	appContextPath = "/zimbra";
	appCurrentSkin = "sand";
	appExtension   = ".zgz";
	appDevMode     = false;



if(!window.com_zimbra_email){com_zimbra_email={}
}com_zimbra_email.addToFilter="Add to Filter";
com_zimbra_email.advancedSearch="Advanced Search";
com_zimbra_email.goToUrl="Go to URL";
com_zimbra_email.newContact="New Contact";
com_zimbra_email.newEmail="New Email";
com_zimbra_email.newFilter="New Filter";
com_zimbra_email.newIM="New IM";
com_zimbra_email.search="Search";
if(!window.com_zimbra_date){com_zimbra_date={}
}com_zimbra_date.appointmentNewTitle="New Appointment";
com_zimbra_date.boundaryFalse="false";
com_zimbra_date.boundaryTrue="true";
com_zimbra_date["format1.boundary"]="true";
com_zimbra_date["format1.pattern"]="(today|tonight|this morning)";
com_zimbra_date["format1.rule"]="now";
com_zimbra_date["format10.boundary"]="true";
com_zimbra_date["format10.pattern"]="{monthname}.? {datenum}(st|nd|rd|th)?";
com_zimbra_date["format10.rule"]="now month={monthname},{datenum}";
com_zimbra_date["format11.boundary"]="true";
com_zimbra_date["format11.pattern"]="{dayname}, {datenum} {monthname} {yearnum}";
com_zimbra_date["format11.rule"]="{yearnum}-01-01 month={monthname},{datenum}";
com_zimbra_date["format12.boundary"]="true";
com_zimbra_date["format12.pattern"]="{datenum} {monthname} {yearnum}";
com_zimbra_date["format12.rule"]="{yearnum}-01-01 month={monthname},{datenum}";
com_zimbra_date["format13.boundary"]="true";
com_zimbra_date["format13.pattern"]="{monthnum}/{datenum}/{yearnum}";
com_zimbra_date["format13.rule"]="{yearnum}-{monthnum}-{datenum}";
com_zimbra_date["format14.boundary"]="true";
com_zimbra_date["format14.pattern"]="{yearnum}-{monthnum}-{datenum}";
com_zimbra_date["format14.rule"]="{yearnum}-{monthnum}-{datenum}";
com_zimbra_date["format15.boundary"]="true";
com_zimbra_date["format15.pattern"]="{monthname} {yearnum}";
com_zimbra_date["format15.rule"]="now month={monthname},1";
com_zimbra_date["format16.boundary"]="true";
com_zimbra_date["format16.pattern"]="{dayname}";
com_zimbra_date["format16.rule"]="now +1 {dayname}";
com_zimbra_date["format17.boundary"]="true";
com_zimbra_date["format17.pattern"]="{datenum}(st|nd|rd|th)? {monthname}?,? {yearnum}";
com_zimbra_date["format17.rule"]="{yearnum}-01-01 month={monthname},{datenum}";
com_zimbra_date["format18.boundary"]="true";
com_zimbra_date["format18.pattern"]="{dayname}, {monthname} {datenum}";
com_zimbra_date["format18.rule"]="now month={monthname},{datenum}";
com_zimbra_date["format19.boundary"]="true";
com_zimbra_date["format19.pattern"]="###";
com_zimbra_date["format19.rule"]="###";
com_zimbra_date["format2.boundary"]="true";
com_zimbra_date["format2.pattern"]="tomorrow";
com_zimbra_date["format2.rule"]="now +1 day";
com_zimbra_date["format20.boundary"]="true";
com_zimbra_date["format20.pattern"]="###";
com_zimbra_date["format20.rule"]="###";
com_zimbra_date["format21.boundary"]="true";
com_zimbra_date["format21.pattern"]="###";
com_zimbra_date["format21.rule"]="###";
com_zimbra_date["format22.boundary"]="true";
com_zimbra_date["format22.pattern"]="###";
com_zimbra_date["format22.rule"]="###";
com_zimbra_date["format23.boundary"]="true";
com_zimbra_date["format23.pattern"]="###";
com_zimbra_date["format23.rule"]="###";
com_zimbra_date["format24.boundary"]="true";
com_zimbra_date["format24.pattern"]="###";
com_zimbra_date["format24.rule"]="###";
com_zimbra_date["format25.boundary"]="true";
com_zimbra_date["format25.pattern"]="###";
com_zimbra_date["format25.rule"]="###";
com_zimbra_date["format26.boundary"]="true";
com_zimbra_date["format26.pattern"]="###";
com_zimbra_date["format26.rule"]="###";
com_zimbra_date["format27.boundary"]="true";
com_zimbra_date["format27.pattern"]="###";
com_zimbra_date["format27.rule"]="###";
com_zimbra_date["format28.boundary"]="true";
com_zimbra_date["format28.pattern"]="###";
com_zimbra_date["format28.rule"]="###";
com_zimbra_date["format29.boundary"]="true";
com_zimbra_date["format29.pattern"]="###";
com_zimbra_date["format29.rule"]="###";
com_zimbra_date["format3.boundary"]="true";
com_zimbra_date["format3.pattern"]="yesterday";
com_zimbra_date["format3.rule"]="now -1 day";
com_zimbra_date["format30.boundary"]="true";
com_zimbra_date["format30.pattern"]="###";
com_zimbra_date["format30.rule"]="###";
com_zimbra_date["format4.boundary"]="true";
com_zimbra_date["format4.pattern"]="(this|next) {dayname}";
com_zimbra_date["format4.rule"]="now +1 {dayname}";
com_zimbra_date["format5.boundary"]="true";
com_zimbra_date["format5.pattern"]="last {dayname}";
com_zimbra_date["format5.rule"]="now -1 {dayname}";
com_zimbra_date["format6.boundary"]="true";
com_zimbra_date["format6.pattern"]="{weekord} {dayname} (of|in) {monthname}";
com_zimbra_date["format6.rule"]="now date=1 +1 {monthname} {weekord} {dayname}";
com_zimbra_date["format7.boundary"]="true";
com_zimbra_date["format7.pattern"]="{weekord} {dayname}";
com_zimbra_date["format7.rule"]="now {weekord} {dayname}";
com_zimbra_date["format8.boundary"]="true";
com_zimbra_date["format8.pattern"]="{datenum}(st|nd|rd|th) (of|in) {monthname}";
com_zimbra_date["format8.rule"]="now month={monthname},{datenum}";
com_zimbra_date["format9.boundary"]="true";
com_zimbra_date["format9.pattern"]="{monthname}.? {datenum}(st|nd|rd|th)?, {yearnum}";
com_zimbra_date["format9.rule"]="{yearnum}-01-01 month={monthname},{datenum}";
com_zimbra_date.searchForMessages="Search for mail messages";
com_zimbra_date.viewDay="Day";
if(!window.com_zimbra_phone){com_zimbra_phone={}
}com_zimbra_phone.addToContacts="Add To Contacts";
com_zimbra_phone.search="Search";
com_zimbra_phone.skypeCall="Skype Call";
if(!window.com_zimbra_local){com_zimbra_local={}
}com_zimbra_local.address="Address:";
com_zimbra_local.changeLocation="Change Location by Zip Code";
com_zimbra_local.coordsNotFound="Could not find coordinates for the given zip code.";
com_zimbra_local.csgNetworkError="Could not detect your location <br> from provided zip using csgnetwork service. <br> Enter your location manually.";
com_zimbra_local.enterAddress="Yahoo! Maps: Enter Address";
com_zimbra_local.errorLoadingAPI="Error loading Yahoo! API";
com_zimbra_local.latitude="Latitude";
com_zimbra_local.local="Local";
com_zimbra_local.localSearchBtnLabel="Local";
com_zimbra_local.localSearchBtnTooltip="Run Y! Local search";
com_zimbra_local.longitude="Longitude";
com_zimbra_local.manualLocation="Manual Location";
com_zimbra_local.maxMindError="Could not auto detect your location <br> using max mind service at this time. <br> Enter your location manually.";
com_zimbra_local.menuItemChangeLocation="Change Location";
com_zimbra_local.menuItemChangeLocationByZip="Change Location By Zip";
com_zimbra_local.menuItemMyLocation="My Location";
com_zimbra_local.menuItemPreferences="Preferences";
com_zimbra_local.menuItemSearch="Search";
com_zimbra_local.menuItemSearchAddress="Search Address";
com_zimbra_local.menuItemTraffic="Traffic";
com_zimbra_local.menuItemUpcoming="Upcoming";
com_zimbra_local.msgBody="Hi,\nYour friend has shared you this Yahoo Map {0}. \n\nPlease access it @    \n\n";
com_zimbra_local.msgFooter="\n\nThis email was sent to you by a user on Yahoo Maps (maps.yahoo.com).";
com_zimbra_local.msgSubject="{0} sent this Yahoo Maps.";
com_zimbra_local.panelTooltip="Yahoo! Local. Right click for more options ";
com_zimbra_local.searchFor="Search for:";
com_zimbra_local.searchYahooLocal="Search Yahoo! Local";
com_zimbra_local.trafficTooltip="Search for Local Traffic";
com_zimbra_local.upcomingTooltip="Search for Local Events";
com_zimbra_local.ygeoLocalError="Could not detect your location <br> from provided zip using Yahoo! Geo-Local service. <br> Enter your location manually.";
com_zimbra_local.ygeoapiURL="http://local.yahooapis.com/MapsService/V1/geocode";
com_zimbra_local.zipCode="Zip Code:";
com_zimbra_local.zipCodeInvalid="Zipcode invalid.";
if(!window.com_zimbra_ymemoticons){com_zimbra_ymemoticons={}
}com_zimbra_ymemoticons.preferences="Preferences";
com_zimbra_ymemoticons.temporarilyDisableInMail="Temporarily disable in Mail";
com_zimbra_ymemoticons.yahooEmoticons="Yahoo! Emoticons";
function Com_Zimbra_Email(){}Com_Zimbra_Email.prototype=new ZmZimletBase();
Com_Zimbra_Email.prototype.constructor=Com_Zimbra_Email;
Com_Zimbra_Email.IM_NEW_IM="im new im";
Com_Zimbra_Email.IM_NEW_BUDDY="im new buddy";
Com_Zimbra_Email.NEW_FILTER="__new__";
Com_Zimbra_Email.prototype.init=function(){if(appCtxt.get(ZmSetting.CONTACTS_ENABLED)){this._composeTooltipHint=ZmMsg.leftClickComposeHint+"<br>"+ZmMsg.rightClickHint;
this._newTooltipHint=ZmMsg.leftClickNewContactHint+"<br>"+ZmMsg.rightClickHint;
if(appCtxt.get(ZmSetting.IM_ENABLED)){this._presenceCache=[]
}}else{this._newTooltipHint=ZmMsg.leftClickComposeHint+"<br>"+ZmMsg.rightClickHint
}this._yahooSocialEnabled=this.getBoolConfig("yahooSocialEnabled")
};
Com_Zimbra_Email.prototype._getRoster=function(){if(!this._roster&&appCtxt.get(ZmSetting.IM_ENABLED)&&!(!appCtxt.get(ZmSetting.IM_PREF_AUTO_LOGIN)&&!appCtxt.getApp(ZmApp.IM).hasRoster())){this._roster=AjxDispatcher.run("GetRoster");
var A=this._roster.getRosterItemList();
A.addChangeListener(new AjxListener(this,this._rosterChangeListener))
}return this._roster
};
Com_Zimbra_Email.prototype._rosterChangeListener=function(I){if(I.event!=ZmEvent.E_MODIFY){return 
}var H=I.getDetail("fields");
var D=ZmRosterItem.F_PRESENCE in H;
if(D){var B=I.getItems();
var F={};
for(var G=B.length;
--G>=0;
){var J=B[G];
F[J.getAddress()]=J
}var A=this._presenceCache;
for(var G=A.length;
--G>=0;
){var C=A[G];
var J=F[C.im_addr];
if(J){var E=document.getElementById(C.img_id);
if(E){AjxImg.setImage(E,J.getPresence().getIcon(),true)
}else{}}}}};
Com_Zimbra_Email.prototype._getHtmlContent=function(D,H,C,A,B){if(C instanceof AjxEmailAddress){var G=appCtxt.getApp(ZmApp.CONTACTS);
var E=G&&G.getContactByEmail(C.address);
var F=this._getBuddy(E,C.address);
if(G&&!E&&E!==null){var I=new AjxCallback(this,this._handleResponseGetContact,[D,H,C,B]);
G.getContactByEmail(C.address,I)
}return this._updateHtmlContent(D,H,C,E,F)
}else{D[H++]=AjxStringUtil.htmlEncode(C);
return H
}};
Com_Zimbra_Email.prototype._updateHtmlContent=function(F,L,E,G,J,B){var H;
if(J){var D=J.getPresence();
var I=Dwt.getNextId();
var C=[AjxStringUtil.htmlEncode(J.getDisplayName())," ",AjxImg.getImageHtml(D.getIcon(),"display: inline; padding: 1px 8px;","id="+I)];
H=C.join("");
var A={contact:G,buddy:J,im_addr:J.getAddress(),img_id:I};
this._presenceCache.push(A);
if(this._presenceCache.length>50){this._presenceCache.splice(0,1)
}this._getRoster()
}else{if(G){H=AjxStringUtil.htmlEncode(G.getFullName());
if(!H){H=AjxStringUtil.htmlEncode(E.toString())
}}else{H=AjxStringUtil.htmlEncode(E.toString())
}}if(B){var K=document.getElementById(B);
if(K){K.innerHTML=H
}}else{F[L++]=H;
return L
}};
Com_Zimbra_Email.prototype._handleResponseGetContact=function(D,B,F,E,A){if(A){var C=this._getBuddy(A,F.address);
this._updateHtmlContent(D,B,F,A,C,E)
}};
Com_Zimbra_Email.prototype._getBuddy=function(A,B){if(appCtxt.isChildWindow){return 
}var C;
if(appCtxt.get(ZmSetting.IM_ENABLED)&&!(!appCtxt.get(ZmSetting.IM_PREF_AUTO_LOGIN)&&!appCtxt.getApp(ZmApp.IM).hasRoster())){C=A&&A.getBuddy();
if(!C){C=AjxDispatcher.run("GetRoster").getRosterItem(B)
}}return C
};
Com_Zimbra_Email.prototype.toolTipPoppedUp=function(C,L,M,B){var K=(L instanceof AjxEmailAddress)?L.address:L;
if(this.isMailToLink(K)){K=(this.parseMailToLink(K)).to||K
}var A;
var D=false;
if(this._yahooSocialEnabled){var H=K.split("@");
var G=(H.length>0)?H[1]:null;
D=(G&&G=="yahoo.com")
}var I=AjxDispatcher.run("GetContacts");
var J=I?I.getContactByEmail(K):null;
if(J){var F=D?this._getYahooHint():this._composeTooltipHint;
A=J.getToolTip(K,false,F)
}else{var F=D?this._getYahooHint():this._newTooltipHint;
var E={addrstr:K.toString(),hint:F};
A=AjxTemplate.expand("abook.Contacts#TooltipNotInAddrBook",E)
}B.innerHTML=A
};
Com_Zimbra_Email.prototype.createFilterMenu=function(A){if(this._filterMenu){return 
}this._newFilterMenuItem=A.getOp("ADDTOFILTER");
this._filterMenu=new ZmPopupMenu(A);
this._newFilterMenuItem.setMenu(this._filterMenu);
this._rules=AjxDispatcher.run("GetFilterRules");
this._rules.addChangeListener(new AjxListener(this,this._rulesChangeListener));
this._resetFilterMenu()
};
Com_Zimbra_Email.prototype._resetFilterMenu=function(){var A=this._filterMenu.getItems();
while(A.length>0){this._filterMenu.removeChild(A[0])
}this._rules.loadRules(false,new AjxCallback(this,this._populateFiltersMenu))
};
Com_Zimbra_Email.prototype._populateFiltersMenu=function(B){var C=B.getResponse();
var D=this._filterMenu;
var E=new DwtMenuItem({parent:D});
E.setText(this.getMessage("newFilter"));
E.setImage("Plus");
E.setData(Dwt.KEY_OBJECT,Com_Zimbra_Email.NEW_FILTER);
E.addSelectionListener(new AjxListener(this,this._filterItemSelectionListener));
if(C.size()){D.createSeparator()
}for(var A=0;
A<C.size();
A++){this._addFilter(D,C.get(A))
}};
Com_Zimbra_Email.prototype._rulesChangeListener=function(A){if(A.type!=ZmEvent.S_FILTER){return 
}if(!A.handled){this._resetFilterMenu();
A.handled=true
}};
Com_Zimbra_Email.prototype._filterItemSelectionListener=function(B){var A=B.item;
var C=true;
var E=A.getData(Dwt.KEY_OBJECT);
if(E==Com_Zimbra_Email.NEW_FILTER){C=false;
E=new ZmFilterRule();
E.addAction(ZmFilterRule.A_KEEP)
}var F=this._getAddress(this._actionObject);
if(AjxUtil.isString(F)&&this.isMailToLink(F)){F=(this.parseMailToLink(F)).to||F
}var D=ZmFilterRule.C_HEADER_VALUE[ZmFilterRule.C_FROM];
E.addCondition(ZmFilterRule.TEST_HEADER,ZmFilterRule.OP_IS,F,D);
appCtxt.getFilterRuleDialog().popup(E,C)
};
Com_Zimbra_Email.prototype._addFilter=function(D,C,B){var A=new DwtMenuItem({parent:D,index:B});
A.setText(AjxStringUtil.clipByLength(C.name,20));
A.setData(Dwt.KEY_OBJECT,C);
A.addSelectionListener(new AjxListener(this,this._filterItemSelectionListener))
};
Com_Zimbra_Email.prototype.getActionMenu=function(D,I,B){var G=ZmZimletBase.prototype.getActionMenu.call(this,D,I,B);
if(appCtxt.get(ZmSetting.FILTERS_ENABLED)&&G.getOp("ADDTOFILTER")){this.createFilterMenu(G)
}var F=(D instanceof AjxEmailAddress)?D.getAddress():D;
if(this.isMailToLink(F)){F=(this.parseMailToLink(F)).to||F
}if(!appCtxt.get(ZmSetting.CONTACTS_ENABLED)){if(G.getOp("NEWCONTACT")){G.removeOp("NEWCONTACT")
}}var A=G.getOp("NEWIM");
if(A){if(!appCtxt.get(ZmSetting.IM_ENABLED)){G.removeOp("NEWIM")
}else{var C=D instanceof AjxEmailAddress?D:new AjxEmailAddress(D);
ZmImApp.updateImMenuItemByAddress(A,C)
}}if(G.getOp("SEARCH")&&!appCtxt.get(ZmSetting.SEARCH_ENABLED)){ZmOperation.removeOperation(G,"SEARCH",G._menuItems)
}if(G.getOp("SEARCHBUILDER")&&!appCtxt.get(ZmSetting.BROWSE_ENABLED)){ZmOperation.removeOperation(G,"SEARCHBUILDER",G._menuItems)
}if(G.getOp("ADDTOFILTER")&&!appCtxt.get(ZmSetting.FILTERS_ENABLED)){ZmOperation.removeOperation(G,"ADDTOFILTER",G._menuItems)
}var H=appCtxt.getApp(ZmApp.CONTACTS);
var E=H&&H.getContactByEmail(D.address);
if(E){ZmOperation.setOperation(G,"NEWCONTACT",ZmOperation.EDIT_CONTACT)
}else{if(H&&!E&&E!==null){G.getOp("NEWCONTACT").setText(ZmMsg.loading);
var J=new AjxCallback(this,this._handleResponseGetContact1,[G]);
H.getContactByEmail(F,J)
}else{ZmOperation.setOperation(G,"NEWCONTACT",ZmOperation.NEW_CONTACT,ZmMsg.AB_ADD_CONTACT)
}}return G
};
Com_Zimbra_Email.prototype._handleResponseGetContact1=function(D,A){var B=A?ZmOperation.EDIT_CONTACT:ZmOperation.NEW_CONTACT;
var C=A?null:ZmMsg.AB_ADD_CONTACT;
ZmOperation.setOperation(D,"NEWCONTACT",B,C)
};
Com_Zimbra_Email.prototype.isMailToLink=function(A){return(!!(A.search(/mailto/i)!=-1))
};
Com_Zimbra_Email.prototype.parseMailToLink=function(C){var B={};
var A=C.match(/\bsubject=([^&]+)/);
B.subject=A?decodeURIComponent(A[1]):null;
A=C.match(/\bto\:([^&]+)/);
if(!A){A=C.match(/\bmailto\:([^\?]+)/i)
}B.to=A?decodeURIComponent(A[1]):null;
A=C.match(/\bbody=([^&]+)/);
B.body=A?decodeURIComponent(A[1]):null;
return B
};
Com_Zimbra_Email.prototype.clicked=function(A,I,J,H){var G=(I instanceof AjxEmailAddress)?I.address:I;
if(this._yahooSocialEnabled){var B=G.split("@");
var C=(B.length>0)?B[1]:null;
if(C&&C=="yahoo.com"){var F="http://profiles.yahoo.com/"+B[0];
window.open(F,"_blank");
return 
}}var D=AjxDispatcher.run("GetContacts");
var E=D?D.getContactByEmail(G):null;
if(E||D==null||(AjxUtil.isString(G)&&this.isMailToLink(G))){this._actionObject=null;
this._composeListener(H,G)
}else{this._actionObject=I;
this._contactListener(true)
}};
Com_Zimbra_Email.prototype.menuItemSelected=function(C,B,A){switch(C){case"SEARCH":this._searchListener();
break;
case"SEARCHBUILDER":this._browseListener();
break;
case"NEWEMAIL":this._composeListener(A);
break;
case"NEWIM":this._newImListener(A);
break;
case"NEWCONTACT":this._contactListener(true);
break;
case"ADDTOFILTER":this._filterListener();
break;
case"GOTOURL":this._goToUrlListener();
break
}};
Com_Zimbra_Email.prototype._getYahooHint=function(){var B=[];
var A=0;
B[A++]="<center><table border=0><tr><td valign=top><div class='ImgWebSearch'></div></td><td>";
B[A++]=ZmMsg.leftClickYahoohint;
B[A++]="<div class='TooltipHint'>";
B[A++]=ZmMsg.rightClickHint;
B[A++]="</div></td></tr></table></center>";
return B.join("")
};
Com_Zimbra_Email.prototype._getAddress=function(A){return(A.constructor==AjxEmailAddress)?A.address:A
};
Com_Zimbra_Email.prototype._contactListener=function(B){var A=new AjxCallback(this,this._handleLoadContact,[B]);
AjxDispatcher.require(["ContactsCore","Contacts"],false,A,null,true)
};
Com_Zimbra_Email.prototype._newImListener=function(A){ZmImApp.getImMenuItemListener().handleEvent(A)
};
Com_Zimbra_Email.prototype._getActionedContact=function(B){var A;
var C=this._actionObject;
if(this._actionObject){if(this._actionObject instanceof ZmContact){A=this._actionObject
}else{if(AjxUtil.isString(this._actionObject)){C=this._getAddress(this._actionObject);
if(this.isMailToLink(C)){C=(this.parseMailToLink(C)).to||C
}A=AjxDispatcher.run("GetContacts").getContactByEmail(C)
}else{A=AjxDispatcher.run("GetContacts").getContactByEmail(this._actionObject.address)
}}}if(A==null&&B){A=new ZmContact(null);
A.initFromEmail(C)
}return A
};
Com_Zimbra_Email.prototype._handleLoadContact=function(B){var A=this._getActionedContact(true);
if(window.parentAppCtxt){var C=window.parentAppCtxt.getApp(ZmApp.CONTACTS);
C.getContactController().show(A,B)
}else{AjxDispatcher.run("GetContactController").show(A,B)
}};
Com_Zimbra_Email.prototype._composeListener=function(B,E){E=(this._actionObject)?this._getAddress(this._actionObject):E;
if(!E){E=""
}var D={};
var A=(!appCtxt.get(ZmSetting.NEW_WINDOW_COMPOSE)&&B&&B.shiftKey)||(appCtxt.get(ZmSetting.NEW_WINDOW_COMPOSE)&&B&&!B.shiftKey);
if(this.isMailToLink(E)){var C=this.parseMailToLink(E);
D.toOverride=C.to;
D.subjOverride=C.subject;
D.extraBodyText=C.body;
E=C.to||E
}D.action=ZmOperation.NEW_MESSAGE;
D.inNewWindow=A;
if(!D.toOverride){D.toOverride=E+AjxEmailAddress.SEPARATOR
}AjxDispatcher.run("Compose",D)
};
Com_Zimbra_Email.prototype._browseListener=function(){var A=this._getAddress(this._actionObject);
if(this.isMailToLink(A)){A=(this.parseMailToLink(A)).to||A
}appCtxt.getSearchController().fromBrowse(A)
};
Com_Zimbra_Email.prototype._searchListener=function(){var A=this._getAddress(this._actionObject);
if(this.isMailToLink(A)){A=(this.parseMailToLink(A)).to||A
}appCtxt.getSearchController().fromSearch(this._getAddress(A))
};
Com_Zimbra_Email.prototype._filterListener=function(){var A=new AjxCallback(this,this._handleLoadFilter);
AjxDispatcher.require(["PreferencesCore","Preferences"],false,A,null,true)
};
Com_Zimbra_Email.prototype._handleLoadFilter=function(){appCtxt.getAppViewMgr().popView(true,ZmId.VIEW_LOADING);
var B=new ZmFilterRule();
var C=this._getAddress(this._actionObject);
if(AjxUtil.isString(C)&&this.isMailToLink(C)){C=(this.parseMailToLink(C)).to||C
}var A=ZmFilterRule.C_HEADER_VALUE[ZmFilterRule.C_FROM];
B.addCondition(ZmFilterRule.TEST_HEADER,ZmFilterRule.OP_IS,C,A);
B.addAction(ZmFilterRule.A_KEEP);
appCtxt.getFilterRuleDialog().popup(B)
};
Com_Zimbra_Email.prototype._goToUrlListener=function(){var D=this._getAddress(this._actionObject);
if(AjxUtil.isString(D)&&this.isMailToLink(D)){D=(this.parseMailToLink(D)).to||D
}var C=D.split("@");
if(C.length){var B=C[C.length-1];
var A=B.split(".");
this._actionUrl="http://"+((A.length<=2)?"www."+B:B)
}if(this._actionUrl){window.open(this._actionUrl,"_blank")
}else{this.displayStatusMessage(ZmMsg.errorCreateUrl)
}};
Com_Zimbra_Date=function(A){if(arguments.length==1){this._generateRegex(A)
}};
Com_Zimbra_Date.prototype=new ZmZimletBase();
Com_Zimbra_Date.prototype.constructor=Com_Zimbra_Date;
Com_Zimbra_Date.prototype.TYPE=ZmObjectManager.DATE;
Com_Zimbra_Date.validate=function(A,D,B){if(A<1||A>31){return false
}if(D<0||D>11){return false
}if((D==3||D==5||D==8||D==10)&&A==31){return false
}if(B&&D==1){var C=(B%4==0&&(B%100!=0||B%400==0));
if(A>29||(A==29&&!C)){return false
}}return true
};
Com_Zimbra_Date.prototype.getCurrentDate=function(A){var B=this[ZmObjectManager.ATTR_CURRENT_DATE];
return B?B:new Date()
};
Com_Zimbra_Date.prototype.init=function(){Com_Zimbra_Date.prototype._zimletContext=this._zimletContext;
Com_Zimbra_Date.prototype._className="Object";
this._initDateObjectHandlers()
};
Com_Zimbra_Date.prototype.getActionMenu=function(C,B,A){if(this._zimletContext._contentActionMenu instanceof AjxCallback){this._zimletContext._contentActionMenu=this._zimletContext._contentActionMenu.run()
}Com_Zimbra_Date._actionObject=C;
Com_Zimbra_Date._actionSpan=B;
Com_Zimbra_Date._actionContext=A;
return this._zimletContext._contentActionMenu
};
Com_Zimbra_Date.prototype.menuItemSelected=function(A){switch(A){case"DAYVIEW":this._dayViewListener();
break;
case"NEWAPPT":this._newApptListener();
break;
case"SEARCHMAIL":this._searchMailListener();
break
}};
Com_Zimbra_Date.prototype.toolTipPoppedUp=function(C,D,B,A){if(appCtxt.isChildWindow){var E=this.getOpenerApp(ZmApp.CALENDAR);
if(E){A.innerHTML=E.getDateToolTip(B?B.date:new Date())
}}else{var F=AjxDispatcher.run("GetCalController");
A.innerHTML=F.getDayToolTipText(B?B.date:new Date())
}};
Com_Zimbra_Date.prototype.getOpenerApp=function(C){var B=window.opener;
var A=B?B.appCtxt:null;
var D=A?A.getApp(C):null;
return D
};
Com_Zimbra_Date.prototype.clicked=function(E,F,D,C){if(appCtxt.isChildWindow){var G=this.getOpenerApp(ZmApp.CALENDAR);
if(G){G.showDayView(D.date);
window.opener.focus();
window.close()
}}else{var B=AjxDispatcher.run("GetCalController");
var A=B.getMiniCalendar();
B.setDate(D.date,0,A.getForceRollOver());
if(!B._viewVisible){B.show(ZmId.VIEW_CAL_DAY)
}}};
Com_Zimbra_Date.prototype.match=function(L,J){if(!Com_Zimbra_Date.PATTERNS){return null
}var E,A,H,K,C,D;
for(D=0;
D<Com_Zimbra_Date.REGEXES.length;
D++){K=Com_Zimbra_Date.REGEXES[D];
K.lastIndex=J;
C=K.exec(L);
if(C&&C[0]&&(!E||C[0].length>E[0].length)){E=C;
H=Com_Zimbra_Date.RULES[D];
A=K.mapping
}}if(!E){return null
}try{var F,I;
for(D in A){F=A[D];
I=E[D];
H=H.replace(new RegExp("\\{"+F+"\\}","gi"),I)
}var B=new Date(this.getCurrentDate().getTime());
E.context={rule:H,date:AjxDateUtil.calculate(H,B),monthOnly:0,valid:true};
return E
}catch(G){if(window.console&&window.console.log){console.log(G)
}return null
}};
Com_Zimbra_Date.prototype._initDateObjectHandlers=function(){if(!appCtxt.get(ZmSetting.CALENDAR_ENABLED)){return 
}Com_Zimbra_Date.MAPPINGS={datenum:"(0[1-9]|[1-9]|[1-2][0-9]|3[0-1])",dayname:"("+AjxDateUtil.S_DAYNAME+")",weekord:"("+AjxDateUtil.S_WEEKORD+")",monthnum:"(0[1-9]|[1-9]|1[0-2])",monthname:"("+AjxDateUtil.S_MONTHNAME+")",yearnum:"(\\d{2}|[1-9]\\d{2,3})",number:"(\\d+)"};
Com_Zimbra_Date.PATTERNS=[];
Com_Zimbra_Date.RULES=[];
Com_Zimbra_Date.REGEXES=[];
var B,D;
for(B=1;
D=this.getMessage("format"+B+".pattern");
B++){if(D.match(/^\?\?\?+/)){break
}if(D.match(/^###+/)){break
}if(D.match(/^#/)){continue
}Com_Zimbra_Date.PATTERNS.push(D);
Com_Zimbra_Date.RULES.push(this.getMessage("format"+B+".rule"))
}for(B=0;
B<Com_Zimbra_Date.DEFAULT_FORMATS.length;
B++){Com_Zimbra_Date.PATTERNS.push(Com_Zimbra_Date.DEFAULT_FORMATS[B]);
Com_Zimbra_Date.RULES.push(Com_Zimbra_Date.DEFAULT_FORMATS[++B])
}var E,C;
var A=this.getMessage("boundaryTrue");
for(B=0;
B<Com_Zimbra_Date.PATTERNS.length;
B++){D=Com_Zimbra_Date.PATTERNS[B];
D=D.replace(/\s+/g,"\\s+");
D=D.replace(/\(([^\)]+)\)/g,"(?:$1)");
Com_Zimbra_Date.__replaceKeyword_group=1;
Com_Zimbra_Date.__replaceKeyword_mapping={};
D=D.replace(/\{([a-z]+)\}/g,Com_Zimbra_Date.__replaceKeyword);
E=this.getMessage("format"+B+".boundary");
if(E==null||E==A){D="\\b"+D+"\\b"
}C=new RegExp(D,"gi");
C.mapping=Com_Zimbra_Date.__replaceKeyword_mapping;
Com_Zimbra_Date.REGEXES.push(C)
}ZmObjectManager.registerHandler(this,ZmObjectManager.DATE,this._zimletContext.priority)
};
Com_Zimbra_Date.prototype._dayViewListener=function(){var A=new AjxCallback(this,this._handleLoadDayView);
AjxDispatcher.require(["CalendarCore","Calendar","CalendarAppt"],false,A,null,true)
};
Com_Zimbra_Date.prototype._handleLoadDayView=function(){var B=appCtxt.getApp(ZmApp.CALENDAR);
B.activate(true);
var A=B.getCalController();
A.show(ZmId.VIEW_CAL_DAY);
A.setDate(Com_Zimbra_Date._actionContext.date)
};
Com_Zimbra_Date.prototype._newApptListener=function(){var A=new AjxCallback(this,this._handleLoadNewAppt);
AjxDispatcher.require(["CalendarCore","Calendar","CalendarAppt"],false,A,null,true)
};
Com_Zimbra_Date.prototype._handleLoadNewAppt=function(){appCtxt.getAppViewMgr().popView(true,ZmId.VIEW_LOADING);
AjxDispatcher.run("GetCalController").newAppointmentHelper(Com_Zimbra_Date._actionContext.date)
};
Com_Zimbra_Date.prototype._searchMailListener=function(){appCtxt.getSearchController().dateSearch(Com_Zimbra_Date._actionContext.date)
};
Com_Zimbra_Date.__replaceKeyword_mapping=null;
Com_Zimbra_Date.__replaceKeyword_group=-1;
Com_Zimbra_Date.__replaceKeyword=function(A,B){var D=Com_Zimbra_Date.MAPPINGS;
B=B.toLowerCase();
if(!D[B]){return A
}var C=Com_Zimbra_Date.__replaceKeyword_mapping;
var E=Com_Zimbra_Date.__replaceKeyword_group++;
C[E++]=B;
return D[B]
};
Com_Zimbra_Date.DEFAULT_FORMATS=["Brooke Ellen Henrikson","2009-10-17T10:20:00Z","Nicholas Mateo Damon","2008-07-18T17:35:00Z","Shyar Parag Shah","2008-07-16T04:51:00Z","Diego Isaac Comfort","2006-12-08T20:05:00Z","Nila Dharmaraj","2006-03-19T16:30:00Z","Nikhil Dharmaraj","2001-08-22T20:00:00Z"];
function Com_Zimbra_Url(){}Com_Zimbra_Url.prototype=new ZmZimletBase();
Com_Zimbra_Url.prototype.constructor=Com_Zimbra_Url;
Com_Zimbra_Url.prototype.init=function(){this._disablePreview=this.getBoolConfig("disablePreview",true);
this._alexaId=this.getConfig("alexaThumbnailId");
if(this._alexaId){this._alexaId=AjxStringUtil.trim(this._alexaId);
this._alexaKey=AjxStringUtil.trim(this.getConfig("alexaThumbnailKey"))
}Com_Zimbra_Url.REGEXES=[];
var A=this.getConfig("ZIMLET_CONFIG_REGEX_VALUE");
if(A){var B=new RegExp(A,"gi");
if(B){Com_Zimbra_Url.REGEXES.push(B)
}}if(/^\s*true\s*$/i.test(this.getConfig("supportUNC"))){A=this.getConfig("ZIMLET_UNC_REGEX_VALUE");
var B=new RegExp(A,"gi");
if(B){Com_Zimbra_Url.REGEXES.push(B)
}}};
Com_Zimbra_Url.THUMB_URL="http://images.websnapr.com/?url=";
Com_Zimbra_Url.THUMB_SIZE='width="200" height="150"';
Com_Zimbra_Url.prototype.match=function(B,G){for(var D=0;
D<Com_Zimbra_Url.REGEXES.length;
D++){var E=Com_Zimbra_Url.REGEXES[D];
E.lastIndex=G;
var A=E.exec(B);
if(!A){continue
}var F=A[0].charAt(A[0].length-1);
if(F=="."||F==","||F=="!"){var C={index:A.index};
C[0]=A[0].substring(0,A[0].length-1);
return C
}else{return A
}}};
Com_Zimbra_Url.prototype._getHtmlContent=function(F,I,E,A){var G=E.replace(/\"/g,'"').replace(/^\s+|\s+$/g,"");
if(G.substr(0,4)=="www."){G="http://"+G
}G=G.replace(/\\/g,"/");
if(G.indexOf("\\\\")==0||G.indexOf("//")==0){E.isUNC=true;
G="file://"+G
}var H="<a target='_blank' href='"+G;
if(G.split(/[\?#]/)[0]==(""+window.location).split(/[\?#]/)[0]){var D=G.substr(G.indexOf("?"));
if(D){var C=AjxStringUtil.parseQueryString(G);
if(C){var B=C.app;
if(B&&B.length>0){B=B.toUpperCase();
if(appCtxt.getApp(ZmApp[B])){H="<a href='javascript:top.appCtxt.getAppController().activateApp(top.ZmApp."+B+", null, null);"
}}}}}F[I++]=H;
F[I++]="'>";
F[I++]=AjxStringUtil.htmlEncode(E);
F[I++]="</a>";
return I
};
Com_Zimbra_Url.prototype.toolTipPoppedUp=function(D,E,C,B){var A=E.replace(/^\s+|\s+$/g,"");
if(/^\s*true\s*$/i.test(this.getConfig("stripUrls"))){A=A.replace(/[?#].*$/,"")
}A=A.replace(/\\/g,"/");
if(A.indexOf("\\\\")==0||A.indexOf("//")==0){A="file://"+A
}if(this._disablePreview||A.indexOf("file://")==0){this._showUrlThumbnail(A,B)
}else{if(this._alexaId){this._showAlexaThumbnail(A,B)
}else{(new Image()).src=this.getResource("blank_pixel.gif");
this._showFreeThumbnail(A,B)
}}};
Com_Zimbra_Url.prototype.clicked=function(){var A=DwtShell.getShell(window).getToolTip();
if(A){A.popdown()
}return true
};
Com_Zimbra_Url.prototype._showUrlThumbnail=function(B,A){A.innerHTML="<b>URL:</b> "+decodeURI(B)
};
Com_Zimbra_Url.prototype._showFreeThumbnail=function(B,A){var D=[];
var C=0;
D[C++]="<img src='";
D[C++]=this.getResource("blank_pixel.gif");
D[C++]="' ";
D[C++]=Com_Zimbra_Url.THUMB_SIZE;
D[C++]=" style='background: url(";
D[C++]='"';
D[C++]=Com_Zimbra_Url.THUMB_URL;
D[C++]=B;
D[C++]='"';
D[C++]=")'/>";
A.innerHTML=D.join("")
};
Com_Zimbra_Url.ALEXA_THUMBNAIL_CACHE={};
Com_Zimbra_Url.ALEXA_CACHE_EXPIRES=10*60*1000;
Com_Zimbra_Url.prototype._showAlexaThumbnail=function(A,C){C.innerHTML=["<table style='width: 200px; height: 150px; border-collapse: collapse' cellspacing='0' cellpadding='0'><tr><td align='center'>",ZmMsg.fetchingAlexaThumbnail,"</td></tr></table>"].join("");
var F=Com_Zimbra_Url.ALEXA_THUMBNAIL_CACHE[A];
if(F){var L=new Date().getTime()-F.timestamp;
if(L<Com_Zimbra_Url.ALEXA_CACHE_EXPIRES){var H=["<img src='",F.img,"' />"].join("");
C.firstChild.rows[0].cells[0].innerHTML=H;
return 
}else{delete Com_Zimbra_Url.ALEXA_THUMBNAIL_CACHE[A]
}}var B=new Date(),E=Com_Zimbra_Url.zeroPad;
var I=E(B.getUTCFullYear(),4)+"-"+E(B.getUTCMonth()+1,2)+"-"+E(B.getUTCDate(),2)+"T"+E(B.getUTCHours(),2)+":"+E(B.getUTCMinutes(),2)+":"+E(B.getUTCSeconds(),2)+".000Z";
var D=this._computeAlexaSignature(I);
var J={Service:"AlexaSiteThumbnail",Action:"Thumbnail",AWSAccessKeyId:this._alexaId,Timestamp:I,Signature:D,Size:"Large",Url:A};
var K=[];
for(var G in J){K.push(G+"="+AjxStringUtil.urlComponentEncode(J[G]))
}K="http://ast.amazonaws.com/xino/?"+K.join("&");
this.sendRequest(null,K,null,new AjxCallback(this,this._alexaDataIn,[C,A,K]),true)
};
Com_Zimbra_Url.prototype._computeAlexaSignature=function(A){return AjxSHA1.b64_hmac_sha1(this._alexaKey,"AlexaSiteThumbnailThumbnail"+A)+"="
};
Com_Zimbra_Url.prototype._alexaDataIn=function(D,C,G,A){var B=AjxXmlDoc.createFromDom(A.xml);
var F=B.toJSObject(true,false,true);
F=F.Response;
if(F.ResponseStatus.StatusCode=="Success"){if(F.ThumbnailResult.Thumbnail.Exists=="true"){var E=["<img src='",F.ThumbnailResult.Thumbnail,"' />"].join("");
D.firstChild.rows[0].cells[0].innerHTML=E;
Com_Zimbra_Url.ALEXA_THUMBNAIL_CACHE[C]={img:F.ThumbnailResult.Thumbnail,timestamp:new Date().getTime()}
}else{this._showFreeThumbnail(C,D)
}}else{this._showFreeThumbnail(C,D)
}};
Com_Zimbra_Url.zeroPad=function(C,B){var A=""+C;
while(A.length<B){A="0"+A
}return A
};
function Com_Zimbra_Phone(){}Com_Zimbra_Phone.prototype=new ZmZimletBase();
Com_Zimbra_Phone.prototype.constructor=Com_Zimbra_Phone;
Com_Zimbra_Phone.prototype.match=function(C,H){var B=this.regexps;
var E=null;
for(var F=0;
F<B.length;
++F){var G=B[F];
G.lastIndex=H;
var A=G.exec(C);
if(A&&(E==null||A.index<E.index)){if(G.useParen){for(var D=1;
D<G.useParen;
++D){A.index+=A[D].length
}A[0]=A[G.useParen]
}if(!/^000/.test(A[0])){E=A
}}}return E
};
Com_Zimbra_Phone.prototype.init=function(){var B=[];
var F=this.xmlObj().contentObject.matchOn[0];
var A=F.regex;
for(var D=0;
D<A.length;
++D){F=A[D];
var C=F.attrs;
if(!C){C="ig"
}var E=new RegExp(F._content,C);
if(F.paren!=null){E.useParen=parseInt(F.paren)
}B.push(E)
}this.regexps=B
};
Com_Zimbra_Phone.prototype._getHtmlContent=function(D,A,B,C){var E=Com_Zimbra_Phone.getCallToLink(B);
D[A++]=['<a href="',E,'" onclick="window.top.Com_Zimbra_Phone.unsetOnbeforeunload()">',AjxStringUtil.htmlEncode(B),"</a>"].join("");
return A
};
Com_Zimbra_Phone.prototype.toolTipPoppedUp=function(D,E,B,A){var C={contentObjText:E};
A.innerHTML=AjxTemplate.expand("com_zimbra_phone.templates.Phone#Tooltip",C)
};
Com_Zimbra_Phone.prototype.menuItemSelected=function(A){switch(A){case"SEARCH":this._searchListener();
break;
case"ADDCONTACT":this._contactListener();
break;
case"CALL":this._callListener();
break
}};
Com_Zimbra_Phone.prototype._searchListener=function(){appCtxt.getSearchController().search({query:this._actionObject})
};
Com_Zimbra_Phone.prototype._contactListener=function(){var A=new ZmContact(null);
A.initFromPhone(this._actionObject,this.getConfig("defaultContactField"));
AjxDispatcher.run("GetContactController").show(A)
};
Com_Zimbra_Phone.prototype._callListener=function(){var A=Com_Zimbra_Phone.getCallToLink(this._actionObject.toString());
Com_Zimbra_Phone.unsetOnbeforeunload();
window.location=A
};
Com_Zimbra_Phone.resetOnbeforeunload=function(){window.onbeforeunload=ZmZimbraMail._confirmExitMethod
};
Com_Zimbra_Phone.unsetOnbeforeunload=function(){window.onbeforeunload=null;
this._timerObj=new AjxTimedAction(null,Com_Zimbra_Phone.resetOnbeforeunload);
AjxTimedAction.scheduleAction(this._timerObj,3000)
};
Com_Zimbra_Phone.getCallToLink=function(B){if(!B){return""
}var A=AjxStringUtil.trim(B,true);
if(!/^(?:\+|00)/.test(A)){A="+1"+A
}return"callto:"+A
};
AjxTemplate.register("com_zimbra_phone.templates.Phone#Tooltip",function(B,F,E,A){var D=Boolean(A);
E=(typeof E=="string"?{id:E}:E)||{};
A=A||[];
var C=A.length;
A[C++]="<table cellpadding=2 cellspacing=0 border=0><tr valign='center'><td>";
A[C++]=AjxImg.getImageHtml("Telephone");
A[C++]="</td><td><b><div style='white-space:nowrap'>";
A[C++]=ZmMsg.phone;
A[C++]=":</div></b></td><td><div style='white-space:nowrap'>";
A[C++]=AjxStringUtil.htmlEncode(E.contentObjText);
A[C++]="</div></td></tr></table>";
return D?A.length:A.join("")
},{id:"Tooltip"},true);
AjxPackage.define("com_zimbra_phone.templates.Phone");
AjxTemplate.register("com_zimbra_phone.templates.Phone",AjxTemplate.getTemplate("com_zimbra_phone.templates.Phone#Tooltip"),AjxTemplate.getParams("com_zimbra_phone.templates.Phone#Tooltip"));
function Com_Zimbra_Wikipedia(){}Com_Zimbra_Wikipedia.prototype=new ZmZimletBase();
Com_Zimbra_Wikipedia.prototype.constructor=Com_Zimbra_Wikipedia;
Com_Zimbra_Wikipedia.prototype.init=function(){};
Com_Zimbra_Wikipedia.prototype.doubleClicked=function(){this.singleClicked()
};
Com_Zimbra_Wikipedia.prototype.singleClicked=function(){var E=[{label:"Search",name:"search",type:"string",value:"",minLength:4,maxLength:100}];
if(!this._dlg_propertyEditor){var B=new DwtComposite(this.getShell());
this._propertyEditor=new DwtPropertyEditor(B,true);
var A=this._propertyEditor;
A.initProperties(E);
var D={title:"Search Wikipedia",view:B};
this._dlg_propertyEditor=this._createDialog(D);
var C=this._dlg_propertyEditor;
A.setFixedLabelWidth();
A.setFixedFieldWidth();
C.setButtonListener(DwtDialog.OK_BUTTON,new AjxListener(this,function(){if(!A.validateData()){return 
}this._doSearch()
}))
}this._dlg_propertyEditor.popup()
};
Com_Zimbra_Wikipedia.prototype._doSearch=function(){this._dlg_propertyEditor.popdown();
this._displaySearchResult(this._propertyEditor.getProperties().search);
this._dlg_propertyEditor.dispose();
this._dlg_propertyEditor=null
};
Com_Zimbra_Wikipedia.prototype._displaySearchResult=function(B){var C=["toolbar=yes,location=yes,status=yes,menubar=yes,scrollbars=yes,resizable=yes,width=800,height=600"];
C=C.join(",");
var A="http://www.wikipedia.org/search-redirect.php?language=en&go=Go&search="+AjxStringUtil.urlEncode(B);
window.open(A,"Wikipedia",C)
};
Com_Zimbra_Local=function(){};
Com_Zimbra_Local.prototype=new ZmZimletBase;
Com_Zimbra_Local.prototype.constructor=Com_Zimbra_Local;
Com_Zimbra_Local.prototype.toString=function(){return"Com_Zimbra_Local"
};
Com_Zimbra_Local.prototype.init=function(){this._controller=new YahooLocalController(this);
if(window.skin&&!skin.searchLocal){skin.searchLocal=AjxCallback.simpleClosure(this._controller.searchLocal,this._controller)
}if(appCtxt.get(ZmSetting.WEB_SEARCH_ENABLED)){var A=document.getElementById("skin_search_local_button");
if(!A){this.addLocalSearchToolBar((new AjxListener(this,this._localSearchListener)))
}else{Dwt.setVisible(A,true)
}}YahooMaps.loadExternalResources()
};
Com_Zimbra_Local.prototype.addLocalSearchToolBar=function(C){var B=this._searchToolBar=appCtxt.getSearchController().getSearchToolbar();
var D=document.getElementById(B._htmlElId+"_searchMenuButton");
var E=D.parentNode.insertCell(D.cellIndex+2);
E.id=B._htmlElId+"_searchLocal";
E.className="ZmSearchToolbarCell";
var A=B._addButton({tdId:"_searchLocal",lbl:this.getMessage("localSearchBtnLabel"),icon:"WebSearch",tooltip:this.getMessage("localSearchBtnTooltip"),buttonId:ZmId.LOCAL_SEARCH_BUTTON});
A.addSelectionListener(C)
};
Com_Zimbra_Local.prototype._localSearchListener=function(A){var B=AjxStringUtil.trim(this._searchToolBar.getSearchFieldValue());
if(B&&B.length){this._controller.searchLocal(B)
}};
Com_Zimbra_Local.prototype.menuItemSelected=function(A){switch(A){case"MY_LOCATION":this._controller.markMe();
break;
case"SEARCH":this._controller.searchQuery();
break;
case"SEARCH_ADDR":this._controller.searchAddress();
break;
case"TRAFFIC":this._controller.searchTraffic();
break;
case"UPCOMING":this._controller.searchUpcoming();
break;
case"MANUAL_LOCAION":this._controller.changeLocation();
break;
case"MANULA_LOCATION_ZIP":this._controller.changeLocationByZip();
break;
case"PREFERENCES":this.createPropertyEditor();
break;
default:this.createPropertyEditor();
break
}};
Com_Zimbra_Local.prototype.singleClicked=function(){this._controller.searchQuery()
};
YahooLocalController=function(A){if(arguments.length==0){return 
}ZmController.call(this,appCtxt.getShell());
ZmOperation.registerOp("TRAFFIC",{image:"YLogo"});
ZmOperation.registerOp("UPCOMING",{image:"ULogo"});
this._listeners={};
this._listeners[ZmOperation.TRAFFIC]=new AjxListener(this,this._trafficListener);
this._listeners[ZmOperation.CANCEL]=new AjxListener(this,this._cancelListener);
this._listeners[ZmOperation.SEND]=new AjxListener(this,this._sendListener);
this._listeners[ZmOperation.UPCOMING]=new AjxListener(this,this._upcomingListener);
this._listeners[ZmOperation.SEARCH]=new AjxListener(this,this.searchAddress);
this._zimlet=A;
this._searchOkListener=new AjxListener(this,this._handleSearchListener);
this._searchAddrOkListener=new AjxListener(this,this._handleSearchAddrListener);
this._changeLocationOkListener=new AjxListener(this,this._handleChangeLocationListener)
};
YahooLocalController.prototype=new ZmController;
YahooLocalController.prototype.constructor=YahooLocalController;
YahooLocalController.prototype.getLocal=function(){if(typeof (geoip_country_code)=="undefined"||!AjxUtil.isFunction(geoip_country_code)){return 
}if(!this._ylocal){this._countryCode=geoip_country_code();
this._countryName=geoip_country_name();
this._city=geoip_city();
this._region=geoip_region();
this._latitude=geoip_latitude();
this._longitude=geoip_longitude();
this._ylocal={countryCode:this._countryCode,countryName:this._countryName,city:this._city,region:this._region,latitude:this._latitude,longitude:this._longitude};
this._ylocalTmp={countryCode:this._countryCode,countryName:this._countryName,city:this._city,region:this._region,latitude:this._latitude,longitude:this._longitude}
}var A=this._zimlet.getUserProperty("manuallocation");
if(A&&A.match(/true/i)){this._ylocalTmp.latitude=this._zimlet.getUserProperty("latitude");
this._ylocalTmp.longitude=this._zimlet.getUserProperty("longitude");
return this._ylocalTmp
}return this._ylocal
};
YahooLocalController.prototype.setLocation=function(A,B,C){this._zimlet.setUserProperty("manuallocation","true");
this._zimlet.setUserProperty("latitude",A);
this._zimlet.setUserProperty("longitude",B);
this._zimlet.saveUserProperties(C)
};
YahooLocalController.prototype.searchLocal=function(A){this._getGeoIP(new AjxCallback(this,this._handleSearchLocal,A))
};
YahooLocalController.prototype._handleSearchLocal=function(B){var A=this._setDefaultView(this._curr_lat,this._curr_lon);
if(A){this.getMapsView().searchLocal({query:B,defaultLat:A.latitude,defaultLon:A.longitude})
}else{this._showErrorLoadingAPI()
}};
YahooLocalController.prototype.searchQuery=function(){var B=this._zimlet.getMessage("searchYahooLocal");
var A=this._zimlet.getMessage("searchFor");
this._showInputDialog(B,A,this._searchOkListener)
};
YahooLocalController.prototype.searchAddress=function(A){var C=this._zimlet.getMessage("enterAddress");
var B=this._zimlet.getMessage("address");
this._showInputDialog(C,B,this._searchAddrOkListener)
};
YahooLocalController.prototype.changeLocationByZip=function(A){var C=this._zimlet.getMessage("changeLocation");
var B=this._zimlet.getMessage("zipCode");
this._showInputDialog(C,B,this._changeLocationOkListener)
};
YahooLocalController.prototype.searchUpcoming=function(){this._getGeoIP(new AjxCallback(this,this._handleSearchUpcoming))
};
YahooLocalController.prototype._handleSearchUpcoming=function(){var A=this._setDefaultView(this._curr_lat,this._curr_lon);
if(A){this.getMapsView().searchUpcoming({latitude:A.latitude,longitude:A.longitude})
}else{this._showErrorLoadingAPI()
}};
YahooLocalController.prototype.searchTraffic=function(){this._getGeoIP(new AjxCallback(this,this._handleSearchTraffic))
};
YahooLocalController.prototype._handleSearchTraffic=function(){var A=this._setDefaultView(this._curr_lat,this._curr_lon);
if(A){this.getMapsView().searchTraffic({latitude:A.latitude,longitude:A.longitude})
}else{this._showErrorLoadingAPI()
}};
YahooLocalController.prototype.markMe=function(){this._getGeoIP(new AjxCallback(this,this._handleMarkMe))
};
YahooLocalController.prototype._handleMarkMe=function(){var C;
var D;
if(AjxUtil.isFunction(geoip_latitude)&&AjxUtil.isFunction(geoip_longitude)){C=geoip_latitude();
D=geoip_longitude();
this._curr_lat=C;
this._curr_lon=D
}var B=this._setDefaultView(this._curr_lat,this._curr_lon);
if(B){var E=B?B.latitude:null;
var A=B?B.longitude:null;
this.getMapsView().markMe(E,A)
}else{this._showErrorLoadingAPI()
}};
YahooLocalController.prototype.displayAddress=function(A){this.setView({clean:true,typeControl:true,panControl:false,zoomControl:"long",zoomLevel:6,defaultLocation:A});
this.getMapsView().markAddr({defaultLocation:A})
};
YahooLocalController.prototype.changeLocation=function(A){this._getGeoIP(new AjxCallback(this,this._handleChangeLocation,A))
};
YahooLocalController.prototype._handleChangeLocation=function(B){var A=this._setDefaultView(45,45);
if(A){this.getMapsView().changeLocation({latitude:A.latitude,longitude:A.longitude})
}else{this._showErrorLoadingAPI()
}};
ZmId.VIEW_YMAPS="YAHOOMAPS";
YahooLocalController.prototype.getMapsView=function(){if(!this._mapsView){this._mapsView=new YahooMaps(appCtxt.getShell(),this)
}return this._mapsView
};
YahooLocalController.prototype.setView=function(A){this._initializeToolBar();
this._toolbar.enableAll(true);
this._createMapView(A);
this.showView(A)
};
YahooLocalController.prototype.showView=function(A){this._mapsView.prepareMap(A);
appCtxt.getAppViewMgr().pushView(ZmId.VIEW_YMAPS);
appCtxt.getAppViewMgr()._fitToContainer([ZmAppViewMgr.C_APP_CONTENT])
};
YahooLocalController.prototype.hideView=function(){appCtxt.getAppViewMgr().popView(true,ZmId.VIEW_YMAPS)
};
YahooLocalController.prototype._createView=function(){var A={};
A[ZmAppViewMgr.C_TOOLBAR_TOP]=this._toolbar;
A[ZmAppViewMgr.C_APP_CONTENT]=this._mapsView;
appCtxt.getAppViewMgr().createView({viewId:ZmId.VIEW_YMAPS,elements:A})
};
YahooLocalController.prototype._createMapView=function(A){if(this._mapsView){return 
}this.getMapsView();
this._createView()
};
YahooLocalController.prototype._initializeToolBar=function(){if(this._toolbar){return 
}var D=[ZmOperation.SEND,ZmOperation.UPCOMING,ZmOperation.TRAFFIC,ZmOperation.SEARCH,ZmOperation.CANCEL];
this._toolbar=new ZmButtonToolBar({parent:appCtxt.getShell(),buttons:D,className:"ZmAppToolBar ImgSkin_Toolbar"});
for(var C=0;
C<this._toolbar.opList.length;
C++){var B=this._toolbar.opList[C];
if(B==ZmOperation.UPCOMING){var A=this._toolbar.getOp(B);
A.setText(this._zimlet.getMessage("menuItemUpcoming"));
A.setToolTipContent(this._zimlet.getMessage("upcomingTooltip"))
}else{if(B==ZmOperation.TRAFFIC){var A=this._toolbar.getOp(B);
A.setText(this._zimlet.getMessage("menuItemTraffic"));
A.setToolTipContent(this._zimlet.getMessage("trafficTooltip"))
}}if(this._listeners[B]){this._toolbar.addSelectionListener(B,this._listeners[B])
}}};
YahooLocalController.prototype._showInputDialog=function(E,D,C){if(!this._inputDialog){this._inputDialog=new ZmDialog({parent:appCtxt.getShell()});
var B=[];
var A=0;
B[A++]="<table cellpadding=2 cellspacing=2><tr><td class='ZmFieldLabelRight' id='";
B[A++]=this._inputDialog._htmlElId;
B[A++]="_label'></td><td><input type='text' size=20 maxlength=255 id='";
B[A++]=this._inputDialog._htmlElId;
B[A++]="_input'></td></tr></table>";
this._inputDialog.setContent(B.join(""));
this._inputEl=document.getElementById(this._inputDialog._htmlElId+"_input");
this._inputLabel=document.getElementById(this._inputDialog._htmlElId+"_label")
}this._inputDialog.setTitle(E);
this._inputDialog.setButtonListener(DwtDialog.OK_BUTTON,C);
this._inputDialog.setEnterListener(C);
this._inputEl.value="";
this._inputLabel.innerHTML=D;
this._inputDialog.popup();
this._inputEl.focus()
};
YahooLocalController.prototype._setDefaultView=function(E,D){if(E==45&&D==45){zoomLevel=14
}else{zoomLevel=8
}var C=this.getLocal();
var H=this._zimlet.getUserProperty("latitude");
var B=this._zimlet.getUserProperty("longitude");
if((!H||!B)&&(!C||(C&&(!C.latitude||!C.longitude)))&&(!E&&!D)){var A=this._zimlet.getUserProperty("manuallocation");
if(!A||A.match(/false/i)){var F=this._zimlet.getMessage("maxMindError");
var G=new YLocalDialog(appCtxt._shell,null,this._zimlet,F,true);
G.popup();
return 
}}if(!C){this._zimlet._ylocal={countryCode:"",countryName:"",city:"",region:"",latitude:E||H,longitude:D||B};
C=this._zimlet._ylocal
}if(C){C.latitude=E||C.latitude;
C.longitude=D||C.longitude;
this.setView({clean:true,typeControl:true,panControl:false,zoomControl:"long",zoomLevel:zoomLevel,defaultLat:C.latitude,defaultLon:C.longitude})
}return C
};
YahooLocalController.prototype._getGeoIP=function(D){geoip_country_code=null;
var B="http://j.maxmind.com/app/geoip.js";
var C=new AjxCallback(this,this._handleGetIP,D);
var A=ZmZimletBase.PROXY+AjxStringUtil.urlComponentEncode(B);
AjxRpc.invoke(null,A,null,C,true,5000)
};
YahooLocalController.prototype._handleGetIP=function(callback,result){if(result&&result.success&&result.text){AjxPackage.eval(result.text)
}if(callback){callback.run()
}};
YahooLocalController.prototype._showErrorLoadingAPI=function(){var A=appCtxt.getMsgDialog();
var B=this._zimlet.getMessage("errorLoadingAPI");
A.setMessage(B,DwtMessageDialog.CRITICAL_STYLE);
A.popup()
};
YahooLocalController.prototype.selectLocation=function(A){this.messageDlg.popdown();
this._dlg_propertyEditor=new YLocalDialog(appCtxt._shell,null,this._zimlet,A);
this._dlg_propertyEditor.popup()
};
YahooLocalController.prototype._locateLocation=function(){var B=this._textObj1.getValue();
var A=this._textObj2.getValue();
this._zimlet.setUserProperty("latitude",B);
this._zimlet.setUserProperty("longitude",A);
this._curr_lat=B;
this._curr_lon=A;
this._zimlet._controller._dlg_propertyEditor.popdown();
this._zimlet._controller._handleSearchLocal()
};
YahooLocalController.prototype._getMessageDlg=function(A){this.messageDlg=new DwtDialog(appCtxt.getShell(),null,"Confirmation",[DwtDialog.OK_BUTTON]);
this.messageDlg.setContent(A);
return this.messageDlg
};
YahooLocalController.prototype._handleSearchListener=function(){var A=AjxStringUtil.trim(this._inputEl.value);
if(A.length){this._inputDialog.popdown();
this.searchLocal(A)
}};
YahooLocalController.prototype._handleSearchAddrListener=function(){var A=AjxStringUtil.trim(this._inputEl.value);
if(A.length){this._inputDialog.popdown();
this.displayAddress(A)
}};
YahooLocalController.prototype._handleChangeLocationListener=function(){var A=AjxStringUtil.trim(this._inputEl.value);
if(A.length){this._inputDialog.popdown();
this._getLatLonForZip(A)
}};
YahooLocalController.prototype._getLatLonForZip=function(D){var C=this._zimlet.getConfig("ydnAPPID");
var B=this._zimlet.getMessage("ygeoapiURL");
B+="?appid="+C+"&zip="+D;
var A=ZmZimletBase.PROXY+AjxStringUtil.urlComponentEncode(B);
var E=new AjxCallback(this,this._handleLatLonForZip,D);
AjxRpc.invoke(null,A,null,E,true,5000)
};
YahooLocalController.prototype._handleLatLonForZip=function(B,A){if(!A||(A&&!A.success)){var E=this._zimlet.getMessage("ygeoLocalError");
var F=new YLocalDialog(appCtxt._shell,null,this._zimlet,E,false);
F.popup();
return 
}if(A.text.match(/Error/i)){appCtxt.setStatusMsg(this._zimlet.getMessage("zipCodeInvalid"),ZmStatusView.LEVEL_CRITICAL);
return 
}var C=AjxStringUtil.trim((A.text.match(/<Latitude>.*(\-?[.\w]+)<\/Latitude>/ig))[0].replace(/<\/?[^>]+>|Latitude/gi,""));
var D=AjxStringUtil.trim((A.text.match(/<Longitude>.*(\-?[.\w]+)<\/Longitude>/ig))[0].replace(/<\/?[^>]+>|Longitude/gi,""));
if(!(C&&D)){appCtxt.setStatusMsg(this._zimlet.getMessage("coordsNotFound"),ZmStatusView.LEVEL_CRITICAL);
return 
}this.setLanLongAndChangeLocation(C,D,3)
};
YahooLocalController.prototype.setLanLongAndChangeLocation=function(D,A,C){var B={clean:true,typeControl:true,panControl:false,zoomControl:"long",zoomLevel:C||6,defaultLat:D,defaultLon:A};
this._zimlet._controller.setView(B);
this._zimlet._controller.getMapsView().changeLocation({latitude:D,longitude:A});
this._curr_lat=D;
this._curr_lon=A
};
YahooLocalController.prototype._sendListener=function(D){var F=this._mapsView.getState();
var B=["http://maps.yahoo.com/#tt=",F.query,"&lon=",F.lon,"&lat=",F.lat,"&mag=",F.zoom,"&mvt=m&tp=1"].join("");
var A=this._zimlet.getMessage("msgBody").replace("{0}",F.query?"("+F.query+")":"");
var H=this._zimlet.getMessage("msgFooter");
var C=this._zimlet.getMessage("msgSubject").replace("{0}",appCtxt.get(ZmSetting.USERNAME));
this._zimlet.getMessage("maxMindError");
if(appCtxt.get(ZmSetting.HTML_COMPOSE_ENABLED)&&appCtxt.get(ZmSetting.COMPOSE_AS_FORMAT)==ZmSetting.COMPOSE_HTML){A=AjxStringUtil.nl2br(A);
H=AjxStringUtil.nl2br(H)
}var E={action:ZmOperation.NEW_MESSAGE,subjOverride:C,extraBodyText:(A+B+H),inNewWindow:appCtxt.get(ZmSetting.NEW_WINDOW_COMPOSE)};
var G=AjxDispatcher.run("GetComposeController");
G.doAction(E)
};
YahooLocalController.prototype._upcomingListener=function(A){this.searchUpcoming()
};
YahooLocalController.prototype._trafficListener=function(A){this.searchTraffic()
};
YahooLocalController.prototype._cancelListener=function(A){this.hideView()
};
YahooMaps=function(B,A){if(arguments.length==0){return 
}DwtComposite.call(this,{parent:B,className:"YahooMap",posStyle:Dwt.ABSOLUTE_STYLE,id:"YahooMap"});
this._controller=A;
this.getMap();
this.addSearchLocalListener();
this.addTrafficSearchListener()
};
YahooMaps.prototype=new DwtComposite;
YahooMaps.prototype.constructor=new YahooMaps;
YahooMaps.APPID="ZimbraMail";
YahooMaps.VERSION="3.7";
YahooMaps.DEFAULT_ZOOMLEVEL=5;
YahooMaps.QUERY_RESULTS=10;
YahooMaps.DEFAULT_TRAFFICRADIUS=10;
YahooMaps.LOC_MARKER_IMAGE="http://us.i1.yimg.com/us.yimg.com/i/us/tr/fc/map/nightlife_bubble_w.png";
YahooMaps.prototype.prepareMap=function(C){var B=this.getMap();
if(C.clean){B.removeMarkersAll()
}if(C.panControl){B.addPanControl()
}else{B.addPanControl();
B.removePanControl()
}if(C.zoomControl){if(C.zoomControl=="long"){B.addZoomLong()
}else{B.addZoomShort()
}}else{B.removeZoomControl()
}if(C.zoomScale){B.addZoomScale()
}else{B.removeZoomScale()
}if(C.typeControl){B.addTypeControl()
}if(C.defaultLat&&C.defaultLon){var A=this.getGeoPoint(C.defaultLat,C.defaultLon);
B.drawZoomAndCenter(A);
this.setLocMarker(C.defaultLat,C.defaultLon,"You are here.",YahooMaps.LOC_MARKER_IMAGE)
}else{if(C.defaultLocation){B.drawZoomAndCenter(C.defaultLocation)
}}B.setZoomLevel(C.zoomLevel||YahooMaps.DEFAULT_ZOOMLEVEL)
};
YahooMaps.prototype.searchLocal=function(C){if(!C.query){return 
}var B=this.getMap();
var A=(C.defaultLat&&C.defaultLon)?this.getGeoPoint(C.defaultLat,C.defaultLon):B.getCenterLatLon();
C.radius=C.radius||YahooMaps.DEFAULT_RADIUS;
C.nresults=C.nresults||YahooMaps.QUERY_RESULTS;
B.searchLocal(A,C.query,C.radius,C.nresults);
this._searchQuery=C.query;
this._searchLat=C.defaultLat;
this._searchLon=C.defaultLon
};
YahooMaps.prototype.addSearchLocalListener=function(){var A=this;
function B(F){if(!F.Data){return 
}var H=A.getMap();
for(var E in F.Data.ITEMS){var D=F.Data.ITEMS[E];
if(D.TITLE){var G=A.constructLocalResult(D);
var C=A.getMarker(A.getGeoPoint(D.LATITUDE,D.LONGITUDE),G);
H.addOverlay(C)
}}}YEvent.Capture(this.getMap(),EventsList.onEndLocalSearch,B)
};
YahooMaps.prototype.constructLocalResult=function(B){var C=[];
var A=0;
C[A++]="<div class='YMapAddress'>";
C[A++]="<div style='font-weight:bold;'><a target='_blank' href='";
C[A++]=B.BUSINESSURL;
C[A++]="'>";
C[A++]=B.TITLE;
C[A++]="</a></div>";
C[A++]="<div style='font-style:italic;'>";
C[A++]=B.ADDRESS;
C[A++]=",";
C[A++]=B.CITY;
C[A++]=",";
C[A++]=B.STATE;
C[A++]="</div>";
if(B.PHONE){C[A++]="<div><img width='16' hight='16' src='";
C[A++]=this.getResource("phone.gif");
C[A++]="'>";
C[A++]=B.PHONE;
C[A++]="</div>"
}C[A++]="<div>";
C[A++]=B.DISTANCE;
C[A++]=" miles away!</div>";
var D=B.RATING.AVERAGERATING;
if(!isNaN(D)){C[A++]="<div>";
var E=1;
while(E<=D){C[A++]="<img width='16' height='16' src='";
C[A++]=this.getResource("star_on.gif");
C[A++]="'>";
E++
}while(E<=5){C[A++]="<img width='16' height='16' src='";
C[A++]=this.getResource("star_off.gif");
C[A++]="'>";
E++
}C[A++]="</div>"
}var F=B.TITLE.replace("'","");
var G=B.ADDRESS.replace("'","");
C[A++]='<div><a href="#" onclick="YahooMaps._addContact({';
C[A++]=" title:'";
C[A++]=F;
C[A++]="', addr:'";
C[A++]=G;
C[A++]="', city:'";
C[A++]=B.CITY;
C[A++]="', state:'";
C[A++]=B.STATE;
C[A++]="', phone:'";
C[A++]=B.PHONE;
C[A++]="', bizurl:'";
C[A++]=B.BUSINESSURL;
C[A++]="', url:'";
C[A++]=B.URL;
C[A++]="'});\">+Contact</a>";
if(appCtxt.getZimletMgr().zimletExists("com_zimbra_asterisk")){C[A++]="&nbsp;|&nbsp;<a href='#' onclick=\"YahooMaps._phoneCall('";
C[A++]=B.PHONE;
C[A++]="');\">Call</a>"
}if(appCtxt.getZimletMgr().zimletExists("com_zimbra_sms")){C[A++]="&nbsp;|&nbsp;<a href='#' onclick=\"YahooMaps._sendSMS({";
C[A++]=" title:'";
C[A++]=F;
C[A++]="', addr:'";
C[A++]=G;
C[A++]="', city:'";
C[A++]=B.CITY;
C[A++]="', state:'";
C[A++]=B.STATE;
C[A++]="', phone:'";
C[A++]=B.PHONE;
C[A++]="', bizurl:'";
C[A++]=B.BUSINESSURL;
C[A++]="', url:'";
C[A++]=B.URL;
C[A++]="'});\">SMS</a>"
}C[A++]='&nbsp;|&nbsp;<a href="#" onclick="YahooMaps._sendLocalResult({';
C[A++]=" title:'";
C[A++]=F;
C[A++]="', addr:'";
C[A++]=G;
C[A++]="', city:'";
C[A++]=B.CITY;
C[A++]="', state:'";
C[A++]=B.STATE;
C[A++]="', phone:'";
C[A++]=B.PHONE;
C[A++]="', bizurl:'";
C[A++]=B.BUSINESSURL;
C[A++]="', url:'";
C[A++]=B.URL;
C[A++]="'});\">Email</a>";
C[A++]="</div>";
C[A++]="<div><a href='"+B.URL+"' target='_blank'>more >></a></div>";
C[A++]="</div>";
return C.join("")
};
YahooMaps._sendLocalResult=function(D){var B=appCtxt.get(ZmSetting.USERNAME)+" shared an address using Yahoo! Local";
var C=[D.title,"\n",D.addr,"\n",D.city,",",D.state,"\n","Phone:",D.phone,"\n","Business URL:",D.bizurl,"\n","For Reviews & more info view ",D.url,"\n"].join("");
var A=C+"\n\n\n\nThis email was sent to you by a user on Yahoo Local (local.yahoo.com).";
if(appCtxt.get(ZmSetting.HTML_COMPOSE_ENABLED)&&appCtxt.get(ZmSetting.COMPOSE_AS_FORMAT)==ZmSetting.COMPOSE_HTML){A=AjxStringUtil.nl2br(A)
}var D={action:ZmOperation.NEW_MESSAGE,subjOverride:B,extraBodyText:A};
var E=AjxDispatcher.run("GetComposeController");
E.doAction(D)
};
YahooMaps._sendSMS=function(D){var C=appCtxt.getZimletMgr().getZimletsHash();
var B=C?C.com_zimbra_sms:null;
if(B){var A=[D.title,"\n",D.addr,"\n",D.city,",",D.state,"\n","Phone:",D.phone,"\n","Business URL:",D.bizurl,"\n","For Reviews & more info view ",D.url,"\n"].join("");
A=A+"\n\nYahoo! Local (local.yahoo.com)";
B.callHandler("singleClicked",[D.phone,A])
}};
YahooMaps._phoneCall=function(A){var C=appCtxt.getZimletMgr().getZimletsHash();
var B=C?C.com_zimbra_asterisk:null;
if(B){B.callHandler("setupCall",[A])
}};
YahooMaps._addContact=function(B){var A=new AjxCallback(YahooMaps._handleLoadContact,B);
AjxDispatcher.require(["ContactsCore","Contacts"],false,A,null,true)
};
YahooMaps._handleLoadContact=function(B){var A=new ZmContact();
if(B.title){A.setAttr(ZmContact.F_firstName,B.title);
A.setAttr(ZmContact.F_company,B.title)
}if(B.addr){A.setAttr(ZmContact.F_workStreet,B.addr)
}if(B.city){A.setAttr(ZmContact.F_workCity,B.city)
}if(B.state){A.setAttr(ZmContact.F_workCountry,B.state)
}if(B.phone){A.setAttr(ZmContact.F_workPhone,B.phone)
}if(B.bizurl){A.setAttr(ZmContact.F_workURL,B.bizurl)
}AjxDispatcher.run("GetContactController").show(A)
};
YahooMaps.prototype.getState=function(){return{query:this._searchQuery,lat:this._searchLat,lon:this._searchLon,zoom:YahooMaps.DEFAULT_ZOOMLEVEL}
};
YahooMaps.prototype.searchUpcoming=function(A){A.callback=new AjxCallback(this,this._processUpcomingResponse);
this.getUpcoming().searchEvents(A)
};
YahooMaps.prototype._processUpcomingResponse=function(D){if(!D){return 
}var F=this.getMap();
for(var C=0;
C<D.length;
C++){var E=D[C];
if(E.name){var B=this._constructEventResult(E);
var A=this.getMarker(this.getGeoPoint(E.latitude,E.longitude),B);
F.addOverlay(A)
}}};
YahooMaps.prototype._constructEventResult=function(D){var C=[];
var A=0;
C[A++]="<div class='YMapAddress'>";
C[A++]="<div style='font-weight:bold;'><a href='"+D.url+"' target='_blank'>"+D.name+"</a></div>";
C[A++]="<div style='font-weight:italic;'> When:"+D.start_date+","+D.start_time+" </div>";
C[A++]="<div style='font-weight:italic;'>Venue: "+D.venue_name+"</div>";
C[A++]="<div style='font-style:italic;'>"+D.venue_address+","+D.venue_city+","+D.venue_state_name+"</div>";
C[A++]="<div>"+D.distance+" miles away!</div";
var B=D.name.replace("'","");
var E=D.venue_address.replace("'","");
C[A++]='<div><a href="#" onclick="YahooMaps._addAppt({name:\''+B+"',addr:'"+E+"',city:'"+D.venue_city+"',state:'"+D.venue_state_name+"',startdate:'"+D.start_date+"',starttime:'"+D.start_time+"',enddate:'"+D.end_date+"',endtime:'"+D.end_time+"',bizurl:'"+D.url+"',url:'http://upcoming.yahoo.com/event/"+D.id+"/'});\">+Calendar</a>";
C[A++]='&nbsp;|&nbsp;<a href="#" onclick="YahooMaps._sendEvent({name:\''+B+"',addr:'"+E+"',city:'"+D.venue_city+"',state:'"+D.venue_state_name+"',startdate:'"+D.start_date+"',starttime:'"+D.start_time+"',enddate:'"+D.end_date+"',endtime:'"+D.end_time+"',bizurl:'"+D.url+"',url:'http://upcoming.yahoo.com/event/"+D.id+"/'});\">Email</a>";
C[A++]="</div>";
C[A++]="<div><a target='_blank' href='http://upcoming.yahoo.com/event/"+D.id+"/'>more >></a></div>";
C[A++]="</div>";
return C.join("")
};
YahooMaps._addAppt=function(D){var C=AjxDispatcher.run("GetApptComposeController");
var B=new ZmAppt();
B.setName(D.name);
var F=YahooMaps._isValidTime(D.starttime);
var A=YahooMaps._isValidTime(D.starttEnd);
if(F){B.setStartDate(YahooMaps._parseDate(D.startdate,D.starttime))
}else{B.setStartDate(YahooMaps._parseDate(D.startdate))
}if(!A&&F&&(D.startdate==D.enddate||!D.enddate)){B.setEndDate(YahooMaps._parseDate(D.startdate,D.starttime,1))
}else{if(!(A&&F)){B.setEndDate(YahooMaps._parseDate(D.enddate))
}else{B.setEndDate(YahooMaps._parseDate(D.enddate,D.starttime,1))
}}var E=["Direction:\n\n",D.addr,"\n",D.city,",",D.state,"\n\nBusiness URL:",D.bizurl,"\n","For reviews & more info visit ",D.url,"\n"].join("");
B.setTextNotes((D.description||"")+E);
C.show(B)
};
YahooMaps._parseDate=function(C,D,A){if(C){var B=C.split("-")
}if(D){var E=D.split(":")
}if(E&&A){return(new Date(B[0],B[1]-1,B[2],parseInt(E[0])+A,E[1],E[2]))
}else{if(E&&!A){return(new Date(B[0],B[1]-1,B[2],E[0],E[1],E[2]))
}else{if(C){return(new Date(B[0],B[1]-1,B[2]))
}}}return null
};
YahooMaps._isValidTime=function(A){if(A){return A.split(":").length>1?true:false
}return false
};
YahooMaps._sendEvent=function(D){var A=appCtxt.get(ZmSetting.USERNAME)+" shared an event using Yahoo! Local";
var B=[D.name,"\n",D.addr,"\n",D.city,",",D.state,"\n","Business URL:",D.bizurl,"\n","For Reviews & more info view ",D.url,"\n"].join("");
var F="\n\nThis email was sent to you by a user on Upcoming (upcoming.com).";
var C="Hi,\n\n"+B+F;
if(appCtxt.get(ZmSetting.HTML_COMPOSE_ENABLED)&&appCtxt.get(ZmSetting.COMPOSE_AS_FORMAT)==ZmSetting.COMPOSE_HTML){C=AjxStringUtil.nl2br(C)
}var D={action:ZmOperation.NEW_MESSAGE,subjOverride:A,extraBodyText:C};
var E=AjxDispatcher.run("GetComposeController");
E.doAction(D)
};
YahooMaps.prototype.addTrafficSearchListener=function(){var A=this;
function B(F){if(!F.Data){return 
}var G=A.getMap();
for(a in F.Data.ITEMS){var D=F.Data.ITEMS[a];
if(D.TITLE){var E=A._constructTrafficResult(D);
var C=A.getMarker(A.getGeoPoint(D.LATITUDE,D.LONGITUDE),E);
G.addOverlay(C)
}}}YEvent.Capture(this.getMap(),EventsList.onEndTrafficSearch,B)
};
YahooMaps.prototype._constructTrafficResult=function(B){var C=[];
var A=0;
C[A++]="<div>";
C[A++]=B.TITLE;
C[A++]="</div>";
C[A++]='<div><a href="#" onclick="YahooMaps._sendTrafficResult({';
C[A++]=" title:'";
C[A++]=B.TITLE.replace("'","");
C[A++]="'";
C[A++]='});">Email</a>';
C[A++]="</div>";
return C.join("")
};
YahooMaps._sendTrafficResult=function(C){var A=appCtxt.get(ZmSetting.USERNAME)+" shared a traffic info. using Yahoo! Local";
var B=C.title;
if(appCtxt.get(ZmSetting.HTML_COMPOSE_ENABLED)&&appCtxt.get(ZmSetting.COMPOSE_AS_FORMAT)==ZmSetting.COMPOSE_HTML){B=AjxStringUtil.nl2br(B)
}var C={action:ZmOperation.NEW_MESSAGE,subjOverride:A,extraBodyText:B};
var D=AjxDispatcher.run("GetComposeController");
D.doAction(C)
};
YahooMaps.prototype.searchTraffic=function(C){var B=this.getMap();
var A=this.getGeoPoint(C.latitude,C.longitude);
C.radius=C.radius||YahooMaps.DEFAULT_TRAFFICRADIUS;
B.searchTraffic(A,C.radius)
};
YahooMaps.prototype.changeLocation=function(C){if(C.latitude&&C.longitude){this.setLocMarker(C.latitude,C.longitude,"<b>You are here!</b><br>Please select your new location to make it your default location",YahooMaps.LOC_MARKER_IMAGE);
YEvent.Capture(this.getMap(),EventsList.MouseClick,B)
}var A=this;
function B(D,F){A.getMap().removeMarkersAll();
var E=A.setLocMarker(F.Lat,F.Lon,"<b>Click here to make this your default location.</b><br>Or, Please select a new location.",YahooMaps.LOC_MARKER_IMAGE);
YEvent.Capture(E,EventsList.MouseClick,G);
function G(I,H){YEvent.Remove(A.getMap(),EventsList.MouseClick,B);
A._controller.setLocation(F.Lat,F.Lon);
A.markMe(F.Lat,F.Lon)
}}if(C.newLatitude&&C.newLongitude){B(null,{Lat:C.newLatitude,Lon:C.newLongitude})
}};
YahooMaps.prototype.markMe=function(A,B){this.setLocMarker(A,B,"You are here!",YahooMaps.LOC_MARKER_IMAGE)
};
YahooMaps.prototype.markAddr=function(C){this.getMap().drawZoomAndCenter(C.defaultLocation);
var B=this.getMap().getCenterLatLon();
var A=this.getMarker(this.getGeoPoint(B.LAT,B.LON),C.defaultLocation);
this.getMap().addOverlay(A)
};
YahooMaps.prototype.getMap=function(){if(!this._map){try{this._map=new YMap(this.getHtmlElement())
}catch(A){alert("Unable to load map. YMap missing.");
return 
}}return this._map
};
YahooMaps.prototype.getGeoPoint=function(A,B){return(new YGeoPoint(A,B))
};
YahooMaps.prototype.getMarker=function(B,E,D){var A=new YMarker(B);
if(D){var C=new YImage();
D=ZmZimletBase.PROXY+AjxStringUtil.urlComponentEncode(D);
C.src=D;
A.changeImage(C)
}A.addAutoExpand(E);
return A
};
YahooMaps.prototype.getUpcoming=function(){if(!this._upcoming){this._upcoming=new UpComingEvents()
}return this._upcoming
};
YahooMaps.prototype.setLocMarker=function(C,E,D,B){var A=this.getMarker(this.getGeoPoint(C,E),D,B);
this.getMap().addOverlay(A);
return A
};
YahooMaps.prototype.mark=function(B){var A=this.getMarker(this.getGeoPoint(B.latitude,B.longitude),B.text||"",B.imgsrc);
this.getMap().addOverlay(A);
return A
};
YahooMaps.prototype.getResource=function(A){return this._controller._zimlet.getResource(A)
};
YahooMaps._loadYAPI=function(A){var B=document.createElement("script");
B.setAttribute("type","text/javascript");
B.setAttribute("src",(ZmZimletBase.PROXY+AjxStringUtil.urlComponentEncode(A)));
if(AjxEnv.isSafari||AjxEnv.isWebKitBased){document.body.appendChild(B)
}else{document.getElementsByTagName("head").item(0).appendChild(B)
}};
YahooMaps._loadYMapsAPI=function(B){var C=new AjxCallback(YahooMaps._postLoadYMapsAPI);
var A=ZmZimletBase.PROXY+AjxStringUtil.urlComponentEncode(B);
AjxRpc.invoke(null,A,null,C,true)
};
YahooMaps._postLoadYMapsAPI=function(result){var js=result.text;
js=js.replace(/<!--.*-->/,"")+"function _ywjs(inc){YahooMaps._loadYAPI(inc)};";
try{AjxPackage.eval(js)
}catch(ex){alert("Failed to load Yahoo! Maps API.")
}};
YahooMaps.loadExternalResources=function(){YahooMaps._loadYMapsAPI("http://api.maps.yahoo.com/ajaxymap?v="+YahooMaps.VERSION+"&appid="+YahooMaps.APPID)
};
UpComingEvents=function(){};
UpComingEvents.DEFAULT_RADIUS=50;
UpComingEvents.prototype.searchEvents=function(F){var B=["api_key=ae7d801cfb&method=event.search"];
if(F.query){B.push("search_text="+F.query)
}if(F.latitude&&F.longitude){B.push("location="+F.latitude+","+F.longitude)
}B.push("radius="+(F.radius||UpComingEvents.DEFAULT_RADIUS));
if(F.mindate){B.push("min_date="+F.mindate)
}else{var D=new Date();
var E=["min_date=",D.getFullYear(),"-",(D.getMonth()<9)?("0"+(D.getMonth()+1)):(D.getMonth()+1),"-",(D.getDate()<10)?("0"+D.getDate()):(D.getDate())];
B.push(E.join(""))
}if(F.page){B.push("page="+F.page)
}var C="http://upcoming.yahooapis.com/services/rest/?"+B.join("&");
var A=ZmZimletBase.PROXY+AjxStringUtil.urlComponentEncode(C);
var G=new AjxCallback(this,this._processSearchEventsResponse,F.callback);
AjxRpc.invoke(B,A,null,G,true)
};
UpComingEvents.prototype._processSearchEventsResponse=function(C,A){var B=this.xmlToObject(A).event;
B=B.length?B:[B];
if(C){C.run(B)
}};
UpComingEvents.prototype.xmlToObject=function(A){try{var C=new AjxXmlDoc.createFromDom(A.xml).toJSObject(true,false,true)
}catch(B){}return C
};
YLocalDialog=function(B,D,C,F,A){D=D||"YSymbolsDialog";
this._zimlet=C;
var E="Select Option";
DwtDialog.call(this,{parent:B,className:D,title:E});
this._createSearchHtml(F,A)
};
YLocalDialog.prototype=new DwtDialog;
YLocalDialog.prototype.constructor=YLocalDialog;
YLocalDialog.prototype._lookupCallback;
YLocalDialog.prototype._createSearchHtml=function(G,C){this._textObj1=new DwtInputField(this);
this._textObj2=new DwtInputField(this);
this._lableObj=new DwtButton(this);
var D=document.createElement("TABLE");
D.border=0;
D.cellPadding=0;
D.cellSpacing=4;
var F;
var A;
if(G){F=D.insertRow(-1);
A=F.insertCell(-1);
A.colSpan=2;
A.innerHTML=G;
F=D.insertRow(-1);
A=F.insertCell(-1);
A.colSpan=2;
A.align="center";
A.innerHTML="<hr>"
}if(C){this._textZip=new DwtInputField(this);
F=D.insertRow(-1);
A=F.insertCell(-1);
A.innerHTML="Zip:";
A=F.insertCell(-1);
A.appendChild(this._textZip.getHtmlElement());
F=D.insertRow(-1);
A=F.insertCell(-1);
A.colSpan=2;
A.align="center";
A.innerHTML="<b>or</b>"
}F=D.insertRow(-1);
A=F.insertCell(-1);
A.colSpan=2;
A.innerHTML="Enter Latitude and Longitude";
F=D.insertRow(-1);
A=F.insertCell(-1);
A.innerHTML="Latitude:";
A=F.insertCell(-1);
A.appendChild(this._textObj1.getHtmlElement());
F=D.insertRow(-1);
A=F.insertCell(-1);
A.innerHTML="Longitude:";
A=F.insertCell(-1);
A.appendChild(this._textObj2.getHtmlElement());
F=D.insertRow(-1);
A=F.insertCell(-1);
A.colSpan=2;
A.align="center";
A.innerHTML="<b>or</b>";
F=D.insertRow(-1);
A=F.insertCell(-1);
A.colSpan=2;
var E={latitude:45,longitude:45};
A.appendChild(this._lableObj.getHtmlElement());
YLocalDialog.gInstance=this;
A.innerHTML="<a href='#' onclick='changeLocation()'>Click here</a> to select location on map";
var B=this._getContentDiv();
B.appendChild(D)
};
YLocalDialog.gInstance;
changeLocation=function(){var A=YLocalDialog.gInstance;
A.popdown();
A._zimlet._controller.changeLocation({latitude:45,longitude:45})
};
YLocalDialog.prototype.changeLocationByZip=function(){var B=AjxStringUtil.trim((result.text.match(/<td><b>Latitude<\/b><\/td><td>.*(\-?[.\w]+)<\/td>/ig))[0].replace(/<\/?[^>]+>|Latitude/gi,""));
var C=AjxStringUtil.trim((result.text.match(/<td><b>Longitude<\/b><\/td><td>.*(\-?[.\w]+)<\/td>/ig))[0].replace(/<\/?[^>]+>|Longitude/gi,""));
if(!(B&&C)){appCtxt.setStatusMsg(this._zimlet.getMessage("coordsNotFound"),ZmStatusView.LEVEL_CRITICAL);
return 
}var A=this.getLocal();
this.setView({clean:true,typeControl:true,panControl:false,zoomControl:"long",zoomLevel:3,defaultLat:B,defaultLon:C});
this.getMapsView().changeLocation({latitude:A.latitude,longitude:A.longitude,newLatitude:B,newLongitude:C})
};
YLocalDialog.prototype.popup=function(A,B){this._lookupCallback=B;
this.setTitle("Select Option");
this.setButtonListener(DwtDialog.OK_BUTTON,new AjxListener(this,this.okButtonListener));
this.setButtonEnabled(DwtDialog.OK_BUTTON,true);
this.setButtonEnabled(DwtDialog.CANCEL_BUTTON,true);
DwtDialog.prototype.popup.call(this)
};
YLocalDialog.prototype.popdown=function(){ZmDialog.prototype.popdown.call(this)
};
YLocalDialog.prototype.okButtonListener=function(){if(this._textZip&&this._textZip.getValue()!=""){this._zimlet._controller._getLatLonForZip(this._textZip.getValue())
}else{this._zimlet._controller.setLanLongAndChangeLocation(this._textObj1.getValue(),this._textObj2.getValue())
}DwtDialog.prototype.popdown.call(this)
};
function Com_Zimbra_YMEmoticons(){this.re=Com_Zimbra_YMEmoticons.REGEXP;
this.hash=Com_Zimbra_YMEmoticons.SMILEYS;
this._isEnabled=true
}Com_Zimbra_YMEmoticons.prototype=new ZmZimletBase;
Com_Zimbra_YMEmoticons.prototype.constructor=Com_Zimbra_YMEmoticons;
Com_Zimbra_YMEmoticons.prototype.createComposeButton=function(B){var C=B.parent;
var A=new YMEmoticonsPickerButton({parent:B,className:"ZToolbarButton"},true);
A.dontStealFocus();
A.setToolTipContent(ZmMsg.emoticons);
A.setEmoticon(":)");
A.addSelectionListener(new AjxListener(this,this._composeToolbarSmileyListener,[C]))
};
Com_Zimbra_YMEmoticons.prototype.on_htmlEditor_createToolbar2=function(B,A){this.createComposeButton(A)
};
Com_Zimbra_YMEmoticons.prototype.onFindMsgObjects=function(B,A){if(!this.enableInMail){this.enableInMail=Boolean(this.getUserProperty("yemoticons_enableInMail"))
}if(B.folderId==ZmOrganizer.ID_CHATS){A.addHandler(this);
A.sortHandlers();
A.__hasSmileysHandler=true
}else{if(!A.__hasSmileysHandler&&this._isEnabled&&this.enableInMail){A.addHandler(this);
A.sortHandlers();
A.__hasSmileysHandler=true
}if(A.__hasSmileysHandler&&(!this._isEnabled||!this.enableInMail)){A.removeHandler(this);
A.sortHandlers();
A.__hasSmileysHandler=false
}}};
Com_Zimbra_YMEmoticons.prototype.match=function(B,D){this.re.lastIndex=D;
var A=this.re.exec(B);
if(A){A.context=this.hash[A[1].toLowerCase()];
var C=new Image();
C.src=A.context.src;
A.context.img=C
}return A
};
Com_Zimbra_YMEmoticons.prototype.generateSpan=function(C,A,F,E,B){var D=B.height/2;
C[A++]=["<span style='height:",B.height,";width:",B.width,";padding:",D,"px ",B.width,"px ",D,"px 0; background:url(",B.img.src,") no-repeat 0 50%;'",' title="',AjxStringUtil.xmlAttrEncode(B.text)," - ",AjxStringUtil.xmlAttrEncode(B.alt),'"',"></span>"].join("");
return A
};
Com_Zimbra_YMEmoticons.prototype.onNewChatWidget=function(D){var C=D.getObjectManager();
C.addHandler(this);
C.sortHandlers();
var A=D.getEditor().getBasicToolBar();
var B=new YMEmoticonsPickerButton({parent:A,className:"ZToolbarButton",index:0});

B.dontStealFocus();
B.setToolTipContent(ZmMsg.emoticons);
B.setData(ZmLiteHtmlEditor._VALUE,ZmLiteHtmlEditor.SMILEY);
B.setEmoticon(":)");
B.addSelectionListener(new AjxListener(this,this._smileyListener,[D]));
A.addSeparator(null,1)
};
Com_Zimbra_YMEmoticons.prototype._smileyListener=function(B,A){this._composeToolbarSmileyListener(B.getEditor(),A)
};
Com_Zimbra_YMEmoticons.prototype._composeToolbarSmileyListener=function(A,C){if(!A){return 
}var B=C.item.getSelectedSmiley();
if(B){A.insertText(B.text);
A.focus()
}};
Com_Zimbra_YMEmoticons.prototype.menuItemSelected=function(A){switch(A){case"YE_TEMP_DISABLE":this.temporarilyDisable();
break;
case"YE_PREFERENCES":this._showPreferenceDlg();
break
}};
Com_Zimbra_YMEmoticons.prototype.doubleClicked=function(){this.singleClicked()
};
Com_Zimbra_YMEmoticons.prototype.singleClicked=function(){this._showPreferenceDlg()
};
Com_Zimbra_YMEmoticons.prototype.temporarilyDisable=function(){this._isEnabled=false;
var A=[ZmToast.FADE_IN,ZmToast.PAUSE,ZmToast.FADE_OUT];
appCtxt.getAppController().setStatusMsg("Emoticons Temporarily Disabled",ZmStatusView.LEVEL_INFO,null,A)
};
Com_Zimbra_YMEmoticons.prototype._showPreferenceDlg=function(){if(this._preferenceDialog){this._preferenceDialog.popup();
return 
}this._preferenceView=new DwtComposite(this.getShell());
this._preferenceView.getHtmlElement().style.overflow="auto";
this._preferenceView.getHtmlElement().innerHTML=this._createPrefView();
this._preferenceDialog=this._createDialog({title:"Yahoo! Emoticons Preferences",view:this._preferenceView,standardButtons:[DwtDialog.OK_BUTTON]});
this._preferenceDialog.setButtonListener(DwtDialog.OK_BUTTON,new AjxListener(this,this._okPreferenceBtnListener));
if(!this.enableInMail){this.enableInMail=Boolean(this.getUserProperty("yemoticons_enableInMail"))
}document.getElementById("yemoticons_enableInMail_div").checked=this.enableInMail;
this._preferenceDialog.popup()
};
Com_Zimbra_YMEmoticons.prototype._createPrefView=function(){return["<div class='ymemoticonsPrefDialog'>","<input id='yemoticons_enableInMail_div' type='checkbox'/>Enable Emoticons In Mail","</div>"].join("")
};
Com_Zimbra_YMEmoticons.prototype._okPreferenceBtnListener=function(){this._preferenceDialog.popdown();
var B=document.getElementById("yemoticons_enableInMail_div").checked;
if(B!=this.enableInMail){this.setUserProperty("yemoticons_enableInMail",B,true);
this.enableInMail=B;
var A=B?"Enabled":"Disabled";
var C=[ZmToast.FADE_IN,ZmToast.PAUSE,ZmToast.FADE_OUT];
appCtxt.getAppController().setStatusMsg(["Emoticons ",A," In Mail"].join(""),ZmStatusView.LEVEL_INFO,null,C)
}};
Com_Zimbra_YMEmoticons.REGEXP=/(>:D<|#:-S|O:-\)|<:-P|:-SS|<\):\)|:-\?\?|3:-O|:\(\|\)|@};-|\*\*==|\(~~\)|\*-:\)|\[-O<|:\)>-|\\:D\x2f|\^:\)\^|;;\)|:-\x2f|:\x22>|:-\*|=\(\(|:-O|B-\)|:-S|>:\)|:\(\(|:\)\)|\x2f:\)|=\)\)|:-B|:-c|:\)\]|~X\(|:-h|:-t|8->|I-\)|8-\||L-\)|:-&|:-\$|\[-\(|:O\)|8-}|\(:\||=P~|:-\?|#-o|=D>|@-\)|:\^o|:-w|:-<|>:P|:o3|%-\(|:@\)|~:>|%%-|~O\)|8-X|=:\)|>-\)|:-L|\$-\)|:-\x22|b-\(|\[-X|>:\x2f|;\)\)|:-@|:-j|\(\*\)|o->|o=>|o-\+|\(%\)|:\)|:\(|;\)|:D|:x|:P|X\(|:>|:\||=;)/ig;
Com_Zimbra_YMEmoticons.SMILEYS={":)":{width:18,alt:"happy",src:"/service/zimlet/com_zimbra_ymemoticons/img/1.gif",text:":)",regexp:":\\)",height:18},":(":{width:18,alt:"sad",src:"/service/zimlet/com_zimbra_ymemoticons/img/2.gif",text:":(",regexp:":\\(",height:18},"(~~)":{width:17,alt:"pumpkin",src:"/service/zimlet/com_zimbra_ymemoticons/img/56.gif",text:"(~~)",regexp:"\\(~~\\)",height:18},"~o)":{width:18,alt:"coffee",src:"/service/zimlet/com_zimbra_ymemoticons/img/57.gif",text:"~O)",regexp:"~O\\)",height:18},':">':{width:18,alt:"blushing",src:"/service/zimlet/com_zimbra_ymemoticons/img/9.gif",text:':">',regexp:":\\x22>",height:18},"[-(":{width:18,alt:"not talking",src:"/service/zimlet/com_zimbra_ymemoticons/img/33.gif",text:"[-(",regexp:"\\[-\\(",height:18},">:d<":{width:42,alt:"big hug",src:"/service/zimlet/com_zimbra_ymemoticons/img/6.gif",text:">:D<",regexp:">:D<",height:18},"#-o":{width:24,alt:"d'oh",src:"/service/zimlet/com_zimbra_ymemoticons/img/40.gif",text:"#-o",regexp:"#-o",height:18},"[-x":{width:22,alt:"shame on you",src:"/service/zimlet/com_zimbra_ymemoticons/img/68.gif",text:"[-X",regexp:"\\[-X",height:18},":-t":{width:30,alt:"time out",src:"/service/zimlet/com_zimbra_ymemoticons/img/104.gif",text:":-t",regexp:":-t",height:18},":(|)":{width:21,alt:"monkey",src:"/service/zimlet/com_zimbra_ymemoticons/img/51.gif",text:":(|)",regexp:":\\(\\|\\)",height:18},":o)":{width:28,alt:"clown",src:"/service/zimlet/com_zimbra_ymemoticons/img/34.gif",text:":O)",regexp:":O\\)",height:18},"i-)":{width:21,alt:"sleepy",src:"/service/zimlet/com_zimbra_ymemoticons/img/28.gif",text:"I-)",regexp:"I-\\)",height:18},";;)":{width:18,alt:"batting eyelashes",src:"/service/zimlet/com_zimbra_ymemoticons/img/5.gif",text:";;)",regexp:";;\\)",height:18},":^o":{width:18,alt:"liar",src:"/service/zimlet/com_zimbra_ymemoticons/img/44.gif",text:":^o",regexp:":\\^o",height:18},"<:-p":{width:38,alt:"party",src:"/service/zimlet/com_zimbra_ymemoticons/img/36.gif",text:"<:-P",regexp:"<:-P",height:18},"x(":{width:34,alt:"angry",src:"/service/zimlet/com_zimbra_ymemoticons/img/14.gif",text:"X(",regexp:"X\\(",height:18},":-/":{width:20,alt:"confused",src:"/service/zimlet/com_zimbra_ymemoticons/img/7.gif",text:":-/",regexp:":-\\x2f",height:18},"#:-s":{width:34,alt:"whew!",src:"/service/zimlet/com_zimbra_ymemoticons/img/18.gif",text:"#:-S",regexp:"#:-S",height:18},"8->":{width:23,alt:"daydreaming",src:"/service/zimlet/com_zimbra_ymemoticons/img/105.gif",text:"8->",regexp:"8->",height:18},":d":{width:18,alt:"big grin",src:"/service/zimlet/com_zimbra_ymemoticons/img/4.gif",text:":D",regexp:":D",height:18},"\\:d/":{width:26,alt:"dancing",src:"/service/zimlet/com_zimbra_ymemoticons/img/69.gif",text:"\\:D/",regexp:"\\\\:D\\x2f",height:18},":-b":{width:24,alt:"nerd",src:"/service/zimlet/com_zimbra_ymemoticons/img/26.gif",text:":-B",regexp:":-B",height:18},":-@":{width:36,alt:"chatterbox",src:"/service/zimlet/com_zimbra_ymemoticons/img/76.gif",text:":-@",regexp:":-@",height:18},":-h":{width:28,alt:"wave",src:"/service/zimlet/com_zimbra_ymemoticons/img/103.gif",text:":-h",regexp:":-h",height:18},":-c":{width:28,alt:"call me",src:"/service/zimlet/com_zimbra_ymemoticons/img/101.gif",text:":-c",regexp:":-c",height:18},"=p~":{width:18,alt:"drooling",src:"/service/zimlet/com_zimbra_ymemoticons/img/38.gif",text:"=P~",regexp:"=P~",height:18},"(:|":{width:18,alt:"yawn",src:"/service/zimlet/com_zimbra_ymemoticons/img/37.gif",text:"(:|",regexp:"\\(:\\|",height:18},":-o":{width:18,alt:"surprise",src:"/service/zimlet/com_zimbra_ymemoticons/img/13.gif",text:":-O",regexp:":-O",height:18},"o->":{width:18,alt:"hiro",src:"/service/zimlet/com_zimbra_ymemoticons/img/72.gif",text:"o->",regexp:"o->",height:18},":))":{width:18,alt:"laughing",src:"/service/zimlet/com_zimbra_ymemoticons/img/21.gif",text:":))",regexp:":\\)\\)",height:18},"/:)":{width:18,alt:"raised eyebrow",src:"/service/zimlet/com_zimbra_ymemoticons/img/23.gif",text:"/:)",regexp:"\\x2f:\\)",height:18},"*-:)":{width:30,alt:"idea",src:"/service/zimlet/com_zimbra_ymemoticons/img/58.gif",text:"*-:)",regexp:"\\*-:\\)",height:18},":)]":{width:31,alt:"on the phone",src:"/service/zimlet/com_zimbra_ymemoticons/img/100.gif",text:":)]",regexp:":\\)\\]",height:18},":-ss":{width:36,alt:"nailbiting",src:"/service/zimlet/com_zimbra_ymemoticons/img/42.gif",text:":-SS",regexp:":-SS",height:18},"(%)":{width:18,alt:"yin yang",src:"/service/zimlet/com_zimbra_ymemoticons/img/75.gif",text:"(%)",regexp:"\\(%\\)",height:18},":-*":{width:18,alt:"kiss",src:"/service/zimlet/com_zimbra_ymemoticons/img/11.gif",text:":-*",regexp:":-\\*",height:18},"~x(":{width:44,alt:"at wits' end",src:"/service/zimlet/com_zimbra_ymemoticons/img/102.gif",text:"~X(",regexp:"~X\\(",height:18},"o=>":{width:18,alt:"billy",src:"/service/zimlet/com_zimbra_ymemoticons/img/73.gif",text:"o=>",regexp:"o=>",height:18},":-??":{width:40,alt:"I don't know",src:"/service/zimlet/com_zimbra_ymemoticons/img/106.gif",text:":-??",regexp:":-\\?\\?",height:18},"@-)":{width:18,alt:"hypnotized",src:"/service/zimlet/com_zimbra_ymemoticons/img/43.gif",text:"@-)",regexp:"@-\\)",height:18},"3:-o":{width:18,alt:"cow",src:"/service/zimlet/com_zimbra_ymemoticons/img/50.gif",text:"3:-O",regexp:"3:-O",height:18},"=d>":{width:18,alt:"applause",src:"/service/zimlet/com_zimbra_ymemoticons/img/41.gif",text:"=D>",regexp:"=D>",height:18},":-w":{width:23,alt:"waiting",src:"/service/zimlet/com_zimbra_ymemoticons/img/45.gif",text:":-w",regexp:":-w",height:18},":x":{width:18,alt:"love struck",src:"/service/zimlet/com_zimbra_ymemoticons/img/8.gif",text:":x",regexp:":x",height:18},":-$":{width:18,alt:"don't tell anyone",src:"/service/zimlet/com_zimbra_ymemoticons/img/32.gif",text:":-$",regexp:":-\\$",height:18},"~:>":{width:18,alt:"chicken",src:"/service/zimlet/com_zimbra_ymemoticons/img/52.gif",text:"~:>",regexp:"~:>",height:18},"=:)":{width:20,alt:"bug",src:"/service/zimlet/com_zimbra_ymemoticons/img/60.gif",text:"=:)",regexp:"=:\\)",height:18},"(*)":{width:18,alt:"star",src:"/service/zimlet/com_zimbra_ymemoticons/img/79.gif",text:"(*)",regexp:"\\(\\*\\)",height:18},":|":{width:18,alt:"straight face",src:"/service/zimlet/com_zimbra_ymemoticons/img/22.gif",text:":|",regexp:":\\|",height:18},":((":{width:22,alt:"crying",src:"/service/zimlet/com_zimbra_ymemoticons/img/20.gif",text:":((",regexp:":\\(\\(",height:18},"8-x":{width:18,alt:"skull",src:"/service/zimlet/com_zimbra_ymemoticons/img/59.gif",text:"8-X",regexp:"8-X",height:18},"o:-)":{width:30,alt:"angel",src:"/service/zimlet/com_zimbra_ymemoticons/img/25.gif",text:"O:-)",regexp:"O:-\\)",height:18},">:p":{width:18,alt:"phbbbbt",src:"/service/zimlet/com_zimbra_ymemoticons/img/47.gif",text:">:P",regexp:">:P",height:18},">-)":{width:18,alt:"alien",src:"/service/zimlet/com_zimbra_ymemoticons/img/61.gif",text:">-)",regexp:">-\\)",height:18},"=((":{width:18,alt:"broken heart",src:"/service/zimlet/com_zimbra_ymemoticons/img/12.gif",text:"=((",regexp:"=\\(\\(",height:18},"l-)":{width:24,alt:"loser",src:"/service/zimlet/com_zimbra_ymemoticons/img/30.gif",text:"L-)",regexp:"L-\\)",height:18},":@)":{width:18,alt:"pig",src:"/service/zimlet/com_zimbra_ymemoticons/img/49.gif",text:":@)",regexp:":@\\)",height:18},">:/":{width:23,alt:"bring it on",src:"/service/zimlet/com_zimbra_ymemoticons/img/70.gif",text:">:/",regexp:">:\\x2f",height:18},"b-(":{width:18,alt:"feeling beat up",src:"/service/zimlet/com_zimbra_ymemoticons/img/66.gif",text:"b-(",regexp:"b-\\(",height:18},"$-)":{width:18,alt:"money eyes",src:"/service/zimlet/com_zimbra_ymemoticons/img/64.gif",text:"$-)",regexp:"\\$-\\)",height:18},":-?":{width:18,alt:"thinking",src:"/service/zimlet/com_zimbra_ymemoticons/img/39.gif",text:":-?",regexp:":-\\?",height:18},":)>-":{width:22,alt:"peace sign",src:"/service/zimlet/com_zimbra_ymemoticons/img/67.gif",text:":)>-",regexp:":\\)>-",height:18},":-j":{width:26,alt:"oh go on",src:"/service/zimlet/com_zimbra_ymemoticons/img/78.gif",text:":-j",regexp:":-j",height:18},"%%-":{width:18,alt:"good luck",src:"/service/zimlet/com_zimbra_ymemoticons/img/54.gif",text:"%%-",regexp:"%%-",height:18},"%-(":{width:52,alt:"not listening",src:"/service/zimlet/com_zimbra_ymemoticons/img/107.gif",text:"%-(",regexp:"%-\\(",height:18},":p":{width:18,alt:"tongue",src:"/service/zimlet/com_zimbra_ymemoticons/img/10.gif",text:":P",regexp:":P",height:18},"^:)^":{width:32,alt:"not worthy",src:"/service/zimlet/com_zimbra_ymemoticons/img/77.gif",text:"^:)^",regexp:"\\^:\\)\\^",height:18},':-"':{width:22,alt:"whistling",src:"/service/zimlet/com_zimbra_ymemoticons/img/65.gif",text:':-"',regexp:":-\\x22",height:18},":-<":{width:24,alt:"sigh",src:"/service/zimlet/com_zimbra_ymemoticons/img/46.gif",text:":-<",regexp:":-<",height:18},":o3":{width:31,alt:"puppy dog eyes",src:"/service/zimlet/com_zimbra_ymemoticons/img/108.gif",text:":o3",regexp:":o3",height:18},">:)":{width:18,alt:"devil",src:"/service/zimlet/com_zimbra_ymemoticons/img/19.gif",text:">:)",regexp:">:\\)",height:18},"=;":{width:18,alt:"talk to the hand",src:"/service/zimlet/com_zimbra_ymemoticons/img/27.gif",text:"=;",regexp:"=;",height:18},"8-|":{width:18,alt:"rolling eyes",src:"/service/zimlet/com_zimbra_ymemoticons/img/29.gif",text:"8-|",regexp:"8-\\|",height:18},"**==":{width:25,alt:"flag",src:"/service/zimlet/com_zimbra_ymemoticons/img/55.gif",text:"**==",regexp:"\\*\\*==",height:18},"o-+":{width:18,alt:"april",src:"/service/zimlet/com_zimbra_ymemoticons/img/74.gif",text:"o-+",regexp:"o-+",height:18},"8-}":{width:24,alt:"silly",src:"/service/zimlet/com_zimbra_ymemoticons/img/35.gif",text:"8-}",regexp:"8-}",height:18},"=))":{width:30,alt:"rolling on the floor",src:"/service/zimlet/com_zimbra_ymemoticons/img/24.gif",text:"=))",regexp:"=\\)\\)",height:18},":-l":{width:18,alt:"frustrated",src:"/service/zimlet/com_zimbra_ymemoticons/img/62.gif",text:":-L",regexp:":-L",height:18},"b-)":{width:18,alt:"cool",src:"/service/zimlet/com_zimbra_ymemoticons/img/16.gif",text:"B-)",regexp:"B-\\)",height:18},";)":{width:18,alt:"winking",src:"/service/zimlet/com_zimbra_ymemoticons/img/3.gif",text:";)",regexp:";\\)",height:18},":>":{width:18,alt:"smug",src:"/service/zimlet/com_zimbra_ymemoticons/img/15.gif",text:":>",regexp:":>",height:18},":-&":{width:18,alt:"sick",src:"/service/zimlet/com_zimbra_ymemoticons/img/31.gif",text:":-&",regexp:":-&",height:18},"<):)":{width:18,alt:"cowboy",src:"/service/zimlet/com_zimbra_ymemoticons/img/48.gif",text:"<):)",regexp:"<\\):\\)",height:18},":-s":{width:18,alt:"worried",src:"/service/zimlet/com_zimbra_ymemoticons/img/17.gif",text:":-S",regexp:":-S",height:18},";))":{width:18,alt:"hee hee",src:"/service/zimlet/com_zimbra_ymemoticons/img/71.gif",text:";))",regexp:";\\)\\)",height:18},"[-o<":{width:18,alt:"praying",src:"/service/zimlet/com_zimbra_ymemoticons/img/63.gif",text:"[-O<",regexp:"\\[-O<",height:18},"@};-":{width:18,alt:"rose",src:"/service/zimlet/com_zimbra_ymemoticons/img/53.gif",text:"@};-",regexp:"@};-",height:18}};
YMEmoticonsPickerButton=function(B,A){if(arguments.length==0){return 
}B.actionTiming=DwtButton.ACTION_MOUSEUP;
DwtToolBarButton.call(this,B);
this.setEmoticon();
if(A&&A==true){this.setMenu(new AjxCallback(this,this._createMenu),false,false,false)
}else{this.setMenu(new AjxCallback(this,this._createMenu),false,false,true)
}};
YMEmoticonsPickerButton.prototype=new DwtToolBarButton;
YMEmoticonsPickerButton.prototype.constructor=YMEmoticonsPickerButton;
YMEmoticonsPickerButton.prototype._createMenu=function(){var A=new DwtMenu({parent:this,style:DwtMenu.GENERIC_WIDGET_STYLE});
this._picker=new YMEmoticonsPicker(A,null,null);
this._picker.addSelectionListener(new AjxListener(this,this._smileyPicked));
return A
};
YMEmoticonsPickerButton.prototype.setEmoticon=function(B){var A=B?YMEmoticonsPicker.SMILEYS[B]:YMEmoticonsPicker.getDefaultSmiley();
if(A){this._smileyButtonDiv.src=A.src;
this._smiley=A
}};
YMEmoticonsPickerButton.prototype._createHtmlFromTemplate=function(B,C){DwtButton.prototype._createHtmlFromTemplate.call(this,B,C);
var D=Dwt.getNextId();
var A="<div unselectable><img width='18' src='' id='"+D+"_smiley'></div>";
this.setText(A);
this._smileyButtonDiv=document.getElementById(D+"_smiley");
delete D
};
YMEmoticonsPickerButton.prototype.getSmiley=function(A){return this._picker.getSmiley(A)
};
YMEmoticonsPickerButton.prototype.getSelectedSmiley=function(){return this._smiley
};
YMEmoticonsPickerButton.prototype._smileyPicked=function(A){var C=A.detail;
this.setEmoticon(C);
if(this.isListenerRegistered(DwtEvent.SELECTION)){var B=DwtShell.selectionEvent;
B.item=this;
this.notifyListeners(DwtEvent.SELECTION,B)
}};
YMEmoticonsPicker=function(C,B,A){if(arguments.length==0){return 
}B=B||"DwtColorPicker";
DwtControl.call(this,{parent:C,className:B,posStyle:A});
this._createEmoticonsPicker(C)
};
YMEmoticonsPicker.prototype=new DwtControl;
YMEmoticonsPicker.prototype.constructor=YMEmoticonsPicker;
YMEmoticonsPicker.SMILEYS=Com_Zimbra_YMEmoticons.SMILEYS;
YMEmoticonsPicker.getDefaultSmiley=function(){for(var A in YMEmoticonsPicker.SMILEYS){return YMEmoticonsPicker.SMILEYS[A]
}return null
};
YMEmoticonsPicker.prototype.getDefaultSmiley=YMEmoticonsPicker.getDefaultSmiley;
YMEmoticonsPicker.prototype._createEmoticonsPicker=function(A){this._createEmoticonsTable();
this._registerHandlers()
};
YMEmoticonsPicker.prototype.addSelectionListener=function(A){this.addListener(DwtEvent.SELECTION,A)
};
YMEmoticonsPicker.prototype.removeSelectionListener=function(A){this.removeListener(DwtEvent.SELECTION,A)
};
YMEmoticonsPicker.prototype.dispose=function(){if(this._disposed){return 
}Dwt.disassociateElementFromObject(this.getHtmlElement().firstChild,this);
DwtControl.prototype.dispose.call(this)
};
YMEmoticonsPicker.prototype.getSmiley=function(A){return YMEmoticonsPicker.SMILEYS[A]
};
YMEmoticonsPicker.EMOTICONS_PER_ROW=11;
YMEmoticonsPicker.prototype._createEmoticonsTable=function(){var G=0;
var D=[];
var A=0;
var E=0;
var H=0;
var B=0;
var I=0;
for(var C in YMEmoticonsPicker.SMILEYS){if(A!=0&&!(A%YMEmoticonsPicker.EMOTICONS_PER_ROW)){D[G++]="</tr><tr>";
if(E>H){H=E
}E=0
}B=YMEmoticonsPicker.SMILEYS[C].width;
I=YMEmoticonsPicker.SMILEYS[C].height;
D[G++]=['<td style=\'background-color:#FFFFFF;\' align="center" valign="middle" id=\'',C,"' >"].join("");
D[G++]=["<img  height='",I,"' width='",B,"' src='",YMEmoticonsPicker.SMILEYS[C].src,"'","  title='",YMEmoticonsPicker.SMILEYS[C].alt,"  ",YMEmoticonsPicker.SMILEYS[C].text,"'","  />"].join("");
D[G++]="</td>";
A++;
E=E+B
}D[G++]="</table>";
var F=["<table  cellpadding='2' cellspacing='3' border='0' align='center' width='",H,"px'><tr>"].join("");
this.getHtmlElement().innerHTML=[F,D.join("")].join("");
if(AjxEnv.isFirefox1_5up&&!AjxEnv.isFirefox3up){this.setSize("480px",Dwt.DEFAULT)
}};
YMEmoticonsPicker.prototype._registerHandlers=function(){var F=this.getHtmlElement().firstChild;
Dwt.associateElementWithObject(F,this);
var G=F.rows;
var H=G.length;
for(var D=0;
D<H;
D++){var C=G[D].cells;
var E=C.length;
for(var B=0;
B<E;
B++){var A=C[B];
Dwt.setHandler(A,DwtEvent.ONMOUSEDOWN,YMEmoticonsPicker._mouseDownHdlr);
Dwt.setHandler(A,DwtEvent.ONMOUSEUP,YMEmoticonsPicker._mouseUpHdlr)
}}};
YMEmoticonsPicker._mouseDownHdlr=function(B){var A=DwtShell.mouseEvent;
A.setFromDhtmlEvent(B,true);
var C=A.target;
if(C.nodeName.toLowerCase()=="img"){C=C.parentNode
}A.dwtObj._downTdId=C.id;
A._stopPropagation=true;
A._returnValue=false;
A.setToDhtmlEvent(B);
return false
};
YMEmoticonsPicker._mouseUpHdlr=function(C){var B=DwtShell.mouseEvent;
B.setFromDhtmlEvent(C,true);
var F=B.dwtObj;
var E=B.target;
if(E.nodeName.toLowerCase()=="img"){E=E.parentNode
}if(F._downTdId==E.id){var A=YMEmoticonsPicker.SMILEYS[E.id];
if(A){if(F.isListenerRegistered(DwtEvent.SELECTION)){var D=DwtShell.selectionEvent;
DwtUiEvent.copy(D,B);
D.item=F;
D.detail=E.id;
F.notifyListeners(DwtEvent.SELECTION,D)
}}if(F.parent instanceof DwtMenu){DwtMenu.closeActiveMenu()
}}B._stopPropagation=true;
B._returnValue=false;
B.setToDhtmlEvent(C);
return false
};
function Com_Zimbra_Gtranslator(){}Com_Zimbra_Gtranslator.prototype=new ZmZimletBase();
Com_Zimbra_Gtranslator.prototype.constructor=Com_Zimbra_Gtranslator;
Com_Zimbra_Gtranslator.URL="http://translate.google.com/translate_t";
Com_Zimbra_Gtranslator.prototype.doDrop=function(A){this._zmObject=A;
this._isUserInput=false;
if(!this._gTranslatorDialog){this._initialize()
}this._contentDIV.innerHTML=AjxStringUtil.nl2br(this._zmObject.body);
this._contentTA.style.visibility="hidden";
this._contentDIV.style.visibility="visible";
this._langSelect.setSelected(0);
this._gTranslatorDialog.popup()
};
Com_Zimbra_Gtranslator.prototype.doubleClicked=function(A){this._isUserInput=true;
if(!this._gTranslatorDialog){this._initialize()
}this._contentTA.value="";
this._contentDIV.style.visibility="hidden";
this._contentTA.style.visibility="visible";
this._contentTA.focus();
this._gTranslatorDialog.popup()
};
Com_Zimbra_Gtranslator.prototype._makeRequest=function(F,E){var A=[];
var D=0;
A[D++]="text=";
A[D++]=AjxStringUtil.urlEncode(E);
A[D++]="&langpair=";
A[D++]=AjxStringUtil.urlEncode(F||"en|de");
A[D++]="&hl=en&ie=UTF8";
var B={"User-Agent":navigator.userAgent,"Content-Type":"application/x-www-form-urlencoded",Referrer:"http://translate.google.com/translate_t"};
var C=ZmZimletBase.PROXY+AjxStringUtil.urlEncode(Com_Zimbra_Gtranslator.URL);
AjxRpc.invoke(A.join(""),C,B,new AjxCallback(this,this._resultCallback))
};
Com_Zimbra_Gtranslator.prototype._initialize=function(){this._parentView=new DwtComposite(this.getShell());
this._parentView.setSize("440","175");
this._languages=[{value:"en|de",label:"English to German"},{value:"en|es",label:"English to Spanish"},{value:"en|fr",label:"English to French"},{value:"en|it",label:"English to Italian"},{value:"en|pt",label:"English to Portuguese"},{value:"en|ja",label:"English to Japanese BETA"},{value:"en|ko",label:"English to Korean BETA"},{value:"en|zh-CN",label:"English to Chinese (Simplified) BETA"},{value:"de|en",label:"German to English"},{value:"de|fr",label:"German to French"},{value:"es|en",label:"Spanish to English"},{value:"fr|en",label:"French to English"},{value:"fr|de",label:"French to German"},{value:"it|en",label:"Italian to English"},{value:"pt|en",label:"Portuguese to English"},{value:"ja|en",label:"Japanese to English BETA"},{value:"ko|en",label:"Korean to English BETA"},{value:"zh-CN|en",label:"Chinese (Simplified) to English BETA"}];
var D=Dwt.getNextId();
var C=Dwt.getNextId();
var F=document.createElement("div");
var B=[];
var A=0;
B[A++]="<table border=0 width=100%><tr>";
B[A++]="<td width=100% id='";
B[A++]=D;
B[A++]="'></td><td id='";
B[A++]=C;
B[A++]="'></td></tr></table>";
F.innerHTML=B.join("");
this._parentView.getHtmlElement().appendChild(F);
this._langSelect=new DwtSelect({parent:this._parentView});
this._langSelect.reparentHtmlElement(D);
for(A=0;
A<this._languages.length;
A++){var E=this._languages[A];
this._langSelect.addOption(E.label,A==0,E.value)
}this._translateButton=new DwtButton({parent:this._parentView});
this._translateButton.reparentHtmlElement(C);
this._translateButton.setText("Translate");
this._translateButton.addSelectionListener(new AjxListener(this,this._translateListener));
this._contentTA=document.createElement("TEXTAREA");
this._contentTA.style.height="140px";
this._contentTA.style.width="435px";
this._contentTA.style.padding="3px";
this._contentTA.style.position="absolute";
this._parentView.getHtmlElement().appendChild(this._contentTA);
this._contentDIV=document.createElement("DIV");
this._contentDIV.style.height="140px";
this._contentDIV.style.width="435px";
this._contentDIV.style.backgroundColor="#FFFFFF";
this._contentDIV.style.padding="3px";
this._contentDIV.style.position="absolute";
this._contentDIV.style.overflow="auto";
this._parentView.getHtmlElement().appendChild(this._contentDIV);
this._gTranslatorDialog=this._createDialog({title:"Google Translator",view:this._parentView});
this._gTranslatorDialog.setButtonListener(DwtDialog.OK_BUTTON,new AjxListener(this,this._gTranslatorDialogOkListener))
};
Com_Zimbra_Gtranslator.prototype._populate=function(C){var A=C.success?C.text:null;
var B=A?A.indexOf("<div id=result_box"):null;
var D=B?Dwt.parseHtmlFragment(A.substring(B)):null;
if(this._isUserInput){this._contentTA.style.visibility="hidden";
this._contentDIV.style.visibility="visible"
}this._contentDIV.innerHTML=D?D.innerHTML:"An error occurred attempting to translate this message."
};
Com_Zimbra_Gtranslator.prototype._gTranslatorDialogOkListener=function(A){this._gTranslatorDialog.popdown()
};
Com_Zimbra_Gtranslator.prototype._translateListener=function(A){var B=this._isUserInput?this._contentTA.value:this._zmObject.body;
this._makeRequest(this._langSelect.getValue(),B)
};
Com_Zimbra_Gtranslator.prototype._resultCallback=function(A){this._populate(A);
if(!this._gTranslatorDialog.isPoppedUp()){this._gTranslatorDialog.popup()
}};
function Com_Zimbra_YMaps(){}Com_Zimbra_YMaps.prototype=new ZmZimletBase();
Com_Zimbra_YMaps.prototype.constructor=Com_Zimbra_YMaps;
Com_Zimbra_YMaps.prototype.init=function(){if(ZmAssistant&&ZmAssistant.register){ZmAssistant.register(new Com_Zimbra_YMaps_Asst())
}};
Com_Zimbra_YMaps.URL="http://api.local.yahoo.com/MapsService/V1/mapImage?appid=ZimbraMail&zoom=4&image_height=245&image_width=345&location=";
Com_Zimbra_YMaps.CACHE=[];
Com_Zimbra_YMaps.prototype.doubleClicked=function(){this.singleClicked()
};
Com_Zimbra_YMaps.prototype.clicked=function(E,D,C,B){var A="http://maps.yahoo.com/maps_result?addr=";
var F=D.replace("\n"," ").replace("\r"," ");
B=window.open(A+escape(F))
};
Com_Zimbra_YMaps.prototype.singleClicked=function(){var E=[{label:"Address",name:"address",type:"string",minLength:2,maxLength:200}];
if(!this._dlg_propertyEditor){var B=new DwtComposite(this.getShell());
var A=this._propertyEditor=new DwtPropertyEditor(B,true);
A.initProperties(E);
var D={title:"Yahoo Maps: Enter Address",view:B};
this._dlg_propertyEditor=this._createDialog(D);
var C=this._dlg_propertyEditor;
A.setFixedLabelWidth();
A.setFixedFieldWidth();
C.setButtonListener(DwtDialog.OK_BUTTON,new AjxListener(this,function(){if(!A.validateData()){return 
}this._getDisplayCustomMap()
}))
}this._dlg_propertyEditor.popup()
};
Com_Zimbra_YMaps.prototype._getDisplayCustomMap=function(){this._dlg_propertyEditor.popdown();
this._displayDialogMap(this._propertyEditor.getProperties().address);
this._dlg_propertyEditor.dispose();
this._dlg_propertyEditor=null
};
Com_Zimbra_YMaps.prototype._displayDialogMap=function(B){var A=new DwtComposite(this.getShell());
var D={view:A,title:"Yahoo Map",standardButtons:[DwtDialog.OK_BUTTON]};
var C=this._createDialog(D);
C.popup();
C.setButtonListener(DwtDialog.OK_BUTTON,new AjxListener(this,function(){C.popdown();
C.dispose()
}));
var E=document.createElement("div");
A.getHtmlElement().appendChild(E);
this.toolTipPoppedUp(null,B,null,E)
};
Com_Zimbra_YMaps.prototype.toolTipPoppedUp=function(D,E,C,B){B.innerHTML=['<center><img width="345" height="245" id="',ZmZimletBase.encodeId(E),'" src="',this.getResource("blank_pixel.gif"),'"/></center>'].join("");
if(Com_Zimbra_YMaps.CACHE[E+"img"]){Com_Zimbra_YMaps._displayImage(Com_Zimbra_YMaps.CACHE[E+"img"],E)
}else{var A=ZmZimletBase.PROXY+AjxStringUtil.urlComponentEncode(Com_Zimbra_YMaps.URL+AjxStringUtil.urlComponentEncode(E));
AjxRpc.invoke(null,A,null,new AjxCallback(this,Com_Zimbra_YMaps._callback,E),true)
}};
Com_Zimbra_YMaps._displayImage=function(A,C){var B=document.getElementById(ZmZimletBase.encodeId(C));
B.style.backgroundImage="url("+A+")";
if(!Com_Zimbra_YMaps.CACHE[C+"img"]){Com_Zimbra_YMaps.CACHE[C+"img"]=A
}};
Com_Zimbra_YMaps._callback=function(D,A){var C=A.text;
var B=C.substring(C.indexOf("http://gws"),C.indexOf("</Result>"));
B=ZmZimletBase.PROXY+AjxStringUtil.urlComponentEncode(B);
Com_Zimbra_YMaps._displayImage(B,D)
};
function Com_Zimbra_YMaps_Asst(){ZmAssistant.call(this,"Yahoo Maps","map","Map an address using Yahoo Maps")
}Com_Zimbra_YMaps_Asst.prototype=new ZmAssistant();
Com_Zimbra_YMaps_Asst.prototype.constructor=Com_Zimbra_YMaps_Asst;
Com_Zimbra_YMaps_Asst.prototype.okHandler=function(C){var B=appCtxt.getZimletMgr();
var A=B?B._ZIMLETS_BY_ID.com_zimbra_ymaps:null;
if(A&&this._address){A.handlerObject.toolTipPoppedUp(null,this._address,null,C.getAssistantDiv())
}return false
};
Com_Zimbra_YMaps_Asst.prototype.handle=function(B,D,A){this._address=A;
var C=A.length>0;
B._setOkButton("Map",true,C)
};
function com_zimbra_bugz(){}com_zimbra_bugz.prototype=new ZmZimletBase();
com_zimbra_bugz.prototype.constructor=com_zimbra_bugz;
com_zimbra_bugz.prototype.generateSpan=function(F,J,E,D,A){var I=this.xmlObj("contentObject");
var B=I&&I.onClick&&I.onClick.actionUrl;
if(B){var H=this._createContentObj(E,A);
var G=[];
this._getHtmlContent(G,0,E,A,D);
var C={id:D,className:this.getClassName(E),href:this._zimletContext.makeURL(B,H),text:G};
F[J++]=AjxTemplate.expand("com_zimbra_bugz.templates.Bugz#Bugz_link",C)
}return J
};
ZmZimletBase.prototype.clicked=function(B,D,A,C){C._stopPropagation=false
};
AjxTemplate.register("com_zimbra_bugz.templates.Bugz#Bugz_link",function(B,F,E,A){var D=Boolean(A);
E=(typeof E=="string"?{id:E}:E)||{};
A=A||[];
var C=A.length;
A[C++]='<a target="_blank" id=\'';
A[C++]=E.id;
A[C++]="' href='";
A[C++]=E.href;
A[C++]="' class='";
A[C++]=E.className;
A[C++]="'>";
A[C++]=E.text;
A[C++]="</a>";
return D?A.length:A.join("")
},{id:"Bugz_link"},true);
AjxPackage.define("com_zimbra_bugz.templates.Bugz");
AjxTemplate.register("com_zimbra_bugz.templates.Bugz",AjxTemplate.getTemplate("com_zimbra_bugz.templates.Bugz#Bugz_link"),AjxTemplate.getParams("com_zimbra_bugz.templates.Bugz#Bugz_link"));



/* Copyright (c) 2006, Yahoo! Inc. All rights reserved. */ YAHOO.util.Dom=new function(){this.get=function(el){if(typeof el=='string'){el=document.getElementById(el);}return el;};this.getStyle=function(el,property){var value=null;var dv=document.defaultView;el=this.get(el);if(property=='opacity'&&el.filters){value=1;try{value=el.filters.item('DXImageTransform.Microsoft.Alpha').opacity/100;}catch(e){try{value=el.filters.item('alpha').opacity/100;}catch(e){}}}else if(el.style[property]){value=el.style[property];}else if(el.currentStyle&&el.currentStyle[property]){value=el.currentStyle[property];}else if(dv&&dv.getComputedStyle){var converted='';for(i=0,len=property.length;i<len;++i){if(property.charAt(i)==property.charAt(i).toUpperCase()){converted=converted+'-'+property.charAt(i).toLowerCase();}else{converted=converted+property.charAt(i);}}if(dv.getComputedStyle(el,'').getPropertyValue(converted)){value=dv.getComputedStyle(el,'').getPropertyValue(converted);}}return value;};this.setStyle=function(el,property,val){el=this.get(el);switch(property){case'opacity':if(el.filters){el.style.filter='alpha(opacity='+val*100+')';if(!el.currentStyle.hasLayout){el.style.zoom=1;}}else{el.style.opacity=val;el.style['-moz-opacity']=val;el.style['-khtml-opacity']=val;}break;default:el.style[property]=val;}};this.getXY=function(el){el=this.get(el);if(el.parentNode===null||this.getStyle(el,'display')=='none'){return false;}var parent=null;var pos=[];var box;if(el.getBoundingClientRect){box=el.getBoundingClientRect();var scrollTop=document.documentElement.scrollTop||document.body.scrollTop;var scrollLeft=document.documentElement.scrollLeft||document.body.scrollLeft;return[box.left+scrollLeft,box.top+scrollTop];}else if(document.getBoxObjectFor){box=document.getBoxObjectFor(el);pos=[box.x,box.y];}else{pos=[el.offsetLeft,el.offsetTop];parent=el.offsetParent;if(parent!=el){while(parent){pos[0]+=parent.offsetLeft;pos[1]+=parent.offsetTop;parent=parent.offsetParent;}}var ua=navigator.userAgent.toLowerCase();if(ua.indexOf('opera')!=-1||(ua.indexOf('safari')!=-1&&this.getStyle(el,'position')=='absolute')){pos[0]-=document.body.offsetLeft;pos[1]-=document.body.offsetTop;}}if(el.parentNode){parent=el.parentNode;}else{parent=null;}while(parent&&parent.tagName!='BODY'&&parent.tagName!='HTML'){pos[0]-=parent.scrollLeft;pos[1]-=parent.scrollTop;if(parent.parentNode){parent=parent.parentNode;}else{parent=null;}}return pos;};this.getX=function(el){return this.getXY(el)[0];};this.getY=function(el){return this.getXY(el)[1];};this.setXY=function(el,pos,noRetry){el=this.get(el);var pageXY=YAHOO.util.Dom.getXY(el);if(pageXY===false){return false;}if(this.getStyle(el,'position')=='static'){this.setStyle(el,'position','relative');}var delta=[parseInt(YAHOO.util.Dom.getStyle(el,'left'),10),parseInt(YAHOO.util.Dom.getStyle(el,'top'),10)];if(isNaN(delta[0])){delta[0]=0;}if(isNaN(delta[1])){delta[1]=0;}if(pos[0]!==null){el.style.left=pos[0]-pageXY[0]+delta[0]+'px';}if(pos[1]!==null){el.style.top=pos[1]-pageXY[1]+delta[1]+'px';}var newXY=this.getXY(el);if(!noRetry&&(newXY[0]!=pos[0]||newXY[1]!=pos[1])){this.setXY(el,pos,true);}return true;};this.setX=function(el,x){return this.setXY(el,[x,null]);};this.setY=function(el,y){return this.setXY(el,[null,y]);};this.getRegion=function(el){el=this.get(el);return new YAHOO.util.Region.getRegion(el);};this.getClientWidth=function(){return(document.documentElement.offsetWidth||document.body.offsetWidth);};this.getClientHeight=function(){return(self.innerHeight||document.documentElement.clientHeight||document.body.clientHeight);};this.getElementsByClassName=function(className,tag,root){root=root||document;tag=tag||'*';var nodes=[];var elements=root.getElementsByTagName(tag);var re=new RegExp('(^|\\s)'+className+'(\\s|$)');for(var i=0,len=elements.length;i<len;++i){if(re.test(elements[i]['className'])){nodes[nodes.length]=elements[i];}}return nodes;};this.hasClass=function(el,className){el=this.get(el);var re=new RegExp('(^|\\s)'+className+'(\\s|$)');return re.test(el['className']);};this.addClass=function(el,className){if(this.hasClass(el,className)){return false;}el=this.get(el);el['className']=[el['className'],className].join(' ');return true;};this.removeClass=function(el,className){if(!this.hasClass(el,className)){return false;}el=this.get(el);var re=new RegExp('(^|\\s)'+className+'(\\s|$)');var c=el['className'];el['className']=c.replace(re,'');return true;};};YAHOO.util.Region=function(t,r,b,l){this.top=t;this.right=r;this.bottom=b;this.left=l;};YAHOO.util.Region.prototype.contains=function(region){return(region.left>=this.left&&region.right<=this.right&&region.top>=this.top&&region.bottom<=this.bottom);};YAHOO.util.Region.prototype.getArea=function(){return((this.bottom-this.top)*(this.right-this.left));};YAHOO.util.Region.prototype.intersect=function(region){var t=Math.max(this.top,region.top);var r=Math.min(this.right,region.right);var b=Math.min(this.bottom,region.bottom);var l=Math.max(this.left,region.left);if(b>=t&&r>=l){return new YAHOO.util.Region(t,r,b,l);}else{return null;}};YAHOO.util.Region.prototype.union=function(region){var t=Math.min(this.top,region.top);var r=Math.max(this.right,region.right);var b=Math.max(this.bottom,region.bottom);var l=Math.min(this.left,region.left);return new YAHOO.util.Region(t,r,b,l);};YAHOO.util.Region.prototype.toString=function(){return("Region {"+"  t: "+this.top+", r: "+this.right+", b: "+this.bottom+", l: "+this.left+"}");};YAHOO.util.Region.getRegion=function(el){var p=YAHOO.util.Dom.getXY(el);var t=p[1];var r=p[0]+el.offsetWidth;var b=p[1]+el.offsetHeight;var l=p[0];return new YAHOO.util.Region(t,r,b,l);};YAHOO.util.Point=function(x,y){this.x=x;this.y=y;this.top=y;this.right=x;this.bottom=y;this.left=x;};YAHOO.util.Point.prototype=new YAHOO.util.Region();



/* Copyright (c) 2006 Yahoo! Inc. All rights reserved. */YAHOO.util.CustomEvent=function(_1,_2){this.type=_1;this.scope=_2||window;this.subscribers=[];if(YAHOO.util["Event"]){YAHOO.util.Event.regCE(this);}};YAHOO.util.CustomEvent.prototype={subscribe:function(fn,_4,_5){this.subscribers.push(new YAHOO.util.Subscriber(fn,_4,_5));},unsubscribe:function(fn,_6){var _7=false;for(var i=0;i<this.subscribers.length;++i){var s=this.subscribers[i];if(s&&s.contains(fn,_6)){this._delete(i);_7=true;}}return _7;},fire:function(){for(var i=0;i<this.subscribers.length;++i){var s=this.subscribers[i];if(s){var _10=(s.override)?s.obj:this.scope;s.fn.call(_10,this.type,arguments,s.obj);}}},unsubscribeAll:function(){for(var i=0;i<this.subscribers.length;++i){this._delete(i);}},_delete:function(_11){var s=this.subscribers[_11];if(s){delete s.fn;delete s.obj;}delete this.subscribers[_11];}};YAHOO.util.Subscriber=function(fn,obj,_13){this.fn=fn;this.obj=obj||null;this.override=(_13);};YAHOO.util.Subscriber.prototype.contains=function(fn,obj){return (this.fn==fn&&this.obj==obj);};if(!YAHOO.util.Event){YAHOO.util.Event=function(){var _14=false;var _15=[];var _16=[];var _17=[];var _18=[];var _19=[];var _20=[];var _21=0;var _22=[];return {POLL_RETRYS:200,POLL_INTERVAL:50,EL:0,TYPE:1,FN:2,WFN:3,SCOPE:3,ADJ_SCOPE:4,isSafari:(/Safari|Konqueror|KHTML/gi).test(navigator.userAgent),isIE:(!this.isSafari&&!navigator.userAgent.match(/opera/gi)&&navigator.userAgent.match(/msie/gi)),addDelayedListener:function(el,_24,fn,_25,_26){_16[_16.length]=[el,_24,fn,_25,_26];if(_14){_21=this.POLL_RETRYS;this.startTimeout(0);}},startTimeout:function(_27){var i=(_27||_27===0)?_27:this.POLL_INTERVAL;this.timeout=setTimeout("YAHOO.util.Event._tryPreloadAttach()",i);},onAvailable:function(_28,_29,_30,_31){_22.push({id:_28,fn:_29,obj:_30,override:_31});_21=this.POLL_RETRYS;this.startTimeout(0);},addListener:function(el,_32,fn,_33,_34){if(this._isValidCollection(el)){var ok=true;for(var i=0;i<el.length;++i){ok=(this.on(el[i],_32,fn,_33,_34)&&ok);}return ok;}else{if(typeof el=="string"){var oEl=this.getEl(el);if(_14&&oEl){el=oEl;}else{this.addDelayedListener(el,_32,fn,_33,_34);return true;}}}if(!el){return false;}if("unload"==_32&&_33!==this){_17[_17.length]=[el,_32,fn,_33,_34];return true;}var _37=(_34)?_33:el;var _38=function(e){return fn.call(_37,YAHOO.util.Event.getEvent(e),_33);};var li=[el,_32,fn,_38,_37];var _41=_15.length;_15[_41]=li;if(this.useLegacyEvent(el,_32)){var _42=this.getLegacyIndex(el,_32);if(_42==-1){_42=_19.length;_19[_42]=[el,_32,el["on"+_32]];_20[_42]=[];el["on"+_32]=function(e){YAHOO.util.Event.fireLegacyEvent(YAHOO.util.Event.getEvent(e),_42);};}_20[_42].push(_41);}else{if(el.addEventListener){el.addEventListener(_32,_38,false);}else{if(el.attachEvent){el.attachEvent("on"+_32,_38);}}}return true;},fireLegacyEvent:function(e,_43){var ok=true;var le=_20[_43];for(i=0;i<le.length;++i){var _45=le[i];if(_45){var li=_15[_45];if(li&&li[this.WFN]){var _46=li[this.ADJ_SCOPE];var ret=li[this.WFN].call(_46,e);ok=(ok&&ret);}else{delete le[i];}}}return ok;},getLegacyIndex:function(el,_48){for(var i=0;i<_19.length;++i){var le=_19[i];if(le&&le[0]==el&&le[1]==_48){return i;}}return -1;},useLegacyEvent:function(el,_49){return ((!el.addEventListener&&!el.attachEvent)||(_49=="click"&&this.isSafari));},removeListener:function(el,_50,fn){if(typeof el=="string"){el=this.getEl(el);}else{if(this._isValidCollection(el)){var ok=true;for(var i=0;i<el.length;++i){ok=(this.removeListener(el[i],_50,fn)&&ok);}return ok;}}var _51=null;var _52=this._getCacheIndex(el,_50,fn);if(_52>=0){_51=_15[_52];}if(!el||!_51){return false;}if(el.removeEventListener){el.removeEventListener(_50,_51[this.WFN],false);}else{if(el.detachEvent){el.detachEvent("on"+_50,_51[this.WFN]);}}delete _15[_52][this.WFN];delete _15[_52][this.FN];delete _15[_52];return true;},getTarget:function(ev,_54){var t=ev.target||ev.srcElement;if(_54&&t&&"#text"==t.nodeName){return t.parentNode;}else{return t;}},getPageX:function(ev){var x=ev.pageX;if(!x&&0!==x){x=ev.clientX||0;if(this.isIE){x+=this._getScrollLeft();}}return x;},getPageY:function(ev){var y=ev.pageY;if(!y&&0!==y){y=ev.clientY||0;if(this.isIE){y+=this._getScrollTop();}}return y;},getXY:function(ev){return [this.getPageX(ev),this.getPageY(ev)];},getRelatedTarget:function(ev){var t=ev.relatedTarget;if(!t){if(ev.type=="mouseout"){t=ev.toElement;}else{if(ev.type=="mouseover"){t=ev.fromElement;}}}return t;},getTime:function(ev){if(!ev.time){var t=new Date().getTime();try{ev.time=t;}catch(e){return t;}}return ev.time;},stopEvent:function(ev){this.stopPropagation(ev);this.preventDefault(ev);},stopPropagation:function(ev){if(ev.stopPropagation){ev.stopPropagation();}else{ev.cancelBubble=true;}},preventDefault:function(ev){if(ev.preventDefault){ev.preventDefault();}else{ev.returnValue=false;}},getEvent:function(e){var ev=e||window.event;if(!ev){var c=this.getEvent.caller;while(c){ev=c.arguments[0];if(ev&&Event==ev.constructor){break;}c=c.caller;}}return ev;},getCharCode:function(ev){return ev.charCode||(ev.type=="keypress")?ev.keyCode:0;},_getCacheIndex:function(el,_59,fn){for(var i=0;i<_15.length;++i){var li=_15[i];if(li&&li[this.FN]==fn&&li[this.EL]==el&&li[this.TYPE]==_59){return i;}}return -1;},_isValidCollection:function(o){return (o&&o.length&&typeof o!="string"&&!o.tagName&&!o.alert&&typeof o[0]!="undefined");},elCache:{},getEl:function(id){return document.getElementById(id);},clearCache:function(){for(i in this.elCache){delete this.elCache[i];}},regCE:function(ce){_18.push(ce);},_load:function(e){_14=true;},_tryPreloadAttach:function(){if(this.locked){return false;}this.locked=true;var _63=!_14;if(!_63){_63=(_21>0);}var _64=[];for(var i=0;i<_16.length;++i){var d=_16[i];if(d){var el=this.getEl(d[this.EL]);if(el){this.on(el,d[this.TYPE],d[this.FN],d[this.SCOPE],d[this.ADJ_SCOPE]);delete _16[i];}else{_64.push(d);}}}_16=_64;notAvail=[];for(i=0;i<_22.length;++i){var _66=_22[i];if(_66){el=this.getEl(_66.id);if(el){var _67=(_66.override)?_66.obj:el;_66.fn.call(_67,_66.obj);delete _22[i];}else{notAvail.push(_66);}}}_21=(_64.length===0&&notAvail.length===0)?0:_21-1;if(_63){this.startTimeout();}this.locked=false;},_unload:function(e,me){for(var i=0;i<_17.length;++i){var l=_17[i];if(l){var _70=(l[this.ADJ_SCOPE])?l[this.SCOPE]:window;l[this.FN].call(_70,this.getEvent(e),l[this.SCOPE]);}}if(_15&&_15.length>0){for(i=0;i<_15.length;++i){l=_15[i];if(l){this.removeListener(l[this.EL],l[this.TYPE],l[this.FN]);}}this.clearCache();}for(i=0;i<_18.length;++i){_18[i].unsubscribeAll();delete _18[i];}for(i=0;i<_19.length;++i){delete _19[i][0];delete _19[i];}},_getScrollLeft:function(){return this._getScroll()[1];},_getScrollTop:function(){return this._getScroll()[0];},_getScroll:function(){var dd=document.documentElement;db=document.body;if(dd&&dd.scrollTop){return [dd.scrollTop,dd.scrollLeft];}else{if(db){return [db.scrollTop,db.scrollLeft];}else{return [0,0];}}}};}();YAHOO.util.Event.on=YAHOO.util.Event.addListener;if(document&&document.body){YAHOO.util.Event._load();}else{YAHOO.util.Event.on(window,"load",YAHOO.util.Event._load,YAHOO.util.Event,true);}YAHOO.util.Event.on(window,"unload",YAHOO.util.Event._unload,YAHOO.util.Event,true);YAHOO.util.Event._tryPreloadAttach();}



/* Test build: dragdrop.20060522-1 Copyright (c) 2006, Yahoo! Inc. All rights reserved. Code licensed under the BSD License: http://developer.yahoo.net/yui/license.txt */ YAHOO.util.DragDrop=function(id,_2){if(id){this.init(id,_2);}};YAHOO.util.DragDrop.prototype={id:null,dragElId:null,handleElId:null,invalidHandleTypes:null,invalidHandleIds:null,invalidHandleClasses:null,startPageX:0,startPageY:0,groups:null,locked:false,lock:function(){this.locked=true;},unlock:function(){this.locked=false;},isTarget:true,padding:null,_domRef:null,__ygDragDrop:true,constrainX:false,constrainY:false,minX:0,maxX:0,minY:0,maxY:0,maintainOffset:false,xTicks:null,yTicks:null,primaryButtonOnly:true,available:false,b4StartDrag:function(x,y){},startDrag:function(x,y){},b4Drag:function(e){},onDrag:function(e){},onDragEnter:function(e,id){},b4DragOver:function(e){},onDragOver:function(e,id){},b4DragOut:function(e){},onDragOut:function(e,id){},b4DragDrop:function(e){},onDragDrop:function(e,id){},b4EndDrag:function(e){},endDrag:function(e){},b4MouseDown:function(e){},onMouseDown:function(e){},onMouseUp:function(e){},onAvailable:function(){},getEl:function(){if(!this._domRef){this._domRef=this.DDM.getElement(this.id);}return this._domRef;},getDragEl:function(){return this.DDM.getElement(this.dragElId);},init:function(id,_6){this.initTarget(id,_6);YAHOO.util.Event.addListener(this.id,"mousedown",this.handleMouseDown,this,true);},initTarget:function(id,_7){this.DDM=YAHOO.util.DDM;this.padding=[0,0,0,0];this.groups={};this.id=id;this.setDragElId(id);this.invalidHandleTypes={A:"A"};this.invalidHandleIds={};this.invalidHandleClasses=[];this.handleElId=id;YAHOO.util.Event.onAvailable(id,this.handleOnAvailable,this,true);this.addToGroup((_7)?_7:"default");},handleOnAvailable:function(){this.available=true;this.resetConstraints();this.onAvailable();},setPadding:function(_8,_9,_10,_11){if(!_9&&0!==_9){this.padding=[_8,_8,_8,_8];}else{if(!_10&&0!==_10){this.padding=[_8,_9,_8,_9];}else{this.padding=[_8,_9,_10,_11];}}},setInitPosition:function(_12,_13){var el=this.getEl();if(!this.DDM.verifyEl(el)){return;}var dx=_12||0;var dy=_13||0;var p=YAHOO.util.Dom.getXY(el);this.initPageX=p[0]-dx;this.initPageY=p[1]-dy;this.lastPageX=p[0];this.lastPageY=p[1];this.setStartPosition(p);},setStartPosition:function(pos){var p=pos||YAHOO.util.Dom.getXY(this.getEl());this.startPageX=p[0];this.startPageY=p[1];},addToGroup:function(_19){this.groups[_19]=true;this.DDM.regDragDrop(this,_19);},setDragElId:function(id){this.dragElId=id;},setHandleElId:function(id){this.handleElId=id;this.DDM.regHandle(this.id,id);},setOuterHandleElId:function(id){YAHOO.util.Event.addListener(id,"mousedown",this.handleMouseDown,this,true);this.setHandleElId(id);},unreg:function(){YAHOO.util.Event.removeListener(this.id,"mousedown",this.handleMouseDown);this._domRef=null;this.DDM._remove(this);},isLocked:function(){return (this.DDM.isLocked()||this.locked);},handleMouseDown:function(e,oDD){var EU=YAHOO.util.Event;var _22=e.which||e.button;if(this.primaryButtonOnly&&_22>1){return;}if(this.isLocked()){return;}this.DDM.refreshCache(this.groups);var pt=new YAHOO.util.Point(EU.getPageX(e),EU.getPageY(e));if(this.DDM.isOverTarget(pt,this)){var _24=EU.getTarget(e);if(this.isValidHandleChild(_24)&&(this.id==this.handleElId||this.DDM.handleWasClicked(_24,this.id))){this.setStartPosition();this.b4MouseDown(e);this.onMouseDown(e);this.DDM.handleMouseDown(e,this);this.DDM.stopEvent(e);}}},addInvalidHandleType:function(_25){var _26=_25.toUpperCase();this.invalidHandleTypes[_26]=_26;},addInvalidHandleId:function(id){this.invalidHandleIds[id]=id;},addInvalidHandleClass:function(_27){this.invalidHandleClasses.push(_27);},removeInvalidHandleType:function(_28){var _29=_28.toUpperCase();delete this.invalidHandleTypes[_29];},removeInvalidHandleId:function(id){delete this.invalidHandleIds[id];},removeInvalidHandleClass:function(_30){for(var i=0,len=this.invalidHandleClasses.length;i<len;++i){if(this.invalidHandleClasses[i]==_30){delete this.invalidHandleClasses[i];}}},isValidHandleChild:function(_32){var _33=true;var n=(_32.nodeName=="#text")?_32.parentNode:_32;_33=_33&&!this.invalidHandleTypes[n.nodeName];_33=_33&&!this.invalidHandleIds[n.id];for(var i=0,len=this.invalidHandleClasses.length;_33&&i<len;++i){_33=!YAHOO.util.Dom.hasClass(n,this.invalidHandleClasses[i]);}return _33;},setXTicks:function(_35,_36){this.xTicks=[];this.xTickSize=_36;var _37={};for(var i=this.initPageX;i>=this.minX;i=i-_36){if(!_37[i]){this.xTicks[this.xTicks.length]=i;_37[i]=true;}}for(i=this.initPageX;i<=this.maxX;i=i+_36){if(!_37[i]){this.xTicks[this.xTicks.length]=i;_37[i]=true;}}this.xTicks.sort(this.DDM.numericSort);},setYTicks:function(_38,_39){this.yTicks=[];this.yTickSize=_39;var _40={};for(var i=this.initPageY;i>=this.minY;i=i-_39){if(!_40[i]){this.yTicks[this.yTicks.length]=i;_40[i]=true;}}for(i=this.initPageY;i<=this.maxY;i=i+_39){if(!_40[i]){this.yTicks[this.yTicks.length]=i;_40[i]=true;}}this.yTicks.sort(this.DDM.numericSort);},setXConstraint:function(_41,_42,_43){this.leftConstraint=_41;this.rightConstraint=_42;this.minX=this.initPageX-_41;this.maxX=this.initPageX+_42;if(_43){this.setXTicks(this.initPageX,_43);}this.constrainX=true;},setYConstraint:function(iUp,_45,_46){this.topConstraint=iUp;this.bottomConstraint=_45;this.minY=this.initPageY-iUp;this.maxY=this.initPageY+_45;if(_46){this.setYTicks(this.initPageY,_46);}this.constrainY=true;},resetConstraints:function(){if(this.initPageX||this.initPageX===0){var dx=(this.maintainOffset)?this.lastPageX-this.initPageX:0;var dy=(this.maintainOffset)?this.lastPageY-this.initPageY:0;this.setInitPosition(dx,dy);}else{this.setInitPosition();}if(this.constrainX){this.setXConstraint(this.leftConstraint,this.rightConstraint,this.xTickSize);}if(this.constrainY){this.setYConstraint(this.topConstraint,this.bottomConstraint,this.yTickSize);}},getTick:function(val,_48){if(!_48){return val;}else{if(_48[0]>=val){return _48[0];}else{for(var i=0,len=_48.length;i<len;++i){var _49=i+1;if(_48[_49]&&_48[_49]>=val){var _50=val-_48[i];var _51=_48[_49]-val;return (_51>_50)?_48[i]:_48[_49];}}return _48[_48.length-1];}}},toString:function(val,_52){return ("YAHOO.util.DragDrop {"+this.id+"}");}};if(!YAHOO.util.DragDropMgr){YAHOO.util.DragDropMgr=new function(){this.ids={};this.handleIds={};this.dragCurrent=null;this.dragOvers={};this.deltaX=0;this.deltaY=0;this.preventDefault=true;this.stopPropagation=true;this.initalized=false;this.locked=false;this.init=function(){};this.POINT=0;this.INTERSECT=1;this.mode=this.POINT;this._execOnAll=function(_53,_54){for(var i in this.ids){for(var j in this.ids[i]){var oDD=this.ids[i][j];if(!this.isTypeOfDD(oDD)){continue;}oDD[_53].apply(oDD,_54);}}};this._onLoad=function(){var EU=YAHOO.util.Event;EU.on(document,"mouseup",this.handleMouseUp,this,true);EU.on(document,"mousemove",this.handleMouseMove,this,true);EU.on(window,"unload",this._onUnload,this,true);EU.on(window,"resize",this._onResize,this,true);this.initalized=true;};this._onResize=function(e){this._execOnAll("resetConstraints",[]);};this.lock=function(){this.locked=true;};this.unlock=function(){this.locked=false;};this.isLocked=function(){return this.locked;};this.locationCache={};this.useCache=true;this.clickPixelThresh=3;this.clickTimeThresh=1000;this.dragThreshMet=false;this.clickTimeout=null;this.startX=0;this.startY=0;this.regDragDrop=function(oDD,_56){if(!this.initialized){this.init();}if(!this.ids[_56]){this.ids[_56]={};}this.ids[_56][oDD.id]=oDD;};this._remove=function(oDD){for(var g in oDD.groups){if(g&&this.ids[g][oDD.id]){delete this.ids[g][oDD.id];}}delete this.handleIds[oDD.id];};this.regHandle=function(_58,_59){if(!this.handleIds[_58]){this.handleIds[_58]={};}this.handleIds[_58][_59]=_59;};this.isDragDrop=function(id){return (this.getDDById(id))?true:false;};this.getRelated=function(_60,_61){var _62=[];for(var i in _60.groups){for(j in this.ids[i]){var dd=this.ids[i][j];if(!this.isTypeOfDD(dd)){continue;}if(!_61||dd.isTarget){_62[_62.length]=dd;}}}return _62;};this.isLegalTarget=function(oDD,_64){var _65=this.getRelated(oDD);for(var i=0,len=_65.length;i<len;++i){if(_65[i].id==_64.id){return true;}}return false;};this.isTypeOfDD=function(oDD){return (oDD&&oDD.__ygDragDrop);};this.isHandle=function(_66,_67){return (this.handleIds[_66]&&this.handleIds[_66][_67]);};this.getDDById=function(id){for(var i in this.ids){if(this.ids[i][id]){return this.ids[i][id];}}return null;};this.handleMouseDown=function(e,oDD){this.currentTarget=YAHOO.util.Event.getTarget(e);this.dragCurrent=oDD;var el=oDD.getEl();this.startX=YAHOO.util.Event.getPageX(e);this.startY=YAHOO.util.Event.getPageY(e);this.deltaX=this.startX-el.offsetLeft;this.deltaY=this.startY-el.offsetTop;this.dragThreshMet=false;this.clickTimeout=setTimeout(function(){var DDM=YAHOO.util.DDM;DDM.startDrag(DDM.startX,DDM.startY);},this.clickTimeThresh);};this.startDrag=function(x,y){clearTimeout(this.clickTimeout);if(this.dragCurrent){this.dragCurrent.b4StartDrag(x,y);this.dragCurrent.startDrag(x,y);}this.dragThreshMet=true;};this.handleMouseUp=function(e){if(!this.dragCurrent){return;}clearTimeout(this.clickTimeout);if(this.dragThreshMet){this.fireEvents(e,true);}else{}this.stopDrag(e);this.stopEvent(e);};this.stopEvent=function(e){if(this.stopPropagation){YAHOO.util.Event.stopPropagation(e);}if(this.preventDefault){YAHOO.util.Event.preventDefault(e);}};this.stopDrag=function(e){if(this.dragCurrent){if(this.dragThreshMet){this.dragCurrent.b4EndDrag(e);this.dragCurrent.endDrag(e);}this.dragCurrent.onMouseUp(e);}this.dragCurrent=null;this.dragOvers={};};this.handleMouseMove=function(e){if(!this.dragCurrent){return;}if(YAHOO.util.Event.isIE&&!e.button){this.stopEvent(e);return this.handleMouseUp(e);}if(!this.dragThreshMet){var _69=Math.abs(this.startX-YAHOO.util.Event.getPageX(e));var _70=Math.abs(this.startY-YAHOO.util.Event.getPageY(e));if(_69>this.clickPixelThresh||_70>this.clickPixelThresh){this.startDrag(this.startX,this.startY);}}if(this.dragThreshMet){this.dragCurrent.b4Drag(e);this.dragCurrent.onDrag(e);this.fireEvents(e,false);}this.stopEvent(e);};this.fireEvents=function(e,_71){var dc=this.dragCurrent;if(!dc||dc.isLocked()){return;}var x=YAHOO.util.Event.getPageX(e);var y=YAHOO.util.Event.getPageY(e);var pt=new YAHOO.util.Point(x,y);var _73=[];var _74=[];var _75=[];var _76=[];var _77=[];for(var i in this.dragOvers){var ddo=this.dragOvers[i];if(!this.isTypeOfDD(ddo)){continue;}if(!this.isOverTarget(pt,ddo,this.mode)){_74.push(ddo);}_73[i]=true;delete this.dragOvers[i];}for(var _79 in dc.groups){if("string"!=typeof _79){continue;}for(i in this.ids[_79]){var oDD=this.ids[_79][i];if(!this.isTypeOfDD(oDD)){continue;}if(oDD.isTarget&&!oDD.isLocked()&&oDD!=dc){if(this.isOverTarget(pt,oDD,this.mode)){if(_71){_76.push(oDD);}else{if(!_73[oDD.id]){_77.push(oDD);}else{_75.push(oDD);}this.dragOvers[oDD.id]=oDD;}}}}}if(this.mode){if(_74.length){dc.b4DragOut(e,_74);dc.onDragOut(e,_74);}if(_77.length){dc.onDragEnter(e,_77);}if(_75.length){dc.b4DragOver(e,_75);dc.onDragOver(e,_75);}if(_76.length){dc.b4DragDrop(e,_76);dc.onDragDrop(e,_76);}}else{var len=0;for(i=0,len=_74.length;i<len;++i){dc.b4DragOut(e,_74[i].id);dc.onDragOut(e,_74[i].id);}for(i=0,len=_77.length;i<len;++i){dc.onDragEnter(e,_77[i].id);}for(i=0,len=_75.length;i<len;++i){dc.b4DragOver(e,_75[i].id);dc.onDragOver(e,_75[i].id);}for(i=0,len=_76.length;i<len;++i){dc.b4DragDrop(e,_76[i].id);dc.onDragDrop(e,_76[i].id);}}};this.getBestMatch=function(dds){var _82=null;var len=dds.length;if(len==1){_82=dds[0];}else{for(var i=0;i<len;++i){var dd=dds[i];if(dd.cursorIsOver){_82=dd;break;}else{if(!_82||_82.overlap.getArea()<dd.overlap.getArea()){_82=dd;}}}}return _82;};this.refreshCache=function(_83){for(sGroup in _83){if("string"!=typeof sGroup){continue;}for(i in this.ids[sGroup]){var oDD=this.ids[sGroup][i];if(this.isTypeOfDD(oDD)){var loc=this.getLocation(oDD);if(loc){this.locationCache[oDD.id]=loc;}else{delete this.locationCache[oDD.id];oDD.unreg();}}}}};this.verifyEl=function(el){try{if(el){var _85=el.offsetParent;if(_85){return true;}}}catch(e){}return false;};this.getLocation=function(oDD){if(!this.isTypeOfDD(oDD)){return null;}var el=oDD.getEl();if(!this.verifyEl(el)){return null;}var _86=YAHOO.util.Dom.getXY(el);x1=_86[0];x2=x1+el.offsetWidth;y1=_86[1];y2=y1+el.offsetHeight;var t=y1-oDD.padding[0];var r=x2+oDD.padding[1];var b=y2+oDD.padding[2];var l=x1-oDD.padding[3];return new YAHOO.util.Region(t,r,b,l);};this.isOverTarget=function(pt,_91,_92){var loc=this.locationCache[_91.id];if(!loc||!this.useCache){loc=this.getLocation(_91);this.locationCache[_91.id]=loc;}_91.cursorIsOver=loc.contains(pt);_91.overlap=null;if(_92){var el=this.dragCurrent.getDragEl();var x=pt.x-this.dragCurrent.deltaX;var y=pt.y-this.dragCurrent.deltaY;var _93=new YAHOO.util.Region(y,x+el.offsetWidth,y+el.offsetHeight,x);var _94=_93.intersect(loc);if(_94){_91.overlap=_94;return true;}else{return false;}}else{return _91.cursorIsOver;}};this._onUnload=function(e,me){this.unregAll();};this.unregAll=function(){if(this.dragCurrent){this.stopDrag();this.dragCurrent=null;}this._execOnAll("unreg",[]);for(i in this.elementCache){delete this.elementCache[i];}this.elementCache={};this.ids={};};this.elementCache={};this.getElWrapper=function(id){var _96=this.elementCache[id];if(!_96||!_96.el){_96=this.elementCache[id]=new this.ElementWrapper(document.getElementById(id));}return _96;};this.getElement=function(id){return document.getElementById(id);};this.getCss=function(id){var css=null;var el=document.getElementById(id);if(el){css=el.style;}return css;};this.ElementWrapper=function(el){this.el=el||null;this.id=this.el&&el.id;this.css=this.el&&el.style;};this.getPosX=function(el){return YAHOO.util.Dom.getX(el);};this.getPosY=function(el){return YAHOO.util.Dom.getY(el);};this.swapNode=function(n1,n2){if(n1.swapNode){n1.swapNode(n2);}else{var p=n2.parentNode;var s=n2.nextSibling;n1.parentNode.replaceChild(n2,n1);p.insertBefore(n1,s);}};this.getScroll=function(){var t,l;if(document.documentElement&&document.documentElement.scrollTop){t=document.documentElement.scrollTop;l=document.documentElement.scrollLeft;}else{if(document.body){t=document.body.scrollTop;l=document.body.scrollLeft;}}return {top:t,left:l};};this.getStyle=function(el,_101){return YAHOO.util.Dom.getStyle(el,_101);};this.getScrollTop=function(){return this.getScroll().top;};this.getScrollLeft=function(){return this.getScroll().left;};this.moveToEl=function(_102,_103){var _104=YAHOO.util.Dom.getXY(_103);YAHOO.util.Dom.setXY(_102,_104);};this.getClientHeight=function(){return (window.innerHeight)?window.innerHeight:(document.documentElement&&document.documentElement.clientHeight)?document.documentElement.clientHeight:document.body.offsetHeight;};this.getClientWidth=function(){return (window.innerWidth)?window.innerWidth:(document.documentElement&&document.documentElement.clientWidth)?document.documentElement.clientWidth:document.body.offsetWidth;};this.numericSort=function(a,b){return (a-b);};this._timeoutCount=0;this._addListeners=function(){if(YAHOO.util.Event&&document){this._onLoad();}else{if(this._timeoutCount>1000){}else{var DDM=YAHOO.util.DDM;setTimeout(function(){DDM._addListeners();},10);if(document&&document.body){this._timeoutCount+=1;}}}};this.handleWasClicked=function(node,id){if(this.isHandle(id,node.id)){return true;}else{var p=node.parentNode;while(p){if(this.isHandle(id,p.id)){return true;}else{p=p.parentNode;}}}return false;};}();YAHOO.util.DDM=YAHOO.util.DragDropMgr;YAHOO.util.DDM._addListeners();}YAHOO.util.DD=function(id,_107){if(id){this.init(id,_107);}};YAHOO.util.DD.prototype=new YAHOO.util.DragDrop();YAHOO.util.DD.prototype.scroll=true;YAHOO.util.DD.prototype.autoOffset=function(_108,_109){var el=this.getEl();var _110=YAHOO.util.Dom.getXY(el);var x=_108-_110[0];var y=_109-_110[1];this.setDelta(x,y);};YAHOO.util.DD.prototype.setDelta=function(_111,_112){this.deltaX=_111;this.deltaY=_112;};YAHOO.util.DD.prototype.setDragElPos=function(_113,_114){var el=this.getDragEl();this.alignElWithMouse(el,_113,_114);};YAHOO.util.DD.prototype.alignElWithMouse=function(el,_115,_116){var _117=this.getTargetCoord(_115,_116);var _118=[_117.x,_117.y];YAHOO.util.Dom.setXY(el,_118);this.cachePosition(_117.x,_117.y);this.autoScroll(_117.x,_117.y,el.offsetHeight,el.offsetWidth);};YAHOO.util.DD.prototype.cachePosition=function(_119,_120){if(_119){this.lastPageX=_119;this.lastPageY=_120;}else{var _121=YAHOO.util.Dom.getXY(this.getEl());this.lastPageX=_121[0];this.lastPageY=_121[1];}};YAHOO.util.DD.prototype.autoScroll=function(x,y,h,w){if(this.scroll){var _124=this.DDM.getClientHeight();var _125=this.DDM.getClientWidth();var st=this.DDM.getScrollTop();var sl=this.DDM.getScrollLeft();var bot=h+y;var _129=w+x;var _130=(_124+st-y-this.deltaY);var _131=(_125+sl-x-this.deltaX);var _132=40;var _133=(document.all)?80:30;if(bot>_124&&_130<_132){window.scrollTo(sl,st+_133);}if(y<st&&st>0&&y-st<_132){window.scrollTo(sl,st-_133);}if(_129>_125&&_131<_132){window.scrollTo(sl+_133,st);}if(x<sl&&sl>0&&x-sl<_132){window.scrollTo(sl-_133,st);}}};YAHOO.util.DD.prototype.getTargetCoord=function(_134,_135){var x=_134-this.deltaX;var y=_135-this.deltaY;if(this.constrainX){if(x<this.minX){x=this.minX;}if(x>this.maxX){x=this.maxX;}}if(this.constrainY){if(y<this.minY){y=this.minY;}if(y>this.maxY){y=this.maxY;}}x=this.getTick(x,this.xTicks);y=this.getTick(y,this.yTicks);return {x:x,y:y};};YAHOO.util.DD.prototype.b4MouseDown=function(e){this.autoOffset(YAHOO.util.Event.getPageX(e),YAHOO.util.Event.getPageY(e));};YAHOO.util.DD.prototype.b4Drag=function(e){this.setDragElPos(YAHOO.util.Event.getPageX(e),YAHOO.util.Event.getPageY(e));};YAHOO.util.DDProxy=function(id,_136){if(id){this.forceCssPosition=false;this.init(id,_136);this.initFrame();}};YAHOO.util.DDProxy.prototype=new YAHOO.util.DD();YAHOO.util.DDProxy.frameDiv=null;YAHOO.util.DDProxy.dragElId="ygddfdiv";YAHOO.util.DDProxy.prototype.borderWidth=2;YAHOO.util.DDProxy.prototype.resizeFrame=true;YAHOO.util.DDProxy.prototype.centerFrame=false;YAHOO.util.DDProxy.createFrame=function(){var self=YAHOO.util.DDProxy;var body=document.body;if(!body||!body.firstChild){setTimeout(self.createFrame,50);return;}if(!self.frameDiv){self.frameDiv=document.createElement("div");self.frameDiv.id=self.dragElId;var s=self.frameDiv.style;s.position="absolute";s.visibility="hidden";s.cursor="move";s.border="2px solid #aaa";s.zIndex=999;body.insertBefore(self.frameDiv,body.firstChild);}};YAHOO.util.DDProxy.prototype.initFrame=function(){YAHOO.util.DDProxy.createFrame();this.setDragElId(YAHOO.util.DDProxy.dragElId);this.useAbsMath=true;};YAHOO.util.DDProxy.prototype.showFrame=function(_139,_140){var el=this.getEl();var s=this.getDragEl().style;if(this.resizeFrame){s.width=(parseInt(el.offsetWidth,10)-(2*this.borderWidth))+"px";s.height=(parseInt(el.offsetHeight,10)-(2*this.borderWidth))+"px";}if(this.centerFrame){this.setDelta(Math.round(parseInt(s.width,10)/2),Math.round(parseInt(s.width,10)/2));}this.setDragElPos(_139,_140);s.visibility="";};YAHOO.util.DDProxy.prototype.b4MouseDown=function(e){var x=YAHOO.util.Event.getPageX(e);var y=YAHOO.util.Event.getPageY(e);this.autoOffset(x,y);this.setDragElPos(x,y);};YAHOO.util.DDProxy.prototype.b4StartDrag=function(x,y){this.showFrame(x,y);};YAHOO.util.DDProxy.prototype.b4EndDrag=function(e){var s=this.getDragEl().style;s.visibility="hidden";};YAHOO.util.DDProxy.prototype.endDrag=function(e){var lel=this.getEl();var del=this.getDragEl();del.style.visibility="";lel.style.visibility="hidden";YAHOO.util.DDM.moveToEl(lel,del);del.style.visibility="hidden";lel.style.visibility="";};YAHOO.util.DDTarget=function(id,_143){if(id){this.initTarget(id,_143);}};YAHOO.util.DDTarget.prototype=new YAHOO.util.DragDrop();



/* Copyright (c) 2006, Yahoo! Inc. All rights reserved. */ YAHOO.util.Anim=function(el,attributes,duration,method){if(el){this.init(el,attributes,duration,method);}};YAHOO.util.Anim.prototype={doMethod:function(attribute,start,end){return this.method(this.currentFrame,start,end-start,this.totalFrames);},setAttribute:function(attribute,val,unit){YAHOO.util.Dom.setStyle(this.getEl(),attribute,val+unit);},getAttribute:function(attribute){return parseFloat(YAHOO.util.Dom.getStyle(this.getEl(),attribute));},defaultUnit:'px',defaultUnits:{opacity:' '},init:function(el,attributes,duration,method){var isAnimated=false;var startTime=null;var endTime=null;var actualFrames=0;var defaultValues={};el=YAHOO.util.Dom.get(el);this.attributes=attributes||{};this.duration=duration||1;this.method=method||YAHOO.util.Easing.easeNone;this.useSeconds=true;this.currentFrame=0;this.totalFrames=YAHOO.util.AnimMgr.fps;this.getEl=function(){return el;};this.setDefault=function(attribute,val){if(val.constructor!=Array&&(val=='auto'||isNaN(val))){switch(attribute){case'width':val=el.clientWidth||el.offsetWidth;break;case'height':val=el.clientHeight||el.offsetHeight;break;case'left':if(YAHOO.util.Dom.getStyle(el,'position')=='absolute'){val=el.offsetLeft;}else{val=0;}break;case'top':if(YAHOO.util.Dom.getStyle(el,'position')=='absolute'){val=el.offsetTop;}else{val=0;}break;default:val=0;}}defaultValues[attribute]=val;};this.getDefault=function(attribute){return defaultValues[attribute];};this.isAnimated=function(){return isAnimated;};this.getStartTime=function(){return startTime;};this.animate=function(){if(this.isAnimated()){return false;}this.onStart.fire();this._onStart.fire();this.totalFrames=(this.useSeconds)?Math.ceil(YAHOO.util.AnimMgr.fps*this.duration):this.duration;YAHOO.util.AnimMgr.registerElement(this);var attributes=this.attributes;var el=this.getEl();var val;for(var attribute in attributes){val=this.getAttribute(attribute);this.setDefault(attribute,val);}isAnimated=true;actualFrames=0;startTime=new Date();};this.stop=function(){if(!this.isAnimated()){return false;}this.currentFrame=0;endTime=new Date();var data={time:endTime,duration:endTime-startTime,frames:actualFrames,fps:actualFrames/this.duration};isAnimated=false;actualFrames=0;this.onComplete.fire(data);};var onTween=function(){var start;var end=null;var val;var unit;var attributes=this['attributes'];for(var attribute in attributes){unit=attributes[attribute]['unit']||this.defaultUnits[attribute]||this.defaultUnit;if(typeof attributes[attribute]['from']!='undefined'){start=attributes[attribute]['from'];}else{start=this.getDefault(attribute);}if(typeof attributes[attribute]['to']!='undefined'){end=attributes[attribute]['to'];}else if(typeof attributes[attribute]['by']!='undefined'){if(start.constructor==Array){end=[];for(var i=0,len=start.length;i<len;++i){end[i]=start[i]+attributes[attribute]['by'][i];}}else{end=start+attributes[attribute]['by'];}}if(end!==null&&typeof end!='undefined'){val=this.doMethod(attribute,start,end);if((attribute=='width'||attribute=='height'||attribute=='opacity')&&val<0){val=0;}this.setAttribute(attribute,val,unit);}}actualFrames+=1;};this._onStart=new YAHOO.util.CustomEvent('_onStart',this);this.onStart=new YAHOO.util.CustomEvent('start',this);this.onTween=new YAHOO.util.CustomEvent('tween',this);this._onTween=new YAHOO.util.CustomEvent('_tween',this);this.onComplete=new YAHOO.util.CustomEvent('complete',this);this._onTween.subscribe(onTween);}};YAHOO.util.AnimMgr=new function(){var thread=null;var queue=[];var tweenCount=0;this.fps=200;this.delay=1;this.registerElement=function(tween){if(tween.isAnimated()){return false;}queue[queue.length]=tween;tweenCount+=1;this.start();};this.start=function(){if(thread===null){thread=setInterval(this.run,this.delay);}};this.stop=function(tween){if(!tween){clearInterval(thread);for(var i=0,len=queue.length;i<len;++i){if(queue[i].isAnimated()){queue[i].stop();}}queue=[];thread=null;tweenCount=0;}else{tween.stop();tweenCount-=1;if(tweenCount<=0){this.stop();}}};this.run=function(){for(var i=0,len=queue.length;i<len;++i){var tween=queue[i];if(!tween||!tween.isAnimated()){continue;}if(tween.currentFrame<tween.totalFrames||tween.totalFrames===null){tween.currentFrame+=1;if(tween.useSeconds){correctFrame(tween);}tween.onTween.fire();tween._onTween.fire();}else{YAHOO.util.AnimMgr.stop(tween);}}};var correctFrame=function(tween){var frames=tween.totalFrames;var frame=tween.currentFrame;var expected=(tween.currentFrame*tween.duration*1000/tween.totalFrames);var elapsed=(new Date()-tween.getStartTime());var tweak=0;if(elapsed<tween.duration*1000){tweak=Math.round((elapsed/expected-1)*tween.currentFrame);}else{tweak=frames-(frame+1);}if(tweak>0&&isFinite(tweak)){if(tween.currentFrame+tweak>=frames){tweak=frames-(frame+1);}tween.currentFrame+=tweak;}};};YAHOO.util.Bezier=new function(){this.getPosition=function(points,t){var n=points.length;var tmp=[];for(var i=0;i<n;++i){tmp[i]=[points[i][0],points[i][1]];}for(var j=1;j<n;++j){for(i=0;i<n-j;++i){tmp[i][0]=(1-t)*tmp[i][0]+t*tmp[parseInt(i+1,10)][0];tmp[i][1]=(1-t)*tmp[i][1]+t*tmp[parseInt(i+1,10)][1];}}return[tmp[0][0],tmp[0][1]];};};YAHOO.util.Easing=new function(){this.easeNone=function(t,b,c,d){return b+c*(t/=d);};this.easeIn=function(t,b,c,d){return b+c*((t/=d)*t*t);};this.easeOut=function(t,b,c,d){var ts=(t/=d)*t;var tc=ts*t;return b+c*(tc+-3*ts+3*t);};this.easeBoth=function(t,b,c,d){var ts=(t/=d)*t;var tc=ts*t;return b+c*(-2*tc+3*ts);};this.backIn=function(t,b,c,d){var ts=(t/=d)*t;var tc=ts*t;return b+c*(-3.4005*tc*ts+10.2*ts*ts+-6.2*tc+0.4*ts);};this.backOut=function(t,b,c,d){var ts=(t/=d)*t;var tc=ts*t;return b+c*(8.292*tc*ts+-21.88*ts*ts+22.08*tc+-12.69*ts+5.1975*t);};this.backBoth=function(t,b,c,d){var ts=(t/=d)*t;var tc=ts*t;return b+c*(0.402*tc*ts+-2.1525*ts*ts+-3.2*tc+8*ts+-2.05*t);};};YAHOO.util.Motion=function(el,attributes,duration,method){if(el){this.initMotion(el,attributes,duration,method);}};YAHOO.util.Motion.prototype=new YAHOO.util.Anim();YAHOO.util.Motion.prototype.defaultUnits.points='px';YAHOO.util.Motion.prototype.doMethod=function(attribute,start,end){var val=null;if(attribute=='points'){var translatedPoints=this.getTranslatedPoints();var t=this.method(this.currentFrame,0,100,this.totalFrames)/100;if(translatedPoints){val=YAHOO.util.Bezier.getPosition(translatedPoints,t);}}else{val=this.method(this.currentFrame,start,end-start,this.totalFrames);}return val;};YAHOO.util.Motion.prototype.getAttribute=function(attribute){var val=null;if(attribute=='points'){val=[this.getAttribute('left'),this.getAttribute('top')];if(isNaN(val[0])){val[0]=0;}if(isNaN(val[1])){val[1]=0;}}else{val=parseFloat(YAHOO.util.Dom.getStyle(this.getEl(),attribute));}return val;};YAHOO.util.Motion.prototype.setAttribute=function(attribute,val,unit){if(attribute=='points'){YAHOO.util.Dom.setStyle(this.getEl(),'left',val[0]+unit);YAHOO.util.Dom.setStyle(this.getEl(),'top',val[1]+unit);}else{YAHOO.util.Dom.setStyle(this.getEl(),attribute,val+unit);}};YAHOO.util.Motion.prototype.initMotion=function(el,attributes,duration,method){YAHOO.util.Anim.call(this,el,attributes,duration,method);attributes=attributes||{};attributes.points=attributes.points||{};attributes.points.control=attributes.points.control||[];this.attributes=attributes;var start;var end=null;var translatedPoints=null;this.getTranslatedPoints=function(){return translatedPoints;};var translateValues=function(val,self){var pageXY=YAHOO.util.Dom.getXY(self.getEl());val=[val[0]-pageXY[0]+start[0],val[1]-pageXY[1]+start[1]];return val;};var onStart=function(){start=this.getAttribute('points');var attributes=this.attributes;var control=attributes['points']['control']||[];if(control.length>0&&control[0].constructor!=Array){control=[control];}if(YAHOO.util.Dom.getStyle(this.getEl(),'position')=='static'){YAHOO.util.Dom.setStyle(this.getEl(),'position','relative');}if(typeof attributes['points']['from']!='undefined'){YAHOO.util.Dom.setXY(this.getEl(),attributes['points']['from']);start=this.getAttribute('points');}else if((start[0]===0||start[1]===0)){YAHOO.util.Dom.setXY(this.getEl(),YAHOO.util.Dom.getXY(this.getEl()));start=this.getAttribute('points');}var i,len;if(typeof attributes['points']['to']!='undefined'){end=translateValues(attributes['points']['to'],this);for(i=0,len=control.length;i<len;++i){control[i]=translateValues(control[i],this);}}else if(typeof attributes['points']['by']!='undefined'){end=[start[0]+attributes['points']['by'][0],start[1]+attributes['points']['by'][1]];for(i=0,len=control.length;i<len;++i){control[i]=[start[0]+control[i][0],start[1]+control[i][1]];}}if(end){translatedPoints=[start];if(control.length>0){translatedPoints=translatedPoints.concat(control);}translatedPoints[translatedPoints.length]=end;}};this._onStart.subscribe(onStart);};YAHOO.util.Scroll=function(el,attributes,duration,method){if(el){YAHOO.util.Anim.call(this,el,attributes,duration,method);}};YAHOO.util.Scroll.prototype=new YAHOO.util.Anim();YAHOO.util.Scroll.prototype.defaultUnits.scroll=' ';YAHOO.util.Scroll.prototype.doMethod=function(attribute,start,end){var val=null;if(attribute=='scroll'){val=[this.method(this.currentFrame,start[0],end[0]-start[0],this.totalFrames),this.method(this.currentFrame,start[1],end[1]-start[1],this.totalFrames)];}else{val=this.method(this.currentFrame,start,end-start,this.totalFrames);}return val;};YAHOO.util.Scroll.prototype.getAttribute=function(attribute){var val=null;var el=this.getEl();if(attribute=='scroll'){val=[el.scrollLeft,el.scrollTop];}else{val=parseFloat(YAHOO.util.Dom.getStyle(el,attribute));}return val;};YAHOO.util.Scroll.prototype.setAttribute=function(attribute,val,unit){var el=this.getEl();if(attribute=='scroll'){el.scrollLeft=val[0];el.scrollTop=val[1];}else{YAHOO.util.Dom.setStyle(el,attribute,val+unit);}};



/*
Copyright (c) 2008 Yahoo! Inc. All rights reserved. - version 3.8.2.7
*/
function YahooMapsAPIAjax(){var YMapConfig=new function(){this._list=["locale","imgPrefixURL","statURL","geoCoder","geoRSS","localSearch","trafficSearch","tileReg","tileSat","tileHyb","tileRegMono","tileSatMono","copySat","copyHyb","copyReg","copyText","unitMetersText","unitKmText","unitFtText","unitMilesText","tileSize","tileXY","radiusKm","milesKm","nauticalKm","milesDeg360","radPerDeg","maxZoom","mapsSite"];var getYear=function(){return new Date().getFullYear();};var regVer=4.3;var satVer=1.9;var _defaults={locale:"en_US",imgPrefixURL:"http://l.yimg.com/a/i/us/map/aj/",statURL:"http://geo.yahoo.com/p?",polyLine:"http://api.maps.yahoo.com/ajax/pl?",geoCoder:"http://api.maps.yahoo.com/ajax/geocode?",geoRSS:"http://api.maps.yahoo.com/ajax/georss?",localSearch:"http://api.maps.yahoo.com/ajax/locsrch?",trafficSearch:"http://api.maps.yahoo.com/ajax/trfsrch?",tileReg:["http://maps.yimg.com/hx/tl?v="+regVer+"&","http://maps1.yimg.com/hx/tl?v="+regVer+"&","http://maps2.yimg.com/hx/tl?v="+regVer+"&","http://maps3.yimg.com/hx/tl?v="+regVer+"&"],tileHyb:["http://maps.yimg.com/hx/tl?v="+regVer+"&t=h&","http://maps1.yimg.com/hx/tl?v="+regVer+"&t=h&","http://maps2.yimg.com/hx/tl?v="+regVer+"&t=h&","http://maps3.yimg.com/hx/tl?v="+regVer+"&t=h&"],tileRegMono:["http://maps.yimg.com/hx/ximg?v="+regVer+"&f=g&","http://maps1.yimg.com/hx/ximg?v="+regVer+"&f=g&","http://maps2.yimg.com/hx/ximg?v="+regVer+"&f=g&","http://maps3.yimg.com/hx/ximg?v="+regVer+"&f=g&"],tileSat:["http://maps.yimg.com/ae/ximg?v="+satVer+"&t=a&s=256&","http://maps1.yimg.com/ae/ximg?v="+satVer+"&t=a&s=256&","http://maps2.yimg.com/ae/ximg?v="+satVer+"&t=a&s=256&","http://maps3.yimg.com/ae/ximg?v="+satVer+"&t=a&s=256&"],tileSatMono:["http://maps.yimg.com/ae/ximg?v="+satVer+"&t=a&s=256&f=jg&","http://maps1.yimg.com/ae/ximg?v="+satVer+"&t=a&s=256&f=jg&","http://maps2.yimg.com/ae/ximg?v="+satVer+"&t=a&s=256&f=jg&","http://maps3.yimg.com/ae/ximg?v="+satVer+"&t=a&s=256&f=jg&"],copySat:{service:"http://api.maps.yahoo.com/ajax/copy?v=1.8&m=2"},copyReg:{service:"http://tile.maps.yahoo.com/copyright?t=png&color=black&aa=-1&"},copyHyb:{service:"http://tile.maps.yahoo.com/copyright?t=png&color=white&aa=-1&"},copyText:"&copy;"+getYear()+" Yahoo! Inc.",unitMetersText:"m",unitKmText:"km",unitFtText:"ft",unitMilesText:"mi",tileSize:256,tileXY:256,radiusKm:6366.707,milesKm:0.621371192,nauticalKm:0.539956803,milesDeg360:39999960,radPerDeg:(Math.PI/180),maxZoom:18,mapsSite:"http://maps.yahoo.com"};this.set=function(l,v){if(l&&v){this[l]=v;return ;}for(var i=0;i<this._list.length;i++){if(l[this._list[i]]){this[this._list[i]]=l[this._list[i]];}}};this.set(_defaults);this.marker1=this.imgPrefixURL+"markerf19824.png";this.marker2=this.imgPrefixURL+"star.gif";this.marker9=this.imgPrefixURL+"cpx.gif";this.ylogo=this.imgPrefixURL+"yahoo20091203.png";};YMapConfig.isValidLocale=function(l){var i={"de-DE":true,"DE":true,"es-ES":true,"ES":true,"fr-FR":true,"FR":true,"it-IT":true,"IT":true,"en-GB":true,"UK":true,"en-US":true,"US":true,"fr-CA":true,"en-CA":true,"en-IN":true,"IN":true};return(i[l]);};YMapConfig.setLocale=function(l){if(this.isValidLocale){this.locale=l;}};YMapConfig.setRegTile=function(l){this.tileReg=l;};YMapConfig.setSatTile=function(l){this.tileSat=l;};YMapConfig.setHybTile=function(l){this.tileHyb=l;};YMapConfig.setRegMonoTile=function(l){this.tileRegMono=l;};YMapConfig.setSatMonoTile=function(l){this.tileSatMono=l;};YMapConfig.get=function(l){var c={};for(var i=0;i<this._list.length;i++){c[this._list[i]]=this[this._list[i]];}if(l){return this[l];}return c;};YMapConfig.getProperties=function(){return this._list;};YMapConfig.getLocale=function(l){return this.locale;};var YGeoPoint=function(a,b){this.Lat=parseFloat(a)||0;this.Lon=parseFloat(b)||0;};YGeoPoint.prototype.greater=function(p){if(p&&p.valid){return(this.Lat>p.Lat&&this.Lon>p.Lon);}return false;};YGeoPoint.prototype.equal=function(p){if(p&&p.valid){return(this.Lat==p.Lat&&this.Lon==p.Lon);}return false;};YGeoPoint.prototype.valid=function(){return true;};YGeoPoint.prototype.getRad=function(){return new YGeoPoint(this.Lat*Math.PI/180,this.Lon*Math.PI/180);};YGeoPoint.prototype.distance=function(p,u){if(!p){return ;}var a=this.pointDiff(p);var _do=new Object();var p1r=this.getRad();var p2r=p.getRad();var _b=Math.acos(Math.cos(p1r.Lat)*Math.cos(p1r.Lon)*Math.cos(p2r.Lat)*Math.cos(p2r.Lon)+Math.cos(p1r.Lat)*Math.sin(p1r.Lon)*Math.cos(p2r.Lat)*Math.sin(p2r.Lon)+Math.sin(p1r.Lat)*Math.sin(p2r.Lat));_do.kilometers=YMapConfig.radiusKm*_b;_do.miles=YMapConfig.milesKm*_do.kilometers;_do.nautical=YMapConfig.nauticalKm*_do.kilometers;_do.degrees=Math.sqrt(a.Lat*a.Lat+a.Lon*a.Lon);if(u){_do.pixels=_do.kilometers/u.kilometers;}return _do;};YGeoPoint.prototype.pointDiff=function(p){if(!p){return ;}var _l=this.Lat-p.Lat;var _g=p.Lon-this.Lon;return(new YGeoPoint(_l,_g));};YGeoPoint.prototype.middle=function(p){var _a=(this.Lat+p.Lat)/2;var _b=(this.Lon+p.Lon)/2;return(new YGeoPoint(_a,_b));};YGeoPoint.prototype.setgeobox=function(_b){this.LatMax=(this.Lat>_b.Lat)?this.Lat:_b.Lat;this.LatMin=(this.Lat>_b.Lat)?_b.Lat:this.Lat;this.LonMax=(this.Lon>_b.Lon)?this.Lon:_b.Lon;this.LonMin=(this.Lon>_b.Lon)?_b.Lon:this.Lon;this.min=new YGeoPoint((this.Lat>_b.Lat)?_b.Lat:this.Lat,(this.Lon>_b.Lon)?_b.Lon:this.Lon);this.max=new YGeoPoint((this.Lat>_b.Lat)?this.Lat:_b.Lat,(this.Lon>_b.Lon)?this.Lon:_b.Lon);};var YCoordPoint=function(x,y){this.x=parseFloat(x)||0;this.y=parseFloat(y)||0;this._xpos="left";this._ypos="top";};YCoordPoint.prototype.equal=function(p){if(p&&p.valid){return(this.x==p.x&&this.y==p.y);}return false;};YCoordPoint.prototype.translate=function(_a,_b){this._xpos=_a;this._ypos=_b;};YCoordPoint.prototype.valid=function(){return true;};YCoordPoint.prototype.distance=function(p){var a=this.pointDiff(p);return Math.sqrt(a.x*a.x+a.y*a.y);};YCoordPoint.prototype.pointDiff=function(p){var _x=p.x-this.x;var _y=this.y-p.y;return(new YCoordPoint(_x,_y));};var YSize=function(w,h){this.width=parseInt(w)||0;this.height=parseInt(h)||0;};YSize.prototype.hasSmallerSide=function(_s){return(this.width<_s.width||this.height<_s.height);};YSize.prototype.valid=function(){return true;};YSize.prototype.area=function(_s){if(_s){return _s.width*_s.height;}return this.width*this.height;};var YImage=function(a,b,c,d){this.src=a||YMapConfig.marker1;this.size=b||new YSize(30,33);this.offsetSmartWindow=c||new YCoordPoint(-1,-1);this.offset=d||new YCoordPoint(0,0);this.yitype=true;};var TileXY=function(tx,ty,x,y){this.tx=tx||0;this.ty=ty||0;this.x=parseInt(x,10)||0;this.y=parseInt(y,10)||0;};var Annotation=function(t,d,l){this.title=t;this.description=d;this.link=l;this.valid=true;};var MapDistance=function(n,t){this.distance=n;this.type=t||"miles";this.valid=true;};function Projection(p_level,clat,tilew,tileh){this.init(p_level,clat,tilew,tileh);}Projection.prototype.init=function(p_level,clat,tilew,tileh){if(p_level<1){this.level_=1;}else{if(p_level>YMapConfig.maxZoom){this.level_=YMapConfig.maxZoom;}else{this.level_=p_level;}}this.tile_w_=tilew;this.tile_h_=tileh;this.status_=1;this.isok=isok;this.tile_width=tile_width;this.pixel_width=pixel_width;this.tile_height=tile_height;this.pixel_height=pixel_height;this.mpp=mpp;this.level=level;this.tile_size=tile_size;this.scaleKm=scaleKm;this.scaleMiles=scaleMiles;this.scaleFeet=scaleFeet;this.pix_to_tile=pix_to_tile;};function pix_to_tile(xp,yp){var _txy=new TileXY();var ypos=Math.abs(yp);_txy.tx=Math.floor(xp/this.tile_w_);_txy.x=xp%this.tile_w_;_txy.ty=Math.floor(ypos/this.tile_h_);_txy.y=ypos%this.tile_h_;if(yp<0){_txy.ty=-_txy.ty;var y=ypos%this.tile_h_;if(y&&y>0){_txy.ty--;_txy.y=this.tile_h_-_txy.y;}}return _txy;}function tile_width(){return this.ntiles_w_;}function pixel_width(){return this.ntiles_w_*this.tile_w_;}function tile_height(){return this.ntiles_h_;}function pixel_height(){return this.ntiles_h_*this.tile_h_;}function mpp(){return this.meters_per_pixel_;}function level(){return this.level_;}function tile_size(){return this.tile_w_;}function isok(){return this.status_==1;}function scaleKm(km,clat){return(this.scaleMeters(km*1000,clat));}function scaleMiles(miles,clat){return(this.scaleMeters(miles*1609.344,clat));}function scaleFeet(feet,clat){return(this.scaleMeters(feet/3.282,clat));}function sinh(x){ret=Math.exp(x);ret=(ret-1/ret)/2;return ret;}function MercatorProjection(p_level,tilew,tileh){tileh=tilew=YMapConfig.tileXY;this.init(p_level,0,tilew,tileh);this.circum_px=1<<(26-this.level_);this.ntiles_w_=this.circum_px/this.tile_w_;this.ntiles_h_=this.circum_px/this.tile_h_;this.meters_per_pixel_=YMapConfig.milesDeg360/this.circum_px;this.x_per_lon_=this.circum_px/360;this.ll_to_xy=ll_to_xy;this.xy_to_ll=xy_to_ll;this.mpp_m=mpp_m;this.scaleMeters=scaleMeters;this.ll_to_pxy=ll_to_pxy;this.pxy_to_ll=pxy_to_ll;}MercatorProjection.prototype=new Projection();MercatorProjection.prototype.constructor=MercatorProjection;MercatorProjection.superclass=Projection.prototype;MercatorProjection.prototype._returnCoordPoint=function(l,t,x,y){return new YCoordPoint(l+x,t+YMapConfig.tileXY-y);};function xy_to_ll(col,row,x,y){var x_pixel=col*this.tile_w_+x;var y_pixel=row*this.tile_h_+y;return(this.pxy_to_ll(x_pixel,y_pixel));}function ll_to_xy(_g){var _txy=new TileXY();var _cp=this.ll_to_pxy(_g.Lat,_g.Lon);if(this.isok()){_txy=this.pix_to_tile(_cp.x,_cp.y);}return _txy;}function ll_to_pxy(lat,lon){var _cp=new YCoordPoint();var alon=lon+180;var ltmp=Math.abs(alon)%360;if(alon<0){alon=360-ltmp;}if(alon>360){alon=ltmp;}var alat=Math.abs(lat);if(alat>90){alat=90;}alat*=YMapConfig.radPerDeg;_cp.x=parseInt(alon*this.x_per_lon_);ytemp=Math.log(Math.tan(alat)+1/Math.cos(alat))/Math.PI;_cp.y=parseInt(ytemp*this.pixel_height())/2;if(lat<0){_cp.y=-_cp.y;}this.status_=1;return _cp;}function pxy_to_ll(x_pixel,y_pixel){var gp=new YGeoPoint();this.status_=0;var alon=x_pixel/this.x_per_lon_;var ltmp=Math.abs(alon)%360;if(alon<0){alon=360-ltmp;}if(alon>360){alon=ltmp;}gp.Lon=alon-180;var alat=(y_pixel/(this.pixel_height()/2))*Math.PI;alat=Math.atan(sinh(alat))/YMapConfig.radPerDeg;if(alat<-90){alat=-90;}if(alat>90){alat=90;}gp.Lat=alat;this.status_=1;return gp;}function mpp_m(clat){return(this.meters_per_pixel_*Math.cos(clat*YMapConfig.radPerDeg));}function scaleMeters(meters,clat){return(parseInt(meters/this.mpp_m(clat)+0.5));}var YUtility=new function(){};var trackTr=null;var trackCache=[];var trackDl=3000;function trackDelay(o,t,c){return(function(){if(t=="pan_ob"){o.resetXY();}YUtility.tracker(o,t);clearTimeout(trackTr);trackTr=null;});}var markerTr=null;function checkMarkerAdded(o,t){return(function(){if(o){var mc=o.getMarkerCount();YUtility.tracker(o,t);clearTimeout(markerTr);markerTr=null;}});}YUtility.trackKey=function(o,z){var _c="_";return"xy"+o.tx+_c+o.ty+_c+z;};YUtility.tracker=function(o,operation){var cpt=o.getCenterLatLon();if(!cpt){return ;}var maptype=o.getCurrentMapType();var size=o.getContainerSize();var zoom=o.getZoomLevel();var dw=screen&&screen.width?screen.width:0;var dh=screen&&screen.height?screen.height:0;var width=size.width;var height=size.height;var _dsopkey="";var txy=o.getTXY();var key=YUtility.trackKey(txy,zoom);var cached=(trackCache[key])?1:0;if(operation=="zoom_ob"){_dsopkey="ds_zmtr";}if(operation=="start"){_dsopkey="ds_initr";}if(operation=="pan_ob"){_dsopkey="ds_pantr";}var _img=document.createElement("img");_img.width=_img.height="1px";_img.style.visibility="hidden";_img.id="ymaptrk"+operation;var _mvt="m";var _nvq="n";if(maptype==YAHOO_MAP_SAT){_mvt="s";_nvq="";}if(maptype==YAHOO_MAP_HYB){_mvt="h";}var nmkr=o.getMarkerCount();var _l="s=97199103";_l+="&oper="+operation;_l+="&z_lvl="+zoom;_l+="&mvt="+_mvt;_l+="&nloc="+nmkr;_l+="&appid="+YMAPPID;_l+="&cached="+cached;_l+="&swpx="+dw;_l+="&shpx="+dh;_l+="&wpx="+width;_l+="&hpx="+height;_l+="&lat="+cpt.Lat;_l+="&lon="+cpt.Lon;_l+="&i_api=1";_l+="&apptype=ajax";_l+="&locale="+YMapConfig.getLocale();_l+="&testid=M077";_l+="&i_trf=0";_l+="&d_s="+_nvq;_l+="&ds_i="+_nvq;_l+="&ds_maptr="+_nvq;if(_dsopkey){_l+="&"+_dsopkey+"="+_nvq;}_img.src=YMapConfig.statURL+_l;_img.onload=function(){YUtility.removeNode(_img);};YUtility.appendNode(o.dom,_img);if(operation=="zoom_ob"||operation=="pan"||operation=="start"){trackCache[key]=zoom;}};YUtility._xyKey=function(x,y,z,t){var _z=z||0;var _t=t||0;var _c="_";return"xy"+x+_c+y+_c+_z+_c+_t;};YUtility.getByID=function(id){return document.getElementById(id);};YUtility.getByTag=function(tag){return document.getElementsByTagName(tag);};YUtility.getRandomID=function(){var r="yid"+Math.random().toString();return(r.replace(/\./g,""));};YUtility.removeNode=function(_n){var o=(_n&&_n.dom)?_n.dom:_n;if(typeof o==="object"){try{YUtility.deleak(o);var n=o.parentNode.removeChild(o);n=null;}catch(x){}}};var _selectOnCache=[];YUtility.setDefaultSelectStyle=function(_c){if(YUtility.browser.id==0){_c.unselectable="on";if(_c.nodeName=="IMG"){_c.galleryImg="no";}}else{if(YUtility.browser.id==1){YUtility.setStyle(_c,"MozUserSelect","none");}}};var _nodeCache={};YUtility.cloneNode=function(_e,_p){var _c=null;var _k=_e+_p;var _n=_nodeCache[_k];if(!_n){_c=_nodeCache[_k]=YUtility.createNode(_e);}else{_c=_n.cloneNode(true);}YUtility.setDefaultSelectStyle(_c);return _c;};YUtility.createNode=function(_e,_id){var _c=document.createElement(_e);if(_id){_c.id=_id;}YUtility.setDefaultSelectStyle(_c);return _c;};YUtility.appendNode=function(_s,_n){if(!_n||!_s){return ;}var _c=(_n.dom)?_n.dom:_n;var _p=(_s.dom)?_s.dom:_s;if(!_c.parentNode){_p.appendChild(_c);return ;}if(_c.parentNode&&_c.parentNode.nodeType>3){_p.appendChild(_c);return ;}};YUtility.deleak=function(o){var a,i,l,n;a=(o)?o.attributes:null;if(a){l=a.length;for(i=0;i<l;i+=1){if(!a[i]){continue;}n=a[i].name;if(typeof o[n]==="function"){o[n]=null;}}}if(o){a=o.childNodes;}if(a){l=a.length;for(i=0;i<l;i+=1){YUtility.deleak(o.childNodes[i]);}}};YUtility.dynamicSNode=function(i,r){var shead=YUtility.getByTag("head");var snode=YUtility.getByID(i);if(snode){YUtility.removeNode(snode);}snode=YUtility.createNode("script");snode.type="text/javascript";snode.src=r;snode.id=i;YUtility.appendNode(shead[0],snode);};YUtility.getSize=function(_e){var d=YAHOO.util.Dom.getRegion(_e);var s=(d.getArea())?(new YSize((d.right-d.left),(d.bottom-d.top))):(new YSize(0,0));return s;};YUtility.setStyle=function(e,k,v){if(!e){return ;}var _e=(e.dom)?e.dom:e;if(typeof k=="object"){for(var t in k){if(typeof k[t]!="function"){_e.style[t]=k[t];}}}else{_e.style[k]=v;}};YUtility.browser=new function(){var _n={ie:0,moz:1,saf:2,opr:3,oth:9};var _o={win:0,mac:1,oth:3};var ua=navigator.userAgent.toLowerCase();this.os=3;if(/windows/.test(ua)){this.os=0;}else{if(/mac/.test(ua)){this.os=1;}}this.id=9;if(/opera/.test(ua)){this.id=3;}else{if(/safari/.test(ua)){this.id=2;}else{if(/gecko/.test(ua)){this.id=1;}else{if(typeof document.all!="undefined"){this.id=0;}}}}};YUtility.getInt=function(_n){var n=parseInt(_n);return(isNaN(n)?0:n);};YUtility.alphaLoad=function(_n,_t){var _clr=YMapConfig.marker9;var _typ=(_t)?"crop":"scale";var _p=(_n.dom)?_n.dom:_n;if(YUtility.browser.id){return ;}else{if(_p&&_p.nodeName=="IMG"){var _ie="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+_p.src+"', sizingMethod="+_typ+")";YUtility.setStyle(_p,"filter",_ie);_p.src=_clr;}}};YUtility.alphaImg2=function(_ni){if(YUtility.browser.id){return ;}return"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+_ni+"', sizingMethod=crop)";};YUtility.alphaImg=function(_ni,_t,_oi){if(YUtility.browser.id){return ;}var _typ=(_t)?"crop":"scale";if(_oi){_oi.src=YMapConfig.marker9;}return"progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+_ni+"', sizingMethod="+_typ+")";};var _subscriber=function(fn,obj,cast){this.fn=fn;this.obj=obj||null;this.override=(cast);this._muted=false;};_subscriber.prototype.contains=function(fn,obj){return(this.fn==fn&&this.obj==obj);};var _captureEvent=function(_t,_s){this.type=_t;this.scope=_s;this.subscribers=[];};_captureEvent.prototype=new YAHOO.util.CustomEvent;_captureEvent.prototype.trigger=function(_e,_o){for(var i in this.subscribers){var _s=this.subscribers[i];if(_s){var scope=(_s.override)?_s.obj:this.scope;if(_s.fn&&!_s._muted){_s.fn.call(scope,_e,_o);}}}};_captureEvent.prototype.subscribe=function(fn,obj,cast){this.subscribers.push(new _subscriber(fn,obj,cast));};var _eventObject=function(_a,_b,_c){this._elem=_a;this._type=_b;this._func=_c;};var YEvent=new function(){this._cache=[];};YEvent.Capture=function(_a,_b,_c,_d,_p){if(!_a||!_b||!_c){return ;}var el=(_a.dom)?_a.dom:(_a.id?_a.id:_a);if(_a.Events&&_a.Events[_b]&&!_p){_a.Events[_b].subscribe(_c,(_d?_d:_a),true);}else{YAHOO.util.Event.addListener(el,(_p?_p:_b),_c,(_d?_d:_a),true);}if(_a.id){if(!this._cache[_a.id]){this._cache[_a.id]=[];}if(!this._cache[_a.id][_b]){this._cache[_a.id][_b]=[];}this._cache[_a.id][_b].push([(_p?_p:_b),_c]);}};YEvent.Remove=function(_a,_b,_c,_p){if(!_a||!_b||!_c){return ;}if(_a.Events&&_a.Events[_b]&&!_p){_a.Events[_b].unsubscribe(_c,_a);}else{var el=(_a.dom)?_a.dom:(_a.id?_a.id:_a);YAHOO.util.Event.removeListener(el,(_p?_p:_b),_c);}};YEvent.ClearAll=function(_a){if(!_a){return ;}var el=(_a.dom)?_a.dom:(_a.id?_a.id:_a);for(var etype in _a.Events){for(var i in this._cache[_a.id][etype]){YAHOO.util.Event.removeListener(el,this._cache[_a.id][etype][i][0],this._cache[_a.id][etype][i][1]);if(_a.Events[etype].unsubscribe){_a.Events[etype].unsubscribe(this._cache[_a.id][etype][i][1],_a);}delete this._cache[_a.id][etype][i];}delete _a.Events[etype];}};YEvent.isCaptureSet=function(_a,_t){for(var _e in _a.Events){if(_e==_t&&_a.Events[_e].subscribers.length){return true;}}return false;};YEvent.stopDefault=function(_e){if(!_e){return ;}YAHOO.util.Event.preventDefault(_e);};YEvent.stopPropag=function(_e){if(!_e){return ;}YAHOO.util.Event.stopPropagation(_e);};YEvent.stopEvent=function(_e){if(!_e){return ;}YAHOO.util.Event.stopEvent(_e);};var EventsList=new function(){};EventsList.unload="unload";EventsList.wheel=(YUtility.browser.id)?"DOMMouseScroll":"mousewheel";EventsList.resize="resize";EventsList.click="click";EventsList.dblclick="dblclick";EventsList.mover="mouseover";EventsList.mout="mouseout";EventsList.mdown="mousedown";EventsList.mup="mouseup";EventsList.mmv="mousemove";EventsList.kdown="keydown";EventsList.kup="keyup";EventsList.MouseClick="MouseClick";EventsList.MouseDoubleClick="MouseDoubleClick";EventsList.MouseOver="MouseOver";EventsList.MouseOut="MouseOut";EventsList.MouseDown="MouseDown";EventsList.MouseUp="MouseUp";EventsList.MouseMove="MouseMove";EventsList.KeyDown="KeyDown";EventsList.KeyUp="KeyUp";EventsList.MouseUp="MouseUp";EventsList.MouseDown="MouseDown";EventsList.polylineAdded="polylineAdded";EventsList.polylineRemoved="polylineRemoved";EventsList.endPanOB="endPanOB";EventsList.endMapDraw="endMapDraw";EventsList.zoomAdded="zoomAdded";EventsList.MapTypeControlAdded="MapTypeControlAdded";EventsList.miniAdded="miniAdded";EventsList.startPan="startPan";EventsList.endPan="endPan";EventsList.onPan="onPan";EventsList.startAutoPan="startAutoPan";EventsList.endAutoPan="endAutoPan";EventsList.changeZoom="changeZoom";EventsList.changeMapType="changeMapType";EventsList.openSmartWindow="openSmartWindow";EventsList.closeSmartWindow="closeSmartWindow";EventsList.closeSmartWindowClick="closeSmartWindowClick";EventsList.openExpanded="openExpanded";EventsList.closeExpanded="closeExpanded";EventsList.onStartGeoCode="onStartGeoCode";EventsList.onEndGeoCode="onEndGeoCode";EventsList.onStartGeoRSS="onStartGeoRSS";EventsList.onEndGeoRSS="onEndGeoRSS";EventsList.onEndLocalSearch="onEndLocalSearch";EventsList.onEndTrafficSearch="onEndTrafficSearch";var Overlay=function(_p,_n){this._defaults(_p,_n);};Overlay.prototype.setMapObject=function(_m){this._map=_m;};Overlay.prototype._defaults2=function(a,b){this.YGeoPoint=a;this.id="hello";this.dom=YUtility.createNode("div");};Overlay.prototype._defaults=function(a,b){if(!a){return ;}if(a.Lat){this.YGeoPoint=a;}else{if(a.x){this.YCoordPoint=a;}}this.id=(b&&b.id)?b.id:YUtility.getRandomID();if(b){this.dom=(b.dom)?b.dom:b;}else{this._container();}this._setBaseElStyle();this._setBaseEvents();this._setImage();this._setOffset();};Overlay.prototype._setImage=function(i){if(i){this._image=i;}else{this._image=new YImage();}};Overlay.prototype._destroy=function(u){if(!u){YEvent.ClearAll(this);}if(this.dom){YUtility.removeNode(this.dom);}this.dom=null;};Overlay.prototype._setBaseElStyle=function(_n){if(this.dom){YUtility.setStyle(this.dom,"position","absolute");}};Overlay.prototype._setBaseEvents=function(){this.Events={};this.Events.MouseClick=new _captureEvent(EventsList.MouseClick,this);this.Events.MouseOver=new _captureEvent(EventsList.MouseOver,this);this.Events.MouseMove=new _captureEvent(EventsList.MouseMove,this);this.Events.MouseOut=new _captureEvent(EventsList.MouseOut,this);this.Events.MouseDoubleClick=new _captureEvent(EventsList.MouseDoubleClick,this);this.Events.MouseUp=new _captureEvent(EventsList.MouseUp,this);this.Events.MouseDown=new _captureEvent(EventsList.MouseDown,this);YEvent.Capture(this,EventsList.MouseClick,this._MouseClickRun,null,EventsList.click);YEvent.Capture(this,EventsList.MouseMove,this._MouseMoveRun,null,EventsList.mmv);YEvent.Capture(this,EventsList.MouseOver,this._MouseOverRun,null,EventsList.mover);YEvent.Capture(this,EventsList.MouseOut,this._MouseOutRun,null,EventsList.mout);YEvent.Capture(this,EventsList.MouseDoubleClick,this._MouseDoubleClickRun,null,EventsList.dblclick);YEvent.Capture(this,EventsList.MouseUp,this._MouseUpRun,null,EventsList.mup);YEvent.Capture(this,EventsList.MouseDown,this._MouseDownRun,null,EventsList.mdown);};Overlay.prototype._setOffset=function(o){this.setOffset(new YCoordPoint(0,0));};Overlay.prototype._MouseClickRun=function(_e){this.Events.MouseClick.trigger(new _eO(this));};Overlay.prototype._MouseMoveRun=function(_e){this.Events.MouseMove.trigger(new _eO(this));};Overlay.prototype._MouseOverRun=function(_e){this.Events.MouseOver.trigger(new _eO(this));};Overlay.prototype._MouseOutRun=function(_e){this.Events.MouseOut.trigger(new _eO(this));};Overlay.prototype._MouseDoubleClickRun=function(_e){this.Events.MouseDoubleClick.trigger(new _eO(this));};Overlay.prototype._MouseUpRun=function(_e){this.Events.MouseUp.trigger(new _eO(this));};Overlay.prototype._MouseDownRun=function(_e){this.Events.MouseDown.trigger(new _eO(this));};Overlay.prototype.assignCoordPoint=function(){if(this.YCoordPoint){var _xC=this.YCoordPoint._xpos;var _yC=this.YCoordPoint._ypos;var _s={};_s[_xC]=this.YCoordPoint.x+"px";_s[_yC]=this.YCoordPoint.y+"px";YUtility.setStyle(this,_s);}};Overlay.prototype._updateX=function(n){var t=this._xy;this._xy=new YCoordPoint(t.x+n,t.y);if(this._map){this._xybr=new YCoordPoint(this._xy.x+parseFloat(this._map.subContainer.style.left),this._xy.y+parseFloat(this._map.subContainer.style.top));}};Overlay.prototype.setOffset=function(c){if(c&&c.valid){this.offset=c;this._image.size=new YSize(0,0);this._image.offset=new YCoordPoint(0,0);}};Overlay.prototype.setGeoXYPoint=function(){var _xybr=this._map._ll2xy(this.YGeoPoint);var offx=this.offset.x+this._image.offset.x;var offy=this.offset.y+this._image.offset.y;this._xybr=new YCoordPoint(_xybr.x+offx,(_xybr.y-this._image.size.height+offy));var _xy=this._map._ll2xy(this.YGeoPoint,1);this._xy=new YCoordPoint(_xy.x+offx,(_xy.y-this._image.size.height+offy));var absPos=this._xy.x+_xy._xscpos;var intPos=parseInt(absPos/this._map.MP.circum_px);var left_buffer=500;if(absPos>this._map.YSize.width){this._xy.x=this._xy.x-(intPos)*this._map.MP.circum_px;}else{if(absPos<0-left_buffer){this._xy.x=this._xy.x-(intPos-1)*this._map.MP.circum_px;}}if(!this._hidden){this.unhide();}};Overlay.prototype.calculatePosition=function(_z){this.MP=new MercatorProjection(_z);return this.MP.ll_to_xy(this.YGeoPoint);};Overlay.prototype.setYGeoPoint=function(_p){this.YGeoPoint=new YGeoPoint(_p.Lat,_p.Lon);this.setGeoXYPoint(this._z,this._posTbl);};Overlay.prototype.hide=function(_i){if(!_i){this._hidden=true;}this.dom.style.left=this.dom.style.top="-9500px";this.dom.style.zIndex=-9999;};Overlay.prototype.ishidden=function(){return this._hidden;};Overlay.prototype.unhide=function(){this._hidden=false;if(this._xy){this.dom.style.left=this._xy.x+"px";this.dom.style.top=this._xy.y+"px";this.dom.style.zIndex=2;}};Overlay.prototype.getCoordPoint=function(){var x=YUtility.getInt(this.dom.style.left);var y=YUtility.getInt(this.dom.style.top);return new YCoordPoint(x,y);};Overlay.prototype._container=function(_n){this.dom=YUtility.createNode("div");if(_n){YUtility.appendNode(this.dom,_n);}};Overlay.prototype._setpos=function(c){this.YCoordPoint=c;};var Control=function(){this.dom=null;};Control.prototype=new Overlay;var logoSearch=function(c,mapObj){this._map=mapObj;this._setpos(c);this._setContainer();this._defaults(this.YCoordPoint,this.dom);this.id="ylocalsearch";this._markers=[];};logoSearch.prototype=new Control;logoSearch.prototype._setContainer=function(){this._imgUrl={logo:YMapConfig.imgPrefixURL+"sl_ylogo.gif",close:YMapConfig.imgPrefixURL+"x.gif",mapic:YMapConfig.imgPrefixURL+"sl_ic.gif",copy:YMapConfig.imgPrefixURL+"sl_cp_06.gif",submit:YMapConfig.imgPrefixURL+"sl_bt_go.gif",bg:YMapConfig.imgPrefixURL+"sl_bk.png",bg50:YMapConfig.imgPrefixURL+"sl_bk_50.png",bg80:YMapConfig.imgPrefixURL+"sl_bk_80.png",marker:YMapConfig.imgPrefixURL+"sl_mrk2.gif"};this._attr={max:{width:{to:205},height:{to:165}},min:{width:{to:90},height:{to:40}},offset:{width:{to:90},height:{to:50}}};this._duration=0.7;this.dom=YUtility.createNode("div");var _mb="0px";var _mr="0px";if(!YUtility.browser.id){_mb="-4px";_mr="-1px";}var _sd={position:"absolute",marginBottom:_mb,marginRight:_mr,width:"90px",height:"40px"};YUtility.setStyle(this.dom,_sd);this.i2=YUtility.createNode("img");this.i2.src=this._imgUrl.bg50;YUtility.alphaLoad(this.i2);var i3=YUtility.createNode("img");i3.src=this._imgUrl.logo;var _ltp="14px";if(!YUtility.browser.id){_ltp="12px";}var _si3={position:"absolute",top:_ltp,left:"15px",cursor:"pointer"};YUtility.setStyle(i3,_si3);var i4=YUtility.createNode("img");i4.src=this._imgUrl.copy;var _crb="2px";if(!YUtility.browser.id){_crb="5px";}var _si4={position:"absolute",bottom:_crb,right:"1px"};YUtility.setStyle(i4,_si4);var dd=YUtility.createNode("div");var _str_dd='<img src="'+this._imgUrl.mapic+'"> Get driving directions, live traffic and more on the new Yahoo! Maps: <a href="'+YMapConfig.mapsSite+'">Go to Yahoo! Maps Now</a>.';dd.innerHTML=_str_dd;var _sdd={position:"absolute",fontSize:"11",fontFamily:"tahoma",top:"95px",left:"20px"};YUtility.setStyle(dd,_sdd);YUtility.appendNode(this.dom,this.i2);YUtility.appendNode(this.dom,i3);YUtility.appendNode(this.dom,i4);YUtility.appendNode(this.dom,dd);this._setform();};logoSearch.prototype.init=function(){};logoSearch.prototype._MouseDoubleClickRun=function(_e){YEvent.stopEvent(_e);};logoSearch.prototype._MouseOverRun=function(){if(this._bigon){return ;}this._animate(this.i2,this._attr.offset,0.1);this._animate(this.dom,this._attr.offset,0.1);this.i2.src=this._imgUrl.bg80;YUtility.alphaLoad(this.i2);};logoSearch.prototype._MouseOutRun=function(){if(this._bigon){return ;}this._animate(this.i2,this._attr.min,0.1);this._animate(this.dom,this._attr.min,0.1);this.i2.src=this._imgUrl.bg50;YUtility.alphaLoad(this.i2);};logoSearch.prototype._MouseClickRun=function(){if(this._bigon){return ;}YUtility.appendNode(this.dom,this._form);this._animate(this.i2,this._attr.max,this._duration,YAHOO.util.Easing.backOut);this._animate(this.dom,this._attr.max,this._duration,YAHOO.util.Easing.backOut);this.cx=YUtility.createNode("img");this.cx.src=this._imgUrl.close;var _scx={position:"absolute",cursor:"pointer",top:"12px",right:"4px"};YUtility.setStyle(this.cx,_scx);YEvent.Capture(this.cx,EventsList.MouseClick,this._closeit,this,"click");YUtility.appendNode(this.dom,this.cx);this._form.style.visibility="visible";this._bigon=true;};logoSearch.prototype._setform=function(){this._form=YUtility.createNode("form");var _sform={position:"absolute",width:"185px",verticalAlign:"bottom",top:"28px",left:"15px"};YUtility.setStyle(this._form,_sform);var _str={legend:"Find businesses and events here on Yahoo! Local",example:" e.g. restaurants, dentists",copy:'<img src="'+this._imgUrl.copy+'">',clear:"Clear"};var lp=YUtility.createNode("div");var _slp={width:"180px",height:"30px"};YUtility.setStyle(lp,_slp);var limg=YUtility.createNode("img");limg.src=this._imgUrl.marker;var _slimg={position:"absolute",top:"5px",left:"2px"};YUtility.setStyle(limg,_slimg);var lc=YUtility.createNode("div");var _slc={position:"absolute",top:"5px",left:"25px",fontSize:"11",fontFamily:"tahoma"};YUtility.setStyle(lc,_slc);lc.innerHTML=_str.legend;YUtility.appendNode(lp,limg);YUtility.appendNode(lp,lc);this._i=YUtility.createNode("input");this._i.type="text";this._i.value=_str.example;var _si={position:"absolute",top:"32px",left:"4px",width:"140px",color:"#999",fontSize:"11",fontFamily:"tahoma"};YUtility.setStyle(this._i,_si);var s=YUtility.createNode("input");s.type="image";s.src=this._imgUrl.submit;var _ss={position:"absolute",width:"28px",height:"21px",top:"30px",right:"10px"};YUtility.setStyle(s,_ss);this._nC=YUtility.createNode("span");this._nC.innerHTML=_str.clear;var _sn={position:"absolute",cursor:"pointer",fontSize:"9",fontFamily:"verdana",color:"#03f",top:"50px",left:"3px"};YUtility.setStyle(this._nC,_sn);this._n0=YUtility.createNode("span");this._n0.innerHTML="No results";var _sn0={visibility:"hidden",position:"absolute",fontSize:"9",fontFamily:"verdana",color:"red",top:"50px",left:"50px"};YUtility.setStyle(this._n0,_sn0);YUtility.appendNode(this._form,lp);YUtility.appendNode(this._form,s);YUtility.appendNode(this._form,this._i);YUtility.appendNode(this._form,this._nC);YUtility.appendNode(this._form,this._n0);var that=this;this._i.onclick=function(){if(that._i.value==_str.example){that._i.value="";}if(YUtility.browser.id){that._i.focus();}else{that._i.select();}};};logoSearch.prototype._closeit=function(){this._animate(this.i2,this._attr.min,this._duration,YAHOO.util.Easing.backOut);this._animate(this.dom,this._attr.min,this._duration,YAHOO.util.Easing.backOut);YUtility.removeNode(this.cx);this._form.style.visibility="hidden";this._i.blur();this._bigon=false;};logoSearch.prototype._animate=function(iob,attr,duration,aniType){var anim=new YAHOO.util.Anim(iob,attr,duration,aniType);anim.animate();};var Polyline=function(a,c,w,t){if(!a||!a.length){return ;}this._path=a;this._color=c||"navy";this._weight=parseInt(w)||6;this._alpha=t||"0.7";this._segs=new Array;this.cPath();this.polyline=true;this._defaults(this._path[0]);this.id=YUtility.getRandomID();};Polyline.prototype=new Overlay;Polyline.prototype._MouseClickRun=function(_e){if(this._map){var _tr=YAHOO.util.Event.getTarget(_e);var _xy=YAHOO.util.Event.getXY(_e);var _dp=YAHOO.util.Dom.getXY(this.dom);var _ep=new YCoordPoint(_xy[0]-_dp[0],_xy[1]-_dp[1]);var _ll=this._map._xy2ll(_ep);var dfc=_ll.distance(this._map.YGeoPoint,this._map.getUnitsPerPixel());if(dfc.pixels>this._map.YSize.width){return ;}var _ce=(new _eO(this._map,this._map.YGeoPoint,{previous:this._map.zoomLevelPrev,current:this._map.zoomLevel}));this._map.Events.MouseClick.trigger(_ce,_ll);}this.Events.MouseClick.trigger(new _eO(this));};Polyline.prototype.setGeoXYPoint=function(_z,_a,_t){if(_t==2){return ;}for(var s in this._segs){if(this._segs[s]._ygpto){var gp1=this._segs[s]._ygpfrom;var gp2=this._segs[s]._ygpto;var pa=this._map._ll2xy(gp1,1);var pb=this._map._ll2xy(gp2,1);if(!pa.x||!pa.y||!pb.x||!pb.y){return ;}this._setFromTo(this._segs[s],pa,pb);if(!this._segs[s]._added){this.dom.style.zIndex=1;YUtility.appendNode(this.dom,this._segs[s]);this._segs[s]._added=true;}}}};Polyline.prototype._setFromTo=function(o,a,b){if(!YUtility.browser.id){o.from=a.x+","+a.y;o.to=b.x+","+b.y;return ;}var minx=(a.x>b.x)?b.x:a.x;var miny=(a.y>b.y)?b.y:a.y;if(YUtility.browser.id&&this._svg){var mx=Math.abs(a.x-b.x)+this._weight*2;var my=Math.abs(a.y-b.y)+this._weight*2;mx=(mx>my)?mx:my;minx-=this._weight;miny-=this._weight;o.style.left=minx+"px";o.style.top=miny+"px";o.style.position="absolute";o.setAttribute("viewBox",minx+" "+miny+" "+mx+" "+mx);o.setAttribute("width",mx+"px");o.setAttribute("height",mx+"px");if(!o._yline){o._yline=document.createElementNS("http://www.w3.org/2000/svg","line");o._yline.setAttribute("stroke-linecap","round");o._yline.setAttribute("stroke-linejoin","round");o._yline.setAttribute("stroke-width",this._weight+"px");o._yline.setAttribute("stroke-opacity",this._alpha);o._yline.setAttribute("stroke",this._color);YUtility.appendNode(o,o._yline);}o._yline.setAttribute("x1",a.x);o._yline.setAttribute("y1",a.y);o._yline.setAttribute("x2",b.x);o._yline.setAttribute("y2",b.y);return ;}o.src=YMapConfig.polyLine+"x="+a.x+"|"+a.y+"&y="+b.x+"|"+b.y;if(YUtility.browser.id){YUtility.setStyle(o,"cursor","move");YUtility.setStyle(o,"visibility","hidden");o.onload=function(){YUtility.setStyle(o,"visibility","visible");};}o.style.position="absolute";o.style.left=minx;o.style.top=miny;};Polyline.prototype.cPath=function(){this._plength=this._path.length;for(var i=0;i<this._plength;i++){var s1=i;var s2=(i+1<this._plength)?i+1:i;if(s1==s2){continue;}if(this._path[i]&&this._path[i].valid){var v=this.cSeg(this._path[s2],this._path[s1]);if(v){this._segs.push(v);}}}};Polyline.prototype.cSeg=function(a,b){var _l=_s=[];if(!YUtility.browser.id){_l=document.createElement("v:line");_l.strokecolor=this._color;_l.strokeweight=this._weight+"px";_s=document.createElement("v:stroke");_s.opacity=this._alpha;_s.endcap="round";YUtility.appendNode(_l,_s);}if(YUtility.browser.id){_l=document.createElementNS("http://www.w3.org/2000/svg","svg");if(_l.x&&_l.y){YUtility.setStyle(_l,"cursor","move");this._svg=true;}else{_l=YUtility.createNode("img");}}_l._ygpfrom=a;_l._ygpto=b;return _l;};Polyline.prototype._destroy=function(){if(this.dom){for(var s in this._segs){this._segs[s]=null;}this.dom=null;}};var TypeControl=function(c,t){this._setpos(c);this._types=(t)?t:[YAHOO_MAP_REG,YAHOO_MAP_SAT,YAHOO_MAP_HYB];this._bobj=[];this.id=YUtility.getRandomID();this._defaults(this.YCoordPoint,this.dom);this._setobj();};TypeControl.prototype=new Control;TypeControl.prototype.setControl=function(t,c,s){if(typeof c=="object"){if(c.yitype){var _t;if(!YUtility.browser.id){_t=YUtility.createNode("div");_t._iefix=YUtility.createNode("img");_t.style.filter=YUtility.alphaImg2(c.src)+" alpha(opacity=80)";_t._iefix.src=c.src;}else{_t=YUtility.createNode("img");_t.src=c.src;_t.style.opacity=0.8;}_t.style.width=c.size.width+"px";_t.style.height=c.size.height+"px";c=_t;}YUtility.appendNode(this._bobj[t],c);}else{this._bobj[t].innerHTML=c;}this._bobj[t].YSize=s;this._bobj[t].YObj=c;};TypeControl.prototype._setbobj=function(t){var obj=YUtility.createNode("div");var f;if(t==YAHOO_MAP_REG){f=this._runMapRegTypeClick;}if(t==YAHOO_MAP_SAT){f=this._runMapSatTypeClick;}if(t==YAHOO_MAP_HYB){f=this._runMapHybTypeClick;}YEvent.Capture(obj,EventsList.MouseClick,f,this,EventsList.click);YEvent.Capture(obj,EventsList.MouseDoubleClick,this._runSilentDoubleClick,this,EventsList.dblclick);this._bobj[t]=obj;};TypeControl.prototype._setobj=function(){var _curs=(!YUtility.browser.id)?"hand":"pointer";var _ss={cursor:_curs,borderColor:"white",borderStyle:"solid",borderWidth:"0px",padding:"1px"};for(var i=0;i<this._types.length;i++){var t=this._types[i];this._setbobj(t);YUtility.appendNode(this.dom,this._bobj[t]);YUtility.setStyle(this._bobj[t],_ss);}};TypeControl.prototype.setVertical=function(){for(var i=0;i<this._types.length;i++){var t=this._types[i];YUtility.setStyle(this._bobj[t],"position","relative");YUtility.setStyle(this._bobj[t],"left","0px");}};TypeControl.prototype.setHorizontal=function(){var _x=0;var _p=2;for(var i=0;i<this._types.length;i++){var t=this._types[i];var n=(this._bobj[t].YSize)?this._bobj[t].YSize.width:0;YUtility.setStyle(this._bobj[t],"position","absolute");YUtility.setStyle(this._bobj[t],"top","0px");YUtility.setStyle(this._bobj[t],"left",_x+"px");_x+=n+_p;}};TypeControl.prototype._MouseClickRun=function(_e){YEvent.stopEvent(_e);var _tr=YAHOO.util.Event.getTarget(_e);if(_tr._pw){this._map.smoothPan(new YCoordPoint(200,0));}if(_tr._pn){this._map.smoothPan(new YCoordPoint(0,200));}if(_tr._pe){this._map.smoothPan(new YCoordPoint(-200,0));}if(_tr._ps){this._map.smoothPan(new YCoordPoint(0,-200));}var _tr=YAHOO.util.Event.getTarget(_e);};TypeControl.prototype._MouseDoubleClickRun=function(_e){YEvent.stopEvent(_e);};TypeControl.prototype._runMapRegTypeClick=function(_e){YEvent.stopEvent(_e);this._map.setMapType(YAHOO_MAP_REG);var _ce=new _eO(this);this._map.Events.changeMapType.trigger(_ce);};TypeControl.prototype._runMapHybTypeClick=function(_e){YEvent.stopEvent(_e);this._map.setMapType(YAHOO_MAP_HYB);var _ce=new _eO(this);this._map.Events.changeMapType.trigger(_ce);};TypeControl.prototype._runMapSatTypeClick=function(_e){YEvent.stopEvent(_e);this._map.setMapType(YAHOO_MAP_SAT);var _ce=new _eO(this);this._map.Events.changeMapType.trigger(_ce);};TypeControl.prototype._runSilentDoubleClick=function(_e){YEvent.stopEvent(_e);};var ZoomControl=function(z,c,s){this._zoom=this._i1prevz=z;this._short=s?s:false;this._setpos(c);if(this._short){this._setobjShort(z);}else{this._setobjLong(z);}this._defaults(this.YCoordPoint,this.dom);this.setMinMax();this.id=YUtility.getRandomID();};ZoomControl.prototype=new Control;ZoomControl.prototype._setobjLong=function(z){var _si1={position:"absolute",zIndex:1,top:"9px",width:"19px",height:"19px"};var _si2={position:"absolute",width:"19px",height:"74px"};this._i1=YUtility.createNode("img");this._i1._zkn=true;var _i2=YUtility.createNode("img");this._i1.src=YMapConfig.imgPrefixURL+"zkn16.png";_i2.src=YMapConfig.imgPrefixURL+"zbg16.png";YUtility.setStyle(this._i1,_si1);YUtility.setStyle(_i2,_si2);YUtility.alphaLoad(this._i1);YUtility.alphaLoad(_i2);this.dom=YUtility.createNode("div");var _s={width:"19px",height:"74px"};_s[this.YCoordPoint._xpos]=this.YCoordPoint.x;_s[this.YCoordPoint._ypos]=this.YCoordPoint.y;YUtility.setStyle(this.dom,_s);this._limYmin=9;this._limYmax=45;this._limYdlt=this._limYmax-this._limYmin;YUtility.appendNode(this.dom,this._i1);YUtility.appendNode(this.dom,_i2);};ZoomControl.prototype._setobjShort=function(z){var _si1={position:"absolute",top:"0px",left:"1px",width:"17px",height:"15px"};var _si2={position:"absolute",top:"17px",left:"0px",width:"19px",height:"16px"};var _i1=YUtility.createNode("img");_i1._zout=true;var _i2=YUtility.createNode("img");_i2._zin=true;_i1.src=YMapConfig.imgPrefixURL+"zco16.png";_i2.src=YMapConfig.imgPrefixURL+"zci16.png";YUtility.setStyle(_i1,_si1);YUtility.setStyle(_i2,_si2);YUtility.alphaLoad(_i1);YUtility.alphaLoad(_i2);this.dom=YUtility.createNode("div");var _s={width:"19px",height:"32px"};_s[this.YCoordPoint._xpos]=this.YCoordPoint.x;_s[this.YCoordPoint._ypos]=this.YCoordPoint.y;YUtility.setStyle(this.dom,_s);YUtility.appendNode(this.dom,_i1);YUtility.appendNode(this.dom,_i2);};ZoomControl.prototype.zoomIn=function(){this._knobZtoY(this._zoom-1);};ZoomControl.prototype.zoomOut=function(){this._knobZtoY(this._zoom+1);};ZoomControl.prototype._MouseDownRun=function(_e){YEvent.stopEvent(_e);YEvent.Capture(document,EventsList.MouseUp,this._knobMouseUp,this,EventsList.mup);YEvent.Capture(document,EventsList.MouseMove,this._knobMouseMove,this,EventsList.mmv);this._initY=YAHOO.util.Event.getPageY(_e);this._posY=this._getY()-this._limYmin;};ZoomControl.prototype._MouseMoveRun=function(_e){var y=YAHOO.util.Event.getPageY(_e);var ps=YAHOO.util.Dom.getXY(this.dom);var d=y-ps[1];var _tr=YAHOO.util.Event.getTarget(_e);var _curs=(!YUtility.browser.id)?"hand":"pointer";_tr.style.cursor="default";if(_tr._zkn){_tr.style.cursor=_curs;}if(d>=0&&d<=15||_tr._zout){_tr.style.cursor=_curs;}if(d>=59&&d<=74||_tr._zin){_tr.style.cursor=_curs;}};ZoomControl.prototype._knobMouseUp=function(_e){YEvent.Remove(document,EventsList.mup,this._knobMouseUp);YEvent.Remove(document,EventsList.mmv,this._knobMouseMove);this._knobYtoZ(this._getY());};ZoomControl.prototype._knobYtoZ=function(y){if(this._i1prevy==y){return ;}var r=this._getR();var z;var delta_zoom=Math.floor(Math.abs(y-this._i1prevy)/r);if(this._i1prevy>y){z=Math.ceil(this._i1prevz+delta_zoom);if(z==this._i1prevz){z+=1;}}if(this._i1prevy<y){z=Math.ceil(this._i1prevz-delta_zoom);if(z==this._i1prevz){z-=1;}if(!z){z=this._minz;}}z=this._validZoom(z);this._knobZtoY(z);};ZoomControl.prototype._validZoom=function(z){if(z<=this._minz){return this._minz;}if(z>=this._maxz){return this._maxz;}return z;};ZoomControl.prototype._changeZoomLevel=function(z){if(this._i1prevz!=z){if(this._map){this._map.setZoomLevel(z);this._zoom=z;}}};ZoomControl.prototype._knobZtoY=function(z){z=this._validZoom(z);if(!this._difz){return ;}this.updateZoomLevel(z);this._changeZoomLevel(z);this._i1prevy=this._getY();this._i1prevz=z;};ZoomControl.prototype.updateZoomLevel=function(z){var r=this._getR();var y=this._limYdlt-r*(z-this._minz);if(z>=this._maxz){y=0;}if(z<=this._minz){y=this._limYdlt;}this._adjY(y);this._zoom=z;};ZoomControl.prototype._knobMouseMove=function(_e){var relPos=(YAHOO.util.Event.getPageY(_e)-this._initY/1+this._posY);if(relPos<0){relPos=0;}if(relPos>this._limYdlt){relPos=this._limYdlt;}this._adjY(relPos);};ZoomControl.prototype.setMinMax=function(m,x){this._minz=m||1;this._maxz=x||17;this._difz=Math.abs(this._maxz-this._minz);this._knobZtoY(this._zoom);};ZoomControl.prototype._getR=function(){return this._limYdlt/(this._difz+1);};ZoomControl.prototype._adjY=function(y){if(y>this._limYdlt){y=this._limYdlt;}if(y<0){y=0;}if(this._i1){this._i1.style.top=(y+this._limYmin)+"px";}};ZoomControl.prototype._getY=function(){if(this._i1){return parseInt(this._i1.style.top);}return 0;};ZoomControl.prototype._adjustOpacity=function(i){var _v=i?15:75;this.dom.style.filter="alpha(opacity="+_v+")";this.dom.style.opacity=_v/100;};ZoomControl.prototype._MouseClickRun=function(_e){YEvent.stopEvent(_e);var y=YAHOO.util.Event.getPageY(_e);var ps=YAHOO.util.Dom.getXY(this.dom);var d=y-ps[1];var _tr=YAHOO.util.Event.getTarget(_e);if(d>=0&&d<=15||_tr._zout){this.zoomOut();}if(d>=59&&d<=74||_tr._zin){this.zoomIn();}var _tr=YAHOO.util.Event.getTarget(_e);};ZoomControl.prototype._MouseOverRun=function(_e){YEvent.stopEvent(_e);};ZoomControl.prototype._MouseOutRun=function(_e){YEvent.stopEvent(_e);};ZoomControl.prototype._MouseDoubleClickRun=function(_e){YEvent.stopEvent(_e);};var PanControl=function(c){this._setpos(c);this._setobj();this._defaults(this.YCoordPoint,this.dom);this.id=YUtility.getRandomID();};PanControl.prototype=new Control;PanControl.prototype._setobj=function(){var _curs=(!YUtility.browser.id)?"hand":"pointer";var _s1={position:"absolute",cursor:_curs,top:"16px",left:"0px",width:"19px",height:"19px"};var _s2={position:"absolute",cursor:_curs,top:"0px",left:"13px",width:"19px",height:"19px"};var _s3={position:"absolute",cursor:_curs,top:"16px",right:"0px",width:"19px",height:"19px"};var _s4={position:"absolute",cursor:_curs,bottom:"0px",left:"13px",width:"19px",height:"19px"};var _i1=YUtility.createNode("img");var _i2=YUtility.createNode("img");var _i3=YUtility.createNode("img");var _i4=YUtility.createNode("img");_i1._pw=true;_i2._pn=true;_i3._pe=true;_i4._ps=true;_i1.src=YMapConfig.imgPrefixURL+"pw16.png";_i2.src=YMapConfig.imgPrefixURL+"pn16.png";_i3.src=YMapConfig.imgPrefixURL+"pe16.png";_i4.src=YMapConfig.imgPrefixURL+"ps16.png";YUtility.setStyle(_i1,_s1);YUtility.setStyle(_i2,_s2);YUtility.setStyle(_i3,_s3);YUtility.setStyle(_i4,_s4);YUtility.alphaLoad(_i1);YUtility.alphaLoad(_i2);YUtility.alphaLoad(_i3);YUtility.alphaLoad(_i4);this.dom=YUtility.createNode("div");var _s={width:"44px",height:"50px"};_s[this.YCoordPoint._xpos]=this.YCoordPoint.x;_s[this.YCoordPoint._ypos]=this.YCoordPoint.y;YUtility.setStyle(this.dom,_s);YUtility.appendNode(this.dom,_i1);YUtility.appendNode(this.dom,_i2);YUtility.appendNode(this.dom,_i3);YUtility.appendNode(this.dom,_i4);};PanControl.prototype._MouseClickRun=function(_e){YEvent.stopEvent(_e);var _tr=YAHOO.util.Event.getTarget(_e);if(_tr._pw){this._map.smoothPan(new YCoordPoint(200,0));}if(_tr._pn){this._map.smoothPan(new YCoordPoint(0,200));}if(_tr._pe){this._map.smoothPan(new YCoordPoint(-200,0));}if(_tr._ps){this._map.smoothPan(new YCoordPoint(0,-200));}var _tr=YAHOO.util.Event.getTarget(_e);};PanControl.prototype._MouseDoubleClickRun=function(_e){YEvent.stopEvent(_e);};var MiniControl=function(z,c){this._setobj(z);this._setpos(c);this._defaults(this.YCoordPoint,this.dom);this.id=YUtility.getRandomID();};MiniControl.prototype=new Control;MiniControl.prototype._setobj=function(){};var Scale=function(z,u,r,c){this._zr=r;this._setunits(z,u);this._setobj(z);this._setpos(c);this._defaults(this.YCoordPoint,this.dom);this.id="yscale";};Scale.prototype=new Overlay();Scale.prototype._setunits=function(z,u){var _zsl_zsr=8;this._un=u||0;this._km=(this._zr[z-1])?this._zr[z-1][2][0]:0;this._mi=(this._zr[z-1])?this._zr[z-1][2][1]:0;this.pkm=YUtility.getInt(1/this._un.kilometers*this._km-_zsl_zsr)+"px";this.pmi=YUtility.getInt(1/this._un.miles*this._mi-_zsl_zsr)+"px";this.ukm=(this._km<0.5)?Math.ceil(this._km*1000)+YMapConfig.unitMetersText:this._km+YMapConfig.unitKmText;this.umi=(this._mi<0.5)?Math.ceil(this._mi*5280)+YMapConfig.unitFtText:this._mi+YMapConfig.unitMilesText;};Scale.prototype._setpos=function(c){var p=new YCoordPoint(1,12);p.translate("left","bottom");this.YCoordPoint=c?c:p;};Scale.prototype._setobj=function(z){var _cs={width:"4px",height:"8px"};var _zsl1=YUtility.createNode("img");_zsl1.src=YMapConfig.imgPrefixURL+"zsl.gif";YUtility.setStyle(_zsl1,_cs);var _zsl2=YUtility.createNode("img");_zsl2.src=YMapConfig.imgPrefixURL+"zsl.gif";YUtility.setStyle(_zsl2,_cs);var _zsr1=YUtility.createNode("img");_zsr1.src=YMapConfig.imgPrefixURL+"zsr.gif";YUtility.setStyle(_zsr1,_cs);var _zsr2=YUtility.createNode("img");_zsr2.src=YMapConfig.imgPrefixURL+"zsr.gif";YUtility.setStyle(_zsr2,_cs);this.dom=YUtility.createNode("div");this.dom.align="left";var _s={bottom:"12px",left:"1px",zIndex:3,font:"normal 9px verdana"};YUtility.setStyle(this.dom,_s);this._skmm=YUtility.createNode("img");this._skmm.src=YMapConfig.imgPrefixURL+"zs.gif?v=1";this._skmm.style.width=this.pkm;this._skmm.style.height="8px";this._skmm._kml=true;this._km=YUtility.createNode("span");this._km.innerHTML=this.ukm;this._km.style.position="relative";this._km.style.top="-1px";this._km._kmt=true;this._smim=YUtility.createNode("img");this._smim.src=YMapConfig.imgPrefixURL+"zs.gif?v=1";this._smim.style.width=this.pmi;this._smim.style.height="8px";this._smim._mil=true;this._mi=YUtility.createNode("span");this._mi.innerHTML=this.umi;this._mi.style.position="relative";this._mi.style.top="-1px";this._mi._mit=true;var _br=YUtility.cloneNode("br");YUtility.appendNode(this.dom,_zsl1);YUtility.appendNode(this.dom,this._skmm);YUtility.appendNode(this.dom,_zsr1);YUtility.appendNode(this.dom,this._km);YUtility.appendNode(this.dom,_br);YUtility.appendNode(this.dom,_zsl2);YUtility.appendNode(this.dom,this._smim);YUtility.appendNode(this.dom,_zsr2);YUtility.appendNode(this.dom,this._mi);};Scale.prototype.update=function(z,u,t){this._setunits(z,u);for(var i=0;i<this.dom.childNodes.length;i++){if(this.dom.childNodes[i]._kml){this.dom.childNodes[i].style.width=this.pkm;}if(this.dom.childNodes[i]._kmt){this.dom.childNodes[i].innerHTML=this.ukm;}if(this.dom.childNodes[i]._mil){this.dom.childNodes[i].style.width=this.pmi;}if(this.dom.childNodes[i]._mit){this.dom.childNodes[i].innerHTML=this.umi;}if(t==YAHOO_MAP_SAT||t==YAHOO_MAP_HYB){this.dom.childNodes[i].style.color="#fff";}else{this.dom.childNodes[i].style.color="#000";}}};var CustomOverlay=function(a,b){this._defaults(a,b);};CustomOverlay.prototype=new Overlay();CustomOverlay.prototype.constructor=CustomOverlay;CustomOverlay.prototype.superclass=Overlay.prototype;var CM=function(a){if(!a){return ;}var im,id;for(var i=1;i<arguments.length;i++){if(typeof arguments[i]=="object"){im=arguments[i];}if(typeof arguments[i]=="string"){id=arguments[i];}}this.id=id||"ymarker"+YUtility.getRandomID();this._hidden=false;this._disableAutoContain=false;this._autoExpand=false;var my=YUtility.createNode("img");my.src=YMapConfig.marker1;my.src=im.src;my.style.zIndex=5;my.id=this.id;this._setCustomEvents();this._defaults(a,my);};CM.prototype=new Overlay;CM.prototype.constructor=CustomOverlay;CM.prototype.superclass=Overlay.prototype;CM.prototype._setCustomEvents=function(){this.Events.openSmartWindow=new _captureEvent(EventsList.openSmartWindow,this);this.Events.closeSmartWindow=new _captureEvent(EventsList.closeSmartWindow,this);this.Events.openExpanded=new _captureEvent(EventsList.openExpanded,this);this.Events.closeExpanded=new _captureEvent(EventsList.closeExpanded,this);YEvent.Capture(this,EventsList.openSmartWindow,this._openSmartWindowRun);YEvent.Capture(this,EventsList.closeSmartWindow,this._closeSmartWindowRun);YEvent.Capture(this,EventsList.openExpanded,this._openExpandedRun);YEvent.Capture(this,EventsList.closeExpanded,this._closeExpandedRun);};var Marker=function(gp){var im,id;if(!gp){return ;}for(var i=1;i<arguments.length;i++){if(typeof arguments[i]=="object"){im=arguments[i];}if(typeof arguments[i]=="string"){id=arguments[i];}}this.id=id||"ymarker"+YUtility.getRandomID();this.YGeoPoint=new YGeoPoint(gp.Lat,gp.Lon);this._hidden=false;this._disableAutoContain=false;this._autoExpand=false;if(im){this._image=im;}else{this._image=new YImage();}this._createMarkerDom();this._defineEvents();this._registerEvents();if(typeof (gp)=="string"){this.Address=gp;}};Marker.prototype._destroy=function(u){if(this.aedom){YUtility.removeNode(this.aedom);}if(this.swdom){YUtility.removeNode(this.swdom.dom);this.swdom.dom=null;}if(this.imgdom){YUtility.removeNode(this.imgdom);}this.aedom=null;this.swdom=null;this.imgdom=null;if(this.dom){YUtility.removeNode(this.dom);}this.dom=null;};Marker.prototype.setMapObject=function(_m){this._map=_m;if(this.Address){this._map._startGeoCode(this.Address,12,this.id);}};Marker.prototype.setYGeoPoint=function(_p){this.YGeoPoint=new YGeoPoint(_p.Lat,_p.Lon);this.setGeoXYPoint();};Marker.prototype.setAnnotation=function(o){this._annotate=o;};Marker.prototype.getAnnotation=function(){return this._annotate;};Marker.prototype._updateX=function(n){var t=this._xy;this._xy=new YCoordPoint(t.x+n,t.y);if(this._map){this._xybr=new YCoordPoint(this._xy.x+parseFloat(this._map.subContainer.style.left),this._xy.y+parseFloat(this._map.subContainer.style.top));}};Marker.prototype.setGeoXYPoint=function(){var _xybr=this._map._ll2xy(this.YGeoPoint);this._xybr=new YCoordPoint(_xybr.x+this._image.offset.x,(_xybr.y-this._image.size.height+this._image.offset.y));var _xy=this._map._ll2xy(this.YGeoPoint,1);this._xy=new YCoordPoint(_xy.x+this._image.offset.x,(_xy.y-this._image.size.height+this._image.offset.y));if(this._map&&this._map.MP){var absPos=this._xy.x+_xy._xscpos;var intPos=parseInt(absPos/this._map.MP.circum_px);if(absPos>this._map.YSize.width){this._xy.x=this._xy.x-(intPos)*this._map.MP.circum_px;}else{if(absPos<0){this._xy.x=this._xy.x-(intPos-1)*this._map.MP.circum_px;}}}if(!this._hidden){this.unhide();}};Marker.prototype.hide=function(_i){if(!_i){this._hidden=true;}this.dom.style.left=this.dom.style.top="-9500px";this.dom.style.zIndex=-9999;};Marker.prototype.ishidden=function(){return this._hidden;};Marker.prototype.unhide=function(){this._hidden=false;if(this._xy){this.dom.style.left=this._xy.x+"px";this.dom.style.top=this._xy.y+"px";if(this.swdom){this.dom.style.zIndex=888;}else{this.dom.style.zIndex=2;}}};Marker.prototype._defineEvents=function(){this.Events={};this.Events.openSmartWindow=new _captureEvent(EventsList.openSmartWindow,this);this.Events.closeSmartWindow=new _captureEvent(EventsList.closeSmartWindow,this);this.Events.closeSmartWindowClick=new _captureEvent(EventsList.closeSmartWindowClick,this);this.Events.openExpanded=new _captureEvent(EventsList.openExpanded,this);this.Events.closeExpanded=new _captureEvent(EventsList.closeExpanded,this);this.Events.MouseClick=new _captureEvent(EventsList.MouseClick,this);this.Events.MouseOver=new _captureEvent(EventsList.MouseOver,this);this.Events.MouseOut=new _captureEvent(EventsList.MouseOut,this);this.Events.MouseDoubleClick=new _captureEvent(EventsList.MouseDoubleClick,this);this.Events.MouseUp=new _captureEvent(EventsList.MouseUp,this);};Marker.prototype._registerEvents=function(){YEvent.Capture(this,EventsList.openSmartWindow,this._openSmartWindowRun);YEvent.Capture(this,EventsList.openExpanded,this._openExpandedRun);YEvent.Capture(this,EventsList.closeExpanded,this._closeExpandedRun);YEvent.Capture(this,EventsList.MouseClick,this._MouseClickRun,null,EventsList.click);YEvent.Capture(this,EventsList.MouseOver,this._MouseOverRun,null,EventsList.mover);YEvent.Capture(this,EventsList.MouseOut,this._MouseOutRun,null,EventsList.mout);YEvent.Capture(this,EventsList.MouseDoubleClick,this._MouseDoubleClickRun,null,EventsList.dblclick);YEvent.Capture(this,EventsList.MouseUp,this._MouseUpRun,null,EventsList.mup);};Marker.prototype._MouseClickRun=function(_e){if(YUtility.browser.id!=2){YEvent.stopEvent(_e);}var _ce=new _eO(this);this.Events.MouseClick.trigger(_ce);};Marker.prototype._MouseOverRun=function(_e){YEvent.stopEvent(_e);if(this._autoExpand){if(_expCache._exmid){if(this.id!=_expCache._exmid){_expCache._destroy();}}if(!this.swdom){_expCache.dom.style.zIndex=4;_expCache.setContent(this._expContent);_expCache.setColor(this.swColor);_expCache._exmid=this.id;YUtility.appendNode(this.dom,_expCache.dom);var _ce=(new _eO(this));this.Events.openExpanded.trigger(_ce);}}if(this.swdom){this.dom.style.zIndex=888;}else{this.dom.style.zIndex=3;}var _ce=new _eO(this);this.Events.MouseOver.trigger(_ce);};Marker.prototype._MouseOutRun=function(_e){YEvent.stopEvent(_e);var _ce=new _eO(this);this.Events.MouseOut.trigger(_ce);if(this.swdom){this.dom.style.zIndex=888;}else{if(!this._autoExpand&&!this.swdom){this.dom.style.zIndex=2;}}};Marker.prototype._MouseDoubleClickRun=function(_e){YEvent.stopEvent(_e);var _ce=new _eO(this);this.Events.MouseDoubleClick.trigger(_ce);};Marker.prototype._MouseUpRun=function(_e){var _ce=new _eO(this);this.Events.MouseUp.trigger(_ce);};Marker.prototype._openExpandedRun=function(e){if(!this.swdom){this.dom.style.zIndex=3;_expCache.dom.style.zIndex=4;}};Marker.prototype._closeExpandedRun=function(e){if(this.swdom){this.dom.style.zIndex=888;}else{this.dom.style.zIndex=2;}};Marker.prototype._openSmartWindowRun=function(e){for(var m in this._map._mTb){if(m!=e.thisObj.id){if(this._map._mTb[m].swdom){this._map._mTb[m].closeSmartWindow();}}}};Marker.prototype._closeSmartWindowRun=function(e){if(_nodeCache.divsw){delete _nodeCache.divsw;}};Marker.prototype.disableAutoContain=function(){this._disableAutoContain=true;};Marker.prototype.enableAutoContain=function(){this._disableAutoContain=false;};Marker.prototype.changeImage=function(_o){if(YUtility.browser.id==0){this.imgdom.style.filter=YUtility.alphaImg(_o.src);}else{this.imgdom.src=_o.src;}if(_o.size.width){this.imgdom.style.width=_o.size.width;}if(_o.size.height){this.imgdom.style.height=_o.size.height;}};Marker.prototype._createMarkerDom=function(){this.dom=YUtility.createNode("div");this.dom.id=this.id;this.dom.align="left";var _s={position:"absolute",zIndex:2,width:this._image.size.width+"px",height:this._image.size.height+"px"};YUtility.setStyle(this.dom,_s);this.imgdom=YUtility.createNode("img");this.imgdom.id="ymi"+this.id;YUtility.setStyle(this.imgdom,_s);if(!YUtility.browser.id){YUtility.setStyle(this.imgdom,"filter",YUtility.alphaImg(this._image.src,"image",this.imgdom));}else{this.imgdom.src=this._image.src;}YUtility.appendNode(this.dom,this.imgdom);};Marker.prototype.getElement=function(){return this.dom;};Marker.prototype.getCoordPoint=function(){var x=YUtility.getInt(this.dom.style.left);var y=YUtility.getInt(this.dom.style.top);return new YCoordPoint(x,y);};Marker.prototype.setSmartWindowColor=function(_c){var _ac={orange:"org",f19824:"org",blue:"blu",lightblue:"lbl","71a4c1":"lbl",violet:"blv",brown:"brn",green:"grn",black:"blk",grey:"gry",lightgreen:"lgn",a7cc25:"lgn",maroon:"mar",ocre:"ocr",purple:"ple"};this.swColor=_ac["org"];if(_ac[_c]){this.swColor=_ac[_c];}};Marker.prototype.reLabel=function(nl){if(this._domLabel){this._domLabel.innerHTML=nl;}};Marker.prototype.closeSmartWindow=function(_e){if(this.swdom){this.swdom._destroy();this.swdom.dom=null;this._marker=null;this.swdom=null;var _ce=new _eO(this);this.Events.closeSmartWindow.trigger(_ce);}};var _expCache=null;Marker.prototype.openAutoExpand=function(_c){if(this._autoExpand){if(!this.swdom){this.dom.style.zIndex=3;_expCache.dom.style.zIndex=4;_expCache.setContent(this._expContent);_expCache.setColor(this.swColor);_expCache._exmid=this.id;YUtility.appendNode(this.dom,_expCache.dom);var _ce=new _eO(this);this.Events.openExpanded.trigger(_ce);}}};Marker.prototype.closeAutoExpand=function(_c){if(this._autoExpand){_expCache._destroy();}};Marker.prototype.addAutoExpand=function(_c){this._autoExpand=true;this._expContent=_c;if(!_expCache){_expCache=new SmartWindow(this,_c,this._image,this.swColor,"swae"+this.id,true);_expCache.dom.style.width="160px";if(!YUtility.browser.id){_expCache.dom.style.cursor="hand";}if(YUtility.browser.id){_expCache.dom.style.cursor="pointer";}}};Marker.prototype.openSmartWindow=function(_c){if(_expCache){if(_expCache._exmid){_expCache._destroy();}}if(this.swdom){return ;}this.swdom=new SmartWindow(this,_c,this._image,this.swColor,this.id);YUtility.appendNode(this.dom,this.swdom.dom);this.dom.style.zIndex=888;this.swdom.dom.style.zIndex=888;if(!this._map){return ;}this.containSmartWindow();YEvent.Capture(this.swdom.dom._swclid,EventsList.MouseClick,this._runXcloser,this,"click");var _ce=new _eO(this);this.Events.openSmartWindow.trigger(_ce);};Marker.prototype.updateSmartWindow=function(_c){if(this.swdom&&this.swdom.setContent){this.swdom.setContent(_c);YEvent.Capture(this.swdom.dom._swclid,EventsList.MouseClick,this._runXcloser,this,"click");}};Marker.prototype._runXcloser=function(_e){YEvent.stopEvent(_e);this.closeSmartWindow();var _ce=new _eO(this);this.Events.closeSmartWindowClick.trigger(_ce);};var SmartWindow=function(_mrk,_c,_io,_clr,id,_ae){this._marker=_mrk;this._aeon=(_ae)?true:false;this._swid="ysmw"+((id)?id:"");if(this._aeon){this._swid="ysmwexp";}this._clids="clw"+this._swid;this._createNode();this.setColor(_clr);this.setContent(_c);this.setPosition(_io);this.id=this._swid;this._defineEvents();this._registerEvents();};SmartWindow.prototype._defineEvents=function(){this.Events={};this.Events.MouseClick=new _captureEvent(EventsList.MouseClick,this);this.Events.MouseOver=new _captureEvent(EventsList.MouseOver,this);this.Events.MouseOut=new _captureEvent(EventsList.MouseOut,this);this.Events.MouseDoubleClick=new _captureEvent(EventsList.MouseDoubleClick,this);this.Events.MouseUp=new _captureEvent(EventsList.MouseUp,this);this.Events.MouseDown=new _captureEvent(EventsList.MouseDown,this);};SmartWindow.prototype._registerEvents=function(){YEvent.Capture(this,EventsList.MouseClick,this._MouseClickRun,null,EventsList.click);YEvent.Capture(this,EventsList.MouseOver,this._MouseOverRun,null,EventsList.mover);YEvent.Capture(this,EventsList.MouseOut,this._MouseOutRun,null,EventsList.mout);YEvent.Capture(this,EventsList.MouseDoubleClick,this._MouseDoubleClickRun,null,EventsList.dblclick);YEvent.Capture(this,EventsList.MouseUp,this._MouseUpRun,null,EventsList.mup);YEvent.Capture(this,EventsList.MouseDown,this._MouseDownRun,null,EventsList.mdown);};SmartWindow.prototype._MouseClickRun=function(_e){if(YUtility.browser.id!=2){YEvent.stopPropag(_e);}if(this._aeon){var marker=this._marker._map._mTb[this._exmid];if(marker){var _ce=new _eO(marker);marker.Events.MouseClick.trigger(_ce);}}};SmartWindow.prototype._MouseOverRun=function(_e){YEvent.stopEvent(_e);};SmartWindow.prototype._MouseOutRun=function(_e){YEvent.stopEvent(_e);if(_expCache){_expCache._destroy();}};SmartWindow.prototype._MouseDoubleClickRun=function(_e){YEvent.stopEvent(_e);};SmartWindow.prototype._MouseUpRun=function(_e){};SmartWindow.prototype._MouseDownRun=function(_e){YEvent.stopEvent(_e);};SmartWindow.prototype._createNode=function(){this.dom=YUtility.createNode("div");this.dom.id=this._swid;this.dom._swclid=this._clids;};SmartWindow.prototype._destroy=function(_w){if(this.dom.parentNode&&this.dom.parentNode.style){this.dom.parentNode.style.zIndex=2;}if(this._exmid){if(this._marker._map){var marker=this._marker._map._mTb[this._exmid];var _ce=new _eO(marker);if(marker){marker.Events.closeExpanded.trigger(_ce);}this._exmid=null;}}else{}if(!this._aeon){YEvent.ClearAll(this);}YUtility.removeNode(this.dom);};SmartWindow.prototype._hide=function(){YUtility.setStyle(this.dom,"zIndex",-10);};SmartWindow.prototype._show=function(){YUtility.setStyle(this.dom,"zIndex",99);};SmartWindow.prototype.setPosition=function(o){if(!o){return ;}var _x=o.offsetSmartWindow.x+"px";var _y=o.offsetSmartWindow.y+"px";var _so={"position":"absolute","left":_x,"bottom":_y};YUtility.setStyle(this.dom,_so);};SmartWindow.prototype._combine=function(){this.dom.innerHTML=this._sc+this._data+this._ec;};SmartWindow.prototype.setContent=function(_c){if(!_c){return ;}this._data=_c;if(_c.nodeValue){this._data=_c.nodeValue;}this._combine();};SmartWindow.prototype.setColor=function(_clr){var w=new _sw(_clr,this._clids,this._aeon);this._sc=w._sc;this._ec=w._ec;this._combine();};var _sw=function(_clr,_clids,ae){var _s,_sw,_ne,_se,_e,_nw,_n,_w;var _swi=YMapConfig.imgPrefixURL;var _col=(_clr)?_clr:"org";var _cls=_swi+"x.gif";if(!YUtility.browser.id){_s="filter:"+YUtility.alphaImg(_swi+_col+"_s.png");_sw="filter:"+YUtility.alphaImg(_swi+_col+"_sw.png");_ne="filter:"+YUtility.alphaImg(_swi+_col+"_ne.png");_se="filter:"+YUtility.alphaImg(_swi+_col+"_se.png");_e="filter:"+YUtility.alphaImg(_swi+_col+"_e.png");_nw="filter:"+YUtility.alphaImg(_swi+_col+"_nw.png");_n="filter:"+YUtility.alphaImg(_swi+_col+"_n.png");_w="filter:"+YUtility.alphaImg(_swi+_col+"_w.png");}else{_nw="background:url("+_swi+_col+"_nw.png) bottom no-repeat;";_n="background:url("+_swi+_col+"_n.png) bottom repeat-x;";_ne="background:url("+_swi+_col+"_ne.png) bottom left no-repeat;";_sw="background:url("+_swi+_col+"_sw.png);";_s="background:url("+_swi+_col+"_s.png) repeat-x;";_se="background:url("+_swi+_col+"_se.png) no-repeat;";_e="background:url("+_swi+_col+"_e.png) repeat-y;";_w="background:url("+_swi+_col+"_w.png) repeat-y;";}var _x="";var _spid="yswid";var _stla="margin-top: -0.1em;";if(!ae){var _als='style="position:relative;top:0.05em;right:0.05em;cursor:pointer;border:none;"';_x='<img id="'+_clids+'" '+_als+' src="'+_cls+'" alt="" width="12" height="12 border="0">';_spid="ysaeid";if(YUtility.browser.id){_stla="margin-top: -1.0em;margin-right: 1.0em;";}else{_stla="margin-top: -0.8em;margin-right: 1.0em;";}}this._sc='<div><table cellspacing="0" cellpadding="0" border="0"><tr style="line-height:6px"><td style="line-height:6px; '+_nw+'">&nbsp;</td><td style="line-height:6px; '+_n+'"></td><td style="line-height:6px; '+_ne+'"></td></tr><tr><td style="'+_w+'"></td> <td align=right valign=top bgcolor="#ffffff">'+_x+'<div id="'+_spid+'" style="text-align:left;'+_stla+'">';this._ec='</div></td><td style="'+_e+'">&nbsp;&nbsp;&nbsp;</td></tr><tr style="height:16px;"><td style="height:16px; '+_sw+'"></td><td style="height:16px; '+_s+'"></td><td style="height:16px; '+_se+'"></td></tr  </table></div>';YEvent.Capture(_spid,EventsList.MouseOut,function(_e){YEvent.stopPropag(_e);},null,"mouseout");};Marker.prototype.containSmartWindow=function(){var _x=_y=0;var _ws;if(this.swdom){_ws=YUtility.getSize(this.swdom.dom);if(!this.swdom.dom.style.width){this.swdom.dom.style.width="160px";}}else{if(_expCache){_ws=YUtility.getSize(_expCache.dom);}else{return ;}}var _mp=this._map._ll2xy(this.YGeoPoint);if(this._xybr){_mp=new YCoordPoint(this._xybr.x,this._xybr.y+this._image.size.height);}var _mvbx=_ws.width;var _mvby=_ws.height;var cmX=this._image.size.width+this._image.offsetSmartWindow.x;var cmY=this._image.size.height+this._image.offsetSmartWindow.y;var nx=_mvbx-(this._map.YSize.width-_mp.x);var ny=_mp.y-_mvby;var _off=0;if(_mp.x<_off){_x=cmX-_mp.x;}else{if(nx>0){_x=-(nx+cmX);}}if(ny<_off){_y=-(ny-cmY);}else{if(_mp.y>this._map.YSize.height){_y=this._map.YSize.height-_mp.y-cmY;}}if(this.correctLogoSearch){var _wls=205;var _hls=165;var _xlse=this._map.YSize.width-_wls;var _ylse=this._map.YSize.height-_hls;var _xuc=_mp.x+_ws.width;var _yuc=_mp.y-_ws.height;var _xd=_xlse-_xuc;var _yd=_ylse-_yuc;if(_xd<0){_x=_xd+_x;}if(_yd<0){_y=_yd+_y;}}if(!this._disableAutoContain){this._map.smoothPan(new YCoordPoint(_x,_y));}};Marker.prototype.addLabel=function(cin){if(this._domLabel){return ;}var o=YUtility.createNode("div");o.style.position="absolute";o.style.fontWeight="bold";o.style.textAlign="center";o.style.width="20px";o.style.height="20px";o.onmouseover=function(){o.style.cursor="default";};o.style.zIndex=2;o.innerHTML=cin;this._domLabel=o;YUtility.setDefaultSelectStyle(o);YUtility.appendNode(this.dom,this._domLabel);};Marker.prototype.calculatePosition=function(z){this.MP=new MercatorProjection(z);return this.MP.ll_to_xy(this.YGeoPoint);};var GeoCode=function(a,m){if(!m){return ;}this.GeoAddress=a||false;this.Obj=m;this.getPoint=GeoCode.getPoint;};GeoCode.prototype.set=function(s,t,id){var mID=(id)?id:"map";var qtype=(t)?t:99;var rnd=YUtility.getRandomID();var _id="ygeocodenode:"+rnd;if(s){var req=YMapConfig.geoCoder;req+="appid="+YMAPPID+"&qs="+escape(s)+"&qt="+qtype;req+="&mid="+this.Obj.id;req+="&id="+mID+"&r="+rnd;YUtility.dynamicSNode(_id,req);}};GeoCode.getPoint=function(s,t){if(s&&s.GeoMID){_GTab[s.GeoMID]._endGeoCode(s,t);}};var GeoRSS=function(a){this.GeoRSS=a||false;this.Obj=null;};GeoRSS.prototype.set=function(s,m,t){this.Obj=m;var rnd=YUtility.getRandomID();var _id="ygeorssnode:"+rnd;if(s){var req=YMapConfig.geoRSS;req+="appid="+YMAPPID+"&xml="+escape(s)+"&r="+YUtility.getRandomID()+"&mid="+this.Obj.id+"&t="+t;YUtility.dynamicSNode(_id,req);}};GeoRSS.get=function(s,m,t){if(s&&m){_GTab[m]._endGeoRSS(s,t);}};var GeoSearch=function(s,t,m,r,q,n){this.GeoSearch=s||false;this.id=m;this._q=q||"*";this.set(s,t,r,n);};GeoSearch.prototype.set=function(s,t,r,n){var rnd=YUtility.getRandomID();var rid=(t==1)?"ygeolocsrch:"+rnd:"ygeotrfsrch"+rnd;var req;if(s){req=(t==1)?YMapConfig.localSearch:YMapConfig.trafficSearch;req+="appid="+YMAPPID+"&ll="+(s)+"&rr="+YUtility.getRandomID()+"&mid="+this.id+"&t="+t;req+=((t==1)?"&q="+this._q:"");req+=(r?"&r="+r:"");req+=(n?"&n="+n:"");YUtility.dynamicSNode(rid,req);}};GeoSearch.get=function(s,m,t){if(s&&m){_GTab[m]._endGeoSearch(s,t);}};var Template=function(p,d){this._p=p;this._d=d;};Template.prototype.process=function(mu){var im=new YImage();if(this._d.BASEICON){im.src=this._d.BASEICON.src;var w=this._d.BASEICON.width?this._d.BASEICON.width:10;var h=this._d.BASEICON.height?this._d.BASEICON.height:15;im.size=new YSize(w,h);im.offsetSmartWindow=new YCoordPoint(0,h);}var mrk=new YMarker(this._p,im);var csy=this._d.YMAPS_CITYSTATE?this._d.YMAPS_CITYSTATE:"";var zip=this._d.YMAPS_ZIP?this._d.YMAPS_ZIP:"";var ao={title:this._d.TITLE,link:this._d.LINK,description:this._d.DESCRIPTION};mrk.setAnnotation(ao);var sw=new Object();sw.title=this._d.TITLE?"<b>"+this._d.TITLE+"</b><br/>":"";sw.address=this._d.YMAPS_ADDRESS?this._d.YMAPS_ADDRESS+"<br/>":"";sw.city_state=csy?csy+"<br/>":"";sw.phone=this._d.YMAPS_PHONENUMBER?this._d.YMAPS_PHONENUMBER+"<br/>":"";sw.description=(this._d.DESCRIPTION)?"<div style='width:200px;'>"+this._d.DESCRIPTION+"</div><br/>":"";sw.link=this._d.LINK?"<a href='"+this._d.LINK+"' target='_blank'>":"";sw.lnam=sw.link?sw.title+"</a>":"";sw.eimgTitle=sw.eimg="";if(this._d.YMAPS_EXTRAIMAGE){sw.eimgTitle=this._d.YMAPS_EXTRAIMAGE.TITLE?this._d.YMAPS_EXTRAIMAGE.TITLE:"";sw.eimg=this._d.YMAPS_EXTRAIMAGE.URL?'<br/><img src="'+this._d.YMAPS_EXTRAIMAGE.URL+'" border=0 title="'+sw.eimgTitle+'">':"";}sw.itmurl=this._d.YMAPS_ITEMURL?'<iframe src="'+this._d.YMAPS_ITEMURL+'"></iframe>':"";sw.dirt='<a href="http://maps.yahoo.com/dd?taddr='+escape(this._d.YMAPS_ADDRESS)+"&tlt="+this._d.GEO_LAT+"&tln="+this._d.GEO_LONG+"&tname="+this._d.TITLE+"&tcsz="+escape(csy)+" "+zip+'+&terr=12" target=_blank>To here</a>';sw.dirf='<a href="http://maps.yahoo.com/dd?newaddr='+escape(this._d.YMAPS_ADDRESS)+"&slt="+this._d.GEO_LAT+"&sln="+this._d.GEO_LONG+"&name="+this._d.TITLE+"&csz="+escape(csy)+" "+zip+'&oerr=12" target=_blank>From here</a>';sw.dirline=(csy||zip)?"Directions: "+sw.dirt+" - "+sw.dirf:"";var ht='<div style=\'margin: 0 3px 2px 3px;\'><font face="verdana,geneva,sans-serif" size="-2">'+sw.title+sw.address+sw.city_state+sw.phone+sw.description+sw.link+sw.lnam+sw.dirline+sw.eimg+sw.itmurl+"</font></div>";YEvent.Capture(mrk,EventsList.MouseClick,function(){this.openSmartWindow(ht);});return mrk;};var _eO=function(o,p,z){this.thisObj=o;this.YGeoPoint=p;this.zoomObj=z;};function eventObjectGeoRSS(m,u,d){this.ThisMap=m;this.URL=u;this.Data=d||null;this.success=(d&&d.success)?d.success:0;}function eventObjectGeoCode(m,a,g,s){this.ThisMap=m;this.Address=a;this.GeoPoint=g||null;this.success=s||0;}var _setBounds=function(tx,ty,bx,by){this.bL=tx-bx;this.bR=tx+bx;this.bT=ty+by;this.bB=ty-by;};_setBounds.prototype={abL:function(){this.pbL=this.bL;this.bL--;},abR:function(){this.pbR=this.bR;this.bR++;},abT:function(){this.pbT=this.bT;this.bT++;},abB:function(){this.pbB=this.bB;this.bB--;},sbL:function(){this.bL++;},sbR:function(){this.bR--;},sbT:function(){this.bT--;},sbB:function(){this.bB++;},inB:function(x,y){if(x>=this.bL&&x<=this.bR){if(y<=this.bT&&y>=this.bB){return true;}}return false;}};var _GTab={};YAHOO_MAP_REG="YAHOO_MAP";YAHOO_MAP_SAT="YAHOO_SAT";YAHOO_MAP_HYB="YAHOO_HYB";var Map=function(_c,_t,_s){try{if(typeof _c=="string"){_c=document.getElementById(_c);}this.YSize=this._getContainerSize(_c,_s);}catch(x){throw ("Y!Map.Error "+x+", no container object!");}this._defaultStart();this._setParentContainer(_c);this._defineEvents();this._registerEvents();this.setMapType(_t);this._tileCache=[];this._posTbl=[];this._vueTbl=[];this._mTb=[];this._pTb=[];this._totalX=this._totalY=0;this._myTX=this._myTY=0;_GTab[this.id]=this;};Map.prototype={resetXY:function(){this._totalX=this._totalY=0;},getProjection:function(zm){return(zm&&zm!=this.zoomLevel)?(new MercatorProjection(zm)):this.MP;},getTXY:function(){return this._txy;},getTileInfo:function(gp,zm){var mo;mo=(zm&&zm!=this.zoomLevel)?(new MercatorProjection(zm)):this.MP;var txy=mo.ll_to_xy(gp);var tll=mo.xy_to_ll(txy.tx,txy.ty,0,0);var pointpxy=mo.ll_to_pxy(gp.Lat,gp.Lon);var tilepxy=mo.ll_to_pxy(tll.Lat,tll.Lon);return{xy:txy,ll:tll,cp:{x:pointpxy.x-tilepxy.x,y:tilepxy.y-pointpxy.y}};},getTileFill:function(){var b=this.getBounds();var t=this.getTileInfo(b.min);var fx=this._xyFill.width*2+1;var fy=this._xyFill.height*2+1;return{x:t.xy.tx,y:t.xy.ty,nx:fx,ny:fy};},setAnnotation:function(o){this._annotate=o;},getAnnotation:function(){return this._annotate;},getElement:function(){return this.dom;},exportFormat:function(t){if(t!="GEORSS"){return ;}var mt=this.getMarkerIDs();var pt=this.getPolylineIDs();var ma=this.getAnnotation();var cp=this.YGeoPoint;var _s='<?xml version="1.0"?>';_s+='<rss version="2.0" xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#" xmlns:ymaps="http://api.maps.yahoo.com/Maps/V2/AnnotatedMaps.xsd">';_s+="<channel>";var _e="</channel>";_e+="</rss>";if(ma&&ma.valid){if(ma.title){_s+="<title>"+ma.title+"</title>";}if(ma.description){_s+="<description>"+ma.description+"</description>";}if(ma.link){_s+="<link>"+ma.link+"</link>";}}var _1s="<item>";var _1e="</item>";var _m="";for(var i=0;i<pt.length;i++){var o=this.getPolylineObject(pt[i]);_m+=_1s;var ln="";for(var j=0;j<o._plength;j++){ln+=o._path[j].Lat+","+o._path[j].Lon+((j!=o._plength-1)?" ":"");}if(ln){_m+="<geo:line>"+ln+"</geo:line>";}if(o._color){_m+="<linecolor>"+o._color+"</linecolor>";}if(o._weight){_m+="<linewidth>"+o._weight+"</linewidth>";}if(o._alpha){_m+="<linealpha>"+o._alpha+"</linealpha>";}_m+=_1e;}for(var i=0;i<mt.length;i++){_m+=_1s;var o=this.getMarkerObject(mt[i]);var ga=o.getAnnotation();if(ga){if(ga.title){_m+="<title><![CDATA["+ga.title+"]]></title>";}if(ga.link){_m+="<link>"+ga.link+"</link>";}if(ga.description){_m+="<description><![CDATA["+ga.description+"]]></description>";}}if(o._image.src){}_m+="<geo:lat>"+o.YGeoPoint.Lat+"</geo:lat>";_m+="<geo:long>"+o.YGeoPoint.Lon+"</geo:long>";_m+=_1e;}var _rss=_s+_m+_e;return _rss;},_defaultStart:function(){this._mapType=YAHOO_MAP_REG;this.setZoomRange(1,17);this.zoomLevelPrev=null;this._disableDrag=false;this._txy=new YCoordPoint();},_setMapTypeHigh:function(_i){var _t=(_i)?_i:this._mapType;var _k=(this._ctrlType)?this._ctrlType.id:null;if(!_k){return ;}var _tps=this._ctrlType._types;for(var i=0;i<_tps.length;i++){var _ik=_tps[i];var _obj=this._ctrlType._bobj[_ik].YObj;if(!YUtility.browser.id){this._ctrlType._bobj[_ik].YObj.style.filter=YUtility.alphaImg2(_obj._iefix.src)+" alpha(opacity=80)";}else{this._ctrlType._bobj[_ik].style.opacity=0.8;}this._ctrlType._bobj[_ik].style.borderWidth="0px";if(_t==_ik){if(!YUtility.browser.id){this._ctrlType._bobj[_ik].YObj.style.filter=YUtility.alphaImg2(_obj._iefix.src)+" alpha(opacity=99)";}else{this._ctrlType._bobj[_ik].style.opacity=1;}this._ctrlType._bobj[_ik].style.borderWidth="0.1px";}}},setMapType:function(_t){if(!_t||this._mapType==_t){return ;}this._mapType=_t;this._setMapTypeHigh();if(this.YGeoPoint){this.drawZoomAndCenter(this.YGeoPoint,this.zoomLevel);}},getMapTypes:function(){var _t=[YAHOO_MAP_REG,YAHOO_MAP_SAT,YAHOO_MAP_HYB];return _t;},getCurrentMapType:function(){return this._mapType;},addTypeControl:function(_t,_a,_c){for(var i=0;i<arguments.length;i++){var o=arguments[i];if(typeof o=="object"){if(o.valid){_c=o;}else{_t=o;}}if(typeof o=="string"){_a=o;}}if(!_c){_c=new YCoordPoint(110,5);_c.translate("right","top");}this._typeControlPosition=_c;this._ctrlType=new TypeControl(this._typeControlPosition,_t);var _dc={YAHOO_MAP:YMapConfig.imgPrefixURL+"med_map.png?v=1.3",YAHOO_SAT:YMapConfig.imgPrefixURL+"med_sat.png?v=1.3",YAHOO_HYB:YMapConfig.imgPrefixURL+"med_hyb.png?v=1.3"};for(var i=0;i<this._ctrlType._types.length;i++){var dt=this._ctrlType._types[i];this._ctrlType.setControl(dt,new YImage(_dc[dt],new YSize(33,17)),new YSize(33,17));}this._ctrlType.setHorizontal();if(_a=="v"){this._ctrlType.setVertical();}this.addOverlay(this._ctrlType);var _ce=new _eO(this,this.YGeoPoint);this.Events.MapTypeControlAdded.trigger(_ce);},addNavigatorControl:function(c){if(!c){c=new YCoordPoint(5,5);c.translate("right","bottom");}this._miniPosition=c;if(!this._miniObj){this._miniObj=new MiniControl(this.zoomLevel,this._miniPosition);this.addOverlay(this._miniObj);var _ce=(new _eO(this,this.YGeoPoint,{previous:this.zoomLevelPrev,current:this.zoomLevel}));this.Events.miniAdded.trigger(_ce);}},_showMini:function(){},addZoomLong:function(c){this._zoomType=false;this._createZoomControl(c);},addZoomShort:function(c){this._zoomType=true;this._createZoomControl(c);},_createZoomControl:function(c){if(!c){c=new YCoordPoint(5,5);}this._zoomPosition=c;if(!this.zoomLevel){YEvent.Capture(this,EventsList.endMapDraw,this._updateZoomLevel);}else{this._updateZoomLevel();}},_updateZoomLevel:function(){if(!this._ctrlZoom){this._ctrlZoom=new ZoomControl(this.zoomLevel,this._zoomPosition,this._zoomType);this.addOverlay(this._ctrlZoom);var _ce=(new _eO(this,this.YGeoPoint,{previous:this.zoomLevelPrev,current:this.zoomLevel}));this.Events.zoomAdded.trigger(_ce);}},removeZoomControl:function(){this.removeOverlay(this._ctrlZoom.id);this._ctrlZoom=null;this._zoomON=false;},setZoomLevel:function(z){if(this.isValidZoomLevel(z)){if(Math.abs(z-this.zoomLevel)){this._setZoomLevel(YUtility.getInt(z));}}},_setZoomLevel:function(z,p){this.zoomLevelPrev=p||this.zoomLevel;this.drawZoomAndCenter(this.YGeoPoint,z);},setZoomRange:function(min,max){this._zoomMin=min;this._zoomMax=max;YEvent.Capture(this,EventsList.zoomAdded,this._updateZoomRange);},_updateZoomRange:function(){if(this._ctrlZoom){this._ctrlZoom.setMinMax(this._zoomMin,this._zoomMax);}},getZoomValidLevels:function(){return this.vZoom;},isValidZoomLevel:function(z){if(this._zr[YUtility.getInt(z)-1]&&z>=this._zoomMin&&z<=this._zoomMax){return true;}return false;},addPanControl:function(c){if(!c){c=new YCoordPoint(25,5);}this._panPosition=c;if(!this._ctrlPan){this._ctrlPan=new PanControl(this._panPosition);this.addOverlay(this._ctrlPan);}},removePanControl:function(){this.removeOverlay(this._ctrlPan.id);this._ctrlPan=null;},_processLogoSearch:function(e){var sti=["sl_st05.gif","sl_st1.gif","sl_st15.gif","sl_st2.gif","sl_st25.gif","sl_st3.gif","sl_st35.gif","sl_st4.gif","sl_st45.gif","sl_rst.gif"];var setupMarker=function(p,l){var im=new YImage(YMapConfig.imgPrefixURL+"smarker71a4c2.png",new YSize(23,32),new YCoordPoint(0,0));var _idm=l.PHONE.replace(/[\(\)\s]/g,"");var m=new YMarker(p,im,"ymrkloc"+_idm);m.correctLogoSearch=true;var iar=YMapConfig.imgPrefixURL+"sl_earr.gif";var etx='<div style="font:10 tahoma;">'+l.TITLE+"<img src="+iar+"></div>";m.setSmartWindowColor("71a4c1");m.addAutoExpand(etx);var _br="<br>";var ets='<div style="font:10 tahoma;width:130px;height:auto;"><b>'+l.TITLE+"</b>"+_br;if(l.PHONE){ets+=l.PHONE+_br;}if(l.ADDRESS){ets+=l.ADDRESS+_br;}if(l.CITY){ets+=l.CITY+", "+l.STATE+_br;}if(l.RATING&&l.RATING.AVERAGERATING){var si=isNaN(l.RATING.AVERAGERATING)?"":l.RATING.AVERAGERATING;var _imc;if(si<1){_imc=sti[0];}if(si==1){_imc=sti[1];}if(si>1&&si<2){_imc=sti[2];}if(si==2){_imc=sti[3];}if(si>2&&si<3){_imc=sti[4];}if(si==3){_imc=sti[5];}if(si>3&&si<4){_imc=sti[6];}if(si==4){_imc=sti[7];}if(si>4&&si<5){_imc=sti[8];}if(si==5){_imc=sti[9];}var im=(si)?"<img src="+YMapConfig.imgPrefixURL+_imc+">":"";ets+=im;if(YUtility.getInt(l.RATING.TOTALREVIEWS)){ets+=" ("+l.RATING.TOTALREVIEWS+")";}ets+=" <a href="+l.URL+" target=_blank>Rate it</a>";ets+="<br>";}var _dd=YMapConfig.mapsSite+"/dd?";var _addr=l.ADDRESS;var _city=l.CITY+","+l.STATE;var _ddt=_dd+"tname="+escape(l.TITLE)+"&taddr="+escape(_addr)+"&tcsz="+_city;var _ddf=_dd+"name="+escape(l.TITLE)+"&newaddr="+escape(_addr)+"&csz="+_city;ets+="<a href="+_ddt+" target=_blank>Directions To</a>";ets+=" | ";ets+="<a href="+_ddf+" target=_blank>From</a>";ets+="<br>";ets+="<a href="+l.URL+" target=_blank>More Info</a>";ets+="<br>";ets+="</div>";YEvent.Capture(m,EventsList.MouseClick,function(e){m.openSmartWindow(ets);});return m;};var _p=[];var nres=e.Data.ITEMS.length;this._nls._n0.style.visibility="visible";this._nls._n0.innerHTML=nres+((nres==1)?" result":" results");if(e.Data){for(var a in e.Data.ITEMS){var l=e.Data.ITEMS[a];if(l.TITLE){var p=new YGeoPoint(l.LATITUDE,l.LONGITUDE);_p.push(p);var m=setupMarker(p,l);this._nls._markers.push(m);this.addOverlay(m);}}}},disableLogoSearch:function(){this.removeOverlay("ylocalsearch");this._ylogo2();},enableLogoSearch:function(){this.removeOverlay("ycopy2");this.removeOverlay("ylogo");this._ylogo();},_ylogo:function(){if(this._coordTable["ylocalsearch"]||this._coordTable["ylogo"]){return ;}if(this.YSize.width<245||this.YSize.height<205){this.disableLogoSearch();return ;}var cp=new YCoordPoint(0,0);cp.translate("right","bottom");this._nls=new logoSearch(cp);YEvent.Capture(this,EventsList.onEndLocalSearch,this._processLogoSearch);var that=this;this._nls._form.onsubmit=function(){var bds=that.getBoundsLatLon();var npt1=new YGeoPoint(that.YGeoPoint.Lat,bds.max.Lon);var npt2=new YGeoPoint(bds.max.Lat,that.YGeoPoint.Lon);var dst1=that.YGeoPoint.distance(npt1);var dst2=that.YGeoPoint.distance(npt2);var dst=(dst1.miles>dst2.miles)?dst2.miles:dst1.miles;var nres=10;that.searchLocal(that.YGeoPoint,that._nls._i.value,(dst),nres);return false;};this._nls._form.onmousedown=function(){that.disableDragMap();};this._nls._form.onmouseup=function(){that.enableDragMap();};this._nls._nC.onclick=function(){that._nls._i.value="";that._nls._n0.innerHTML="";for(var m=0;m<that._nls._markers.length;m++){that.removeOverlay(that._nls._markers[m]);}};this._nls._i.tabIndex=999;this.addOverlay(this._nls);},_ylogo2:function(){if(this._disableLogo){return ;}var _l=YUtility.createNode("img");var _s={position:"absolute",width:"71px",height:"13px",zIndex:3};_l.src=YMapConfig.ylogo;YUtility.setStyle(_l,_s);var _p=new YCoordPoint(1,12);_p.translate("right","bottom");var _ol=new YCustomOverlay(_p,_l);_ol.id="ylogo";this.addOverlay(_ol);this._ycpyr();},_datacopy:function(w){var _id="ycopy1";if(this._coordTable[_id]){return ;}var _sc={position:"absolute",zIndex:3,cursor:"default",fontSize:"9px",width:"230px",height:"10px",fontFamily:"verdana",color:"#000",fontWeight:200,textAlign:"left"};var _l1=YUtility.createNode("div");if(typeof YMapConfig.copyReg=="object"){_l1._cimg=YUtility.createNode("img");if(w){_l1._cimg.src=YMapConfig.copyHyb.service+"&x="+this._txy.tx+"&y="+this._txy.ty+"&z="+this.zoomLevel+"&top="+this._xyFill.width/2+"&left="+this._xyFill.height/2;}else{_l1._cimg.src=YMapConfig.copyReg.service+"&x="+this._txy.tx+"&y="+this._txy.ty+"&z="+this.zoomLevel+"&top="+this._xyFill.width/2+"&left="+this._xyFill.height/2;}YUtility.alphaLoad(_l1._cimg);YUtility.appendNode(_l1,_l1._cimg);YUtility.setStyle(_l1._cimg,_sc);}else{_l1.innerHTML=YMapConfig.copyReg;}YUtility.setStyle(_l1,_sc);var _p1;if(w){YUtility.setStyle(_l1,"color","#fff");_p1=new YCoordPoint(202,0);}else{_p1=new YCoordPoint(1,0);}_p1.translate("left","bottom");var _ovcpy1=new YCustomOverlay(_p1,_l1);_ovcpy1.id=_id;this.addOverlay(_ovcpy1);},_satcopy:function(np){var _id="ycopy3";if(this._coordTable[_id]){return ;}var _sc={position:"absolute",zIndex:3,cursor:"default",height:"10px",width:"200px",textAlign:"left"};var _l3=YUtility.cloneNode("img",_id);if(typeof YMapConfig.copySat=="object"){_l3.src=YMapConfig.copySat.service+"&x="+this._txy.tx+"&y="+this._txy.ty+"&z="+this.zoomLevel+"&ew=1&ns=1";}YUtility.setStyle(_l3,_sc);YUtility.setStyle(_l3,"filter",YUtility.alphaImg(_l3.src));var _p3=(np)?np:new YCoordPoint(1,0);_p3.translate("left","bottom");var _ovcpy3=new YCustomOverlay(_p3,_l3);_ovcpy3.id=_id;this.addOverlay(_ovcpy3);},disableCopyright:function(){this._disableCopy=true;},_ycopy:function(){if(this._disableCopy){return ;}var _sc={position:"absolute",zIndex:3,cursor:"default",textAlign:"left"};if(this._mapType==YAHOO_MAP_REG){this.removeOverlay("ycopy1");this._datacopy();this.removeOverlay("ycopy3");}else{if(this._mapType==YAHOO_MAP_SAT){this.removeOverlay("ycopy3");this._satcopy();this.removeOverlay("ycopy1");}else{if(this._mapType==YAHOO_MAP_HYB){this.removeOverlay("ycopy1");this._datacopy(1);this.removeOverlay("ycopy3");this._satcopy();}}}},_ycpyr:function(){var _sc={position:"absolute",zIndex:3,fontSize:"7pt",fontStyle:"normal",fontFamily:"verdana",color:"#000",cursor:"default",textAlign:"right"};var c2id="ycopy2";if(!this._coordTable[c2id]){var _l2=YUtility.createNode("div");_l2.innerHTML=YMapConfig.copyText;YUtility.setStyle(_l2,_sc);var _p2=new YCoordPoint(1,1);_p2.translate("right","bottom");var _ol2=new YCustomOverlay(_p2,_l2);_ol2.id=c2id;this.addOverlay(_ol2);}},removeYLogo:function(){this._disableLogo=true;this.removeOverlay("ylogo");},removeYCopy:function(){this._disableCopy=true;this.removeOverlay("ycopy1");this.removeOverlay("ycopy2");this.removeOverlay("ycopy3");},_yscale:function(){if(this._zoomScaleDisabled){return ;}this.addZoomScale();},addZoomScale:function(){if(!this._ovMapScale){this._ovMapScale=new Scale(this.zoomLevel,this.getUnitsPerPixel(),this._zr);this.addOverlay(this._ovMapScale);}this._zoomScaleDisabled=false;},removeZoomScale:function(){if(this._ovMapScale){this.removeOverlay(this._ovMapScale.id);this._ovMapScale=null;}this._zoomScaleDisabled=true;},_defineEvents:function(){this.Events={};this.Events.endPan=new _captureEvent(EventsList.endPan,this);this.Events.endAutoPan=new _captureEvent(EventsList.endAutoPan,this);this.Events.startPan=new _captureEvent(EventsList.startPan,this);this.Events.startAutoPan=new _captureEvent(EventsList.startAutoPan,this);this.Events.onPan=new _captureEvent(EventsList.onPan,this);this.Events.changeZoom=new _captureEvent(EventsList.changeZoom,this);this.Events.changeMapType=new _captureEvent(EventsList.changeMapType,this);this.Events.onStartGeoCode=new _captureEvent(EventsList.onStartGeoCode,this);this.Events.onEndGeoCode=new _captureEvent(EventsList.onEndGeoCode,this);this.Events.onStartGeoRSS=new _captureEvent(EventsList.onStartGeoRSS,this);this.Events.onEndGeoRSS=new _captureEvent(EventsList.onEndGeoRSS,this);this.Events.onEndTrafficSearch=new _captureEvent(EventsList.onEndTrafficSearch,this);this.Events.onEndLocalSearch=new _captureEvent(EventsList.onEndLocalSearch,this);this.Events.endPanOB=new _captureEvent(EventsList.endPanOB,this);this.Events.endMapDraw=new _captureEvent(EventsList.endMapDraw,this);this.Events.zoomAdded=new _captureEvent(EventsList.zoomAdded,this);this.Events.MapTypeControlAdded=new _captureEvent(EventsList.MapTypeControlAdded,this);this.Events.miniAdded=new _captureEvent(EventsList.miniAdded,this);this.Events.polylineAdded=new _captureEvent(EventsList.polylineAdded,this);this.Events.polylineRemoved=new _captureEvent(EventsList.polylineRemoved,this);this.Events.MouseClick=new _captureEvent(EventsList.MouseClick,this);this.Events.MouseUp=new _captureEvent(EventsList.MouseUp,this);this.Events.MouseDoubleClick=new _captureEvent(EventsList.MouseDoubleClick,this);this.Events.MouseOver=new _captureEvent(EventsList.MouseOver,this);this.Events.MouseOut=new _captureEvent(EventsList.MouseOut,this);this.Events.MouseDown=new _captureEvent(EventsList.MouseDown,this);this._endPan=true;this.keyTypes={};this.keyTypes.zoomIn=1;this.keyTypes.zoomOut=2;this.keyTypes.panN=3;this.keyTypes.panS=4;this.keyTypes.panW=5;this.keyTypes.panE=6;this.keyTypes.panNW=7;this.keyTypes.panNE=8;this.keyTypes.panSW=9;this.keyTypes.panSE=10;this.Events.KeyDown=new _captureEvent(EventsList.KeyDown,this);this.Events.KeyUp=new _captureEvent(EventsList.KeyUp,this);},_registerEvents:function(){YEvent.Capture(window,EventsList.resize,this._onResizeRun,this);YEvent.Capture(window,EventsList.unload,this._runUnload,this);YEvent.Capture(this,EventsList.wheel,this._runWheel);YEvent.Capture(this,EventsList.endPanOB,this._endPanOBRun);YEvent.Capture(this,EventsList.endMapDraw,this._endMapDrawRun);YEvent.Capture(this,EventsList.zoomAdded,this._zoomAddedRun);YEvent.Capture(this,EventsList.MapTypeControlAdded,this._MapTypeControlAddedRun);YEvent.Capture(this,EventsList.miniAdded,this._miniAddedRun);YEvent.Capture(this,EventsList.endPan,this._runendPan);YEvent.Capture(this,EventsList.endAutoPan,this._runendPan);YEvent.Capture(this,EventsList.startPan,this._runstartPan);YEvent.Capture(this,EventsList.onPan,this._runonPan);YEvent.Capture(this,EventsList.changeZoom,this._runchangeZoom);YEvent.Capture(this,EventsList.changeMapType,this._changeMapTypeRun);YEvent.Capture(this,EventsList.polylineAdded,this._polylineAddedRun);YEvent.Capture(this,EventsList.polylineRemoved,this._polylineRemovedRun);YEvent.Capture(this,EventsList.MouseClick,this._MouseClickRun,null,EventsList.click);YEvent.Capture(this,EventsList.MouseUp,this._MouseUpRun,null,EventsList.mup);YEvent.Capture(this,EventsList.MouseDoubleClick,this._DoubleClickRun,null,EventsList.dblclick);YEvent.Capture(this,EventsList.MouseDown,this._MouseDownRun,null,EventsList.mdown);YEvent.Capture(this,EventsList.MouseOver,this._MouseOverRun,null,EventsList.mover);YEvent.Capture(this,EventsList.MouseOut,this._MouseOutRun,null,EventsList.mout);YEvent.Capture(this,EventsList.MouseDoubleClick,this._dc2pan);YEvent.Capture(document,EventsList.KeyDown,this._runkeyDown,this,EventsList.kdown);YEvent.Capture(document,EventsList.KeyUp,this._runkeyUp,this,EventsList.kup);YEvent.Capture(this,EventsList.KeyDown,this._keyZoom);YEvent.Capture(this,EventsList.KeyDown,this._keyPan);YEvent.Capture(this,EventsList.KeyDown,this._keyType);},_changeMapTypeRun:function(_e){},_polylineAddedRun:function(_e){},_polylineRemovedRun:function(_e){},_MapTypeControlAddedRun:function(_e){this._setMapTypeHigh();},_miniAddedRun:function(_e){this._miniON=true;},_zoomAddedRun:function(_e){this._zoomON=true;},_panAddedRun:function(_e){this._panON=true;},_startGeoCode:function(_a,_t,_id){var _n=new GeoCode(_a,this);_n.set(_n.GeoAddress,_t,_id);var _ce=new eventObjectGeoCode(this,_a);this.Events.onStartGeoCode.trigger(_ce);},_endGeoCode:function(_e,_t){if(_t==10){this.drawZoomAndCenter(_e.GeoPoint,this.zoomLevel);}if(_t==11){this.addMarker(_e.GeoPoint);}if(_t==12){if(this._mTb[_e.GeoID]){this._mTb[_e.GeoID].setYGeoPoint(_e.GeoPoint);this._mTb[_e.GeoID].setGeoXYPoint(this.zoomLevel,this._posTbl);}}var gp=new YGeoPoint(_e.GeoPoint.Lat,_e.GeoPoint.Lon);var _ce=new eventObjectGeoCode(this,_e.GeoAddress,gp,_e.success);this.Events.onEndGeoCode.trigger(_ce);},_startGeoSearch:function(_g,_t,_r,_q,_n){if(!_g){if(!this.YGeoPoint){return ;}_i=this.YGeoPoint.Lat+"|"+this.YGeoPoint.Lon;}else{_i=_g.Lat+"|"+_g.Lon;}var r=new GeoSearch(_i,_t,this.id,_r,_q,_n);},_endGeoSearch:function(_e,_t){var _ce=new eventObjectGeoRSS(this,_e.URL,_e);if(_t==1){this.Events.onEndLocalSearch.trigger(_ce);}if(_t==2){this.Events.onEndTrafficSearch.trigger(_ce);}},_startGeoRSS:function(_o,_t){_o.set(_o.GeoRSS,this,_t);var _ce=new eventObjectGeoRSS(this,_o);this.Events.onStartGeoRSS.trigger(_ce);},_endGeoRSS:function(_e,_t){if(_t==1){var _c=this.getBoxGeoCenter(_e.GEOBOX.MIN,_e.GEOBOX.MAX);var _z=this.getZoomLevel(_e.GEOBOX.MIN,_e.GEOBOX.MAX);this.drawZoomAndCenter(_c,_z);for(var o in _e.ITEMS){var i=_e.ITEMS[o];if(i.YGEORSS&&i.GEO_LINE){var p=[];for(var l in i.GEO_LINE){if(i.GEO_LINE[l].GEO_LAT){p.push(new YGeoPoint(i.GEO_LINE[l].GEO_LAT,i.GEO_LINE[l].GEO_LON));}}var lc=(i.LINECOLOR)?i.LINECOLOR:null;var lw=(i.LINEWIDTH)?i.LINEWIDTH:null;var la=(i.LINEALPHA)?i.LINEALPHA:null;var pl=new YPolyline(p,lc,lw,la);this.addOverlay(pl);}else{if(i.YGEORSS){var p=new YGeoPoint(i.GEO_LAT,i.GEO_LONG);var t=new Template(p,i);var m=t.process();this.addOverlay(m);}}}}if(_t==2){}var _ce=new eventObjectGeoRSS(this,_e.URL,_e);this.Events.onEndGeoRSS.trigger(_ce);},_endPanOBRun:function(e){},_endMapDrawRun:function(_e){if(this._zoomON==true&&this._ctrlZoom){this._ctrlZoom.updateZoomLevel(this.zoomLevel);}if(this._disableDrag==true){this.disableDragMap();}this._yscale();if(this._miniON==true){this._showMini();}if(this._ovMapScale){this._ovMapScale.update(this.zoomLevel,this.getUnitsPerPixel(),this._mapType);}this._ylogo2();this._ycopy();},_runUnload:function(_e){this._clearView(1);},_runWheel:function(_e){if(this._disableKeys){return ;}var _d;if(_e.detail){_d=YUtility.getInt(_e.detail)*(-40);}if(_e.wheelDelta){_d=_e.wheelDelta;}if(_d>=120){this.setZoomLevel(this.zoomLevel-1);}else{this.setZoomLevel(this.zoomLevel+1);}},_getKeyType:function(_k){var zkp="61";var zkm="109";if(!YUtility.browser.id){zkp="187";zkm="189";}var _ks={"45":this.keyTypes.zoomOut,"107":this.keyTypes.zoomIn,"46":this.keyTypes.zoomIn,"38":this.keyTypes.panN,"40":this.keyTypes.panS,"37":this.keyTypes.panW,"39":this.keyTypes.panE,"36":this.keyTypes.panNW,"33":this.keyTypes.zoomOut,"35":this.keyTypes.panSW,"34":this.keyTypes.zoomIn,"_":""};_ks[zkm]=this.keyTypes.zoomOut;_ks[zkp]=this.keyTypes.zoomIn;if(_ks[_k]){return _ks[_k];}return false;},_keyZoom:function(_e,_k){if(this._disableKeys){return ;}if(this._getKeyType(_k)==this.keyTypes.zoomIn){this.setZoomLevel(this.zoomLevel-1);}else{if(this._getKeyType(_k)==this.keyTypes.zoomOut){this.setZoomLevel(this.zoomLevel+1);}}},_keyType:function(_e,_k){if(this._disableKeys){return ;}},_keyPan:function(_e,_k){if(this._disableKeys){return ;}var x=40;var y=40;if(this._disableDrag==true){return ;}if(this._getKeyType(_k)==this.keyTypes.panN){this.smoothPan(new YCoordPoint(0,y));}else{if(this._getKeyType(_k)==this.keyTypes.panS){this.smoothPan(new YCoordPoint(0,-y));}else{if(this._getKeyType(_k)==this.keyTypes.panW){this.smoothPan(new YCoordPoint(x,0));}else{if(this._getKeyType(_k)==this.keyTypes.panE){this.smoothPan(new YCoordPoint(-x,0));}else{if(this._getKeyType(_k)==this.keyTypes.panNW){this.smoothPan(new YCoordPoint(x,y));}else{if(this._getKeyType(_k)==this.keyTypes.panNE){this.smoothPan(new YCoordPoint(-x,y));}else{if(this._getKeyType(_k)==this.keyTypes.panSW){this.smoothPan(new YCoordPoint(x,-y));}else{if(this._getKeyType(_k)==this.keyTypes.panSE){this.smoothPan(new YCoordPoint(-x,-y));}}}}}}}}},_runkeyDown:function(_e){var _key=_e.keyCode;var _ce=(new _eO(this,this.YGeoPoint,{previous:this.zoomLevelPrev,current:this.zoomLevel}));this.Events.KeyDown.trigger(_ce,_key);},_runkeyUp:function(_e){var _key=_e.keyCode;var _ce=(new _eO(this,this.YGeoPoint,{previous:this.zoomLevelPrev,current:this.zoomLevel}));this.Events.KeyUp.trigger(_ce,_key);},_MouseOverRun:function(_e){var _ll=this._getEvGP(_e);var _ce=(new _eO(this,this.YGeoPoint,{previous:this.zoomLevelPrev,current:this.zoomLevel}));this.Events.MouseOver.trigger(_ce,_ll);},_MouseOutRun:function(_e){var _ll=this._getEvGP(_e);var pt=this._ll2xy(_ll);if(pt.x<5||pt.x>=(this.YSize.width-5)||pt.y<5||pt.y>=(this.YSize.height-30)){var _ce=(new _eO(this,this.YGeoPoint,{previous:this.zoomLevelPrev,current:this.zoomLevel}));this.Events.MouseOut.trigger(_ce,_ll);}if(!pt.x||!pt.y){var _ce=(new _eO(this,this.YGeoPoint,{previous:this.zoomLevelPrev,current:this.zoomLevel}));this.Events.MouseOut.trigger(_ce,_ll);}},_MouseDownRun:function(_e){var _ll=this._getEvGP(_e);var tr=this._getEtrg(_e);if(!YUtility.browser.id){YUtility.setStyle(tr,"cursor","http://l.yimg.com/a/i/us/map/aj/iegrb.png");}else{YUtility.setStyle(tr,"cursor","-moz-grabbing");}var _ce=(new _eO(this,this.YGeoPoint,{previous:this.zoomLevelPrev,current:this.zoomLevel}));this.Events.MouseDown.trigger(_ce,_ll);},_MouseUpRun:function(_e){var tr=this._getEtrg(_e);YUtility.setStyle(tr,"cursor","pointer");if(this._endPan){if(this.Events.MouseClick){}}else{if(this.Events.MouseClick){}}var _ll=this._getEvGP(_e);var _ce=(new _eO(this,this.YGeoPoint,{previous:this.zoomLevelPrev,current:this.zoomLevel}));this.Events.MouseUp.trigger(_ce,_ll);},_MouseClickRun:function(_e){this.setFocus();if(YUtility.browser.id!=2){YEvent.stopPropag(_e);}if(!this.YCoordPoint){return ;}var _ll=this._getEvGP(_e);var dfc=_ll.distance(this.YGeoPoint,this.getUnitsPerPixel());if(dfc.pixels>this.YSize.width){return ;}var _ce=(new _eO(this,this.YGeoPoint,{previous:this.zoomLevelPrev,current:this.zoomLevel}));this.Events.MouseClick.trigger(_ce,_ll);this.dragOn=false;},_runstartPan:function(_e){this._endPan=false;},_runonPan:function(_e){},_runendPan:function(_e){this._endPan=true;this._adjustOverlay(2);this._cleanTileCache(true);if(Math.abs(this._myTX)>this.YSize.width/2||Math.abs(this._myTY)>this.YSize.height/2){this.Events.endPanOB.trigger();this._myTX=this._myTY=0;}if(this.YSize.hasSmallerSide(new YSize(Math.abs(this._totalX),Math.abs(this._totalY)))){var f=trackDelay(this,"pan_ob",this.YGeoPoint);if(!trackTr){trackTr=setTimeout(f,trackDl);}if(this._mapType==YAHOO_MAP_SAT||this._mapType==YAHOO_MAP_HYB){var src=YMapConfig.copySat.service+"&x="+this._txy.tx+"&y="+this._txy.ty+"&z="+this.zoomLevel+"&ew=1&ns=1";if(this._coordTable["ycopy3"]){if(!YUtility.browser.id){this._coordTable["ycopy3"].dom.style.filter=YUtility.alphaImg(src);}else{this._coordTable["ycopy3"].dom.src=src;}}}if(this._mapType==YAHOO_MAP_HYB){if(typeof YMapConfig.copyHyb=="object"){var src=YMapConfig.copyHyb.service+"&x="+this._txy.tx+"&y="+this._txy.ty+"&z="+this.zoomLevel+"&top="+this._xyFill.width/2+"&left="+this._xyFill.height/2;if(this._coordTable["ycopy1"]){if(!YUtility.browser.id){this._coordTable["ycopy1"].dom._cimg.style.filter=YUtility.alphaImg(src);}else{this._coordTable["ycopy1"].dom._cimg.src=src;}}}}else{if(this._mapType==YAHOO_MAP_REG){if(typeof YMapConfig.copyReg=="object"){var src=YMapConfig.copyReg.service+"&x="+this._txy.tx+"&y="+this._txy.ty+"&z="+this.zoomLevel+"&top="+this._xyFill.width/2+"&left="+this._xyFill.height/2;if(this._coordTable["ycopy1"]){if(!YUtility.browser.id){this._coordTable["ycopy1"].dom._cimg.style.filter=YUtility.alphaImg(src);}else{this._coordTable["ycopy1"].dom._cimg.src=src;}}}}}}else{YUtility.tracker(this,"pan");}},_runchangeZoom:function(e){if(this._ctrlZoom){this._ctrlZoom.updateZoomLevel(this.zoomLevel);}},_getEvCP:function(_e){var xy=YAHOO.util.Event.getXY(_e);var ps=YAHOO.util.Dom.getXY(this.dom);var ax=xy[0]-ps[0];var ay=xy[1]-ps[1];var np=new YCoordPoint(ax,ay);var _cx=this.YSize.width/2;var _cy=this.YSize.height/2;var dx=_cx-np.x;var dy=_cy-np.y;var cp=new YCoordPoint(dx,dy);return cp;},_getEtrg:function(_e){return YAHOO.util.Event.getTarget(_e);},_getEvXY:function(_e){var _tr=YAHOO.util.Event.getTarget(_e);var _xy=YAHOO.util.Event.getXY(_e);var _dp=YAHOO.util.Dom.getXY(this.dom);var _ep=new YCoordPoint(_xy[0]-_dp[0],_xy[1]-_dp[1]);if(!this.YCoordPoint){return ;}var dx=this.YCoordPoint.x-_ep.x;var dy=this.YCoordPoint.y-_ep.y;var otx=this._txy.x;var oty=this._txy.y;var tdx=this._txy.tx-_tr.tx;var tdy=this._txy.ty-_tr.ty;var ntx=otx-(dx-tdx*YMapConfig.tileXY);var nty=oty+(dy+tdy*YMapConfig.tileXY);return(new TileXY(_tr.tx,_tr.ty,ntx,nty));},_getEvGP:function(_e){var _txy=this._getEvXY(_e);if(!this.MP){return ;}var _ll=this.MP.xy_to_ll(_txy.tx,_txy.ty,_txy.x,_txy.y);return _ll;},_adjustOverlay:function(t){for(var m in this._mTb){if(this._mTb[m].setGeoXYPoint){this._mTb[m].setGeoXYPoint(this.zoomLevel,this._posTbl,t);}}if(t!=2){for(var p in this._pTb){if(this._pTb[p].setGeoXYPoint){this._pTb[p].setGeoXYPoint(this.zoomLevel,this._posTbl,t);}}}},handleSizeChange:function(_e){this._onResizeRun(_e);},_onResizeRun:function(_e){YEvent.stopEvent(_e);if(!this.YSize){return ;}this._adjustOnResize(YUtility.getSize(this.dom));},disablePanOnDoubleClick:function(){YEvent.Remove(this,EventsList.MouseDoubleClick,this._dc2pan);},_dc2pan:function(_e,_ll){if(_ll&&_ll.Lat==0&&_ll.Lon==-180){return ;}this.setZoomLevel(this.zoomLevel-1);this.panToLatLon(_ll);},_DoubleClickRun:function(_e){YEvent.stopEvent(_e);if(this._disableDrag){return ;}var _ll=this._getEvGP(_e);var _ce=(new _eO(this,this.YGeoPoint,{previous:this.zoomLevelPrev,current:this.zoomLevel}));this.Events.MouseDoubleClick.trigger(_ce,_ll);},vZoom:[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],_zr:[[1,"1",[0.1,0.0473484848]],[2,"st",[0.125,0.1]],[3,"3",[0.25,0.2]],[4,"city",[0.5,0.5]],[5,"5",[1,1]],[6,"6",[2,2]],[7,"7",[5,3]],[8,"state",[10,7]],[9,"9",[20,15]],[10,"10",[30,25]],[11,"11",[75,50]],[12,"12",[150,100]],[13,"13",[300,200]],[14,"14",[600,400]],[15,"15",[1000,750]],[16,"16",[2000,1500]],[17,"17",[5000,3000]],[18,"18",[5000,3000]]],_lct:function(x,y){var _a=this._txy.x-this.YSize.width/2+x;var _b=this._txy.y+this.YSize.height/2-y;return new YCoordPoint(_a,_b);},_xy2ll:function(_c,_t){var _p=this._lct(_c.x,_c.y);return this.MP.xy_to_ll(this._txy.tx,this._txy.ty,_p.x,_p.y);},_getSubContainerXY:function(){return(new YCoordPoint(YUtility.getInt(this.subContainer.style.left),YUtility.getInt(this.subContainer.style.top)));},_ll2xy:function(gp,op){if(this.MP){var v=this.MP.ll_to_xy(gp);var k=YUtility._xyKey(v.tx,v.ty,this.zoomLevel,this._mapType);var scxy=this._getSubContainerXY();var pos=null;if(this._posTbl[k]){pos=this._posTbl[k];}else{if(this._vueTbl[k]){pos=this._vueTbl[k];}else{var cT=this.MP.ll_to_xy(this.YGeoPoint);var cK=YUtility._xyKey(cT.tx,cT.ty,this.zoomLevel,this._mapType);var cP=this._posTbl[cK];if(!cP){return false;}var xN=cP.tx-v.tx;var yN=cP.ty-v.ty;var xP=cP.x-YMapConfig.tileXY*xN;var yP=cP.y+YMapConfig.tileXY*yN;pos=new TileXY(v.tx,v.ty,xP,yP);}}if(pos){var xm=YUtility.getInt(pos.x)+((op==1)?0:scxy.x);var ym=YUtility.getInt(pos.y)+((op==1)?0:scxy.y);var rv=this.MP._returnCoordPoint(xm,ym,v.x,v.y);if(op==1){rv._xscpos=scxy.x;}else{rv.x%=this.MP.circum_px;}return rv;}}return false;},checkMax:function(u,r){var max={YAHOO_MAP:YMapConfig.tileReg.length,YAHOO_SAT:YMapConfig.tileSat.length,YAHOO_HYB:YMapConfig.tileHyb.length};return((r>max[u]-1)?max[u]-1:r);},setTileServer:function(_u,r){var pos=this.checkMax(_u,r);var _s={YAHOO_MAP:YMapConfig.tileReg[pos],YAHOO_SAT:YMapConfig.tileSat[pos],YAHOO_HYB:YMapConfig.tileHyb[pos]};this.tileServer=_u||YMapConfig.tileReg[pos];if(_s[_u]){this.tileServer=_s[_u];}},_setParentContainer:function(_c){this.id=_c.id=(_c.id)?_c.id:"ymapid"+YUtility.getRandomID();this._setYMapOn(_c);var _s={position:"relative",overflow:"hidden",background:"#f1f1f1"};YUtility.setStyle(_c,_s);this.dom=_c;this.dom.tabIndex=2;if(!this.subContainer){this._setSubContainer();}this._setTileXY();},setFocus:function(){this.dom.focus();},_setSubContainer:function(_p){this.subContainer=YUtility.createNode("div");this._setCanvas();var _s1={position:"absolute",zIndex:0,left:"0px",top:"0px"};YUtility.setStyle(this.subContainer,_s1);YUtility.appendNode(this.dom,this.subContainer);},getCoordPoint:function(){return(new YCoordPoint(this.subContainer.style.left,this.subContainer.style.top));},_setYMapOn:function(_c){_c._ymapset=true;},_setCanvas:function(){if(!YUtility.browser.id){if(!document._ymapset){document.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML");}document._ymapset=1;}},_setTileXY:function(){var _x=Math.ceil(((YMapConfig.tileXY*Math.ceil(this.YSize.width/YMapConfig.tileXY))/YMapConfig.tileXY)/2);var _y=Math.ceil(((YMapConfig.tileXY*Math.ceil(this.YSize.height/YMapConfig.tileXY))/YMapConfig.tileXY)/2);this._xyFill=new YSize(_x,_y);},_getContainerSize:function(_c,_s){if(_s){this.setContainerSize(_c,_s);return _s;}return this._sizeCheck(YUtility.getSize(_c),_c);},_sizeCheck:function(_s,_c){var _dYSize=new YSize(400,400);if(!_s.width||!_s.height){_s.width=_s.height=_dYSize.width;this.setContainerSize(_c,_dYSize);return _s;}return _s;},setContainerSize:function(_c,_s){var _wh={"width":_s.width+"px","height":_s.height+"px"};YUtility.setStyle(_c,_wh);},_addTile:function(_n,_k,_m){YUtility.appendNode(this.subContainer,_n);},_ipA:function(o,k,i){k=k||(YUtility._xyKey(o.tx,o.ty,this.zoomLevel,this._mapType));if(i){this._vueTbl[k]=new TileXY(o.tx,o.ty,o.x,o.y);}else{this._posTbl[k]=new TileXY(o.tx,o.ty,o.x,o.y);}},_getSrc:function(x,y){var _ru=this.tileServer+"x="+x+"&y="+y+"&z="+this.zoomLevel;return _ru;},_browserTile:function(_t,_o){var _s={position:"absolute",padding:"0px",cursor:"pointer",margin:"0px",width:YMapConfig.tileSize+"px",height:YMapConfig.tileSize+"px",zIndex:0,left:_o.x+"px",top:_o.y+"px"};YUtility.setStyle(_t,_s);YUtility.setStyle(_t,"cursor","pointer");_t.tx=_o.tx;_t.ty=_o.ty;if(YUtility.browser.id){YUtility.setStyle(_t,"visibility","hidden");_t.onload=function(){YUtility.setStyle(_t,"visibility","visible");};}},_tileRandom:0,_getTile:function(_o){var _k=YUtility._xyKey(_o.tx,_o.ty,this.zoomLevel,this._mapType);this._ipA(_o,_k);if(this._mapType==YAHOO_MAP_HYB){var _k1=YUtility._xyKey(_o.tx,_o.ty,this.zoomLevel,YAHOO_MAP_SAT);this.__loadTiles(_o,_k1,YAHOO_MAP_SAT);var _k2=YUtility._xyKey(_o.tx,_o.ty,this.zoomLevel,YAHOO_MAP_HYB);this.__loadTiles(_o,_k2,YAHOO_MAP_HYB);}else{var _k3=YUtility._xyKey(_o.tx,_o.ty,this.zoomLevel,this._mapType);this.__loadTiles(_o,_k3,this._mapType);}this._tileRandom++;if(this._tileRandom==4){this._tileRandom=0;}},__loadTiles:function(_o,_k,_m){this.setTileServer(_m,this._tileRandom);var _f=this.MP.xy_to_ll(_o.tx,_o.ty,128,128);var _r=this.MP.ll_to_xy(_f);if(_r.tx!=_o.tx){var kv=YUtility._xyKey(_r.tx,_o.ty,this.zoomLevel,this._mapType);this._ipA(new TileXY(_r.tx,_o.ty,_o.x,_o.y),kv,1);}if(!this._tileCache[_k]){var _t;if(!YUtility.browser.id){_t=YUtility.createNode("div");var url=this._getSrc(_r.tx,_o.ty);_t._iefix=YUtility.createNode("img");_t._iefix.onload=function(){_t.style.filter=YUtility.alphaImg2(url);};_t._iefix.src=url;}else{_t=YUtility.createNode("img");_t.src=this._getSrc(_r.tx,_o.ty);}this._browserTile(_t,_o);this._tileCache[_k]=_o;if(_m==YAHOO_MAP_HYB){this._tileCache[_k]._h=_t;}else{this._tileCache[_k]._t=_t;}this._addTile(_t,_k,_m);}},_callTiles:function(_f){var _cx=parseInt(this.YSize.width/2-this._txy.x,10);var _cy=parseInt(this.YSize.height/2-YMapConfig.tileXY+this._txy.y,10);var _cxy=new YCoordPoint(_cx,_cy);if(_f){var ckey=YUtility._xyKey(this._txy.tx,this._txy.ty,this.zoomLevel,this._mapType);_cxy=this._posTbl[ckey];}for(var xI=0;xI<=this._xyFill.width;xI++){for(var yI=0;yI<=this._xyFill.height;yI++){var tx=this._txy.tx+xI;var ty=this._txy.ty+yI;var key=YUtility._xyKey(tx,ty,this.zoomLevel,this._mapType);if(this._tileCache[key]){continue;}this._getTile(new TileXY(tx,ty,_cxy.x+(xI*YMapConfig.tileXY),_cxy.y+(-yI*YMapConfig.tileXY)));}}for(var xI=-this._xyFill.width;xI<=this._xyFill.width;xI++){for(var yI=-this._xyFill.height;yI<=this._xyFill.height;yI++){var tx=this._txy.tx+xI;var ty=this._txy.ty+yI;var key=YUtility._xyKey(tx,ty,this.zoomLevel,this._mapType);if(this._tileCache[key]){continue;}this._getTile(new TileXY(tx,ty,_cxy.x+(xI*YMapConfig.tileXY),_cxy.y+(-yI*YMapConfig.tileXY)));}}},_cleanTileCache:function(partial){for(var i in this._tileCache){if(partial&&this.bO.inB(this._tileCache[i].tx,this._tileCache[i].ty)&&this._tileCache[i]._t){continue;}if(this._tileCache[i]._h){if(this._tileCache[i]._h._iefix){this._tileCache[i]._h._iefix=null;}YUtility.removeNode(this._tileCache[i]._h);}if(this._tileCache[i]._t){if(this._tileCache[i]._t._iefix){this._tileCache[i]._t._iefix=null;}YUtility.removeNode(this._tileCache[i]._t);}delete this._tileCache[i];}},_clearView:function(u){if(u&&YUtility.browser.id){return ;}if(!u){for(var m in this._mTb){if(this._mTb[m].setGeoXYPoint){this._mTb[m].setGeoXYPoint();}}}else{for(var m in this._mTb){if(this._mTb[m]._destroy){this._mTb[m]._destroy(1);}}for(var p in this._pTb){if(this._pTb[p].setGeoXYPoint){this._pTb[p]._destroy();}}}this._cleanTileCache();for(var p in this._posTbl){if(this._posTbl[p].tx){delete this._posTbl[p];}}},_adjustSubContPos:function(_c){var _s={left:_c.x+"px",top:_c.y+"px"};if(this.subContainer){YUtility.setStyle(this.subContainer,_s);}},_setProjection:function(){this.MP=new MercatorProjection(this.zoomLevel,YMapConfig.tileXY);this._txy=this.MP.ll_to_xy(this.YGeoPoint);this.YCoordPoint=new YCoordPoint(this.YSize.width/2,this.YSize.height/2);},_draw:function(){if(!this.YGeoPoint){return ;}this._adjustSubContPos(new YCoordPoint(0,0));this._clearView();this._setProjection();this.bO=new _setBounds(this._txy.tx,this._txy.ty,this._xyFill.width,this._xyFill.height);this._callTiles();this._adjustOverlay(1);this._updateGeoBox();},_updateGeoBox:function(){var bSW=this.MP.xy_to_ll(this._txy.tx,this._txy.ty,this._txy.x+this.YSize.width/2,this._txy.y-this.YSize.height/2);var bNE=this.MP.xy_to_ll(this._txy.tx,this._txy.ty,this._txy.x-this.YSize.width/2,this._txy.y+this.YSize.height/2);if(this.MP.circum_px<=this.YSize.width){bSW.Lon=-180;bNE.Lon=180;}bSW.setgeobox(bNE);this._geoBox=bSW;},_gLC:function(){this.bO.abL();for(var tb=this.bO.bB;tb<=this.bO.bT;tb++){var key=YUtility._xyKey(this.bO.pbL,tb,this.zoomLevel,this._mapType);if(this._posTbl[key]){this._getTile(new TileXY(this.bO.bL,tb,this._posTbl[key].x-YMapConfig.tileXY,this._posTbl[key].y));}}this.bO.sbR();},_gRC:function(){this.bO.abR();for(var tb=this.bO.bB;tb<=this.bO.bT;tb++){var key=YUtility._xyKey(this.bO.pbR,tb,this.zoomLevel,this._mapType);if(this._posTbl[key]){this._getTile(new TileXY(this.bO.bR,tb,this._posTbl[key].x+YMapConfig.tileXY,this._posTbl[key].y));}}this.bO.sbL();},_gTR:function(){this.bO.abT();for(var tb=this.bO.bL;tb<=this.bO.bR;tb++){var key=YUtility._xyKey(tb,this.bO.pbT,this.zoomLevel,this._mapType);if(this._posTbl[key]){this._getTile(new TileXY(tb,this.bO.bT,this._posTbl[key].x,this._posTbl[key].y-YMapConfig.tileXY));}}this.bO.sbB();},_gBR:function(){this.bO.abB();for(var tb=this.bO.bL;tb<=this.bO.bR;tb++){var key=YUtility._xyKey(tb,this.bO.pbB,this.zoomLevel,this._mapType);if(this._posTbl[key]){this._getTile(new TileXY(tb,this.bO.bB,this._posTbl[key].x,this._posTbl[key].y+YMapConfig.tileXY));}}this.bO.sbT();},_pan:function(iX,iY,_r){var _x=YUtility.getInt(iX);var _y=YUtility.getInt(iY);if(!_x&&!_y||!this.bO){return ;}var t=this.subContainer;var pL=YUtility.getInt(t.style.left)+_x;var pT=YUtility.getInt(t.style.top)+_y;t.style.left=(pL)+"px";t.style.top=(pT)+"px";var nR,nB,nL,nT;var kR=YUtility._xyKey(this.bO.bR,this.bO.bT,this.zoomLevel,this._mapType);var kB=YUtility._xyKey(this.bO.bL,this.bO.bB,this.zoomLevel,this._mapType);if(this._posTbl[kR]){nR=this._posTbl[kR].x;}if(this._posTbl[kB]){nB=this._posTbl[kB].y;}if(this._posTbl[kB]){nL=this._posTbl[kB].x;}if(this._posTbl[kR]){nT=this._posTbl[kR].y;}if((nL+pL)>-YMapConfig.tileXY){this._gLC();}if((nR+pL)<this.YSize.width){this._gRC();}if((nT+pT)>-YMapConfig.tileXY){this._gTR();}if((nB+pT)<this.YSize.height){this._gBR();}this._panUpdate(_x,_y,_r);this._totalX+=_x;this._totalY+=_y;this._myTX+=_x;this._myTY+=_y;},_panUpdate:function(x,y,_r){if(!x&&!y){return ;}var _x=x;var _y=y;if(_r){_x=0;_y=0;}this._txy.tx=this._txy.tx-_x/YMapConfig.tileXY;this._txy.ty=this._txy.ty+_y/YMapConfig.tileXY;this.YGeoPoint=this.MP.xy_to_ll(this._txy.tx,this._txy.ty,this._txy.x,this._txy.y);this._updateGeoBox();},_drag:function(){if(!this._dragObject){this._dragObject=new YAHOO.util.DDProxy(this.dom.id);this._dragObject.scroll=false;}var that=this;var ox,oy;that._dragObject.onDrag=function(_e){YEvent.stopDefault(_e);that.dragOn=true;var _ex=_e.clientX;var _ey=_e.clientY;if(YUtility.browser.id==0||YUtility.browser.id==4){_ex=_ex+(document.compatMode=="BackCompat"?document.body.scrollLeft:document.documentElement.scrollLeft);_ey=_ey+(document.compatMode=="BackCompat"?document.body.scrollTop:document.documentElement.scrollTop);}else{_ex=_ex+window.pageXOffset;_ey=_ey+window.pageYOffset;}var pos={x:_ex-ox,y:_ey-oy};ox=_ex;oy=_ey;with(that){_pan(pos.x,pos.y);var _ce=(new _eO(that,YGeoPoint,{previous:zoomLevelPrev,current:zoomLevel}));Events.onPan.trigger(_ce);}};that._dragObject.endDrag=function(_e){with(that){var _ce=(new _eO(that,YGeoPoint,{previous:zoomLevelPrev,current:zoomLevel}));Events.endPan.trigger(_ce);}};that._dragObject.b4StartDrag=function(_e){};that._dragObject.startDrag=function(_ex,_ey){ox=_ex;oy=_ey;with(that){var _ce=(new _eO(that,YGeoPoint,{previous:zoomLevelPrev,current:zoomLevel}));Events.startPan.trigger(_ce);}};},isZoomChanged:function(z){var c=this.zoomLevel;var p=z?z:this.zoomLevelPrev;return(p&&Math.abs(p-c));},startSet:false,drawZoomAndCenter:function(o,z){var otype="draw";this.zoomLevel=this.isValidZoomLevel(z)?YUtility.getInt(z):5;if(!this.zoomLevelPrev){otype="start";this.zoomLevelPrev=this.zoomLevel;}if(typeof (o)=="string"){this._startGeoCode(o,10);}else{if(o){this.YGeoPoint=new YGeoPoint(o.Lat,o.Lon);this._draw();this._drag();var _ce=(new _eO(this,this.YGeoPoint,{previous:this.zoomLevelPrev,current:this.zoomLevel}));if(this.isZoomChanged()){this.Events.changeZoom.trigger(_ce);otype="zoom_ob";}else{otype=this.startSet?"draw":"start";}this.Events.endMapDraw.trigger(_ce);if(!this._disableTrack){if(otype=="zoom_ob"){var f=trackDelay(this,otype,this.YGeoPoint);if(!trackTr){trackTr=setTimeout(f,trackDl);}}else{if(otype=="start"){this.startSet=true;}YUtility.tracker(this,otype);}}}}this.zoomLevelPrev=this.zoomLevel;},dragOn:false,panToLatLon:function(geo,z){if(this.dragOn){return ;}var _zoom=z?z:this.zoomLevel;var _lldiff=geo.pointDiff(this.YGeoPoint);var _units=this.getUnitsPerPixel(_zoom);var _xdiff=Math.ceil(_lldiff.Lon/_units.longitude);var _ydiff=Math.ceil(_lldiff.Lat/_units.latitude);var _panMax=1.5;if(this.isZoomChanged(z)||(Math.abs(_xdiff)>this.YSize.width*_panMax||Math.abs(_ydiff)>this.YSize.height*_panMax)){this.drawZoomAndCenter(geo,_zoom);}else{this.smoothPan(new YCoordPoint(_xdiff,_ydiff));}},smoothPan:function(_cp,f){var attributes={};var _f=(f)?f:10;var _anm=new YAHOO.util.Motion(this.subContainer,attributes,_f,YAHOO.util.Easing.easeNone);_anm.useSeconds=false;var that=this;_anm.onStart.subscribe(function(){with(that){var _ce=(new _eO(that,YGeoPoint,{previous:zoomLevelPrev,current:zoomLevel}));Events.startAutoPan.trigger(_ce);}});_anm.onTween.subscribe(function(){with(that){var _ce=(new _eO(that,YGeoPoint,{previous:zoomLevelPrev,current:zoomLevel}));_pan(_cp.x/_f,_cp.y/_f);Events.onPan.trigger(_ce);}});_anm.onComplete.subscribe(function(){with(that){var _ce=(new _eO(that,YGeoPoint,{previous:zoomLevelPrev,current:zoomLevel}));Events.endAutoPan.trigger(_ce);}});_anm.animate();},_pointPan:function(_cp){this.smoothPan(_cp);},_smoothPan:function(_cp){this.smoothPan(_cp);},addOverlay:function(o){if(!o){throw ("Error: attempting to add invalid overlay object!");}if(o.YGeoPoint){o.setMapObject(this);o.setGeoXYPoint(this.zoomLevel,this._posTbl);if(o.polyline&&!this._pTb[o.id]){YUtility.appendNode(this.subContainer,o);this._pTb[o.id]=o;var _ce=new _eO(this,this.YGeoPoint);this.Events.polylineAdded.trigger(_ce);}else{if(!this._mTb[o.id]){YUtility.appendNode(this.subContainer,o);this._mTb[o.id]=o;if(!markerTr){var f=checkMarkerAdded(this,"poi");markerTr=setTimeout(f,trackDl);}}}}else{if(o.YCoordPoint){o.setMapObject(this);o.assignCoordPoint();if(!this._coordTable){this._coordTable=[];}if(!this._coordTable[o.id]){YUtility.appendNode(this,o);}this._coordTable[o.id]=o;}else{if(o.GeoRSS){this._startGeoRSS(o,1);return ;}}}YUtility.alphaLoad(o);},processGeoRSS:function(o){this._startGeoRSS(o,2);},searchLocal:function(g,q,r,n){this._startGeoSearch(g,1,r,q,n);},searchTraffic:function(g,r){this._startGeoSearch(g,2,r);},removeOverlay:function(o){if(o&&o.dom){if(o.polyline){var _ce=new _eO(this,this.YGeoPoint);this.Events.polylineRemoved.trigger(_ce);delete this._pTb[o.id];}YUtility.removeNode(o.dom);delete this._mTb[o.id];}else{if(typeof (o)=="string"){if(this._coordTable[o]){var _obj=this._coordTable[o];YUtility.removeNode(_obj.dom);delete this._coordTable[o];}}}},addXY:function(_cp){var m=document.createElement("img");m.id="xypt"+Math.random();m.src=YMapConfig.marker2;var _s={"position":"absolute","left":_cp.x,"top":_cp.y,"zIndex":3};YUtility.setStyle(m,_s);YUtility.appendNode(this.dom,m);},getEventsList:function(){return EventsList;},convertLatLonXY:function(gp){return this._ll2xy(gp);},convertXYLatLon:function(cpt){return this._xy2ll(cpt);},removeFromMap:function(id){YUtility.removeNode(YUtility.getByID(id));},addMarker:function(a,b){if(typeof (a)=="string"){this._startGeoCode(a,11);}else{this.addOverlay(new Marker(a,b));}},getZoomFromDegreePerPixel:function(degppx,uppx){return Math.ceil(1+Math.log(degppx/(uppx))/Math.log(2));},getZoomLevel:function(gpa,gpb,cs){var _a,_b;if(typeof (gpa)=="object"&&gpa.distance){var w=this.YSize.width;var up=this.getUnitsPerPixel();var upn=(gpa.distance*2)/w;return this.getZoomFromDegreePerPixel(upn,this.getUnitsPerPixel(1).miles);}if(gpa&&!gpb){var _o=this.getGeoBox(gpa);_a=_o.min;_b=_o.max;}else{_a=gpa;_b=gpb;}if(_a&&_b){var tcs=this.YSize;if(cs){tcs=cs;}if(_a&&!_a.setgeobox){_a=new YGeoPoint(_a.Lat,_a.Lon);_b=new YGeoPoint(_b.Lat,_b.Lon);}_a.setgeobox(_b);var c1=this.getBoxGeoCenter(_a,_b);if(!this.YGeoPoint){this.YGeoPoint=new YGeoPoint(c1.Lat,c1.Lon);}var lnpx=(_a.LonMax-_a.LonMin)/(tcs.width-tcs.height/10);var ltpx=(_a.LatMax-_a.LatMin)/(tcs.height-tcs.width/10);if(!lnpx){return 1;}var zmlon=this.getZoomFromDegreePerPixel(lnpx,this.getUnitsPerPixel(1).longitude);var zmlat=this.getZoomFromDegreePerPixel(ltpx,this.getUnitsPerPixel(1).latitude);var rz=(zmlon>zmlat)?zmlon:zmlat;return Math.abs(rz);}return parseInt(this.zoomLevel,10);},getBestZoomAndCenter:function(a){var z=this.getZoomLevel(a);var c=this.getCenterGeoPoint(a);return{zoomLevel:z,YGeoPoint:c};},getGeoBox:function(a){var o={};o.max=o.min=new YGeoPoint();if(!a.length){return o;}o.min=new YGeoPoint(a[0].Lat,a[0].Lon);o.max=new YGeoPoint(a[0].Lat,a[0].Lon);for(var k in a){var n=a[k];if(n.Lat<o.min.Lat){o.min.Lat=n.Lat;}if(n.Lat>o.max.Lat){o.max.Lat=n.Lat;}if(n.Lon<o.min.Lon){o.min.Lon=n.Lon;}if(n.Lon>o.max.Lon){o.max.Lon=n.Lon;}}return o;},getCenterGeoPoint:function(a){return this.getCenterPoint(a);},getCenterPoint:function(a){var _o=this.getGeoBox(a);var _c=(_o)?this.getBoxGeoCenter(_o.min,_o.max):new YGeoPoint();return _c;},getGeoBoxCenter:function(a,b){return this.getBoxGeoCenter(a,b);},getBoxGeoCenter:function(a,b){var _a=(a.Lat+b.Lat)/2;var _b=(a.Lon+b.Lon)/2;return(new YGeoPoint(_a,_b));},getFixedOverlayIDs:function(){var a=[];for(var p in this._coordTable){if(this._coordTable[p].YCoordPoint){a.push(p);}}return a;},getPolylineIDs:function(){var a=[];for(var p in this._pTb){if(this._pTb[p].YGeoPoint){a.push(p);}}return a;},getPolylineObject:function(k){return this._pTb[k];},getMarkerById:function(k){return this._mTb[k];},getMarkerObject:function(k){return this._mTb[k];},hideAllMarkers:function(){for(var k in this._mTb){var o=this._mTb[k];if(o.YGeoPoint){if(!o.ishidden()){o.hide();o.selective=true;}}}},unhideAllMarkers:function(){for(var k in this._mTb){var o=this._mTb[k];if(o.YGeoPoint&&o.selective){if(o.ishidden()){o.unhide();}}}},isMarkerInView:function(o){if(!o||!o.YGeoPoint){return false;}var p=this.convertLatLonXY(o.YGeoPoint);return(p.x>0&&p.x<this.YSize.width&&p.y>0&&p.y<this.YSize.height);},getMarkerCount:function(){var c=0;for(var m in this._mTb){var o=this._mTb[m];if(o.YGeoPoint&&!o.ishidden()){if(this.isMarkerInView(o)){c++;}}}return c;},getMarkerIDs:function(){var a=[];for(var m in this._mTb){if(this._mTb[m].YGeoPoint){a.push(m);}}return a;},getMarkerTable:function(){return this._mTb;},removeMarkersAll:function(){if(_expCache){_expCache._destroy();_expCache=null;}for(var m in this._mTb){if(this._mTb[m]._destroy){this._mTb[m]._destroy();delete this._mTb[m];}}if(this._mTb.length){return false;}return true;},removeMarker:function(m){if(this._mTb[m]&&this._mTb[m]._destroy){this._mTb[m]._destroy();delete this._mTb[m];return true;}return false;},getOuterRadius:function(){return(YUtility.getInt(this.YSize.width>this.YSize.height?this.YSize.width:this.YSize.height))/2;},getInnerRadius:function(){return(YUtility.getInt(this.YSize.width>this.YSize.height?this.YSize.height:this.YSize.width))/2;},_adjustOnResize:function(_ns){var _pYSize=this.YSize;this.YSize=_ns;var _dx=(this.YSize.width-_pYSize.width)/2;var _dy=(this.YSize.height-_pYSize.height)/2;if(!_dx&&!_dy){return ;}this._setTileXY();this._updateGeoBox();this._setProjection();this.bO=new _setBounds(this._txy.tx,this._txy.ty,this._xyFill.width,this._xyFill.height);this._callTiles(true);this._pan(_dx,_dy,false);},resizeTo:function(ys){if(ys){this._adjustOnResize(this._getContainerSize(this.dom,ys));}},moveByXY:function(cpt){this._pan(cpt.x,cpt.y);},smoothMoveByXY:function(cpt,f){this.smoothPan(cpt,f?f:1);},panToXY:function(np){var op=new YCoordPoint(this.YSize.width/2,this.YSize.height/2);for(var i=1;i<arguments.length;i++){if(typeof arguments[i]=="object"){op=arguments[i];}}var xd=Math.floor(op.x-np.x);var yd=Math.floor(op.y-np.y);this.smoothPan(new YCoordPoint(-xd,-yd));},getBounds:function(){return this._geoBox;},getBoundsLatLon:function(){return this._geoBox;},getPortSize:function(){return this.YSize;},getContainerSize:function(){return this.YSize;},getCenterLatLon:function(){return this.YGeoPoint;},getUnitsPerPixel:function(z){var zm=z||this.zoomLevel;var mp=new MercatorProjection(zm);var km=(this.YGeoPoint)?mp.mpp_m(this.YGeoPoint.Lat)/1000:0;var mi=(this.YGeoPoint)?mp.mpp_m(this.YGeoPoint.Lat)/1609.344:0;var lonppx=1/mp.x_per_lon_;var latppx=lonppx*0.794370211280205;return{miles:mi,kilometers:km,latitude:latppx,longitude:lonppx};},showSmartWindow:function(gp,cin,id){if(!gp||!cin){return ;}var im=new YImage();im.src=YMapConfig.marker9;im.size=new YSize(0,0);im.offsetSmartWindow=new YCoordPoint(0,0);var marker=new Marker(gp,id,im);this.addOverlay(marker);marker.openSmartWindow(cin);},isDragMapEnabled:function(){return !this._disableDrag;},disableDragMap:function(){if(this._dragObject){this._dragObject.lock();}this._disableDrag=true;for(var i in this._tileCache){if(this._tileCache[i]._t){YUtility.setStyle(this._tileCache[i]._t,"cursor","default");}}},enableDragMap:function(){if(this._dragObject){this._dragObject.unlock();}this._disableDrag=false;for(var i in this._tileCache){if(this._tileCache[i]._t){YUtility.setStyle(this._tileCache[i]._t,"cursor","move");}}},enableKeyControls:function(){this.setFocus();this._disableKeys=false;},disableKeyControls:function(){this._disableKeys=true;},disableTracking:function(){this._disableTrack=true;},enableTracking:function(){this._disableTrack=false;},geoCodeAddress:function(s){this._startGeoCode(s);},__end:function(){}};YUtility.containerResize=function(panelElId,handleElId,sGroup){if(handleElId){this.init(panelElId,sGroup);this.handleElId=handleElId;this.setHandleElId(handleElId);}};YUtility.containerResize.prototype=new YAHOO.util.DragDrop();YUtility.containerResize.prototype.onMouseDown=function(e){var panel=this.getEl();this.startWidth=panel.offsetWidth;this.startHeight=panel.offsetHeight;this.startPos=[YAHOO.util.Event.getPageX(e),YAHOO.util.Event.getPageY(e)];};YUtility.containerResize.prototype.onDrag=function(e){var newPos=[YAHOO.util.Event.getPageX(e),YAHOO.util.Event.getPageY(e)];var offsetX=newPos[0]-this.startPos[0];var offsetY=newPos[1]-this.startPos[1];var newWidth=Math.max(this.startWidth+offsetX,10);var newHeight=Math.max(this.startHeight+offsetY,10);var panel=this.getEl();panel.style.width=newWidth+"px";panel.style.height=newHeight+"px";};var Debug=function(i){this.id=i||"ymapdebug";this._count=0;this.initSize(new YSize(200,200));this.initPos(new YCoordPoint(10,10));};Debug.prototype.initPos=function(yc){this._x=yc.x;this._y=yc.y;};Debug.prototype.initSize=function(ys){this._w=ys.width;this._h=ys.height;};Debug.prototype.print=function(inp){this._count=0;if(!this._p){this._p=document.getElementById(this.id);this._p=YUtility.createNode("div");this._p.id=this.id;this._p.style.position="absolute";this._p.style.background="#EEEEEE";this._p.style.filter="alpha(opacity=1)";this._p.style.opacity=1;this._p.style.width=this._w;this._p.style.height=this._h;this._p.style.left=this._x;this._p.style.top=this._y;this._p.style.zIndex=999;this._p.style.borderStyle="solid";if(!YUtility.browser.id){this._p.style.overflow="auto";}var _h=YUtility.createNode("div","yloghd");var hs={backgroundColor:"#EEE000",position:"absolute",overflow:"visible",zIndex:999,bottom:-5,right:-5,width:15,height:15};YUtility.setStyle(_h,hs);var _l=YUtility.createNode("div");_l.style.borderWidth="1px";_l.style.padding="1px";_l.style.borderStyle="solid";var _c=YUtility.createNode("img","ylogx");_c.src=YMapConfig.imgPrefixURL+"x.gif";_c.style.position="absolute";_c.style.right="3px";_c.style.top="3px";YEvent.Capture(_c,EventsList.MouseClick,this._MouseClickRun,this,"click");var _t=YUtility.createNode("div");_t.innerHTML="<b>Yahoo! Maps API Logger</b>";_t.style.background="#EEE000";_t.style.width="98%";_t.style.paddingLeft="3px";YUtility.appendNode(_t,_c);YUtility.appendNode(this._p,_t);YUtility.appendNode(this._p,_l);YUtility.appendNode(this._p,_h);YUtility.appendNode(document.body,this._p);if(!this._o){this._o=YUtility.createNode("div","ylogmn");if(YUtility.browser.id){this._o.style.height="90%";}this._o.style.background="#EEEEEE";this._o.style.filter="alpha(opacity=75)";this._o.style.opacity=0.75;if(YUtility.browser.id){this._o.style.overflow="auto";}YUtility.appendNode(this._p,this._o);}}if(YUtility.browser.id){var _d=new YAHOO.util.DD(this._p.id);var _r=new YUtility.containerResize(this.id,"yloghd");}else{var _r=new YUtility.containerResize(this.id,"yloghd");var _d=new YAHOO.util.DD(this._p.id);}YEvent.Capture(this._o,EventsList.MouseDown,function(_e){YEvent.stopPropag(_e);},null,"mousedown");var t=typeof inp;if(this._o){this._o.innerHTML+="<div>";if(t=="object"||t=="array"){for(var o in inp){this._o.innerHTML+=this._count+". <b>"+o+"</b> :: "+inp[o]+"<br>";this._count++;}}else{this._o.innerHTML+=this._count+". "+inp;this._count++;}this._o.innerHTML+="</div>";}};Debug.prototype._MouseClickRun=function(){this.hide();};Debug.prototype.hide=function(){this._p.style.visibility="hidden";};Debug.prototype.write=function(inp){this.print(inp);};function Exporter(o){var _E=o||window;_E.YMapConfig=YMapConfig;_E.YOverlay=Overlay;_E.YAnnotation=Annotation;_E.YMapTypeControl=TypeControl;_E.YMapDistance=MapDistance;_E.YCoordPoint=YCoordPoint;_E.YGeoPoint=YGeoPoint;_E.YImage=YImage;_E.YSize=YSize;_E.YEvent=YEvent;_E.YMarker=Marker;_E.YPolyline=Polyline;_E.YSmartWindow=SmartWindow;_E.YCustomOverlay=CustomOverlay;_E.YUtility=YUtility;_E.YGeoCode=GeoCode;_E.YGeoRSS=GeoRSS;_E.YGeoSearch=GeoSearch;_E.YMap=Map;_E.EventsList=EventsList;_E.YLog=new Debug("ymaplog");}Exporter();}YahooMapsAPIAjax();



if(!window.I18nMsg){I18nMsg={}
}I18nMsg.currencyCode="USD";
I18nMsg.currencySymbol="$";
I18nMsg.eraAD="AD";
I18nMsg.eraBC="BC";
I18nMsg.firstDayOfWeek="1";
I18nMsg.formatDateFull="EEEE, MMMM d, yyyy";
I18nMsg.formatDateLong="MMMM d, yyyy";
I18nMsg.formatDateMedium="MMM d, yyyy";
I18nMsg.formatDateShort="M/d/yy";
I18nMsg.formatDateTime="{0} {1}";
I18nMsg.formatNumber="#,##0.###";
I18nMsg.formatNumberCurrency="\u00a4#,##0.00;(\u00a4#,##0.00)";
I18nMsg.formatNumberInteger="#,##0";
I18nMsg.formatNumberPercent="#,##0%";
I18nMsg.formatTimeFull="h:mm:ss a z";
I18nMsg.formatTimeLong="h:mm:ss a z";
I18nMsg.formatTimeMedium="h:mm:ss a";
I18nMsg.formatTimeShort="h:mm a";
I18nMsg.monthAprLong="April";
I18nMsg.monthAprMedium="Apr";
I18nMsg.monthAugLong="August";
I18nMsg.monthAugMedium="Aug";
I18nMsg.monthDecLong="December";
I18nMsg.monthDecMedium="Dec";
I18nMsg.monthFebLong="February";
I18nMsg.monthFebMedium="Feb";
I18nMsg.monthJanLong="January";
I18nMsg.monthJanMedium="Jan";
I18nMsg.monthJulLong="July";
I18nMsg.monthJulMedium="Jul";
I18nMsg.monthJunLong="June";
I18nMsg.monthJunMedium="Jun";
I18nMsg.monthMarLong="March";
I18nMsg.monthMarMedium="Mar";
I18nMsg.monthMayLong="May";
I18nMsg.monthMayMedium="May";
I18nMsg.monthNovLong="November";
I18nMsg.monthNovMedium="Nov";
I18nMsg.monthOctLong="October";
I18nMsg.monthOctMedium="Oct";
I18nMsg.monthSepLong="September";
I18nMsg.monthSepMedium="Sep";
I18nMsg.numberInfinity="\u221e";
I18nMsg.numberNaN="\ufffd";
I18nMsg.numberSeparatorDecimal=".";
I18nMsg.numberSeparatorGrouping=",";
I18nMsg.numberSeparatorMoneyDecimal=".";
I18nMsg.numberSignMinus="-";
I18nMsg.numberSignPerMill="\u2030";
I18nMsg.numberSignPercent="%";
I18nMsg.numberZero="0";
I18nMsg.periodAm="AM";
I18nMsg.periodPm="PM";
I18nMsg.weekdayFriLong="Friday";
I18nMsg.weekdayFriMedium="Fri";
I18nMsg.weekdayMonLong="Monday";
I18nMsg.weekdayMonMedium="Mon";
I18nMsg.weekdaySatLong="Saturday";
I18nMsg.weekdaySatMedium="Sat";
I18nMsg.weekdaySunLong="Sunday";
I18nMsg.weekdaySunMedium="Sun";
I18nMsg.weekdayThuLong="Thursday";
I18nMsg.weekdayThuMedium="Thu";
I18nMsg.weekdayTueLong="Tuesday";
I18nMsg.weekdayTueMedium="Tue";
I18nMsg.weekdayWedLong="Wednesday";
I18nMsg.weekdayWedMedium="Wed";
if(!window.AjxMsg){AjxMsg={}
}AjxMsg["Africa/Algiers"]="GMT +01:00 West Central Africa";
AjxMsg["Africa/Cairo"]="GMT +02:00 Egypt";
AjxMsg["Africa/Casablanca"]="GMT +00:00 Casablanca";
AjxMsg["Africa/Harare"]="GMT +02:00 Harare / Pretoria";
AjxMsg["Africa/Monrovia"]="GMT +00:00 Monrovia";
AjxMsg["Africa/Nairobi"]="GMT +03:00 Nairobi";
AjxMsg["Africa/Windhoek"]="GMT +01:00 Namibia";
AjxMsg["America/Anchorage"]="GMT -09:00 Alaska";
AjxMsg["America/Argentina/Buenos_Aires"]="GMT -03:00 Argentina";
AjxMsg["America/Bogota"]="GMT -05:00 Colombia";
AjxMsg["America/Caracas"]="GMT -04:30 Caracas";
AjxMsg["America/Chicago"]="GMT -06:00 US/Canada Central";
AjxMsg["America/Chihuahua"]="GMT -07:00 Chihuahua / La Paz / Mazatlan";
AjxMsg["America/Denver"]="GMT -07:00 US/Canada Mountain";
AjxMsg["America/Godthab"]="GMT -03:00 Greenland";
AjxMsg["America/Guatemala"]="GMT -06:00 Central America";
AjxMsg["America/Guyana"]="GMT -04:00 Georgetown";
AjxMsg["America/Halifax"]="GMT -04:00 Atlantic Time (Canada)";
AjxMsg["America/Indiana/Indianapolis"]="GMT -05:00 Indiana (East)";
AjxMsg["America/La_Paz"]="GMT -04:00 La Paz";
AjxMsg["America/Los_Angeles"]="GMT -08:00 US/Canada Pacific";
AjxMsg["America/Manaus"]="GMT -04:00 Manaus";
AjxMsg["America/Mexico_City"]="GMT -06:00 Guadalajara / Mexico City / Monterrey";
AjxMsg["America/Montevideo"]="GMT -03:00 Montevideo";
AjxMsg["America/New_York"]="GMT -05:00 US/Canada Eastern";
AjxMsg["America/Phoenix"]="GMT -07:00 Arizona";
AjxMsg["America/Regina"]="GMT -06:00 Saskatchewan";
AjxMsg["America/Santiago"]="GMT -04:00 Pacific South America";
AjxMsg["America/Sao_Paulo"]="GMT -03:00 Brasilia";
AjxMsg["America/St_Johns"]="GMT -03:30 Newfoundland";
AjxMsg["America/Tijuana"]="GMT -08:00 Tijuana / Baja California";
AjxMsg["Asia/Amman"]="GMT +02:00 Jordan";
AjxMsg["Asia/Baghdad"]="GMT +03:00 Iraq";
AjxMsg["Asia/Baku"]="GMT +04:00 Baku";
AjxMsg["Asia/Bangkok"]="GMT +07:00 Bangkok, Hanoi, Jakarta";
AjxMsg["Asia/Beirut"]="GMT +02:00 Beirut";
AjxMsg["Asia/Colombo"]="GMT +05:30 Sri Jayawardenepura";
AjxMsg["Asia/Dhaka"]="GMT +06:00 Astana / Dhaka";
AjxMsg["Asia/Hong_Kong"]="GMT +08:00 Beijing / Chongqing / Hong Kong / Urumqi";
AjxMsg["Asia/Irkutsk"]="GMT +08:00 Irkutsk, Ulaan Bataar";
AjxMsg["Asia/Jerusalem"]="GMT +02:00 Jerusalem";
AjxMsg["Asia/Kabul"]="GMT +04:30 Kabul";
AjxMsg["Asia/Karachi"]="GMT +05:00 Islamabad / Karachi";
AjxMsg["Asia/Katmandu"]="GMT +05:45 Kathmandu";
AjxMsg["Asia/Kolkata"]="GMT +05:30 Chennai, Kolkata, Mumbai, New Delhi";
AjxMsg["Asia/Krasnoyarsk"]="GMT +07:00 Krasnoyarsk";
AjxMsg["Asia/Kuala_Lumpur"]="GMT +08:00 Kuala Lumpur / Singapore";
AjxMsg["Asia/Kuwait"]="GMT +03:00 Kuwait / Riyadh";
AjxMsg["Asia/Magadan"]="GMT +11:00 Magadan, Solomon Is., New Caledonia";
AjxMsg["Asia/Muscat"]="GMT +04:00 Abu Dhabi / Muscat";
AjxMsg["Asia/Novosibirsk"]="GMT +06:00 Almaty, Novosibirsk";
AjxMsg["Asia/Rangoon"]="GMT +06:30 Rangoon";
AjxMsg["Asia/Seoul"]="GMT +09:00 Korea";
AjxMsg["Asia/Taipei"]="GMT +08:00 China, Taiwan";
AjxMsg["Asia/Tashkent"]="GMT +05:00 Tashkent";
AjxMsg["Asia/Tbilisi"]="GMT +04:00 Tbilisi";
AjxMsg["Asia/Tehran"]="GMT +03:30 Tehran";
AjxMsg["Asia/Tokyo"]="GMT +09:00 Japan";
AjxMsg["Asia/Vladivostok"]="GMT +10:00 Vladivostok";
AjxMsg["Asia/Yakutsk"]="GMT +09:00 Yakutsk";
AjxMsg["Asia/Yekaterinburg"]="GMT +05:00 Yekaterinburg";
AjxMsg["Asia/Yerevan"]="GMT +04:00 Yerevan";
AjxMsg["Atlantic/Azores"]="GMT -01:00 Azores";
AjxMsg["Atlantic/Cape_Verde"]="GMT -01:00 Cape Verde Is.";
AjxMsg["Atlantic/South_Georgia"]="GMT -02:00 Mid-Atlantic";
AjxMsg["Australia/Adelaide"]="GMT +09:30 Adelaide (CT)";
AjxMsg["Australia/Brisbane"]="GMT +10:00 Brisbane";
AjxMsg["Australia/Darwin"]="GMT +09:30 Darwin";
AjxMsg["Australia/Hobart"]="GMT +10:00 Hobart";
AjxMsg["Australia/Perth"]="GMT +08:00 Perth";
AjxMsg["Australia/Sydney"]="GMT +10:00 Canberra / Melbourne / Sydney";
AjxMsg["Etc/GMT+12"]="GMT -12:00 Dateline";
AjxMsg["Europe/Athens"]="GMT +02:00 Athens, Beirut, Bucharest, Istanbul";
AjxMsg["Europe/Belgrade"]="GMT +01:00 Belgrade / Bratislava / Budapest / Ljubljana / Prague";
AjxMsg["Europe/Berlin"]="GMT +01:00 Amsterdam / Berlin / Bern / Rome / Stockholm / Vienna";
AjxMsg["Europe/Brussels"]="GMT +01:00 Brussels / Copenhagen / Madrid / Paris";
AjxMsg["Europe/Helsinki"]="GMT +02:00 Helsinki / Kyiv / Riga / Sofia / Tallinn / Vilnius";
AjxMsg["Europe/London"]="GMT +00:00 GMT Britain, Ireland, Portugal";
AjxMsg["Europe/Minsk"]="GMT +02:00 Minsk";
AjxMsg["Europe/Moscow"]="GMT +03:00 Moscow, St. Petersburg, Volgograd";
AjxMsg["Europe/Warsaw"]="GMT +01:00 Sarajevo / Skopje / Warsaw / Zagreb";
AjxMsg["Pacific/Auckland"]="GMT +12:00 New Zealand";
AjxMsg["Pacific/Fiji"]="GMT +12:00 Fiji";
AjxMsg["Pacific/Guam"]="GMT +10:00 Guam / Port Moresby";
AjxMsg["Pacific/Honolulu"]="GMT -10:00 Hawaii";
AjxMsg["Pacific/Midway"]="GMT -11:00 Midway Island / Samoa";
AjxMsg["Pacific/Tongatapu"]="GMT +13:00 Nuku'alofa";
AjxMsg.XfnumberLessThanMin="Value must be greater than or equal to {0}.";
AjxMsg._close="Close";
AjxMsg._finish="Finish";
AjxMsg._next="Next";
AjxMsg._prev="Previous";
AjxMsg.add="Add";
AjxMsg.addAll="Add All";
AjxMsg.ago="ago";
AjxMsg["calc.dayname.friday"]="fri|friday";
AjxMsg["calc.dayname.monday"]="mon|monday";
AjxMsg["calc.dayname.saturday"]="sat|saturday";
AjxMsg["calc.dayname.sunday"]="sun|sunday";
AjxMsg["calc.dayname.thursday"]="thu|thur|thurs|thursday";
AjxMsg["calc.dayname.tuesday"]="tue|tues|tuesday";
AjxMsg["calc.dayname.wednesday"]="wed|wednesday";
AjxMsg["calc.monthname.april"]="apr|april";
AjxMsg["calc.monthname.august"]="aug|august";
AjxMsg["calc.monthname.december"]="dec|december";
AjxMsg["calc.monthname.february"]="feb|february";
AjxMsg["calc.monthname.january"]="jan|january";
AjxMsg["calc.monthname.july"]="jul|july";
AjxMsg["calc.monthname.june"]="jun|june";
AjxMsg["calc.monthname.march"]="mar|march";
AjxMsg["calc.monthname.may"]="may";
AjxMsg["calc.monthname.november"]="nov|november";
AjxMsg["calc.monthname.october"]="oct|october";
AjxMsg["calc.monthname.september"]="sep|september";
AjxMsg["calc.ordinal.fifth"]="5th|fifth";
AjxMsg["calc.ordinal.first"]="1st|first";
AjxMsg["calc.ordinal.fourth"]="4th|fourth";
AjxMsg["calc.ordinal.last"]="last";
AjxMsg["calc.ordinal.second"]="2nd|second";
AjxMsg["calc.ordinal.third"]="3rd|third";
AjxMsg.calendarWeekTitle="W";
AjxMsg.cancel="Cancel";
AjxMsg.cancelRequest="Cancel Request";
AjxMsg.confirmTitle="Confirmation";
AjxMsg.criticalMsg="Critical";
AjxMsg.dateParsing2DigitStartYear="1936";
AjxMsg.day="day";
AjxMsg.days="days";
AjxMsg.detail="Detail";
AjxMsg.didNotMatchChoice="Value '{0}' did not match any values for this type.";
AjxMsg.dismiss="Dismiss";
AjxMsg["fontFamilyBase1.css"]="arial, helvetica, sans-serif";
AjxMsg["fontFamilyBase1.display"]="Arial";
AjxMsg["fontFamilyBase10.css"]="###";
AjxMsg["fontFamilyBase10.display"]="###";
AjxMsg["fontFamilyBase2.css"]="bookman old style, new york, times, serif";
AjxMsg["fontFamilyBase2.display"]="Bookman Old Style";
AjxMsg["fontFamilyBase3.css"]="Courier New, courier, monaco, monospace, sans-serif";
AjxMsg["fontFamilyBase3.display"]="Courier New";
AjxMsg["fontFamilyBase4.css"]="garamond, new york, times, serif";
AjxMsg["fontFamilyBase4.display"]="Garamond";
AjxMsg["fontFamilyBase5.css"]="lucida console, sans-serif";
AjxMsg["fontFamilyBase5.display"]="Lucida Console";
AjxMsg["fontFamilyBase6.css"]="symbol";
AjxMsg["fontFamilyBase6.display"]="Symbol";
AjxMsg["fontFamilyBase7.css"]="tahoma, new york, times, serif";
AjxMsg["fontFamilyBase7.display"]="Tahoma";
AjxMsg["fontFamilyBase8.css"]="times new roman, new york, times, serif";
AjxMsg["fontFamilyBase8.display"]="Times New Roman";
AjxMsg["fontFamilyBase9.css"]="verdana, helvetica, sans-serif";
AjxMsg["fontFamilyBase9.display"]="Verdana";
AjxMsg["fontFamilyIntl1.css"]="###";
AjxMsg["fontFamilyIntl1.display"]="###";
AjxMsg["fontFamilyIntl10.css"]="###";
AjxMsg["fontFamilyIntl10.display"]="###";
AjxMsg["fontFamilyIntl2.css"]="###";
AjxMsg["fontFamilyIntl2.display"]="###";
AjxMsg["fontFamilyIntl3.css"]="###";
AjxMsg["fontFamilyIntl3.display"]="###";
AjxMsg["fontFamilyIntl4.css"]="###";
AjxMsg["fontFamilyIntl4.display"]="###";
AjxMsg["fontFamilyIntl5.css"]="###";
AjxMsg["fontFamilyIntl5.display"]="###";
AjxMsg["fontFamilyIntl6.css"]="###";
AjxMsg["fontFamilyIntl6.display"]="###";
AjxMsg["fontFamilyIntl7.css"]="###";
AjxMsg["fontFamilyIntl7.display"]="###";
AjxMsg["fontFamilyIntl8.css"]="###";
AjxMsg["fontFamilyIntl8.display"]="###";
AjxMsg["fontFamilyIntl9.css"]="###";
AjxMsg["fontFamilyIntl9.display"]="###";
AjxMsg.formatCalDate="EEE, MMM d";
AjxMsg.formatCalDateFull="EEEE, MMMM d, yyyy";
AjxMsg.formatCalDateLong="EEEE, MMMM d";
AjxMsg.formatCalDay="M/d ";
AjxMsg.formatCalHour="{0,choice,0#Midnight|1#{1,time,h a}|12#Noon|13#{1,time,h a}|24#Midnight}";
AjxMsg.formatCalMonth="MMMM yyyy";
AjxMsg.formatDateMediumNoYear="MMM dd ";
AjxMsg.formatShortCalMonth="MMM yyyy";
AjxMsg.formatSizeAndUnits="{0} {1}";
AjxMsg.formatWordyDate="EEE, M/d/yy, h:mm a";
AjxMsg.formatWordyDateToday="'Today,' h:mm a";
AjxMsg.formatWordyDateYesterday="'Yesterday,' h:mm a";
AjxMsg.hour="hour";
AjxMsg.hours="hours";
AjxMsg.infoMsg="Informational";
AjxMsg.invalidDateString='Date value must be entered in the form: MM/DD/YYYY or "today", "yesterday" or "tomorrow".';
AjxMsg.invalidDatetimeString="Date format not understood.";
AjxMsg.invalidEmailAddr="Value is not a valid email address.";
AjxMsg.invalidTimeString="Time value must be entered in the form: HH:MM[:SS] [AM|PM]";
AjxMsg.listSeparator=", ";
AjxMsg.listSeparatorLast=" and ";
AjxMsg.loading="Loading...";
AjxMsg.minute="minute";
AjxMsg.minutes="minutes";
AjxMsg.month="month";
AjxMsg.monthAprShort="A";
AjxMsg.monthAugShort="A";
AjxMsg.monthDecShort="D";
AjxMsg.monthFebShort="F";
AjxMsg.monthJanShort="J";
AjxMsg.monthJulShort="J";
AjxMsg.monthJunShort="J";
AjxMsg.monthMarShort="M";
AjxMsg.monthMayShort="M";
AjxMsg.monthNovShort="N";
AjxMsg.monthOctShort="O";
AjxMsg.monthSepShort="S";
AjxMsg.months="months";
AjxMsg.no="No";
AjxMsg.noResults="No results found.";
AjxMsg.notANumber="Value must be a number.";
AjxMsg.notAString="Value must be a text string.";
AjxMsg.notAnInteger="Value must be an integer.";
AjxMsg.numberFractionExceeded="Fractional digits exceeds total of {0}.";
AjxMsg.numberLessThanEqualMin="Value must be greater than {0}.";
AjxMsg.numberLessThanMin="Value must be greater than or equal to {0}.";
AjxMsg.numberMoreThanEqualMax="Value must be less than {0}.";
AjxMsg.numberMoreThanMax="Value must be less than or equal to {0}.";
AjxMsg.numberMustBeNon0Percent="Value must be a percentage between 1 and 100";
AjxMsg.numberTotalExceeded="Whole digits exceeds total of {0}.";
AjxMsg.ok="OK";
AjxMsg.percentageString="{0}%";
AjxMsg.remove="Remove";
AjxMsg.removeAll="Remove All";
AjxMsg.second="second";
AjxMsg.seconds="seconds";
AjxMsg.select="Select";
AjxMsg.setColor="Set";
AjxMsg.showPassword="Show password";
AjxMsg.sizeBytes="B";
AjxMsg.sizeGigaBytes="GB";
AjxMsg.sizeKiloBytes="KB";
AjxMsg.sizeMegaBytes="MB";
AjxMsg.stringLenWrong="Value must be exactly {0} characters long.";
AjxMsg.stringMismatch="Value did not match valid values.";
AjxMsg.stringTooLong="Value must be no more than {0} characters long.";
AjxMsg.stringTooShort="Value must be at least {0} characters long.";
AjxMsg["timezoneNameAuto-DetectedLong"]="Auto-Detected";
AjxMsg["timezoneNameAuto-DetectedShort"]="Auto";
AjxMsg.today="today";
AjxMsg.tomorrow="tomorrow";
AjxMsg.valueIsRequired="Value is required";
AjxMsg.warningMsg="Warning";
AjxMsg.week="week";
AjxMsg.weekdayFriShort="F";
AjxMsg.weekdayMonShort="M";
AjxMsg.weekdaySatShort="S";
AjxMsg.weekdaySunShort="S";
AjxMsg.weekdayThuShort="T";
AjxMsg.weekdayTueShort="T";
AjxMsg.weekdayWedShort="W";
AjxMsg.weeks="weeks";
AjxMsg.workInProgress="Work In Progress";
AjxMsg.xFnumberMoreThanMax="Value must be less than or equal to {0}.";
AjxMsg.xformDateTimeFormat="{0,date} at {0,time}";
AjxMsg.xformFontColor="Font Color";
AjxMsg.xformRepeatAdd="+";
AjxMsg.xformRepeatRemove="-";
AjxMsg.year="year";
AjxMsg.years="years";
AjxMsg.yes="Yes";
AjxMsg.yesterday="yesterday";
if(!window.ZMsg){ZMsg={}
}ZMsg.BAD_JSON_RESPONSE="A network error has occurred.";
ZMsg.CSFE_SVC_ERROR="A network service error has occurred.";
ZMsg.EMPTY_RESPONSE="Cannot connect to server.";
ZMsg.NETWORK_ERROR="A network error has occurred.";
ZMsg.SOAP_ERROR="A network error has occurred.";
ZMsg["account.ACCT_NO_SUCH_TAG"]="No such tag exists.";
ZMsg["account.AUTH_FAILED"]="The username or password is incorrect. Verify that CAPS LOCK is not on, and then retype the current username and password.";
ZMsg["account.CHANGE_PASSWORD"]="Your password is no longer valid. Please choose a new password.";
ZMsg["account.INVALID_PASSWORD"]="You have entered an invalid password.";
ZMsg["account.INVALID_PREF_NAME"]="Invalid preference name.";
ZMsg["account.INVALID_PREF_VALUE"]="Invalid preference value.";
ZMsg["account.MAINTENANCE_MODE"]="This account is currently in maintenance mode.";
ZMsg["account.NO_SUCH_ACCOUNT"]="No such account exists.";
ZMsg["account.NO_SUCH_SAVED_SEARCH"]="No such saved search exists.";
ZMsg["account.PASSWORD_CHANGE_TOO_SOON"]="Password cannot be changed too soon.";
ZMsg["account.PASSWORD_LOCKED"]="Password locked. User not allowed to change password. Please contact your System Administrator.";
ZMsg["account.PASSWORD_RECENTLY_USED"]="The password you submitted has recently been used. Please choose a different password.";
ZMsg["account.TOO_MANY_IDENTITIES"]="The identity could not be created because you have exceeded your identity quota.";
ZMsg.errorEmptyResponse="Received empty response from server";
ZMsg.errorMaintenanceMode="The account is in maintenance mode";
ZMsg["formatter.INVALID_FORMAT"]='Invalid file format for file "{0}".';
ZMsg["formatter.INVALID_TYPE"]='Folder "{1}" cannot contain items of type "{0}".';
ZMsg["formatter.MISMATCHED_META"]='Meta information for item "{0}" does not match content.';
ZMsg["formatter.MISMATCHED_SIZE"]='Size of ignored item "{0}" does not match.';
ZMsg["formatter.MISMATCHED_TYPE"]='Cannot overwrite item "{0}" of different type.';
ZMsg["formatter.MISSING_BLOB"]='Content for item "{0}" is missing.';
ZMsg["formatter.MISSING_META"]='Meta information for item "{0}" is missing.';
ZMsg["formatter.MISSING_VCARD_FIELDS"]='Contact item "{0}" does not contain any fields.';
ZMsg["formatter.UNKNOWN_ERROR"]='Unknown error for item "{0}": {1}';
ZMsg["im.Banned"]="You have been banned from the room.";
ZMsg["im.INVALID_ADDRESS"]="The address is invalid.";
ZMsg["im.MaxUsers"]="The room has reached capacity.";
ZMsg["im.MustUseReservedRoomnick"]="You must use a reserved nickname.";
ZMsg["im.NicknameConflict"]="Someone else is already using your nickname.";
ZMsg["im.NoSuchRoom"]="No such room.";
ZMsg["im.NotAMember"]="The room is invite-only, and you aren't a member.";
ZMsg["im.NotAllowed"]="You are not allowed to create the room.";
ZMsg["im.PasswordRequired"]="A password is required to enter the room.";
ZMsg["im.Unknown"]="Unknown error.";
ZMsg["im.forbidden"]="Forbidden.";
ZMsg["im.internal_server_error"]="An internal server error occurred.";
ZMsg["im.item_not_found"]="The user was not found. The message may not have been sent.";
ZMsg["im.jid_malformed"]="The address is invalid.";
ZMsg["im.not_acceptable"]="The message is not acceptable.";
ZMsg["im.not_allowed"]="You are not allowed to send a message to the intended recipient.";
ZMsg["im.payment_required"]="Payment required.";
ZMsg["im.recipient_unavailable"]="The recipient is unavailable.";
ZMsg["im.redirect"]="The user is at a different address.";
ZMsg["im.remote_server_not_found"]="The remote server could not be found.";
ZMsg["im.remote_server_timeout"]="The connection to the remote server timed out.";
ZMsg["im.resource_constraint"]="The system is busy.";
ZMsg["im.service_unavailable"]="Messages are not accepted by the service.";
ZMsg["im.undefined_condition"]="An undefined error occurred. ";
ZMsg["im.unknown_error"]="An unknown error occurred.";
ZMsg["mail.ALREADY_EXISTS"]="An object with that name already exists.";
ZMsg["mail.INVALID_NAME"]='Sorry, "{0}" is not a valid name. It contains at least one invalid character.';
ZMsg["mail.MAIL_UNABLE_TO_IMPORT_APPOINTMENTS"]="Unable to import. The chosen file may be invalid.";
ZMsg["mail.MAIL_UNABLE_TO_IMPORT_CONTACTS"]="Unable to import. The chosen file may be invalid.";
ZMsg["mail.MAINTENANCE"]="This account is currently in maintenance mode.";
ZMsg["mail.MESSAGE_TOO_BIG"]="This message cannot be sent because it has exceeded the maximum allowed size.";
ZMsg["mail.MODIFY_CONFLICT"]="Item version number conflict. Another version was added between edit and save.";
ZMsg["mail.NO_SUCH_CONV"]="No such conversation exists.";
ZMsg["mail.NO_SUCH_FOLDER"]="No such folder exists.";
ZMsg["mail.NO_SUCH_ITEM"]='Item "{0}" does not exist.';
ZMsg["mail.NO_SUCH_MSG"]="No such message exists.";
ZMsg["mail.NO_SUCH_PART"]="No such message part exists.";
ZMsg["mail.NO_SUCH_TAG"]="No such tag exists.";
ZMsg["mail.QUERY_PARSE_ERROR"]="Unable to parse the search query.";
ZMsg["mail.QUOTA_EXCEEDED"]="Your message could not be sent because you have exceeded your mail quota.";
ZMsg["mail.SEND_ABORTED_ADDRESS_FAILURE"]="Could not send message due to invalid address(es)";
ZMsg["mail.SEND_FAILURE"]="Could not send message: {0}";
ZMsg["mail.TOO_MANY_CONTACTS"]="Contact could not be created because you have exceeded your contact quota.";
ZMsg["mail.TOO_MANY_QUERY_TERMS_EXPANDED"]="Please be more specific in your search criteria.";
ZMsg["mail.TOO_MANY_TAGS"]="A tag could not be created because you have exceeded the limit.";
ZMsg["offline.ONLINE_ONLY_OP"]="You must be online to use this feature. Please check your network connection and try again.";
ZMsg["service.ALREADY_IN_PROGRESS"]="Operation already in progress.";
ZMsg["service.AUTH_EXPIRED"]="Your session has expired. Please login again.";
ZMsg["service.AUTH_REQUIRED"]="Authentication Required";
ZMsg["service.FAILURE"]="A network service error has occurred.";
ZMsg["service.INTERRUPTED"]="The operation has been interrupted";
ZMsg["service.INVALID_REQUEST"]="An invalid request was made.";
ZMsg["service.NON_READONLY_OPERATION_DENIED"]="The server is in read-only mode.";
ZMsg["service.NOT_IN_PROGRESS"]="Operation not in progress.";
ZMsg["service.NO_SPELL_CHECK_URL"]="No spell check server defined.";
ZMsg["service.PARSE_ERROR"]="A parsing error has occurred.";
ZMsg["service.PERM_DENIED"]="Permission denied.";
ZMsg["service.PROXY_ERROR"]="Proxy error.";
ZMsg["service.RESOURCE_UNREACHABLE"]="Resource unreachable.";
ZMsg["service.TEMPORARILY_UNAVAILABLE"]="Service temporarily unavailable.";
ZMsg["service.TOO_MANY_HOPS"]="Too many hops between servers.";
ZMsg["service.UNKNOWN_DOCUMENT"]="Server error (unknown command sent to server).";
ZMsg["service.WRONG_HOST"]="Request was sent to the wrong server.";
ZMsg.unknownError="An unknown error ({0}) has occurred.";
ZMsg["voice.UNABLE_TO_DELETE_VOICEMAIL"]="Unable to delete voice mail.";
ZMsg["voice.UNABLE_TO_EMPTY_VOICEMAIL_TRASH"]="Unable to empty voice mail trash.";
ZMsg["voice.UNABLE_TO_FORWARD_VOICEMAIL"]="Your email could not be forwarded at this time. Please try again later.";
ZMsg["voice.UNABLE_TO_MODIFY_CALL_FEATURES"]="We are temporarily unable to forward calls. We apologize for this inconvenience.";
ZMsg["voice.UNABLE_TO_MODIFY_VOICEMAIL_PREFS"]="An error occurred while attempting to update your voice mail preferences. Please try again.";
ZMsg["voice.UNABLE_TO_MODIFY_VOICEMAIL_STATUS"]="Unable to modify voice mail status. ";
ZMsg["voice.UNABLE_TO_RETRIEVE_CALLLOGS"]="We are currently unable to display call records. We apologize for this inconvenience.";
ZMsg["voice.UNABLE_TO_RETRIEVE_CALL_FEATURES"]="Unable to retrieve call features.";
ZMsg["voice.UNABLE_TO_RETRIEVE_PROFILE_SUMMARY"]="The system is currently unable to complete your request. We apologize for this inconvenience.";
ZMsg["voice.UNABLE_TO_RETRIEVE_VOICEMAIL_CONTENT"]="Unable to retrieve voice mail content.";
ZMsg["voice.UNABLE_TO_RETRIEVE_VOICEMAIL_FOLDER"]="We are temporarily unable to display voice mail records.";
ZMsg["voice.UNABLE_TO_RETRIEVE_VOICEMAIL_PREFS"]="Unable to retrieve voice mail preferences.";
ZMsg["voice.UNABLE_TO_RETRIEVE_VOICEMAIL_SUMMARY"]="Unable to retrieve voice mail summary.";
ZMsg["voice.UNABLE_TO_UNDELETE_VOICEMAIL"]="Unable to undelete voice mail.";
ZMsg["voice.UNABLE_TO_UPDATE_CALL_FEATURES"]="We are temporarily unable to forward calls. We apologize for this inconvenience.";
ZMsg["zclient.CLIENT_ERROR"]="A network service error has occurred (zclient).";
ZMsg["zclient.IO_ERROR"]="A network service error has occurred (zclient/io).";
ZMsg["ztaglib.TAG_EXCEPTION"]="A client error occurred. Please try again.";
if(!window.ZmMsg){ZmMsg={}
}ZmMsg.AB_ADDR_HOME="Home Address";
ZmMsg.AB_ADDR_OTHER="Other Address";
ZmMsg.AB_ADDR_WORK="Work Address";
ZmMsg.AB_ADD_CONTACT="Add To Contacts";
ZmMsg.AB_EDIT_CONTACT="Edit Contact";
ZmMsg.AB_EDIT_GROUP="Edit Group";
ZmMsg.AB_FIELD_URL="Web Page";
ZmMsg.AB_FIELD_anniversary="Anniversary";
ZmMsg.AB_FIELD_assistantPhone="Assistant Phone";
ZmMsg.AB_FIELD_attachment="Attachment";
ZmMsg.AB_FIELD_birthday="Birthday";
ZmMsg.AB_FIELD_callbackPhone="Callback";
ZmMsg.AB_FIELD_carPhone="Car";
ZmMsg.AB_FIELD_city="City";
ZmMsg.AB_FIELD_company="Company";
ZmMsg.AB_FIELD_companyPhone="Company Phone";
ZmMsg.AB_FIELD_country="Country/Region";
ZmMsg.AB_FIELD_custom="Custom";
ZmMsg.AB_FIELD_department="Department";
ZmMsg.AB_FIELD_email="Email";
ZmMsg.AB_FIELD_email2="Email 2";
ZmMsg.AB_FIELD_email3="Email 3";
ZmMsg.AB_FIELD_firstName="First";
ZmMsg.AB_FIELD_fullName="Full Name";
ZmMsg.AB_FIELD_fullNameLabel="Full Name:";
ZmMsg.AB_FIELD_homeCity="Home City";
ZmMsg.AB_FIELD_homeCountry="Home Country/Region";
ZmMsg.AB_FIELD_homeFax="Home Fax";
ZmMsg.AB_FIELD_homePhone="Home Phone";
ZmMsg.AB_FIELD_homePhone2="Home Phone 2";
ZmMsg.AB_FIELD_homePostalCode="Home Postal Code";
ZmMsg.AB_FIELD_homeState="Home State/Province";
ZmMsg.AB_FIELD_homeStreet="Home Street";
ZmMsg.AB_FIELD_homeURL="Home Web Page";
ZmMsg.AB_FIELD_imAddress="IM Address";
ZmMsg.AB_FIELD_imAddress1="IM Address";
ZmMsg.AB_FIELD_imAddress2="IM Address 2";
ZmMsg.AB_FIELD_imAddress3="IM Address 3";
ZmMsg.AB_FIELD_image="Image";
ZmMsg.AB_FIELD_jobTitle="Job Title";
ZmMsg.AB_FIELD_lastName="Last";
ZmMsg.AB_FIELD_maidenName="Maiden";
ZmMsg.AB_FIELD_middleName="Middle";
ZmMsg.AB_FIELD_mobilePhone="Mobile";
ZmMsg.AB_FIELD_nickname="Nickname";
ZmMsg.AB_FIELD_otherCity="Other City";
ZmMsg.AB_FIELD_otherCountry="Other Country/Region";
ZmMsg.AB_FIELD_otherFax="Other Fax";
ZmMsg.AB_FIELD_otherPhone="Other Phone";
ZmMsg.AB_FIELD_otherPostalCode="Other Postal Code";
ZmMsg.AB_FIELD_otherState="Other State/Province";
ZmMsg.AB_FIELD_otherStreet="Other Street";
ZmMsg.AB_FIELD_otherURL="Other Web Page";
ZmMsg.AB_FIELD_pager="Pager";
ZmMsg.AB_FIELD_postalCode="Postal Code";
ZmMsg.AB_FIELD_prefix="Prefix";
ZmMsg.AB_FIELD_state="State/Province";
ZmMsg.AB_FIELD_street="Street";
ZmMsg.AB_FIELD_suffix="Suffix";
ZmMsg.AB_FIELD_workAltPhone="Work Alternate";
ZmMsg.AB_FIELD_workCity="Work City";
ZmMsg.AB_FIELD_workCountry="Work Country/Region";
ZmMsg.AB_FIELD_workFax="Work Fax";
ZmMsg.AB_FIELD_workMobile="Work Mobile";
ZmMsg.AB_FIELD_workPhone="Work Phone";
ZmMsg.AB_FIELD_workPhone2="Work Phone 2";
ZmMsg.AB_FIELD_workPostalCode="Work Postal Code";
ZmMsg.AB_FIELD_workState="Work State/Province";
ZmMsg.AB_FIELD_workStreet="Work Street";
ZmMsg.AB_FIELD_workURL="Work Web Page";
ZmMsg.AB_FILE_AS_company="Company";
ZmMsg.AB_FILE_AS_companyFirstLast="Company (First Last)";
ZmMsg.AB_FILE_AS_companyLastFirst="Company (Last, First)";
ZmMsg.AB_FILE_AS_firstLast="First Last";
ZmMsg.AB_FILE_AS_firstLastCompany="First Last (Company)";
ZmMsg.AB_FILE_AS_lastFirst="Last, First";
ZmMsg.AB_FILE_AS_lastFirstCompany="Last, First (Company)";
ZmMsg.AB_HOME_URL="Home URL";
ZmMsg.AB_MOVE_CONTACT="Move Contact";
ZmMsg.AB_MOVE_CONTACTS="Move Contacts";
ZmMsg.AB_OTHER_URL="Other URL";
ZmMsg.AB_TAG_CONTACT="Tag Contact";
ZmMsg.AB_TAG_CONTACTS="Tag Contacts";
ZmMsg.AB_TAG_GROUP="Tag Group";
ZmMsg.AB_WORK_URL="Work URL";
ZmMsg.ALT_ERROR="Error";
ZmMsg.ASST_APPT_HELP='The appointment assistant allows you to quickly create a new appointment without switching context from what you are currently doing.<br><br><b>Examples:</b><br><ul><li>lunch with Dave next friday 11am - 1pm<li>"Linux Conference" April 5th April 10th [San Francisco]</ul>';
ZmMsg.ASST_APPT_location="[enclose location in brackets]";
ZmMsg.ASST_APPT_notes="(enclose notes in parenthesis)";
ZmMsg.ASST_APPT_subject='"enclose subject in quotes or just type"';
ZmMsg.ASST_CALENDAR_HELP="The calendar assistant allows you to quickly go to a specific date and calender view.<br><br><b>Examples:</b><br><ul><li>August 8th<li>next friday<li>December 2009 month<li>Jan 5th, 2008 week</ul>";
ZmMsg.ASST_CMD_APPOINTMENT="appointment";
ZmMsg.ASST_CMD_CALENDAR="calendar";
ZmMsg.ASST_CMD_CALL="call";
ZmMsg.ASST_CMD_CONTACT="contact";
ZmMsg.ASST_CMD_MAIL="mail";
ZmMsg.ASST_CMD_SUM_APPOINTMENT="Create a new appointment";
ZmMsg.ASST_CMD_SUM_CALENDAR="Go to a specific date in the calendar";
ZmMsg.ASST_CMD_SUM_CONTACT="Create a new contact";
ZmMsg.ASST_CMD_SUM_MAIL="Send an email message";
ZmMsg.ASST_CMD_SUM_TASK="Create a new task";
ZmMsg.ASST_CMD_TASK="task";
ZmMsg.ASST_CONTACT_HELP="The contact assistant allows you to quickly create a new contact without switching context from what you are currently doing.<br><br><b>Examples:</b><br><ul><li>John Doe john@doe.com www.doe.com (123) 456-6789<li>l:Doe f:John e:john@doe.com hu: http://www.doe.com hf: (123) 456-6789<li>c:zimbra [1500 fashion island blvd; san mateo; ca; 94404]</ul><br><b>Available fields:</b><br><br>";
ZmMsg.ASST_CONTACT_LONG_assistantPhone="assistantPhone";
ZmMsg.ASST_CONTACT_LONG_callbackPhone="callbackPhone";
ZmMsg.ASST_CONTACT_LONG_carPhone="carPhone";
ZmMsg.ASST_CONTACT_LONG_company="company";
ZmMsg.ASST_CONTACT_LONG_companyPhone="companyPhone";
ZmMsg.ASST_CONTACT_LONG_email="email";
ZmMsg.ASST_CONTACT_LONG_email2="email2";
ZmMsg.ASST_CONTACT_LONG_email3="email3";
ZmMsg.ASST_CONTACT_LONG_firstName="firstName";
ZmMsg.ASST_CONTACT_LONG_homeAddress="homeAddress";
ZmMsg.ASST_CONTACT_LONG_homeCity="homeCity";
ZmMsg.ASST_CONTACT_LONG_homeCountry="homeCountry";
ZmMsg.ASST_CONTACT_LONG_homeFax="homeFax";
ZmMsg.ASST_CONTACT_LONG_homePhone="homePhone";
ZmMsg.ASST_CONTACT_LONG_homePhone2="homePhone2";
ZmMsg.ASST_CONTACT_LONG_homePostalCode="homePostalCode";
ZmMsg.ASST_CONTACT_LONG_homeState="homeState";
ZmMsg.ASST_CONTACT_LONG_homeStreet="homeStreet";
ZmMsg.ASST_CONTACT_LONG_homeURL="homeURL";
ZmMsg.ASST_CONTACT_LONG_jobTitle="jobTitle";
ZmMsg.ASST_CONTACT_LONG_lastName="lastName";
ZmMsg.ASST_CONTACT_LONG_middleName="middleName";
ZmMsg.ASST_CONTACT_LONG_mobilePhone="mobilePhone";
ZmMsg.ASST_CONTACT_LONG_notes="notes";
ZmMsg.ASST_CONTACT_LONG_otherAddress="otherAddress";
ZmMsg.ASST_CONTACT_LONG_otherCity="otherCity";
ZmMsg.ASST_CONTACT_LONG_otherCountry="otherCountry";
ZmMsg.ASST_CONTACT_LONG_otherFax="otherFax";
ZmMsg.ASST_CONTACT_LONG_otherPhone="otherPhone";
ZmMsg.ASST_CONTACT_LONG_otherPostalCode="otherPostalCode";
ZmMsg.ASST_CONTACT_LONG_otherState="otherState";
ZmMsg.ASST_CONTACT_LONG_otherStreet="otherStreet";
ZmMsg.ASST_CONTACT_LONG_otherURL="otherURL";
ZmMsg.ASST_CONTACT_LONG_pager="pager";
ZmMsg.ASST_CONTACT_LONG_workAddress="workAddress";
ZmMsg.ASST_CONTACT_LONG_workCity="workCity";
ZmMsg.ASST_CONTACT_LONG_workCountry="workCountry";
ZmMsg.ASST_CONTACT_LONG_workFax="workFax";
ZmMsg.ASST_CONTACT_LONG_workPhone="workPhone";
ZmMsg.ASST_CONTACT_LONG_workPhone2="workPhone2";
ZmMsg.ASST_CONTACT_LONG_workPostalCode="workPostalCode";
ZmMsg.ASST_CONTACT_LONG_workState="workState";
ZmMsg.ASST_CONTACT_LONG_workStreet="workStreet";
ZmMsg.ASST_CONTACT_LONG_workURL="workURL";
ZmMsg.ASST_CONTACT_SHORT_assistantPhone="a";
ZmMsg.ASST_CONTACT_SHORT_callbackPhone="cb";
ZmMsg.ASST_CONTACT_SHORT_carPhone="ca";
ZmMsg.ASST_CONTACT_SHORT_company="c";
ZmMsg.ASST_CONTACT_SHORT_companyPhone="cp";
ZmMsg.ASST_CONTACT_SHORT_email="e";
ZmMsg.ASST_CONTACT_SHORT_email2="e2";
ZmMsg.ASST_CONTACT_SHORT_email3="e3";
ZmMsg.ASST_CONTACT_SHORT_firstName="fn";
ZmMsg.ASST_CONTACT_SHORT_homeAddress="ha";
ZmMsg.ASST_CONTACT_SHORT_homeCity="hc";
ZmMsg.ASST_CONTACT_SHORT_homeCountry="co";
ZmMsg.ASST_CONTACT_SHORT_homeFax="hf";
ZmMsg.ASST_CONTACT_SHORT_homePhone="hp";
ZmMsg.ASST_CONTACT_SHORT_homePhone2="hp2";
ZmMsg.ASST_CONTACT_SHORT_homePostalCode="hz";
ZmMsg.ASST_CONTACT_SHORT_homeState="st";
ZmMsg.ASST_CONTACT_SHORT_homeStreet="hs";
ZmMsg.ASST_CONTACT_SHORT_homeURL="hu";
ZmMsg.ASST_CONTACT_SHORT_jobTitle="t";
ZmMsg.ASST_CONTACT_SHORT_lastName="ln";
ZmMsg.ASST_CONTACT_SHORT_middleName="mn";
ZmMsg.ASST_CONTACT_SHORT_mobilePhone="m";
ZmMsg.ASST_CONTACT_SHORT_notes="n";
ZmMsg.ASST_CONTACT_SHORT_otherAddress="oa";
ZmMsg.ASST_CONTACT_SHORT_otherCity="oc";
ZmMsg.ASST_CONTACT_SHORT_otherCountry="oco";
ZmMsg.ASST_CONTACT_SHORT_otherFax="of";
ZmMsg.ASST_CONTACT_SHORT_otherPhone="op";
ZmMsg.ASST_CONTACT_SHORT_otherPostalCode="oz";
ZmMsg.ASST_CONTACT_SHORT_otherState="ost";
ZmMsg.ASST_CONTACT_SHORT_otherStreet="os";
ZmMsg.ASST_CONTACT_SHORT_otherURL="ou";
ZmMsg.ASST_CONTACT_SHORT_pager="p";
ZmMsg.ASST_CONTACT_SHORT_workAddress="wa";
ZmMsg.ASST_CONTACT_SHORT_workCity="wc";
ZmMsg.ASST_CONTACT_SHORT_workCountry="wco";
ZmMsg.ASST_CONTACT_SHORT_workFax="f";
ZmMsg.ASST_CONTACT_SHORT_workPhone="wp";
ZmMsg.ASST_CONTACT_SHORT_workPhone2="wp2";
ZmMsg.ASST_CONTACT_SHORT_workPostalCode="wz";
ZmMsg.ASST_CONTACT_SHORT_workState="wst";
ZmMsg.ASST_CONTACT_SHORT_workStreet="ws";
ZmMsg.ASST_CONTACT_SHORT_workURL="wu";
ZmMsg.ASST_CONTACT_address="[street; city; state; zip; country]";
ZmMsg.ASST_CONTACT_email="type an email address";
ZmMsg.ASST_CONTACT_fullName="type to enter fullname";
ZmMsg.ASST_CONTACT_notes="(enclose notes in parenthesis)";
ZmMsg.ASST_CONTACT_phone="type a phone number";
ZmMsg.ASST_CONTACT_url="type a URL";
ZmMsg.ASST_HELP="The assistant provides a quick way to interact with the system via the keyboard.<br><br>Available commands:<br><br>";
ZmMsg.ASST_MAIL_HELP='The mail assistant allows you to quickly send a new mail message without switching context from what you are currently doing.<br><br><b>Examples:</b><br><ul><li>"call me" to:john@doe.com body: call me about the quote<li>subject: monday is good to:john@doe.com cc:jan@doe.com</ul>';
ZmMsg.ASST_MAIL_body="type body: followed by the body (must be last)";
ZmMsg.ASST_MAIL_subject='"enclose subject in quotes"';
ZmMsg.ASST_MAIL_to="type to: followed by adddresses";
ZmMsg.ASST_TASK_HELP='The TASK assistant allows you to quickly create a new TASK without switching context from what you are currently doing.<br><br><b>Examples:</b><br><ul><li>lunch with Dave next friday <li>"Soccer practice" April 5th April 10th [San Francisco]</ul>';
ZmMsg.ASST_availableCommands="available commands:";
ZmMsg.ASST_no_match="(no commands match)";
ZmMsg.COLUMN_WIDTH_ACTIONS_SH="180";
ZmMsg.COLUMN_WIDTH_ACTIVE="50";
ZmMsg.COLUMN_WIDTH_CAPACITY_NA="50";
ZmMsg.COLUMN_WIDTH_CONTACT_NA="150";
ZmMsg.COLUMN_WIDTH_DATE="75";
ZmMsg.COLUMN_WIDTH_DATE_CAL="105";
ZmMsg.COLUMN_WIDTH_DATE_CALL="180";
ZmMsg.COLUMN_WIDTH_DATE_DLV="80";
ZmMsg.COLUMN_WIDTH_DATE_DUE_TLV="110";
ZmMsg.COLUMN_WIDTH_FBSTATUS_NA="80";
ZmMsg.COLUMN_WIDTH_FOLDER="47";
ZmMsg.COLUMN_WIDTH_FOLDER_CAL="100";
ZmMsg.COLUMN_WIDTH_FOLDER_CN="20";
ZmMsg.COLUMN_WIDTH_FOLDER_DLV="100";
ZmMsg.COLUMN_WIDTH_FOLDER_FLV="120";
ZmMsg.COLUMN_WIDTH_FOLDER_NA="160";
ZmMsg.COLUMN_WIDTH_FOLDER_SH="150";
ZmMsg.COLUMN_WIDTH_FROM_CALL="190";
ZmMsg.COLUMN_WIDTH_FROM_CLV="145";
ZmMsg.COLUMN_WIDTH_FROM_MLV="105";
ZmMsg.COLUMN_WIDTH_HOME_PHONE_NA="100";
ZmMsg.COLUMN_WIDTH_ID_MDL="250";
ZmMsg.COLUMN_WIDTH_ITEM_COUNT="120";
ZmMsg.COLUMN_WIDTH_LOCATION_CAL="175";
ZmMsg.COLUMN_WIDTH_NAME_ACC="170";
ZmMsg.COLUMN_WIDTH_NAME_CN="100";
ZmMsg.COLUMN_WIDTH_NAME_NA="150";
ZmMsg.COLUMN_WIDTH_NOTES_NA="30";
ZmMsg.COLUMN_WIDTH_OWNER_DLV="80";
ZmMsg.COLUMN_WIDTH_OWNER_SH="180";
ZmMsg.COLUMN_WIDTH_PCOMPLETE_TLV="75";
ZmMsg.COLUMN_WIDTH_PROTOCOL_MDL="100";
ZmMsg.COLUMN_WIDTH_PROVISIONABLE_MDL="75";
ZmMsg.COLUMN_WIDTH_ROLE_SH="50";
ZmMsg.COLUMN_WIDTH_SIZE="45";
ZmMsg.COLUMN_WIDTH_SIZE_DLV="45";
ZmMsg.COLUMN_WIDTH_STATUS_ACC="80";
ZmMsg.COLUMN_WIDTH_STATUS_CAL="80";
ZmMsg.COLUMN_WIDTH_STATUS_MDL="150";
ZmMsg.COLUMN_WIDTH_STATUS_TLV="110";
ZmMsg.COLUMN_WIDTH_TYPE_ACC="85";
ZmMsg.COLUMN_WIDTH_TYPE_CN="20";
ZmMsg.COLUMN_WIDTH_TYPE_DLV="80";
ZmMsg.COLUMN_WIDTH_TYPE_SH="60";
ZmMsg.COLUMN_WIDTH_WITH_SH="180";
ZmMsg.COLUMN_WIDTH_WORK_PHONE_NA="100";
ZmMsg.CRLF="\r\n";
ZmMsg.CRLF2="\r\n\r\n";
ZmMsg.DASHES="-----";
ZmMsg.GAL="Global Address List";
ZmMsg.P_TIME_LAST_4_HOURS="last 4 hours";
ZmMsg.P_TIME_LAST_HOUR="last hour";
ZmMsg.P_TIME_LAST_MONTH="last month";
ZmMsg.P_TIME_LAST_WEEK="last week";
ZmMsg.P_TIME_LAST_YEAR="last year";
ZmMsg.P_TIME_THIS_MONTH="this month";
ZmMsg.P_TIME_THIS_WEEK="this week";
ZmMsg.P_TIME_THIS_YEAR="this year";
ZmMsg.P_TIME_TITLE="Time";
ZmMsg.P_TIME_TODAY="today";
ZmMsg.P_TIME_YESTERDAY="yesterday";
ZmMsg._export="Export";
ZmMsg._import="Import";
ZmMsg._name="Name";
ZmMsg._new="New";
ZmMsg._private="Private";
ZmMsg._public="Public";
ZmMsg.above="Above";
ZmMsg.aboveQuotedText="Above included messages";
ZmMsg.accept="Accept";
ZmMsg.acceptShare="Accept Share";
ZmMsg.acceptShareDetails='They have granted you the <b>{0}</b> role, which means:<div style="margin-left:15px;margin-bottom:3px;margin-top:3px;">{1}</div>';
ZmMsg.acceptShareDetailsAdmin="<li>You can <b>View</b> and <b>Edit</b> items in the folder.<li>You can <b>Add</b> and <b>Remove</b> items to/from the folder.<li>You can <b>Accept</b> and <b>Decline</b> workflow actions for the folder.<li>You can <b>Administer</b> the folder as if it were your own (i.e. share with another user).";
ZmMsg.acceptShareDetailsManager="<li>You can <b>View</b> and <b>Edit</b> items in the folder.<li>You can <b>Add</b> and <b>Remove</b> items to/from the folder.<li>You can <b>Accept</b> and <b>Decline</b> workflow actions for the folder.";
ZmMsg.acceptShareDetailsNone="<li>You cannot do anything to items in the folder.";
ZmMsg.acceptShareDetailsViewer="<li>You can <b>View</b> items in the folder.";
ZmMsg.acceptShareHeader="<b>{0}</b> has shared their <b>{1}</b> folder with you.";
ZmMsg.acceptShareQuestion="Do you want to accept this share?";
ZmMsg.accepted="Accepted";
ZmMsg.account="Account";
ZmMsg.accountChangePortLabel="Change {0} port";
ZmMsg.accountChangeRestart="Would you like to reload the application now to show the new account changes? (Otherwise, the account changes will appear the next time you log in.)";
ZmMsg.accountDefault="Primary Account";
ZmMsg.accountDeleteAfterDownload="Delete messages on the server after downloading them";
ZmMsg.accountDeleteFolder='<b>Do you want to delete the folder "{0}"?</b><p>The folder and all messages contained in the folder will be moved to the Trash.';
ZmMsg.accountDownloadToFolder="Folder: {0}";
ZmMsg.accountDownloadToInbox="Inbox";
ZmMsg.accountDownloadToLabel="Download messages to:";
ZmMsg.accountFromPrompt="Messages sent from this account have the following settings:";
ZmMsg.accountHeaderExternal="External Account Settings";
ZmMsg.accountHeaderPrimary="Primary Account Settings";
ZmMsg.accountInactiveContent="This account could not be activated. Please verify the account settings.";
ZmMsg.accountInactiveTitle="Inactive Account";
ZmMsg.accountLabel="Account:";
ZmMsg.accountName="Account Name";
ZmMsg.accountNameLabel="Account Name:";
ZmMsg.accountNameReserved='Account name "{0}" is reserved. Please choose a different name.';
ZmMsg.accountPersonaInstructions="Use personas to quickly change many settings when sending email messages. For example, if you sometimes send email in a particular role at work, create a persona for that role.";
ZmMsg.accountPersonaLabel="Persona Name:";
ZmMsg.accountPersonaUseLabel="Use this persona:";
ZmMsg.accountPortDefault="({0,number} is the default)";
ZmMsg.accountReplyTo='Set the "Reply-to" field of email messages to:';
ZmMsg.accountServerLabel="Email Server:";
ZmMsg.accountSettings="Account Settings";
ZmMsg.accountSubHeader="{0}";
ZmMsg.accountTest="Test Settings";
ZmMsg.accountTestErrorMissingInfo="You must specify the username, server, and password.";
ZmMsg.accountTypeImap="IMAP";
ZmMsg.accountTypeLabel="Account type:";
ZmMsg.accountTypePersona="Persona";
ZmMsg.accountTypePop="POP";
ZmMsg.accountTypePrimary="Primary";
ZmMsg.accountTypeSecondary="Secondary";
ZmMsg.accountUseSSL="Use an encrypted connection (SSL) when accessing this server";
ZmMsg.accountUsernameLabel="Username of Account:";
ZmMsg.accounts="Accounts";
ZmMsg.action="Action";
ZmMsg.actionLabel="Action:";
ZmMsg.actions="Actions";
ZmMsg.active="Active";
ZmMsg.add="Add";
ZmMsg.addAll="Add All";
ZmMsg.addAttachment="Add Attachment";
ZmMsg.addAttachments="Add Attachments";
ZmMsg.addDocuments="Upload Files";
ZmMsg.addDocumentsTT="Upload one or more files to this notebook";
ZmMsg.addExternalAccount="Add External Account";
ZmMsg.addFilter="Add Filter";
ZmMsg.addImg="Add Image";
ZmMsg.addLabel="Add:";
ZmMsg.addMembers="Add Members to this Group";
ZmMsg.addMoreAttachments="Add More Attachments";
ZmMsg.addNewPhoto="Add New Photo";
ZmMsg.addPersona="Add Persona";
ZmMsg.addPhoto="Add Photo";
ZmMsg.addRemoteAppts="Synchronize appointments from remote calendar";
ZmMsg.addRemoteTasks="Synchronize tasks from remote service (i.e. iCal)";
ZmMsg.addSearch="Add a search to the current query.";
ZmMsg.addShare="Add Share...";
ZmMsg.addSignature="Add Signature";
ZmMsg.addToAddrBook="add to address book";
ZmMsg.addToBriefcase="Briefcase";
ZmMsg.addToBriefcaseTitle="Add to Briefcase";
ZmMsg.addToExistingContact="Add to Existing Contact";
ZmMsg.addToNewContact="Add to New Contact";
ZmMsg.added="Added:";
ZmMsg.address="Address";
ZmMsg.addressBook="Address Book";
ZmMsg.addressBookLabel="Address Book:";
ZmMsg.addressBooks="Address Books";
ZmMsg.addressHint="Address (jsmith@address.com)";
ZmMsg.addressIn="Address in";
ZmMsg.addressLabel="Address:";
ZmMsg.adminLinkLabel="Domain Admin";
ZmMsg.adobePdfDocument="Adobe PDF";
ZmMsg.adobePsDocument="Adobe Postscript";
ZmMsg.advanced="Advanced";
ZmMsg.advancedSearch="Advanced Search";
ZmMsg.advancedSearchTooltip="Open / close advanced search";
ZmMsg.advancedSettings="Advanced settings";
ZmMsg.advancedSettingsLabel="Advanced Settings:";
ZmMsg.after="After";
ZmMsg.afterLc="after";
ZmMsg.afterReload="Setting will take effect after a reload";
ZmMsg.agenda="Agenda";
ZmMsg.aleError="Can't deserialize component";
ZmMsg.align="Align";
ZmMsg.alignment="Alignment";
ZmMsg.all="All";
ZmMsg.allAccounts="All Accounts";
ZmMsg.allAttendees="All Attendees";
ZmMsg.allConditions="All conditions";
ZmMsg.allDay="All day";
ZmMsg.allDayEvent="All day event";
ZmMsg.allFolders="All folders";
ZmMsg.allMail="All Mail";
ZmMsg.allPageSelected="{0} items selected. To select all search results, use Shift-click.";
ZmMsg.allRemindersAreSnoozed="All Reminders are snoozed";
ZmMsg.allSearchSelected="All search results selected, including those not yet loaded.";
ZmMsg.allTags="All Tags";
ZmMsg.allowMultipleLocations="Allow multiple locations";
ZmMsg.almostSupportedBrowserTip='Please note that because you are running an unsupported browser, your user experience may be affected, and all functionality may not be available.<p><a href="javascript:;" onclick="{0}">Click here to continue.</a> <br />';
ZmMsg.alphabet="All,123,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z";
ZmMsg.alwaysShowMiniCal="Always show the mini-calendar";
ZmMsg.andMore="And more...";
ZmMsg.answeredCalls="Answered Calls";
ZmMsg.anyAtt="Any Attachment";
ZmMsg.anyCondition="Any condition";
ZmMsg.anyTime="Any Time";
ZmMsg.anywhere="Anywhere";
ZmMsg.aol="AOL";
ZmMsg.appExitWarning="Doing so will terminate Zimbra Collaboration Suite, and you will lose your unsaved changes";
ZmMsg.appUnknown='The "{0}" application is not available or disabled.';
ZmMsg.application="Application";
ZmMsg.applicationDocument="Application Document";
ZmMsg.applySignature="Apply signature:";
ZmMsg.appointment="Appointment";
ZmMsg.appointmentEditTitle="Edit Appointment";
ZmMsg.appointmentNewTitle="New Appointment";
ZmMsg.appointmentReminder="Appointment Reminder";
ZmMsg.appointments="Appointments";
ZmMsg.apptAttendees="Attendees for this appointment";
ZmMsg.apptBlobMissing="The selected appointment no longer exists. Please delete the entire appointment series.";
ZmMsg.apptCanceled="The following meeting has been cancelled:";
ZmMsg.apptCreated="Appointment Created";
ZmMsg.apptCreating="Creating Appointments";
ZmMsg.apptDateTime="{0,date,short}, {1,time,short}";
ZmMsg.apptDateTimeAllDay="{0,date,short}, all day";
ZmMsg.apptDetails="Appointment Details";
ZmMsg.apptExceptionNote="This is an exception to the series.";
ZmMsg.apptInstance="Instance";
ZmMsg.apptInstanceCanceled="A single instance of the following meeting has been cancelled:";
ZmMsg.apptInstanceModified="A single instance of the following meeting has been modified:";
ZmMsg.apptIsPrivate="This appointment is private and cannot be opened.";
ZmMsg.apptLocations="Location(s) for this appointment";
ZmMsg.apptModified="The following meeting has been modified:";
ZmMsg.apptModifiedStamp="[MODIFIED]";
ZmMsg.apptNew="The following is a new meeting request:";
ZmMsg.apptOutOfDate="The selected appointment has been changed or no longer exists.";
ZmMsg.apptPastDueReminderLabel="Show reminders for past-due meetings";
ZmMsg.apptRemindNDaysBefore="{0,number} {0,choice,0#days|1#day|2#days} before";
ZmMsg.apptRemindNHoursBefore="{0,number} {0,choice,0#hours|1#hour|2#hours} before";
ZmMsg.apptRemindNMinutesBefore="{0,number} {0,choice,0#minutes|1#minute|2#minutes} before";
ZmMsg.apptRemindNWeeksBefore="{0,number} {0,choice,0#weeks|1#week|2#weeks} before";
ZmMsg.apptRemindNever="Never";
ZmMsg.apptReminderLabel="Show reminders:";
ZmMsg.apptReminders="Appointment Reminder(s)";
ZmMsg.apptResources="Resources for this appointment";
ZmMsg.apptSendErrorAbort="Invite not sent; one or more addresses were not accepted.";
ZmMsg.apptSendErrorInvalidAddresses="Rejected addresses: {0}";
ZmMsg.apptSendErrorPartial="Invite not sent to the following rejected addresses: {0}";
ZmMsg.apptSendErrorUnsentAddresses="Invite NOT sent to: {0}";
ZmMsg.apptSeries="Series";
ZmMsg.apptTimeAllDay="{0,date}";
ZmMsg.apptTimeAllDayMulti="From {0,date} to {1,date}";
ZmMsg.apptTimeInstance="{0,date} from {0,time,short} to {1,time,short} {2}";
ZmMsg.apptTimeInstanceMulti="From {0,date} {0,time,short} to {1,date} {1,time,short} {2}";
ZmMsg.apptsImportedResult="{0,number} {0,choice,0#Appointments|1#Appointment|2#Appointments} Imported";
ZmMsg.archiveHint='<a href="javascript:;" onclick="{0}">Create a new folder here</a> for archiving messages,<br>or you can drag-n-drop an entire folder under "Local Folders".';
ZmMsg.arrange="Arrange";
ZmMsg.arrangedBy="Arranged by: {0}";
ZmMsg.asFlagged="As flagged";
ZmMsg.asRead="As read";
ZmMsg.ascending="Ascending";
ZmMsg.askCancel="The server appears to be slow to respond, and may be unavailable. Press the button to cancel your request.";
ZmMsg.askDeleteFilter='Delete filter "{0}"?';
ZmMsg.askDeleteTag='Delete tag "{0}"?';
ZmMsg.askLeaveCompose="Cancel compose? (If you cancel, your message will not be saved.)";
ZmMsg.askSaveAutosavedDraft="The message has been autosaved. Do you want to keep it?";
ZmMsg.askSaveDraft="Save current message as draft?";
ZmMsg.askToSave="Do you want to save changes?";
ZmMsg.at="@";
ZmMsg.atBottomOfMessage="Below included messages";
ZmMsg.atStartTime="at the start time";
ZmMsg.attach="Attach";
ZmMsg.attachClearUploadMessage="Clear or Upload attachments before changing tabs";
ZmMsg.attachFile="Attach File(s)";
ZmMsg.attachFileNo="Attach File {0}:";
ZmMsg.attachMultiMsgs="Forward Conversations";
ZmMsg.attachSelectMessage="Select at least one file to attach";
ZmMsg.attachingFiles="Attaching File(s)";
ZmMsg.attachingFilesDone="Finished Attaching File(s)";
ZmMsg.attachingFilesError="Error while Attaching File(s)";
ZmMsg.attachment="Attachment";
ZmMsg.attachmentConfirmRemove="Are you sure you want to permanently remove this attachment?";
ZmMsg.attachmentConfirmRemoveAll="Are you sure you want to permanently remove all attachments?";
ZmMsg.attachmentTooltip="Attach one or more files to the message";
ZmMsg.attachments="Attachments";
ZmMsg.attachmentsLabel="Attachments:";
ZmMsg.attendeeListChanged="You have made changes to the attendees list:";
ZmMsg.attendeeStatusLabel="Status:";
ZmMsg.attendees="Attendees";
ZmMsg.attendeesLabel="Attendees:";
ZmMsg.audio="Audio";
ZmMsg.audioVideo="Audio/Video";
ZmMsg.authChanged="Another user has logged in on this computer. You will need to login again to continue.";
ZmMsg.authFailure='Authentication failed with account "{0}".<br>Please go to Account Setup for more information.';
ZmMsg.authorLabel="Author:";
ZmMsg.auto="Auto";
ZmMsg.autoAddContacts='Add new contacts to "Emailed Contacts"';
ZmMsg.autoAddInvites="Automatically add received appointments to calendar";
ZmMsg.autoPick="AutoPick";
ZmMsg.autoSaveDrafts="Automatically save drafts of messages while you are composing";
ZmMsg.autocomplete="Autocomplete";
ZmMsg.autocompleteFailed="Autocomplete failed";
ZmMsg.autocompleteNotReady="Contacts Not Loaded, Yet";
ZmMsg.autocompleteShare="Always use this account during autocomplete";
ZmMsg.autocompleteSharedAddrBooks="Include addresses in shared address books";
ZmMsg.autocompleteWaiting="Autocompleting...";
ZmMsg.automaticSignature="Automatically on all messages";
ZmMsg.awayMessage="Away message";
ZmMsg.awayMessageEnabled="Send auto-reply message:";
ZmMsg.b="B";
ZmMsg.back="Back";
ZmMsg.badTargetFolder="You cannot move the folder to the selected destination folder.";
ZmMsg.badTargetFolderItems="You cannot move items to the selected destination folder.";
ZmMsg.badUsername="Your username must be a valid email address.";
ZmMsg.basic="Basic";
ZmMsg.basicSearch="Basic Search";
ZmMsg.bcc="Bcc";
ZmMsg.bccLabel="Bcc:";
ZmMsg.before="Before";
ZmMsg.beforeLc="before";
ZmMsg.below="Below";
ZmMsg.beta="[beta]";
ZmMsg.betaIM="[IM beta]";
ZmMsg.blackListLabel="Block messages from:";
ZmMsg.blue="Blue";
ZmMsg.body="Body";
ZmMsg.bodyTemplate="Body template";
ZmMsg.borderColor="Border Color";
ZmMsg.borderColorLabel="Border Color:";
ZmMsg.borderStyle="Border Style";

ZmMsg.borderStyleDashed="Dashed";
ZmMsg.borderStyleDotted="Dotted";
ZmMsg.borderStyleDouble="Double";
ZmMsg.borderStyleGroove="Groove";
ZmMsg.borderStyleInset="Inset";
ZmMsg.borderStyleLabel="Border Style:";
ZmMsg.borderStyleOutset="Outset";
ZmMsg.borderStyleRidge="Ridge";
ZmMsg.borderStyleSolid="Solid";
ZmMsg.borderThickness="Border Thickness:";
ZmMsg.borderWidth="Border Width:";
ZmMsg.bothNewPasswordsMustMatch="Both new passwords must match.";
ZmMsg.bottom="Bottom";
ZmMsg.briefcase="Briefcase";
ZmMsg.briefcaseCreateNewDocument="Create New Document";
ZmMsg.briefcaseCreateNewPresentation="Create New Presentation";
ZmMsg.briefcaseCreateNewSpreadsheet="Create New Spreadsheet";
ZmMsg.briefcaseFileProps="File Properties";
ZmMsg.briefcasePropModified="Modified";
ZmMsg.briefcasePropName="Name";
ZmMsg.briefcasePropSize="Size";
ZmMsg.briefcasePropTags="Tags";
ZmMsg.brokenHeart="broken heart";
ZmMsg.browse="Browse...";
ZmMsg.browserPlusDisabled="BrowserPlus is disabled";
ZmMsg.browserPlusMissing="This feature requires Yahoo! BrowserPlus. <a target='_blank' href='http://browserplus.yahoo.com/install'>Click here</a> to download and install it.";
ZmMsg.buddies="Buddies";
ZmMsg.buddy="Buddy";
ZmMsg.buddyInvitation="Buddy Invitation";
ZmMsg.buddyList="Buddy List";
ZmMsg.building="Building";
ZmMsg.bulletedList="Bulleted List";
ZmMsg.busy="Busy";
ZmMsg.byAttachment="By Attachment";
ZmMsg.byConversation="By Conversation";
ZmMsg.byFolder="By Folder";
ZmMsg.byMessage="By Message";
ZmMsg.bySender="By Sender";
ZmMsg.byTag="By Tag";
ZmMsg.byTime="By Time";
ZmMsg.byType="By Type";
ZmMsg.bytes="bytes";
ZmMsg.calAssistDefaultView="day, work week, week, month";
ZmMsg.calFeedInvalid="Appointments could not be retrieved. Make sure the following URL is a valid ICAL feed: {0}";
ZmMsg.calPerms="Permissions";
ZmMsg.calPermsNote="<b>Note:</b> Users provided below must be on this mail system ({0}). You may use the full email address, or just the username.";
ZmMsg.calRefreshTooltip="Refresh Calendar Views";
ZmMsg.calViewDay="Day View";
ZmMsg.calViewList="List View";
ZmMsg.calViewMonth="Month View";
ZmMsg.calViewSchedule="Schedule View";
ZmMsg.calViewWeek="7 Day Week View";
ZmMsg.calViewWorkWeek="Work Week View";
ZmMsg.calendar="Calendar";
ZmMsg.calendarAppointment="Calendar Appointment";
ZmMsg.calendarFirstDayOfWeek="First day of the week";
ZmMsg.calendarInitialApptVisibility="Default appointment visibility:";
ZmMsg.calendarInitialView="Initial calendar view";
ZmMsg.calendarInvite="Calendar Invite";
ZmMsg.calendarLabel="Calendar:";
ZmMsg.calendarStartWeekLabel="Start week on:";
ZmMsg.calendars="Calendars";
ZmMsg.call="Call";
ZmMsg.callForwardingDescription="Forward <b>all</b> calls to:";
ZmMsg.callForwardingError="The call forwarding number is invalid";
ZmMsg.callForwardingLabel="Call Forwarding:";
ZmMsg.callForwardingSameNumberError="The call forwarding number may not be the same as the phone number you are managing.";
ZmMsg.callManager="Call Manager";
ZmMsg.callManagerTooltip="Go to the Call Manager";
ZmMsg.callNumber="Call {0}";
ZmMsg.callSettings="Call Settings";
ZmMsg.caller="Caller";
ZmMsg.callingPartyCallerIdFormat="{0}&nbsp;&nbsp;{1}";
ZmMsg.callingPartyFormat="{0} ({1})&nbsp;&nbsp;{2}";
ZmMsg.calls="Calls";
ZmMsg.cancel="Cancel";
ZmMsg.cancelInstance="Cancel Instance";
ZmMsg.cancelSendMsgWarning="Important: Your message may not have been sent. You will be returned to the message. You can click Send again, and if the message was sent, the recipient will not receive a duplicate message. Note, if the message is modified before resending, the recipient may receive both messages.";
ZmMsg.cancelTooltip="Return to previous view";
ZmMsg.cancelled="Cancelled";
ZmMsg.capacity="Capacity";
ZmMsg.caption="Caption:";
ZmMsg.cardMessage="Card Message:";
ZmMsg.cardViewE="E";
ZmMsg.cardViewE2="E2";
ZmMsg.cardViewE3="E3";
ZmMsg.cardViewF="F";
ZmMsg.cardViewH="H";
ZmMsg.cardViewM="M";
ZmMsg.cardViewW="W";
ZmMsg.cardViewW2="W2";
ZmMsg.caseSensitive="Case Sensitive";
ZmMsg.cc="Cc";
ZmMsg.ccLabel="Cc:";
ZmMsg.cell="Cell";
ZmMsg.cellPadding="Padding Within Cells:";
ZmMsg.cellProperties="Cell Properties";
ZmMsg.cellRange="Cell Range";
ZmMsg.cellSpacing="Space Around Cells:";
ZmMsg.center="Center";
ZmMsg.changeEditorMode="Change format";
ZmMsg.changePassword="Change Password";
ZmMsg.changeTime="Change Time";
ZmMsg.chat="Chat";
ZmMsg.chatWith="Chat with {0}";
ZmMsg.chats="Chats";
ZmMsg.checkAgain="Check again";
ZmMsg.checkAll="Check All";
ZmMsg.checkAllFeed="Reload All Feeds";
ZmMsg.checkCalls="Get Calls";
ZmMsg.checkCallsTooltip="Get new calls";
ZmMsg.checkExternalMail="Get External Mail";
ZmMsg.checkFeed="Load Feed";
ZmMsg.checkForConflict="Check for Conflict";
ZmMsg.checkMail="Get Mail";
ZmMsg.checkMailPrefDefault="Run my default search";
ZmMsg.checkMailPrefLabel="When I click Get Mail:";
ZmMsg.checkMailPrefUpdate="Update my current view";
ZmMsg.checkRssTooltip="Check for new RSS feed";
ZmMsg.checkVoicemail="Get Voice Mail";
ZmMsg.checkVoicemailTooltip="Get new voice mail messages";
ZmMsg.chooseAddrBook="Choose Address Book";
ZmMsg.chooseAddrBookToExport="Choose an address book to export:";
ZmMsg.chooseAddrBookToImport="Choose an address book to import to:";
ZmMsg.chooseClient="Which version would you like to use?";
ZmMsg.chooseDate="Choose date";
ZmMsg.chooseFolder="Choose Folder";
ZmMsg.chooseFolderToFilter="Choose folders to apply filter to:";
ZmMsg.chooseIdentity="Choose an identity to send the mail";
ZmMsg.chooseSearchType="Choose which types of items are returned by your search";
ZmMsg.chooseSignature="Choose a signature to use";
ZmMsg.chooseTag="Choose Tag";
ZmMsg.chooserDescription="Type in the box to filter the list. Tab to change focus. Arrow keys can be used to navigate within the list.";
ZmMsg.clear="Clear";
ZmMsg.clearAdvSearch="Clear Advanced Search";
ZmMsg.clearAll="Clear All";
ZmMsg.clearText="Clear text";
ZmMsg.clickToAdd="Click to add";
ZmMsg.clickToDrawABorder="Click to draw a border:";
ZmMsg.clientAdvanced="Advanced (Ajax)";
ZmMsg.clientLoginNotice='<a target="_new" href="http://www.zimbra.com">Zimbra</a> :: the leader in open source messaging and collaboration :: <a target="_new" href="http://www.zimbra.com/blog">Zimbra Blog</a> <a target="_new" href="http://wiki.zimbra.com">Zimbra Wiki</a>';
ZmMsg.clientMobile="Mobile";
ZmMsg.clientPreferred="Default";
ZmMsg.clientStandard="Standard (HTML)";
ZmMsg.clientType="Client Type:";
ZmMsg.clientUnsupported="Note that your web browser or display does not fully support the Advanced version.  We strongly recommend that you use the Standard client.";
ZmMsg.clientWhatsThisMessage='<center style="margin-bottom:3px;"><b>Client Types:</b></center>\t<b>Advanced</b> offers the full set of Web collaboration features. This Web Client works best with newer browsers and faster Internet connections. <br><br><b>Standard</b> is recommended when Internet connections are slow, when using older browsers, or for easier accessibility. <br><br><b>Mobile</b> is recommended for mobile devices. <br><br>To set <b>Default</b> to be your preferred client type, change the login options in your Preferences, General tab after you log in.';
ZmMsg.close="Close";
ZmMsg.closeSearchBuilder="Close Advanced Search";
ZmMsg.closeTooltip="Return to previous view";
ZmMsg.clown="clown";
ZmMsg.code="Code";
ZmMsg.collapsedBorders="Collapsed Borders";
ZmMsg.colorLabel="Color:";
ZmMsg.columnBrowserView="Column Browser View";
ZmMsg.compBadAddresses="<p>The following addresses appear to be invalid: {0}</p><p>Send anyway?</p>";
ZmMsg.compBadAttendees="<p>The following attendees appear to be invalid: {0}</p><p>Save anyway?</p>";
ZmMsg.compSubjectMissing="No subject. Send anyway?";
ZmMsg.company="Company";
ZmMsg.complete="Complete";
ZmMsg.completed="Completed";
ZmMsg.compose="Compose";
ZmMsg.composeAsHTML="As HTML";
ZmMsg.composeAsText="As Text";
ZmMsg.composeDisabled="You currently have not configured any account for composing messages.";
ZmMsg.composeInNewWin="Always compose in new window";
ZmMsg.composeLabel="Compose:";
ZmMsg.composeMessages="Compose messages:";
ZmMsg.composeMoreOptions="Additional composing options can be set on the <a href='#Prefs.Accounts' onclick='skin.gotoPrefs(\"ACCOUNTS\");return false'>Accounts Page</a>";
ZmMsg.composeOptions="Change format";
ZmMsg.composeReplyEmail="When replying to an email:";
ZmMsg.composeReplyLabel="Reply / Reply All:";
ZmMsg.composeUsing="Default editor";
ZmMsg.composing="Composing";
ZmMsg.composingMessages="Composing Messages";
ZmMsg.confidential="Confidential";
ZmMsg.configureWithAdmin="Configure with Admin Console";
ZmMsg.confirm="Confirm";
ZmMsg.confirmCancelAppt="Are you sure you want to delete this appointment?";
ZmMsg.confirmCancelApptFutureInstances="cancel only the selected instance and everything after";
ZmMsg.confirmCancelApptInst="Are you sure you want to delete this meeting instance?";
ZmMsg.confirmCancelApptList="Are you sure you want to delete these appointments?";
ZmMsg.confirmCancelApptReply="Do you want to edit the appointment cancellation message?";
ZmMsg.confirmCancelApptSeries="Are you sure you want to delete this recurring appointment?";
ZmMsg.confirmCancelApptWholeSeries="cancel the entire series";
ZmMsg.confirmCancelTask="Are you sure you want to permanently delete the selected task(s)?";
ZmMsg.confirmDeleteCalendar='Are you sure you want to permanently delete the "{0}" calendar?';
ZmMsg.confirmDeleteContact="Are you sure you want to delete this contact?";
ZmMsg.confirmDeleteFolder='Are you sure you want to permanently delete the "{0}" folder?';
ZmMsg.confirmDeleteItem='Are you sure you want to delete "{0}"?';
ZmMsg.confirmDeleteItemList="Are you sure you want to delete the selected items?";
ZmMsg.confirmDeleteMissingFolder='The shared folder "{0}" is no longer accessible. Would you like to delete it?';
ZmMsg.confirmDeleteNotebook='Are you sure you want to permanently delete the "{0}" notebook?';
ZmMsg.confirmDeleteRule="Are you sure you want to delete this rule?";
ZmMsg.confirmDeleteRules="Are you sure you want to delete these rules?";
ZmMsg.confirmDeleteSavedSearch='Are you sure you want to delete the "{0}" saved search?';
ZmMsg.confirmDeleteTaskFolder='Are you sure you want to permanently delete the "{0}" task list?';
ZmMsg.confirmDisplayAddresss="<b>Recipients:</b>";
ZmMsg.confirmEmptyFolder='Are you sure you want to permanently delete everything within the "{0}" folder?';
ZmMsg.confirmEmptyTrashFolder="This action will delete all items in both the Email and Address Book trash folders.  Are you sure that you want to permanently delete everything in the trash folder?";
ZmMsg.confirmExistingContacts="<b>Recipients already in your contacts:</b>";
ZmMsg.confirmExitPreferences="Would you like to save your changes?";
ZmMsg.confirmExitPreferencesChangeAcct="Save your changes before switching accounts?";
ZmMsg.confirmFilterDetailsSave="Your filter rule is incomplete. Do you want to continue saving locally?";
ZmMsg.confirmModifyApptReply="Do you want to edit the appointment modification message?";
ZmMsg.confirmNewAddresses="<b>Recipients not in your address book:</b>";
ZmMsg.confirmNewAddressesCheck="(check the contacts you want to add)";
ZmMsg.confirmPasswordHasWhitespace="The confirm password field has whitespace. Please correct this, and resubmit your change request.";
ZmMsg.confirmRemovePopAccount='<b>Are you sure you want to remove the account "{0}"?</b><p><b>Note:</b> Account will not be removed until you save the preferences.';
ZmMsg.confirmSummary="Message Sent: {0}";
ZmMsg.confirmed="Confirmed";
ZmMsg.contact="Contact";
ZmMsg.contactCreated="Contact Created";
ZmMsg.contactList="List";
ZmMsg.contactPickerHint="Type recipient's name here.";
ZmMsg.contactSaved="Contact Saved";
ZmMsg.contacts="Contacts";
ZmMsg.contactsImportedResult="{0,number} {0,choice,0#Contacts|1#Contact|2#Contacts} Imported";
ZmMsg.contains="contains";
ZmMsg.content="Content";
ZmMsg.convCountTooltip="Total Messages in Conversation";
ZmMsg.convOrderAscending="Expand conversations from old to new";
ZmMsg.convOrderDescending="Expand conversations from new to old";
ZmMsg.conversation="Conversation";
ZmMsg.conversations="Conversations";
ZmMsg.convertCamelCase="Convert all CamelCase words to links";
ZmMsg.convertCamelCaseMsg="This will convert all CamelCase words into wiki links. Continue?";
ZmMsg.copy="Copy";
ZmMsg.count="Count";
ZmMsg.createAppt="Create Appointment";
ZmMsg.createNewAddrBook="Create New Address Book";
ZmMsg.createNewAppt="Create New Appointment";
ZmMsg.createNewBriefcaseItem="Create New Briefcase Folder";
ZmMsg.createNewCalendar="Create New Calendar";
ZmMsg.createNewContact="Create New Contact";
ZmMsg.createNewFolder="Create New Folder";
ZmMsg.createNewMsg="Create New Message";
ZmMsg.createNewNotebook="Create New Notebook";
ZmMsg.createNewPage="Create New Page";
ZmMsg.createNewRosterItem="Create New Buddy";
ZmMsg.createNewSection="Create New Notebook";
ZmMsg.createNewTag="Create New Tag";
ZmMsg.createNewTask="Create New Task";
ZmMsg.createNewTaskFolder="Create New Task List";
ZmMsg.createNewTaskHint="Click here to add a new Task";
ZmMsg.createSlideShow="Create Slide Show";
ZmMsg.createTask="Create Task";
ZmMsg.created="Created";
ZmMsg.createdOn="Created On";
ZmMsg.createdOnLabel="Created on:";
ZmMsg.creator="Creator";
ZmMsg.crying="crying";
ZmMsg.currency="Currency";
ZmMsg.custom="Custom";
ZmMsg.customRepeat="Custom Repeat";
ZmMsg.customize="Customize";
ZmMsg.customizeSettings="Customize settings";
ZmMsg.cut="Cut";
ZmMsg.cyan="Cyan";
ZmMsg.daily="Daily";
ZmMsg.dataSourceFailureDescription="Retrieving messages for the following external {0,choice,1#account has|2#accounts have} failed:";
ZmMsg.dataSourceFailureInstructions="<b>The failed accounts will not update until the problem(s) have been resolved. Click OK to go to account preferences.</b>";
ZmMsg.dataSourceFailureItem="<ul><li>{0} (failing since {1,date,short} {1,time,short})<br><font color=red><b>Error: {2}</b></font></li></ul>";
ZmMsg.dataSourceFailureItem_noDate="<ul><li>{0}<br><font color=red><b>Error: {1}</b></font></li></ul>";
ZmMsg.dataSourceFailureTitle="External Account Failure";
ZmMsg.dataSourceLoadFailure='Account "{0}" Failed';
ZmMsg.dataSourceLoadSuccess='Account "{0}" Loaded';
ZmMsg.dataSourceTestFailure="Failed";
ZmMsg.dataSourceTestSuccess="Success";
ZmMsg.dataTypesHint="Include all folders from the following applications:";
ZmMsg.dataTypesLabel="Data types:";
ZmMsg.date="Date";
ZmMsg.dateDue="Due Date";
ZmMsg.dateDueLabel="Due Date:";
ZmMsg.dateLabel="Date:";
ZmMsg.declineShare="Decline Share";
ZmMsg.declineShareConfirm="Are you sure you want to decline the {1} share from {0}?";
ZmMsg.declined="Declined";
ZmMsg.dedupeAll="Ignore message";
ZmMsg.dedupeMoveToInbox="Move the sent message to Inbox";
ZmMsg.dedupeNone="Place in Inbox";
ZmMsg.dedupeSecondCopy="Place in Inbox if I'm in To: or Cc:";
ZmMsg.def="Default";
ZmMsg.defLabel="Default:";
ZmMsg.defaultAccountName="DEFAULT";
ZmMsg.defaultCalendarTimezone="Default timezone for new appointments";
ZmMsg.defaultFontSettings="Default font settings (HTML compose)";
ZmMsg.defaultIdentity="Default Identity";
ZmMsg.defaultIdentityName="DEFAULT";
ZmMsg.defaultInviteReplyAcceptInstanceMessage="I will attend on {0,date,full}.\r\n\r\n";
ZmMsg.defaultInviteReplyAcceptMessage="Yes, I will attend.\r\n\r\n";
ZmMsg.defaultInviteReplyCancelInstanceMessage="I will attend on {0,date,full}.\r\n\r\n";
ZmMsg.defaultInviteReplyCancelMessage="Yes, I will attend.\r\n\r\n";
ZmMsg.defaultInviteReplyDeclineInstanceMessage="I won''t attend on {0,date,full}.\r\n\r\n";
ZmMsg.defaultInviteReplyDeclineMessage="No, I won''t attend.\r\n\r\n";
ZmMsg.defaultInviteReplyNewTimeMessage="I would like to propose a time change.\r\n\r\n";
ZmMsg.defaultInviteReplyResourceAcceptInstanceMessage="The resource has been scheduled on {0,date,full}.\r\n\r\n";
ZmMsg.defaultInviteReplyResourceAcceptMessage="The resource has been scheduled.\r\n\r\n";
ZmMsg.defaultInviteReplyResourceDeclineInstanceMessage="The resource could not be scheduled on {0,date,full}.\r\n\r\n";
ZmMsg.defaultInviteReplyResourceDeclineMessage="The resource could not be scheduled.\r\n\r\n";
ZmMsg.defaultInviteReplyResourceTentativeInstanceMessage="The resource might be scheduled on {0,date,full}.\r\n\r\n";
ZmMsg.defaultInviteReplyResourceTentativeMessage="The resource might be scheduled.\r\n\r\n";
ZmMsg.defaultInviteReplyTentativeInstanceMessage="I might attend on {0,date,full}.\r\n\r\n";
ZmMsg.defaultInviteReplyTentativeMessage="I might attend.\r\n\r\n";
ZmMsg.defaultPageName="Page";
ZmMsg.defaultPort="(Default is {0})";
ZmMsg.defaultViewLabel="Default View:";
ZmMsg.defaultsPageRestore="Page Reverted";
ZmMsg.defaultsRestored="Defaults Restored. Please Save Changes";
ZmMsg.deferred="Deferred";
ZmMsg.defualtTimezone="Default Timezone:";
ZmMsg.del="Delete";
ZmMsg.delAll="Delete All";
ZmMsg.delConv="Delete Conversation";
ZmMsg.delMsg="Delete Selected Message(s)";
ZmMsg.deleteApptInstance="Delete Instance";
ZmMsg.deleteApptListQuestion="Would you like to delete the instances or series of each appointment?";
ZmMsg.deleteApptQuestion="Would you like to delete only this instance or the series?";
ZmMsg.deleteApptSeries="Delete Series";
ZmMsg.deleteCell="Delete Cell";
ZmMsg.deleteColumn="Delete Column";
ZmMsg.deleteGroupError="The group cannot be deleted because it still contains buddies.";
ZmMsg.deleteInstance="Delete this instance";
ZmMsg.deleteInstances="Delete the instances";
ZmMsg.deleteInviteOnReply="Delete invite on reply";
ZmMsg.deleteInviteOnReplyLabel="After responding to an invitation:";
ZmMsg.deletePermanentTooltip="Delete selected item(s) permanently";
ZmMsg.deleteReadonly="You have selected one or more appointments which are read only. These appointments cannot be deleted.";
ZmMsg.deleteRecurringItem="Delete Recurring Item(s)";
ZmMsg.deleteRow="Delete Row";
ZmMsg.deleteSeries="Delete the series";
ZmMsg.deleteTable="Delete Table";
ZmMsg.deleteTooltip="Move selected item(s) to Trash";
ZmMsg.deny="Deny";
ZmMsg.descending="Descending";
ZmMsg.description="Description";
ZmMsg.destinationLabel="Destination:";
ZmMsg.detach="Open in a separate window";
ZmMsg.detachAnyway="You will have to reattach your file(s). Open in new window anyway?";
ZmMsg.detachTT="Launch in a separate window";
ZmMsg.detachTooltip="Compose in a separate window";
ZmMsg.detailView="Detail View";
ZmMsg.detailedCards="Card";
ZmMsg.details="Details";
ZmMsg.devil="devil";
ZmMsg.directionLabel="Direction:";
ZmMsg.discard="Discard";
ZmMsg.dismiss="Dismiss";
ZmMsg.dismissAll="Dismiss All";
ZmMsg.display="Display";
ZmMsg.displayAsHTML="As HTML (when possible)";
ZmMsg.displayAsText="As Text";
ZmMsg.displayCalendar="Choose how the calendar is displayed";
ZmMsg.displayContacts="Choose how contacts are displayed";
ZmMsg.displayContactsLabel="Display contacts per page:";
ZmMsg.displayExternalImages="Display Images";
ZmMsg.displayFormatLabel="Display format:";
ZmMsg.displayIM="Choose how IM chats are displayed";
ZmMsg.displayLabel="Display:";
ZmMsg.displayMail="Display Mail:";
ZmMsg.displayMailToolTip="Choose how mail is displayed";
ZmMsg.displayMessages="Displaying Messages";
ZmMsg.dndTooltip="Tip: drag and drop files from your desktop to add attachments to this message.";
ZmMsg.document="Document";
ZmMsg.documentName="Document Name";
ZmMsg.documents="Documents";
ZmMsg.domain="Domain";
ZmMsg.domainPart="domain part";
ZmMsg.domains="Domains";
ZmMsg.done="Done";
ZmMsg.dontInclude="Don't include original message";
ZmMsg.dontNotifyOrganizer="Don't notify organizer";
ZmMsg.dontNotifyOrganizerLabel="Don't Notify Organizer";
ZmMsg.downLabel="Down";
ZmMsg.download="Download";
ZmMsg.downloadAll="Download all attachments";
ZmMsg.downloadVoicemail="Download";
ZmMsg.downloadVoicemailTooltip="Download the selected voice mail message";
ZmMsg.draft="Draft";
ZmMsg.draftSaved="Draft Saved";
ZmMsg.draftSavedAuto="Draft Autosaved at {0}";
ZmMsg.drafts="Drafts";
ZmMsg.dueDate="Due Date";
ZmMsg.duplicateAttendee="Attendee {0} is already added";
ZmMsg.duration="Duration";
ZmMsg.durationDays="{0} - {1}";
ZmMsg.durationHours="{0} - {1}";
ZmMsg.durationLabel="Duration:";
ZmMsg.durationMultiDays="{0} {1} - {2} {3}";
ZmMsg.edit="Edit";
ZmMsg.editAll="Edit all";
ZmMsg.editApptQuestion="Would you like to open only this instance or the series?";
ZmMsg.editAsNew="Edit as New";
ZmMsg.editContact="Edit Contact";
ZmMsg.editFilter="Edit Filter";
ZmMsg.editImg="Edit Image";
ZmMsg.editNotebookChrome="Edit Template for Folder";
ZmMsg.editNotebookFooter="Edit Footer for Folder";
ZmMsg.editNotebookHeader="Edit Header for Folder";
ZmMsg.editNotebookIndex="Edit Table of Contents";
ZmMsg.editNotebookSideBar="Edit Side Bar for Folder";
ZmMsg.editNotebookStyles="Edit Styles for Folder";
ZmMsg.editProperties="Edit Properties";
ZmMsg.editPropertiesTooltip="Edit the selected item's properties";
ZmMsg.editReply="Edit Reply";
ZmMsg.editRosterItem="Edit Buddy";
ZmMsg.editTooltip="Edit the selected item";
ZmMsg.editValue="Edit Value";
ZmMsg.email="Email";
ZmMsg.emailAddr="Email Address";
ZmMsg.emailAddrHint="Email Address";
ZmMsg.emailAddrLabel="Email address:";
ZmMsg.emailAndIM="Email and Instant Messaging";
ZmMsg.emailDeleteSchedule="Scheduled Email Deletion";
ZmMsg.emailDeleteScheduleInboxRead="Inbox (Read):";
ZmMsg.emailDeleteScheduleInboxUnread="Inbox (Unread):";
ZmMsg.emailDeleteScheduleJunk="Junk:";
ZmMsg.emailDeleteScheduleSent="Sent Email:";
ZmMsg.emailDeleteScheduleTrash="Trash:";
ZmMsg.emailLabel="Email:";
ZmMsg.emailNotificationDescription="Send an email notification to:";
ZmMsg.emailNotificationError="The email notification address is invalid";
ZmMsg.emailNotificationLabel="Email Notification:";
ZmMsg.emailedContacts="Emailed Contacts";
ZmMsg.emoticons="Emoticons";
ZmMsg.empty="Empty";
ZmMsg.emptyCell="Empty Cell";
ZmMsg.emptyContact="Empty Contact Not Saved";
ZmMsg.emptyContactSave="Contact must have at least one field set.";
ZmMsg.emptyDocName="Document must have a file name.";
ZmMsg.emptyFolder="Empty Folder";
ZmMsg.emptyGroup="Empty Group Not Saved";
ZmMsg.emptyJunk="Empty Junk";
ZmMsg.emptyTrash="Empty Trash";
ZmMsg.enableAppleICalDelegation="Enable delegation for Apple iCal CalDAV client";
ZmMsg.end="End";
ZmMsg.endDate="End Date";
ZmMsg.endLabel="End:";
ZmMsg.endOn="End On:";
ZmMsg.endTime="End Time";
ZmMsg.endTimeLabel="End Time:";
ZmMsg.enrichedText="Enriched Text";
ZmMsg.enterAddrBelow="Or enter addresses below (comma separated)";
ZmMsg.enterAddresses="Enter addresses on separate lines";
ZmMsg.enterCommand="Enter Command:";
ZmMsg.enterEmailAddress="enter email address";
ZmMsg.enterEmailAddressOrDomain="enter email address or domain";
ZmMsg.enterNewPassword="Please enter a new password and re-enter it in the confirmation field.";
ZmMsg.enterUsername="Please enter your username and password.";
ZmMsg.entireAddress="entire address";
ZmMsg.error="error";
ZmMsg.errorAlreadyExists='A folder with name "{0}" already exists.';
ZmMsg.errorApplication="An unknown application error has occurred.";
ZmMsg.errorAttachment="Attachment error: {0}<br>Unable to upload attachment.";
ZmMsg.errorAttachmentRemove="Unable to remove attachment.";
ZmMsg.errorAttachmentTooBig="Attachment size is too big.";
ZmMsg.errorBrowserUnsupported="We have detected that you are running <b>{0} {1}</b>,which is an unsupported browser for the Zimbra Collaboration Suite. The Zimbra Collaboration Suite is supported on:<br /><ul><li>IE 6.0+</li><li>Mozilla 1.4+</li><li>Netscape 7.1+</li><li>Firefox 1.0+</li><li>Safari 1.3+ (BETA)</li></ul><br />";
ZmMsg.errorCalendarParse="There is an error in the syntax of your query. Correct the syntax and run your query again.";
ZmMsg.errorCalendarSettingAfterCreate="Calendar was created successfully but an error occurred setting properties.";
ZmMsg.errorCannotDeleteFolder="Only empty folders can be deleted for this account. Please delete all messages in this folder first.";
ZmMsg.errorCannotRename='Cannot rename folder "{0}".';
ZmMsg.errorCap="Error";
ZmMsg.errorContact="If the problem persists, please contact your System Administrator.";
ZmMsg.errorCookiesDisabled="Oops! It appears your browser does not allow cookies. You need to enable cookies in order to use the Zimbra Collaboration Suite.";
ZmMsg.errorCreateContact="Unable to Create Contact";
ZmMsg.errorCreateFile="Unable to Create File";
ZmMsg.errorCreateGroup="Unable to Create Group";
ZmMsg.errorCreateUrl="Unable to create URL from email.";
ZmMsg.errorDate="You have entered an invalid date.";
ZmMsg.errorDefaultIdentityName='The name "{0}" is not allowed.';
ZmMsg.errorDeletePopFolder='Unable to delete folder because it is associated to the POP account named "{1}".<p>In order to delete this folder, change the destination folder for the POP account or delete the POP account.';
ZmMsg.errorDuplicateName="Name is not unique.";
ZmMsg.errorEndByDate="End by date cannot be before start date.";
ZmMsg.errorFileAlreadyExists='A file with name "{0}" already exists.';
ZmMsg.errorGeneric="Could not complete operation.";
ZmMsg.errorGettingAppts="Error Getting Appointments";
ZmMsg.errorGroupName="Group Name is a required field.";
ZmMsg.errorHtmlSignatureTooLong="HTML Signature exceeds maximum length of {0,number} ( it includes the html tags ).";
ZmMsg.errorIdentityAlreadyExists='An identity with name "{0}" already exists.';
ZmMsg.errorImportNoContent="Import Error: file not found or file has no content.";
ZmMsg.errorImportStatus="Import Error {0}";
ZmMsg.errorImporting="An error occurred during the import";
ZmMsg.errorInvalidDates="Invalid dates (make sure end date/time is after start date/time).";
ZmMsg.errorInvalidEmail="Email format not understood.";
ZmMsg.errorInvalidEmail2="Invalid email format found.";
ZmMsg.errorInvalidFolder="Folder does not exist: {0}";
ZmMsg.errorInvalidName='Sorry, "{0}" is not a valid name. It contains at least one invalid character.';
ZmMsg.errorInvalidPageOrSectionName='A page or notebook with name "{0}" already exists.\nPlease select a different name.';
ZmMsg.errorInvalidPass="New password does not meet the system's rules (i.e. length). Contact your System Administrator for more information.";
ZmMsg.errorInvalidPhone="The phone number is invalid";
ZmMsg.errorInvalidPrefName="Invalid preference name.";
ZmMsg.errorInvalidPrefValue="Invalid preference value.";
ZmMsg.errorInvalidSize="The size value is invalid.";
ZmMsg.errorJavaScriptRequired='<font face=arial>JavaScript must be enabled in order for you to use the Zimbra advanced client. However, it seems JavaScript is either disabled or not supported by your browser. To use Zimbra, enable JavaScript by changing your browser options, then <a href="{0}">try again</a> or click <a href="{1}">here</a> to switch to the basic client which does not require JavaScript.<br><br><a target="_new" "href="http://www.zimbra.com">Zimbra</a> :: the leader in open source messaging and collaboration<br><a target="_new" href="http://www.zimbra.com/blog">Zimbra Blog</a> | <a target="_new" href="http://wiki.zimbra.com">Zimbra Wiki</a></font>';
ZmMsg.errorLabel="Error:";
ZmMsg.errorLessThanOne="Value must be greater than zero.";
ZmMsg.errorMaintenanceMode="This account is currently in maintenance mode.";
ZmMsg.errorMissingFwdAddr="A forwarding address is required if not saving local copy of messages.";
ZmMsg.errorMissingGroup="Group Name and Group Members are required fields.";
ZmMsg.errorMissingNotifyAddr="An address is required for notification.";
ZmMsg.errorMissingRequired="Required fields not specified.";
ZmMsg.errorMissingSubject="Subject is a required field.";
ZmMsg.errorModifyContact="Unable to Modify Contact";
ZmMsg.errorMoveAppt="Unable to move appointment.";
ZmMsg.errorMovePopFolder='Unable to move folder because it is associated to the POP account named "{1}".<p>In order to move this folder, change the destination folder for the POP account or delete the POP account.';
ZmMsg.errorMyCardDelete="My Card cannot be deleted.";
ZmMsg.errorMyCardMove="My Card cannot be moved.";
ZmMsg.errorNetwork="A network error has occurred.";
ZmMsg.errorNoActiveX="You need to enable ActiveX controls in order to use the Zimbra Collaboration Suite.";
ZmMsg.errorNoPhone="You need to enter a phone number to forward from.";
ZmMsg.errorNoSuchConv="No such conversation exists.";
ZmMsg.errorNoSuchFolder="No such folder exists.";
ZmMsg.errorNoSuchMsg="No such message exists.";
ZmMsg.errorNoSuchPart="No such message part exists.";
ZmMsg.errorNoSuchSavedSearch="No such saved search exists.";
ZmMsg.errorNoSuchTag="No such tag exists.";
ZmMsg.errorNoWeekdayChecked="No weekday(s) checked.";
ZmMsg.errorNotAllowedFile="Please attach allowed files ({0})";
ZmMsg.errorNotAuthenticated="User not authenticated.";
ZmMsg.errorNotImageFile="Please attach an image file (JPG, PNG, GIF)";
ZmMsg.errorPassChange="Your password is no longer valid. Please choose a new password.";
ZmMsg.errorPassChangeTooSoon="Password cannot be changed too soon.";
ZmMsg.errorPassLocked="Password locked. User not allowed to change password. Please contact your System Administrator.";
ZmMsg.errorPassRecentlyUsed="The password you submitted has recently been used. Please choose a different password.";
ZmMsg.errorPermission="Permission denied.";
ZmMsg.errorPermissionMsg="In order to view this, you must have appropriate permission.";
ZmMsg.errorPermissionRequired="In order for the recipient to view the links, they must<br> have permission to view the contents of the containing folder. <p> <b>Do you want to send the links anyway?</b>";
ZmMsg.errorPhoneNotUnique="The phone number is already in the list of numbers being forwarded.";
ZmMsg.errorPrivateVoicemail="The selected voice mail message is private, so it can not be attached to an email message.";
ZmMsg.errorQueryParse="Unable to parse the search query.";
ZmMsg.errorQuotaExceeded="Could not attach the file(s) because you have exceeded your mail quota.";
ZmMsg.errorReports="Error Reports";
ZmMsg.errorSaving="Cannot save. You have errors that must be corrected.";
ZmMsg.errorSavingAppt="Unable to save appointment.";
ZmMsg.errorSavingPageNameRequired="Cannot save page. You must enter a name for the new page.";
ZmMsg.errorSavingWithMessage="Cannot save. You have errors that must be corrected:<p>{0}";
ZmMsg.errorSearchNotExpanded="Not all results were returned (too many results were found). Please be more specific in your search criteria.";
ZmMsg.errorService="A network service error has occurred.";
ZmMsg.errorSignatureTooLong="Signature exceeds maximum length of {0,number}.";
ZmMsg.errorSubFolderNotAllowed="Subfolders under {0} are not allowed.";
ZmMsg.errorTooManyContacts="Contact could not be created because you have exceeded your contact quota.";
ZmMsg.errorTooManyIdentities="The identity could not be created because you have exceeded your identity quota.";
ZmMsg.errorTryAgain="Please correct any errors and retry.";
ZmMsg.errorUrlMissing="Please enter a valid URL.";
ZmMsg.errorWhiteBlackListExceeded="You have reached your maximum limit for this list.";
ZmMsg.event="Event";
ZmMsg.everyDay="Every Day";
ZmMsg.everyMonth="Every Month";
ZmMsg.everyWeek="Every Week";
ZmMsg.everyYear="Every Year";
ZmMsg.exactMatch="matches exactly";
ZmMsg.exampleEmailAddr="e.g. bob@example.com";
ZmMsg.exampleEmailName="e.g. Bob Smith";
ZmMsg.exampleFolderNames="folder name(s)";
ZmMsg.exampleMailServer="e.g. mail.example.com";
ZmMsg.excludeFromFreeBusy="Exclude this calendar when reporting free/busy times";
ZmMsg.execute="Execute";
ZmMsg.exists="exists";
ZmMsg.exitDocNotSaved="Document is not saved.";
ZmMsg.exitDocUnSavedChanges="Document may contain unsaved changes.";
ZmMsg.expand="Expand";
ZmMsg.expandAll="Expand All";
ZmMsg.expandCollapse="Expand / Collapse";
ZmMsg.explorerView="Explorer View";
ZmMsg.exportEmptyName="No Data to Export";
ZmMsg.exportErrorMissingFolder="Must specify folder to export.";
ZmMsg.exportErrorRootNotAllowed="Not allowed to export from root folder for this type.";
ZmMsg.exportFailed="Export failed.";
ZmMsg.exportFilenamePrefixAllFolders="All";
ZmMsg.exportIgnoreArchive="Ignore Local Folders";
ZmMsg.exportLabel="Export:";
ZmMsg.exportSkipMeta="Only export content files, exclude meta data";
ZmMsg.exportSuccess="Export succeeded.";
ZmMsg.exportToCSV="Export as .CSV File";
ZmMsg.exportToCSVHint='You can export your contacts in the standard "Comma-Separated Values" (.csv) format, then import them into another contact manager program. See documentation in the other program for help in importing.';
ZmMsg.exportToICS="Export as .ICS File";
ZmMsg.exportToICSHint="You can export your appointments in the standard iCalendar (.ics) format, then import them into another calendar program. See documentation in the other program for help in importing.";
ZmMsg.exportToTGZHint='All account data can be exported to a "Tar-GZipped" (.tgz) format which can be imported back into the system.';
ZmMsg.expression="Expression";
ZmMsg.externalAccess="Access from Other Mail Clients";
ZmMsg.externalAccessPop="POP access:";
ZmMsg.externalAccessPopCurrentValue="Current value is to only download mail that has arrived after {0,date,short} at {0,time,short}.";
ZmMsg.externalAccessPopDownloadAll="Allow all mail, including old mail, to be downloaded";
ZmMsg.externalAccessPopDownloadFromNow="Allow only mail from now to be downloaded";
ZmMsg.externalAccessPopNotSet="Current value is to download all mail, including old mail.";
ZmMsg.externalImages="External images are not displayed.";
ZmMsg.extra="Extra";
ZmMsg.fColorLabel="Color:";
ZmMsg.fFamilyLabel="Font:";
ZmMsg.fSizeLabel="Size:";
ZmMsg.favIconUrl="/img/logo/favicon.ico";
ZmMsg.fax="Fax";
ZmMsg.feedInvalid="Content could not be retrieved. Make sure the following URL is an RSS/ATOM feed: {0}";
ZmMsg.feedUnreachable="The following URL is not currently reachable: {0}";
ZmMsg.fetchingAlexaThumbnail="Fetching<br />Thumbnail...";
ZmMsg.fileAs="File As";
ZmMsg.fileAsCompanyAsSecondaryOnly="({0})";
ZmMsg.fileAsCompanyName="{1} ({0})";
ZmMsg.fileAsFirstLast="{0} {1}";
ZmMsg.fileAsLabel="File as:";
ZmMsg.fileAsLastFirst="{1}, {0}";
ZmMsg.fileAsNameAsSecondaryOnly="({0})";
ZmMsg.fileAsNameCompany="{0} ({1})";
ZmMsg.fileCreated="File Created";
ZmMsg.fileIntoFolder="File into folder";
ZmMsg.fileLabel="File:";
ZmMsg.filename="Filename:";
ZmMsg.files="Files";
ZmMsg.filter="Filter";
ZmMsg.filterActions="Perform the following actions:";
ZmMsg.filterCondition="If {0,choice,0#any|1#all} of the following conditions are met:";
ZmMsg.filterEdit="Edit Filter";
ZmMsg.filterError="There was a problem parsing your filter rules:";
ZmMsg.filterErrorAction='The action "{0}" is missing one or more values.';
ZmMsg.filterErrorCondition='The condition "{0}" is missing one or more values.';
ZmMsg.filterErrorIllegalCharacter='Filter values may not contain double-quote (") or backslash (\\)';
ZmMsg.filterErrorNameExists="There is already a filter by that name.";
ZmMsg.filterErrorNoName="The new filter needs a name.";
ZmMsg.filterForwardActionWarning='One or more of the selected filters contains an action to "Forward To Address". This action cannot be run on existing filters and will be ignored.';
ZmMsg.filterMoveDown="Move Down";
ZmMsg.filterMoveUp="Move Up";
ZmMsg.filterName="Filter Name";
ZmMsg.filterNameLabel="Filter Name:";
ZmMsg.filterRemove="Delete Filter";
ZmMsg.filterRuleApplied="Filter run complete. {0} message(s) were affected.";
ZmMsg.filterRuleChangesSavedImmediately="Note: Changes to filter rules are saved immediately.";
ZmMsg.filterRules="Filters";
ZmMsg.filterRun="Run Filter";
ZmMsg.filtersSaved="Filters Saved";
ZmMsg.find="Find";
ZmMsg.findAttendees="Find Attendees";
ZmMsg.findLabel="Find:";
ZmMsg.findLocations="Find Locations";
ZmMsg.findNReplaceTitle="Find and Replace";
ZmMsg.findResources="Find Resources";
ZmMsg.findShares="Find Shares";
ZmMsg.findWhatLabel="Find what:";
ZmMsg.finishLoading="Click here to finish loading this contact";
ZmMsg.firstNameHint="First Name";
ZmMsg.fixedCellWidth="Fixed Cell Width";
ZmMsg.flag="Flag";
ZmMsg.flagged="Flagged";
ZmMsg.flags="Flags";
ZmMsg.flashBrowser="Flash the browser title";
ZmMsg.flashMailAppTab="Highlight the Mail tab";
ZmMsg.floor="Floor";
ZmMsg.folder="Folder";
ZmMsg.folderLabel="Folder:";
ZmMsg.folderLc="folder";
ZmMsg.folderName="Folder name";
ZmMsg.folderNameReserved="That folder name is reserved. Please use another name.";
ZmMsg.folderNoLocation="You must select a location for the folder.";
ZmMsg.folderNotify="Folder Notifications";
ZmMsg.folderOrSearchNameExists="A folder or saved search with that name already exists. Please use another name.";
ZmMsg.folderProperties="Folder Properties";
ZmMsg.folderSharing="Sharing for this folder";
ZmMsg.folderSize="Folder Size";
ZmMsg.folderType="Folder type:";
ZmMsg.folderUnread="{0} ({1})";
ZmMsg.folders="Folders";
ZmMsg.foldersLabel="Folders:";
ZmMsg.foldersSearches="Folders and Saved Searches";
ZmMsg.foldersShown="{0} {1} shown";
ZmMsg.fontBackground="Font Background";
ZmMsg.fontBackgroundLabel="Font Background:";
ZmMsg.fontColor="Font Color";
ZmMsg.fontColorLabel="Font Color:";
ZmMsg.format="Format";
ZmMsg.formatAsHtml="Format As HTML";
ZmMsg.formatAsText="Format As Plain Text";
ZmMsg.formatHtmlSource="HTML Source";
ZmMsg.formatMediaWiki="MediaWiki Syntax";
ZmMsg.formatNotSupported="Format not supported";
ZmMsg.formatRichText="Rich Text";
ZmMsg.formatTWiki="TWiki Syntax";
ZmMsg.formatTooltip="Choose the format to compose in";
ZmMsg.forward="Forward";
ZmMsg.forwardAtt="Forward as Attachment";
ZmMsg.forwardByEmail="Forward by Email";
ZmMsg.forwardByEmailTooltip="Forward the selected voice mail message as an email attachment";
ZmMsg.forwardCopyTo="Forward a copy to:";
ZmMsg.forwardInclude="When forwarding:";
ZmMsg.forwardInline="Forward Inline";
ZmMsg.forwardInstance="Forward Instance";
ZmMsg.forwardInvitesTo="Forward my invites to:";
ZmMsg.forwardOptions="Change format, change how original is forwarded";
ZmMsg.forwardSeries="Forward Series";
ZmMsg.forwardTo="Forward to";
ZmMsg.forwardToAddress="Forward to Address";
ZmMsg.forwardTooltip="Forward the selected message";
ZmMsg.forwardTooltipConv="Forward the most recent message in the conversation";
ZmMsg.forwarded="Forwarded";
ZmMsg.forwardedMessage="Forwarded Message";
ZmMsg.forwardingEmail="When forwarding an email:";
ZmMsg.forwardingLabel="Forward:";
ZmMsg.fragment="Fragment";
ZmMsg.fragmentIsEmpty="(This message is empty)";
ZmMsg.free="Free";
ZmMsg.freeBusyAllowAll="Allow both internal and external users to see my free/busy information";
ZmMsg.freeBusyAllowLocal="Allow only internal users to see my free/busy information";
ZmMsg.freeBusyAllowNone="Don't let anyone see my free/busy information";
ZmMsg.freeBusyAllowSome="Allow only the following internal users to see my free/busy information:";
ZmMsg.freeBusyLabel="Free / Busy:";
ZmMsg.freeBusyLink="Mail Free & Busy link";
ZmMsg.freeBusyLinkTooltip="Email Free & Busy link";
ZmMsg.from="From";
ZmMsg.fromDetail='Choose the name that appears in the "From" field of email messages';
ZmMsg.fromLabel="From:";
ZmMsg.fullname="{0} {1} {2} {4}";
ZmMsg.fullnameMaiden="{0} {1} {2} ({3}) {4}";
ZmMsg.fullnameMaidenSuffix="{0} {1} {2} ({3}) {4}, {5}";
ZmMsg.fullnameSuffix="{0} {1} {2} {4}, {5}";
ZmMsg.fw="Fw";
ZmMsg.fwd="Fwd";
ZmMsg.galAutocomplete="Include addresses in the Global Address List";
ZmMsg.galAutocompleteFailure="GAL Auto-Complete Disabled";
ZmMsg.galAutocompleteSession="GAL autocomplete has been temporarily disabled. Check to re-enable.";
ZmMsg.galAutocompleteTimedOut="GAL Auto-Complete Timed Out";
ZmMsg.galAutocompleteWaiting="Waiting for GAL...";
ZmMsg.gb="GB";
ZmMsg.general="General";
ZmMsg.genericTextHint="Enter text";
ZmMsg.gifImage="GIF Image";
ZmMsg.global="Global";
ZmMsg.globalInbox="Global Inbox";
ZmMsg.gmail="Gmail";
ZmMsg.goBack="Go back one page";
ZmMsg.goForward="Go forward one page";
ZmMsg.goToCalendar="Go to Calendar";
ZmMsg.goToContacts="Go to Address Book";
ZmMsg.goToDate="Go to date";
ZmMsg.goToDocuments="Go to Documents";
ZmMsg.goToFolder="Go to {0}";
ZmMsg.goToHelp="Read online help documentation";
ZmMsg.goToMail="Go to Mail";
ZmMsg.goToOptions="View or edit your options";
ZmMsg.goToPortal="Go to Welcome page";
ZmMsg.goToTasks="Go to Tasks";
ZmMsg.goToUrl="Go to {0}";
ZmMsg.goToVoice="Go to Voice";
ZmMsg.gotoBriefcase="Go to Briefcase";
ZmMsg.grantFormText='To share a folder, choose the type and then press the "Share" button.';
ZmMsg.granteeGone='<p>At least one user or group with whom the following items have been shared no longer exists:</p><ul>{0}</ul><p>Press OK to revoke those shares, or Cancel to exit. If you cancel, you can then revoke each share individually by clicking the "Revoke" link.</p>';
ZmMsg.gray="Gray";
ZmMsg.green="Green";
ZmMsg.group="Contact Group";
ZmMsg.groupBadAddresses="<p>The following addresses appear to be invalid: {0}</p><br>";
ZmMsg.groupCreated="Group Created";
ZmMsg.groupHint="Enter addresses on separate lines";
ZmMsg.groupMailBy="Group mail by";
ZmMsg.groupMembers="Group Members:";
ZmMsg.groupMessagesLabel="Group mail by:";
ZmMsg.groupNameLabel="Group Name:";
ZmMsg.groupSaved="Group Saved";
ZmMsg.happy="happy";
ZmMsg.hardDeleteTooltip="Delete selected item(s)";
ZmMsg.hasAlias="has alias";
ZmMsg.header="Header";
ZmMsg.headerNamed="Header Named";
ZmMsg.heading1="Heading 1";
ZmMsg.heading2="Heading 2";
ZmMsg.heading3="Heading 3";
ZmMsg.heading4="Heading 4";
ZmMsg.heading5="Heading 5";
ZmMsg.heading6="Heading 6";
ZmMsg.heightLabel="Height:";
ZmMsg.help="Help";
ZmMsg.helpURI="/help/advanced/Zimbra_User_Help.htm";
ZmMsg.hideBCC="Hide BCC";
ZmMsg.hideDetails="Hide Details";
ZmMsg.high="High";
ZmMsg.highPriorityTooltip="This item has been marked as high priority";
ZmMsg.hiliteObjects="Highlight objects.";
ZmMsg.historyLabel="History";
ZmMsg.home="Home";
ZmMsg.horizRule="Horizontal Rule";
ZmMsg.htmlDocument="HTML";
ZmMsg.icon="Icon";
ZmMsg.ics="ICS";
ZmMsg.identities="Identities";
ZmMsg.identitiesAdd="Add a new identity";
ZmMsg.identitiesIntro="<b>Identities</b> group email settings together to allow you to quickly switch between different roles. For example, if you manage work and identity emails from the same account, you can have an identity for each that sets the signature, reply-to address, etc. When composing an email, a selector allows you to quickly switch between different identities.";
ZmMsg.identitiesTab="Mail Identities";
ZmMsg.identitiesUseDefault="Use same settings as Default Identity";
ZmMsg.identityAdvanced="Advanced";
ZmMsg.identityChangeWarning="Do you want to apply the changed settings? <br> <b>Any changes you have made to the message will be discarded.</b>";
ZmMsg.identityInfoContent="Use mail identities to quickly customize Mail for different situations -- for example:<UL style='margin-top: 5px; margin-bottom: 5px;'><LI>To respond to mail from home or work using different addresses</LI><LI>To manage different roles in your job</LI></UL>You can always change the current identity when composing a message.";
ZmMsg.identityInfoTitle="About Mail Identities:";
ZmMsg.identityNameError="The identity name is invalid";
ZmMsg.identityNameLabel="Identity name:";
ZmMsg.identityTextExternal="{0} <{2}>";
ZmMsg.identityTextPersona="{0} ({1} <{2}>)";
ZmMsg.identityTextPrimary="{0} ({1} <{2}>)";
ZmMsg.im="Instant Messaging";
ZmMsg.imAccounts="Accounts";
ZmMsg.imAddToBuddyList="Add {0} to your buddy list";
ZmMsg.imAddress="Buddy Address";
ZmMsg.imAddressLabel="Buddy Address:";
ZmMsg.imAnonymousInfo="Make users of the room anonymous";
ZmMsg.imAnonymousLabel="Anonymous:";
ZmMsg.imAppTitle="IM [Beta]";
ZmMsg.imArrivalLabel="When a message arrives:";
ZmMsg.imBlock="Block";
ZmMsg.imBootedYahoo="You have logged in to Yahoo! Messenger from another location.";
ZmMsg.imBuddyArchive="View Chat Archive";
ZmMsg.imChat="Chat";
ZmMsg.imChatMultiWindow="Multiple Windows";
ZmMsg.imChatTabbed="Tabbed Window";
ZmMsg.imChatTitle="{0} ({1})";
ZmMsg.imCloseAllChats="Close All Chats";
ZmMsg.imCloseChat="Close This Chat";
ZmMsg.imCloseOtherChats="Close Other Chats";
ZmMsg.imCloseWindow="Close window";
ZmMsg.imConference="Conference";
ZmMsg.imConferenceRooms="Conference Rooms";
ZmMsg.imConferences="Conferences";
ZmMsg.imConfirmDeleteRosterItem="Are you sure you want to delete {0}?";
ZmMsg.imCreateNewGroup="Create New Group";
ZmMsg.imCustomStatusMsg="New Status Message...";
ZmMsg.imEnteredChat="{0} has joined the conference";
ZmMsg.imErrorYahooBuddy="Unable to add buddy from Yahoo! service.";
ZmMsg.imErrorYahooBuddyLogin="Unable to add buddy from Yahoo! service because you are not logged in to Yahoo!. Do you want to log in to Yahoo!?";
ZmMsg.imGateway="IM Service";
ZmMsg.imGatewayDisconnectedHeader="You have been disconnected from Yahoo! Messenger because you signed in from another location.";
ZmMsg.imGatewayLabel="IM Service:";
ZmMsg.imGatewayLoggedInHeader="You are logged in to Yahoo! Messenger as <b>{0}</b>";
ZmMsg.imGatewayNotLoggedInHeader="You are not logged in to Yahoo! Messenger. Login with your Yahoo! ID and password below.";
ZmMsg.imGateway_aol="AOL";
ZmMsg.imGateway_msn="MSN";
ZmMsg.imGateway_xmpp="Zimbra (local)";
ZmMsg.imGateway_yahoo="Yahoo!";
ZmMsg.imGroupChat="Group Chat";
ZmMsg.imGroupExists="A group with that name exists. Please use another name.";
ZmMsg.imGroupItemTooltip="You have {1,number} {1,choice,0#buddies|1#buddy|2#buddies} in group {0}";
ZmMsg.imGroupName="Group Name";
ZmMsg.imGroups="Buddy Groups";
ZmMsg.imGroupsLabel="Buddy Groups:";
ZmMsg.imGwOfflineTooltip="You are not logged in to {0}. <BR/> Click here to log in.";
ZmMsg.imGwOnlineTooltip="You are logged in to {0} as {1}. <BR/> Click here to log out.";
ZmMsg.imIdle="Idle";
ZmMsg.imInvitation="Invitation";
ZmMsg.imInvitationFrom="Invitation from {0}";
ZmMsg.imInviteNotification="<b>{0}</b> invites you to a conference";
ZmMsg.imLabel="IM:";
ZmMsg.imLeftChat="{0} has left the conference";
ZmMsg.imLogOut="Log out";
ZmMsg.imLoginDifferent="Log in as a different user";
ZmMsg.imLoginLabel="Login:";
ZmMsg.imLogoutYahoo="Log out of Yahoo! Messenger";
ZmMsg.imMarkChatImportant='Mark this chat as "important"';
ZmMsg.imMinimize="Minimize chat window";
ZmMsg.imMinimizedLabel="[{0} chats]";
ZmMsg.imName="Buddy Name";
ZmMsg.imNameLabel="Buddy Name:";
ZmMsg.imNewBuddy='Add "{0}" to Buddy List...';
ZmMsg.imNewBuddyTooltip="Create a new buddy";
ZmMsg.imNewChat="New Chat";
ZmMsg.imNewChatName='Chat with "{0}"';
ZmMsg.imNewConferenceRoom="Create a new conference room";
ZmMsg.imNewConferenceRoomTitle="Create a new conference room";
ZmMsg.imNewGroup="New Group";
ZmMsg.imNewRosterItemToast='Added Buddy "{0}"';
ZmMsg.imNoBuddies='Your buddy list is empty. <span class="FakeAnchor" onclick="{0}">Click here</span> or on the <span class="ImgNewContact inlineIcon FakeAnchor" onclick="{0}">&nbsp;&nbsp;&nbsp;&nbsp;</span> icon to create a buddy.';
ZmMsg.imNotLoggedIn='You are not logged in to IM. <span class="FakeAnchor" onclick="{0}">Click here</span> to log in.';
ZmMsg.imNotLoggedInPrefs='You must be logged in to IM before you can update IM accounts. <span class="FakeAnchor" onclick="{0}">Click here</span> to log in.';
ZmMsg.imNotificationsLabel="Notifications:";
ZmMsg.imPasswordExpired="Your Yahoo! Messenger session has expired. Please log in again.";
ZmMsg.imPasswordFailed="The Yahoo! ID and password do not match.";
ZmMsg.imPasswordFailedTitle="Login failed.";
ZmMsg.imPasswordInfo="You may choose to password protect the room";
ZmMsg.imPasswordMismatch="The passwords don't match.";
ZmMsg.imPermanentInfo="Preserve the room after all users leave";
ZmMsg.imPermanentLabel="Permanent:";
ZmMsg.imPoweredBy="Instant Messaging Powered by";
ZmMsg.imPrefAutoLogin="Automatically log in to instant messaging services";
ZmMsg.imPrefIdleStatus="Set presence";
ZmMsg.imPrefIdleStatusLabel="Set presence:";
ZmMsg.imPrefIdleTimeout="Idle timeout";
ZmMsg.imPrefIdleTimeoutLabel="Idle timeout:";
ZmMsg.imPrefIdleTimeoutMinutes="{0,number} {0,choice,0#minutes|1#minute|2#minutes}";
ZmMsg.imPrefInstantNotify="Enable instant notifications";
ZmMsg.imPrefLogChats="Save chat history";
ZmMsg.imPrefNotifyPresence="Display presence notifications";
ZmMsg.imPrefNotifyStatus="Display notification when a buddy changes status";
ZmMsg.imPrefReportIdle="Report idle status";
ZmMsg.imPresence="Presence";
ZmMsg.imReconnect="reconnect";
ZmMsg.imReconnectCaps="Reconnect";

ZmMsg.imRememberYahoo="Remember this Yahoo! ID";
ZmMsg.imRemoveRosterItemToast='Removed Buddy "{0}"';
ZmMsg.imRestore="Restore chat window";
ZmMsg.imRoomNameLabel="Room Name:";
ZmMsg.imRoomNameRequired="The room name is empty. It's required.";
ZmMsg.imRoomPasswordFailed="The password is incorrect.";
ZmMsg.imRoomPasswordRequired="A password is required to enter the room";
ZmMsg.imRoomSettings="Settings for the room";
ZmMsg.imScreenName="Screen name:";
ZmMsg.imScreenNameHint="Screen Name";
ZmMsg.imScreenNameMsn="MSN Passport:";
ZmMsg.imScreenNameYahoo="Yahoo! ID:";
ZmMsg.imSortListByName="Sort by Name";
ZmMsg.imSortListByPresence="Sort by Status";
ZmMsg.imStatusAway="away";
ZmMsg.imStatusChat="available for chat";
ZmMsg.imStatusDND="do not disturb";
ZmMsg.imStatusExtAway="extended away";
ZmMsg.imStatusGatewayOffline="Log in to {0}";
ZmMsg.imStatusGatewayOnline="Logged into {0} as {1}";
ZmMsg.imStatusInvisible="invisible";
ZmMsg.imStatusOffline="offline";
ZmMsg.imStatusOnline="online";
ZmMsg.imStatusToast="{0} ({1})";
ZmMsg.imStatusUnknown="unknown";
ZmMsg.imSubscribeAuthRequest="<b>{0}</b> wants to add you as a buddy.  Accept?";
ZmMsg.imSubscribeAuthRequest_accept="Accept";
ZmMsg.imSubscribeAuthRequest_acceptAndAdd="Accept and add";
ZmMsg.imSubscribeAuthRequest_deny="Deny";
ZmMsg.imSubscribeAuthRequest_doNothing="Do nothing";
ZmMsg.imSubscribeAuthRequest_waiting="Waiting for {0} to accept your request";
ZmMsg.imSystem="system message";
ZmMsg.imToastGwOffline="You are now logged out of the {0} service";
ZmMsg.imToastGwOnline="You are logged into the {0} service";
ZmMsg.imToggleBlocked="Hide Blocked Buddies";
ZmMsg.imToggleOffline="Hide Offline Buddies";
ZmMsg.imUnblock="Unblock";
ZmMsg.imYahooLoadError="The Yahoo! Messenger SDK appears to be unable to load. This might be caused by a slow internet connection. If you are using a Flash blocker, you need to add this page to its whitelist, then reload the page.";
ZmMsg.imYahooLogin="Log in to Yahoo! Messenger";
ZmMsg.imYahooMissingFlash="The Adobe Flash Player is required to connect to Yahoo! Messenger. <a target='_blank' href='http://www.adobe.com/go/getflashplayer/'>Click here</a> to download and install it. You will need to restart your browser after the installation is complete.";
ZmMsg.image="Image";
ZmMsg.images="Images";
ZmMsg.imagesLabel="Images:";
ZmMsg.importAdditionalWarnings="<i>{0,number} more {0,choice,1#warning|2#warnings} reported.</i>";
ZmMsg.importAutoDetect="Auto-Detect";
ZmMsg.importChoose="Choose a document to import";
ZmMsg.importDocs="Import Document";
ZmMsg.importErrorMissingFile="Must specify an import file.";
ZmMsg.importErrorMissingFolder="Must specify destination folder.";
ZmMsg.importErrorRootNotAllowed="Not allowed to import to root folder for this type.";
ZmMsg.importErrorUpload="Error uploading file.";
ZmMsg.importExport="Import / Export";
ZmMsg.importExportTypeCSV="Contacts";
ZmMsg.importExportTypeICS="Calendar";
ZmMsg.importExportTypeTGZ="Account";
ZmMsg.importFailed="Import Failed";
ZmMsg.importFromCSV="Import .CSV File";
ZmMsg.importFromCSVHint='If you are using another contact manager program, you can import your existing contacts by saving them in "Comma-Separated Values" (.csv) format. See documentation in that program for help saving in this format.';
ZmMsg.importFromCSVLabel="CSV File:";
ZmMsg.importFromICS="Import .ICS File";
ZmMsg.importFromICSHint="If you are using another calendar program, you can import your existing appointments by saving them in iCalendar (.ics) format. See documentation in that program for help saving in this format.";
ZmMsg.importFromICSLabel="ICS File:";
ZmMsg.importFromTGZHint='You can import an account export file in a "Tar-GZipped" (.tgz) format.';
ZmMsg.importLabel="Import:";
ZmMsg.importResetWarning="If you reset the destination folder, all data and folders in the destination folder will be deleted.<p><b>If no destination folder is selected, this will delete <i>all</i> of the data and folders in your account.</b>";
ZmMsg.importStarted="Import started.";
ZmMsg.importSuccess="Import succeeded.";
ZmMsg.importSuccessWithWarnings="Import completed with {0,choice,1#a warning|2#warnings}:<p>{1}";
ZmMsg.importingContacts="Importing...";
ZmMsg.inContacts="In Personal Address Book";
ZmMsg.inGal="In Global Address List";
ZmMsg.inProgress="In Progress";
ZmMsg.inTime="in";
ZmMsg.inbox="Inbox";
ZmMsg.includeInBody="Include original message";
ZmMsg.includeJunk="Also search Junk";
ZmMsg.includeJunkFolder="Include Junk Folder in Searches";
ZmMsg.includeMenuAttachment="Include Original As Attachment";
ZmMsg.includeMenuNoPrefix="Include Original";
ZmMsg.includeMenuNone="Don't Include Original Message";
ZmMsg.includeMenuPrefix="Include Original With Prefix";
ZmMsg.includeMenuPrefixFull="Include Original With Headers And Prefix";
ZmMsg.includeMenuSmart="Include Last Message Only";
ZmMsg.includeOriginalAsAttach="Include original message as an attachment";
ZmMsg.includeOriginalInBody="Include original message in the body";
ZmMsg.includePrefix="Include original message with the prefix below";
ZmMsg.includePrefixFull="Include original message and headers with the prefix below";
ZmMsg.includeTrash="Also search Trash";
ZmMsg.includeTrashFolder="Include Trash Folder in Searches";
ZmMsg.indent="Increase Indent";
ZmMsg.indentTooltip="Indent";
ZmMsg.inheritPerms="Sub-folders inherit permissions";
ZmMsg.initialMailSearch="Initial mail search";
ZmMsg.initialMailSearchLabel="Default Mail Search:";
ZmMsg.initiallySearchGal="Initially search the Global Address List when using the contact picker";
ZmMsg.inlineAttachmentOption="Show images in message body";
ZmMsg.insertAttachment="Insert Files";
ZmMsg.insertCell="Insert Cell";
ZmMsg.insertColumn="Insert Column";
ZmMsg.insertColumnAfter="Insert Column After";
ZmMsg.insertColumnBefore="Insert Column Before";
ZmMsg.insertFunction="Insert Function";
ZmMsg.insertImage="Insert Images";
ZmMsg.insertImageUrl="Insert Image via url";
ZmMsg.insertLink="Insert Link";
ZmMsg.insertObject="Insert Object";
ZmMsg.insertRow="Insert Row";
ZmMsg.insertRowAbove="Insert Row Above";
ZmMsg.insertRowUnder="Insert Row Under";
ZmMsg.insertSpreadsheet="Insert Spreadsheet";
ZmMsg.insertTable="Insert Table";
ZmMsg.invalidAttendees="Invalid attendees found:";
ZmMsg.invalidAwayMessage="Away message must be at most {0} characters";
ZmMsg.invalidEmail="{0} is not a valid email address";
ZmMsg.invalidEmailAddress="Invalid email address";
ZmMsg.invalidInitialSearch="Initial search must be at most {0} characters";
ZmMsg.invalidPersonaName="Missing value for Persona Name";
ZmMsg.invalidPollingInterval="Polling interval must be at least {0} minutes";
ZmMsg.invalidPrefValue="A required value is either missing or invalid";
ZmMsg.invalidSignature="Signature must be at most {0} characters";
ZmMsg.inviteForwardingAddress="Address to forward invite to";
ZmMsg.inviteOutOfDate="The meeting invitation has been changed or no longer exists.";
ZmMsg.invitePermissionDenied="<p>You do not have permission to invite the following attendees to a meeting: <br> {0}</p><p>Save anyway?</p>";
ZmMsg.invitees="Invitees";
ZmMsg.invitesAllowAll="Allow both internal and external users to invite me to meetings";
ZmMsg.invitesAllowLocal="Allow only internal users to invite me to meetings";
ZmMsg.invitesAllowNone="Don't let anyone invite me to meetings";
ZmMsg.invitesAllowSome="Allow only the following internal users to invite me to meetings:";
ZmMsg.invitesLabel="Invites:";
ZmMsg.isAfter="is after";
ZmMsg.isBefore="is before";
ZmMsg.isIn="in";
ZmMsg.isOn="is on";
ZmMsg.isRecurringAppt='"{0}" is a recurring appointment.';
ZmMsg.isRecurringApptList="You have selected recurring appointments.";
ZmMsg.isRecurringTask='"{0}" is a recurring task.';
ZmMsg.isVisible="Is Visible";
ZmMsg.itemCopied="{0,number} {0,choice,1#Item|2#Items} Copied";
ZmMsg.itemCount="{0} {1}";
ZmMsg.itemCount1="{0} of {1} {2}";
ZmMsg.itemTemplate="Item template";
ZmMsg.itemType="Item Type";
ZmMsg.items="Items";
ZmMsg.itemsProcessed="{0} {1} processed";
ZmMsg.javaSource="Java Source Code";
ZmMsg.jpegImage="JPEG Image";
ZmMsg.junk="Junk";
ZmMsg.junkMailOptions="Junk Mail Options";
ZmMsg.junkTooltip="Mark selected item(s) as Junk";
ZmMsg.kb="KB";
ZmMsg.keepCopyInInbox="Keep a copy in my Inbox";
ZmMsg.keepInInbox="Keep in Inbox";
ZmMsg.key="Key";
ZmMsg.keyboardShortcuts="Zimbra Keyboard Shortcuts";
ZmMsg.kilobytes="kilobytes (KB)";
ZmMsg["label@"]="@";
ZmMsg.languageLabel="Language:";
ZmMsg.larger="is larger than";
ZmMsg.lastModified="Last Modified:";
ZmMsg.lastMonth="Last Month";
ZmMsg.lastSaved="Last Saved";
ZmMsg.lastSync="Last Sync";
ZmMsg.lastWeek="Last Week";
ZmMsg.lastYear="Last Year";
ZmMsg.layout="Layout";
ZmMsg.left="Left";
ZmMsg.leftClickComposeHint="Click to compose.";
ZmMsg.leftClickNewContactHint="Click to add to Address Book.";
ZmMsg.leftClickYahoohint="Click to visit user's Yahoo! profile";
ZmMsg.licenseExpired="Your server's license has expired.";
ZmMsg.lifetimeDurationDays="{0,number} {0,choice,0#Days|1#Day|2#Days}";
ZmMsg.lifetimeDurationNever="Never";
ZmMsg.linkProperties="Link Properties";
ZmMsg.linkTarget="Link target";
ZmMsg.linkTargetDesc="Enter the address of a web page:";
ZmMsg.linkText="Link text";
ZmMsg.linkTextDesc="Enter text visible for the link:";
ZmMsg.linkTitleLabel="Link title:";
ZmMsg.linkTitleOptionalLabel="Link title (optional):";
ZmMsg.linkTo="Link to";
ZmMsg.linkToNewIdentity="Link to new identity:";
ZmMsg.linkUrlLabel="Link URL:";
ZmMsg.list="List";
ZmMsg.loading="Loading...";
ZmMsg.localFolders="Local Folders";
ZmMsg.localPart="local part";
ZmMsg.localeChangeRestart="Would you like to reload the application now to show the new language? <br>(Otherwise, the new language will appear the next time you log in.)";
ZmMsg.location="Location";
ZmMsg.locationFormatCityCountry="{0}, {1}";
ZmMsg.locationFormatCityStateCountry="{0}, {1} {2}";
ZmMsg.locationLabel="Location:";
ZmMsg.logOff="Log Out";
ZmMsg.login="Log In";
ZmMsg.loginAsDiff="Log in as a different user";
ZmMsg.loginError="The username or password is incorrect. Verify that CAPS LOCK is not on, and then retype the current username and password";
ZmMsg.loginHeader="Acme Corporation";
ZmMsg.loginLabel="Login using:";
ZmMsg.loginOptions="Login Options";
ZmMsg.lostEmailNotification="The email notification will be turned off and the email address will be removed.";
ZmMsg.low="Low";
ZmMsg.lowPriorityTooltip="This item has been marked as low priority";
ZmMsg.mail="Mail";
ZmMsg.mailDeliveryDisabled="Don't keep a local copy of messages";
ZmMsg.mailFolder="Mail Folder";
ZmMsg.mailFolders="Mail Folders";
ZmMsg.mailForwardingAddress="Address to forward mail to";
ZmMsg.mailMessage="Mail Message";
ZmMsg.mailNotifAddress="Address for new mail notifications";
ZmMsg.mailNotifEnabled="Send a notification message to:";
ZmMsg.mailPriorityTooltip="Set the priority of the message";
ZmMsg.mailSendAddressFailure="Could not send message due to invalid address(es)";
ZmMsg.mailSendFailure="Could not send message: {0}";
ZmMsg.mailSignature="Mail Signature:";
ZmMsg.makeLabel="{0}:";
ZmMsg.mandatorySpellcheck="Mandatory spellcheck before sending a message.";
ZmMsg.manualSignature='Manually via the "Add Signature" button';
ZmMsg.mark="Mark";
ZmMsg.markAllHeard="Mark All as Heard";
ZmMsg.markAllRead="Mark All as Read";
ZmMsg.markAs="Mark as:";
ZmMsg.markAsHeard="Mark As Heard";
ZmMsg.markAsRead="Mark As Read";
ZmMsg.markAsUnheard="Mark As Unheard";
ZmMsg.markAsUnread="Mark As Unread";
ZmMsg.markedAsJunk="{0,number} {0,choice,1#Item|2#Items} Marked as Junk";
ZmMsg.markedAsNotJunk="{0,number} {0,choice,1#Item|2#Items} Marked as Not Junk";
ZmMsg.matches="matches wildcard condition";
ZmMsg.mb="MB";
ZmMsg.meeting="Meeting";
ZmMsg.meetingStatus="Meeting Status";
ZmMsg.meetingStatusUnknown="Could not find meeting details. Status for this slot is free.";
ZmMsg.megabytes="megabytes (MB)";
ZmMsg.mergeCell="Merge Cell";
ZmMsg.mergeCells="Merge Cells";
ZmMsg.message="Message";
ZmMsg.messageArrivalLabel="When a message arrives:";
ZmMsg.messageLabel="Message:";
ZmMsg.messagePreviewLabel="Message Preview:";
ZmMsg.messageReadLabel="When I read a message in the reading pane:";
ZmMsg.messageReadNone="Do not mark it read";
ZmMsg.messageReadNow="Mark it read immediately";
ZmMsg.messageReadTime='Mark it read after <input id="{0}" type="text" size=4 /> seconds';
ZmMsg.messageSent="Message Sent";
ZmMsg.messageStatus="Message Status";
ZmMsg.messageTooLarge="This message is too large to display properly.";
ZmMsg.messageTruncated="[Message truncated]";
ZmMsg.messages="Messages";
ZmMsg.messagesReceiving="Receiving Messages";
ZmMsg.messagesSentLabel="Sent Messages:";
ZmMsg.method="Method";
ZmMsg.middle="Middle";
ZmMsg.mine="Mine";
ZmMsg.minimumCapacity="Minimum Capacity";
ZmMsg.minutes="minutes";
ZmMsg.missedCalls="Missed Calls";
ZmMsg.missingAwayMessage="Empty away message";
ZmMsg.missingEmailAddress="Missing email address";
ZmMsg.missingPlugin="Sorry, a required plugin is missing.";
ZmMsg.missingPluginHelp="The QuickTime plugin is required to play voice mail messages. <a target='_blank' href='http://www.apple.com/quicktime/download/'>Click here</a> to download and install it. You will need to restart your browser after the installation is complete.";
ZmMsg.missingPluginHelpIE="A plugin is required to play voice mail messages. <a target='_blank' href='http://www.microsoft.com/windows/windowsmedia/download/'>Click here</a> to download and install Windows Media Player, or <a target='_blank' href='http://www.apple.com/quicktime/download/'>click here</a> to download and install the QuickTime plugin. You will need to restart your browser after the installation is complete.";
ZmMsg.misspelling="misspelling";
ZmMsg.misspellings="misspellings";
ZmMsg.misspellingsMessage="{0} misspellings found. Do you want to correct them?";
ZmMsg.misspellingsResult="{0,number} {0,choice,0#Misspellings|1#Misspelling|2#Misspellings}";
ZmMsg.mobile="Mobile";
ZmMsg.mobileDevice="Device";
ZmMsg.mobileDeviceChangesSavedImmediately="Note: Changes to mobile devices are saved immediately.";
ZmMsg.mobileDeviceId="Device ID";
ZmMsg.mobileDeviceWipeConfirm="Are you sure you want to wipe the contents of your lost or stolen device?";
ZmMsg.mobileDevices="Mobile Devices";
ZmMsg.mobileFirstReqReceived="Device registration";
ZmMsg.mobileLastPolicyUpdate="Last policy update";
ZmMsg.mobileProtocolVersion="Protocol version";
ZmMsg.mobileProvisionable="Provisionable";
ZmMsg.mobileRemoteWipeAck="Remote wipe confirmed";
ZmMsg.mobileRemoteWipeReq="Remote wipe requested";
ZmMsg.mobileResumeSync="Resume Sync";
ZmMsg.mobileStatusNeedProvision="Needs provisioning";
ZmMsg.mobileStatusOk="OK";
ZmMsg.mobileStatusSuspended="Suspended";
ZmMsg.mobileStatusWipe="Remote wipe requested";
ZmMsg.mobileStatusWipeComplete="Remote wipe completed";
ZmMsg.mobileSuspendSync="Suspend Sync";
ZmMsg.mobileUserAgent="User agent";
ZmMsg.mobileWipe="Wipe Device";
ZmMsg.mobileWipeCancel="Cancel Wipe";
ZmMsg.modified="Modified";
ZmMsg.modifiedField="[MODIFIED]";
ZmMsg.modifiedOnLabel="Modified on:";
ZmMsg.modifier="Modifier";
ZmMsg.modifyApptQuestion="Would you like to modify only this instance or the series?";
ZmMsg.modifyInstance="Modify this instance";
ZmMsg.modifyRecurringItem="Modify Recurring Item";
ZmMsg.modifySearch="Modify Search";
ZmMsg.modifySeries="Modify the series";
ZmMsg.month="Month";
ZmMsg.monthly="Monthly";
ZmMsg.months="Months";
ZmMsg.more="More...";
ZmMsg.moreDetails="More Details...";
ZmMsg.moreVoiceControlsLabel="Need more controls over your voice service?";
ZmMsg.moreVoiceControlsText="Visit the Digital Voice Center";
ZmMsg.mountAddrBook="Link to Shared Address Book";
ZmMsg.mountBriefcase="Link to Shared Briefcase";
ZmMsg.mountCalendar="Link to Shared Calendar";
ZmMsg.mountFolder="Link to Shared Folder";
ZmMsg.mountInstructions1="To link to an item that has been shared with you, enter the owner's email address and the location of the folder in their mailbox (e.g. Work/Projects):";
ZmMsg.mountInstructions2="Properties of your new link:";
ZmMsg.mountNotebook="Link to Shared Notebook";
ZmMsg.mountSection="Link to Shared Notebook";
ZmMsg.mountTaskFolder="Link to Shared Task List";
ZmMsg.mountedSharesTitle="Folders shared with me that I have accepted";
ZmMsg.move="Move";
ZmMsg.moveAddrBook='Move Address Book "{0}"';
ZmMsg.moveAppt="Move Appointment";
ZmMsg.moveAppts="Move Appointments";
ZmMsg.moveConversation="Move Conversation";
ZmMsg.moveConversations="Move Conversations";
ZmMsg.moveFolder='Move Folder "{0}"';
ZmMsg.moveItem="Move Item";
ZmMsg.moveItems="Move Items";
ZmMsg.moveMessage="Move Message";
ZmMsg.moveMessages="Move Messages";
ZmMsg.moveReadonly="You have selected one or more appointments which are read only. These appointments cannot be moved.";
ZmMsg.moveSearch='Move Saved Search "{0}"';
ZmMsg.moveTask="Move Task";
ZmMsg.moveTasks="Move Tasks";
ZmMsg.moveToVoiceMail="Move back to Voice Mail folder";
ZmMsg.moveTooltip="Move selected item(s)";
ZmMsg.mp3Audio="MP3 Audio";
ZmMsg.msDownload="Microsoft DLL";
ZmMsg.msExcelDocument="Microsoft Excel";
ZmMsg.msExchange="Microsoft Exchange";
ZmMsg.msLive="Microsoft Live";
ZmMsg.msPPTDocument="Microsoft PowerPoint";
ZmMsg.msProjectDocument="Microsoft Project";
ZmMsg.msVisioDocument="Microsoft Visio";
ZmMsg.msWMV="Windows Media Video";
ZmMsg.msWinmailDat="Microsoft Outlook (TNEF)";
ZmMsg.msWordDocument="Microsoft Word";
ZmMsg.msn="MSN";
ZmMsg.multipartAlternative="Multipart Alternative";
ZmMsg.multipartMixed="Multipart Mixed";
ZmMsg.multipleAttachmentsTooltip="{0} attachments";
ZmMsg.myCard="My Card";
ZmMsg.myCardHome="Home";
ZmMsg.myCardWork="Work";
ZmMsg.myComputer="My Computer";
ZmMsg.myContacts="My Contacts";
ZmMsg.name="Name";
ZmMsg.nameEmpty="You must specify a value for the name.";
ZmMsg.nameHint="Name (John Smith)";
ZmMsg.nameLabel="Name:";
ZmMsg.nameTooLong="The name must be at most {0} characters long";
ZmMsg.navText1="{0} - {1}";
ZmMsg.navText2="{0} - {1} of {2}";
ZmMsg.needsAction="Needs Action";
ZmMsg.neverShow="never show";
ZmMsg.neverSynced="This account has not been synced. Click Send/Receive to start sync.";
ZmMsg.newAddrBook="New Address Book";
ZmMsg.newAddrBookTooltip="Create a new address book";
ZmMsg.newAllDayAppt="New All Day Appointment";
ZmMsg.newAllDayApptTooltip="Create a new all day calendar appointment";
ZmMsg.newAppt="New Appointment";
ZmMsg.newApptTooltip="Create a new calendar appointment";
ZmMsg.newBriefcase="New Briefcase";
ZmMsg.newBriefcaseTooltip="Create a new briefcase";
ZmMsg.newCalendar="New Calendar";
ZmMsg.newCalendarTooltip="Create a new calendar";
ZmMsg.newContact="New Contact";
ZmMsg.newContactTooltip="Create a new contact";
ZmMsg.newDocument="New Document";
ZmMsg.newEmail="New Email";
ZmMsg.newExternalAccount="New External Account {0,number}";
ZmMsg.newFile="New File";
ZmMsg.newFilter="New Filter";
ZmMsg.newFolder="New Folder";
ZmMsg.newFolderParent="Select where to place the new folder:";
ZmMsg.newFolderTooltip="Create a new folder";
ZmMsg.newGroup="New Contact Group";
ZmMsg.newGroupTooltip="Create a new group";
ZmMsg.newIM="New IM";
ZmMsg.newIdentity="New Identity {0}";
ZmMsg.newInstantMessage="New Instant Message";
ZmMsg.newMail="New mail from: {0}";
ZmMsg.newMailWithAccount="New mail from: {0} ({1})";
ZmMsg.newMessage="New message";
ZmMsg.newMessageFormat="New message format:";
ZmMsg.newMessageTooltip="Compose a new message";
ZmMsg.newName="New name";
ZmMsg.newNotebook="New Notebook";
ZmMsg.newNotebookTooltip="Create a new notebook";
ZmMsg.newPage="New Page";
ZmMsg.newPassword="New Password";
ZmMsg.newPersona="New Persona {0,number}";
ZmMsg.newPopAccountName="New Account {0}";
ZmMsg.newPresentation="New Presentation";
ZmMsg.newPresentationBeta="New Presentation [beta]";
ZmMsg.newRosterItem="New Buddy";
ZmMsg.newSearchParent="Select where to place the new saved search";
ZmMsg.newSection="New Notebook";
ZmMsg.newSpreadSheet="New Spreadsheet";
ZmMsg.newSpreadSheetBeta="New Spreadsheet [beta]";
ZmMsg.newStatusMessage="New Status Message";
ZmMsg.newTag="New Tag";
ZmMsg.newTagName="New Tag Name";
ZmMsg.newTagTooltip="Create a new tag";
ZmMsg.newTask="New Task";
ZmMsg.newTaskFolder="New Task List";
ZmMsg.newTaskFolderTooltip="Create a new task list";
ZmMsg.newTaskTooltip="Create a new task";
ZmMsg.newWinComposeExit="You can press Cancel to save as draft.";
ZmMsg.newWindow="New Window";
ZmMsg.next="Next";
ZmMsg.nextConversation="Next Conversation";
ZmMsg.nextDay="Next Day";
ZmMsg.nextMessage="Next Message";
ZmMsg.nextMonth="Next Month";
ZmMsg.nextPage="Next Page";
ZmMsg.nextWeek="Next Week";
ZmMsg.nextWorkWeek="Next Work Week";
ZmMsg.noAddresses="There must be at least one address in the To:, Cc:, or Bcc: fields";
ZmMsg.noAppts="No Appointments";
ZmMsg.noAtt="No Attachments";
ZmMsg.noCallResults="No results found.";
ZmMsg.noFreeSlotFound="No free time slots found with on selected week range";
ZmMsg.noItems="No {0}";
ZmMsg.noMisspellingsFound="Spelling Correct";
ZmMsg.noName="<No Name>";
ZmMsg.noShareDetailsFound="No share details found";
ZmMsg.noSubject="<No Subject>";
ZmMsg.noSuggestions="No Suggestions";
ZmMsg.noTargetFolder="You must select a folder";
ZmMsg.noVoiceMail="Voice mail is not available.";
ZmMsg.noWhere="<No Where>";
ZmMsg.none="None";
ZmMsg.normal="Normal";
ZmMsg.notAfter="not after";
ZmMsg.notAvailable="Not Available";
ZmMsg.notBefore="not before";
ZmMsg.notContain="does not contain";
ZmMsg.notExactMatch="does not match exactly";
ZmMsg.notExist="does not exist";
ZmMsg.notIn="not in";
ZmMsg.notIs="is not";
ZmMsg.notJunk="Not Junk";
ZmMsg.notJunkTooltip="Mark selected item(s) as not Junk";
ZmMsg.notMatch="does not match wildcard condition";
ZmMsg.notOver="not over";
ZmMsg.notSet="Not Set";
ZmMsg.notStarted="Not Started";
ZmMsg.notSyncing='This folder is currently not syncing.<br><a href="javascript:;" onclick="{0}">Click here to sync this folder</a>.';
ZmMsg.notUnder="not under";
ZmMsg.noteForward="Note: Forwarded message attached";
ZmMsg.noteLabel="Note:";
ZmMsg.notebook="Notebook";
ZmMsg.notebookFileView="File List";
ZmMsg.notebookLabel="Notebook:";
ZmMsg.notebookPageLabel="A notebook page:";
ZmMsg.notebookPageView="Page Browser";
ZmMsg.notebookPersonalName="Notebook";
ZmMsg.notebooks="Notebooks";
ZmMsg.notes="Notes";
ZmMsg.notesLabel="Notes:";
ZmMsg.nothingToTag="The items you have selected cannot be tagged.";
ZmMsg.notify="Notify";
ZmMsg.notifyOrganizer="Notify organizer";
ZmMsg.notifyOrganizerLabel="Notify Organizer";
ZmMsg.number="Number";
ZmMsg.numberOfCols="Number of Columns:";
ZmMsg.numberOfMinutes="Number of minutes before an appointment to show reminder";
ZmMsg.numberOfRows="Number of Rows:";
ZmMsg.numberedList="Numbered List";
ZmMsg.object="Object";
ZmMsg.objects="Objects";
ZmMsg.objectsNotDisplayed="Objects are not highlighted due to message size.";
ZmMsg.off="Off";
ZmMsg.offlineAllowMailTo="Use Zimbra Desktop as default mail application";
ZmMsg.offlineQuota="Mailbox size: {0}";
ZmMsg.ok="OK";
ZmMsg.oldPasswordIsIncorrect="The old password you submitted is incorrect.";
ZmMsg.on="On";
ZmMsg.onBehalfOf="On Behalf Of";
ZmMsg.onBehalfOfLabel="On Behalf Of:";
ZmMsg.onLabel="On:";
ZmMsg.onlyWholeNumbersError="Only whole numbers are accepted";
ZmMsg.openAppointment="Open Appointment";
ZmMsg.openApptInstance="Open Instance";
ZmMsg.openApptSeries="Open Series";
ZmMsg.openCalendar="Open Calendar";
ZmMsg.openFile="Open";
ZmMsg.openFileTooltip="Open this file";
ZmMsg.openInstance="Open this instance";
ZmMsg.openMailNewWin="Double-click opens message in new window";
ZmMsg.openRecurringItem="Open Recurring Item";
ZmMsg.openSearchBuilder="Open Advanced Search";
ZmMsg.openSeries="Open the series";
ZmMsg.options="Options";
ZmMsg.optionsSaved="Preferences Saved";
ZmMsg.or="or";
ZmMsg.orPickAStyleBelow="Or pick a style below:";
ZmMsg.orange="Orange";
ZmMsg.orgChange='This will change the organizer to "{0}" and attendees will be notified. Continue?';
ZmMsg.organizer="Organizer";
ZmMsg.organizerLabel="Organizer:";
ZmMsg.organizerNotification="Do you want to notify organizer?";

ZmMsg.origMsg="Original Message";
ZmMsg.originalFormat="Format of the original message";
ZmMsg.other="Other";
ZmMsg.otherLabel="Other:";
ZmMsg.outOfOffice="Out of Office";
ZmMsg.outRpcCache="Out of RPC cache";
ZmMsg.outbox="Outbox";
ZmMsg.outdent="Decrease Indent";
ZmMsg["outlook-2000-csv"]="Outlook 2000 Contacts";
ZmMsg["outlook-2003-csv"]="Outlook 2003 Contacts";
ZmMsg["outlook-unknown-csv"]="Outlook Contacts";
ZmMsg.over="over";
ZmMsg.owner="Owner";
ZmMsg.ownerLabel="Owner:";
ZmMsg.pComplete="% Complete";
ZmMsg.paddingHorizontal="Horizontal Padding:";
ZmMsg.paddingVertical="Vertical Padding:";
ZmMsg.page="Page";
ZmMsg.pageLabel="Page:";
ZmMsg.pageNameLabel="Page Name:";
ZmMsg.pageNotFound='The page at the path "{0}" could not be found.';
ZmMsg.pageSaved="Page Saved";
ZmMsg.pages="Pages";
ZmMsg.parentFolderLabel="Parent:";
ZmMsg.participantStatus="Participant Status";
ZmMsg.party="party";
ZmMsg.password="Password";
ZmMsg.passwordConfirmLabel="Confirm Password:";
ZmMsg.passwordLabel="Password:";
ZmMsg.paste="Paste";
ZmMsg.path="Path";
ZmMsg.pathLabel="Path:";
ZmMsg.pattern="Pattern";
ZmMsg.pause="Pause";
ZmMsg.pendingSharesTitle="Folders that have been shared with me but not yet accepted";
ZmMsg.percent="Percent";
ZmMsg.percentComplete="Percent Complete";
ZmMsg.permissions="Permissions:";
ZmMsg.personaSettings="Persona Settings";
ZmMsg.personaWhenInFolder="Replying to or forwarding messages in folder(s):";
ZmMsg.personaWhenSentTo="When replying or forwarding messages sent to:";
ZmMsg.personal="Personal";
ZmMsg.personas="Personas";
ZmMsg.phone="Phone";
ZmMsg.phone2="Phone 2";
ZmMsg.phoneLabel="Phone:";
ZmMsg.phoneLabelAssistant="Assistant";
ZmMsg.phoneLabelCallback="Callback";
ZmMsg.phoneLabelCar="Car";
ZmMsg.phoneLabelCompany="Company";
ZmMsg.phoneLabelHome="Home";
ZmMsg.phoneLabelHome2="Home 2";
ZmMsg.phoneLabelHomeAlternate="Home Alternate";
ZmMsg.phoneLabelHomeFax="Home Fax";
ZmMsg.phoneLabelMobile="Mobile";
ZmMsg.phoneLabelOther="Other";
ZmMsg.phoneLabelOtherFax="Other Fax";
ZmMsg.phoneLabelPager="Pager";
ZmMsg.phoneLabelWork="Work";
ZmMsg.phoneLabelWork2="Work 2";
ZmMsg.phoneLabelWorkFax="Work Fax";
ZmMsg.phoneNumberHint="Phone Number";
ZmMsg.phoneNumbers="Phone Numbers";
ZmMsg.pickADate="Pick a date";
ZmMsg.pickATag="Pick a tag";
ZmMsg.pink="Pink";
ZmMsg.pixels="Pixels";
ZmMsg.placeSignature="Place the signature:";
ZmMsg.placed="Placed";
ZmMsg.placedCalls="Placed Calls";
ZmMsg.placementLabel="Placement:";
ZmMsg.plainText="Plain Text";
ZmMsg.play="Play";
ZmMsg.playSound="Play a sound (requires QuickTime or Windows Media plugin)";
ZmMsg.pleaseWaitHilitingObjects="Please wait, depending on the message size this might take a while.";
ZmMsg.pngImage="PNG Image";
ZmMsg.pollEveryNMinutes="{0,number} {0,choice,0#minutes|1#minute|2#minutes}";
ZmMsg.pollNever="Never";
ZmMsg.pollingInterval="Polling interval (minutes after which to check for new mail)";
ZmMsg.pollingIntervalLabel="Check for new mail every:";
ZmMsg.popAccountCreateNewIdentity="Create new identity for this account";
ZmMsg.popAccountDownloadLabel="When downloading messages:";
ZmMsg.popAccountDownloadLeave="Leave a copy on the POP server";
ZmMsg.popAccountDownloadRemove="Remove from the POP server";
ZmMsg.popAccountFolderLabel="Place messages in folder:";
ZmMsg.popAccountFolderSelect="Select folder for POP messages:";
ZmMsg.popAccountIdentityHelp="Create a new mail identity if you wish to respond to mail received from this account using the name of the account rather than your default Zimbra name.";
ZmMsg.popAccountLinkForAddr="For messages sent to this email address";
ZmMsg.popAccountLinkForFolder="For messages read or replied in this folder";
ZmMsg.popAccountLinkLabel="Link identity:";
ZmMsg.popAccountNameLabel="Account name:";
ZmMsg.popAccountServerLabel="Incoming mail server:";
ZmMsg.popAccountSettings="POP Account Settings";
ZmMsg.popAccountTest="Test Account Settings";
ZmMsg.popAccountTestFailure="Failed";
ZmMsg.popAccountTestFailureMsg='Connection to POP account "{0}" failed. See details for error message from server.';
ZmMsg.popAccountTestInProgress="Testing...";
ZmMsg.popAccountTestNote="If you continue to save, account will be marked inactive.<br>Press Cancel to return to editing accounts.";
ZmMsg.popAccountTestSuccess="Success";
ZmMsg.popAccountTestSuccessMsg='Connection to POP account "{0}" succeeded.';
ZmMsg.popAccountTestTitle="Test POP Accounts";
ZmMsg.popAccountUseSSL="Use SSL to connect securely";
ZmMsg.popAccounts="POP Accounts";
ZmMsg.popAccountsInfo="You can retrieve email from your POP email accounts by setting up POP accounts here.  To start: <ol><li> Click <b>Add</b> in the bottom of this page.<li> Enter the settings for your POP account.<li> Select a folder in which to place your messages.<li> Optionally, create a mail identity to customize replies to the POP account messages.</ol><p><strong>Note:</strong> To retrieve mail, click the <b>Get POP Mail</b> button in the folder from step 3.";
ZmMsg.popAccountsInfoHeader="About POP Accounts";
ZmMsg.popupBlocker="Oops! Browser is Blocking Popups";
ZmMsg.portLabel="Port:";
ZmMsg.portal="Home";
ZmMsg.positiveNumberError="This must be a positive number.";
ZmMsg.preferenceResetButtonLabel="Reset";
ZmMsg.preferences="Preferences";
ZmMsg.prefix="Prefix each included line with";
ZmMsg.prefixLabel="Prefix:";
ZmMsg.prefixTextWith="Prefix included messages with:";
ZmMsg.preformatted="Preformatted";
ZmMsg.presenceTooltip="Your current instant messaging status is: {0}";
ZmMsg.presenceTooltipYahoo="You are logged in to Yahoo! Messenger as {0}. Your status is: {1}.";
ZmMsg.presenceTooltipYahooLoggedOut="You are not logged in to Yahoo! Messenger.";
ZmMsg.presentation="Presentation";
ZmMsg.presentationName="Presentation Name";
ZmMsg.presentations="Presentations";
ZmMsg.preview="Preview";
ZmMsg.previous="Previous";
ZmMsg.previousConversation="Previous Conversation";
ZmMsg.previousDay="Previous Day";
ZmMsg.previousMessage="Previous Message";
ZmMsg.previousMonth="Previous Month";
ZmMsg.previousPage="Previous Page";
ZmMsg.previousWeek="Previous Week";
ZmMsg.previousWorkWeek="Previous Work Week";
ZmMsg.print="Print";
ZmMsg.printAddrBook="Print Address Book";
ZmMsg.printCalendar="Print calendar";
ZmMsg.printCallTooltip="Print call list";
ZmMsg.printContact="Print selected contact(s)";
ZmMsg.printDocument="Print document";
ZmMsg.printMultiTooltip="Print selected item(s)";
ZmMsg.printResults="Print Results";
ZmMsg.printTask="Print selected task(s)";
ZmMsg.printTaskFolder="Print Task Folder";
ZmMsg.printTooltip="Print selected item";
ZmMsg.printVoicemailTooltip="Print voice mail list";
ZmMsg.priority="Priority";
ZmMsg.priorityLabel="Priority:";
ZmMsg.privatePermission="Allow user(s) to see my private appointments.";
ZmMsg.progress="Progress";
ZmMsg.properties="Properties";
ZmMsg.pt="{0}pt";
ZmMsg.ptstAccept="Accepted";
ZmMsg.ptstDeclined="Declined";
ZmMsg.ptstDeferred="Deferred";
ZmMsg.ptstDelegated="Delegated";
ZmMsg.ptstNeedsAction="Needs Action";
ZmMsg.ptstTentative="Tentative";
ZmMsg.ptstWaiting="Waiting";
ZmMsg.purple="Purple";
ZmMsg.quick="Quick";
ZmMsg.quickAddAppt="QuickAdd Appointment";
ZmMsg.quota="Quota";
ZmMsg.quotaDescLimited="{0} of {1}";
ZmMsg.quotaDescUnlimited="{0} of unlimited";
ZmMsg.re="Re";
ZmMsg.read="Read";
ZmMsg.readReceipt="Read Receipt:";
ZmMsg.readReceiptAddress="Read Receipt Address:";
ZmMsg.readReceiptAlways="Always send a read receipt";
ZmMsg.readReceiptAsk="Ask me";
ZmMsg.readReceiptNever="Never send a read receipt";
ZmMsg.readReceiptPref="When I receive a request for a read receipt";
ZmMsg.readReceiptSend="The sender of this message has requested to be notified when you read this message.<br><br>Do you wish to notify the sender?";
ZmMsg.readReceiptSent="A read receipt was sent for this message.";
ZmMsg.readingPaneAtBottom="Reading Pane At The Bottom";
ZmMsg.readingPaneOff="Reading Pane Off";
ZmMsg.readingPaneOnRight="Reading Pane On The Right";
ZmMsg.received="Received";
ZmMsg.recurBlurb="{0} {2} {1}";
ZmMsg.recurDailyEveryDay="Every day";
ZmMsg.recurDailyEveryNumDays="Every {0,number,integer} days";
ZmMsg.recurDailyEveryWeekday="Every weekday";
ZmMsg.recurEndByDate="End by {0,date,medium}";
ZmMsg.recurEndNone="No end date";
ZmMsg.recurEndNumber="End after {0,number,integer} occurrence(s)";
ZmMsg.recurMonthlyEveryNumMonthsDate="Day {0,number,integer} of every {1,number,integer} month(s)";
ZmMsg.recurMonthlyEveryNumMonthsNumDay="The {0,choice,-1#last|1#first|2#second|3#third|4#fourth} {1,date,EEEE} of every {2,number,integer} month(s)";
ZmMsg.recurMonthlyEveryNumMonthsWeekDays="The {0,choice,-1#last|1#first|2#second|3#third|4#fourth} {1,choice,-1#day|0#weekend|1#weekday} of every {2,number,integer} month(s)";
ZmMsg.recurStart="Effective {0,date,medium}";
ZmMsg.recurWeeklyEveryNumWeeksDate="Every {0,number,integer} weeks on {2}{1,list,date,EEEE}";
ZmMsg.recurWeeklyEveryWeekday="Every {0,date,EEEE}";
ZmMsg.recurYearlyEveryDate="Every year on {0,date,MMMM} {1,number,integer}";
ZmMsg.recurYearlyEveryMonthNumDay="The {0,choice,-1#last|1#first|2#second|3#third|4#fourth} {1,date,EEEE} of every {2,date,MMMM}";
ZmMsg.recurYearlyEveryMonthWeekDays="The {0,choice,-1#last|1#first|2#second|3#third|4#fourth} {1,choice,-1#day|0#weekend|1#weekday} of every {2,date,MMMM}";
ZmMsg.recurrence="Recurrence";
ZmMsg.recurrenceRuleDay="day";
ZmMsg.recurrenceRuleWeekday="weekday";
ZmMsg.recurrenceRuleWeekend="weekend day";
ZmMsg.red="Red";
ZmMsg.refresh="Refresh";
ZmMsg.refreshFilters="Refresh Filters";
ZmMsg.refreshTooltip="Refresh the selected item";
ZmMsg.reload="Reload";
ZmMsg.rememberMe="Remember me on this computer";
ZmMsg.rememberMeMobile="Remember me";
ZmMsg.reminder="Reminder";
ZmMsg.reminderInDays="In {3,number,integer} {3,choice,1#day|2#days}.";
ZmMsg.reminderInDaysHours="In {3,number,integer} {3,choice,1#day|2#days}, {4,number,integer} {4,choice,1#hour|2#hours}.";
ZmMsg.reminderInHours="In {4,number,integer} {4,choice,1#hour|2#hours}.";
ZmMsg.reminderInHoursMinutes="In {4,number,integer} {4,choice,1#hour|2#hours}, {5,number,integer} {5,choice,1#minute|2#minutes}.";
ZmMsg.reminderInMinutes="In {5,number,integer} {5,choice,1#minute|2#minutes}.";
ZmMsg.reminderInMonths="In {2,number,integer} {2,choice,1#month|2#months}.";
ZmMsg.reminderInMonthsDays="In {2,number,integer} {2,choice,1#month|2#months}, {3,number,integer} {3,choice,1#day,2#days}.";
ZmMsg.reminderInYears="In {1,number,integer} {1,choice,1#year|2#years}.";
ZmMsg.reminderInYearsMonths="In {1,number,integer} {1,choice,1#year|2#years}, {2,number,integer} {2,choice,1#months|2#months}.";
ZmMsg.reminderLabel="Reminder:";
ZmMsg.reminderOverdueByDays="Overdue by {3,number,integer} {3,choice,1#day|2#days}.";
ZmMsg.reminderOverdueByDaysHours="Overdue by {3,number,integer} {3,choice,1#day|2#days}, {4,number,integer} {4,choice,1#hour|2#hours}.";
ZmMsg.reminderOverdueByHours="Overdue by {4,number,integer} {4,choice,1#hour|2#hours}.";
ZmMsg.reminderOverdueByHoursMinutes="Overdue by {4,number,integer} {4,choice,1#hour|2#hours}, {5,number,integer} {5,choice,1#minute|2#minutes}.";
ZmMsg.reminderOverdueByMinutes="Overdue by {5,number,integer} {5,choice,1#minute|2#minutes}.";
ZmMsg.reminderOverdueByMonths="Overdue by {2,number,integer} {2,choice,1#month|2#months}.";
ZmMsg.reminderOverdueByMonthsDays="Overdue by {2,number,integer} {2,choice,1#month|2#months}, {3,number,integer} {3,choice,1#day,2#days}.";
ZmMsg.reminderOverdueByYears="Overdue by {1,number,integer} {1,choice,1#year|2#years}.";
ZmMsg.reminderOverdueByYearsMonths="Overdue by {1,number,integer} {1,choice,1#year|2#years}, {2,number,integer} {2,choice,1#months|2#months}.";
ZmMsg.reminderSnoozeMinutes="{0} {0,choice,1#minute|2#minutes}";
ZmMsg.remove="Remove";
ZmMsg.removeAddr="Remove {0}";
ZmMsg.removeAll="Remove All";
ZmMsg.removeAllAttachments="Remove all attachments";
ZmMsg.removeDupesToSelf="When I receive a message originally sent by me";
ZmMsg.removeDupesToSelfLabel="Messages from me:";
ZmMsg.removePhoto="Remove Photo";
ZmMsg.removeTag="Remove Tag";
ZmMsg.removed="Removed:";
ZmMsg.renameFolder="Rename Folder";
ZmMsg.renameSearch="Rename Search";
ZmMsg.renameTag="Rename Tag";
ZmMsg.repeat="Repeat";
ZmMsg.repeatLabel="Repeat:";
ZmMsg.repeats="Repeats";
ZmMsg.replace="Replace";
ZmMsg.replaceAll="Replace All";
ZmMsg.replaceAllMenu="Replace all ({0} occurrences)";
ZmMsg.replaceWithLabel="Replace with:";
ZmMsg.replied="Replied";
ZmMsg.reply="Reply";
ZmMsg.replyAccept="Accept";
ZmMsg.replyAll="Reply to All";
ZmMsg.replyAllTooltip="Reply to all recipients of the selected message";
ZmMsg.replyAllTooltipConv="Reply to all recipients of the most recent message in the conversation";
ZmMsg.replyByEmail="Reply by Email";
ZmMsg.replyByEmailTooltip="Reply by email to the caller of the selected voice mail message";
ZmMsg.replyDecline="Decline";
ZmMsg.replyForwardFormat="Reply/Forward message format:";
ZmMsg.replyForwardInSameFormat="Reply/Forward using format of the original message";
ZmMsg.replyInclude="When replying:";
ZmMsg.replyNewTime="Propose New Time";
ZmMsg.replyOptions="Set reply mode, change format, change how original is forwarded";
ZmMsg.replyPrefix="----- {0} wrote:\r\n";
ZmMsg.replySender="Reply to Sender";
ZmMsg.replyTentative="Tentative";
ZmMsg.replyTo="Reply To";
ZmMsg.replyToAddress="Reply-to address";
ZmMsg.replyToAddressError="The reply to address field is not a valid email address";
ZmMsg.replyToError="The reply to field is empty";
ZmMsg.replyTooltip="Reply to the sender of the selected message";
ZmMsg.replyTooltipConv="Reply to the sender of the most recent message in the conversation";
ZmMsg.replyWithIdentity="When replying to or forwarding messages with this identity:";
ZmMsg.report="Send Error Report";
ZmMsg.reportSyncError="Unable to send report.";
ZmMsg.reportSyncFailure="Report";
ZmMsg.requestReadReceipt="Request Read Receipt";
ZmMsg.requestResponses="Request Responses";
ZmMsg.resend="Resend";
ZmMsg.resentShareMessage="Share Notice Sent";
ZmMsg.reset="Reset";
ZmMsg.resolveDuplicateIgnore="Ignore";
ZmMsg.resolveDuplicateModify="Modify";
ZmMsg.resolveDuplicateReplace="Replace";
ZmMsg.resolveDuplicateReset="Reset";
ZmMsg.resolveDuplicatesLabel="Resolve duplicates:";
ZmMsg.resourceConflictIgnore="Ignore Conflicts and Book";
ZmMsg.resourceConflictInfo="The selected resources/location might already be scheduled on the following instances";
ZmMsg.resourceConflictLabel="Conflicting Resources";
ZmMsg.resources="Resources";
ZmMsg.resourcesLabel="Resources:";
ZmMsg.restoreDefaults="Restore Defaults";
ZmMsg.restorePage="Undo Changes";
ZmMsg.resumeEditing="Resume editing";
ZmMsg.revert="Revert";
ZmMsg.revertTimeChanges="Revert Time Changes";
ZmMsg.revoke="Revoke";
ZmMsg.revokeShare="Revoke Share";
ZmMsg.revokeShareConfirm="Are you sure you want to revoke access for {0}?";
ZmMsg.right="Right";
ZmMsg.rightClickHint="Right-click for more options.";
ZmMsg.role="Role";
ZmMsg.roleLabel="Role:";
ZmMsg.room="Room";
ZmMsg.rootFolder="Root";
ZmMsg.rosterItemAddressNoValue="You must specify an address.";
ZmMsg.rotfl="rolling on the floor laughing";
ZmMsg.rowProperties="Row Properties";
ZmMsg.runSlideShow="Run Slide Show";
ZmMsg.running="running";
ZmMsg.save="Save";
ZmMsg.saveConflict="Save Conflict";
ZmMsg.saveConflictDesc="<b>{0}</b> already exists or has been changed.<br>What would you like to do?";
ZmMsg.saveConflictDoc='Document with name "{0}" already exists. Please use a different name.';
ZmMsg.saveConflictKeepMine="Keep My Copy";
ZmMsg.saveConflictKeepMineDesc="Keep <b>my</b> copy of the file,<br>discarding their changes.";
ZmMsg.saveConflictKeepTheirs="Keep Their Copy";
ZmMsg.saveConflictKeepTheirsDesc="Keep <b>their</b> copy of the file,<br>discarding my changes.";
ZmMsg.saveConflictPresentation='Presentation with name "{0}" already exists. Please use a different name.';
ZmMsg.saveConflictSpreadsheet='Spreadsheet with name "{0}" already exists. Please use a different name.';
ZmMsg.saveConflictViewTheirs="View Their File";
ZmMsg.saveConflictViewTheirsDesc="View their file to see which to keep.<br>(Will open in a new window.)";
ZmMsg.saveContactTooltip="Save the current contact";
ZmMsg.saveCurrentSearch="Save the current search";
ZmMsg.saveDraft="Save Draft";
ZmMsg.saveDraftTooltip="Save message to Drafts folder";
ZmMsg.saveFile="Download";
ZmMsg.saveFileTooltip="Save this file to your computer";
ZmMsg.saveIn="Save in";
ZmMsg.savePrefs="Save current options";
ZmMsg.saveSearch="Save Search";
ZmMsg.saveSearchTooltip="Save the search";
ZmMsg.saveToSent="Save a copy to Sent folder";
ZmMsg.saveToSentNOT="Do not save sent messages";
ZmMsg.savedAppointment="Appointment Saved";
ZmMsg.savedDoc="Document Saved";
ZmMsg.savedPresentation="Presentation Saved";
ZmMsg.savedSearch="Saved Search";
ZmMsg.savedSearches="Saved Searches";
ZmMsg.savedSpreadsheet="Spreadsheet Saved";
ZmMsg.schedule="Schedule";
ZmMsg.search="Search";
ZmMsg.searchAll="All Item Types";
ZmMsg.searchAllAccounts="Search All Accounts";
ZmMsg.searchAppts="Search Appointments";
ZmMsg.searchBriefcase="Files";
ZmMsg.searchBuilder="Advanced";
ZmMsg.searchByAttachment="Search by attachment type";
ZmMsg.searchByBasic="Search by address, subject, or content";
ZmMsg.searchByCustom="Add text to the search query";
ZmMsg.searchByDate="Search on, before, or after a certain date";
ZmMsg.searchByDomain="Search by address domain";
ZmMsg.searchByFlag="Search by message flag or status";
ZmMsg.searchByFolder="Search by folder";
ZmMsg.searchBySavedSearch="Invoke a saved search";
ZmMsg.searchBySize="Search by size";
ZmMsg.searchByTag="Search by tag";
ZmMsg.searchByTime="Search by relative time/date";
ZmMsg.searchByZimlet="Search by Zimlet";
ZmMsg.searchCalendar="Calendar Appointments";
ZmMsg.searchContacts="Contacts";
ZmMsg.searchFilterHint="e.g. has:attachment";
ZmMsg.searchFilterLabel="Search filter:";
ZmMsg.searchForAny="Search for anything";
ZmMsg.searchForAppts="Search for appointments";
ZmMsg.searchForConvs="Search for mail conversations";
ZmMsg.searchForFiles="Search for files";
ZmMsg.searchForMessages="Search for mail messages";
ZmMsg.searchForPages="Search for pages";
ZmMsg.searchForVoicemails="Search for voice mails";
ZmMsg.searchGALContacts="Global Address List";
ZmMsg.searchIn="in:";
ZmMsg.searchInput="Search";
ZmMsg.searchLabel="Search:";
ZmMsg.searchLanguageLabel="Search Language:";
ZmMsg.searchMail="Email";
ZmMsg.searchName="Name for the saved search";
ZmMsg.searchNameEmpty="You must specify a value for the name of the saved search.";
ZmMsg.searchNameExists="A saved search with that name exists. Please use another name.";
ZmMsg.searchNoLocation="You must select a location for the saved search.";
ZmMsg.searchNotebooks="Pages";
ZmMsg.searchNotes="Notes";
ZmMsg.searchPersonalContacts="Personal Contacts";
ZmMsg.searchPersonalSharedContacts="Personal and Shared Contacts";
ZmMsg.searchResults="Search results";
ZmMsg.searchScope="Search Scope";
ZmMsg.searchSettingsLabel="Search Settings:";
ZmMsg.searchShared="Include Shared Items";
ZmMsg.searchTasks="Search Tasks";
ZmMsg.searchTooltip="Run the search";
ZmMsg.searchVoicemails="Voice Mails";
ZmMsg.searches="Searches";
ZmMsg.seconds="seconds";
ZmMsg.sections="Sections";
ZmMsg.selectAdapt="Select based on whether I was moving up or down in the list";
ZmMsg.selectAddresses="Select Addresses";
ZmMsg.selectAfterDeleteLabel="After I move or delete a message:";
ZmMsg.selectBuddyOrContact="Select Buddy or Contact";
ZmMsg.selectContact="Select Contact";
ZmMsg.selectIdentityWhen="Select this identity when:";
ZmMsg.selectLanguage="Language";
ZmMsg.selectNext="Select the next message";
ZmMsg.selectPrevious="Select the previous message";
ZmMsg.selectSearch="Select a saved search";
ZmMsg.selectSkin="UI theme";
ZmMsg.selectTimezone="Timezone";
ZmMsg.selectTimezoneInfo="We are unable to identify the timezone in your area, please choose the timezone from list";
ZmMsg.selectTimezoneLabel="Timezone:";
ZmMsg.selectTimezoneTitle="Select Timezone    ";
ZmMsg.selection="Selection";
ZmMsg.selectionColumn="Click to select all items on page. Shift-click to select all search results.";
ZmMsg.selectiveCallForwardingDescription="Forward <b>only</b> the following numbers to:";
ZmMsg.selectiveCallForwardingError="The selective call forwarding number is invalid";
ZmMsg.selectiveCallForwardingFromError="There must be at least one number to forward calls from";
ZmMsg.selectiveCallForwardingHeader="Forward Calls From";
ZmMsg.selectiveCallForwardingLabel="Selective Call Forwarding:";
ZmMsg.selectiveCallForwardingRules="(You may forward up to 12 numbers)";
ZmMsg.sellEmail="You are not authorized to send email.";
ZmMsg.send="Send";
ZmMsg.sendAsAttachment="Send as attachment(s)";
ZmMsg.sendBCCTo="Send BCC to:";
ZmMsg.sendByEmail="Send by email";
ZmMsg.sendComposedMailAboutShare="Compose email in new window";
ZmMsg.sendErrorAbort="Message not sent; one or more addresses were not accepted.";
ZmMsg.sendErrorInvalidAddresses="Rejected addresses: {0}";
ZmMsg.sendErrorPartial="Message not sent to the following rejected addresses: {0}";
ZmMsg.sendErrorUnsentAddresses="Message NOT sent to: {0}";
ZmMsg.sendFile="Send file";
ZmMsg.sendFrom="From:";
ZmMsg.sendFromAddressError="The send from address field is not a valid email address";
ZmMsg.sendFromError="The send from field is empty";
ZmMsg.sendInvDeniedAutoReply="Send auto-reply to users who are denied from inviting me";
ZmMsg.sendLink="Send link(s)";
ZmMsg.sendMailAboutShareNote="<b>Note:</b> The standard message displays your name, the name of the shared item, permissions granted to the recipients, and login information, if necessary.";
ZmMsg.sendNoMailAboutShare="Do not send mail about this share";
ZmMsg.sendNotificationMail="Send Notification Mail";
ZmMsg.sendNotificationMailWarning="Changes made will not be visible to attendees on disabling mail notification";
ZmMsg.sendObo="Send this message on behalf of: {0}";
ZmMsg.sendPageTT="Send page";
ZmMsg.sendReceive="Send/Receive";
ZmMsg.sendStandardMailAboutShare="Send standard message";
ZmMsg.sendStandardMailAboutSharePlusNote="Add note to standard message";
ZmMsg.sendTooltip="Send message";
ZmMsg.sendUpdateTitle="Send Update to Attendees";
ZmMsg.sendUpdatesAll="Send updates to all attendees.";
ZmMsg.sendUpdatesNew="Send updates only to added or removed attendees.";
ZmMsg.sendWithIdentity="Send messages with this identity:";
ZmMsg.sender="Sender";
ZmMsg.sent="Sent";
ZmMsg.sentAt="Sent";
ZmMsg.sentBy="Sent By";
ZmMsg.sentByLabel="Sent By:";
ZmMsg.separator="Separator";
ZmMsg.sessionExpired="Your session has expired. Please login again.";
ZmMsg.setPriority="Set the priority of the message";
ZmMsg.setReplyTo="Reply-to:";
ZmMsg.setStatus="Set Status";
ZmMsg.settingsLabel="Settings:";
ZmMsg.setup="Setup";
ZmMsg.share="Share";
ZmMsg.shareAFolder="Share A Folder";
ZmMsg.shareAcceptedHtml='<h3>The following share has been accepted:</h3>\n<p>\n<table border="0">\n<tr><th align="left">Shared item:</th><td>{0}</td></tr>\n<tr><th align="left">Owner:</th><td>{2}</td></tr>\n</table>\n<p>\n<table border="0">\n<tr><th align="left">Grantee:</th><td>{3}</td></tr>\n<tr><th align="left">Role:</th><td>{4}</td></tr>\n<tr><th align="left">Allowed actions:</th><td>{5}</td>\n</tr>\n</table>';
ZmMsg.shareAcceptedSubject="Share Accepted";
ZmMsg.shareAcceptedText="The following share has been accepted:\n\nShared item: {0}\nOwner: {2}\n\nGrantee: {3}\nRole: {4}\nAllowed actions: {5}";
ZmMsg.shareActionAdmin="Administer";
ZmMsg.shareActionDelete="Remove";
ZmMsg.shareActionInsert="Add";
ZmMsg.shareActionNoAdmin="Administer Denied";
ZmMsg.shareActionNoDelete="Remove Denied";
ZmMsg.shareActionNoInsert="Add Denied";
ZmMsg.shareActionNoRead="View Denied";
ZmMsg.shareActionNoWorkflow="Accept Denied, Decline Denied";
ZmMsg.shareActionNoWrite="Edit Denied";
ZmMsg.shareActionNone="None";
ZmMsg.shareActionRead="View";
ZmMsg.shareActionWorkflow="Accept, Decline";
ZmMsg.shareActionWrite="Edit";
ZmMsg.shareAddrBook="Share Address Book";
ZmMsg.shareCalendar="Share Calendar";
ZmMsg.shareCreatedHtml='<h3>The following share has been created:</h3>\n<p>\n<table border="0">\n<tr><th align="left">Shared item:</th><td>{0} {1}</td></tr>\n<tr><th align="left">Owner:</th><td>{2}</td></tr>\n</table>\n</p>\n<table border="0">\n<tr><th align="left">Grantee:</th><td>{3}</td></tr>\n<tr><th align="left">Role:</th><td>{4}</td></tr>\n<tr><th align="left">Allowed actions:</th><td>{5}</td>\n</tr>\n</table>';
ZmMsg.shareCreatedSubject="Share Created";
ZmMsg.shareCreatedText="The following share has been created:\n\nShared item: {0} {1}\nOwner: {2}\n\nGrantee: {3}\nRole: {4}\nAllowed actions: {5}\n";
ZmMsg.shareDeclinedHtml='<h3>The following share has been declined:</h3>\n<p>\n<table border="0">\n<tr><th align="left">Shared item:</th><td>{0}</td></tr>\n<tr><th align="left">Owner:</th><td>{2}</td></tr>\n</table>\n<p>\n<table border="0">\n<tr><th align="left">Grantee:</th><td>{3}</td></tr>\n<tr><th align="left">Role:</th><td>{4}</td></tr>\n<tr><th align="left">Allowed actions:</th><td>{5}</td>\n</tr>\n</table>';
ZmMsg.shareDeclinedSubject="Share Declined";
ZmMsg.shareDeclinedText="The following share has been declined:\n\nShared item: {0}\nOwner: {2}\n\nGrantee: {3}\nRole: {4}\nAllowed actions: {5}";
ZmMsg.shareFolder="Share Folder";
ZmMsg.shareFormText="Folders that have been shared with you are shown below. Once a folder has been shared with you, you must accept the share and provide a local name for the folder before it shows up in the overview. Folders that have been shared with you but which you have not accepted (if any) are shown in a separate list from shared folders that you have accepted. Folders may be shared with you in two different ways: they may be shared with a distribution list which includes you, or they may be shared with you directly by another user.";
ZmMsg.shareModifiedHtml='<h3>The following share has been modified:</h3>\n<p>\n<table border="0">\n<tr><th align="left">Shared item:</th><td>{0} {1}</td></tr>\n<tr><th align="left">Owner:</th><td>{2}</td></tr>\n</table>\n<p>\n<table border="0">\n<tr><th align="left">Grantee:</th><td>{3}</td></tr>\n<tr><th align="left">Role:</th><td>{4} [MODIFIED]</td></tr>\n<tr><th align="left">Allowed actions:</th><td>{5} [MODIFIED]</td>\n</tr>\n</table>';
ZmMsg.shareModifiedSubject="Share Modified";
ZmMsg.shareModifiedText="The following share has been modified:\n\nShared item: {0} {1}\nOwner: {2}\n\nGrantee: {3}\nRole: {4} [MODIFIED]\nAllowed actions: {5} [MODIFIED]";
ZmMsg.shareNameDefault="{0}''s {1}";
ZmMsg.shareNotebook="Share Notebook";
ZmMsg.shareNotesHtml='<p>\n<table border="0">\n<tr valign="top"><th align="left">Notes:</th><td>{0}</td></tr>\n</table>';
ZmMsg.shareNotifyHtml='<h3>The following share item has been updated:</h3>\n<p>\n<table border="0">\n<tr><th align="left">Shared item:</th><td>{0}</td></tr>\n<tr><th align="left">Owner:</th><td>{2}</td></tr>\n</table>\n<p>\n<table border="0">\n<tr><th align="left">Grantee:</th><td>{3}</td></tr>\n<tr><th align="left">Role:</th><td>{4}</td></tr>\n<tr><th align="left">Allowed actions:</th><td>{5}</td>\n</tr>\n</table>';
ZmMsg.shareNotifySubject="Share Item Updated";
ZmMsg.shareNotifyText="The following shared item has been updated:\n\nShared item: {0}\nOwner: {2}\n\nGrantee: {3}\nRole: {4}\nAllowed actions: {5}";
ZmMsg.shareProperties="Share Properties";
ZmMsg.shareRevokedHtml='<h3>The following share has been revoked:</h3>\n\n<table border="0">\n<tr><th align="left">Shared item:</th><td>{0} {1}</td></tr>\n<tr><th align="left">Owner:</th><td>{2}</td></tr>\n</table>\n<p>\n<table border="0">\n<tr><th align="left">Revokee:</th><td>{3}</td></tr>\n</table>';
ZmMsg.shareRevokedSubject="Share Revoked";
ZmMsg.shareRevokedText="The following share has been revoked:\n\nShared item: {0} {1}\nOwner: {2}\n\nRevokee: {3}";
ZmMsg.shareRoleAdmin="Admin";
ZmMsg.shareRoleCustom="Custom";
ZmMsg.shareRoleManager="Manager";
ZmMsg.shareRoleNone="None";
ZmMsg.shareRoleViewer="Viewer";
ZmMsg.shareSection="Share Notebook";
ZmMsg.shareTaskFolder="Share Task List";
ZmMsg.shareTooltip="Share this item with another user";
ZmMsg.shareUrlInfo="To allow others to access this item, direct them to this URL:";
ZmMsg.shareWithAll="All authenticated users";
ZmMsg.shareWithGuest="External guests (view only)";
ZmMsg.shareWithGuestNotes="URL: {0}\nUsername: {1}\nPassword: {2}";
ZmMsg.shareWithLabel="Share with:";
ZmMsg.shareWithPublic="Public";
ZmMsg.shareWithPublicLong="Public (view only, no password required)";
ZmMsg.shareWithUserOrGroup="Internal users or groups";
ZmMsg.sharedBySubject="{0} shared by {1}";
ZmMsg.sharedFolderNotSupported="A file cannot be copied to shared folder";
ZmMsg.sharing="Sharing";
ZmMsg.sharingByMe="Folders shared by me";
ZmMsg.sharingErrorOwnerMissing="Owner is a required field";
ZmMsg.sharingErrorOwnerSelf="You cannot search for shares from yourself";
ZmMsg.sharingFolder="Folder";
ZmMsg.sharingFolderType="Type";
ZmMsg.sharingGroup="Group";
ZmMsg.sharingItem="Item";
ZmMsg.sharingOwner="Owner";
ZmMsg.sharingOwnerLabel="Owner:";
ZmMsg.sharingRole="Role";
ZmMsg.sharingWith="With";
ZmMsg.sheet="Spreadsheets";
ZmMsg.sheetTooltip="Spreadsheets";
ZmMsg.shortcuts="Shortcuts";
ZmMsg.shortcutsApp="Application Shortcuts";
ZmMsg.shortcutsCurrent="Listed below are the keyboard shortcuts that are currently available, based on where you are in the application. To see a comprehensive list of all keyboard shortcuts, go to Preferences | Shortcuts.";
ZmMsg.shortcutsSys="System Shortcuts";
ZmMsg.shouldShowTimezone="Show timezone list in appointment view";
ZmMsg.showAdvancedOptions="Show advanced options";
ZmMsg.showAllItemTypes="Show All Item Types";
ZmMsg.showAs="Show as:";
ZmMsg.showBCC="Show BCC";
ZmMsg.showDetails="Show Details";
ZmMsg.showExternalImages="Download pictures automatically in HTML Email";
ZmMsg.showFragments="Display snippets of messages in email list:";
ZmMsg.showGlobalInbox="Show Global Inbox";
ZmMsg.showGroupShares="Show folders shared with me through a distribution list";
ZmMsg.showMessage="Show Message";
ZmMsg.showNames="Show names from:";
ZmMsg.showOnlyContacts="Show only Contacts";
ZmMsg.showOnlyMail="Show only Mail Messages";
ZmMsg.showOrig="Show Original";
ZmMsg.showPassword="Show password";
ZmMsg.showPopup="Show a popup notification";
ZmMsg.showPopupBrowserPlus="Show a popup notification";
ZmMsg.showPopupBrowserPlusLink="(requires <a target='_blank' href='http://browserplus.yahoo.com/'>Yahoo! BrowserPlus</a>)";
ZmMsg.showPopupMac="Show a popup notification (requires Growl)";
ZmMsg.showRemainingFolders="Show remaining {0}";
ZmMsg.showRemainingFoldersTooltip="Click here to show {0} remaining {1}";
ZmMsg.showSearchString="Show advanced search language in search toolbar";
ZmMsg.showSelectionString="Display checkboxes to quickly select items in lists (requires refresh)";
ZmMsg.showUserShares="Show folders shared with me by the following user:";
ZmMsg.showWeekNumber="Show Calendar Week ";
ZmMsg.signature="Signature";
ZmMsg.signatureAttachLabel="Attach Signature:";
ZmMsg.signatureDoNotAttach="Do Not Attach Signature";
ZmMsg.signatureEnabled="Automatically attach my signature to every email I send";
ZmMsg.signatureEnabledHelp="To only use this signature sometimes, uncheck the box above and use the <b>Add Signature</b> button in the email compose screen.";
ZmMsg.signatureLabel="Signature:";
ZmMsg.signatureMoreOptions="A default signature can be set on the <a href='#Prefs.Accounts' onclick='skin.gotoPrefs(\"ACCOUNTS\");return false'>Accounts Page</a>";
ZmMsg.signatureNameLabel="Signature Name:";
ZmMsg.signatureNameMissingRequired="Signature name is empty. It's required.";
ZmMsg.signatureNewName="Signature #{0}";
ZmMsg.signatureNote="Signatures with no name or content are discarded.";
ZmMsg.signatureStyle="Place signature at bottom of entire message";
ZmMsg.signatureValueMissingRequired="Signature value is empty. It's required.";
ZmMsg.signatures="Signatures";
ZmMsg.signaturesUsing="Using Signatures";
ZmMsg.simple="Simple";
ZmMsg.site="Site";
ZmMsg.size="Size";
ZmMsg.sizeLabel="Size:";
ZmMsg.sizeToolTip="Size";
ZmMsg.skinChangeRestart="Would you like to reload the application now to show the new theme? <br>(Otherwise, the new theme will appear the next time you log in.)";
ZmMsg.skinDeletedError='Your current theme, "{0}", is not available. Please contact your system administrator.';
ZmMsg.skinDeletedErrorTitle="Zimbra : Theme not available";
ZmMsg.slide_insertAreaChart="Insert Area Chart";
ZmMsg.slide_insertChart="Insert Chart";
ZmMsg.slide_insertColumnChart="Insert Column Chart";
ZmMsg.slide_insertDoughnutChart="Insert Doughnut Chart";
ZmMsg.slide_insertFunnelChart="Insert Funnel Chart";
ZmMsg.slide_insertPieChart="Insert Pie Chart";
ZmMsg.slides_confirmDeleteSlide="Are you sure you want to delete this slide?";
ZmMsg.slides_deleteSlide="Delete Slide";
ZmMsg.slides_deleteTextBox="Delete Text Box";
ZmMsg.slides_endSlideMsg="End of slide show. <br> Click to exit";
ZmMsg.slides_imageURL="Image URL";
ZmMsg.slides_insertSlide="Insert Slide";
ZmMsg.slides_insertTextBox="Insert Text Box";
ZmMsg.slides_launchSlideShow="Launch Slide Show";
ZmMsg.slides_runSlideShow="Run";
ZmMsg.slides_textBoxMessage="Click to enter text";
ZmMsg.slides_themeBlue="Blue";
ZmMsg.slides_themeBlueBand="Blue Band";
ZmMsg.slides_themeDarkBlue="Dark Blue";
ZmMsg.slides_themeDefault="Default";
ZmMsg.slides_themeGreen="Green";
ZmMsg.slides_themePurple="Purple";
ZmMsg.slides_themes="Themes";
ZmMsg.smaller="is smaller than";
ZmMsg.smartInclude="Include last message only";
ZmMsg.snooze="Snooze";
ZmMsg.snoozeAll="Snooze all for:";
ZmMsg.sortByDuration="Sort by Duration";
ZmMsg.sortByFrom="Sort by From";
ZmMsg.sortByLastSaved="Sort by Last Saved";
ZmMsg.sortByReceived="Sort by Received";
ZmMsg.sortBySent="Sort by Sent";
ZmMsg.sortBySize="Sort by Size";
ZmMsg.sortBySubject="Sort by Subject";
ZmMsg.sortByTo="Sort by To";
ZmMsg.sortOrder="Sort order";
ZmMsg.source="Source";
ZmMsg.sourceLabel="Source:";
ZmMsg.specAtt="Specific Attachment";
ZmMsg.specFile="Specific Filename";
ZmMsg.spellCheck="Spell Check";
ZmMsg.spellCheckFailed="Spell Check Failed. Do you want to send this message anyway?";
ZmMsg.spellCheckTooltip="Check spelling";
ZmMsg.spellCheckUnavailable="Spell Check Unavailable";
ZmMsg.splashScreenAppName="Collaboration Suite";
ZmMsg.splashScreenCompanyURL="http://www.zimbra.com";
ZmMsg.splashScreenCopyright="Copyright \u00a9 2005-2009 Zimbra, Inc.     'Zimbra' and the Zimbra logos are trademarks of Zimbra, Inc.";
ZmMsg.splashScreenLoading="Loading ...";
ZmMsg.splashScreenOfflineName="Desktop";
ZmMsg.splashScreenSwitch="If you are using a slow connection or an older computer, you may want to <a href='javascript:switchToStandardClient()'>switch to the Standard (HTML) version</a>.";
ZmMsg.splashScreenVersion="Version";
ZmMsg.splashScreenZimbraUrl="<a href='http://www.zimbra.com' target=_blank>http://www.zimbra.com</a>";
ZmMsg.splitCell="Split Cell";
ZmMsg.splitCells="Split Cells";
ZmMsg.spreadSheet_func_PI="Constant PI";
ZmMsg.spreadSheet_func_abs="Returns the absolute value of the argument";
ZmMsg.spreadSheet_func_average="Computes the arithmetic average of several values";
ZmMsg.spreadSheet_func_ceil="Returns the smallest integer bigger than the argument";
ZmMsg.spreadSheet_func_concat="Concatenates multiple strings";
ZmMsg.spreadSheet_func_cos="Returns the cosine of the argument";
ZmMsg.spreadSheet_func_exp="Computes the exponential of the argument";
ZmMsg.spreadSheet_func_floor="Returns the biggest integer smaller than the argument";
ZmMsg.spreadSheet_func_if="Returns one of 2 values depending on the condition";
ZmMsg.spreadSheet_func_join="Joins multiple strings with a given separator";
ZmMsg.spreadSheet_func_len="Returns the length of the given string argument";
ZmMsg.spreadSheet_func_log="Computes the natural logarithm of the argument";
ZmMsg.spreadSheet_func_max="Returns the maximum of several values";
ZmMsg.spreadSheet_func_min="Returns the minimum of several values";
ZmMsg.spreadSheet_func_modulo="Computes the remainder of division of arg1 to arg2";
ZmMsg.spreadSheet_func_multiply="Multiplies the values of given arguments";
ZmMsg.spreadSheet_func_round="Rounds the argument to the nearest integer";
ZmMsg.spreadSheet_func_sin="Returns the sine of the argument";
ZmMsg.spreadSheet_func_sqrt="Computes the square root of the argument";
ZmMsg.spreadSheet_func_sum="Computes the sum of given arguments";
ZmMsg.spreadSheet_func_tan="Returns the tangent of the argument";
ZmMsg.spreadSheet_msg_autoDecimals="Auto decimals";
ZmMsg.spreadSheet_msg_autoType="Auto type";
ZmMsg.spreadsheet="Spreadsheet";
ZmMsg.spreadsheetName="Spreadsheet Name";
ZmMsg.spreadsheetTitle="Zimbra Spreadsheet ";
ZmMsg.spreadsheet_msg_numberOfDecimals="{0,choice,0#No decimals|1#{0} decimal|2#{0} decimals}";
ZmMsg.start="Start";
ZmMsg.startDate="Start Date";
ZmMsg.startLabel="Start:";
ZmMsg.startOn="Start On:";
ZmMsg.startTime="Start Time";
ZmMsg.startTimeLabel="Start Time:";
ZmMsg.status="Status";
ZmMsg.statusFree="Status: Free";
ZmMsg.statusHistory="Status History";
ZmMsg.statusLabel="Status:";
ZmMsg.stickyWindow="Sticky Window";
ZmMsg.stopEvaluation="Stop evaluation";
ZmMsg.stopFilterProcessing="Do not process additional filters";
ZmMsg.styleLabel="Style:";
ZmMsg.subject="Subject";
ZmMsg.subjectAccept="Accept";
ZmMsg.subjectDecline="Decline";
ZmMsg.subjectLabel="Subject:";
ZmMsg.subjectNewTime="New Time Proposed";
ZmMsg.subjectTentative="Tentative";
ZmMsg.subscribeToFeed="Subscribe to RSS/ATOM feed";
ZmMsg.subscript="Subscript";
ZmMsg.sumCells="Sum cells";
ZmMsg.summary="Summary:";
ZmMsg.superscript="Superscript";
ZmMsg.switchIncludeWarning="Text that you've added before the included content will be preserved, but text added after it will be lost. Continue?";
ZmMsg.switchToHtml="Switching to html will discard some text formatting on switching back. Continue?";
ZmMsg.switchToOfflineClientEx="<a href='http://www.zimbra.com/products/desktop.html' target='_blank'>Learn about the offline version</a>";
ZmMsg.switchToText="Switching to text will discard all HTML formatting. Continue?";
ZmMsg.sync="Sync";
ZmMsg.syncOfflineFolderOff="Turn sync off";
ZmMsg.syncOfflineFolderOn="Turn sync on";
ZmMsg.syncTooltip="Synchronize mailbox with online server";
ZmMsg.systemDefaults="System Defaults:";
ZmMsg.tableAlignment="Table Alignment:";
ZmMsg.tableOperations="Table Operations";
ZmMsg.tableProperties="Table Properties";
ZmMsg.tableSize="Table Size";
ZmMsg.tableWidth="Table Width:";
ZmMsg.tag="Tag";
ZmMsg.tagAppt="Tag Appointment";
ZmMsg.tagAppts="Tag Appointments";
ZmMsg.tagColor="Tag Color";
ZmMsg.tagConversation="Tag Conversation";
ZmMsg.tagConversations="Tag Conversations";
ZmMsg.tagFile="Tag File";
ZmMsg.tagItem="Tag Item";
ZmMsg.tagItems="Tag Items";
ZmMsg.tagMessage="Tag Message";
ZmMsg.tagMessages="Tag Messages";
ZmMsg.tagName="Tag name";
ZmMsg.tagNameEmpty="You must specify a value for the tag name.";
ZmMsg.tagNameExists="A tag with that name exists. Please use another name. (Tag names are case-insensitive.)";
ZmMsg.tagPage="Tag Page";
ZmMsg.tagReadonly="You have selected one or more appointments which are read only or shared. These appointments cannot be tagged.";
ZmMsg.tagSelectLocation="You must select a location for the tag.";
ZmMsg.tagTask="Tag Task";
ZmMsg.tagTasks="Tag Tasks";
ZmMsg.tagTooltip="Tag selected item(s)";
ZmMsg.tagWith="Tag with";
ZmMsg.tags="Tags";
ZmMsg.targetAddressBook="Select the destination address book.";
ZmMsg.targetCalendar="Select the destination calendar.";
ZmMsg.targetFolder="Select the destination folder.";
ZmMsg.targetTag="Select a tag:";
ZmMsg.task="Task";
ZmMsg.taskFolder="Task List:";
ZmMsg.taskPastDue="Task is past due.";
ZmMsg.taskSaved="Task Saved";
ZmMsg.tasks="Tasks";
ZmMsg.tasksFolder="Task Folder";
ZmMsg.template="Template";
ZmMsg.tentative="Tentative";
ZmMsg.testUrl="Test";
ZmMsg.testUrlTooltip="Open this URL in new window";
ZmMsg.text="Text";
ZmMsg.textAlign="Text Alignment:";
ZmMsg.textDocuments="Text Documents";
ZmMsg.textFile="Text File";
ZmMsg.textStyle="Text Style";
ZmMsg.theirs="Theirs";
ZmMsg["theme-bare"]="Bare";
ZmMsg["theme-beach"]="Beach";
ZmMsg["theme-bones"]="Bones";
ZmMsg["theme-froggy"]="Froggy";
ZmMsg["theme-harvest"]="Harvest";
ZmMsg["theme-hotrod"]="Hot Rod";
ZmMsg["theme-lavender"]="Lavender";
ZmMsg["theme-lemongrass"]="Lemongrass";
ZmMsg["theme-sand"]="Sand";
ZmMsg["theme-sky"]="Sky";
ZmMsg["theme-steel"]="Steel";
ZmMsg["theme-vanilla"]="Vanilla";
ZmMsg["theme-venice"]="Venice";
ZmMsg["theme-waves"]="Waves";
ZmMsg.themeLabel="Theme:";
ZmMsg["thunderbird-csv"]="Thunderbird Contacts";
ZmMsg.tiffImage="TIFF Image";
ZmMsg.time="Time";
ZmMsg.timezonePrefSaved="Timezone Preference Saved";
ZmMsg.titleLabel="Title:";
ZmMsg.to="To";
ZmMsg.toCc="To / Cc";
ZmMsg.toLabel="To:";
ZmMsg.today="Today";
ZmMsg.todayGoto="Go to Today";
ZmMsg.todayTooltip="Show the calendar for today";
ZmMsg.top="Top";
ZmMsg.trash="Trash";
ZmMsg.type="Type";
ZmMsg.typeLabel="Type:";
ZmMsg.typing="typing";
ZmMsg.unableToGetPage="Unable to fetch page content";
ZmMsg.unableToImportFile="Unable to import file";
ZmMsg.unableToSavePage="Unable to save page";
ZmMsg.undelete="Undelete";
ZmMsg.under="under";
ZmMsg.unflagged="Unflagged";
ZmMsg.unitsLabel="Units:";
ZmMsg.unknown="Unknown";
ZmMsg.unknownBinaryType="Unknown Binary Type";
ZmMsg.unknownError="An unknown error has occurred.";
ZmMsg.unknownUser='Unknown user "{0}". Must specify a valid Zimbra user.';
ZmMsg.unread="Unread";
ZmMsg.unreadCount="{0} Unread";
ZmMsg.unsupportedBrowserTip="To learn more about Zimbra and the Zimbra Collaboration Suite, visit <a href='http://www.zimbra.com'>www.zimbra.com</a> or send an email to <a href='mailto:info@zimbra.com'>info@zimbra.com</a>.\";";
ZmMsg.untitled="Untitled";
ZmMsg.upLabel="Up";
ZmMsg.uploadAction="If a file already exists with the same name:";
ZmMsg.uploadActionAsk="Ask Me";
ZmMsg.uploadActionKeepMine="Replace With My File";
ZmMsg.uploadActionKeepTheirs="Keep Existing File";
ZmMsg.uploadChoose="Choose one or more files to upload:";
ZmMsg.uploadConflict="Upload Conflict";
ZmMsg.uploadConflictDesc="The following file(s) already exist on the server.<br>Which would you like to keep?";
ZmMsg.uploadDocs="Upload Files";
ZmMsg.uploadError="Upload error: {0}<br>Unable to upload the file.";
ZmMsg.uploadErrorAccessDenied="Upload error: Access is denied<br>Unable to upload the file.";
ZmMsg.uploadFileToBriefcase="Upload New File to Briefcase";
ZmMsg.uploadImage="Upload Image";
ZmMsg.uploadNewFile="Upload File";
ZmMsg.url="URL";
ZmMsg.urlLabel="URL:";
ZmMsg.useQuickAdd="Use the QuickAdd dialog when creating new appointments";
ZmMsg.useSignature="Use signature:";
ZmMsg.userLabel="User:";
ZmMsg.userUnknown="UNKNOWN USER";
ZmMsg.username="Username";
ZmMsg.usernameLabel="Username:";
ZmMsg.validateRecurrence="Start date no longer fits the existing recurrence pattern.<br>Do you want to reset it to the nearest possible date?";
ZmMsg.value="Value";
ZmMsg.valueLabel="Value:";
ZmMsg.versionChangeRestart="The server software has been updated. It is recommended that you reload your browser so that you are up to date.<br><br> Old version: {0}<br> New version: {1}<br><br> Would you like to reload the browser now? Warning: if you choose not to reload, there is a chance you will encounter errors.";
ZmMsg.versionLabel="Version:";
ZmMsg.verticalAlign="Vertical Align:";
ZmMsg.video="Video";
ZmMsg.view="View";
ZmMsg.viewAllImages="View all images";
ZmMsg.viewAppointment="Open";
ZmMsg.viewAsHtml="view as html";
ZmMsg.viewByDate="View by date:";
ZmMsg.viewCalForDay="day";
ZmMsg.viewCalForList="list";
ZmMsg.viewCalForMonth="month";
ZmMsg.viewCalForWeek="week";
ZmMsg.viewCalForWorkWeek="work";
ZmMsg.viewCalListTooltip="Show calendar as a list";
ZmMsg.viewContacts="Default contact view";
ZmMsg.viewDay="Day";
ZmMsg.viewDayTooltip="Show calendar for the currently selected day";
ZmMsg.viewEntireMessage="View entire message.";
ZmMsg.viewFileAsHtml="View as HTML";
ZmMsg.viewList="List";
ZmMsg.viewMailAsHtml="View mail as HTML (when possible)";
ZmMsg.viewMailAsHtmlLabel="Display HTML:";
ZmMsg.viewMessage="To view a message, click on it.";
ZmMsg.viewMonth="Month";
ZmMsg.viewMonthTooltip="Show calendar for the currently selected month";
ZmMsg.viewSchedule="Schedule";
ZmMsg.viewScheduleTooltip="Show schedule view";
ZmMsg.viewTheirs="View Theirs";
ZmMsg.viewTooltip="Change view options";
ZmMsg.viewWeek="Week";
ZmMsg.viewWeekTooltip="Show calendar for the currently selected week";
ZmMsg.viewWorkWeek="Work Week";
ZmMsg.viewWorkWeekTooltip="Show calendar for the currently selected work week";
ZmMsg.voice="Voice";
ZmMsg.voiceMail="Voice Mail";
ZmMsg.voicePageSizeDescription="Voice mail messages per page";
ZmMsg.voicePageSizeLabel="Display:";
ZmMsg.voicePrefsInstruction="Select the phone number you want to manage then select the options for that number.";
ZmMsg.voicemailBodyHtml='<br><br><br><br>A voice customer has sent you a new voice mail message. You can listen to the voice mail by simply opening the attached file.<br>From: {0}&nbsp;&nbsp;|&nbsp;&nbsp;Duration: {1}&nbsp;&nbsp;|&nbsp;&nbsp;Received: {2}<br><br><a href="http://www.zimbra.com">http://www.zimbra.com</a>';
ZmMsg.voicemailBodyText="\n\n\n\nA voice customer has sent you a new voice mail message. You can listen to the voice mail by simply opening the attached file.\nFrom: {0}  |  Duration: {1}  |  Received: {2}\n\nhttp://www.zimbra.com";
ZmMsg.voicemailFolder="Voice Mail Folder";
ZmMsg.voicemailForwardSubject="Listen to this voice mail I received";
ZmMsg.voicemailMessages="Voice Mail Messages";
ZmMsg.voicemailReplySubject="About your voice mail";
ZmMsg.voicemails="Voice Mails";
ZmMsg.volume="Volume";
ZmMsg.waitingOn="Waiting on someone else";
ZmMsg.waveAudio="WAV Audio";
ZmMsg.webPageLabel="A web page (URL):";
ZmMsg.week="Week";
ZmMsg.weekday="weekday";
ZmMsg.weekly="Weekly";
ZmMsg.welcome="Welcome";
ZmMsg.whatsThis="What's This?";
ZmMsg.when="When";
ZmMsg.whenInFolder="Replying to a message in folder(s):";
ZmMsg.whenInFolderError="The select when in folder field is not a valid list of folder names";
ZmMsg.whenInFolderHint="Enter folder names separated by commas or semi-colons";
ZmMsg.whenLabel="When:";
ZmMsg.whenReplyingToAddress="When replying to messages sent to this email address";
ZmMsg.whenReplyingToFolder="When reading or replying to messages in this folder";
ZmMsg.whenSentTo="Replying to a message sent to:";
ZmMsg.whenSentToError="The select when replying to address field is not a valid list of email addresses";
ZmMsg.whenSentToHint="Enter email addresses separated by commas or semi-colons";
ZmMsg.whiteBlackNumUsed="{0} of {1} used.";
ZmMsg.whiteListLabel="Allow messages from:";
ZmMsg.width="Width";
ZmMsg.widthLabel="Width:";
ZmMsg.wikiChangeNameWarning="Warning: Changing the name will break any links that point to this page.";
ZmMsg.wikiFragmentRecursion="Error: recursive fragment.";
ZmMsg.wikiIncludeMissing="Error: missing inclusion page {0}.";
ZmMsg.wikiIncludeRecursion="Error: recursive include of page {0}.";
ZmMsg.wikiNoTitle="[Untitled]";
ZmMsg.wikiPages="Pages";
ZmMsg.wikiPagesHeader="Pages";
ZmMsg.wikiPagesNotFound="(None)";
ZmMsg.wikiSectionsHeader="Notebooks";
ZmMsg.wikiSpecialPages="Special Pages";
ZmMsg.wikiTemplatesMissing="<b>Error:</b> Document templates missing. Please notify administrator.";
ZmMsg.wikiToc="Table of Contents";
ZmMsg.wikiUserPages="Pages";
ZmMsg.wikletColor="Color";
ZmMsg.wikletColorTT="Insert page's notebook color";
ZmMsg.wikletConfigureNone="This wiklet is not configurable";
ZmMsg.wikletConfigureParams="Click to set wiklet parameters";
ZmMsg.wikletConfigureValue="Click to set wiklet value";
ZmMsg.wikletCreateDate="CreateDate";
ZmMsg.wikletCreateDateTT="Insert page creation date";
ZmMsg.wikletCreateTime="CreateTime";
ZmMsg.wikletCreateTimeTT="Insert page creation time";
ZmMsg.wikletCreator="Creator";
ZmMsg.wikletCreatorTT="Insert page creator's name";
ZmMsg.wikletDateFull="Full Date";
ZmMsg.wikletDateLong="Long Date";
ZmMsg.wikletDateMedium="Medium Date";
ZmMsg.wikletDateShort="Short Date";
ZmMsg.wikletDateTimeFull="Full Date and Time";
ZmMsg.wikletDateTimeLong="Long Date and Time";
ZmMsg.wikletDateTimeMedium="Medium Date and Time";
ZmMsg.wikletDateTimeShort="Short Date and Time";
ZmMsg.wikletFragment="Fragment";
ZmMsg.wikletFragmentTT="Insert page fragment";
ZmMsg.wikletIcon="Icon";
ZmMsg.wikletIconTT="Insert item icon";
ZmMsg.wikletId="ID";
ZmMsg.wikletIdTT="Insert item ID";
ZmMsg.wikletInclude="Include";
ZmMsg.wikletIncludeInherit="Inherit";
ZmMsg.wikletIncludeTT="Insert contents of another page into this one";
ZmMsg.wikletInline="Inline";
ZmMsg.wikletInlineTT="Insert contents of another page in current scope";
ZmMsg.wikletModifier="Modifier";
ZmMsg.wikletModifierTT="Insert last modifier's name";
ZmMsg.wikletModifyDate="ModifyDate";
ZmMsg.wikletModifyDateTT="Insert page modification date";
ZmMsg.wikletModifyTime="ModifyTime";
ZmMsg.wikletModifyTimeTT="Insert page modification time";
ZmMsg.wikletMsg="Message";
ZmMsg.wikletMsgTT="Insert string from message catalog";
ZmMsg.wikletName="Name";
ZmMsg.wikletNameTT="Insert current item's name";
ZmMsg.wikletParams="Wiklet Parameters";
ZmMsg.wikletPath="Path";
ZmMsg.wikletPathMakeLinks="Links";
ZmMsg.wikletPathTT="Insert path to this page";
ZmMsg.wikletTags="Tags";
ZmMsg.wikletTagsTT="Insert current items's tags";
ZmMsg.wikletTimeFull="Full Time";
ZmMsg.wikletTimeLong="Long Time";
ZmMsg.wikletTimeMedium="Medium Time";
ZmMsg.wikletTimeShort="Short Time";
ZmMsg.wikletToc="TOC";
ZmMsg.wikletTocTT="Insert table of contents";
ZmMsg.wikletUrl="URL";
ZmMsg.wikletUrlTT="Insert URL to item";
ZmMsg.wikletVersion="Version";
ZmMsg.wikletVersionTT="Insert page version";
ZmMsg.work="Work";
ZmMsg.workWeek="Work Week";
ZmMsg.wrote="wrote";
ZmMsg.xmlDocument="XML";
ZmMsg.yahoo="Yahoo!";
ZmMsg["yahoo-csv"]="Yahoo! Contacts";
ZmMsg.yahooMail="Yahoo! Mail";
ZmMsg.yearly="Yearly";
ZmMsg.yellow="Yellow";
ZmMsg.ysearchURL="http://us.search.yahoo.com";
ZmMsg.zd_docCharts="Charts";
ZmMsg.zd_docChartsTT="Click to create Charts";
ZmMsg.zd_docElements="Document Elements";
ZmMsg.zd_docElementsTT="Click to create Document Elements";
ZmMsg.zd_docQuickInsertTT="Click to insert";
ZmMsg.zd_docQuickTables="Quick Tables";
ZmMsg.zd_docQuickTablesTT="Click to create Quick Tables";
ZmMsg.zd_docSmartArt="SmartArt Graphics";
ZmMsg.zd_docSmartArtTT="Click to create SmartArt Graphics";
ZmMsg.zeroSizedAtts="Files of zero size and invalid path have been discarded.";
ZmMsg["zimbra-csv"]="Account Contacts";
ZmMsg["zimbra-ics"]="Account Calendar";
ZmMsg["zimbra-tgz"]="Account Export";
ZmMsg.zimbraAssistant="Zimbra Assistant";
ZmMsg.zimbraAssistantWelcome="Welcome to Zimbra Assistant!";
ZmMsg.zimbraExcelDocument="Spreadsheet";
ZmMsg.zimbraLabel="Zimbra:";
ZmMsg.zimbraLoginMetaDesc="Zimbra provides open source server and client software for messaging and collaboration. To find out more visit http://www.zimbra.com.";
ZmMsg.zimbraLoginTitle="Zimbra Collaboration Suite Log In";
ZmMsg.zimbraPPTDocument="Presentation";
ZmMsg.zimbraTitle="Zimbra";
ZmMsg.zimbraWordDocument="Document";
ZmMsg.zimlet="Zimlet";
ZmMsg.zimletChangeRestart="Would you like to reload the application now to apply the zimlet changes? <br>(Otherwise, the zimlet changes will appear the next time you log in.)";
ZmMsg.zimletInitError='An error occurred while initializing the zimlet "{0}". Please notify administrator.';
ZmMsg.zimletNotLoaded='The zimlet "{0}" is not yet loaded.';
ZmMsg.zimletUnknown='The zimlet "{0}" is not defined.';
ZmMsg.zimlets="Zimlets";
ZmMsg.zimletsPrefsMsg="Zimlets are add-on applications that enhance the functionality of your client. This table allows you to enable or disable individual zimlets.";
ZmMsg.zipFile="Zip File";
if(!window.AjxKeys){AjxKeys={}
}AjxKeys["button.Select.description"]="Press the button";
AjxKeys["button.Select.display"]="Enter";
AjxKeys["button.Select.keycode"]="13";
AjxKeys["button.Select.sort"]="10010";
AjxKeys["button.SubMenu.description"]="Display menu";
AjxKeys["button.SubMenu.display"]="ArrowDown";
AjxKeys["button.SubMenu.keycode"]="40";
AjxKeys["button.SubMenu.sort"]="10020;";
AjxKeys["button.description"]="Buttons";
AjxKeys["button.sort"]="10000";
AjxKeys["dialog.Cancel.description"]="Cancel changes";
AjxKeys["dialog.Cancel.display"]="Esc";
AjxKeys["dialog.Cancel.keycode"]="27";
AjxKeys["dialog.Cancel.sort"]="40020";
AjxKeys["dialog.Enter.description"]="Save changes";
AjxKeys["dialog.Enter.display"]="Enter; Space";
AjxKeys["dialog.Enter.keycode"]="13; 32";
AjxKeys["dialog.Enter.sort"]="40010";
AjxKeys["dialog.No.description"]='Respond "No"';
AjxKeys["dialog.No.display"]="N";
AjxKeys["dialog.No.keycode"]="78";
AjxKeys["dialog.No.sort"]="40040";
AjxKeys["dialog.Yes.description"]='Respond "Yes"';
AjxKeys["dialog.Yes.display"]="Y";
AjxKeys["dialog.Yes.keycode"]="89";
AjxKeys["dialog.Yes.sort"]="40030";
AjxKeys["dialog.description"]="Dialog Boxes";
AjxKeys["dialog.sort"]="40000";
AjxKeys["editor.Bold.description"]="Bold";
AjxKeys["editor.Bold.display"]="Ctrl+B";
AjxKeys["editor.Bold.keycode"]="Ctrl+66";
AjxKeys["editor.Bold.sort"]="60010";
AjxKeys["editor.CenterJustify.description"]="Align center";
AjxKeys["editor.CenterJustify.display"]="Ctrl+E";
AjxKeys["editor.CenterJustify.keycode"]="Ctrl+69";
AjxKeys["editor.CenterJustify.sort"]="60070";
AjxKeys["editor.Header1.description"]="Level 1 header";
AjxKeys["editor.Header1.display"]="Ctrl+1";
AjxKeys["editor.Header1.keycode"]="Ctrl+49";
AjxKeys["editor.Header1.sort"]="60090";
AjxKeys["editor.Header2.description"]="Level 2 header";
AjxKeys["editor.Header2.display"]="Ctrl+2";
AjxKeys["editor.Header2.keycode"]="Ctrl+50";
AjxKeys["editor.Header2.sort"]="60100";
AjxKeys["editor.Header3.description"]="Level 3 header";
AjxKeys["editor.Header3.display"]="Ctrl+3";
AjxKeys["editor.Header3.keycode"]="Ctrl+51";
AjxKeys["editor.Header3.sort"]="60110";
AjxKeys["editor.Header4.description"]="Level 4 header";
AjxKeys["editor.Header4.display"]="Ctrl+4";
AjxKeys["editor.Header4.keycode"]="Ctrl+52";
AjxKeys["editor.Header4.sort"]="60120";
AjxKeys["editor.Header5.description"]="Level 5 header";
AjxKeys["editor.Header5.display"]="Ctrl+5";
AjxKeys["editor.Header5.keycode"]="Ctrl+53";
AjxKeys["editor.Header5.sort"]="60130";
AjxKeys["editor.Header6.description"]="Level 6 header";
AjxKeys["editor.Header6.display"]="Ctrl+6";
AjxKeys["editor.Header6.keycode"]="Ctrl+54";
AjxKeys["editor.Header6.sort"]="60140";
AjxKeys["editor.Italic.description"]="Italics";
AjxKeys["editor.Italic.display"]="Ctrl+I";
AjxKeys["editor.Italic.keycode"]="Ctrl+73";
AjxKeys["editor.Italic.sort"]="60020";
AjxKeys["editor.LeftJustify.description"]="Align left";
AjxKeys["editor.LeftJustify.display"]="Ctrl+L";
AjxKeys["editor.LeftJustify.keycode"]="Ctrl+76";
AjxKeys["editor.LeftJustify.sort"]="60050";
AjxKeys["editor.RightJustify.description"]="Align right";
AjxKeys["editor.RightJustify.display"]="Ctrl+R";
AjxKeys["editor.RightJustify.keycode"]="Ctrl+82";
AjxKeys["editor.RightJustify.sort"]="60060";
AjxKeys["editor.Strikethru.description"]="Strikethrough";
AjxKeys["editor.Strikethru.display"]="Ctrl+Shift+K";
AjxKeys["editor.Strikethru.keycode"]="Ctrl+Shift+75";
AjxKeys["editor.Strikethru.sort"]="60030";
AjxKeys["editor.Underline.description"]="Underline";
AjxKeys["editor.Underline.display"]="Ctrl+U";
AjxKeys["editor.Underline.keycode"]="Ctrl+85";
AjxKeys["editor.Underline.sort"]="60040";
AjxKeys["editor.description"]="HTML Editor";
AjxKeys["editor.sort"]="60000";
AjxKeys["keys.alt.display"]="Alt";
AjxKeys["keys.alt.keycode"]="18";
AjxKeys["keys.ctrl.display"]="Ctrl";
AjxKeys["keys.ctrl.keycode"]="17";
AjxKeys["keys.meta.display"]="Meta";
AjxKeys["keys.meta.keycode.mac"]="224";
AjxKeys["keys.meta.keycode.win"]="91";
AjxKeys["keys.shift.display"]="Shift";
AjxKeys["keys.shift.keycode"]="16";
AjxKeys["list.AddNext.description"]="Add next item";
AjxKeys["list.AddNext.display"]="Shift+ArrowDown";
AjxKeys["list.AddNext.keycode"]="Shift+40";
AjxKeys["list.AddNext.repeat"]="true";
AjxKeys["list.AddNext.sort"]="30090";
AjxKeys["list.AddPrevious.description"]="Add previous item";
AjxKeys["list.AddPrevious.display"]="Shift+ArrowUp";
AjxKeys["list.AddPrevious.keycode"]="Shift+38";
AjxKeys["list.AddPrevious.repeat"]="true";
AjxKeys["list.AddPrevious.sort"]="30100";
AjxKeys["list.ContextMenu.description"]="Show right-click menu";
AjxKeys["list.ContextMenu.display"]=",; Ctrl+Enter";
AjxKeys["list.ContextMenu.display.mac"]=",; Ctrl+M";
AjxKeys["list.ContextMenu.keycode"]="188; Ctrl+13";
AjxKeys["list.ContextMenu.keycode.mac"]="188; Ctrl+77";
AjxKeys["list.ContextMenu.sort"]="30080";
AjxKeys["list.DoubleClick.description"]="Double-click";
AjxKeys["list.DoubleClick.display"]="Enter";
AjxKeys["list.DoubleClick.keycode"]="13";
AjxKeys["list.DoubleClick.sort"]="30070";
AjxKeys["list.Next.description"]="Focus next item";
AjxKeys["list.Next.display"]="Ctrl+ArrowDown";
AjxKeys["list.Next.keycode"]="Ctrl+40";
AjxKeys["list.Next.repeat"]="true";
AjxKeys["list.Next.sort"]="30110";
AjxKeys["list.Previous.description"]="Focus previous item";
AjxKeys["list.Previous.display"]="Ctrl+ArrowUp";
AjxKeys["list.Previous.keycode"]="Ctrl+38";
AjxKeys["list.Previous.repeat"]="true";
AjxKeys["list.Previous.sort"]="30120";
AjxKeys["list.SelectAll.description"]="Select all";
AjxKeys["list.SelectAll.display"]="Ctrl+A";
AjxKeys["list.SelectAll.keycode"]="Ctrl+65";
AjxKeys["list.SelectAll.sort"]="30030";
AjxKeys["list.SelectCurrent.description"]="Select/Unselect";
AjxKeys["list.SelectCurrent.display"]="Ctrl+`";
AjxKeys["list.SelectCurrent.keycode"]="Ctrl+192";
AjxKeys["list.SelectCurrent.sort"]="30060";
AjxKeys["list.SelectFirst.description"]="Select first item";
AjxKeys["list.SelectFirst.display"]="Home";
AjxKeys["list.SelectFirst.display.mac"]="Home; Meta+ArrowUp";
AjxKeys["list.SelectFirst.keycode"]="36";
AjxKeys["list.SelectFirst.keycode.mac"]="36; Meta+38";
AjxKeys["list.SelectFirst.sort"]="30040";
AjxKeys["list.SelectLast.description"]="Select last item";
AjxKeys["list.SelectLast.display"]="End";
AjxKeys["list.SelectLast.display.mac"]="End; Meta+ArrowDown";
AjxKeys["list.SelectLast.keycode"]="35";
AjxKeys["list.SelectLast.keycode.mac"]="36; Meta+40";
AjxKeys["list.SelectLast.sort"]="30050";
AjxKeys["list.SelectNext.description"]="Select next item";
AjxKeys["list.SelectNext.display"]="ArrowDown; Space; J";
AjxKeys["list.SelectNext.keycode"]="40; 32; 74";
AjxKeys["list.SelectNext.repeat"]="true";
AjxKeys["list.SelectNext.sort"]="30010";
AjxKeys["list.SelectPrevious.description"]="Select previous item";
AjxKeys["list.SelectPrevious.display"]="ArrowUp; K";
AjxKeys["list.SelectPrevious.keycode"]="38; 75";
AjxKeys["list.SelectPrevious.repeat"]="true";
AjxKeys["list.SelectPrevious.sort"]="30020";
AjxKeys["list.description"]="Lists";
AjxKeys["list.sort"]="30000";
AjxKeys["menu.Cancel.description"]="Dismiss";
AjxKeys["menu.Cancel.display"]="Esc";
AjxKeys["menu.Cancel.keycode"]="27";
AjxKeys["menu.Cancel.sort"]="20040";
AjxKeys["menu.ParentMenu.description"]="Hide sub-menu";
AjxKeys["menu.ParentMenu.display"]="ArrowLeft";
AjxKeys["menu.ParentMenu.keycode"]="37";
AjxKeys["menu.ParentMenu.sort"]="20060";
AjxKeys["menu.Select.description"]="Select";
AjxKeys["menu.Select.display"]="Enter";
AjxKeys["menu.Select.keycode"]="13";
AjxKeys["menu.Select.sort"]="20030";
AjxKeys["menu.SelectNext.description"]="Next item";
AjxKeys["menu.SelectNext.display"]="ArrowDown";
AjxKeys["menu.SelectNext.keycode"]="40";
AjxKeys["menu.SelectNext.repeat"]="true";
AjxKeys["menu.SelectNext.sort"]="20010";
AjxKeys["menu.SelectPrevious.description"]="Previous item";
AjxKeys["menu.SelectPrevious.display"]="ArrowUp";
AjxKeys["menu.SelectPrevious.keycode"]="38";
AjxKeys["menu.SelectPrevious.repeat"]="true";
AjxKeys["menu.SelectPrevious.sort"]="20020";
AjxKeys["menu.SubMenu.description"]="Show sub-menu";
AjxKeys["menu.SubMenu.display"]="ArrowRight";
AjxKeys["menu.SubMenu.keycode"]="39";
AjxKeys["menu.SubMenu.sort"]="20050";
AjxKeys["menu.description"]="Pop-up Menus";
AjxKeys["menu.sort"]="20000";
AjxKeys["tabView.GoToTab.description"]="Go to tab [n]";
AjxKeys["tabView.GoToTab.display"]="Ctrl+NNN";
AjxKeys["tabView.GoToTab.keycode"]="Ctrl+NNN";
AjxKeys["tabView.GoToTab.sort"]="110030";
AjxKeys["tabView.NextTab.description"]="Next tab";
AjxKeys["tabView.NextTab.display"]="Ctrl+J";
AjxKeys["tabView.NextTab.keycode"]="Ctrl+74";
AjxKeys["tabView.NextTab.sort"]="110010";
AjxKeys["tabView.PreviousTab.description"]="Previous tab";
AjxKeys["tabView.PreviousTab.display"]="Ctrl+K";
AjxKeys["tabView.PreviousTab.keycode"]="Ctrl+75";
AjxKeys["tabView.PreviousTab.sort"]="110020";
AjxKeys["tabView.description"]="Tab Views";
AjxKeys["tabView.sort"]="110000";
AjxKeys["toolbarHorizontal.INHERIT"]="button";
AjxKeys["toolbarHorizontal.Next.description"]="Next button";
AjxKeys["toolbarHorizontal.Next.display"]="ArrowRight";
AjxKeys["toolbarHorizontal.Next.keycode"]="39";
AjxKeys["toolbarHorizontal.Next.sort"]="50010";
AjxKeys["toolbarHorizontal.Previous.description"]="Previous button";
AjxKeys["toolbarHorizontal.Previous.display"]="ArrowLeft";
AjxKeys["toolbarHorizontal.Previous.keycode"]="37";
AjxKeys["toolbarHorizontal.Previous.sort"]="50020";
AjxKeys["toolbarHorizontal.description"]="Toolbars";
AjxKeys["toolbarHorizontal.sort"]="50000";
AjxKeys["toolbarVertical.INHERIT"]="button";
AjxKeys["toolbarVertical.Next.description"]="Next button";
AjxKeys["toolbarVertical.Next.display"]="ArrowDown";
AjxKeys["toolbarVertical.Next.keycode"]="40";
AjxKeys["toolbarVertical.Next.sort"]="51010";
AjxKeys["toolbarVertical.Previous.description"]="Previous button";
AjxKeys["toolbarVertical.Previous.display"]="ArrowUp";
AjxKeys["toolbarVertical.Previous.keycode"]="38";
AjxKeys["toolbarVertical.Previous.sort"]="51020";
AjxKeys["toolbarVertical.description"]="Vertical Toolbars";
AjxKeys["toolbarVertical.sort"]="51000";
AjxKeys["tree.Collapse.description"]="Collapse";
AjxKeys["tree.Collapse.display"]="ArrowLeft";
AjxKeys["tree.Collapse.keycode"]="37";
AjxKeys["tree.Collapse.sort"]="30540";
AjxKeys["tree.ContextMenu.description"]="Show right-click menu";
AjxKeys["tree.ContextMenu.display"]=",; Ctrl+Enter";
AjxKeys["tree.ContextMenu.display.mac"]=",; Ctrl+M";
AjxKeys["tree.ContextMenu.keycode"]="188; Ctrl+13";
AjxKeys["tree.ContextMenu.keycode.mac"]="188; Ctrl+77";
AjxKeys["tree.ContextMenu.sort"]="30550";
AjxKeys["tree.Expand.description"]="Expand";
AjxKeys["tree.Expand.display"]="ArrowRight";
AjxKeys["tree.Expand.keycode"]="39";
AjxKeys["tree.Expand.sort"]="30530";
AjxKeys["tree.Next.description"]="Next item";
AjxKeys["tree.Next.display"]="ArrowDown";
AjxKeys["tree.Next.keycode"]="40";
AjxKeys["tree.Next.repeat"]="true";
AjxKeys["tree.Next.sort"]="30510";
AjxKeys["tree.Previous.description"]="Previous item";
AjxKeys["tree.Previous.display"]="ArrowUp";
AjxKeys["tree.Previous.keycode"]="38";
AjxKeys["tree.Previous.repeat"]="true";
AjxKeys["tree.Previous.sort"]="30520";
AjxKeys["tree.description"]="Trees";
AjxKeys["tree.sort"]="30500";
if(!window.ZmKeys){ZmKeys={}
}ZmKeys["calendar.CalListView.description"]="List view";
ZmKeys["calendar.CalListView.display"]="L; 9";
ZmKeys["calendar.CalListView.keycode"]="76; 57";
ZmKeys["calendar.CalListView.sort"]="70082";
ZmKeys["calendar.Cancel.description"]="Close";
ZmKeys["calendar.Cancel.display"]="Esc";
ZmKeys["calendar.Cancel.keycode"]="27";
ZmKeys["calendar.Cancel.sort"]="70100";
ZmKeys["calendar.DayView.description"]="Day view";
ZmKeys["calendar.DayView.display"]="D; 1";
ZmKeys["calendar.DayView.keycode"]="68; 49";
ZmKeys["calendar.DayView.sort"]="70050";
ZmKeys["calendar.Edit.description"]="Edit appointment";
ZmKeys["calendar.Edit.display"]="E";
ZmKeys["calendar.Edit.keycode"]="69";
ZmKeys["calendar.Edit.sort"]="70010";
ZmKeys["calendar.INHERIT"]="global";
ZmKeys["calendar.MonthView.description"]="Month view";
ZmKeys["calendar.MonthView.display"]="M; 3";
ZmKeys["calendar.MonthView.keycode"]="77; 51";
ZmKeys["calendar.MonthView.sort"]="70080";
ZmKeys["calendar.QuickAdd.description"]="Quick appointment creation";
ZmKeys["calendar.QuickAdd.display"]="Q";
ZmKeys["calendar.QuickAdd.keycode"]="81";
ZmKeys["calendar.QuickAdd.sort"]="70020";
ZmKeys["calendar.Refresh.description"]="Refresh";
ZmKeys["calendar.Refresh.display"]="R";
ZmKeys["calendar.Refresh.keycode"]="82";
ZmKeys["calendar.Refresh.sort"]="70030";
ZmKeys["calendar.ScheduleView.description"]="Scheduling view";
ZmKeys["calendar.ScheduleView.display"]="S; 0";
ZmKeys["calendar.ScheduleView.keycode"]="83; 48";
ZmKeys["calendar.ScheduleView.sort"]="70090";
ZmKeys["calendar.Today.description"]="Go to today";
ZmKeys["calendar.Today.display"]="Y";
ZmKeys["calendar.Today.keycode"]="89";
ZmKeys["calendar.Today.sort"]="70040";
ZmKeys["calendar.WeekView.description"]="Week view";
ZmKeys["calendar.WeekView.display"]="W; 7";
ZmKeys["calendar.WeekView.keycode"]="87; 55";
ZmKeys["calendar.WeekView.sort"]="70060";
ZmKeys["calendar.WorkWeekView.description"]="Work week view";
ZmKeys["calendar.WorkWeekView.display"]="W,W; 5";
ZmKeys["calendar.WorkWeekView.keycode"]="87,87; 53";
ZmKeys["calendar.WorkWeekView.sort"]="70070";
ZmKeys["calendar.description"]="Calendar";
ZmKeys["calendar.sort"]="70000";
ZmKeys["call.CallManager.description"]="Call Manager";
ZmKeys["call.CallManager.display"]="C";
ZmKeys["call.CallManager.keycode"]="67";
ZmKeys["call.CallManager.sort"]="46050";
ZmKeys["call.INHERIT"]="global";
ZmKeys["call.Print.description"]="Print";
ZmKeys["call.Print.display"]="P";
ZmKeys["call.Print.keycode"]="80";
ZmKeys["call.Print.sort"]="46010";
ZmKeys["call.description"]="Call List View";
ZmKeys["call.sort"]="46000";
ZmKeys["compose.AddressPicker.description"]="Search for addresses";
ZmKeys["compose.AddressPicker.display"]="Ctrl+G";
ZmKeys["compose.AddressPicker.keycode"]="Ctrl+71";
ZmKeys["compose.AddressPicker.sort"]="30050";
ZmKeys["compose.Attachment.description"]="Add attachment";
ZmKeys["compose.Attachment.display"]="Ctrl+M";
ZmKeys["compose.Attachment.keycode"]="Ctrl+77";
ZmKeys["compose.Attachment.sort"]="30040";
ZmKeys["compose.Cancel.description"]="Cancel";
ZmKeys["compose.Cancel.display"]="Esc";
ZmKeys["compose.Cancel.keycode"]="27";
ZmKeys["compose.Cancel.sort"]="30020";
ZmKeys["compose.HtmlFormat.description"]="HTML/text format";
ZmKeys["compose.HtmlFormat.display"]="Ctrl+H";
ZmKeys["compose.HtmlFormat.keycode"]="Ctrl+72";
ZmKeys["compose.HtmlFormat.sort"]="30060";
ZmKeys["compose.NewWindow.description"]="Detach into new window";
ZmKeys["compose.NewWindow.display"]="Ctrl+D";
ZmKeys["compose.NewWindow.keycode"]="Ctrl+68";
ZmKeys["compose.NewWindow.sort"]="30080";
ZmKeys["compose.Save.description"]="Save draft";
ZmKeys["compose.Save.display"]="Ctrl+S";
ZmKeys["compose.Save.keycode"]="Ctrl+83";
ZmKeys["compose.Save.sort"]="30030";
ZmKeys["compose.Send.description"]="Send";
ZmKeys["compose.Send.display"]="Ctrl+Enter";
ZmKeys["compose.Send.keycode"]="Ctrl+13";
ZmKeys["compose.Send.sort"]="30010";
ZmKeys["compose.Shortcuts.description"]="Show shortcuts";
ZmKeys["compose.Shortcuts.display"]="Ctrl+Q";
ZmKeys["compose.Shortcuts.keycode"]="Ctrl+81";
ZmKeys["compose.Shortcuts.sort"]="10270";
ZmKeys["compose.Spellcheck.description"]="Spellcheck";
ZmKeys["compose.Spellcheck.display"]="Alt+X";
ZmKeys["compose.Spellcheck.display.mac"]="Ctrl+X";
ZmKeys["compose.Spellcheck.keycode"]="Alt+88";
ZmKeys["compose.Spellcheck.keycode.mac"]="Ctrl+88";
ZmKeys["compose.Spellcheck.sort"]="30070";
ZmKeys["compose.description"]="Compose";
ZmKeys["compose.sort"]="30000";
ZmKeys["contacts.Edit.description"]="Edit";
ZmKeys["contacts.Edit.display"]="E";
ZmKeys["contacts.Edit.keycode"]="69";
ZmKeys["contacts.Edit.sort"]="50010";
ZmKeys["contacts.INHERIT"]="global";
ZmKeys["contacts.PrintAll.description"]="Print address book";
ZmKeys["contacts.PrintAll.display"]="P,A";
ZmKeys["contacts.PrintAll.keycode"]="80,65";
ZmKeys["contacts.PrintAll.sort"]="50020";
ZmKeys["contacts.description"]="Address Book";
ZmKeys["contacts.sort"]="50000";
ZmKeys["conversation.INHERIT"]="mail";
ZmKeys["conversation.NextConversation.description"]="Next conversation";
ZmKeys["conversation.NextConversation.display"]="Shift+ArrowRight";
ZmKeys["conversation.NextConversation.keycode"]="Shift+39";
ZmKeys["conversation.NextConversation.sort"]="40010";
ZmKeys["conversation.PreviousConversation.description"]="Previous conversation";
ZmKeys["conversation.PreviousConversation.display"]="Shift+ArrowLeft";
ZmKeys["conversation.PreviousConversation.keycode"]="Shift+37";
ZmKeys["conversation.PreviousConversation.sort"]="40020";
ZmKeys["conversation.description"]="Conversation View";
ZmKeys["conversation.sort"]="40000";
ZmKeys["conversationList.CollapseAll.description"]="Collapse all conversations";
ZmKeys["conversationList.CollapseAll.display"]="Ctrl+O";
ZmKeys["conversationList.CollapseAll.keycode"]="Ctrl+79";
ZmKeys["conversationList.CollapseAll.sort"]="25030";
ZmKeys["conversationList.Expand.description"]="Expand/collapse conversation";
ZmKeys["conversationList.Expand.display"]="O";
ZmKeys["conversationList.Expand.keycode"]="79";
ZmKeys["conversationList.Expand.sort"]="25010";
ZmKeys["conversationList.ExpandAll.description"]="Expand all conversations";
ZmKeys["conversationList.ExpandAll.display"]="Shift+O";
ZmKeys["conversationList.ExpandAll.keycode"]="Shift+79";
ZmKeys["conversationList.ExpandAll.sort"]="25020";
ZmKeys["conversationList.FirstUnreadMsg.description"]="Select first unread message";
ZmKeys["conversationList.FirstUnreadMsg.display"]="Shift+Ctrl+[";
ZmKeys["conversationList.FirstUnreadMsg.keycode"]="Shift+Ctrl+219";
ZmKeys["conversationList.FirstUnreadMsg.sort"]="25060";
ZmKeys["conversationList.INHERIT"]="mail";
ZmKeys["conversationList.LastUnreadMsg.description"]="Select last unread message";
ZmKeys["conversationList.LastUnreadMsg.display"]="Shift+Ctrl+]";
ZmKeys["conversationList.LastUnreadMsg.keycode"]="Shift+Ctrl+221";
ZmKeys["conversationList.LastUnreadMsg.sort"]="25070";
ZmKeys["conversationList.NextUnreadMsg.description"]="Select next unread message";
ZmKeys["conversationList.NextUnreadMsg.display"]="Ctrl+]";
ZmKeys["conversationList.NextUnreadMsg.keycode"]="Ctrl+221";
ZmKeys["conversationList.NextUnreadMsg.sort"]="25050";
ZmKeys["conversationList.PreviousUnreadMsg.description"]="Select previous unread message";
ZmKeys["conversationList.PreviousUnreadMsg.display"]="Ctrl+[";
ZmKeys["conversationList.PreviousUnreadMsg.keycode"]="Ctrl+219";
ZmKeys["conversationList.PreviousUnreadMsg.sort"]="25040";
ZmKeys["conversationList.description"]="Conversation List View";
ZmKeys["conversationList.sort"]="25000";
ZmKeys["editAppointment.Cancel.description"]="Cancel";
ZmKeys["editAppointment.Cancel.display"]="Esc";
ZmKeys["editAppointment.Cancel.keycode"]="27";
ZmKeys["editAppointment.Cancel.sort"]="80020";
ZmKeys["editAppointment.HtmlFormat.description"]="HTML/text format";
ZmKeys["editAppointment.HtmlFormat.display"]="Ctrl+H";
ZmKeys["editAppointment.HtmlFormat.keycode"]="Ctrl+72";
ZmKeys["editAppointment.HtmlFormat.sort"]="80040";
ZmKeys["editAppointment.INHERIT"]="tabView";
ZmKeys["editAppointment.Save.description"]="Save";
ZmKeys["editAppointment.Save.display"]="Ctrl+S";
ZmKeys["editAppointment.Save.keycode"]="Ctrl+83";
ZmKeys["editAppointment.Save.sort"]="80010";
ZmKeys["editAppointment.Shortcuts.description"]="Show shortcuts";
ZmKeys["editAppointment.Shortcuts.display"]="Ctrl+Q";
ZmKeys["editAppointment.Shortcuts.keycode"]="Ctrl+81";
ZmKeys["editAppointment.Shortcuts.sort"]="10270";
ZmKeys["editAppointment.description"]="Edit Appointment";
ZmKeys["editAppointment.sort"]="80000";
ZmKeys["editContact.Cancel.description"]="Cancel";
ZmKeys["editContact.Cancel.display"]="Esc";
ZmKeys["editContact.Cancel.keycode"]="27";
ZmKeys["editContact.Cancel.sort"]="60020";
ZmKeys["editContact.Save.description"]="Save";
ZmKeys["editContact.Save.display"]="Ctrl+S";
ZmKeys["editContact.Save.keycode"]="Ctrl+83";
ZmKeys["editContact.Save.sort"]="60010";
ZmKeys["editContact.description"]="Edit Contact";
ZmKeys["editContact.sort"]="60000";
ZmKeys["editPage.Cancel.description"]="Cancel";
ZmKeys["editPage.Cancel.display"]="Esc";
ZmKeys["editPage.Cancel.keycode"]="27";
ZmKeys["editPage.Cancel.sort"]="100060";
ZmKeys["editPage.Save.description"]="Save";
ZmKeys["editPage.Save.display"]="Ctrl+S";
ZmKeys["editPage.Save.keycode"]="Ctrl+83";
ZmKeys["editPage.Save.sort"]="100070";
ZmKeys["editPage.Shortcuts.description"]="Show shortcuts";
ZmKeys["editPage.Shortcuts.display"]="Ctrl+Q";
ZmKeys["editPage.Shortcuts.keycode"]="Ctrl+81";
ZmKeys["editPage.Shortcuts.sort"]="10270";
ZmKeys["editPage.description"]="Edit Notebook Page";
ZmKeys["editPage.sort"]="100050";
ZmKeys["editTask.Cancel.description"]="Cancel";
ZmKeys["editTask.Cancel.display"]="Esc";
ZmKeys["editTask.Cancel.keycode"]="27";
ZmKeys["editTask.Cancel.sort"]="106020";
ZmKeys["editTask.Save.description"]="Save";
ZmKeys["editTask.Save.display"]="Ctrl+S";
ZmKeys["editTask.Save.keycode"]="Ctrl+83";
ZmKeys["editTask.Save.sort"]="106010";
ZmKeys["editTask.description"]="Edit Task";
ZmKeys["editTask.sort"]="106000";
ZmKeys["global.Assistant.description"]="Zimbra Assistant";
ZmKeys["global.Assistant.display"]="`";
ZmKeys["global.Assistant.keycode"]="192";
ZmKeys["global.Assistant.sort"]="10230";
ZmKeys["global.Cancel.description"]="Close";
ZmKeys["global.Cancel.display"]="Esc";
ZmKeys["global.Cancel.keycode"]="27";
ZmKeys["global.Cancel.sort"]="10220";
ZmKeys["global.Delete.description"]="Delete item(s)";
ZmKeys["global.Delete.display"]="Del; Backspace";
ZmKeys["global.Delete.keycode"]="8; 46";
ZmKeys["global.Delete.sort"]="10210";
ZmKeys["global.FocusContentPane.description"]="Focus content pane";
ZmKeys["global.FocusContentPane.display"]="Ctrl+/";
ZmKeys["global.FocusContentPane.keycode"]="Ctrl+191";
ZmKeys["global.FocusContentPane.sort"]="10280";
ZmKeys["global.FocusSearchBox.description"]="Focus search box";
ZmKeys["global.FocusSearchBox.display"]="/";
ZmKeys["global.FocusSearchBox.keycode"]="191";
ZmKeys["global.FocusSearchBox.sort"]="10270";
ZmKeys["global.FocusToolbar.description"]="Focus toolbar";
ZmKeys["global.FocusToolbar.display"]="Ctrl+Y";
ZmKeys["global.FocusToolbar.keycode"]="Ctrl+89";
ZmKeys["global.FocusToolbar.sort"]="10275";
ZmKeys["global.FocusWebSearchBox.description"]="Focus web search box";
ZmKeys["global.FocusWebSearchBox.display"]="Alt+/";
ZmKeys["global.FocusWebSearchBox.keycode"]="Alt+191";
ZmKeys["global.FocusWebSearchBox.sort"]="10277";
ZmKeys["global.GoToBriefcase.description"]="Go to Briefcase";
ZmKeys["global.GoToBriefcase.display"]="G,B";
ZmKeys["global.GoToBriefcase.keycode"]="71,66";
ZmKeys["global.GoToBriefcase.sort"]="10070";
ZmKeys["global.GoToCalendar.description"]="Go to Calendar";
ZmKeys["global.GoToCalendar.display"]="G,C";
ZmKeys["global.GoToCalendar.keycode"]="71,67";
ZmKeys["global.GoToCalendar.sort"]="10030";
ZmKeys["global.GoToContacts.description"]="Go to Contacts";
ZmKeys["global.GoToContacts.display"]="G,A";
ZmKeys["global.GoToContacts.keycode"]="71,65";
ZmKeys["global.GoToContacts.sort"]="10020";
ZmKeys["global.GoToMail.description"]="Go to Mail";
ZmKeys["global.GoToMail.display"]="G,M";
ZmKeys["global.GoToMail.keycode"]="71,77";
ZmKeys["global.GoToMail.sort"]="10010";
ZmKeys["global.GoToNotebook.description"]="Go to Documents";
ZmKeys["global.GoToNotebook.display"]="G,D";
ZmKeys["global.GoToNotebook.keycode"]="71,68";
ZmKeys["global.GoToNotebook.sort"]="10060";
ZmKeys["global.GoToOptions.description"]="Go to Preferences";
ZmKeys["global.GoToOptions.display"]="G,P";
ZmKeys["global.GoToOptions.keycode"]="71,80";
ZmKeys["global.GoToOptions.sort"]="10050";
ZmKeys["global.GoToTasks.description"]="Go to Tasks";
ZmKeys["global.GoToTasks.display"]="G,T";
ZmKeys["global.GoToTasks.keycode"]="71,84";
ZmKeys["global.GoToTasks.sort"]="10035";
ZmKeys["global.GoToVoice.description"]="Go to Voice";
ZmKeys["global.GoToVoice.display"]="G,V";
ZmKeys["global.GoToVoice.keycode"]="71,86";
ZmKeys["global.GoToVoice.sort"]="10015";
ZmKeys["global.Move.description"]="Move item(s)";
ZmKeys["global.Move.display"]="M; M,M";
ZmKeys["global.Move.keycode"]="77; 77,77";
ZmKeys["global.Move.sort"]="10235";
ZmKeys["global.New.description"]="New item";
ZmKeys["global.New.display"]="N";
ZmKeys["global.New.keycode"]="78";
ZmKeys["global.New.sort"]="10070";
ZmKeys["global.NewAppointment.description"]="New appointment";
ZmKeys["global.NewAppointment.display"]="N,A";
ZmKeys["global.NewAppointment.keycode"]="78,65";
ZmKeys["global.NewAppointment.sort"]="10110";
ZmKeys["global.NewCalendar.description"]="New calendar";
ZmKeys["global.NewCalendar.display"]="N,L";
ZmKeys["global.NewCalendar.keycode"]="78,76";
ZmKeys["global.NewCalendar.sort"]="10120";
ZmKeys["global.NewChat.description"]="New chat";
ZmKeys["global.NewChat.display"]="N,H";
ZmKeys["global.NewChat.keycode"]="78,72";
ZmKeys["global.NewChat.sort"]="10117";
ZmKeys["global.NewContact.description"]="New contact";
ZmKeys["global.NewContact.display"]="N,C";
ZmKeys["global.NewContact.keycode"]="78,67";
ZmKeys["global.NewContact.sort"]="10100";
ZmKeys["global.NewDocument.description"]="New document";
ZmKeys["global.NewDocument.display"]="N,D";
ZmKeys["global.NewDocument.keycode"]="78,68";
ZmKeys["global.NewDocument.sort"]="10135";
ZmKeys["global.NewFolder.description"]="New folder";
ZmKeys["global.NewFolder.display"]="N,F";
ZmKeys["global.NewFolder.keycode"]="78,70";
ZmKeys["global.NewFolder.sort"]="10150";
ZmKeys["global.NewMessage.description"]="Compose";
ZmKeys["global.NewMessage.display"]="N,M; C";
ZmKeys["global.NewMessage.keycode"]="78,77; 67";
ZmKeys["global.NewMessage.sort"]="10080";
ZmKeys["global.NewMessageWindow.description"]="Compose in new window";
ZmKeys["global.NewMessageWindow.display"]="Shift+C";
ZmKeys["global.NewMessageWindow.keycode"]="Shift+67";
ZmKeys["global.NewMessageWindow.sort"]="10090";
ZmKeys["global.NewNotebook.description"]="New notebook";
ZmKeys["global.NewNotebook.display"]="N,W";
ZmKeys["global.NewNotebook.keycode"]="78,87";
ZmKeys["global.NewNotebook.sort"]="10140";
ZmKeys["global.NewPage.description"]="New notebook page";
ZmKeys["global.NewPage.display"]="N,P";
ZmKeys["global.NewPage.keycode"]="78,80";
ZmKeys["global.NewPage.sort"]="10130";
ZmKeys["global.NewRosterItem.description"]="New buddy";
ZmKeys["global.NewRosterItem.display"]="N,B";
ZmKeys["global.NewRosterItem.keycode"]="78,66";
ZmKeys["global.NewRosterItem.sort"]="10125";
ZmKeys["global.NewTag.description"]="New tag";
ZmKeys["global.NewTag.display"]="N,T";
ZmKeys["global.NewTag.keycode"]="78,84";
ZmKeys["global.NewTag.sort"]="10160";
ZmKeys["global.NewTask.description"]="New task";
ZmKeys["global.NewTask.display"]="N,K";
ZmKeys["global.NewTask.keycode"]="78,75";
ZmKeys["global.NewTask.sort"]="10115";
ZmKeys["global.NextPage.description"]="Next page";
ZmKeys["global.NextPage.display"]="Ctrl+ArrowRight";
ZmKeys["global.NextPage.keycode"]="Ctrl+39";
ZmKeys["global.NextPage.sort"]="10170";
ZmKeys["global.PreviousPage.description"]="Previous page";
ZmKeys["global.PreviousPage.display"]="Ctrl+ArrowLeft";
ZmKeys["global.PreviousPage.keycode"]="Ctrl+37";
ZmKeys["global.PreviousPage.sort"]="10180";
ZmKeys["global.Print.description"]="Print";
ZmKeys["global.Print.display"]="P";
ZmKeys["global.Print.keycode"]="80";
ZmKeys["global.Print.sort"]="10190";
ZmKeys["global.SavedSearch.description"]="Run a saved search";
ZmKeys["global.SavedSearch.display"]="S";
ZmKeys["global.SavedSearch.keycode"]="83";
ZmKeys["global.SavedSearch.sort"]="10260";
ZmKeys["global.SelectAll.description"]="Select all search results";
ZmKeys["global.SelectAll.display"]="Ctrl+Shift+A";
ZmKeys["global.SelectAll.keycode"]="Ctrl+Shift+65";
ZmKeys["global.SelectAll.sort"]="10270";
ZmKeys["global.Shortcuts.description"]="Show shortcuts";
ZmKeys["global.Shortcuts.display"]="Ctrl+Q;Shift+/";
ZmKeys["global.Shortcuts.keycode"]="Ctrl+81;Shift+191";
ZmKeys["global.Shortcuts.sort"]="10270";
ZmKeys["global.Tag.description"]="Tag item(s)";
ZmKeys["global.Tag.display"]="T";
ZmKeys["global.Tag.keycode"]="84";
ZmKeys["global.Tag.sort"]="10250";
ZmKeys["global.Untag.description"]="Remove tags";
ZmKeys["global.Untag.display"]="U";
ZmKeys["global.Untag.keycode"]="85";
ZmKeys["global.Untag.sort"]="10255";
ZmKeys["global.Visit.description"]="Go to (visit) folder";
ZmKeys["global.Visit.display"]="V";
ZmKeys["global.Visit.keycode"]="86";
ZmKeys["global.Visit.sort"]="10233";
ZmKeys["global.VisitTag.description"]="Go to (visit) tag";
ZmKeys["global.VisitTag.display"]="V,V";
ZmKeys["global.VisitTag.keycode"]="86,86";
ZmKeys["global.VisitTag.sort"]="10234";
ZmKeys["global.description"]="All Applications";
ZmKeys["global.sort"]="10000";
ZmKeys["mail.DoubleClick.description"]="Open message";
ZmKeys["mail.DoubleClick.display"]="Enter";
ZmKeys["mail.DoubleClick.keycode"]="13";
ZmKeys["mail.DoubleClick.sort"]="20060";
ZmKeys["mail.FirstUnread.description"]="First unread";
ZmKeys["mail.FirstUnread.display"]="Shift+[";
ZmKeys["mail.FirstUnread.keycode"]="Shift+219";
ZmKeys["mail.FirstUnread.sort"]="20194";
ZmKeys["mail.Flag.description"]="Flag/Unflag messages";
ZmKeys["mail.Flag.display"]="M,F";
ZmKeys["mail.Flag.keycode"]="77,70";
ZmKeys["mail.Flag.sort"]="20090";
ZmKeys["mail.Forward.description"]="Forward message";
ZmKeys["mail.Forward.display"]="F";
ZmKeys["mail.Forward.keycode"]="70";
ZmKeys["mail.Forward.sort"]="20170";
ZmKeys["mail.GetMail.description"]="Get Mail";
ZmKeys["mail.GetMail.display"]="=";
ZmKeys["mail.GetMail.keycode"]="61; 187";
ZmKeys["mail.GetMail.sort"]="20005";
ZmKeys["mail.GoToDrafts.description"]="Drafts";
ZmKeys["mail.GoToDrafts.display"]="V,D";
ZmKeys["mail.GoToDrafts.keycode"]="86,68";
ZmKeys["mail.GoToDrafts.sort"]="20020";
ZmKeys["mail.GoToInbox.description"]="Inbox";
ZmKeys["mail.GoToInbox.display"]="I; V,I";
ZmKeys["mail.GoToInbox.keycode"]="73; 86,73";
ZmKeys["mail.GoToInbox.sort"]="20010";
ZmKeys["mail.GoToJunk.description"]="Junk";
ZmKeys["mail.GoToJunk.display"]="V,J";
ZmKeys["mail.GoToJunk.keycode"]="86,74";
ZmKeys["mail.GoToJunk.sort"]="20025";
ZmKeys["mail.GoToSent.description"]="Sent";
ZmKeys["mail.GoToSent.display"]="V,S";
ZmKeys["mail.GoToSent.keycode"]="86,83";
ZmKeys["mail.GoToSent.sort"]="20030";
ZmKeys["mail.GoToTrash.description"]="Trash";
ZmKeys["mail.GoToTrash.display"]="V,T";
ZmKeys["mail.GoToTrash.keycode"]="86,84";
ZmKeys["mail.GoToTrash.sort"]="20040";
ZmKeys["mail.INHERIT"]="global";
ZmKeys["mail.LastUnread.description"]="Last unread";
ZmKeys["mail.LastUnread.display"]="Shift+]";
ZmKeys["mail.LastUnread.keycode"]="Shift+221";
ZmKeys["mail.LastUnread.sort"]="20192";
ZmKeys["mail.MarkRead.description"]="Mark read";
ZmKeys["mail.MarkRead.display"]="M,R; Z";
ZmKeys["mail.MarkRead.keycode"]="77,82; 90";
ZmKeys["mail.MarkRead.sort"]="20070";
ZmKeys["mail.MarkUnread.description"]="Mark unread";
ZmKeys["mail.MarkUnread.display"]="M,U; X";
ZmKeys["mail.MarkUnread.keycode"]="77,85; 88";
ZmKeys["mail.MarkUnread.sort"]="20080";
ZmKeys["mail.MoveToInbox.description"]="Move to Inbox";
ZmKeys["mail.MoveToInbox.display"]=".,I";
ZmKeys["mail.MoveToInbox.keycode"]="190,73";
ZmKeys["mail.MoveToInbox.sort"]="20130";
ZmKeys["mail.MoveToTrash.description"]="Move to Trash";
ZmKeys["mail.MoveToTrash.display"]=".,T";
ZmKeys["mail.MoveToTrash.keycode"]="190,84";
ZmKeys["mail.MoveToTrash.sort"]="20110";
ZmKeys["mail.NextUnread.description"]="Next unread";
ZmKeys["mail.NextUnread.display"]="]";
ZmKeys["mail.NextUnread.keycode"]="221";
ZmKeys["mail.NextUnread.sort"]="20190";
ZmKeys["mail.PreviousUnread.description"]="Previous unread";
ZmKeys["mail.PreviousUnread.display"]="[";
ZmKeys["mail.PreviousUnread.keycode"]="219";
ZmKeys["mail.PreviousUnread.sort"]="20180";
ZmKeys["mail.ReadingPaneAtBottom.description"]="Reading pane at bottom";
ZmKeys["mail.ReadingPaneAtBottom.display"]="M,P,B";
ZmKeys["mail.ReadingPaneAtBottom.keycode"]="77,80,66";
ZmKeys["mail.ReadingPaneAtBottom.sort"]="20220";
ZmKeys["mail.ReadingPaneOff.description"]="Turn off reading pane";
ZmKeys["mail.ReadingPaneOff.display"]="M,P,O";
ZmKeys["mail.ReadingPaneOff.keycode"]="77,80,79";
ZmKeys["mail.ReadingPaneOff.sort"]="20226";
ZmKeys["mail.ReadingPaneOnRight.description"]="Reading pane on right";
ZmKeys["mail.ReadingPaneOnRight.display"]="M,P,R";
ZmKeys["mail.ReadingPaneOnRight.keycode"]="77,80,82";
ZmKeys["mail.ReadingPaneOnRight.sort"]="20223";
ZmKeys["mail.Reply.description"]="Reply";
ZmKeys["mail.Reply.display"]="R";
ZmKeys["mail.Reply.keycode"]="82";
ZmKeys["mail.Reply.sort"]="20150";
ZmKeys["mail.ReplyAll.description"]="Reply all";
ZmKeys["mail.ReplyAll.display"]="A";
ZmKeys["mail.ReplyAll.keycode"]="65";
ZmKeys["mail.ReplyAll.sort"]="20160";
ZmKeys["mail.SelectNext.description"]="Select next item";
ZmKeys["mail.SelectNext.display"]="Space; J";
ZmKeys["mail.SelectNext.keycode"]="32; 74";
ZmKeys["mail.SelectNext.repeat"]="true";
ZmKeys["mail.SelectNext.sort"]="20172";
ZmKeys["mail.SelectPrevious.description"]="Select previous item";
ZmKeys["mail.SelectPrevious.display"]="K";
ZmKeys["mail.SelectPrevious.keycode"]="75";
ZmKeys["mail.SelectPrevious.repeat"]="true";
ZmKeys["mail.SelectPrevious.sort"]="20174";
ZmKeys["mail.ShowFragment.description"]="Show snippet";
ZmKeys["mail.ShowFragment.display"]="Q";
ZmKeys["mail.ShowFragment.keycode"]="81";
ZmKeys["mail.ShowFragment.sort"]="20230";
ZmKeys["mail.Spam.description"]="Mark as spam";
ZmKeys["mail.Spam.display"]="M,J";
ZmKeys["mail.Spam.keycode"]="77,74";
ZmKeys["mail.Spam.sort"]="20100";
ZmKeys["mail.ViewByConversation.description"]="Conversation view";
ZmKeys["mail.ViewByConversation.display"]="V,C";
ZmKeys["mail.ViewByConversation.keycode"]="86,67";
ZmKeys["mail.ViewByConversation.sort"]="20200";
ZmKeys["mail.ViewByMessage.description"]="Message view";
ZmKeys["mail.ViewByMessage.display"]="V,M";
ZmKeys["mail.ViewByMessage.keycode"]="86,77";
ZmKeys["mail.ViewByMessage.sort"]="20210";
ZmKeys["mail.description"]="Mail";
ZmKeys["mail.sort"]="20000";
ZmKeys["message.INHERIT"]="mail";
ZmKeys["mixed.DoubleClick.display"]="O";
ZmKeys["mixed.DoubleClick.keycode"]="79";
ZmKeys["mixed.INHERIT"]="global";
ZmKeys["notebook.Edit.description"]="Edit";
ZmKeys["notebook.Edit.display"]="E";
ZmKeys["notebook.Edit.keycode"]="69";
ZmKeys["notebook.Edit.sort"]="100010";
ZmKeys["notebook.INHERIT"]="global";
ZmKeys["notebook.Refresh.description"]="Refresh";
ZmKeys["notebook.Refresh.display"]="R";
ZmKeys["notebook.Refresh.keycode"]="82";
ZmKeys["notebook.Refresh.sort"]="100020";
ZmKeys["notebook.description"]="Documents";
ZmKeys["notebook.sort"]="100000";
ZmKeys["options.INHERIT"]="global,tabView";
ZmKeys["options.Save.description"]="Save";
ZmKeys["options.Save.display"]="Ctrl+S";
ZmKeys["options.Save.keycode"]="Ctrl+83";
ZmKeys["options.Save.sort"]="90010";
ZmKeys["options.description"]="Preferences";
ZmKeys["options.sort"]="90000";
ZmKeys["tasks.INHERIT"]="global";
ZmKeys["tasks.MarkComplete.description"]="Mark completed";
ZmKeys["tasks.MarkComplete.display"]="M,C";
ZmKeys["tasks.MarkComplete.keycode"]="77,67";
ZmKeys["tasks.MarkComplete.sort"]="105010";
ZmKeys["tasks.MarkUncomplete.description"]="Mark not completed";
ZmKeys["tasks.MarkUncomplete.display"]="M,U";
ZmKeys["tasks.MarkUncomplete.keycode"]="77,85";
ZmKeys["tasks.MarkUncomplete.sort"]="105020";
ZmKeys["tasks.description"]="Tasks";
ZmKeys["tasks.sort"]="105000";
ZmKeys["voicemail.CallManager.description"]="Call Manager";
ZmKeys["voicemail.CallManager.display"]="C";
ZmKeys["voicemail.CallManager.keycode"]="67";
ZmKeys["voicemail.CallManager.sort"]="45050";
ZmKeys["voicemail.Download.description"]="Download message";
ZmKeys["voicemail.Download.display"]="S";
ZmKeys["voicemail.Download.keycode"]="83";
ZmKeys["voicemail.Download.sort"]="45045";
ZmKeys["voicemail.Forward.description"]="Forward as email";
ZmKeys["voicemail.Forward.display"]="F";
ZmKeys["voicemail.Forward.keycode"]="70";
ZmKeys["voicemail.Forward.sort"]="45030";
ZmKeys["voicemail.INHERIT"]="global";
ZmKeys["voicemail.MarkHeard.description"]="Mark heard";
ZmKeys["voicemail.MarkHeard.display"]="M,H";
ZmKeys["voicemail.MarkHeard.keycode"]="77,72";
ZmKeys["voicemail.MarkHeard.sort"]="45060";
ZmKeys["voicemail.MarkUnheard.description"]="Mark unheard";
ZmKeys["voicemail.MarkUnheard.display"]="M,U";
ZmKeys["voicemail.MarkUnheard.keycode"]="77,85";
ZmKeys["voicemail.MarkUnheard.sort"]="45070";
ZmKeys["voicemail.Play.description"]="Play";
ZmKeys["voicemail.Play.display"]="Enter";
ZmKeys["voicemail.Play.keycode"]="13";
ZmKeys["voicemail.Play.sort"]="45005";
ZmKeys["voicemail.Print.description"]="Print";
ZmKeys["voicemail.Print.display"]="P";
ZmKeys["voicemail.Print.keycode"]="80";
ZmKeys["voicemail.Print.sort"]="45010";
ZmKeys["voicemail.Reply.description"]="Reply by email";
ZmKeys["voicemail.Reply.display"]="R";
ZmKeys["voicemail.Reply.keycode"]="82";
ZmKeys["voicemail.Reply.sort"]="45020";
ZmKeys["voicemail.description"]="Voice Mail View";
ZmKeys["voicemail.sort"]="45000";



if (!window.AjxImgData) AjxImgData = {};
AjxImgData["ImgCalendarFolderOverlay"]={t:0,l:0,w:16,h:16,f:"@AppContextPath@/img/overlays/ImgCalendarFolderOverlay.png"};
AjxImgData["ImgContactsFolderOverlay"]={t:0,l:0,w:14,h:16,f:"@AppContextPath@/img/overlays/ImgContactsFolderOverlay.png"};
AjxImgData["ImgEmailedContactsOverlay"]={t:0,l:0,w:16,h:16,f:"@AppContextPath@/img/overlays/ImgEmailedContactsOverlay.png"};
AjxImgData["ImgFolderOverlay"]={t:0,l:0,w:16,h:14,f:"@AppContextPath@/img/overlays/ImgFolderOverlay.png"};
AjxImgData["ImgInboxOverlay"]={t:0,l:0,w:16,h:18,f:"@AppContextPath@/img/overlays/ImgInboxOverlay.png"};
AjxImgData["ImgMailFolderOverlay"]={t:0,l:0,w:16,h:18,f:"@AppContextPath@/img/overlays/ImgMailFolderOverlay.png"};
AjxImgData["ImgNotebookOverlay"]={t:0,l:0,w:16,h:15,f:"@AppContextPath@/img/overlays/ImgNotebookOverlay.png"};
AjxImgData["ImgRSSOverlay"]={t:0,l:0,w:16,h:16,f:"@AppContextPath@/img/overlays/ImgRSSOverlay.png"};
AjxImgData["ImgSectionOverlay"]={t:0,l:0,w:16,h:16,f:"@AppContextPath@/img/overlays/ImgSectionOverlay.png"};
AjxImgData["ImgSentFolderOverlay"]={t:0,l:0,w:16,h:18,f:"@AppContextPath@/img/overlays/ImgSentFolderOverlay.png"};
AjxImgData["ImgSharedCalendarFolderOverlay"]={t:0,l:0,w:16,h:15,f:"@AppContextPath@/img/overlays/ImgSharedCalendarFolderOverlay.png"};
AjxImgData["ImgSharedContactsFolderOverlay"]={t:0,l:0,w:16,h:17,f:"@AppContextPath@/img/overlays/ImgSharedContactsFolderOverlay.png"};
AjxImgData["ImgSharedMailFolderOverlay"]={t:0,l:0,w:16,h:17,f:"@AppContextPath@/img/overlays/ImgSharedMailFolderOverlay.png"};
AjxImgData["ImgSharedNotebookOverlay"]={t:0,l:0,w:16,h:16,f:"@AppContextPath@/img/overlays/ImgSharedNotebookOverlay.png"};
AjxImgData["ImgSharedSectionOverlay"]={t:0,l:0,w:16,h:16,f:"@AppContextPath@/img/overlays/ImgSharedSectionOverlay.png"};
AjxImgData["ImgSharedTaskListOverlay"]={t:0,l:0,w:16,h:18,f:"@AppContextPath@/img/overlays/ImgSharedTaskListOverlay.png"};
AjxImgData["ImgTagOverlay"]={t:0,l:0,w:16,h:16,f:"@AppContextPath@/img/overlays/ImgTagOverlay.png"};
AjxImgData["ImgTaskListOverlay"]={t:0,l:0,w:16,h:16,f:"@AppContextPath@/img/overlays/ImgTaskListOverlay.png"};
AjxImgData["ImgNotebookMask"]={t:-80,l:0,w:16,h:16,f:"@AppContextPath@/img/notes.gif"};
AjxImgData["ImgSectionMask"]={t:-128,l:0,w:16,h:16,f:"@AppContextPath@/img/notes.gif"};
AjxImgData["ImgSharedNotebookMask"]={t:-160,l:0,w:16,h:16,f:"@AppContextPath@/img/notes.gif"};
AjxImgData["ImgSharedSectionMask"]={t:-208,l:0,w:16,h:16,f:"@AppContextPath@/img/notes.gif"};
AjxImgData["ImgMailFolderMask"]={t:0,l:0,w:16,h:18,f:"@AppContextPath@/img/mail.gif"};
AjxImgData["ImgRSSMask"]={t:-322,l:0,w:16,h:16,f:"@AppContextPath@/img/mail.gif"};
AjxImgData["ImgSharedTaskListMask"]={t:0,l:0,w:16,h:18,f:"@AppContextPath@/img/tasks.gif"};
AjxImgData["ImgTaskListMask"]={t:-114,l:0,w:16,h:16,f:"@AppContextPath@/img/tasks.gif"};
AjxImgData["ImgCalendarFolderMask"]={t:-96,l:0,w:16,h:16,f:"@AppContextPath@/img/calendar.gif"};
AjxImgData["ImgSharedCalendarFolderMask"]={t:-413,l:0,w:15,h:15,f:"@AppContextPath@/img/calendar.gif"};
AjxImgData["ImgSharedContactsFolderMask"]={t:0,l:0,w:16,h:17,f:"@AppContextPath@/img/contacts.gif"};
AjxImgData["ImgContactsFolderMask"]={t:-65,l:0,w:14,h:16,f:"@AppContextPath@/img/contacts.gif"};
AjxImgData["ImgEmailedContactsMask"]={t:-113,l:0,w:16,h:16,f:"@AppContextPath@/img/contacts.gif"};
AjxImgData["ImgInboxMask"]={t:0,l:0,w:16,h:18,f:"@AppContextPath@/img/startup.gif"};
AjxImgData["ImgSentFolderMask"]={t:-18,l:0,w:16,h:18,f:"@AppContextPath@/img/startup.gif"};
AjxImgData["ImgSharedMailFolderMask"]={t:-36,l:0,w:16,h:17,f:"@AppContextPath@/img/startup.gif"};
AjxImgData["ImgTagMask"]={t:-1493,l:0,w:16,h:16,f:"@AppContextPath@/img/startup.gif"};
AjxImgData["ImgFolderMask"]={t:-1701,l:0,w:16,h:14,f:"@AppContextPath@/img/startup.gif"};

if (!window.AjxImgData) AjxImgData = {};

document.write("<DIV style='display:none'>");
for (var id in AjxImgData) {
	var data = AjxImgData[id];
	if (data.f) data.f = data.f.replace(/@AppContextPath@/,appContextPath);
	document.write("<IMG id='",id,"' src='",data.d||data.f,"'>");
}
document.write("</DIV>");



		function showCompanyUrl() {
			window.open(ZmMsg.splashScreenCompanyURL, '_blank');
		}
	



document.write(ZmMsg.splashScreenAppName)



document.write(ZmMsg.splashScreenLoading)



document.write(ZmMsg.splashScreenSwitch)



document.write(ZmMsg.splashScreenCopyright)



	AjxEnv=function(){};
AjxEnv._inited=false;
AjxEnv.DEFAULT_LOCALE=window.navigator.userLanguage||window.navigator.language||window.navigator.systemLanguage;
AjxEnv.reset=function(){
AjxEnv.geckoDate=0;
AjxEnv.mozVersion=-1;
AjxEnv.webKitVersion=-1;
AjxEnv.isMac=false;
AjxEnv.isWindows=false;
AjxEnv.isLinux=false;
AjxEnv.isNav=false;
AjxEnv.isIE=false;
AjxEnv.isNav4=false;
AjxEnv.trueNs=true;
AjxEnv.isNav6=false;
AjxEnv.isNav6up=false;
AjxEnv.isNav7=false;
AjxEnv.isIE3=false;
AjxEnv.isIE4=false;
AjxEnv.isIE4up=false;
AjxEnv.isIE5=false;
AjxEnv.isIE5_5=false;
AjxEnv.isIE5up=false;
AjxEnv.isIE5_5up=false;
AjxEnv.isIE6=false;
AjxEnv.isIE6up=false;
AjxEnv.isIE7=false;
AjxEnv.isIE7up=false;
AjxEnv.isIE8=false;
AjxEnv.isIE8up=false;
AjxEnv.isNormalResolution=false;
AjxEnv.ieScaleFactor=1;
AjxEnv.isFirefox=false;
AjxEnv.isFirefox1up=false;
AjxEnv.isFirefox1_5up=false;
AjxEnv.isFirefox3up=false;
AjxEnv.isMozilla=false;
AjxEnv.isMozilla1_4up=false;
AjxEnv.isSafari=false;
AjxEnv.isSafari2=false;
AjxEnv.isSafari3=false;
AjxEnv.isSafari4=false;
AjxEnv.isSafari3up=false;
AjxEnv.isCamino=false;
AjxEnv.isChrome=false;
AjxEnv.isGeckoBased=false;
AjxEnv.isWebKitBased=false;
AjxEnv.isOpera=false;
AjxEnv.useTransparentPNGs=false;
AjxEnv.is800x600orLower=screen&&(screen.width<=800&&screen.height<=600);
AjxEnv.is1024x768orLower=screen&&(screen.width<=1024&&screen.height<=768)
};
AjxEnv.parseUA=function(){
AjxEnv.reset();
var n=navigator.userAgent.toLowerCase();
var t=n.split(" ");
var c=false;
var o=false;
var r=false;
var e=false;
var a=false;
if(t!=null){
var u;
var l=-1;
if((l=t[0].search(/^\s*mozilla\//))!=-1){
e=true;
AjxEnv.browserVersion=parseFloat(t[0].substring(l+8));
AjxEnv.isNav=true
}
var s;
for(var h=0;
h<t.length;
++h){
s=t[h];
if(s.indexOf("compatible")!=-1){
a=true;
AjxEnv.isNav=false
}else{
if((s.indexOf("opera"))!=-1){
AjxEnv.isOpera=true;
AjxEnv.isNav=false;
u=parseFloat(t[h+1])
}else{
if((s.indexOf("spoofer"))!=-1){
c=true;
AjxEnv.isNav=false
}else{
if((s.indexOf("webtv"))!=-1){
o=true;
AjxEnv.isNav=false
}else{
if((s.indexOf("hotjava"))!=-1){
r=true;
AjxEnv.isNav=false
}else{
if((l=s.indexOf("msie"))!=-1){
AjxEnv.isIE=true;
u=parseFloat(t[h+1])
}else{
if((l=s.indexOf("gecko/"))!=-1){
AjxEnv.isGeckoBased=true;
AjxEnv.geckoDate=parseFloat(s.substr(l+6))
}else{
if((l=s.indexOf("applewebkit/"))!=-1){
AjxEnv.isWebKitBased=true;
AjxEnv.webKitVersion=parseFloat(s.substr(l+12))
}else{
if((l=s.indexOf("rv:"))!=-1){
AjxEnv.mozVersion=parseFloat(s.substr(l+3));
u=AjxEnv.mozVersion
}else{
if((l=s.indexOf("firefox/"))!=-1){
AjxEnv.isFirefox=true;
u=parseFloat(s.substr(l+8))
}else{
if((l=s.indexOf("prism"))!=-1){
AjxEnv.isPrism=true
}else{
if((l=s.indexOf("camino/"))!=-1){
AjxEnv.isCamino=true;
u=parseFloat(s.substr(l+7))
}else{
if((l=s.indexOf("netscape6/"))!=-1){
AjxEnv.trueNs=true;
u=parseFloat(s.substr(l+10))
}else{
if((l=s.indexOf("netscape/"))!=-1){
AjxEnv.trueNs=true;
u=parseFloat(s.substr(l+9))
}else{
if((l=s.indexOf("safari/"))!=-1){
AjxEnv.isSafari=true
}else{
if((l=s.indexOf("chrome/"))!=-1){
AjxEnv.isChrome=true;
u=parseFloat(s.substr(l+7))
}else{
if(l=s.indexOf("version/")!=-1){
u=parseFloat(s.substr(l+7))
}else{
if(s.indexOf("windows")!=-1){
AjxEnv.isWindows=true
}else{
if((s.indexOf("macintosh")!=-1)||(s.indexOf("mac_")!=-1)){
AjxEnv.isMac=true
}else{
if(s.indexOf("linux")!=-1){
AjxEnv.isLinux=true
}}}}}}}}}}}}}}}}}}}}}
AjxEnv.isNav=(e&&!c&&!a&&!AjxEnv.isOpera&&!o&&!r&&!AjxEnv.isSafari);
AjxEnv.isIE=(AjxEnv.isIE&&!AjxEnv.isOpera);
AjxEnv.isNav4=(AjxEnv.isNav&&(u==4)&&(!AjxEnv.isIE));
AjxEnv.isNav6=(AjxEnv.isNav&&AjxEnv.trueNs&&(u>=6&&u<7));
AjxEnv.isNav6up=(AjxEnv.isNav&&AjxEnv.trueNs&&(u>=6));
AjxEnv.isNav7=(AjxEnv.isNav&&AjxEnv.trueNs&&(u>=7&&u<8));
AjxEnv.isIE3=(AjxEnv.isIE&&u<4);
AjxEnv.isIE4=(AjxEnv.isIE&&u>=4&&u<5);
AjxEnv.isIE4up=(AjxEnv.isIE&&u>=4);
AjxEnv.isIE5=(AjxEnv.isIE&&u>=5&&u<6);
AjxEnv.isIE5_5=(AjxEnv.isIE&&u==5.5);
AjxEnv.isIE5up=(AjxEnv.isIE&&u>=5);
AjxEnv.isIE5_5up=(AjxEnv.isIE&&u>=5.5);
AjxEnv.isIE6=(AjxEnv.isIE&&u>=6&&u<7);
AjxEnv.isIE6up=(AjxEnv.isIE&&u>=6);
AjxEnv.isIE7=(AjxEnv.isIE&&u>=7&&u<8);
AjxEnv.isIE7up=(AjxEnv.isIE&&u>=7);
AjxEnv.isIE8=(AjxEnv.isIE&&u>=8&&u<9);
AjxEnv.isIE8up=(AjxEnv.isIE&&u>=8);
AjxEnv.isMozilla=((AjxEnv.isNav&&AjxEnv.mozVersion&&AjxEnv.isGeckoBased&&(AjxEnv.geckoDate!=0)));
AjxEnv.isMozilla1_4up=(AjxEnv.isMozilla&&(AjxEnv.mozVersion>=1.4));
AjxEnv.isFirefox=((AjxEnv.isMozilla&&AjxEnv.isFirefox));
AjxEnv.isFirefox1up=(AjxEnv.isFirefox&&u>=1);
AjxEnv.isFirefox1_5up=(AjxEnv.isFirefox&&u>=1.5);
AjxEnv.isFirefox2_0up=(AjxEnv.isFirefox&&u>=2);
AjxEnv.isFirefox3up=(AjxEnv.isFirefox&&u>=3);
AjxEnv.isSafari2=(AjxEnv.isSafari&&u>=2&&u<3);
AjxEnv.isSafari3=(AjxEnv.isSafari&&u>=3&&u<4)||AjxEnv.isChrome;
AjxEnv.isSafari4=(AjxEnv.isSafari&&u>=4);
AjxEnv.isSafari3up=(AjxEnv.isSafari&&u>=3)||AjxEnv.isChrome;
AjxEnv.browser="[unknown]";
if(AjxEnv.isOpera){
AjxEnv.browser="OPERA"
}else{
if(AjxEnv.isSafari3up){
AjxEnv.browser="SAF3"
}else{
if(AjxEnv.isSafari){
AjxEnv.browser="SAF"
}else{
if(AjxEnv.isCamino){
AjxEnv.browser="CAM"
}else{
if(o){
AjxEnv.browser="WEBTV"
}else{
if(r){
AjxEnv.browser="HOTJAVA"
}else{
if(AjxEnv.isFirefox3up){
AjxEnv.browser="FF3.0"
}else{
if(AjxEnv.isFirefox2_0up){
AjxEnv.browser="FF2.0"
}else{
if(AjxEnv.isFirefox1_5up){
AjxEnv.browser="FF1.5"
}else{
if(AjxEnv.isFirefox1up){
AjxEnv.browser="FF1.0"
}else{
if(AjxEnv.isFirefox){
AjxEnv.browser="FF"
}else{
if(AjxEnv.isPrism){
AjxEnv.browser="PRISM"
}else{
if(AjxEnv.isNav7){
AjxEnv.browser="NAV7"
}else{
if(AjxEnv.isNav6){
AjxEnv.browser="NAV6"
}else{
if(AjxEnv.isNav4){
AjxEnv.browser="NAV4"
}else{
if(AjxEnv.isIE8){
AjxEnv.browser="IE8"
}else{
if(AjxEnv.isIE7){
AjxEnv.browser="IE7"
}else{
if(AjxEnv.isIE6){
AjxEnv.browser="IE6"
}else{
if(AjxEnv.isIE5){
AjxEnv.browser="IE5"
}else{
if(AjxEnv.isIE4){
AjxEnv.browser="IE4"
}else{
if(AjxEnv.isIE3){
AjxEnv.browser="IE"
}}}}}}}}}}}}}}}}}}}}}
AjxEnv.platform="[unknown]";
if(AjxEnv.isWindows){
AjxEnv.platform="Win"
}else{
if(AjxEnv.isMac){
AjxEnv.platform="Mac"
}else{
if(AjxEnv.isLinux){
AjxEnv.platform="Linux"
}}}}
if(AjxEnv.isIE){
AjxEnv.isNormalResolution=true;
AjxEnv.ieScaleFactor=screen.deviceXDPI/screen.logicalXDPI;
if(AjxEnv.ieScaleFactor>1){
AjxEnv.isNormalResolution=false
}}
AjxEnv.useTransparentPNGs=!AjxEnv.isIE&&!AjxEnv.isLinux&&!AjxEnv.isSafari;
AjxEnv._inited=!AjxEnv.isIE;
if(AjxEnv.isSafari){
var d=AjxEnv.getWebkitVersion();
AjxEnv.isSafariNightly=(d&&d.is_nightly);
AjxEnv.isSafari2=!AjxEnv.isSafari3&&!AjxEnv.isSafariNightly
}};
AjxEnv.getWebkitVersion=function(){
var t;
var o=new RegExp("\\(.*\\) AppleWebKit/(.*) \\((.*)");
var s=o.exec(navigator.userAgent);
if(s){
var e=s[1];
var n=e.split(".");
var a=(e[e.length-1]=="+");
var i=a?"+":parseInt(n[1]);
if(isNaN(i)){
i=""
}
t={
major:parseInt(n[0]),minor:i,is_nightly:a}
}
return{
major:t.major,minor:t.minor,is_nightly:t.is_nightly}
};
AjxEnv.parseUA();
AjxCallback=function(a,t,e){
if(arguments.length==0){
return
}
if(typeof arguments[0]=="function"){
this.obj=null;
this.func=arguments[0];
this.args=arguments[1]
}else{
this.obj=a;
this.func=t;
this.args=e
}};
AjxCallback.prototype.toString=function(){
return"AjxCallback"
};
AjxCallback.NOP=new AjxCallback(function(){}
);
AjxCallback.prototype.run=function(){
var e=[];
if(typeof this.args!="undefined"){
if(this.args instanceof Array){
e=arguments.length>0?e.concat(this.args):this.args
}else{
e.push(this.args)
}}
for(var t=0;
t<arguments.length;
++t){
e.push(arguments[t])
}
if(this.func){
return this.func.apply(this.obj||window,e)
}};
AjxCallback.prototype.run1=function(t){
var e=[];
if(typeof this.args!="undefined"){
if(this.args instanceof Array){
e=arguments.length>0?e.concat(this.args):this.args
}else{
e.push(this.args)
}}
if(t&&t.length){
for(var a=0;
a<t.length;
++a){
e.push(t[a])
}}
if(this.func){
return this.func.apply(this.obj||window,e)
}};
AjxCallback.simpleClosure=function(a,o){
var e=[];
for(var t=2;
t<arguments.length;
++t){
e.push(arguments[t])
}
return function(){
var s=[];
for(var n=0;
n<arguments.length;
++n){
s.push(arguments[n])
}
return a.apply(o||this,e.concat(s))
}
};
AjxCallback.returnFalse=function(){
return false
};
AjxCallback.isNull=function(e){
return e==null
};
AjxLoader=function(){};
AjxLoader.__createXHR;
if(window.XMLHttpRequest){
AjxLoader.__createXHR=function(){
return new XMLHttpRequest()
}
}else{
if(window.ActiveXObject){
(function(){
var t=["MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"];
for(var a=0;
a<t.length;
a++){
try{
new ActiveXObject(t[a]);
AjxLoader.__createXHR=function(){
return new ActiveXObject(t[a])
};
break
}
catch(o){}}}
)()
}}
AjxLoader.load=function(a){
var n=a;
if(typeof a=="string"){
n={
url:a}
}
var o=AjxLoader.__createXHR();
var i=Boolean(n.callback)?function(){
AjxLoader._response(o,n.callback)
}
:null;
var s=n.method||(n.content!=null?"POST":"GET");
if(i){
o.onreadystatechange=i
}
var t=n.async!=null?n.async:Boolean(i);
o.open(s,n.url,t,n.userName,n.password);
for(var e in n.headers){
o.setRequestHeader(e,n.headers[e])
}
o.send(n.content||"");
return o
};
AjxLoader._response=function(e,t){
if(e.readyState==4){
t.run(e)
}};
AjxPackage=function(){};
AjxPackage.METHOD_XHR_SYNC="xhr-sync";
AjxPackage.METHOD_XHR_ASYNC="xhr-async";
AjxPackage.METHOD_SCRIPT_TAG="script-tag";
AjxPackage.DEFAULT_SYNC=AjxPackage.METHOD_XHR_SYNC;
AjxPackage.DEFAULT_ASYNC=AjxEnv.isIE?AjxPackage.METHOD_XHR_ASYNC:AjxPackage.METHOD_SCRIPT_TAG;
AjxPackage._packages={};
AjxPackage._extension=".js";
AjxPackage.__depth=0;
AjxPackage.__scripts=[];
AjxPackage.__data={};
AjxPackage.setBasePath=function(e){
AjxPackage._basePath=e
};
AjxPackage.setExtension=function(e){
AjxPackage._extension=e
};
AjxPackage.setQueryString=function(e){
AjxPackage._queryString=e
};
AjxPackage.isDefined=function(e){
return Boolean(AjxPackage._packages[e])
};
AjxPackage.define=function(e){
AjxPackage.__log("DEFINE "+e,"font-weight:bold;font-style:italic");
e=AjxPackage.__package2path(e);
if(!AjxPackage._packages[e]){
AjxPackage._packages[e]=true;
return true
}
return false
};
AjxPackage.undefine=function(e){
AjxPackage.__log("UNDEFINE "+e,"font-weight:bold;font-style:italic");
e=AjxPackage.__package2path(e);
if(AjxPackage._packages[e]){
delete AjxPackage._packages[e]
}};
AjxPackage.require=function(a){
var b=a;
if(typeof a=="string"){
b={
name:a}
}
var s=b.name;
if(s instanceof Array){
if(!s.internal){
s=[].concat(s);
s.internal=true;
b.name=s
}
var x=s.shift();
if(s.length>0){
var o=new Function();
o.prototype=b;
o.prototype.constructor=o;
var n=new o();
n.name=x;
n.callback=new AjxCallback(null,AjxPackage.__requireNext,b);
AjxPackage.require(n);
return
}
b.name=x
}
var c=b.name;
var x=AjxPackage.__package2path(c);
var i=b.callback;
if(typeof i=="function"){
i=new AjxCallback(i)
}
var f=i?" (callback)":"";
var y=AjxPackage._packages[x]?" LOADED":"";
var d=AjxPackage.__scripts.length?" (async, queueing...)":"";
AjxPackage.__log(['REQUIRE "',c,'"',f,y,d].join(""));
var g=b.forceReload!=null?b.forceReload:false;
if(AjxPackage._packages[x]&&!g){
if(i){
i.run()
}
return
}
var w=b.basePath||AjxPackage._basePath||window.contextPath;
var h=b.extension||AjxPackage._extension;
var t=b.queryString||AjxPackage._queryString;
var k=[w,"/",x,h];
if(t){
k.push("?",t)
}
var m=k.join("");
var e=b.method||(b.callback?AjxPackage.DEFAULT_ASYNC:AjxPackage.DEFAULT_SYNC);
var l=e==AjxPackage.METHOD_XHR_SYNC||b.forceSync;
var r=!l;
var v={
name:x,path:m,method:e,async:r,callback:i||AjxCallback.NOP,scripts:r?[]:null};
if(l||AjxPackage.__scripts.length==0){
AjxPackage.__doLoad(v)
}else{
var p=AjxPackage.__scripts[AjxPackage.__scripts.length-1];
v.method=p.method;
v.async=p.async;
v.scripts=[];
if(i){
var u=AjxPackage.__scripts[0];
u.callback=new AjxCallback(AjxPackage.__chainCallbacks,[u.callback,i]);
v.callback=AjxCallback.NOP
}
p.scripts.push(v)
}};
AjxPackage.eval=function(text){
if(window.execScript){
window.execScript(text)
}else{
if(AjxEnv.isGeckoBased){
window.eval(text)
}else{
var e=document.createElement("SCRIPT");
var t=document.createTextNode(text);
e.appendChild(t);
var heads=document.getElementsByTagName("HEAD");
if(heads.length==0){
heads=[document.createElement("HEAD")];
document.documentElement.appendChild(heads[0])
}
heads[0].appendChild(e)
}}};
AjxPackage.__package2path=function(e){
return e.replace(/\./g,"/").replace(/\*$/,"__all__")
};
AjxPackage.__requireNext=function(t){
var e=AjxCallback.simpleClosure(AjxPackage.require,null,t);
setTimeout(e,AjxEnv.isIE?10:0)
};
AjxPackage.__doLoad=function(e){
if(e.async){
AjxPackage.__doAsyncLoad(e)
}else{
AjxPackage.__doXHR(e)
}};
AjxPackage.__doAsyncLoad=function(t,e){
AjxPackage.__data[name]=t;
if(e||AjxPackage.__scripts.length==0){
AjxPackage.__scripts.push(t);
if(t.method==AjxPackage.METHOD_SCRIPT_TAG){
AjxPackage.__doScriptTag(t)
}else{
AjxPackage.__doXHR(t)
}}else{
var a=AjxPackage.__scripts[AjxPackage.__scripts.length-1];
a.scripts.push(t)
}};
AjxPackage.__doScriptTag=function(i){
var e=document.createElement("SCRIPT");
e.type="text/javascript";
e.src=i.path;
if(AjxEnv.isIE){
var t=AjxCallback.simpleClosure(AjxPackage.__onAsyncLoadIE,null,e);
e.attachEvent("onreadystatechange",t)
}else{
var t=AjxCallback.simpleClosure(AjxPackage.__onAsyncLoad,null,i.name);
e.addEventListener("load",t,true)
}
var a=document.getElementsByTagName("HEAD");
if(!a||a.length==0){
a=[document.createElement("HEAD")];
document.documentElement.appendChild(a[0])
}
a[0].appendChild(e)
};
AjxPackage.__doXHR=function(a){
var i=a.async?new AjxCallback(null,AjxPackage.__onXHR,[a]):null;
var e={
url:a.path,userName:a.userName,password:a.password,async:a.async,callback:i};
var t=AjxLoader.load(e);
if(!a.async){
AjxPackage.__onXHR(a,t)
}};
AjxPackage.__onXHR=function(t,e){
if(e.status==200||e.status==0){
AjxPackage.__requireEval(e.responseText||"")
}else{
AjxPackage.__log("error: "+e.status,"background-color:red")
}
if(t.async){
AjxPackage.__onAsyncLoad()
}else{
AjxPackage.__onLoad(t)
}};
AjxPackage.__onAsyncLoadIE=function(e){
if(e.readyState=="loaded"){
AjxPackage.__onAsyncLoad()
}};
AjxPackage.__onAsyncLoad=function(){
var e;
while(e=AjxPackage.__scripts.pop()){
if(e.scripts.length){
AjxPackage.__scripts.push(e);
e=e.scripts.shift();
AjxPackage.__scripts.push(e);
AjxPackage.__doAsyncLoad(e,true);
return
}
AjxPackage.__onLoad(e)
}};
AjxPackage.__onLoad=function(t){
AjxPackage.define(t.name);
if(t.callback){
try{
t.callback.run()
}
catch(a){
AjxPackage.__log("error on callback: "+a,"color:red")
}}};
AjxPackage.__requireEval=function(text){
AjxPackage.__depth++;
try{
AjxPackage.eval(text)
}
catch(e){
AjxPackage.__log("error on eval: "+e,"color:red")
}
AjxPackage.__depth--
};
AjxPackage.__log=function(t,e){};
AjxPackage.__alertStack=function(r){
var e=[];
if(r){
e.push(r,"\n\n")
}
for(var s=AjxPackage.__scripts.length-1;
s>=0;
s--){
var t=AjxPackage.__scripts[s];
e.push(t.name," (",Boolean(t.callback),")","\n");
if(t.scripts){
for(var n=0;
n<t.scripts.length;
n++){
var o=t.scripts[n];
e.push("  ",o.name," (",Boolean(o.callback),")","\n")
}}}
alert(e.join(""))
};
AjxPackage.__chainCallbacks=function(t,e){
if(t){
t.run()
}
if(e){
e.run()
}};
AjxTemplate=function(){};
AjxTemplate._templates={};
AjxTemplate._stack=[];
AjxTemplate.setBasePath=function(e){
AjxTemplate._basePath=e
};
AjxTemplate.setExtension=function(e){
AjxTemplate._extension=e
};
AjxTemplate.register=function(t,a,i,e){
if(!e&&AjxTemplate._templates[t]&&AjxTemplate._templates[t].authoritative){
return
}
AjxTemplate._templates[t]={
name:t,func:a,params:i||{}
,authoritative:e}
};
AjxTemplate.getTemplate=function(e){
var t=AjxTemplate._templates[e];
return t&&t.func
};
AjxTemplate.getParams=function(e){
var t=AjxTemplate._templates[e];
return t&&t.params
};
AjxTemplate.expand=function(t,r,s){
if(!AjxTemplate._templates[t]&&AjxTemplate.compile){
var i=document.getElementById(t);
if(i){
var d=i.nodeName.toUpperCase()=="TEXTAREA";
AjxTemplate.compile(t,true,true,d?i.value:i.innerHTML)
}}
var c=AjxTemplate.__name2Package(t);
var a=t.replace(/^[^#]*#?/,"");
if(a){
t=[c,a].join("#")
}
AjxTemplate.require(c);
var h=Boolean(s);
s=s||[];
var o=AjxTemplate.getTemplate(t);
if(o){
try{
AjxTemplate._stack.push(c);
var n=AjxTemplate.getParams(t);
o(t,n,r,s)
}
catch(l){
s.push(this.__formatError(t,l))
}
finally{
AjxTemplate._stack.pop()
}}else{
s.push(this.__formatError(t,"template not found"))
}
return h?s.length:s.join("")
};
AjxTemplate.require=function(e){
AjxPackage.require({
name:AjxTemplate.__name2Package(e),basePath:AjxTemplate._basePath,extension:AjxTemplate._extension}
);
return AjxTemplate.getTemplate(e)!=null
};
AjxTemplate.setContent=function(a,e,i){
if(typeof a=="string"){
a=document.getElementById(a)
}
if(a==null){
return
}
var t=AjxTemplate.expand(e,i);
a.innerHTML=t
};
AjxTemplate.__name2Package=function(t){
var e=t.replace(/#.*$/,"");
if(t.match(/^#/)&&AjxTemplate._stack.length>0){
e=AjxTemplate._stack[AjxTemplate._stack.length-1]
}
return e
};
AjxTemplate.__formatError=function(e,t){
return"Error in template '"+e+"': "+t
};
AjxTemplate.compile=function(d,u,l,f){
var e=AjxPackage.__package2path(d);
var g=f!=null?f:AjxLoader.load(e).reponseText;
var r=[],s=0,h=true;
AjxTemplate.__RE_TEMPLATE.lastIndex=0;
var o=AjxTemplate.__RE_TEMPLATE.exec(g);
if(o){
do{
var p=AjxTemplate.__parseAttrs(o[1]);
var c=o[2];
if(p["xml:space"]!="preserve"){
c=c.replace(AjxTemplate.__RE_GT_LINESEP_LT,"><").trim()
}
var n=d;
var a=p.id;
if(a&&(a.indexOf("#")!=-1||a.match(/^\//))){
if(a.indexOf("#")==-1){
a+="#"
}
n=a.replace(/#.*$/,"").replace(/^\//,"").replace(/\//g,".");
a=a.replace(/^.*#/,"")
}
var t=a?n+"#"+a:n;
var i=AjxTemplate.__convertLines(c);
AjxTemplate.register(n,i,p,u);
if(h&&l){
AjxPackage.define(n)
}
if(h){
h=false;
AjxTemplate.register(n,i,p,u)
}}
while(o=AjxTemplate.__RE_TEMPLATE.exec(g))
}else{
if(l){
AjxPackage.define(d)
}
var i=AjxTemplate.__convertLines(g);
AjxTemplate.register(d,i,{}
,u)
}};
AjxTemplate.__RE_REPLACE=new RegExp(["\\$\\{(.+?)\\}","<\\$=(.+?)\\$>","<\\$(.+?)\\$>"].join("|"),"mg");
AjxTemplate.__RE_TEMPLATE=new RegExp("<template(.*?)>(.*?)</template>","mg");
AjxTemplate.__RE_ATTR=new RegExp("\\s*(\\S+)\\s*=\\s*('[^']*'|\"[^\"]*\")","mg");
AjxTemplate.__RE_PARAM_PART=new RegExp("([^\\(\\.]+)(\\(.*?\\))?\\.?","g");
AjxTemplate.__RE_GT_LINESEP_LT=new RegExp([">","\\s*\\n+\\s*","<"].join(""),"mg");
AjxTemplate.__convertLines=function(a){
var t=[],r=0;
t[r++]="\tvar _hasBuffer = Boolean(buffer);";
t[r++]='\tdata = (typeof data == "string" ? { id: data } : data) || {};';
t[r++]="\tbuffer = buffer || [];";
t[r++]="\tvar _i = buffer.length;";
t[r++]="\n";
AjxTemplate.__RE_REPLACE.lastIndex=0;
var e=AjxTemplate.__RE_REPLACE.exec(a);
if(e){
var o=0;
do{
var i=AjxTemplate.__RE_REPLACE.lastIndex-e[0].length;
if(o<i){
AjxTemplate.__printStringLines(t,a.substring(o,i))
}
var s=e[1];
var n=e[2];
if(s){
r=AjxTemplate.__printDataLine(t,s)
}else{
if(n){
r=AjxTemplate.__printBufferLine(t,n)
}else{
r=AjxTemplate.__printLine(t,"\t",e[3].replace(/\n/g,"\n\t"),"\n")
}}
o=AjxTemplate.__RE_REPLACE.lastIndex
}
while(e=AjxTemplate.__RE_REPLACE.exec(a));
if(o<a.length){
r=AjxTemplate.__printStringLines(t,a.substring(o))
}}else{
r=AjxTemplate.__printStringLines(t,a)
}
t[r++]="\n";
t[r++]='\treturn _hasBuffer ? buffer.length : buffer.join("");';
return new Function("name,params,data,buffer",t.join(""))
};
AjxTemplate.__parseAttrs=function(a){
var t={}
,e;
AjxTemplate.__RE_ATTR.lastIndex=0;
while(e=AjxTemplate.__RE_ATTR.exec(a)){
var i=e[2];
t[e[1]]=i.substring(1,i.length-1)
}
return t
};
AjxTemplate.__printLine=function(e,a){
var o=e.length;
for(var t=1;
t<arguments.length;
t++){
e[o++]=arguments[t]
}
return o
};
AjxTemplate.__printStringLines=function(a,r){
var l=a.length;
for(var n=1;
n<arguments.length;
n++){
var h=arguments[n];
var t=h.split("\n");
for(var o=0;
o<t.length;
o++){
var e=t[o];
l=AjxTemplate.__printStringLine(a,e,n<t.length-1?"\n":"")
}}
return l
};
AjxTemplate.__printStringLine=function(e,a){
var o=e.length;
e[o++]='\tbuffer[_i++] = "';
for(var t=1;
t<arguments.length;
t++){
o=AjxTemplate.__printEscaped(e,arguments[t])
}
e[o++]='";';
return o
};
AjxTemplate.__printDataLine=function(t,a){
var i=t.length,e;
t[i++]="\tbuffer[_i++] = data";
AjxTemplate.__RE_PARAM_PART.lastIndex=0;
while(e=AjxTemplate.__RE_PARAM_PART.exec(a)){
t[i++]='["';
t[i++]=e[1];
t[i++]='"]';
if(e[2]!=null){
t[i++]=e[2]
}}
t[i++]=";";
return i
};
AjxTemplate.__printBufferLine=function(e,a){
var o=e.length;
e[o++]="\tbuffer[_i++] = ";
for(var t=1;
t<arguments.length;
t++){
e[o++]=arguments[t]
}
e[o++]=";";
return o
};
AjxTemplate.__printEscaped=function(e,t){
var a=e.length;
e[a++]=t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace("\n","\\n").replace("\r","\\r").replace("\t","\\t");
return a
};
AjxDispatcher=function(){};
AjxDispatcher._registry={};
AjxDispatcher._package={};
AjxDispatcher._preLoad=[];
AjxDispatcher._postLoad=[];
AjxDispatcher._loadFunctionsEnabled=false;
AjxDispatcher._timedAction=null;
AjxDispatcher.addPackageLoadFunction=function(e,a){
var t=AjxDispatcher._getPackageData(e);
if(!t._loaded&&!AjxPackage.isDefined(e)){
t.callback.push(a)
}else{
AjxTimedAction.scheduleAction(new AjxTimedAction(a,a.run),0)
}};
AjxDispatcher.addPreLoadFunction=function(e){
AjxDispatcher._preLoad.push(e)
};
AjxDispatcher.addPostLoadFunction=function(e){
AjxDispatcher._postLoad.push(e)
};
AjxDispatcher.setPackageLoadFunction=AjxDispatcher.addPackageLoadFunction;
AjxDispatcher.setPreLoadFunction=AjxDispatcher.addPreLoadFunction;
AjxDispatcher.setPostLoadFunction=AjxDispatcher.addPostLoadFunction;
AjxDispatcher.enableLoadFunctions=function(e){
AjxDispatcher._loadFunctionsEnabled=e
};
AjxDispatcher.loaded=function(e){
var t=AjxDispatcher._getPackageData(e);
return(t&&t._loaded)||AjxPackage.isDefined(e)
};
AjxDispatcher.setLoaded=function(t,e){
var n=AjxDispatcher._getPackageData(t);
n._loaded=e;
if(e){
var o=n.callback||[];
for(var a=0;
a<o.length;
a++){
o[a].run()
}}};
AjxDispatcher.registerMethod=function(a,e,t){
AjxDispatcher._registry[a]={
pkg:e,callback:t}
};
AjxDispatcher.run=function(o){
if(!o){
return
}
var e,a,t,l,h;
if(typeof(o)=="string"){
e=o;
t=false;
h=false
}else{
e=o.method;
a=o.noLoad;
l=o.callback;
t=o.async!=null?o.async:Boolean(l);
h=o.preLoadOk!=null?o.preLoadOk:(l!=null)
}
var c=AjxDispatcher._registry[e];
if(!c){
AjxPackage.__log("API method '"+e+"' not found");
return
}
AjxPackage.__log("Run method: "+e);
var r=c.pkg;
var s=[];
for(var n=1;
n<arguments.length;
++n){
s.push(arguments[n])
}
if(l){
s.push(l)
}
return AjxDispatcher.require(r,t,c.callback,s,h)
};
AjxDispatcher.require=function(n,a,h,s,r){
if(!n){
return
}
if(typeof(n)=="string"){
n=[n]
}
var l=[];
for(var o=0;
o<n.length;
o++){
var t=n[o];
if(!AjxDispatcher._getPackageData(t)._loaded){
l.push(t)
}}
if(l.length==0){
return AjxDispatcher._postLoadCallback(n,false,h,s)
}else{
var e=AjxDispatcher._preLoad;
if(r&&AjxDispatcher._loadFunctionsEnabled&&e.length){
AjxPackage.__log("pre-load function");
AjxDispatcher._timedAction=new AjxCallback(null,AjxDispatcher._continueRequire,[l,a,h,s]);
for(var o=0;
o<e.length;
o++){
e[o].run()
}
window.setTimeout("AjxDispatcher._timedAction.run()",0)
}else{
return AjxDispatcher._continueRequire(l,a,h,s)
}}};
AjxDispatcher._continueRequire=function(s,e,c,r){
var l=s.join(", ");
AjxPackage.__log("------------------------------------- Loading package: "+l);
if(window.console){
console.log("------------------------------------- Loading package: "+l)
}
if(e&&c){
var o=new AjxCallback(null,AjxDispatcher._postLoadCallback,[s,true,c,r]);
AjxPackage.require({
name:s,callback:o}
)
}else{
var n=new Date();
for(var a=0;
a<s.length;
a++){
AjxPackage.require(s[a])
}
var h=new Date();
var d=h.getTime()-n.getTime();
AjxPackage.__log("LOAD TIME for "+l+": "+d);
return AjxDispatcher._postLoadCallback(s,true,c,r)
}};
AjxDispatcher._postLoadCallback=function(r,n,l,h){
for(var a=0;
a<r.length;
a++){
AjxDispatcher._getPackageData(r[a])._loaded=true
}
for(var a=0;
a<r.length;
a++){
var e=AjxDispatcher._getPackageData(r[a]);
if(n&&e.callback.length&&!e.callbackDone){
e.callbackDone=true;
AjxPackage.__log("Running post-load package function for "+r[a]);
var s=e.callback;
for(var t=0;
t<s.length;
t++){
s[t].run()
}
e.callback.length=0
}}
if(n){
var o=AjxDispatcher._postLoad;
if(AjxDispatcher._loadFunctionsEnabled&&o.length){
for(var a=0;
a<o.length;
a++){
o[a].run()
}}}
if(l){
return l.run1(h)
}};
AjxDispatcher._getPackageData=function(e){
if(!AjxDispatcher._package[e]){
AjxDispatcher._package[e]={
callback:[]}
}
return AjxDispatcher._package[e]
};
	



AjxPackage.setBasePath("/zimbra/js");
AjxPackage.setExtension("_all.js.zgz");
AjxPackage.setQueryString("v=091214175450");

AjxTemplate.setBasePath("/zimbra/templates");
AjxTemplate.setExtension(".template.js");



	AjxEnv.DEFAULT_LOCALE = "en_US";

	function switchToStandardClient() {
		document.location = appContextPath + "/?client=standard";
	}
	
	
		var enforceMinDisplay = true;
		var unsupported = (screen && (screen.width <= 800 && screen.height <= 600) && !false) || (AjxEnv.isSafari && !AjxEnv.isSafari3up);
		if (enforceMinDisplay && unsupported) {
			switchToStandardClient();
		}
	



/**
 * DO NOT EDIT! This file is generated.
 * <p>
 * Any copy of this file checked into source control is merely for
 * convenience and should not be edited in any way.
 * <p>
 * Generated at Sun Sep 26 17:55:17 PDT 2010
 */
AjxTimezoneData = {};

AjxTimezoneData.TRANSITION_YEAR = 2010;

AjxTimezoneData.TIMEZONE_RULES = [
	{ serverId: "Etc/GMT+12", clientId: "Etc/GMT+12", standard: { offset: -720, tzname: "GMT+12" } },
	{ serverId: "Pacific/Midway", clientId: "Pacific/Midway", standard: { offset: -660, tzname: "SST" } },
	{ serverId: "Pacific/Honolulu", clientId: "Pacific/Honolulu", standard: { offset: -600, tzname: "HST" } },
	{ serverId: "America/Anchorage", clientId: "America/Anchorage",
	  standard: { offset: -540, mon: 11, week: 1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 11, 7 ], tzname: "AKST" },
	  daylight: { offset: -480, mon: 3, week: 2, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 14 ], tzname: "AKDT" }
	},
	{ serverId: "America/Los_Angeles", clientId: "America/Los_Angeles",
	  standard: { offset: -480, mon: 11, week: 1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 11, 7 ], tzname: "PST" },
	  daylight: { offset: -420, mon: 3, week: 2, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 14 ], tzname: "PDT" }
	},
	{ serverId: "America/Tijuana", clientId: "America/Tijuana",
	  standard: { offset: -480, mon: 10, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "PST" },
	  daylight: { offset: -420, mon: 4, week: 1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 4, 4 ], tzname: "PDT" }
	},
	{ serverId: "America/Chihuahua", clientId: "America/Chihuahua",
	  standard: { offset: -420, mon: 10, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "MST" },
	  daylight: { offset: -360, mon: 4, week: 1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 4, 4 ], tzname: "MDT" }
	},
	{ serverId: "America/Denver", clientId: "America/Denver",
	  standard: { offset: -420, mon: 11, week: 1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 11, 7 ], tzname: "MST" },
	  daylight: { offset: -360, mon: 3, week: 2, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 14 ], tzname: "MDT" }
	},
	{ serverId: "America/Phoenix", clientId: "America/Phoenix", standard: { offset: -420, tzname: "MST" } },
	{ serverId: "America/Chicago", clientId: "America/Chicago",
	  standard: { offset: -360, mon: 11, week: 1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 11, 7 ], tzname: "CST" },
	  daylight: { offset: -300, mon: 3, week: 2, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 14 ], tzname: "CDT" }
	},
	{ serverId: "America/Guatemala", clientId: "America/Guatemala", standard: { offset: -360 } },
	{ serverId: "America/Mexico_City", clientId: "America/Mexico_City",
	  standard: { offset: -360, mon: 10, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "CST" },
	  daylight: { offset: -300, mon: 4, week: 1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 4, 4 ], tzname: "CDT" }
	},
	{ serverId: "America/Regina", clientId: "America/Regina", standard: { offset: -360, tzname: "CST" } },
	{ serverId: "America/Bogota", clientId: "America/Bogota", standard: { offset: -300 } },
	{ serverId: "America/Indiana/Indianapolis", clientId: "America/Indiana/Indianapolis",
	  standard: { offset: -300, mon: 11, week: 1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 11, 7 ], tzname: "EST" },
	  daylight: { offset: -240, mon: 3, week: 2, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 14 ], tzname: "EDT" }
	},
	{ serverId: "America/New_York", clientId: "America/New_York",
	  standard: { offset: -300, mon: 11, week: 1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 11, 7 ], tzname: "EST" },
	  daylight: { offset: -240, mon: 3, week: 2, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 14 ], tzname: "EDT" }
	},
	{ serverId: "America/Caracas", clientId: "America/Caracas", standard: { offset: -270, tzname: "VET" } },
	{ serverId: "America/Guyana", clientId: "America/Guyana", standard: { offset: -240, tzname: "GYT" } },
	{ serverId: "America/Halifax", clientId: "America/Halifax",
	  standard: { offset: -240, mon: 11, week: 1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 11, 7 ], tzname: "AST" },
	  daylight: { offset: -180, mon: 3, week: 2, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 14 ], tzname: "ADT" }
	},
	{ serverId: "America/La_Paz", clientId: "America/La_Paz", standard: { offset: -240, tzname: "BOT" } },
	{ serverId: "America/Manaus", clientId: "America/Manaus", standard: { offset: -240, tzname: "AMT" } },
	{ serverId: "America/Santiago", clientId: "America/Santiago",
	  standard: { offset: -240, mon: 3, week: 3, wkday: 1, hour: 0, min: 0, sec: 0, trans: [ 2010, 3, 21 ], tzname: "CLT" },
	  daylight: { offset: -180, mon: 10, week: 2, wkday: 1, hour: 0, min: 0, sec: 0, trans: [ 2010, 10, 10 ], tzname: "CLST" }
	},
	{ serverId: "America/St_Johns", clientId: "America/St_Johns",
	  standard: { offset: -210, mon: 11, week: 1, wkday: 1, hour: 0, min: 1, sec: 0, trans: [ 2010, 11, 7 ], tzname: "NST" },
	  daylight: { offset: -150, mon: 3, week: 2, wkday: 1, hour: 0, min: 1, sec: 0, trans: [ 2010, 3, 14 ], tzname: "NDT" }
	},
	{ serverId: "America/Argentina/Buenos_Aires", clientId: "America/Argentina/Buenos_Aires", standard: { offset: -180 } },
	{ serverId: "America/Godthab", clientId: "America/Godthab",
	  standard: { offset: -180, mon: 10, week: -1, wkday: 1, hour: 1, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "WGT" },
	  daylight: { offset: -120, mon: 3, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "WGST" }
	},
	{ serverId: "America/Montevideo", clientId: "America/Montevideo",
	  standard: { offset: -180, mon: 3, week: 2, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 14 ], tzname: "UYT" },
	  daylight: { offset: -120, mon: 10, week: 1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 10, 3 ], tzname: "UYST" }
	},
	{ serverId: "America/Sao_Paulo", clientId: "America/Sao_Paulo",
	  standard: { offset: -180, mon: 2, week: 3, wkday: 1, hour: 0, min: 0, sec: 0, trans: [ 2010, 2, 21 ], tzname: "BRT" },
	  daylight: { offset: -120, mon: 10, week: 3, wkday: 1, hour: 0, min: 0, sec: 0, trans: [ 2010, 10, 17 ], tzname: "BRST" }
	},
	{ serverId: "Atlantic/South_Georgia", clientId: "Atlantic/South_Georgia", standard: { offset: -120, tzname: "GST" } },
	{ serverId: "Atlantic/Azores", clientId: "Atlantic/Azores",
	  standard: { offset: -60, mon: 10, week: -1, wkday: 1, hour: 1, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "AZOT" },
	  daylight: { offset: 0, mon: 3, week: -1, wkday: 1, hour: 0, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "AZOST" }
	},
	{ serverId: "Atlantic/Cape_Verde", clientId: "Atlantic/Cape_Verde", standard: { offset: -60, tzname: "CVT" } },
	{ serverId: "Africa/Casablanca", clientId: "Africa/Casablanca",
	  standard: { offset: 0, mon: 8, week: 3, wkday: 6, hour: 0, min: 0, sec: 0, trans: [ 2010, 8, 20 ], tzname: "WET" },
	  daylight: { offset: 60, mon: 6, week: 1, wkday: 2, hour: 0, min: 0, sec: 0, trans: [ 2010, 6, 7 ], tzname: "WEST" }
	},
	{ serverId: "Africa/Monrovia", clientId: "Africa/Monrovia", standard: { offset: 0, tzname: "GMT" } },
	{ serverId: "Europe/London", clientId: "Europe/London",
	  standard: { offset: 0, mon: 10, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "GMT/BST" },
	  daylight: { offset: 60, mon: 3, week: -1, wkday: 1, hour: 1, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "GMT/BST" }
	},
	{ serverId: "Africa/Algiers", clientId: "Africa/Algiers", standard: { offset: 60, tzname: "CET" } },
	{ serverId: "Africa/Windhoek", clientId: "Africa/Windhoek",
	  standard: { offset: 60, mon: 4, week: 1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 4, 4 ], tzname: "WAT" },
	  daylight: { offset: 120, mon: 9, week: 1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 9, 5 ], tzname: "WAST" }
	},
	{ serverId: "Europe/Belgrade", clientId: "Europe/Belgrade",
	  standard: { offset: 60, mon: 10, week: -1, wkday: 1, hour: 3, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "CET" },
	  daylight: { offset: 120, mon: 3, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "CEST" }
	},
	{ serverId: "Europe/Berlin", clientId: "Europe/Berlin",
	  standard: { offset: 60, mon: 10, week: -1, wkday: 1, hour: 3, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "CET" },
	  daylight: { offset: 120, mon: 3, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "CEST" }
	},
	{ serverId: "Europe/Brussels", clientId: "Europe/Brussels",
	  standard: { offset: 60, mon: 10, week: -1, wkday: 1, hour: 3, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "CET" },
	  daylight: { offset: 120, mon: 3, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "CEST" }
	},
	{ serverId: "Europe/Warsaw", clientId: "Europe/Warsaw",
	  standard: { offset: 60, mon: 10, week: -1, wkday: 1, hour: 3, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "CET" },
	  daylight: { offset: 120, mon: 3, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "CEST" }
	},
	{ serverId: "Africa/Cairo", clientId: "Africa/Cairo",
	  standard: { offset: 120, mon: 8, week: 3, wkday: 5, hour: 0, min: 0, sec: 0, trans: [ 2010, 8, 19 ], tzname: "EET" },
	  daylight: { offset: 180, mon: 4, week: -1, wkday: 6, hour: 0, min: 0, sec: 0, trans: [ 2010, 4, 30 ], tzname: "EEST" }
	},
	{ serverId: "Africa/Harare", clientId: "Africa/Harare", standard: { offset: 120, tzname: "CAT" } },
	{ serverId: "Asia/Amman", clientId: "Asia/Amman",
	  standard: { offset: 120, mon: 10, week: -1, wkday: 6, hour: 1, min: 0, sec: 0, trans: [ 2010, 10, 29 ], tzname: "EET" },
	  daylight: { offset: 180, mon: 3, week: -1, wkday: 5, hour: 23, min: 59, sec: 59, trans: [ 2010, 3, 25 ], tzname: "EEST" }
	},
	{ serverId: "Asia/Beirut", clientId: "Asia/Beirut",
	  standard: { offset: 120, mon: 10, week: -1, wkday: 1, hour: 0, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "EET" },
	  daylight: { offset: 180, mon: 3, week: -1, wkday: 1, hour: 0, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "EEST" }
	},
	{ serverId: "Asia/Jerusalem", clientId: "Asia/Jerusalem",
	  standard: { offset: 120, mon: 9, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 9, 26 ], tzname: "IST" },
	  daylight: { offset: 180, mon: 3, week: -1, wkday: 6, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 26 ], tzname: "IDT" }
	},
	{ serverId: "Europe/Athens", clientId: "Europe/Athens",
	  standard: { offset: 120, mon: 10, week: -1, wkday: 1, hour: 4, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "EET" },
	  daylight: { offset: 180, mon: 3, week: -1, wkday: 1, hour: 3, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "EEST" }
	},
	{ serverId: "Europe/Helsinki", clientId: "Europe/Helsinki",
	  standard: { offset: 120, mon: 10, week: -1, wkday: 1, hour: 4, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "EET" },
	  daylight: { offset: 180, mon: 3, week: -1, wkday: 1, hour: 3, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "EEST" }
	},
	{ serverId: "Europe/Minsk", clientId: "Europe/Minsk",
	  standard: { offset: 120, mon: 10, week: -1, wkday: 1, hour: 3, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "EET" },
	  daylight: { offset: 180, mon: 3, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "EEST" }
	},
	{ serverId: "Africa/Nairobi", clientId: "Africa/Nairobi", standard: { offset: 180, tzname: "EAT" } },
	{ serverId: "Asia/Baghdad", clientId: "Asia/Baghdad", standard: { offset: 180 } },
	{ serverId: "Asia/Kuwait", clientId: "Asia/Kuwait", standard: { offset: 180, tzname: "AST" } },
	{ serverId: "Europe/Moscow", clientId: "Europe/Moscow",
	  standard: { offset: 180, mon: 10, week: -1, wkday: 1, hour: 3, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "MSK/MSD" },
	  daylight: { offset: 240, mon: 3, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "MSK/MSD" }
	},
	{ serverId: "Asia/Tehran", clientId: "Asia/Tehran",
	  standard: { offset: 210, mon: 9, week: 4, wkday: 3, hour: 0, min: 0, sec: 0, trans: [ 2010, 9, 28 ], tzname: "IRST" },
	  daylight: { offset: 270, mon: 3, week: 4, wkday: 1, hour: 0, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "IRDT" }
	},
	{ serverId: "Asia/Baku", clientId: "Asia/Baku",
	  standard: { offset: 240, mon: 10, week: -1, wkday: 1, hour: 5, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "AZT" },
	  daylight: { offset: 300, mon: 3, week: -1, wkday: 1, hour: 4, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "AZST" }
	},
	{ serverId: "Asia/Muscat", clientId: "Asia/Muscat", standard: { offset: 240, tzname: "GST" } },
	{ serverId: "Asia/Tbilisi", clientId: "Asia/Tbilisi", standard: { offset: 240, tzname: "GET" } },
	{ serverId: "Asia/Yerevan", clientId: "Asia/Yerevan",
	  standard: { offset: 240, mon: 10, week: -1, wkday: 1, hour: 3, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "AMT" },
	  daylight: { offset: 300, mon: 3, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "AMST" }
	},
	{ serverId: "Asia/Kabul", clientId: "Asia/Kabul", standard: { offset: 270, tzname: "AFT" } },
	{ serverId: "Asia/Karachi", clientId: "Asia/Karachi",
	  standard: { offset: 300, mon: 11, week: 1, wkday: 1, hour: 0, min: 0, sec: 0, trans: [ 2010, 11, 7 ], tzname: "PKT" },
	  daylight: { offset: 360, mon: 4, week: 3, wkday: 4, hour: 0, min: 0, sec: 0, trans: [ 2010, 4, 21 ], tzname: "PKST" }
	},
	{ serverId: "Asia/Tashkent", clientId: "Asia/Tashkent", standard: { offset: 300, tzname: "UZT" } },
	{ serverId: "Asia/Yekaterinburg", clientId: "Asia/Yekaterinburg",
	  standard: { offset: 300, mon: 10, week: -1, wkday: 1, hour: 3, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "YEKT" },
	  daylight: { offset: 360, mon: 3, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "YEKST" }
	},
	{ serverId: "Asia/Colombo", clientId: "Asia/Colombo", standard: { offset: 330, tzname: "IST" } },
	{ serverId: "Asia/Kolkata", clientId: "Asia/Kolkata", standard: { offset: 330, tzname: "IST" } },
	{ serverId: "Asia/Dhaka", clientId: "Asia/Dhaka", standard: { offset: 360, tzname: "BDT" } },
	{ serverId: "Asia/Novosibirsk", clientId: "Asia/Novosibirsk",
	  standard: { offset: 360, mon: 10, week: -1, wkday: 1, hour: 3, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "NOVT" },
	  daylight: { offset: 420, mon: 3, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "NOVST" }
	},
	{ serverId: "Asia/Rangoon", clientId: "Asia/Rangoon", standard: { offset: 390, tzname: "MMT" } },
	{ serverId: "Asia/Bangkok", clientId: "Asia/Bangkok", standard: { offset: 420, tzname: "ICT" } },
	{ serverId: "Asia/Krasnoyarsk", clientId: "Asia/Krasnoyarsk",
	  standard: { offset: 420, mon: 10, week: -1, wkday: 1, hour: 3, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "KRAT" },
	  daylight: { offset: 480, mon: 3, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "KRAST" }
	},
	{ serverId: "Asia/Hong_Kong", clientId: "Asia/Hong_Kong", standard: { offset: 480 } },
	{ serverId: "Asia/Irkutsk", clientId: "Asia/Irkutsk",
	  standard: { offset: 480, mon: 10, week: -1, wkday: 1, hour: 3, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "IRKT" },
	  daylight: { offset: 540, mon: 3, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "IRKST" }
	},
	{ serverId: "Asia/Kuala_Lumpur", clientId: "Asia/Kuala_Lumpur", standard: { offset: 480, tzname: "MYT" } },
	{ serverId: "Asia/Taipei", clientId: "Asia/Taipei", standard: { offset: 480 } },
	{ serverId: "Australia/Perth", clientId: "Australia/Perth", standard: { offset: 480, tzname: "WST" } },
	{ serverId: "Asia/Seoul", clientId: "Asia/Seoul", standard: { offset: 540 } },
	{ serverId: "Asia/Tokyo", clientId: "Asia/Tokyo", standard: { offset: 540 } },
	{ serverId: "Asia/Yakutsk", clientId: "Asia/Yakutsk",
	  standard: { offset: 540, mon: 10, week: -1, wkday: 1, hour: 3, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "YAKT" },
	  daylight: { offset: 600, mon: 3, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "YAKST" }
	},
	{ serverId: "Australia/Adelaide", clientId: "Australia/Adelaide",
	  standard: { offset: 570, mon: 4, week: 1, wkday: 1, hour: 3, min: 0, sec: 0, trans: [ 2010, 4, 4 ], tzname: "CST" },
	  daylight: { offset: 630, mon: 10, week: 1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 10, 3 ], tzname: "CST" }
	},
	{ serverId: "Australia/Darwin", clientId: "Australia/Darwin", standard: { offset: 570, tzname: "CST" } },
	{ serverId: "Asia/Vladivostok", clientId: "Asia/Vladivostok",
	  standard: { offset: 600, mon: 10, week: -1, wkday: 1, hour: 3, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "VLAT" },
	  daylight: { offset: 660, mon: 3, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "VLAST" }
	},
	{ serverId: "Australia/Brisbane", clientId: "Australia/Brisbane", standard: { offset: 600, tzname: "EST" } },
	{ serverId: "Australia/Hobart", clientId: "Australia/Hobart",
	  standard: { offset: 600, mon: 4, week: 1, wkday: 1, hour: 3, min: 0, sec: 0, trans: [ 2010, 4, 4 ], tzname: "EST" },
	  daylight: { offset: 660, mon: 10, week: 1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 10, 3 ], tzname: "EST" }
	},
	{ serverId: "Australia/Sydney", clientId: "Australia/Sydney",
	  standard: { offset: 600, mon: 4, week: 1, wkday: 1, hour: 3, min: 0, sec: 0, trans: [ 2010, 4, 4 ], tzname: "EST" },
	  daylight: { offset: 660, mon: 10, week: 1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 10, 3 ], tzname: "EST" }
	},
	{ serverId: "Pacific/Guam", clientId: "Pacific/Guam", standard: { offset: 600, tzname: "ChST" } },
	{ serverId: "Asia/Magadan", clientId: "Asia/Magadan",
	  standard: { offset: 660, mon: 10, week: -1, wkday: 1, hour: 3, min: 0, sec: 0, trans: [ 2010, 10, 31 ], tzname: "MAGT" },
	  daylight: { offset: 720, mon: 3, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 3, 28 ], tzname: "MAGST" }
	},
	{ serverId: "Pacific/Auckland", clientId: "Pacific/Auckland",
	  standard: { offset: 720, mon: 4, week: 1, wkday: 1, hour: 3, min: 0, sec: 0, trans: [ 2010, 4, 4 ], tzname: "NZST" },
	  daylight: { offset: 780, mon: 9, week: -1, wkday: 1, hour: 2, min: 0, sec: 0, trans: [ 2010, 9, 26 ], tzname: "NZDT" }
	},
	{ serverId: "Pacific/Fiji", clientId: "Pacific/Fiji", standard: { offset: 720 } },
	{ serverId: "Pacific/Tongatapu", clientId: "Pacific/Tongatapu", standard: { offset: 780 } }
];




/* Copyright (C) 2005-2009 Zimbra Inc. http://www.zimbra.com/ */
if(AjxPackage.define("Startup1_1")){
if(AjxPackage.define("ajax.core.AjxCore")){
AjxCore=function(){};
AjxCore._objectIds=[null];
AjxCore.assignId=function(e){
var t=AjxCore._objectIds.length;
AjxCore._objectIds[t]=e;
return t
};
AjxCore.unassignId=function(e){
AjxCore._objectIds[e]=null
};
AjxCore.objectWithId=function(e){
return AjxCore._objectIds[e]
};
AjxCore.addListener=function(a,e,t){
a=AjxCore._getEventSource(a);
var o=AjxCore._getListenerStruct(a,e,true);
o.list[o.list.length]=t
};
AjxCore.setEventHandler=function(a,e,t){
a=AjxCore._getEventSource(a);
var o=AjxCore._getListenerStruct(a,e,true);
o.single=t
};
AjxCore.removeListener=function(n,t,o){
n=AjxCore._getEventSource(n);
var s=AjxCore._getListenerStruct(n,t);
if(s){
var r=s.list;
var e=r.length;
for(var a=0;
a<e;
a++){
if(r[a]==o){
r[a]=null
}}}};
AjxCore.removeAllListeners=function(o,t){
o=AjxCore._getEventSource(o);
var n=AjxCore._getListenerStruct(o,t);
if(n){
var s=n.list;
var e=s.length;
for(var a=0;
a<e;
a++){
s[a]=null
}}
AjxCore.unassignId(n.id)
};
AjxCore.notifyListeners=function(a,e,t){
a=AjxCore._getEventSource(a);
var o=AjxCore._getListenerStruct(a,e);
if(o){
a[e](t)
}};
AjxCore._getEventSource=function(e){
if(typeof(e)=="string"){
e=document.getElementById(e)
}
return e
};
AjxCore.getListenerStruct=function(t,e){
return AjxCore._getListenerStruct(t,e)
};
AjxCore._getListenerStruct=function(a,e,t){
var o=null;
if(a[e]){
var n=a[e]._lsListenerStructId;
o=AjxCore.objectWithId(n)
}else{
if(t){
o=AjxCore._setupListener(a,e)
}}
return o
};
AjxCore._setupListener=function(a,e,n){
var o=new Object();
o.list=new Array();
o.single=null;
var n=o.id=AjxCore.assignId(o);
var t=AjxCore._createListenerClosure(n);
a[e]=t;
a[e]._lsListenerStructId=n;
return o
};
AjxCore._createListenerClosure=function(id){
var closure=function(arg1){
var listenerStruct=AjxCore.objectWithId(id);
var listenerList=listenerStruct.list;
var len=listenerList.length;
for(var i=0;
i<len;
i++){
var callback=listenerList[i];
if(callback){
if(typeof(callback)=="string"){
eval(callback)
}else{
if(callback.handleEvent){
callback.handleEvent(arg1,this)
}else{
callback(arg1,this)
}}}}
if(listenerStruct.single){
var callback=listenerStruct.single;
if(typeof(callback)=="string"){
eval(callback)
}else{
return callback.handleEvent?callback.handleEvent(arg1,this):callback(arg1,this)
}}};
return closure
};
AjxCore.addOnloadListener=function(e){
if(window.onload&&(!window.onload._lsListenerStructId)){
var t=window.onload;
window.onload=null;
AjxCore.addListener(window,"onload",t)
}
AjxCore.addListener(window,"onload",e)
};
AjxCore.addOnunloadListener=function(e){
if(window.onunload&&(!window.onunload._lsListenerStructId)){
var t=window.onunload;
window.onunload=null;
AjxCore.addListener(window,"onunload",t)
}
AjxCore.addListener(window,"onunload",e)
}
}
if(AjxPackage.define("ajax.util.AjxUtil")){
AjxUtil=function(){};
AjxUtil.FLOAT_RE=/^[+\-]?((\d+(\.\d*)?)|((\d*\.)?\d+))([eE][+\-]?\d+)?$/;
AjxUtil.NOTFLOAT_RE=/[^\d\.]/;
AjxUtil.NOTINT_RE=/[^0-9]+/;
AjxUtil.LIFETIME_FIELD=/^([0-9])+([dhms])?$/;
AjxUtil.isSpecified=function(e){
return((e!==void 0)&&(e!==null))
};
AjxUtil.isUndefined=function(e){
return(e===void 0)
};
AjxUtil.isNull=function(e){
return(e===null)
};
AjxUtil.isBoolean=function(e){
return(typeof(e)=="boolean")
};
AjxUtil.isString=function(e){
return(typeof(e)=="string")
};
AjxUtil.isNumber=function(e){
return(typeof(e)=="number")
};
AjxUtil.isObject=function(e){
return((typeof(e)=="object")&&(e!==null))
};
AjxUtil.isArray=function(e){
return AjxUtil.isInstance(e,Array)
};
AjxUtil.isFunction=function(e){
return(typeof(e)=="function")
};
AjxUtil.isDate=function(e){
return AjxUtil.isInstance(e,Date)
};
AjxUtil.isLifeTime=function(e){
return AjxUtil.LIFETIME_FIELD.test(e)
};
AjxUtil.isNumeric=function(e){
return(!isNaN(parseFloat(e))&&AjxUtil.FLOAT_RE.test(e)&&!AjxUtil.NOTFLOAT_RE.test(e))
};
AjxUtil.isLong=function(e){
return(AjxUtil.isNumeric(e)&&!AjxUtil.NOTINT_RE.test(e))
};
AjxUtil.isNonNegativeLong=function(e){
return(AjxUtil.isNumeric(e)&&AjxUtil.isLong(e)&&(parseFloat(e)>=0))
};
AjxUtil.isInt=function(e){
return(AjxUtil.isNumeric(e)&&!AjxUtil.NOTINT_RE.test(e))
};
AjxUtil.isPositiveInt=function(e){
return(AjxUtil.isNumeric(e)&&AjxUtil.isInt(e)&&(parseInt(e)>0))
};
AjxUtil.isEmpty=function(e){
return(AjxUtil.isNull(e)||AjxUtil.isUndefined(e)||(e==="")||(AjxUtil.isArray(e)&&(e.length==0)))
};
AjxUtil.IP_ADDRESS_RE=/^\d{1,3}(\.\d{1,3}){3}(\.\d{1,3}\.\d{1,3})?$/;
AjxUtil.IP_ADDRESS_WITH_PORT_RE=/^\d{1,3}(\.\d{1,3}){3}(\.\d{1,3}\.\d{1,3})?:\d{1,5}$/;
AjxUtil.SUBNET_RE=/^\d{1,3}(\.\d{1,3}){3}(\.\d{1,3}\.\d{1,3})?\/\d{1,2}$/;
AjxUtil.DOMAIN_NAME_SHORT_RE=/^[A-Za-z0-9\-]{2,}$/;
AjxUtil.DOMAIN_NAME_FULL_RE=/^[A-Za-z0-9\-]{1,}(\.[A-Za-z0-9\-]{2,}){1,}$/;
AjxUtil.HOST_NAME_RE=/^[A-Za-z0-9\-]{2,}(\.[A-Za-z0-9\-]{1,})*(\.[A-Za-z0-9\-]{2,})*$/;
AjxUtil.HOST_NAME_WITH_PORT_RE=/^[A-Za-z0-9\-]{2,}(\.[A-Za-z0-9\-]{2,})*:([0-9])+$/;
AjxUtil.EMAIL_SHORT_RE=/^[^@\s]+$/;
AjxUtil.EMAIL_FULL_RE=/^[^@\s]+@[A-Za-z0-9\-]{2,}(\.[A-Za-z0-9\-]{2,})+$/;
AjxUtil.SHORT_URL_RE=/^[A-Za-z0-9]{2,}:\/\/[A-Za-z0-9\-]+(\.[A-Za-z0-9\-]+)*(:([0-9])+)*$/;
AjxUtil.IP_SHORT_URL_RE=/^[A-Za-z0-9]{2,}:\/\/\d{1,3}(\.\d{1,3}){3}(\.\d{1,3}\.\d{1,3})?(:([0-9])+)*$/;
AjxUtil.isIpAddress=function(e){
return AjxUtil.IP_ADDR_RE.test(e)
};
AjxUtil.isDomain=function(e){
return AjxUtil.DOMAIN_RE.test(e)
};
AjxUtil.isHostName=function(e){
return AjxUtil.HOST_NAME_RE.test(e)
};
AjxUtil.isDomainName=function(t,e){
return e?AjxUtil.DOMAIN_NAME_SHORT_RE.test(t):AjxUtil.DOMAIN_NAME_FULL_RE.test(t)
};
AjxUtil.isEmailAddress=function(t,e){
return e?AjxUtil.EMAIL_SHORT_RE.test(t):AjxUtil.EMAIL_FULL_RE.test(t)
};
AjxUtil.isValidEmailNonReg=function(e){
return((e.indexOf("@")>0)&&(e.lastIndexOf("@")==e.indexOf("@"))&&(e.indexOf(".@")<0))
};
AjxUtil.SIZE_GIGABYTES="GB";
AjxUtil.SIZE_MEGABYTES="MB";
AjxUtil.SIZE_KILOBYTES="KB";
AjxUtil.SIZE_BYTES="B";
AjxUtil.formatSize=function(n,o,s){
if(o==null){
o=true
}
if(s==null){
s=20
}
var t=AjxMsg.sizeBytes;
var a=AjxMsg.SIZE_BYTES;
if(n>=1073741824){
t=AjxMsg.sizeGigaBytes;
a=AjxUtil.SIZE_GIGABYTES
}else{
if(n>=1048576){
t=AjxMsg.sizeMegaBytes;
a=AjxUtil.SIZE_MEGABYTES
}else{
if(n>1023){
t=AjxMsg.sizeKiloBytes;
a=AjxUtil.SIZE_KILOBYTES
}}}
var e=AjxUtil.formatSizeForUnits(n,a,o,s);
return AjxMessageFormat.format(AjxMsg.formatSizeAndUnits,[e,t])
};
AjxUtil.formatSizeForUnits=function(o,t,e,s){
if(t==null){
t=AjxUtil.SIZE_BYTES
}
if(e==null){
e=true
}
if(s==null){
s=20
}
switch(t){
case AjxUtil.SIZE_GIGABYTES:o/=1073741824;
break;
case AjxUtil.SIZE_MEGABYTES:o/=1048576;
break;
case AjxUtil.SIZE_KILOBYTES:o/=1024;
break
}
var n=I18nMsg.formatNumber.replace(/\..*$/,"");
n=n.replace(/,/,"");
if(!e&&s){
n=n+=".";
for(var a=0;
a<s;
a++){
n+="#"
}}
return AjxNumberFormat.format(n,o)
};
AjxUtil.parseSize=function(t,o){
if(typeof t!=_STRING_){
t=t.toString()
}
var n=parseFloat(t.replace(/^\s*/,""));
var a=/[GMK]?B$/i;
var e=a.exec(t);
if(e){
o=e[0].toUpperCase()
}
switch(o){
case AjxUtil.SIZE_GIGABYTES:n*=1073741824;
break;
case AjxUtil.SIZE_MEGABYTES:n*=1048576;
break;
case AjxUtil.SIZE_KILOBYTES:n*=1024;
break
}
return n
};
AjxUtil.isInstance=function(e,t){
return !!(e&&e.constructor&&(e.constructor===t))
};
AjxUtil.assert=function(e,t){
if(!e&&AjxUtil.onassert){
AjxUtil.onassert(t)
}};
AjxUtil.onassert=function(t){
var c=new Object();
c.message=t;
var d=new Array();
if(AjxEnv.isIE5_5up){
var o=arguments.caller;
while(o){
d[d.length]=o.callee;
o=o.caller
}}else{
try{
var o=arguments.callee.caller;
while(o){
d[d.length]=o;
if(d.length>2){
break
}
o=o.caller
}}
catch(h){}}
c.stack=d;
var r="";
var a=170;
for(var n=1;
n<d.length;
n++){
if(n>1){
r+="\n"
}
if(n<11){
var s=d[n].toString();
if(s.length>a){
s=s.substr(0,a)+"...";
s=s.replace(/\n/g,"")
}
r+=n+": "+s
}else{
r+="("+(d.length-11)+" frames follow)";
break
}}
alert("assertion:\n\n"+t+"\n\n---- Call Stack ---\n"+r);
throw c
};
AjxUtil.ELEMENT_NODE=1;
AjxUtil.TEXT_NODE=3;
AjxUtil.DOCUMENT_NODE=9;
AjxUtil.getInnerText=function(e){
if(AjxEnv.isIE){
return e.innerText
}
function t(s){
if(s){
if(s.nodeType==3){
return s.data
}
if(s.nodeType==1){
if(/^br$/i.test(s.tagName)){
return"\r\n"
}
var o="";
for(var a=s.firstChild;
a;
a=a.nextSibling){
o+=t(a)
}
return o
}}
return""
}
return t(e)
};
AjxUtil.createProxy=function(a,r){
var n;
var t=function(){};
t.prototype=a;
if(a instanceof Array){
n=new Array();
var o=a.length;
for(var e=0;
e<o;
e++){
n[e]=a[e]
}}else{
n=new t
}
if(r){
for(var s in a){
if(typeof a[s]=="object"&&a[s]!==null){
n[s]=AjxUtil.createProxy(a[s],r-1)
}}}
n._object_=a;
return n
};
AjxUtil.collapseList=function(a){
var t=[];
for(var e=0;
e<a.length;
e++){
if(a[e]){
t.push(a[e])
}}
return t
};
AjxUtil.arrayAsHash=function(r,o){
var s={};
var a=typeof o=="function"&&o;
var n=o||true;
for(var t=0;
t<r.length;
t++){
var e=r[t];
s[e]=a?a(e,s,t,r):n
}
return s
};
AjxUtil.arrayAdd=function(a,t,e){
if(e==null||e<0||e>=a.length){
a.push(t)
}else{
a.splice(e,0,t)
}};
AjxUtil.arrayRemove=function(a,t){
for(var e=0;
e<a.length;
e++){
if(a[e]==t){
a.splice(e,1);
return true
}}
return false
};
AjxUtil.indexOf=function(n,t,e){
if(n){
for(var a=0;
a<n.length;
a++){
var o=n[a];
if((e&&o===t)||(!e&&o==t)){
return a
}}}
return -1
};
AjxUtil.keys=function(t,e){
var a=[];
for(var o in t){
if(e&&!e(o,t)){
continue
}
a.push(o)
}
return a
};
AjxUtil.values=function(a,t){
var e=[];
for(var o in a){
if(t&&!t(o,a)){
continue
}
e.push(a[o])
}
return e
};
AjxUtil.map=function(o,a){
var e=new Array(o.length);
for(var t=0;
t<o.length;
t++){
e[t]=a?a(o[t]):o[t]
}
return e
};
AjxUtil.uniq=function(a){
var e={};
for(var t=0;
t<a.length;
t++){
e[a[t]]=true
}
return AjxUtil.keys(e)
};
AjxUtil.concat=function(t){
var a=[];
for(var e=0;
e<arguments.length;
e++){
a.push.apply(a,arguments[e])
}
return a
};
AjxUtil.union=function(e){
var t=[];
return AjxUtil.uniq(t.concat.apply(t,arguments))
};
AjxUtil.intersection=function(t){
var o=AjxUtil.concat.apply(this,arguments);
var e=AjxUtil.arrayAsHash(o,AjxUtil.__intersection_count);
for(var a in e){
if(e[a]==1){
delete e[a]
}}
return AjxUtil.keys(e)
};
AjxUtil.__intersection_count=function(t,a,e,o){
return a[t]!=null?a[t]+1:1
};
AjxUtil.complement=function(o,t){
var a=AjxUtil.arrayAsHash(o);
var e=AjxUtil.arrayAsHash(t);
for(var n in e){
if(n in a){
delete e[n]
}}
return AjxUtil.keys(e)
};
AjxUtil.getFirstElement=function(n,o,a,t){
for(var s=n.firstChild;
s;
s=s.nextSibling){
if(s.nodeType!=AjxUtil.ELEMENT_NODE){
continue
}
if(o&&s.nodeName!=o){
continue
}
if(a){
var e=s.getAttributeNode(a);
if(e.nodeName!=a){
continue
}
if(t&&e.nodeValue!=t){
continue
}}
return s
}
return null
};
AjxUtil.formatUrl=function(s){
s=s||{};
var a=[];
var o=0;
if(!s.relative){
var n=s.protocol||location.protocol;
if(n.indexOf(":")==-1){
n=n+":"
}
a[o++]=n;
a[o++]="//";
a[o++]=s.host||location.hostname;
var t=Number(s.port||location.port);
if(t&&((n==ZmSetting.PROTO_HTTP&&t!=ZmSetting.HTTP_DEFAULT_PORT)||(n==ZmSetting.PROTO_HTTPS&&t!=ZmSetting.HTTPS_DEFAULT_PORT))){
a[o++]=":";
a[o++]=t
}}
a[o++]=s.path||location.pathname;
var e="";
if(s.qsArgs){
e=AjxStringUtil.queryStringSet(s.qsArgs,s.qsReset)
}else{
e=s.qsReset?"":location.search
}
a[o++]=e;
return a.join("")
};
AjxUtil.byNumber=function(t,e){
return Number(t)-Number(e)
};
AjxUtil.LOG={};
AjxUtil.enableLogType=function(t,e){
if(e){
AjxUtil.LOG[t]=[];
AjxUtil.LOG[t].push("Log type: "+t)
}else{
AjxUtil.LOG[t]=null
}};
AjxUtil.log=function(e,t){
if(!AjxUtil.LOG[e]){
return
}
AjxUtil.LOG[e].push(t)
};
AjxUtil.mergeArrays=function(h,n,e){
if(!e){
e=function(u,d){
if(u>d){
return 1
}
if(u<d){
return -1
}
if(u==d){
return 0
}}
}
var c=[];
var o=h.length;
for(var t=0;
t<o;
t++){
c.push(h[t])
}
var s=[];
var a=n.length;
for(var t=0;
t<a;
t++){
s.push(n[t])
}
var r=[];
while(c.length>0&&s.length>0){
if(e(c[0],r[r.length-1])==0){
c.shift();
continue
}
if(e(s[0],r[r.length-1])==0){
s.shift();
continue
}
if(e(c[0],s[0])<0){
r.push(c.shift())
}else{
if(e(c[0],s[0])==0){
r.push(c.shift());
s.shift()
}else{
r.push(s.shift())
}}}
while(c.length>0){
if(e(c[0],r[r.length-1])==0){
c.shift();
continue
}
r.push(c.shift())
}
while(s.length>0){
if(e(s[0],r[r.length-1])==0){
s.shift();
continue
}
r.push(s.shift())
}
return r
};
AjxUtil.arraySubstract=function(h,n,e){
if(!e){
e=function(u,d){
if(u>d){
return 1
}
if(u<d){
return -1
}
if(u==d){
return 0
}}
}
var c=[];
var o=h.length;
for(var t=0;
t<o;
t++){
c.push(h[t])
}
var s=[];
var a=n.length;
for(var t=0;
t<a;
t++){
s.push(n[t])
}
s.sort(e);
c.sort(e);
var r=[];
while(c.length>0&&s.length>0){
if(e(c[0],s[0])==0){
c.shift();
s.shift();
continue
}
if(e(c[0],s[0])<0){
r.push(c.shift());
continue
}
if(e(c[0],s[0])>0){
s.shift();
continue
}}
while(c.length>0){
r.push(c.shift())
}
return r
};
AjxUtil.getHashKeys=function(a){
var t=[];
for(var e in a){
t.push(e)
}
t.sort();
return t
};
AjxUtil.arrayCompare=function(t,e){
if((!t||!e)&&(t!=e)){
return false
}
if(t.length!=e.length){
return false
}
for(var a=0;
a<t.length;
a++){
if(t[a]!=e[a]){
return false
}}
return true
};
AjxUtil.hashCompare=function(n,o){
var t=AjxUtil.getHashKeys(n);
var e=AjxUtil.getHashKeys(o);
if(!AjxUtil.arrayCompare(t,e)){
return false
}
for(var a in t){
if(n[a]!=o[a]){
return false
}}
return true
};
AjxUtil.hashCopy=function(t){
var a={};
for(var e in t){
a[e]=t[e]
}
return a
};
AjxUtil.toArray=function(e){
return(e instanceof Array)?e:(e===undefined)?[]:[e]
}
}
if(AjxPackage.define("ajax.core.AjxException")){
AjxException=function(a,t,o,e){
if(arguments.length==0){
return
}
this.msg=a;
this.code=t;
this.method=o;
this.detail=e
};
AjxException.prototype.toString=function(){
return"AjxException"
};
AjxException.prototype.dump=function(){
return"AjxException: msg="+this.msg+" code="+this.code+" method="+this.method+" detail="+this.detail
};
AjxException.INVALIDPARENT="AjxException.INVALIDPARENT";
AjxException.INVALID_OP="AjxException.INVALID_OP";
AjxException.INTERNAL_ERROR="AjxException.INTERNAL_ERROR";
AjxException.INVALID_PARAM="AjxException.INVALID_PARAM";
AjxException.UNIMPLEMENTED_METHOD="AjxException.UNIMPLEMENTED_METHOD";
AjxException.NETWORK_ERROR="AjxException.NETWORK_ERROR";
AjxException.OUT_OF_RPC_CACHE="AjxException.OUT_OF_RPC_CACHE";
AjxException.UNSUPPORTED="AjxException.UNSUPPORTED";
AjxException.UNKNOWN_ERROR="AjxException.UNKNOWN_ERROR";
AjxException.CANCELED="AjxException.CANCELED"
}
if(AjxPackage.define("ajax.util.AjxCookie")){
AjxCookie=function(){};
AjxCookie.prototype.toString=function(){
return"AjxCookie"
};
AjxCookie.getCookie=function(h,t){
var c=t+"=";
var o=c.length;
var r=h.cookie.length;
var a=h.cookie;
var s=0;
while(s<r){
var n=s+o;
if(a.substring(s,n)==c){
var e=a.indexOf(";",n);
if(e==-1){
e=a.length
}
return unescape(a.substring(n,e))
}
s=a.indexOf(" ",s)+1;
if(s==0){
break
}}
return null
};
AjxCookie.setCookie=function(r,t,o,e,s,a,n){
r.cookie=t+"="+escape(o)+((e)?"; expires="+e.toGMTString():"")+((s)?"; path="+s:"")+((a)?"; domain="+a:"")+((n)?"; secure":"")
};
AjxCookie.deleteCookie=function(o,e,a,t){
o.cookie=e+"="+((a)?"; path="+a:"")+((t)?"; domain="+t:"")+"; expires=Fri, 31 Dec 1999 23:59:59 GMT"
};
AjxCookie.areCookiesEnabled=function(o){
var e="ZM_COOKIE_TEST";
var a="Zimbra";
AjxCookie.setCookie(o,e,a);
var t=AjxCookie.getCookie(o,e);
AjxCookie.deleteCookie(o,e);
return t==a
}
}
if(AjxPackage.define("ajax.soap.AjxSoapException")){
AjxSoapException=function(a,t,o,e){
AjxException.call(this,a,t,o,e)
};
AjxSoapException.prototype.toString=function(){
return"AjxSoapException"
};
AjxSoapException.prototype=new AjxException;
AjxSoapException.prototype.constructor=AjxSoapException;
AjxSoapException.INTERNAL_ERROR="INTERNAL_ERROR";
AjxSoapException.INVALID_PDU="INVALID_PDU";
AjxSoapException.ELEMENT_EXISTS="ELEMENT_EXISTS"
}
if(AjxPackage.define("ajax.soap.AjxSoapFault")){
AjxSoapFault=function(t){
if(arguments.length==0){
return
}
var r=t.prefix;
var s=r+":Code";
var n=r+":Reason";
var a=r+":Detail";
var h=t.childNodes.length;
for(var o=0;
o<h;
o++){
var e=t.childNodes[o];
if(e.nodeName==s){
var c=e.firstChild.firstChild.nodeValue;
if(c==(r+":VersionMismatch")){
this.faultCode=AjxSoapFault.VERSION_MISMATCH
}else{
if(c==(r+":MustUnderstand")){
this.faultCode=AjxSoapFault.MUST_UNDERSTAND
}else{
if(c==(r+":DataEncodingUnknown")){
this.faultCode=AjxSoapFault.DATA_ENCODING_UNKNOWN
}else{
if(c==(r+":Sender")){
this.faultCode=AjxSoapFault.SENDER
}else{
if(c==(r+":Receiver")){
this.faultCode=AjxSoapFault.RECEIVER
}else{
this.faultCode=AjxSoapFault.UNKNOWN
}}}}}}else{
if(e.nodeName==n){
this.reason=e.firstChild.firstChild.nodeValue
}else{
if(e.nodeName==a){
this.errorCode=e.firstChild.firstChild.firstChild.nodeValue
}}}}};
AjxSoapFault.prototype.toString=function(){
return"AjxSoapFault"
};
AjxSoapFault.SENDER=-1;
AjxSoapFault.RECEIVER=-2;
AjxSoapFault.VERSION_MISMATCH=-3;
AjxSoapFault.MUST_UNDERSTAND=-4;
AjxSoapFault.DATA_ENCODING_UNKNOWN=-5;
AjxSoapFault.UNKNOWN=-6
}
if(AjxPackage.define("ajax.soap.AjxSoapDoc")){
AjxSoapDoc=function(){
this._soapURI=AjxSoapDoc._SOAP_URI
};
AjxSoapDoc.prototype.toString=function(){
return"AjxSoapDoc"
};
AjxSoapDoc._SOAP_URI="http://www.w3.org/2003/05/soap-envelope";
AjxSoapDoc._XMLNS_URI="http://www.w3.org/2000/xmlns";
AjxSoapDoc.create=function(e,a,h,r){
var s=new AjxSoapDoc();
s._xmlDoc=AjxXmlDoc.create();
var n=s._xmlDoc.getDoc();
if(!r){
r=AjxSoapDoc._SOAP_URI
}
s._soapURI=r;
var t=n.createElementNS&&!AjxEnv.isSafari;
var o=t?n.createElementNS(r,"soap:Envelope"):n.createElement("soap:Envelope");
if(!t){
o.setAttribute("xmlns:soap",r)
}
n.appendChild(o);
var c=t?n.createElementNS(r,"soap:Body"):n.createElement("soap:Body");
o.appendChild(c);
s._methodEl=a&&t?n.createElementNS(a,e):n.createElement(e);
if(a!=null&&!t){
if(h==null){
s._methodEl.setAttribute("xmlns",a)
}else{
s._methodEl.setAttribute("xmlns:"+h,a)
}}
c.appendChild(s._methodEl);
return s
};
AjxSoapDoc.createFromDom=function(t){
var e=new AjxSoapDoc();
e._xmlDoc=AjxXmlDoc.createFromDom(t);
e._methodEl=e._check(e._xmlDoc);
return e
};
AjxSoapDoc.createFromXml=function(e){
var t=new AjxSoapDoc();
t._xmlDoc=AjxXmlDoc.createFromXml(e);
t._methodEl=t._check(t._xmlDoc);
return t
};
AjxSoapDoc.element2FaultObj=function(t){
var e=t.firstChild;
if(!AjxEnv.isSafari){
if(e!=null&&e.namespaceURI!=AjxSoapDoc._SOAP_URI||e.nodeName!=(t.prefix+":Fault")){
return null
}}else{
if(e!=null&&e.nodeName!=(t.prefix+":Fault")){
return null
}}
return new AjxSoapFault(e)
};
AjxSoapDoc.prototype.setMethodAttribute=function(e,t){
this._methodEl.setAttribute(e,t)
};
AjxSoapDoc.prototype.set=function(t,c,d,n){
var h=this.getDoc();
var e=h.createElementNS&&!AjxEnv.isSafari;
var a=t?(n&&e?h.createElementNS(n,t):h.createElement(t)):h.createDocumentFragment();
if(n&&!e){
a.setAttribute("xmlns",n)
}
if(c!=null){
if(typeof c=="object"){
for(var r in c){
var o=c[r];
if(r.charAt(0)=="!"){
a.setAttribute(r.substr(1),o)
}else{
if(o instanceof Array){
for(var s=0;
s<o.length;
++s){
this.set(r,o[s],a)
}}else{
this.set(r,o,a)
}}}}else{
a.appendChild(h.createTextNode(c))
}}
if(!d){
d=this._methodEl
}
return d.appendChild(a)
};
AjxSoapDoc.prototype.getMethod=function(){
return this._methodEl
};
AjxSoapDoc.prototype.createHeaderElement=function(){
var a=this._xmlDoc.getDoc();
var t=a.firstChild;
var o=this.getHeader();
if(o!=null){
throw new AjxSoapException("SOAP header already exists",AjxSoapException.ELEMENT_EXISTS,"AjxSoapDoc.prototype.createHeaderElement")
}
var e=a.createElementNS&&!AjxEnv.isSafari;
o=e?a.createElementNS(this._soapURI,"soap:Header"):a.createElement("soap:Header");
t.insertBefore(o,t.firstChild);
return o
};
AjxSoapDoc.prototype.getHeader=function(){
var t=this._xmlDoc.getDoc();
var e=AjxEnv.isIE?(t.getElementsByTagName(t.firstChild.prefix+":Header")):(t.getElementsByTagNameNS(this._soapURI,"Header"));
return e?e[0]:null
};
AjxSoapDoc.prototype.getBody=function(){
var t=this._xmlDoc.getDoc();
var e=AjxEnv.isIE?(t.getElementsByTagName(t.firstChild.prefix+":Body")):(t.getElementsByTagNameNS(this._soapURI,"Body"));
return e?e[0]:null
};
AjxSoapDoc.prototype.getByTagName=function(t){
if(t.indexOf(":")==-1){
t="soap:"+t
}
var e=this.getDoc().getElementsByTagName(t);
if(e.length==1){
return e[0]
}else{
if(e.length>0){
return e
}else{
return null
}}};
AjxSoapDoc.prototype.ensureHeader=function(){
return(this.getHeader()||this.createHeaderElement())
};
AjxSoapDoc.prototype.getDoc=function(){
return this._xmlDoc.getDoc()
};
AjxSoapDoc.prototype.adoptNode=function(t){
if(AjxEnv.isFirefox3up||!AjxEnv.isFirefox){
try{
var a=this.getDoc();
if(a.adoptNode){
return a.adoptNode(t,true)
}}
catch(e){}}
return t.parentNode.removeChild(t)
};
AjxSoapDoc.prototype.getXml=function(){
return AjxEnv.isSafari||AjxEnv.isOpera?(AjxXmlDoc.getXml(this._xmlDoc.getDoc())):AjxXmlDoc.replaceInvalidChars(this._xmlDoc.getDoc().xml)
};
AjxSoapDoc.prototype._check=function(t){
var a=t.getDoc();
if(a.childNodes.length!=1){
throw new AjxSoapException("Invalid SOAP PDU",AjxSoapException.INVALID_PDU,"AjxSoapDoc.createFromXml:1")
}
var e=a.firstChild;
if(!AjxEnv.isSafari){
if(e.namespaceURI!=AjxSoapDoc._SOAP_URI||e.nodeName!=(e.prefix+":Envelope")||(e.childNodes.length<1||e.childNodes.length>2)){
throw new AjxSoapException("Invalid SOAP PDU",AjxSoapException.INVALID_PDU,"AjxSoapDoc.createFromXml:2")
}}else{
if(e.nodeName!=(e.prefix+":Envelope")){
throw new AjxSoapException("Invalid SOAP PDU",AjxSoapException.INVALID_PDU,"AjxSoapDoc.createFromXml:2")
}}}
}
if(AjxPackage.define("ajax.net.AjxRpcRequest")){
AjxRpcRequest=function(e){
if(!AjxRpcRequest.__inited){
AjxRpcRequest.__init()
}
this.id=e;
this.__httpReq=AjxRpcRequest.__msxmlVers?(new ActiveXObject(AjxRpcRequest.__msxmlVers)):(new XMLHttpRequest())
};
AjxRpcRequest.TIMEDOUT=-1000;
AjxRpcRequest.__inited=false;
AjxRpcRequest.__msxmlVers=null;
AjxRpcRequest.prototype.toString=function(){
return"AjxRpcRequest"
};
AjxRpcRequest.prototype.invoke=function(a,t,s,d,h,r){
var e=(d!=null);
this.__httpReq.open((h)?"get":"post",t,e);
if(e){
if(r){
var o=new AjxTimedAction(this,this.__handleTimeout,[d]);
d._timedActionId=AjxTimedAction.scheduleAction(o,r)
}
var c=this;
this.__httpReq.onreadystatechange=function(u){
if(window.AjxRpcRequest){
AjxRpcRequest.__handleResponse(c,d)
}}
}else{
this.__httpReq.onreadystatechange=function(u){}
}
if(s){
for(var n in s){
this.__httpReq.setRequestHeader(n,s[n])
}}
this.__httpReq.send(a);
if(e){
return this.id
}else{
if(this.__httpReq.status==200||this.__httpReq.status==201){
return{
text:this.__httpReq.responseText,xml:this.__httpReq.responseXML,success:true}
}else{
return{
text:this.__httpReq.responseText,xml:this.__httpReq.responseXML,success:false,status:this.__httpReq.status}
}}};

AjxRpcRequest.prototype.cancel=function(){
AjxRpc.freeRpcCtxt(this);
this.__httpReq.abort()
};
AjxRpcRequest.prototype.__handleTimeout=function(e){
this.cancel();
e.run({
text:null,xml:null,success:false,status:AjxRpcRequest.TIMEDOUT}
)
};
AjxRpcRequest.__handleResponse=function(a,o){
if(!a||!a.__httpReq){
a.cancel();
o.run({
text:null,xml:null,success:false,status:500}
);
return
}
if(a.__httpReq.readyState==4){
if(o._timedActionId!==null){
AjxTimedAction.cancelAction(o._timedActionId)
}
var e=500;
try{
e=a.__httpReq.status
}
catch(t){}
if(e==200||e==201){
o.run({
text:a.__httpReq.responseText,xml:a.__httpReq.responseXML,success:true,reqId:a.id}
)
}else{
o.run({
text:a.__httpReq.responseText,xml:a.__httpReq.responseXML,success:false,status:e,reqId:a.id}
)
}
a.cancel()
}};
AjxRpcRequest.__init=function(){
if(!window.XMLHttpRequest&&window.ActiveXObject){
var t=["MSXML2.XMLHTTP.4.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"];
for(var o=0;
o<t.length;
o++){
try{
var e=new ActiveXObject(t[o]);
AjxRpcRequest.__msxmlVers=t[o];
break
}
catch(a){}}
if(!AjxRpcRequest.__msxmlVers){
throw new AjxException("MSXML not installed",AjxException.INTERNAL_ERROR,"AjxRpc._init")
}}
AjxRpcRequest.__inited=true
}
}
if(AjxPackage.define("ajax.net.AjxRpc")){
AjxRpc=function(){};
AjxRpc.__rpcCache=[];
AjxRpc.__rpcOutstanding={};
AjxRpc.__RPC_CACHE_MAX=50;
AjxRpc.__RPC_COUNT=0;
AjxRpc.__RPC_REAP_AGE=300000;
AjxRpc.invoke=function(a,t,s,u,d,c){
var e=(u!=null);
var n=AjxRpc.__getFreeRpcCtxt();
try{
var o=n.invoke(a,t,s,u,d,c)
}
catch(r){
var h=new AjxException();
h.method="AjxRpc.prototype._invoke";
if(r instanceof Error){
h.detail=r.message;
h.code=AjxException.NETWORK_ERROR;
h.msg="Network error"
}else{
h.detail=r.toString();
h.code=AjxException.UNKNOWN_ERROR;
h.msg="Unknown Error"
}
if(!e){
AjxRpc.freeRpcCtxt(n)
}
throw h
}
if(!e){
AjxRpc.freeRpcCtxt(n)
}
return o
};
AjxRpc.freeRpcCtxt=function(e){
if(AjxRpc.__rpcOutstanding[e.id]){
AjxRpc.__rpcCache.push(e);
delete AjxRpc.__rpcOutstanding[e.id]
}};
AjxRpc.getRpcRequestById=function(e){
return(AjxRpc.__rpcOutstanding[e])
};
AjxRpc.__getFreeRpcCtxt=function(){
var e;
if(AjxRpc.__rpcCache.length>0){
e=AjxRpc.__rpcCache.pop()
}else{
if(AjxRpc.__RPC_COUNT<AjxRpc.__RPC_CACHE_MAX){
var t="__RpcCtxt_"+AjxRpc.__RPC_COUNT;
e=new AjxRpcRequest(t);
AjxRpc.__RPC_COUNT++
}else{
e=AjxRpc.__reap();
if(!e){
throw new AjxException("Out of RPC cache",AjxException.OUT_OF_RPC_CACHE,"AjxRpc.__getFreeRpcCtxt")
}}}
AjxRpc.__rpcOutstanding[e.id]=e;
e.timestamp=(new Date()).getTime();
return e
};
AjxRpc.__reap=function(){
var e;
var a=(new Date()).getTime();
for(var t in AjxRpc.__rpcOutstanding){
e=AjxRpc.__rpcOutstanding[t];
if(e.timestamp+AjxRpc.__RPC_REAP_AGE<a){
e.cancel();
delete AjxRpc.__rpcOutstanding[t];
return e
}}
return null
}
}
if(AjxPackage.define("ajax.util.AjxVector")){
AjxVector=function(){
this._array=new Array()
};
AjxVector.prototype.toString=function(n,t){
if(t!==true){
return this._array.join(n)
}
var o=new Array();
for(var s=0;
s<this._array.length;
s++){
var e=this._array[s];
if(e!=undefined&&e!=null&&e!=""){
o.push(e)
}}
return o.join(n)
};
AjxVector.fromArray=function(t){
var e=new AjxVector();
e._array.length=0;
if(t instanceof Array){
e._array=t
}
return e
};
AjxVector.prototype.size=function(){
return this._array.length
};
AjxVector.prototype.add=function(a,e,t){
if(t&&this.contains(a)){
return
}
AjxUtil.arrayAdd(this._array,a,e)
};
AjxVector.prototype.addList=function(a){
if(!a){
return
}
if(a.length){
this._array=this._array.concat(a)
}else{
if(a.size&&a.size()){
if(AjxEnv.isIE&&(!(a._array instanceof Array))){
var t=[];
for(var e=0;
e<a._array.length;
e++){
t.push(a._array[e])
}
a._array=t
}
this._array=this._array.concat(a._array)
}}};
AjxVector.prototype.remove=function(e){
return AjxUtil.arrayRemove(this._array,e)
};
AjxVector.prototype.removeAt=function(t){
if(t>=this._array.length||t<0){
return null
}
var a=this._array.splice(t,1);
var e=null;
if(a){
e=a[0]
}
return e
};
AjxVector.prototype.removeAll=function(){
for(var e=0;
e<this._array.length;
e++){
this._array[e]=null
}
this._array.length=0
};
AjxVector.prototype.removeLast=function(){
return this._array.length>0?this._array.pop():null
};
AjxVector.prototype.reverse=function(){
this._array.reverse()
};
AjxVector.prototype.replace=function(a,t){
var e=this._array[a];
this._array[a]=t;
return e
};
AjxVector.prototype.replaceObject=function(a,e){
for(var t=0;
t<this._array.length;
t++){
if(this._array[t]==a){
this._array[t]=e;
return a
}}
return null
};
AjxVector.prototype.indexOf=function(t){
if(t==null){
return -1
}
for(var e=0;
e<this._array.length;
e++){
if(this._array[e]==t){
return e
}}
return -1
};
AjxVector.prototype.indexOfLike=function(o,a){
var t=a.call(o);
for(var e=0;
e<this._array.length;
e++){
var n=a.call(this._array[e]);
if(n==t){
return e
}}
return -1
};
AjxVector.prototype.clone=function(){
var e=new AjxVector();
e.addList(this);
return e
};
AjxVector.prototype.contains=function(t){
for(var e=0;
e<this._array.length;
e++){
if(this._array[e]==t){
return true
}}
return false
};
AjxVector.prototype.containsLike=function(o,a){
var t=a.call(o);
for(var e=0;
e<this._array.length;
e++){
var n=a.call(this._array[e]);
if(n==t){
return true
}}
return false
};
AjxVector.prototype.get=function(e){
return e>=this._array.length||e<0?null:this._array[e]
};
AjxVector.prototype.getArray=function(){
return this._array
};
AjxVector.prototype.getLast=function(){
return this._array.length==0?null:this._array[this._array.length-1]
};
AjxVector.prototype.getNext=function(t){
var e=this.indexOf(t);
if(e==-1){
return null
}
return this.get(++e)
};
AjxVector.prototype.getPrev=function(t){
var e=this.indexOf(t);
if(e==-1){
return null
}
return this.get(--e)
};
AjxVector.prototype.sort=function(e){
if(!e){
e=AjxVector._defaultArrayComparator
}
this._array.sort(e)
};
AjxVector.prototype.binarySearch=function(s,r){
if(!r){
r=AjxVector._defaultArrayComparator
}
var a=0;
var e=this._array;
var o=e.length-1;
while(true){
if(o<a){
return -1
}
var n=Math.floor((a+o)/2);
var t=r(s,e[n]);
if(t<0){
o=n-1
}else{
if(t>0){
a=n+1
}else{
return n
}}}};
AjxVector.prototype.merge=function(n,o){
if(n<0){
return
}
var s=o instanceof AjxVector?o.getArray():o;
var e=this._array.length<(n+s.length)?this._array.length:n+s.length;
if(n<this._array.length){
var a=0;
for(var t=n;
t<e;
t++){
this._array[t]=s[a++]
}
if(a<s.length){
this._array=this._array.concat(s.slice(a))
}}else{
this._array=this._array.concat(s)
}};
AjxVector._defaultArrayComparator=function(t,e){
return t<e?-1:(t>e?1:0)
};
AjxVector.prototype.foreach=function(o,n){
var e=this.size(),t=0,a;
if(typeof o=="function"){
while(--e>=0){
o.call(n,this.get(t),t++)
}}else{
while(--e>=0){
a=this.get(t++);
if(a!=null){
a[o].call(a)
}}}};
AjxVector.prototype.map=function(n,s){
var e=[],t=this.size(),o;
if(typeof n=="function"){
while(--t>=0){
e[t]=n.call(s,this.get(t),t)
}}else{
if(n instanceof AjxCallback){
while(--t>=0){
e[t]=n.run(this.get(t),t)
}}else{
while(--t>=0){
o=this.get(t);
if(o!=null){
if(typeof o[n]=="function"){
e.unshift(o[n].call(o))
}else{
e.unshift(o[n])
}}}}}
return AjxVector.fromArray(e)
};
AjxVector.prototype.join=function(e){
return this._array.join(e)
};
AjxVector.prototype.sub=function(s,r){
var t=[],e=this.size(),o=0,n;
while(--e>=0){
n=this.get(o++);
if(!s.call(r,n,o)){
t.push(n)
}}
return AjxVector.fromArray(t)
}
}
if(AjxPackage.define("ajax.util.AjxStringUtil")){
AjxStringUtil=function(){};
AjxStringUtil.TRIM_RE=/^\s+|\s+$/g;
AjxStringUtil.COMPRESS_RE=/\s+/g;
AjxStringUtil.ELLIPSIS=" ... ";
AjxStringUtil.makeString=function(e){
return e?String(e):""
};
AjxStringUtil.capitalize=function(e){
return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()
};
AjxStringUtil.toMixed=function(s,e,o){
if(!s||(typeof s!="string")){
return""
}
e=e||/\s+/;
var a=s.split(e);
var n=[];
n.push(o?a[0].toLowerCase():a[0].substring(0,1).toUpperCase()+a[0].substring(1).toLowerCase());
for(var t=1;
t<a.length;
t++){
n.push(a[t].substring(0,1).toUpperCase()+a[t].substring(1).toLowerCase())
}
return n.join("")
};
AjxStringUtil.trim=function(n,e,o){
if(!n){
return""
}
var a=AjxStringUtil.TRIM_RE;
var t=AjxStringUtil.COMPRESS_RE;
if(o){
a=new RegExp("^"+o+"+|"+o+"+$","g");
t=new RegExp(o+"+","g")
}else{
o=" "
}
n=n.replace(a,"");
if(e){
n=n.replace(t,o)
}
return n
};
AjxStringUtil.repeat=function(o,e){
var a="";
for(var t=0;
t<e;
t++){
a+=o
}
return a
};
AjxStringUtil.getUnitsFromSizeString=function(t){
var a="px";
if(typeof(t)=="string"){
var e=Number(parseInt(t,10)).toString();
if(t.length>e.length){
a=t.substr(e.length,(t.length-e.length));
if(!(a=="em"||a=="ex"||a=="px"||a=="in"||a=="cm"==a=="mm"||a=="pt"||a=="pc"||a=="%")){
a="px"
}}}
return a
};
AjxStringUtil.split=function(d,o){
if(!d){
return[]
}
var s=0;
o=o?o:",";
var m=new Object();
if(typeof o=="string"){
m[o]=1
}else{
for(s=0;
s<o.length;
s++){
m[o[s]]=1
}}
var e=false;
var a=0;
var t=0;
var u;
var r=[];
var n=0;
for(s=0;
s<d.length;
s++){
var h=d.charAt(s);
if(h=='"'){
e=!e
}else{
if(h=="("){
a++
}else{
if(h==")"){
a--
}else{
if(m[h]){
if(!e&&!a){
u=d.substring(t,s);
r[n++]=u;
t=s+1
}}}}}}
u=d.substring(t,d.length);
r[n++]=u;
return r
};
AjxStringUtil.wordWrap=function(s){
if(!(s&&s.text)){
return""
}
var p=s.text;
var d=s.len||80;
var n=s.pre||"";
d-=n.length;
var u=s.eol||(s.htmlMode?"<br>":"\n");
if(s.htmlMode){
var g=p.split(AjxStringUtil.HTML_BR_RE);
var a=[];
if(g.length>0){
for(var r=0;
r<g.length;
r++){
a.push(g[r].replace(/(<div\s+[^>]*>)/gi,"$1"+n))
}
p=n+a.join(u+n)
}
return p
}
var h=[];
var m=0;
p=AjxStringUtil.trim(p,false);
p=p.replace(/[ \t]+\n/g,"\n");
if(s.compress){
p=p.replace(/\b\n\b/g," ")
}
var f=p.length;
for(var r=0,o=0,t=-1;
r<f;
r++){
var e=p.charAt(r);
if(e.match(/[ \t]/)){
t=r
}
if(e=="\n"){
h[m++]=n+p.substring(o,r);
o=r+1;
t=-1
}
if(r-o>=d){
if(t==-1){
if(s.breakOkay){
h[m++]=n+p.substring(o,r);
o=r;
t=-1
}}else{
h[m++]=n+p.substring(o,t);
o=t+1;
t=-1
}}}
if(r>o){
h[m++]=n+p.substring(o,r)
}
return h.join(u)+u
};
AjxStringUtil.IS_PRINT_CODE={};
var print_codes=[32,48,49,50,51,52,53,54,55,56,57,59,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,96,97,98,99,100,101,102,103,104,105,106,107,109,110,111,186,187,188,189,190,191,192,219,220,221,222];
var l=print_codes.length;
for(var i=0;
i<l;
i++){
AjxStringUtil.IS_PRINT_CODE[print_codes[i]]=true
}
AjxStringUtil.isPrintKey=function(e){
return AjxStringUtil.IS_PRINT_CODE[e]
};
AjxStringUtil.SHIFT_CHAR={
48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'};
AjxStringUtil.shiftChar=function(e,t){
return t?AjxStringUtil.SHIFT_CHAR[e]||String.fromCharCode(e):String.fromCharCode(e)
};
AjxStringUtil.diffPoint=function(o,a){
if(!(o&&a)){
return 0
}
var e=Math.min(o.length,a.length);
var t=0;
while(t<e&&(o.charAt(t)==a.charAt(t))){
t++
}
return t
};
AjxStringUtil.resolve=function(t,e){
return AjxMessageFormat.format(t,e)
};
AjxStringUtil.urlEncode=function(t){
if(!t){
return""
}
var e=window.encodeURL||window.encodeURI;
return e(t)
};
AjxStringUtil.urlComponentEncode=function(t){
if(!t){
return""
}
var e=window.encodeURLComponent||window.encodeURIComponent;
return e(t)
};
AjxStringUtil.ENCODE_MAP={
">":"&gt;","<":"&lt;","&":"&amp;"};
AjxStringUtil.htmlEncode=function(t,e){
if(!t){
return""
}
if(!AjxEnv.isSafari||AjxEnv.isSafariNightly){
if(e){
return t.replace(/[<>&]/g,function(a){
return AjxStringUtil.ENCODE_MAP[a]
}
).replace(/  /g," &nbsp;")
}else{
return t.replace(/[<>&]/g,function(a){
return AjxStringUtil.ENCODE_MAP[a]
}
)
}}else{
if(e){
return t.replace(/[&]/g,"&amp;").replace(/  /g," &nbsp;").replace(/[<]/g,"&lt;").replace(/[>]/g,"&gt;")
}else{
return t.replace(/[&]/g,"&amp;").replace(/[<]/g,"&lt;").replace(/[>]/g,"&gt;")
}}};
AjxStringUtil.htmlDecode=function(t,e){
if(e){
t=t.replace(/&nbsp;/g," ")
}
return t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")
};
AjxStringUtil.stripTags=function(t,e){
if(!t){
return""
}
if(e){
t=t.replace(/(<(\w+)[^>]*>).*(<\/\2[^>]*>)/,"$1$3")
}
return t.replace(/<\/?[^>]+>/gi,"")
};
AjxStringUtil.convertToHtml=function(e){
if(!e){
return""
}
e=e.replace(/&/mg,"&amp;").replace(/  /mg," &nbsp;").replace(/^ /mg,"&nbsp;").replace(/\t/mg,"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;").replace(/</mg,"&lt;").replace(/>/mg,"&gt;").replace(/\r?\n/mg,"<br>");
return e
};
AjxStringUtil.SPACE_ENCODE_MAP={
" ":"&nbsp;",">":"&gt;","<":"&lt;","&":"&amp;","\n":"<br>"};
AjxStringUtil.htmlEncodeSpace=function(e){
if(!e){
return""
}
return e.replace(/[&]/g,"&amp;").replace(/ /g,"&nbsp;").replace(/[<]/g,"&lt;").replace(/[>]/g,"&gt;")
};
AjxStringUtil.nl2br=function(e){
if(!e){
return""
}
return e.replace(/^ /mg,"&nbsp;").replace(/\t/mg,"<span style='white-space:pre'>\t</span>").replace(/\n/g,"<br>")
};
AjxStringUtil.xmlEncode=function(e){
if(e){
e=""+e;
return e.replace(/&/g,"&amp;").replace(/</g,"&lt;")
}
return""
};
AjxStringUtil.xmlDecode=function(e){
return e?e.replace(/&amp;/g,"&").replace(/&lt;/g,"<"):""
};
AjxStringUtil.xmlAttrEncode=function(e){
return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\x22/g,"&quot;").replace(/\x27/g,"&apos;"):""
};
AjxStringUtil.xmlAttrDecode=function(e){
return e?e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&apos;/g,"'"):""
};
AjxStringUtil.__RE_META={
" ":" ","\n":"\\n","\r":"\\r","\t":"\\t"};
AjxStringUtil.__reMetaEscape=function(t,e){
return AjxStringUtil.__RE_META[e]||"\\"+e
};
AjxStringUtil.regExEscape=function(e){
return e.replace(/(\W)/g,AjxStringUtil.__reMetaEscape)
};
AjxStringUtil._calcDIV=null;
AjxStringUtil.calcDIV=function(){
if(AjxStringUtil._calcDIV==null){
AjxStringUtil._calcDIV=document.createElement("div");
AjxStringUtil._calcDIV.style.zIndex=0;
AjxStringUtil._calcDIV.style.position=DwtControl.ABSOLUTE_STYLE;
AjxStringUtil._calcDIV.style.visibility="hidden";
document.body.appendChild(AjxStringUtil._calcDIV)
}
return AjxStringUtil._calcDIV
};
AjxStringUtil.clip=function(e,s,n){
var o=AjxStringUtil.calcDIV();
if(arguments.length==3){
o.className=n
}
o.innerHTML=e;
if(o.offsetWidth<=s){
return e
}
for(var a=e.length-1;
a>0;
a--){
var t=e.substr(0,a);
o.innerHTML=t+AjxStringUtil.ELLIPSIS;
if(o.offsetWidth<=s){
return t+AjxStringUtil.ELLIPSIS
}}
return e
};
AjxStringUtil.clipByLength=function(a,t){
var e=a.length;
return(e<=t)?a:[a.substr(0,t/2),"...",a.substring(e-((t/2)-3),e)].join("")
};
AjxStringUtil.wrap=function(s,r,h){
var f=AjxStringUtil.calcDIV();
if(arguments.length==3){
f.className=h
}
var c="";
var n="";
var e=s.split("/n");
for(var o=0;
o<e.length;
o++){
if(o!=0){
c+=n+"<br>";
n=""
}
htmlRows=e[o].split("<br>");
for(var u=0;
u<htmlRows.length;
u++){
if(u!=0){
c+=n+"<br>";
n=""
}
words=htmlRows[u].split(" ");
var m=0;
while(m<words.length){
f.innerHTML=n+" "+words[m];
var a=f.offsetWidth;
if(a>r){
f.innerHTML=words[m];
a=a-f.offsetWidth;
if((a>=r)||(f.offsetWidth<=r)){
c+=n+"<br>";
n=""
}else{
var d=true;
var t=0;
while(d){
t++;
f.innerHTML=n+" "+words[m].substring(0,t);
d=(f.offsetWidth<=r)
}
t--;
c+=n+words[m].substring(0,t)+"<br>";
words[m]=words[m].substr(t);
n=""
}}else{
n+=" "+words[m];
m++
}}}}
c+=n;
return c
};
AjxStringUtil.MSG_SEP_RE=new RegExp("^\\s*--+\\s*(Original Message|Forwarded Message)\\s*--+","i");
AjxStringUtil.SIG_RE=/^(- ?-+)|(__+)\r?$/;
AjxStringUtil.COLON_RE=/\S+:$/;
AjxStringUtil.PREFIX_RE=/^\s*(>|\|)/;
AjxStringUtil.BRACKET_RE=/^\s*\[.+\]\s*$/;
AjxStringUtil.LINE_RE=/^\s*_{30,}\s*$/;
AjxStringUtil.BLANK_RE=/^\s*$/;
AjxStringUtil.SPLIT_RE=/\r|\n|\r\n/;
AjxStringUtil.HTML_BLANK_RE=/^\s*<br>\s*$/i;
AjxStringUtil.HDR_RE=/^\s*\w+:/;
AjxStringUtil.HTML_BR_RE=/<br\s*\/?>/gi;
AjxStringUtil.HTML_BODY_RE=/<body(\s|>)/i;
AjxStringUtil.getTopLevel=function(m,h,t){
var e=/<br|<div/i.test(m);
var c=e?AjxStringUtil.HTML_BR_RE:AjxStringUtil.SPLIT_RE;
var h=e?"<br>":"\n";
m=AjxStringUtil._trimBlankLines(m,c,h,e);
var f=m.split(c);
var s=f.length;
var o=0,a=0;
var n=[];
var r=false;
while(o<s){
var u=r;
var d=AjxStringUtil._linesToSkip(f,o,t);
r=(d>0);
if(u&&!r){
a=o
}else{
if(!u&&r&&o>a){
n.push(AjxStringUtil._trimBlankLines(f.slice(a,o).join(h),c,h,t)+h)
}}
o+=r?d:1
}
if(!r&&o>a){
n.push(AjxStringUtil._trimBlankLines(f.slice(a,o).join(h),c,h,t)+h)
}
return n
};
AjxStringUtil._linesToSkip=function(c,a,e){
var o=c.length;
var h=0;
var t=a;
var d=e?AjxStringUtil.stripTags(c[a]):c[a];
if(AjxStringUtil.MSG_SEP_RE.test(d)){
h=o-a
}else{
if(AjxStringUtil.PREFIX_RE.test(d)){
while(a<c.length&&(AjxStringUtil.PREFIX_RE.test(d)||AjxStringUtil.BLANK_RE.test(d))){
a++;
d=e?AjxStringUtil.stripTags(c[a]):c[a]
}
h=a-t
}else{
if(AjxStringUtil.COLON_RE.test(d)){
var s=AjxStringUtil._nextNonBlankLineIndex(c,a+1,e);
var r=(s==-1)?null:e?AjxStringUtil.stripTags(c[s]):c[s];
if(r&&AjxStringUtil.PREFIX_RE.test(r)){
h=s-a
}else{
if(s!=-1){
s=AjxStringUtil._nextNonBlankLineIndex(c,s+1,e)
}
var n=(s==-1)?null:e?AjxStringUtil.stripTags(c[s]):c[s];
if(n&&AjxStringUtil.BRACKET_RE.test(r)&&AjxStringUtil.PREFIX_RE.test(n)){
h=s-a
}}}else{
if(AjxStringUtil.LINE_RE.test(d)){
var s=AjxStringUtil._nextNonBlankLineIndex(c,a+1,e);
var r=(s==-1)?null:e?AjxStringUtil.stripTags(c[s]):c[s];
if(r&&AjxStringUtil.HDR_RE.test(r)){
h=o-a
}}else{
if(AjxStringUtil.SIG_RE.test(d)){
h=o-a
}}}}}
return h
};
AjxStringUtil._nextNonBlankLineIndex=function(e,t,a){
while(t<e.length&&AjxStringUtil.BLANK_RE.test(a?AjxStringUtil.stripTags(e[t]):e[t])){
t++
}
return((t<e.length)?t:-1)
};
AjxStringUtil._trimBlankLines=function(r,s,n,e){
var c=r.split(s);
var o=c.length;
var h=e?AjxStringUtil.HTML_BLANK_RE:AjxStringUtil.BLANK_RE;
var a=0;
while(a<o&&h.test(c[a])){
a++
}
var t=o;
while(t>0&&h.test(c[t-1])){
t--
}
if(a!=0||t!=o){
r=c.slice(a,t).join(n)+n
}
if(e&&AjxStringUtil.HTML_BODY_RE.test(r)){
r=r.replace(/<body\s*[^>]*>(<br\s*\/?>)+/i,"<body>");
r=r.replace(/(<br\s*\/?>)+<\/body>/i,"</body>")
}
return r
};
AjxStringUtil._NO_LIST=0;
AjxStringUtil._ORDERED_LIST=1;
AjxStringUtil._UNORDERED_LIST=2;
AjxStringUtil._INDENT="    ";
AjxStringUtil._NON_WHITESPACE=/\S+/;
AjxStringUtil._LF=/\n/;
AjxStringUtil.convertHtml2Text=function(a){
if(!a){
return null
}
if(typeof a=="string"){
var o=document.createElement("SPAN");
o.innerHTML=a;
a=o
}
var n=[];
var t=0;
var e={};
this._traverse(a,n,t,AjxStringUtil._NO_LIST,0,0,e);
return n.join("")
};
AjxStringUtil._traverse=function(e,m,d,c,r,n,s){
var h=e.nodeName.toLowerCase();
if(h=="#text"){
if(e.nodeValue.search(AjxStringUtil._NON_WHITESPACE)!=-1){
if(s.lastNode=="ol"||s.lastNode=="ul"){
m[d++]="\n"
}
if(s.isPreformatted){
m[d++]=AjxStringUtil.trim(e.nodeValue)+" "
}else{
m[d++]=AjxStringUtil.trim(e.nodeValue.replace(AjxStringUtil._LF," "),true)+" "
}}}else{
if(h=="p"){
m[d++]="\n\n"
}else{
if(c==AjxStringUtil._NO_LIST&&(h=="br"||h=="hr")){
m[d++]="\n"
}else{
if(h=="ol"||h=="ul"){
m[d++]="\n";
if(e.parentNode.nodeName.toLowerCase()!="li"&&s.lastNode!="br"&&s.lastNode!="hr"){
m[d++]="\n"
}
c=(h=="ol")?AjxStringUtil._ORDERED_LIST:AjxStringUtil._UNORDERED_LIST;
r++;
n=0
}else{
if(h=="li"){
for(var a=0;
a<r;
a++){
m[d++]=AjxStringUtil._INDENT
}
if(c==AjxStringUtil._ORDERED_LIST){
m[d++]=n+". "
}else{
m[d++]="\u2022 "
}}else{
if(h=="img"){
if(e.alt&&e.alt!=""){
m[d++]=e.alt
}}else{
if(h=="tr"&&e.parentNode.firstChild!=e){
m[d++]="\n"
}else{
if(h=="td"&&e.parentNode.firstChild!=e){
m[d++]="\t"
}else{
if(h=="div"){
m[d++]="\n"
}else{
if(h=="blockquote"){
m[d++]="\n\n"
}else{
if(h=="pre"){
s.isPreformatted=true
}else{
if(h=="#comment"||h=="script"||h=="select"||h=="style"){
return d
}}}}}}}}}}}}
var u=e.childNodes;
var o=u.length;
for(var a=0;
a<o;
a++){
var t=u[a];
if(t.nodeType==1&&t.tagName.toLowerCase()=="li"){
n++
}
d=this._traverse(t,m,d,c,r,n,s)
}
if(h=="h1"||h=="h2"||h=="h3"||h=="h4"||h=="h5"||h=="h6"){
m[d++]="\n";
s.list=false
}else{
if(h=="pre"){
s.isPreformatted=false
}else{
if(h=="li"){
if(!s.list){
m[d++]="\n"
}
s.list=false
}else{
if(h=="ol"||h=="ul"){
s.list=true
}else{
if(h!="#text"){
s.list=false
}}}}}
s.lastNode=h;
return d
};
AjxStringUtil.queryStringSet=function(r,c){
var h=c?"":location.search;
if(h.indexOf("?")==0){
h=h.substr(1)
}
var s=h.split("&");
var a={};
for(var o=0;
o<s.length;
o++){
var n=s[o].split("=");
a[n[0]]=n[1]
}
for(var e in r){
a[e]=r[e]
}
var t=[];
var o=0;
for(var e in a){
if(e){
t[o++]=[e,a[e]].join("=")
}}
return"?"+t.join("&")
};
AjxStringUtil.queryStringRemove=function(e,a){
e=e?e:"";
if(e.indexOf("?")==0){
e=e.substr(1)
}
var n=e.split("&");
var t=[];
for(var o=0;
o<n.length;
o++){
if(n[o].indexOf(a)!=0){
t.push(n[o])
}}
return"?"+t.join("&")
};
AjxStringUtil.getAsString=function(e){
return !e?"":(typeof(e)=="object")?e.toString():e
};
AjxStringUtil.isWhitespace=function(e){
return(e.charCodeAt(0)<=32)
};
AjxStringUtil.isDigit=function(t){
var e=t.charCodeAt(0);
return(e>=48&&e<=57)
};
AjxStringUtil.compareRight=function(n,t){
var s=0;
var h=0;
var r=0;
var o;
var e;
for(;
(h<n.length||r<t.length);
h++,r++){
o=n.charAt(h);
e=t.charAt(r);
if(!AjxStringUtil.isDigit(o)&&!AjxStringUtil.isDigit(e)){
return s
}else{
if(!AjxStringUtil.isDigit(o)){
return -1
}else{
if(!AjxStringUtil.isDigit(e)){
return +1
}else{
if(o<e){
if(s==0){
s=-1
}}else{
if(o>e){
if(s==0){
s=+1
}}}}}}}};
AjxStringUtil.natCompare=function(c,h){
var r=0,n=0;
var t=0,e=0;
var s,o;
while(r<c.length||n<h.length){
t=e=0;
s=c.charAt(r);
o=h.charAt(n);
while(AjxStringUtil.isWhitespace(s)||s=="0"){
t=(s=="0")?(t+1):0;
s=c.charAt(++r)
}
while(AjxStringUtil.isWhitespace(o)||o=="0"){
e=(o=="0")?(e+1):0;
o=h.charAt(++n)
}
if(AjxStringUtil.isDigit(s)&&AjxStringUtil.isDigit(o)){
var d=AjxStringUtil.compareRight(c.substring(r),h.substring(n));
if(d&&d!=0){
return d
}}
if(s==0&&o==0){
return t-e
}
if(s<o){
return -1
}else{
if(s>o){
return +1
}}
++r;
++n
}};
AjxStringUtil.clipFile=function(s,t){
var a=s.lastIndexOf(".");
var e=a?(a+1):s.length;
if(e<=t){
return s
}else{
var n=s.substr(0,a);
var o=s.substr(a+1,s.length-1);
return[n.substr(0,t/2),"...",n.substring(e-((t/2)-3),e),".",(o?o:"")].join("")
}};
AjxStringUtil.URL_PARSE_RE=new RegExp("^(?:([^:/?#.]+):)?(?://)?(([^:/?#]*)(?::(\\d*))?)?((/(?:[^?#](?![^?#/]*\\.[^?#/.]+(?:[\\?#]|$)))*/?)?([^?#/]*))?(?:\\?([^#]*))?(?:#(.*))?");
AjxStringUtil.parseURL=function(a){
var n=["source","protocol","authority","domain","port","path","directoryPath","fileName","query","anchor"];
var o=AjxStringUtil.URL_PARSE_RE.exec(a);
var t={};
for(var e=0;
e<n.length;
e++){
t[n[e]]=(o[e]?o[e]:"")
}
if(t.directoryPath.length>0){
t.directoryPath=t.directoryPath.replace(/\/?$/,"/")
}
return t
};
AjxStringUtil.parseQueryString=function(s){
var a=s||(""+window.location);
var t=a.indexOf("?");
if(t==-1){
return null
}
var e=a.substring(t+1).replace(/#.*$/,"");
var n=e.split("&");
var h={};
for(var o=0;
o<n.length;
o++){
var r=n[o].split("=");
h[r[0]]=r[1]
}
return h
};
AjxStringUtil._SPECIAL_CHARS=/["\\\x00-\x1f]/g;
AjxStringUtil._CHARS={
"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};
AjxStringUtil.objToString=function(n){
var p=typeof n,h,c,r,s,m,f,d,e=[];
var u=function(o){
if(!AjxStringUtil._CHARS[o]){
var t=o.charCodeAt();
AjxStringUtil._CHARS[o]="\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16)
}
return AjxStringUtil._CHARS[o]
};
var g=function(t){
return'"'+t.replace(AjxStringUtil._SPECIAL_CHARS,u)+'"'
};
if(p==="string"){
return g(n)
}
if(p==="boolean"||n instanceof Boolean){
return String(n)
}
if(p==="number"||n instanceof Number){
return isFinite(n)?String(n):"null"
}
if(AjxUtil.isArray(n)||(p==="object"&&n.length)){
for(h=e.length-1;
h>=0;
--h){
if(e[h]===n){
return"null"
}}
e[e.length]=n;
d=[];
for(h=n.length-1;
h>=0;
--h){
d[h]=AjxStringUtil.objToString(n[h])
}
e.pop();
return"["+d.join(",")+"]"
}
if(p==="object"&&n){
for(h=e.length-1;
h>=0;
--h){
if(e[h]===n){
return"null"
}}
e[e.length]=n;
d=[];
r=0;
for(s in n){
if(typeof s==="string"&&n.hasOwnProperty(s)){
m=n[s];
f=typeof m;
if(f!=="undefined"&&f!=="function"){
d[r++]=g(s)+":"+AjxStringUtil.objToString(m)
}}}
e.pop();
return"{"+d.join(",")+"}"
}
return"null"
};
AjxStringUtil.prettyPrint=function(o,a,e,t){
AjxStringUtil._visited=new AjxVector();
var n=AjxStringUtil._prettyPrint(o,a,e,t);
AjxStringUtil._visited=null;
return n
};
AjxStringUtil._visited=null;
AjxStringUtil._prettyPrint=function(r,e,u,t){
var p=0;
var n=false;
var w=false;
if(arguments.length>4){
p=arguments[4];
n=arguments[5];
w=arguments[6]
}
if(AjxUtil.isObject(r)){
var d=r.toString();
if(t&&t[d]){
return"["+d+"]"
}
if(AjxStringUtil._visited.contains(r)){
return"[visited object]"
}else{
AjxStringUtil._visited.add(r)
}}
var a=AjxStringUtil.repeat(" ",p);
var g="";
if(r===undefined){
g+="[undefined]"
}else{
if(r===null){
g+="[null]"
}else{
if(AjxUtil.isBoolean(r)){
g+=r?"true":"false"
}else{
if(AjxUtil.isString(r)){
g+='"'+AjxStringUtil._escapeForHTML(r)+'"'
}else{
if(AjxUtil.isNumber(r)){
g+=r
}else{
if(AjxUtil.isObject(r)){
var h=AjxUtil.isArray(r);
if(w){
g+=h?"[Array]":r.toString()
}else{
w=!e;
var y=new Array();
for(var s in r){
y.push(s)
}
if(h){
y.sort(function(k,v){
return k-v
}
)
}else{
y.sort()
}
if(n){
g+=h?"[":"{"
}
var c=y.length;
for(var s=0;
s<c;
s++){
var f=y[s];
var o=r[f];
var m=null;
if(o==window||o==document||(!AjxEnv.isIE&&o instanceof Node)){
m=o.toString()
}
if((typeof(o)=="function")){
if(u){
m="[function]"
}else{
continue
}}
if(s>0){
g+=","
}
g+="\n"+a;
if(m!=null){
g+=f+": "+m
}else{
g+=f+": "+this._prettyPrint(o,e,u,t,p+2,true,w)
}}
if(s>0){
g+="\n"+AjxStringUtil.repeat(" ",p-1)
}
if(n){
g+=h?"]":"}"
}}}}}}}}
return g
};
AjxStringUtil._escapeForHTML=function(t){
if(typeof(t)!="string"){
return t
}
var e=t;
e=e.replace(/\&/g,"&amp;");
e=e.replace(/\</g,"&lt;");
e=e.replace(/\>/g,"&gt;");
e=e.replace(/\"/g,"&quot;");
e=e.replace(/\xA0/g,"&nbsp;");
return e
}
}
if(AjxPackage.define("ajax.xml.AjxXmlDoc")){
AjxXmlDoc=function(){
if(!AjxXmlDoc._inited){
AjxXmlDoc._init()
}};
AjxXmlDoc.prototype.toString=function(){
return"AjxXmlDoc"
};
AjxXmlDoc.INVALID_CHARS_RE=/[\u0000-\u0008\u000B-\u000C\u000E-\u001F\uD800-\uDFFF\uFFFE-\uFFFF]/g;
AjxXmlDoc.REC_AVOID_CHARS_RE=/[\u007F-\u0084\u0086-\u009F\uFDD0-\uFDDF]/g;
AjxXmlDoc._inited=false;
AjxXmlDoc._msxmlVers=null;
AjxXmlDoc.create=function(){
var t=new AjxXmlDoc();
var e=null;
if(AjxEnv.isIE){
e=new ActiveXObject(AjxXmlDoc._msxmlVers);
e.async=true;
if(AjxXmlDoc._msxmlVers=="MSXML2.DOMDocument.4.0"){
e.setProperty("SelectionLanguage","XPath");
e.setProperty("SelectionNamespaces","xmlns:zimbra='urn:zimbra' xmlns:mail='urn:zimbraMail' xmlns:account='urn:zimbraAccount'")
}}else{
if(document.implementation&&document.implementation.createDocument){
e=document.implementation.createDocument("","",null)
}else{
throw new AjxException("Unable to create new Doc",AjxException.INTERNAL_ERROR,"AjxXmlDoc.create")
}}
t._doc=e;
return t
};
AjxXmlDoc.createFromDom=function(t){
var e=new AjxXmlDoc();
e._doc=t;
return e
};
AjxXmlDoc.createFromXml=function(e){
var t=AjxXmlDoc.create();
t.loadFromString(e);
return t
};
AjxXmlDoc.replaceInvalidChars=function(e){
AjxXmlDoc.INVALID_CHARS_RE.lastIndex=0;
return e.replace(AjxXmlDoc.INVALID_CHARS_RE,"?")
};
AjxXmlDoc.getXml=function(t){
var e=new XMLSerializer();
return AjxXmlDoc.replaceInvalidChars(e.serializeToString(t))
};
AjxXmlDoc.prototype.getDoc=function(){
return this._doc
};
AjxXmlDoc.prototype.loadFromString=function(t){
var e=this._doc;
e.loadXML(t);
if(AjxEnv.isIE){
if(e.parseError.errorCode!=0){
throw new AjxException(e.parseError.reason,AjxException.INVALID_PARAM,"AjxXmlDoc.loadFromString")
}}};
AjxXmlDoc.prototype.loadFromUrl=function(e){
this._doc.load(e)
};
AjxXmlDoc.prototype.toJSObject=function(a,t,e){
_node=function(){
this.__msh_content=""
};
_node.prototype.toString=function(){
return this.__msh_content
};
rec=function(c,d){
var r={}
,h,u;
for(c=c.firstChild;
c;
c=c.nextSibling){
if(c.nodeType==1){
h=c.tagName;
if(a){
h=h.replace(/^.*?:/,"")
}
if(t){
h=h.toLowerCase()
}
u=new _node();
if(r[h]){
if(r[h]==1){
d[h]=[d[h]];
r[h]=2
}
d[h].push(u)
}else{
d[h]=u;
r[h]=1
}
if(e){
if(c.attributes&&c.attributes.length){
for(var s=0;
s<c.attributes.length;
s++){
attr=c.attributes[s];
u[attr.name]=AjxUtil.isNumeric(attr.value)?attr.value:String(attr.value)
}}}
rec(c,u)
}else{
if(c.nodeType==3){
d.__msh_content+=c.nodeValue
}}}};
var n=new _node();
rec(this._doc.documentElement,n);
return n
};
AjxXmlDoc.prototype.getElementsByTagNameNS=function(t,e){
var a=this.getDoc();
return AjxEnv.isIE?a.getElementsByTagName(t+":"+e):a.getElementsByTagNameNS(t,e)
};
AjxXmlDoc.prototype.getFirstElementByTagNameNS=function(t,e){
return this.getElementsByTagNameNS(t,e)[0]
};
AjxXmlDoc.prototype.getElementsByTagName=function(e){
var t=this.getDoc();
return t.getElementsByTagName(e)
};
AjxXmlDoc._init=function(){
if(AjxEnv.isIE){
var e=["MSXML4.DOMDocument","MSXML3.DOMDocument","MSXML2.DOMDocument.4.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument","MSXML.DOMDocument","Microsoft.XmlDom"];
for(var a=0;
a<e.length;
a++){
try{
new ActiveXObject(e[a]);
AjxXmlDoc._msxmlVers=e[a];
break
}
catch(t){}}
if(!AjxXmlDoc._msxmlVers){
throw new AjxException("MSXML not installed",AjxException.INTERNAL_ERROR,"AjxXmlDoc._init")
}}else{
if(AjxEnv.isNav||AjxEnv.isOpera||AjxEnv.isSafari){
Document.prototype.loadXML=function(c){
var h=new DOMParser();
var n=h.parseFromString(c,"text/xml");
while(this.hasChildNodes()){
this.removeChild(this.lastChild)
}
var o=n.childNodes.length;
for(var s=0;
s<o;
s++){
var r=this.importNode(n.childNodes[s],true);
this.appendChild(r)
}};
if(AjxEnv.isNav){
_NodeGetXml=function(){
var o=new XMLSerializer();
return o.serializeToString(this)
};
Node.prototype.__defineGetter__("xml",_NodeGetXml)
}}}
AjxXmlDoc._inited=true
};
AjxXmlDoc.prototype.set=function(e,o,t){
var n=this._doc.createElement(e);
if(o!=null){
var a=this._doc.createTextNode("");
n.appendChild(a);
a.nodeValue=o
}
if(t==null){
this.root.appendChild(n)
}else{
t.appendChild(n)
}
return n
};
AjxXmlDoc.prototype.getDocXml=function(){
if(AjxEnv.isSafari){
return AjxXmlDoc.getXml(this.getDoc())
}else{
return AjxXmlDoc.replaceInvalidChars(this.getDoc().xml)
}};
AjxXmlDoc.createRoot=function(a){
var e=AjxXmlDoc.create();
var t=e.getDoc();
e.root=t.createElement(a);
t.appendChild(e.root);
return e
};
AjxXmlDoc.createElement=function(t,o){
var e=AjxXmlDoc.create();
var n=e.getDoc();
e.root=n.createElement(t);
if(o!=null){
var a=n.createTextNode("");
e.root.appendChild(a);
a.nodeValue=o
}
n.appendChild(e.root);
return e
};
AjxXmlDoc.prototype.appendChild=function(e){
this.root.appendChild(e.root)
}
}
if(AjxPackage.define("ajax.core.AjxImg")){
AjxImg=function(){};
AjxImg.prototype=new Object;
AjxImg.prototype.constructor=null;
AjxImg._VIEWPORT_ID="AjxImg_VP";
AjxImg.DISABLED=true;
AjxImg.RE_COLOR=/^(.*?),color=(.*)$/;
AjxImg.setImage=function(a,g,f,o){
var u,c=g.match(AjxImg.RE_COLOR);
if(c){
g=c&&c[1];
u=c&&c[2]
}
var e=AjxImg.getClassForImage(g,o);
if(f){
a.className=e;
return
}
var w=e+"Overlay";
var n=e+"Mask";
if(u&&window.AjxImgData&&AjxImgData[w]&&AjxImgData[n]){
u=(u.match(/^\d$/)?ZmOrganizer.COLOR_VALUES[u]:u)||ZmOrganizer.COLOR_VALUES[ZmOrganizer.ORG_DEFAULT_COLOR];
var y=AjxImgData[w],p=AjxImgData[n];
if(AjxEnv.isIE){
var v="";
var s=["width:",y.w,";","height:",y.h,";"].join("");
var k=["top:",p.t,";","left:",p.l,";"].join("");
if(typeof document.documentMode!="undefined"){
v=["clip:rect(",(-1*p.t)-1,"px, ",y.w-1,"px, ",(p.t*-1)+y.h-1,"px, ",y.l,"px);"].join("")
}
a.innerHTML=["<div style='position:relative;",s,"'>","<div style='overflow:hidden;position:relative;",s,"'>","<img src='",p.f,"' ","style='filter:mask(color=",u,");position:absolute;",k,v,"'>","</div>","<div class='",w,"' style='",s,";position:absolute;top:0;left:0'></div>","</div>"].join("");
return
}
if(!y[u]){
var h=y.w,r=y.h;
var t=document.createElement("CANVAS");
t.width=h;
t.height=r;
var d=t.getContext("2d");
d.save();
d.clearRect(0,0,h,r);
d.save();
d.drawImage(document.getElementById(n),p.l,p.t);
d.globalCompositeOperation="source-out";
d.fillStyle=u;
d.fillRect(0,0,h,r);
d.restore();
d.drawImage(document.getElementById(w),y.l,y.t);
d.restore();
y[u]=t.toDataURL()
}
a.innerHTML=["<img src='",y[u],"'>"].join("");
return
}
if(a.firstChild==null){
a.innerHTML=e?"<div class='"+e+"'></div>":"<div></div>";
return
}
a.firstChild.className=e
};
AjxImg.setDisabledImage=function(t,a,e){
return AjxImg.setImage(t,a,e,true)
};
AjxImg.getClassForImage=function(a,t){
var e="Img"+a;
if(t){
e+=" ZDisabledImage"
}
return e
};
AjxImg.getImageClass=function(e){
return e.firstChild?e.firstChild.className:e.className
};
AjxImg.getImageElement=function(e){
return e.firstChild?e.firstChild:e
};
AjxImg.getParentElement=function(e){
return e.parentNode
};
AjxImg.getImageHtml=function(o,s,e,a){
e=e||"";
s=s?(["style='",s,"' "].join("")):"";
var n=a?"<table style='display:inline' cellpadding=0 cellspacing=0 border=0><tr><td align=center valign=bottom>":"";
var t=a?"</td></tr></table>":"";
if(o){
return[n,"<div class='","Img",o,"' ",s," ",e,"></div>",t].join("")
}
return[n,"<div ",s," ",e,"></div>",t].join("")
};
AjxImg.getImageSpanHtml=function(s,r,e,t){
var n=AjxImg.getClassForImage(s);
var o=[];
var a=0;
o[a++]="<span style='white-space:nowrap'>";
o[a++]="<span class='";
o[a++]=n;
o[a++]=" inlineIcon'";
o[a++]=r?([" style='",r,"' "].join("")):"";
o[a++]=e?([" ",e].join("")):"";
o[a++]=">&nbsp;&nbsp;&nbsp;</span>";
o[a++]=(t||"");
o[a++]="</span>";
return o.join("")
}
}
if(AjxPackage.define("ajax.core.AjxColor")){
AjxColor=function(a,t,e){
if(arguments.length==0){
return
}
this.r=a;
this.g=t;
this.b=e
};
AjxColor.prototype.toString=function(){
return AjxColor.color(this.r,this.g,this.b)
};
AjxColor.components=function(t){
var e=AjxColor.__RE.exec(t);
return e?[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]:null
};
AjxColor.color=function(a,t,e){
return["#",AjxColor.__pad(Number(Math.round(a)).toString(16),2),AjxColor.__pad(Number(Math.round(t)).toString(16),2),AjxColor.__pad(Number(Math.round(e)).toString(16),2)].join("")
};
AjxColor.lighten=function(e,a){
var t=AjxColor.components(e);
return t?AjxColor.color(AjxColor.__lighten(t[0],a),AjxColor.__lighten(t[1],a),AjxColor.__lighten(t[2],a)):""
};
AjxColor.darken=function(e,a){
var t=AjxColor.components(e);
return t?AjxColor.color(AjxColor.__darken(t[0],a),AjxColor.__darken(t[1],a),AjxColor.__darken(t[2],a)):""
};
AjxColor.deepen=function(e,a){
var s=AjxColor.components(e);
var t=0;
for(var o=1;
o<s.length;
o++){
if(s[o]>s[t]){
t=o
}}
for(var o=0;
o<s.length;
o++){
var n=s[o]/s[t];
s[o]=Math.floor(s[o]*n*(a||1))
}
return AjxColor.color(s[0],s[1],s[2])
};
AjxColor.__RE=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})/i;
AjxColor.__pad=function(n,a,o){
if(!o){
o="0"
}
var t=String(n);
for(var e=t.length;
e<a;
e++){
t=o+t
}
return t
};
AjxColor.__lighten=function(e,t){
return Math.max(0,Math.min(255,e+(255-e)*t))
};
AjxColor.__darken=function(e,t){
return Math.max(0,Math.min(255,e+(1-e)*t))
}
}
if(AjxPackage.define("ajax.events.AjxEvent")){
AjxEvent=function(){
this.data=null
};
AjxEvent.HISTORY="HISTORY";
AjxEvent.prototype.toString=function(){
return"AjxEvent"
}
}
if(AjxPackage.define("ajax.events.AjxEventMgr")){
AjxEventMgr=function(){
this._listeners=new Object()
};
AjxEventMgr.prototype.toString=function(){
return"AjxEventMgr"
};
AjxEventMgr.prototype.addListener=function(t,a,e){
var o=this._listeners[t];
if(o==null){
o=this._listeners[t]=new AjxVector()
}
if(!o.contains(a)){
if(this._notifyingListeners){
o=this._listeners[t]=o.clone()
}
o.add(a,e);
return true
}
return false
};
AjxEventMgr.prototype.notifyListeners=function(o,r){
this._notifyingListeners=true;
var d=this._listeners[o];
if(d!=null){
var e=d.getArray();
var n=d.size();
var h=null;
var u=null;
for(var t=0;
t<n;
t++){
u=e[t];
if(!(u&&((u instanceof AjxListener)||(typeof u=="function")))){
continue
}
h=u.handleEvent?u.handleEvent(r):u(r);
if(h===false){
break
}}}
this._notifyingListeners=false;
return h
};
AjxEventMgr.prototype.isListenerRegistered=function(e){
var t=this._listeners[e];
return(t!=null&&t.size()>0)
};
AjxEventMgr.prototype.removeListener=function(e,t){
var a=this._listeners[e];
if(a!=null){
if(this._notifyingListeners){
a=this._listeners[e]=a.clone()
}
a.remove(t);
return true
}
return false
};
AjxEventMgr.prototype.removeAll=function(e){
var t=this._listeners[e];
if(t!=null){
if(this._notifyingListeners){
t=this._listeners[e]=t.clone()
}
t.removeAll();
return true
}
return false
}
}
if(AjxPackage.define("ajax.util.AjxTimedAction")){
AjxTimedAction=function(a,t,e){
AjxCallback.call(this,a,t,e);
this._tid=-1;
this._id=-1;
this._runResult=null
};
AjxTimedAction.prototype=new AjxCallback();
AjxTimedAction.prototype.constructor=AjxTimedAction;
AjxTimedAction.MAX_TIMEOUT=20*24*60*60*1000;
AjxTimedAction.prototype.toString=function(){
return"AjxTimedAction"
};
AjxTimedAction.prototype.getRunResult=function(){
return this._runResult
};
AjxTimedAction._pendingActions={};
AjxTimedAction._nextActionId=1;
AjxTimedAction.scheduleAction=function(a,t){
if(!a){
return
}
if(a._tid&&a._tid!=-1){
AjxTimedAction.cancelAction(a._id)
}
t=t||0;
if(t>AjxTimedAction.MAX_TIMEOUT){
if(window.DBG){}
t=AjxTimedAction.MAX_TIMEOUT
}
var o=a._id=AjxTimedAction._nextActionId++;
AjxTimedAction._pendingActions[o]=a;
var e="AjxTimedAction._exec("+o+")";
a._tid=window.setTimeout(e,t);
return a._id
};
AjxTimedAction.cancelAction=function(t){
var e=AjxTimedAction._pendingActions[t];
if(e){
window.clearTimeout(e._tid);
delete AjxTimedAction._pendingActions[t];
delete e._tid
}};
AjxTimedAction._exec=function(t){
var e=AjxTimedAction._pendingActions[t];
if(e){
delete AjxTimedAction._pendingActions[t];
delete e._tid;
e._runResult=e.run()
}}
}
if(AjxPackage.define("ajax.net.AjxInclude")){
AjxInclude=function(o,s,n,a){
var t=document.getElementsByTagName("head")[0];
function e(h){
if(AjxEnv.isIE&&h&&!/loaded|complete/.test(h.readyState)){
return
}
if(h){
h[AjxInclude.eventName]=null
}
var r=AjxInclude.dwhack_scripts.length>0?AjxInclude.dwhack_scripts:o;
window.status="";
if(r.length>0){
var d=r.shift();
var u=d;
if(!/^((https?|ftps?):\x2f\x2f|\x2f)/.test(d)){
if(s){
d=s+d
}
if(cacheKillerVersion){
d+="?v="+cacheKillerVersion
}}else{
if(a&&d.indexOf("/")!=0){
d=a+AjxStringUtil.urlEncode(d)
}}
var h=document.createElement("script");
var c=AjxCallback.simpleClosure(e,null,h);
if(AjxEnv.isIE){
h.attachEvent("onreadystatechange",c);
h.attachEvent("onerror",c)
}else{
h.addEventListener("load",c,true);
h.addEventListener("error",c,true)
}
h.type="text/javascript";
h.src=d;
window.status="Loading script: "+u;
t.appendChild(h)
}else{
if(o.length==0){
h=null;
t=null;
if(n){
n.run()
}}}}
e(null)
};
AjxInclude.dwhack_scripts=[];
document.write=document.writeln=function(){
var e=[];
for(var t=0;
t<arguments.length;
++t){
e[t]=arguments[t]
}
var o=e.join("");
if(/<script[^>]+src=([\x22\x27])(.*?)\1/i.test(o)){
AjxInclude.dwhack_scripts.push(RegExp.$2)
}};
if(AjxEnv.isIE){
AjxInclude._removeWriteln=function(){
document.write=document.writeln=null;
window.detachEvent("onunload",AjxInclude._removeWriteln)
};
window.attachEvent("onunload",AjxInclude._removeWriteln)
}}

if(AjxPackage.define("ajax.events.AjxListener")){
AjxListener=function(t,a,e){
AjxCallback.call(this,t,a,e)
};
AjxListener.prototype=new AjxCallback();
AjxListener.prototype.constructor=AjxListener;
AjxListener.prototype.toString=function(){
return"AjxListener"
};
AjxListener.prototype.handleEvent=function(e){
return this.run(e)
}
}
if(AjxPackage.define("ajax.util.AjxText")){
AjxFormat=function(e){
this._pattern=e;
this._segments=[]
};
AjxFormat.prototype.toString=function(){
var t=[];
t.push('pattern="',this._pattern,'"');
if(this._segments.length>0){
t.push(", segments={ ");
for(var e=0;
e<this._segments.length;
e++){
if(e>0){
t.push(", ")
}
t.push(String(this._segments[e]))
}
t.push(" }")
}
return t.join("")
};
AjxFormat.prototype._pattern;
AjxFormat.prototype._segments;
AjxFormat.initialize=function(){
AjxDateFormat.initialize();
AjxNumberFormat.initialize()
};
AjxFormat.prototype.format=function(e){
var a=[];
for(var t=0;
t<this._segments.length;
t++){
a.push(this._segments[t].format(e))
}
return a.join("")
};
AjxFormat.prototype.parse=function(o){
var t=this._createParseObject();
var e=0;
for(var a=0;
a<this._segments.length;
a++){
var n=this._segments[a];
e=n.parse(t,o,e)
}
if(e<o.length){
throw new AjxFormat.ParsingException(this,null,"input too long")
}
return t
};
AjxFormat.prototype.getSegments=function(){
return this._segments
};
AjxFormat.prototype.toPattern=function(){
return this._pattern
};
AjxFormat.prototype.clone=function(){
return new this.constructor(this._pattern)
};
AjxFormat.prototype._createParseObject=function(e){
throw new AjxFormat.ParsingException(this,null,"not implemented")
};
AjxFormat._zeroPad=function(n,r,t,h){
n=typeof n=="string"?n:String(n);
if(n.length>=r){
return n
}
t=t||"0";
var e=[];
for(var o=n.length;
o<r;
o++){
e.push(t)
}
e[h?"unshift":"push"](n);
return e.join("")
};
AjxFormat.FormatException=function(t,e){
this._format=t;
this._message=e
};
AjxFormat.FormatException.prototype.toString=function(){
return this._message
};
AjxFormat.FormatException.prototype._format;
AjxFormat.FormatException.prototype._message;
AjxFormat.FormattingException=function(a,t,e){
AjxFormat.FormatException.call(this,a,e);
this._segment=t
};
AjxFormat.FormattingException.prototype=new AjxFormat.FormatException;
AjxFormat.FormattingException.prototype.constructor=AjxFormat.FormattingException;
AjxFormat.FormattingException.prototype._segment;
AjxFormat.ParsingException=function(a,t,e){
AjxFormat.FormatException.call(this,a,e);
this._segment=t
};
AjxFormat.ParsingException.prototype=new AjxFormat.FormatException;
AjxFormat.ParsingException.prototype.constructor=AjxFormat.ParsingException;
AjxFormat.ParsingException.prototype._segment;
AjxFormat.Segment=function(t,e){
this._parent=t;
this._s=e
};
AjxFormat.Segment.prototype.toString=function(){
return'segment: "'+this._s+'"'
};
AjxFormat.Segment.prototype._parent;
AjxFormat.Segment.prototype._s;
AjxFormat.Segment.prototype.format=function(e){
return this._s
};
AjxFormat.Segment.prototype.parse=function(a,t,e){
throw new AjxFormat.ParsingException(this._parent,this,"not implemented")
};
AjxFormat.Segment.prototype.getFormat=function(){
return this._parent
};
AjxFormat.Segment.prototype.toSubPattern=function(){
return this._s
};
AjxFormat.Segment.prototype._getFixedLength=function(){
var e;
if(this._index+1<this._parent._segments.length){
var t=this._parent._segments[this._index+1];
if(!(t instanceof AjxFormat.TextSegment)){
e=this._s.length
}}
return e
};
AjxFormat.Segment._parseLiteral=function(o,a,e){
if(a.length-e<o.length){
throw new AjxFormat.ParsingException(this._parent,this,"input too short")
}
for(var t=0;
t<o.length;
t++){
if(o.charAt(t)!=a.charAt(e+t)){
throw new AjxFormat.ParsingException(this._parent,this,"input doesn't match")
}}
return e+o.length
};
AjxFormat.Segment._parseLiterals=function(a,h,m,t,g,c){
for(var r=0;
r<t.length;
r++){
try{
var p=t[r];
var n=AjxFormat.Segment._parseLiteral(p,g,c);
if(h){
var u=a||window;
if(typeof h=="function"){
h.call(u,r+m)
}else{
u[h]=r+m
}}
return n
}
catch(d){}}
return -1
};
AjxFormat.Segment._parseInt=function(t,n,g,y,r,e,m){
var h=e||y.length-r;
var u=r;
for(var a=0;
a<h;
a++){
if(!y.charAt(r++).match(/\d/)){
r--;
break
}}
var d=r;
if(u==d){
throw new AjxFormat.ParsingException(this._parent,this,"number not present")
}
if(e&&d-u!=e){
throw new AjxFormat.ParsingException(this._parent,this,"number too short")
}
var p=parseInt(y.substring(u,d),m||10);
if(n){
var c=t||window;
if(typeof n=="function"){
n.call(c,p+g)
}else{
c[n]=p+g
}}
return d
};
AjxDateFormat=function(s){
AjxFormat.call(this,s);
if(typeof s=="number"){
switch(s){
case AjxDateFormat.SHORT:s=I18nMsg.formatDateShort;
break;
case AjxDateFormat.MEDIUM:s=I18nMsg.formatDateMedium;
break;
case AjxDateFormat.LONG:s=I18nMsg.formatDateLong;
break;
case AjxDateFormat.FULL:s=I18nMsg.formatDateFull;
break
}}
for(var a=0;
a<s.length;
a++){
var h=s.charAt(a);
if(h=="'"){
var t=a+1;
for(a++;
a<s.length;
a++){
var h=s.charAt(a);
if(h=="'"){
if(a+1<s.length&&s.charAt(a+1)=="'"){
s=s.substr(0,a)+s.substr(a+1)
}else{
break
}}}
if(a==s.length){}
var e=a;
var n=new AjxFormat.TextSegment(this,s.substring(t,e));
this._segments.push(n);
continue
}
var t=a;
while(a<s.length){
h=s.charAt(a);
if(AjxDateFormat._META_CHARS.indexOf(h)!=-1||h=="'"){
break
}
a++
}
var e=a;
if(t!=e){
var n=new AjxFormat.TextSegment(this,s.substring(t,e));
this._segments.push(n);
a--;
continue
}
var t=a;
while(++a<s.length){
if(s.charAt(a)!=h){
break
}}
var e=a--;
var o=e-t;
var r=s.substr(t,o);
var n=null;
switch(h){
case"G":n=new AjxDateFormat.EraSegment(this,r);
break;
case"y":n=new AjxDateFormat.YearSegment(this,r);
break;
case"M":n=new AjxDateFormat.MonthSegment(this,r);
break;
case"w":n=new AjxDateFormat.WeekSegment(this,r);
break;
case"W":n=new AjxDateFormat.WeekSegment(this,r);
break;
case"D":n=new AjxDateFormat.DaySegment(this,r);
break;
case"d":n=new AjxDateFormat.DaySegment(this,r);
break;
case"F":n=new AjxDateFormat.WeekdaySegment(this,r);
break;
case"E":n=new AjxDateFormat.WeekdaySegment(this,r);
break;
case"a":n=new AjxDateFormat.AmPmSegment(this,r);
break;
case"H":n=new AjxDateFormat.HourSegment(this,r);
break;
case"k":n=new AjxDateFormat.HourSegment(this,r);
break;
case"K":n=new AjxDateFormat.HourSegment(this,r);
break;
case"h":n=new AjxDateFormat.HourSegment(this,r);
break;
case"m":n=new AjxDateFormat.MinuteSegment(this,r);
break;
case"s":n=new AjxDateFormat.SecondSegment(this,r);
break;
case"S":n=new AjxDateFormat.SecondSegment(this,r);
break;
case"z":n=new AjxDateFormat.TimezoneSegment(this,r);
break;
case"Z":n=new AjxDateFormat.TimezoneSegment(this,r);
break
}
if(n!=null){
n._index=this._segments.length;
this._segments.push(n)
}}};
AjxDateFormat.prototype=new AjxFormat;
AjxDateFormat.prototype.constructor=AjxDateFormat;
AjxDateFormat.prototype.toString=function(){
return"[AjxDateFormat: "+AjxFormat.prototype.toString.call(this)+"]"
};
AjxDateFormat.SHORT=0;
AjxDateFormat.MEDIUM=1;
AjxDateFormat.LONG=2;
AjxDateFormat.FULL=3;
AjxDateFormat.DEFAULT=AjxDateFormat.MEDIUM;
AjxDateFormat._META_CHARS="GyMwWDdFEaHkKhmsSzZ";
AjxDateFormat.getDateInstance=function(e){
e=e!=null?e:AjxDateFormat.DEFAULT;
if(!AjxDateFormat._DATE_FORMATTERS[e]){
AjxDateFormat._DATE_FORMATTERS[e]=new AjxDateFormat(AjxDateFormat._dateFormats[e])
}
return AjxDateFormat._DATE_FORMATTERS[e]
};
AjxDateFormat.getTimeInstance=function(e){
e=e!=null?e:AjxDateFormat.DEFAULT;
if(!AjxDateFormat._TIME_FORMATTERS[e]){
AjxDateFormat._TIME_FORMATTERS[e]=new AjxDateFormat(AjxDateFormat._timeFormats[e])
}
return AjxDateFormat._TIME_FORMATTERS[e]
};
AjxDateFormat.getDateTimeInstance=function(e,t){
e=e!=null?e:AjxDateFormat.DEFAULT;
t=t!=null?t:AjxDateFormat.DEFAULT;
var o=e*10+t;
if(!AjxDateFormat._DATETIME_FORMATTERS[o]){
var n=I18nMsg.formatDateTime;
var s=[AjxDateFormat._dateFormats[e],AjxDateFormat._timeFormats[t]];
var a=AjxMessageFormat.format(n,s);
AjxDateFormat._DATETIME_FORMATTERS[o]=new AjxDateFormat(a)
}
return AjxDateFormat._DATETIME_FORMATTERS[o]
};
AjxDateFormat.format=function(t,e){
return new AjxDateFormat(t).format(e)
};
AjxDateFormat.parse=function(t,e){
return new AjxDateFormat(t).parse(e)
};
AjxDateFormat.initialize=function(){
AjxDateFormat._dateFormats=[I18nMsg.formatDateShort,I18nMsg.formatDateMedium,I18nMsg.formatDateLong,I18nMsg.formatDateFull];
AjxDateFormat._timeFormats=[I18nMsg.formatTimeShort,I18nMsg.formatTimeMedium,I18nMsg.formatTimeLong,I18nMsg.formatTimeFull];
AjxDateFormat._DATE_FORMATTERS={};
AjxDateFormat._TIME_FORMATTERS={};
AjxDateFormat._DATETIME_FORMATTERS={};
AjxDateFormat.MonthSegment.initialize();
AjxDateFormat.WeekdaySegment.initialize()
};
AjxDateFormat.prototype.parse=function(n){
var o=null;
try{
o=AjxFormat.prototype.parse.call(this,n);
var a=new Date(0,0,1,0,0,0,0);
if(o.year!=null){
a.setFullYear(o.year)
}
if(o.month!=null){
a.setMonth(o.month)
}
if(o.dayofmonth!=null){
a.setDate(o.dayofmonth)
}else{
if(o.dayofyear!=null){
a.setMonth(0,o.dayofyear)
}}
if(o.hours!=null){
a.setHours(o.hours)
}
if(o.minutes!=null){
a.setMinutes(o.minutes)
}
if(o.seconds!=null){
a.setSeconds(o.seconds)
}
if(o.milliseconds!=null){
a.setMilliseconds(o.milliseconds)
}
if(o.ampm!=null){
var t=a.getHours();
if(t==12&&o.ampm==0){
t=0
}else{
if(t!=12&&o.ampm==1){
t+=12
}}
a.setHours(t)
}
o=a
}
catch(r){}
return o
};
AjxDateFormat.prototype._createParseObject=function(){
return{
year:null,month:null,dayofmonth:null,dayofyear:null,hours:null,minutes:null,seconds:null,milliseconds:null,ampm:null,era:null,timezone:null}
};
AjxFormat.TextSegment=function(t,e){
AjxFormat.Segment.call(this,t,e)
};
AjxFormat.TextSegment.prototype=new AjxFormat.Segment;
AjxFormat.TextSegment.prototype.constructor=AjxFormat.TextSegment;
AjxFormat.TextSegment.prototype.toString=function(){
return'text: "'+this._s+'"'
};
AjxFormat.TextSegment.prototype.parse=function(a,t,e){
return AjxFormat.Segment._parseLiteral(this._s,t,e)
};
AjxDateFormat.DateSegment=function(t,e){
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.DateSegment.prototype=new AjxFormat.Segment;
AjxDateFormat.DateSegment.prototype.constructor=AjxDateFormat.DateSegment;
AjxDateFormat.EraSegment=function(t,e){
AjxDateFormat.DateSegment.call(this,t,e)
};
AjxDateFormat.EraSegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.EraSegment.prototype.constructor=AjxDateFormat.EraSegment;
AjxDateFormat.EraSegment.prototype.toString=function(){
return'dateEra: "'+this._s+'"'
};
AjxDateFormat.EraSegment.prototype.format=function(e){
return I18nMsg.eraAD
};
AjxDateFormat.YearSegment=function(t,e){
AjxDateFormat.DateSegment.call(this,t,e)
};
AjxDateFormat.YearSegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.YearSegment.prototype.constructor=AjxDateFormat.YearSegment;
AjxDateFormat.YearSegment.prototype.toString=function(){
return'dateYear: "'+this._s+'"'
};
AjxDateFormat.YearSegment.prototype.format=function(e){
var t=String(e.getFullYear());
return this._s.length<4?t.substr(t.length-2):AjxFormat._zeroPad(t,this._s.length)
};
AjxDateFormat.YearSegment.prototype.parse=function(a,d,n){
var e=this._getFixedLength();
var t=AjxFormat.Segment._parseInt(a,"year",0,d,n,e);
if(t-n==2){
if(!AjxDateFormat._2digitStartYear){
AjxDateFormat._2digitStartYear=parseInt(AjxMsg.dateParsing2DigitStartYear)
}
var h=AjxDateFormat._2digitStartYear;
var c=parseInt(d.substr(n,2),10);
var o=(Math.floor(h/100)+(c<(h%100)?1:0))*100;
var r=o+c;
a.year=r
}
return t
};
AjxDateFormat.MonthSegment=function(t,e){
AjxDateFormat.DateSegment.call(this,t,e)
};
AjxDateFormat.MonthSegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.MonthSegment.prototype.constructor=AjxDateFormat.MonthSegment;
AjxDateFormat.MonthSegment.prototype.toString=function(){
return'dateMonth: "'+this._s+'"'
};
AjxDateFormat.MonthSegment.initialize=function(){
AjxDateFormat.MonthSegment.MONTHS={};
AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.SHORT]=[AjxMsg.monthJanShort,AjxMsg.monthFebShort,AjxMsg.monthMarShort,AjxMsg.monthAprShort,AjxMsg.monthMayShort,AjxMsg.monthJunShort,AjxMsg.monthJulShort,AjxMsg.monthAugShort,AjxMsg.monthSepShort,AjxMsg.monthOctShort,AjxMsg.monthNovShort,AjxMsg.monthDecShort];
AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.MEDIUM]=[I18nMsg.monthJanMedium,I18nMsg.monthFebMedium,I18nMsg.monthMarMedium,I18nMsg.monthAprMedium,I18nMsg.monthMayMedium,I18nMsg.monthJunMedium,I18nMsg.monthJulMedium,I18nMsg.monthAugMedium,I18nMsg.monthSepMedium,I18nMsg.monthOctMedium,I18nMsg.monthNovMedium,I18nMsg.monthDecMedium];
AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.LONG]=[I18nMsg.monthJanLong,I18nMsg.monthFebLong,I18nMsg.monthMarLong,I18nMsg.monthAprLong,I18nMsg.monthMayLong,I18nMsg.monthJunLong,I18nMsg.monthJulLong,I18nMsg.monthAugLong,I18nMsg.monthSepLong,I18nMsg.monthOctLong,I18nMsg.monthNovLong,I18nMsg.monthDecLong]
};
AjxDateFormat.MonthSegment.prototype.format=function(e){
var t=e.getMonth();
switch(this._s.length){
case 1:return String(t+1);
case 2:return AjxFormat._zeroPad(t+1,2);
case 3:return AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.MEDIUM][t];
case 5:return AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.SHORT][t]
}
return AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.LONG][t]
};
AjxDateFormat.MonthSegment.prototype.parse=function(a,n,t){
var e;
switch(this._s.length){
case 3:e=AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.MEDIUM];
case 4:e=e||AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.LONG];
case 5:e=e||AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.SHORT];
var o=AjxFormat.Segment._parseLiterals(a,"month",0,e,n,t);
if(o==-1){
throw new AjxFormat.ParsingException(this._parent,this,"no match")
}
return o
}
var r=this._getFixedLength();
return AjxFormat.Segment._parseInt(a,"month",-1,n,t,r)
};
AjxDateFormat.WeekSegment=function(t,e){
AjxDateFormat.DateSegment.call(this,t,e)
};
AjxDateFormat.WeekSegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.WeekSegment.prototype.constructor=AjxDateFormat.WeekSegment;
AjxDateFormat.WeekSegment.prototype.toString=function(){
return'weekMonth: "'+this._s+'"'
};
AjxDateFormat.WeekSegment.prototype.format=function(t){
var o=t.getYear();
var s=t.getMonth();
var e=t.getDate();
var r=/w/.test(this._s);
var n=new Date(o,r?0:s,1);
var a=0;
while(true){
a++;
if(n.getMonth()>s||(n.getMonth()==s&&n.getDate()>=e)){
break
}
n.setDate(n.getDate()+7)
}
return AjxFormat._zeroPad(a,this._s.length)
};
AjxDateFormat.WeekSegment.prototype.parse=function(t,a,e){
var o=this._getFixedLength();
return AjxFormat.Segment._parseInt(null,null,0,a,e,o)
};
AjxDateFormat.DaySegment=function(t,e){
AjxDateFormat.DateSegment.call(this,t,e)
};
AjxDateFormat.DaySegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.DaySegment.prototype.constructor=AjxDateFormat.DaySegment;
AjxDateFormat.DaySegment.prototype.toString=function(){
return'dateDay: "'+this._s+'"'
};
AjxDateFormat.DaySegment.prototype.format=function(t){
var n=t.getMonth();
var e=t.getDate();
if(/D/.test(this._s)&&n>0){
var a=t.getYear();
do{
var o=new Date(a,n,1);
o.setDate(0);
e+=o.getDate();
n--
}
while(n>0)
}
return AjxFormat._zeroPad(e,this._s.length)
};
AjxDateFormat.DaySegment.prototype.parse=function(t,o,e){
var n=this._getFixedLength();
var a=/D/.test(this._s)?"dayofyear":"dayofmonth";
return AjxFormat.Segment._parseInt(t,a,0,o,e,n)
};
AjxDateFormat.WeekdaySegment=function(t,e){
AjxDateFormat.DateSegment.call(this,t,e)
};
AjxDateFormat.WeekdaySegment.prototype=new AjxDateFormat.DateSegment;
AjxDateFormat.WeekdaySegment.prototype.constructor=AjxDateFormat.WeekdaySegment;
AjxDateFormat.DaySegment.prototype.toString=function(){
return'dateDay: "'+this._s+'"'
};
AjxDateFormat.WeekdaySegment.initialize=function(){
AjxDateFormat.WeekdaySegment.WEEKDAYS={};
AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.SHORT]=[AjxMsg.weekdaySunShort,AjxMsg.weekdayMonShort,AjxMsg.weekdayTueShort,AjxMsg.weekdayWedShort,AjxMsg.weekdayThuShort,AjxMsg.weekdayFriShort,AjxMsg.weekdaySatShort];
AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.MEDIUM]=[I18nMsg.weekdaySunMedium,I18nMsg.weekdayMonMedium,I18nMsg.weekdayTueMedium,I18nMsg.weekdayWedMedium,I18nMsg.weekdayThuMedium,I18nMsg.weekdayFriMedium,I18nMsg.weekdaySatMedium];
AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.LONG]=[I18nMsg.weekdaySunLong,I18nMsg.weekdayMonLong,I18nMsg.weekdayTueLong,I18nMsg.weekdayWedLong,I18nMsg.weekdayThuLong,I18nMsg.weekdayFriLong,I18nMsg.weekdaySatLong]
};
AjxDateFormat.WeekdaySegment.prototype.format=function(e){
var a=e.getDay();
if(/E/.test(this._s)){
var t;
switch(this._s.length){
case 4:t=AjxDateFormat.LONG;
break;
case 5:t=AjxDateFormat.SHORT;
break;
default:t=AjxDateFormat.MEDIUM
}
return AjxDateFormat.WeekdaySegment.WEEKDAYS[t][a]
}
return AjxFormat._zeroPad(a,this._s.length)
};
AjxDateFormat.WeekdaySegment.prototype.parse=function(a,n,t){
var e;
switch(this._s.length){
case 3:e=AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.MEDIUM];
case 4:e=e||AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.LONG];
case 5:e=e||AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.SHORT];
var o=AjxFormat.Segment._parseLiterals(null,null,0,e,n,t);
if(o==-1){
throw new AjxFormat.ParsingException(this._parent,this,"no match")
}
return o
}
var r=this._getFixedLength();
return AjxFormat.Segment._parseInt(null,null,0,n,t,r)
};
AjxDateFormat.TimeSegment=function(t,e){
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.TimeSegment.prototype=new AjxFormat.Segment;
AjxDateFormat.TimeSegment.prototype.constructor=AjxDateFormat.TimeSegment;
AjxDateFormat.HourSegment=function(t,e){
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.HourSegment.prototype=new AjxDateFormat.TimeSegment;
AjxDateFormat.HourSegment.prototype.constructor=AjxDateFormat.HourSegment;
AjxDateFormat.HourSegment.prototype.toString=function(){
return'timeHour: "'+this._s+'"'
};
AjxDateFormat.HourSegment.prototype.format=function(t){
var e=t.getHours();
if(e>12&&/[hK]/.test(this._s)){
e-=12
}else{
if(e==0&&/[h]/.test(this._s)){
e=12
}}
return AjxFormat._zeroPad(e,this._s.length)
};
AjxDateFormat.HourSegment.prototype.parse=function(t,a,e){
var o=this._getFixedLength();
return AjxFormat.Segment._parseInt(t,"hours",0,a,e,o)
};
AjxDateFormat.MinuteSegment=function(t,e){
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.MinuteSegment.prototype=new AjxDateFormat.TimeSegment;
AjxDateFormat.MinuteSegment.prototype.constructor=AjxDateFormat.MinuteSegment;
AjxDateFormat.MinuteSegment.prototype.toString=function(){
return'timeMinute: "'+this._s+'"'
};
AjxDateFormat.MinuteSegment.prototype.format=function(e){
var t=e.getMinutes();
return AjxFormat._zeroPad(t,this._s.length)
};
AjxDateFormat.MinuteSegment.prototype.parse=function(t,a,e){
var o=this._getFixedLength();
return AjxFormat.Segment._parseInt(t,"minutes",0,a,e,o)
};
AjxDateFormat.SecondSegment=function(t,e){
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.SecondSegment.prototype=new AjxDateFormat.TimeSegment;
AjxDateFormat.SecondSegment.prototype.constructor=AjxDateFormat.SecondSegment;
AjxDateFormat.SecondSegment.prototype.toString=function(){
return'timeSecond: "'+this._s+'"'
};
AjxDateFormat.SecondSegment.prototype.format=function(e){
var t=/s/.test(this._s)?e.getSeconds():e.getMilliseconds();
return AjxFormat._zeroPad(t,this._s.length)
};
AjxDateFormat.SecondSegment.prototype.parse=function(t,o,e){
var n=this._getFixedLength();
var a=/s/.test(this._s)?"seconds":"milliseconds";
return AjxFormat.Segment._parseInt(t,a,0,o,e,n)
};
AjxDateFormat.AmPmSegment=function(t,e){
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.AmPmSegment.prototype=new AjxDateFormat.TimeSegment;
AjxDateFormat.AmPmSegment.prototype.constructor=AjxDateFormat.AmPmSegment;
AjxDateFormat.AmPmSegment.prototype.toString=function(){
return'timeAmPm: "'+this._s+'"'
};
AjxDateFormat.AmPmSegment.prototype.format=function(t){
var e=t.getHours();
return e<12?I18nMsg.periodAm:I18nMsg.periodPm
};
AjxDateFormat.AmPmSegment.prototype.parse=function(t,o,e){
var n=[I18nMsg.periodAm.toLowerCase(),I18nMsg.periodPm.toLowerCase(),I18nMsg.periodAm.toUpperCase(),I18nMsg.periodPm.toUpperCase()];
var a=AjxFormat.Segment._parseLiterals(t,"ampm",0,n,o,e);
if(a==-1){
throw new AjxFormat.ParsingException(this._parent,this,"no match")
}
t.ampm=t.ampm%2;
return a
};
AjxDateFormat.TimezoneSegment=function(t,e){
AjxFormat.Segment.call(this,t,e)
};
AjxDateFormat.TimezoneSegment.prototype=new AjxDateFormat.TimeSegment;
AjxDateFormat.TimezoneSegment.prototype.constructor=AjxDateFormat.TimezoneSegment;
AjxDateFormat.TimezoneSegment.prototype.toString=function(){
return'timeTimezone: "'+this._s+'"'
};
AjxDateFormat.TimezoneSegment.prototype.format=function(t){
var e=t.timezone||AjxTimezone.DEFAULT;
if(/Z/.test(this._s)){
return AjxTimezone.getShortName(e)
}
return this._s.length<4?AjxTimezone.getMediumName(e):AjxTimezone.getLongName(e)
};
AjxMessageFormat=function(s){
if(!s){
return""
}
AjxFormat.call(this,s);
for(var t=0;
t<s.length;
t++){
var r=s.charAt(t);
if(r=="'"){
if(t+1<s.length&&s.charAt(t+1)=="'"){
var a=new AjxFormat.TextSegment(this,"'");
this._segments.push(a);
t++;
continue
}
var h=t+1;
for(t++;
t<s.length;
t++){
var r=s.charAt(t);
if(r=="'"){
if(t+1<s.length&&s.charAt(t+1)=="'"){
s=s.substr(0,t)+s.substr(t+1)
}else{
break
}}}
if(t==s.length){}
var n=t;
var a=new AjxFormat.TextSegment(this,s.substring(h,n));
this._segments.push(a);
continue
}
var h=t;
while(t<s.length){
r=s.charAt(t);
if(r=="{"||r=="'"){
break
}
t++
}
var n=t;
if(h!=n){
var a=new AjxFormat.TextSegment(this,s.substring(h,n));
this._segments.push(a);
t--;
continue
}
var h=t+1;
var e=0;
while(++t<s.length){
var r=s.charAt(t);
if(r=="{"){
e++
}else{
if(r=="}"){
if(e==0){
break
}
e--
}}}
var n=t;
var o=n-h;
var d=s.substr(h,o);
var a=new AjxMessageFormat.MessageSegment(this,d);
if(a!=null){
this._segments.push(a)
}}};
AjxMessageFormat.prototype=new AjxFormat;
AjxMessageFormat.prototype.constructor=AjxMessageFormat;
AjxMessageFormat.prototype.toString=function(){
return"[AjxMessageFormat: "+AjxFormat.prototype.toString.call(this)+"]"
};
AjxMessageFormat.format=function(e,t){
return new AjxMessageFormat(e).format(t)
};
AjxMessageFormat.prototype.format=function(e){
if(!(e instanceof Array)){
e=[e]
}
return AjxFormat.prototype.format.call(this,e)
};
AjxMessageFormat.prototype.getFormats=function(){
var e=[];
for(var t=0;
t<this._segments.length;
t++){
var a=this._segments[t];
if(a instanceof AjxMessageFormat.MessageSegment){
e.push(a.getSegmentFormat())
}}
return e
};
AjxMessageFormat.prototype.getFormatsByArgumentIndex=function(){
var e=[];
for(var t=0;
t<this._segments.length;
t++){
var a=this._segments[t];
if(a instanceof AjxMessageFormat.MessageSegment){
e[a.getIndex()]=a.getSegmentFormat()
}}
return e
};
AjxMessageFormat.MessageSegment=function(o,e){
AjxFormat.Segment.call(this,o,e);
var a=AjxMessageFormat.MessageSegment._split(e,",");
this._index=Number(a[0]);
this._type=a[1]||"string";
this._style=a[2];
if(this._type=="list"){
this._isList=true;
this._type=a[2]||"string";
this._style=a[3]
}
switch(this._type){
case"number":switch(this._style){
case"integer":this._formatter=AjxNumberFormat.getIntegerInstance();
break;
case"currency":this._formatter=AjxNumberFormat.getCurrencyInstance();
break;
case"percent":this._formatter=AjxNumberFormat.getPercentInstance();
break;
default:this._formatter=this._style==null?AjxNumberFormat.getInstance():new AjxNumberFormat(this._style)
}
break;
case"date":case"time":var t=this._type=="date"?AjxDateFormat.getDateInstance:AjxDateFormat.getTimeInstance;
switch(this._style){
case"short":this._formatter=t(AjxDateFormat.SHORT);
break;
case"medium":this._formatter=t(AjxDateFormat.MEDIUM);
break;
case"long":this._formatter=t(AjxDateFormat.LONG);
break;
case"full":this._formatter=t(AjxDateFormat.FULL);
break;
default:this._formatter=this._style==null?t(AjxDateFormat.DEFAULT):new AjxDateFormat(this._style)
}
break;
case"choice":this._formatter=new AjxChoiceFormat(this._style);
break
}
if(this._isList){
this._formatter=new AjxListFormat(this._formatter)
}};
AjxMessageFormat.MessageSegment.prototype=new AjxFormat.Segment;
AjxMessageFormat.MessageSegment.prototype.constructor=AjxMessageFormat.MessageSegment;
AjxMessageFormat.MessageSegment.prototype.toString=function(){
var e=['message: "',this._s,'", index: ',this._index];
if(this._isList){
e.push(", list: ",this._isList)
}
if(this._type){
e.push(", type: ",this._type)
}
if(this._style){
e.push(", style: ",this._style)
}
if(this._formatter){
e.push(", formatter: ",this._formatter.toString())
}
return e.join("")
};
AjxMessageFormat.MessageSegment.prototype._index;
AjxMessageFormat.MessageSegment.prototype._type;
AjxMessageFormat.MessageSegment.prototype._style;
AjxMessageFormat.MessageSegment.prototype._isList=false;
AjxMessageFormat.MessageSegment.prototype._formatter;
AjxMessageFormat.MessageSegment.prototype.format=function(t){
var e=t[this._index];
if(this._formatter instanceof AjxChoiceFormat){
return this._formatter.format(t,this._index)
}
return this._formatter?this._formatter.format(e):String(e)
};
AjxMessageFormat.MessageSegment.prototype.getIndex=function(){
return this._index
};
AjxMessageFormat.MessageSegment.prototype.getType=function(){
return this._type
};
AjxMessageFormat.MessageSegment.prototype.getStyle=function(){
return this._style
};
AjxMessageFormat.MessageSegment.prototype.getSegmentFormat=function(){
return this._formatter
};
AjxMessageFormat.MessageSegment._split=function(o,e){
var n=[];
var a=0;
var t;
var r=0;
for(t=0;
t<o.length;
t++){
var h=o.charAt(t);
if(h=="{"){
r++
}else{
if(h=="}"){
r--
}else{
if(h==e&&r==0){
n.push(o.substring(a,t));
a=t+1
}}}}
if(t>a){
n.push(o.substring(a,t))
}
return n
};
AjxNumberFormat=function(y,w){
AjxFormat.call(this,y);
if(y==""){
return
}
var a=y.split(/;/);
var y=a[0];
var p=0;
var m=this.__parseStatic(y,p);
p=m.offset;
var s=m.text!="";
if(s){
this._segments.push(new AjxFormat.TextSegment(this,m.text))
}
var r=p;
while(p<y.length&&AjxNumberFormat._META_CHARS.indexOf(y.charAt(p))!=-1){
p++
}
var n=p;
var t=y.substring(r,n);
var v=t.indexOf("E");
var d=v!=-1?t.substring(v+1):null;
if(d){
t=t.substring(0,v);
this._showExponent=true
}
var u=t.indexOf(".");
var k=u!=-1?t.substring(0,u):t;
if(k){
var x=k.lastIndexOf(",");
if(x!=-1){
this._groupingOffset=k.length-x-1
}
k=k.replace(/[^#0]/g,"");
var c=k.indexOf("0");
if(c!=-1){
this._minIntDigits=k.length-c
}
this._maxIntDigits=k.length
}
var g=u!=-1?t.substring(u+1):null;
if(g){
var c=g.lastIndexOf("0");
if(c!=-1){
this._minFracDigits=c+1
}
this._maxFracDigits=g.replace(/[^#0]/g,"").length
}
this._segments.push(new AjxNumberFormat.NumberSegment(this,t));
var m=this.__parseStatic(y,p);
p=m.offset;
if(m.text!=""){
this._segments.push(new AjxFormat.TextSegment(this,m.text))
}
if(w){
return
}
if(a.length>1){
var y=a[1];
this._negativeFormatter=new AjxNumberFormat(y,true)
}else{
var f=new AjxNumberFormat("");
f._segments=f._segments.concat(this._segments);
var h=s?1:0;
var o=new AjxFormat.TextSegment(f,I18nMsg.numberSignMinus);
f._segments.splice(h,0,o);
this._negativeFormatter=f
}};
AjxNumberFormat.prototype=new AjxFormat;
AjxNumberFormat.prototype.constructor=AjxNumberFormat;
AjxNumberFormat.prototype.toString=function(){
var e=["[AjxNumberFormat: ","formatter=",AjxFormat.prototype.toString.call(this)];
if(this._negativeFormatter){
e.push(", negativeFormatter=",this._negativeFormatter.toString())
}
e.push("]");
return e.join("")
};
AjxNumberFormat._NUMBER="number";
AjxNumberFormat._INTEGER="integer";
AjxNumberFormat._CURRENCY="currency";
AjxNumberFormat._PERCENT="percent";
AjxNumberFormat._META_CHARS="0#.,E";
AjxNumberFormat.prototype._groupingOffset=Number.MAX_VALUE;
AjxNumberFormat.prototype._maxIntDigits;
AjxNumberFormat.prototype._minIntDigits=1;
AjxNumberFormat.prototype._maxFracDigits;
AjxNumberFormat.prototype._minFracDigits;
AjxNumberFormat.prototype._isCurrency=false;
AjxNumberFormat.prototype._isPercent=false;
AjxNumberFormat.prototype._isPerMille=false;
AjxNumberFormat.prototype._showExponent=false;
AjxNumberFormat.prototype._negativeFormatter;
AjxNumberFormat.getInstance=function(){
if(!AjxNumberFormat._FORMATTERS[AjxNumberFormat._NUMBER]){
AjxNumberFormat._FORMATTERS[AjxNumberFormat._NUMBER]=new AjxNumberFormat(I18nMsg.formatNumber)
}
return AjxNumberFormat._FORMATTERS[AjxNumberFormat._NUMBER]
};
AjxNumberFormat.getNumberInstance=AjxNumberFormat.getInstance;
AjxNumberFormat.getCurrencyInstance=function(){
if(!AjxNumberFormat._FORMATTERS[AjxNumberFormat._CURRENCY]){
AjxNumberFormat._FORMATTERS[AjxNumberFormat._CURRENCY]=new AjxNumberFormat(I18nMsg.formatNumberCurrency)
}
return AjxNumberFormat._FORMATTERS[AjxNumberFormat._CURRENCY]
};
AjxNumberFormat.getIntegerInstance=function(){
if(!AjxNumberFormat._FORMATTERS[AjxNumberFormat._INTEGER]){
AjxNumberFormat._FORMATTERS[AjxNumberFormat._INTEGER]=new AjxNumberFormat(I18nMsg.formatNumberInteger)
}
return AjxNumberFormat._FORMATTERS[AjxNumberFormat._INTEGER]
};
AjxNumberFormat.getPercentInstance=function(){
if(!AjxNumberFormat._FORMATTERS[AjxNumberFormat._PERCENT]){
AjxNumberFormat._FORMATTERS[AjxNumberFormat._PERCENT]=new AjxNumberFormat(I18nMsg.formatNumberPercent)
}
return AjxNumberFormat._FORMATTERS[AjxNumberFormat._PERCENT]
};
AjxNumberFormat.format=function(t,e){
return new AjxNumberFormat(t).format(e)
};
AjxNumberFormat.initialize=function(){
AjxNumberFormat._FORMATTERS={}
};
AjxNumberFormat.prototype.format=function(e){
if(e<0&&this._negativeFormatter){
return this._negativeFormatter.format(e)
}
return AjxFormat.prototype.format.call(this,e)
};
AjxNumberFormat.prototype.__parseStatic=function(a,t){
var o=[];
while(t<a.length){
var r=a.charAt(t++);
if(AjxNumberFormat._META_CHARS.indexOf(r)!=-1){
t--;
break
}
switch(r){
case"'":var n=t;
while(t<a.length&&a.charAt(t++)!="'"){}
var e=t;
r=e-n==0?"'":a.substring(n,e);
break;
case"%":r=I18nMsg.numberSignPercent;
this._isPercent=true;
break;
case"\u2030":r=I18nMsg.numberSignPerMill;
this._isPerMille=true;
break;
case"\u00a4":r=a.charAt(t)=="\u00a4"?I18nMsg.currencyCode:I18nMsg.currencySymbol;
this._isCurrency=true;
break
}
o.push(r)
}
return{
text:o.join(""),offset:t}
};
AjxNumberFormat.NumberSegment=function(t,e){
AjxFormat.Segment.call(this,t,e)
};
AjxNumberFormat.NumberSegment.prototype=new AjxFormat.Segment;
AjxNumberFormat.NumberSegment.prototype.constructor=AjxNumberFormat.NumberSegment;
AjxNumberFormat.NumberSegment.prototype.toString=function(){
return'number: "'+this._s+'"'
};
AjxNumberFormat.NumberSegment.prototype.format=function(t){
if(isNaN(t)){
return I18nMsg.numberNaN
}
if(t===Number.NEGATIVE_INFINITY||t===Number.POSITIVE_INFINITY){
return I18nMsg.numberInfinity
}
if(typeof t!="number"){
t=Number(t)
}
t=Math.abs(t);
if(this._parent._isPercent){
t*=100
}else{
if(this._parent._isPerMille){
t*=1000
}}
var e=this._parent._showExponent?t.toExponential(this._parent._maxFracDigits).toUpperCase().replace(/E\+/,"E"):t.toFixed(this._parent._maxFracDigits||0);
e=this._normalize(e);
return e
};
AjxNumberFormat.NumberSegment.prototype._normalize=function(r){
var o=r.split(/[\.Ee]/);
var h=o.shift();
if(h.length<this._parent._minIntDigits){
h=AjxFormat._zeroPad(h,this._parent._minIntDigits,I18nMsg.numberZero)
}
if(h.length>this._parent._groupingOffset){
var t=[];
var n=h.length-this._parent._groupingOffset;
while(n>0){
t.unshift(h.substr(n,this._parent._groupingOffset));
t.unshift(I18nMsg.numberSeparatorGrouping);
n-=this._parent._groupingOffset
}
t.unshift(h.substring(0,n+this._parent._groupingOffset));
h=t.join("")
}
var c="0";
var d;
if(r.match(/\./)){
c=o.shift()
}else{
if(r.match(/\e/)||r.match(/\E/)){
d=o.shift()
}}
c=c.replace(/0+$/,"");
if(c.length<this._parent._minFracDigits){
c=AjxFormat._zeroPad(c,this._parent._minFracDigits,I18nMsg.numberZero,true)
}
var t=[h];
if(c.length>0){
var e=this._parent._isCurrency?I18nMsg.numberSeparatorMoneyDecimal:I18nMsg.numberSeparatorDecimal;
t.push(e,c)
}
if(d){
t.push("E",d.replace(/^\+/,""))
}
return t.join("")
};
AjxChoiceFormat=function(s){
AjxFormat.call(this,s);
var c=s.split("|");
if(arguments.length==1){
this._limits=new Array(c.length);
this._lessThan=new Array(c.length);
this._formats=new Array(c.length);
var r=new RegExp("^([^#<\u2264]+)([#<\u2264])(.*)$");
for(var a=0;
a<c.length;
a++){
var t=c[a];
var o=r.exec(t);
var e=o[1];
var n=o[2];
var h=o[3];
if(e=="\u221E"){
this._limits[a]=Number.POSITIVE_INFINITY
}else{
if(e=="-\u221E"){
this._limits[a]=Number.NEGATIVE_INFINITY
}else{
this._limits[a]=parseFloat(e)
}}
this._lessThan[a]=n=="#"||n=="\u2264";
this._formats[a]=new AjxMessageFormat(h)
}}else{
this._limits=arguments[0];
this._lessThan=new Array(arguments[0].length);
this._formats=arguments[1];
this._pattern=[];
for(var a=0;
a<this._formats.length;
a++){
if(a>0){
this._pattern.push("|")
}
this._pattern.push(this._limits[a],"#",this._formats[a]);
this._lessThan[a]=false;
this._formats[a]=new AjxMessageFormat(this._formats[a])
}
this._pattern=this._pattern.join("")
}};
AjxChoiceFormat.prototype=new AjxFormat;
AjxChoiceFormat.prototype.constructor=AjxChoiceFormat;
AjxChoiceFormat.prototype.toString=function(){
return["[AjxChoiceFormat: ","limits={ ",this._limits.join(", ")," }, ","formats={ ",this._formats.join(", ")," }, ","lessThan={ ",this._lessThan.join(", ")," }]"].join("")
};
AjxChoiceFormat.prototype._limits;
AjxChoiceFormat.prototype._lessThan;
AjxChoiceFormat.prototype._formats;
AjxChoiceFormat.prototype.getLimits=function(){
return this._limits
};
AjxChoiceFormat.prototype.getFormats=function(){
return this._formats
};
AjxChoiceFormat.prototype.format=function(e,n){
var o=e instanceof Array?e[n]:e;
var c;
if(isNaN(o)||o<this._limits[0]){
c=this._formats[0]
}else{
for(var t=0;
t<this._limits.length-1;
t++){
var h=this._limits[t];
var r=this._limits[t+1];
var d=o>=h;
var s=this._lessThan[t+1]?o<r:o<=r;
if(d&&s){
c=this._formats[t];
break
}}
if(!c){
c=this._formats[this._formats.length-1]
}}
return c.format(e)
};
AjxListFormat=function(e,a,t){
AjxFormat.call(this,e?e.toPattern():"");
this._formatter=e;
this._separator=a||AjxMsg.listSeparator;
this._lastSeparator=t||AjxMsg.listSeparatorLast
};
AjxListFormat.prototype=new AjxFormat;
AjxListFormat.prototype.constructor=AjxListFormat;
AjxListFormat.prototype._formatter;
AjxListFormat.prototype._separator;
AjxListFormat.prototype._lastSeparator;
AjxListFormat.prototype.format=function(o){
o=o instanceof Array?o:[o];
var a=[];
for(var e=0;
e<o.length;
e++){
if(e>0){
a.push(e<o.length-1?this._separator:this._lastSeparator)
}
var t=o[e];
a.push(this._formatter?this._formatter.format(t):String(t))
}
return a.join("")
};
AjxFormat.initialize()
}
if(AjxPackage.define("ajax.util.AjxDateUtil")){
AjxDateUtil=function(){};
AjxDateUtil.YEAR=1;
AjxDateUtil.MONTH=2;
AjxDateUtil.WEEK=3;
AjxDateUtil.DAY=4;
AjxDateUtil.TWO_WEEKS=5;
AjxDateUtil.MSEC_PER_FIFTEEN_MINUTES=900000;
AjxDateUtil.MSEC_PER_HALF_HOUR=1800000;
AjxDateUtil.MSEC_PER_HOUR=3600000;
AjxDateUtil.MSEC_PER_DAY=24*AjxDateUtil.MSEC_PER_HOUR;
AjxDateUtil.WEEKDAY_SHORT=AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.SHORT];
AjxDateUtil.WEEKDAY_MEDIUM=AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.MEDIUM];
AjxDateUtil.WEEKDAY_LONG=AjxDateFormat.WeekdaySegment.WEEKDAYS[AjxDateFormat.LONG];
AjxDateUtil.MONTH_SHORT=AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.SHORT];
AjxDateUtil.MONTH_MEDIUM=AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.MEDIUM];
AjxDateUtil.MONTH_LONG=AjxDateFormat.MonthSegment.MONTHS[AjxDateFormat.LONG];
AjxDateUtil._daysPerMonth={
0:31,1:29,2:31,3:30,4:31,5:30,6:31,7:31,8:30,9:31,10:30,11:31};
AjxDateUtil.WEEK_ONE_JAN_DATE=1;
AjxDateUtil._init=function(){
AjxDateUtil._dateFormat=AjxDateFormat.getDateInstance(AjxDateFormat.SHORT).clone();
var e=AjxDateUtil._dateFormat.getSegments();
for(var t=0;
t<e.length;
t++){
if(e[t] instanceof AjxDateFormat.YearSegment){
e[t]=new AjxDateFormat.YearSegment(AjxDateUtil._dateFormat,"yyyy")
}}
AjxDateUtil._dateTimeFormat=new AjxDateFormat(AjxDateUtil._dateFormat.toPattern()+" "+AjxDateFormat.getTimeInstance(AjxDateFormat.SHORT));
AjxDateUtil._dateFormatNoYear=new AjxDateFormat(AjxMsg.formatDateMediumNoYear)
};
AjxDateUtil._init();
AjxDateUtil.validDate=function(n,e,o){
var t=new Date(n,e,o);
var a=n>999?t.getFullYear():t.getYear();
return t.getMonth()==e&&t.getDate()==o&&a==n
};
AjxDateUtil.daysInMonth=function(a,e){
var t=new Date(a,e,1,12);
t.setMonth(t.getMonth()+1);
t.setDate(t.getDate()-1);
return t.getDate()
};
AjxDateUtil.isLeapYear=function(e){
return(new Date(e,1,29)).getMonth()==1
};
AjxDateUtil.isLocale24Hour=function(){
var t=AjxDateFormat.getTimeInstance(AjxDateFormat.SHORT);
var e=t._segments.length;
for(var a=0;
a<e;
a++){
if(t._segments[a]._s=="a"){
return false
}}
return true
};
AjxDateUtil.roll=function(t,a,n){
var o=t.getDate();
if(a==AjxDateUtil.MONTH){
t.setDate(1);
t.setMonth(t.getMonth()+n);
var e=AjxDateUtil.daysInMonth(t.getFullYear(),t.getMonth());
t.setDate(Math.min(o,e))
}else{
if(a==AjxDateUtil.YEAR){
t.setDate(1);
t.setFullYear(t.getFullYear()+n);
var e=AjxDateUtil.daysInMonth(t.getFullYear(),t.getMonth());
t.setDate(Math.min(o,e))
}else{
if(a==AjxDateUtil.WEEK){
t.setDate(t.getDate()+7*n)
}else{
if(a==AjxDateUtil.DAY){
t.setDate(t.getDate()+n)
}else{
if(a==AjxDateUtil.TWO_WEEKS){
t.setDate(t.getDate()+14*n)
}else{
return t
}}}}}
return t
};
AjxDateUtil.computeDateDelta=function(e){
var t=(new Date()).getTime()-e;
var a=AjxDateUtil.computeDuration(t);
return a?(a+" "+AjxMsg.ago):null
};
AjxDateUtil.computeDuration=function(a,c){
if(a<0){
return null
}
var n=Math.floor(a/(AjxDateUtil.MSEC_PER_DAY*365));
if(n!=0){
a-=n*AjxDateUtil.MSEC_PER_DAY*365
}
var t=Math.floor(a/(AjxDateUtil.MSEC_PER_DAY*30.42));
if(t>0){
a-=Math.floor(t*AjxDateUtil.MSEC_PER_DAY*30.42)
}
var h=Math.floor(a/AjxDateUtil.MSEC_PER_DAY);
if(h>0){
a-=h*AjxDateUtil.MSEC_PER_DAY
}
var s=Math.floor(a/AjxDateUtil.MSEC_PER_HOUR);
if(s>0){
a-=s*AjxDateUtil.MSEC_PER_HOUR
}
var e=Math.floor(a/60000);
if(e>0){
a-=e*60000
}
var o=Math.floor(a/1000);
var r=c?AjxDurationFormatConcise:AjxDurationFormatVerbose;
if(n>0){
return r.formatYears(n,t)
}else{
if(t>0){
return r.formatMonths(t,h)
}else{
if(h>0){
return r.formatDays(h,s)
}else{
if(s>0){
return r.formatHours(s,e)
}else{
if(e>0){
return r.formatMinutes(e,o)
}else{
return r.formatSeconds(o)
}}}}}};
AjxDateUtil.simpleComputeDateStr=function(t,a){
var e=AjxDateUtil._dateFormat.format(t);
return a?a+e:e
};
AjxDateUtil.simpleParseDateStr=function(e){
return AjxDateUtil._dateFormat.parse(e)
};
AjxDateUtil.simpleComputeDateTimeStr=function(t,a){
var e=AjxDateUtil._dateTimeFormat.format(t);
return a?a+e:e
};
AjxDateUtil.simpleParseDateTimeStr=function(e){
return AjxDateUtil._dateTimeFormat.parse(e)
};
AjxDateUtil.longComputeDateStr=function(e){
var t=AjxDateFormat.getDateInstance(AjxDateFormat.FULL);
return t.format(e)
};
AjxDateUtil.computeDateStr=function(a,t){
if(t==null){
return""
}
var e=new Date(t);
if(a.getTime()-t<AjxDateUtil.MSEC_PER_DAY&&a.getDay()==e.getDay()){
return AjxDateUtil.computeTimeString(e)
}
if(a.getFullYear()==e.getFullYear()){
return AjxDateUtil._dateFormatNoYear.format(e)
}
return AjxDateUtil.simpleComputeDateStr(e)
};
AjxDateUtil.computeWordyDateStr=function(a,t){
if(t==null){
return""
}
var e=new Date(t);
if(a.getTime()-t<AjxDateUtil.MSEC_PER_DAY&&a.getDay()==e.getDay()){
if(!AjxDateUtil._wordyDateToday){
AjxDateUtil._wordyDateToday=new AjxDateFormat(AjxMsg.formatWordyDateToday)
}
return AjxDateUtil._wordyDateToday.format(e)
}else{
if((a.getTime()-t)<(2*AjxDateUtil.MSEC_PER_DAY)&&(a.getDay()-1)==e.getDay()){
if(!AjxDateUtil._wordyDateYesterday){
AjxDateUtil._wordyDateYesterday=new AjxDateFormat(AjxMsg.formatWordyDateYesterday)
}
return AjxDateUtil._wordyDateYesterday.format(e)
}else{
if(!AjxDateUtil._wordyDate){
AjxDateUtil._wordyDate=new AjxDateFormat(AjxMsg.formatWordyDate)
}
return AjxDateUtil._wordyDate.format(e)
}}};
AjxDateUtil.computeTimeString=function(e){
var t=AjxDateFormat.getTimeInstance(AjxDateFormat.SHORT);
return t.format(e)
};
AjxDateUtil.computeDateTimeString=function(e){
var t=AjxDateFormat.getDateTimeInstance(AjxDateFormat.LONG);
return t.format(e)
};
AjxDateUtil._getHoursStr=function(t,a,e){
var o=t.getHours();
if(!e){
o%=12;
if(o==0){
o=12
}}
return a?AjxDateUtil._pad(o):o
};
AjxDateUtil._getMinutesStr=function(e){
return AjxDateUtil._pad(e.getMinutes())
};
AjxDateUtil._getSecondsStr=function(e){
return AjxDateUtil._pad(e.getSeconds())
};
AjxDateUtil._getAMPM=function(t,a){
var e=t.getHours();
return(e<12)?(a?"AM":"am"):(a?"PM":"pm")
};
AjxDateUtil._getMonthName=function(e,t){
return t?AjxDateUtil.MONTH_MEDIUM[e.getMonth()]:AjxDateUtil.MONTH_LONG[e.getMonth()]
};
AjxDateUtil._getMonth=function(e,a){
var t=e.getMonth()+1;
if(a){
return AjxDateUtil._pad(t)
}else{
return t
}};
AjxDateUtil._getDate=function(e,t){
var a=e.getDate();
return t?AjxDateUtil._pad(a):a
};
AjxDateUtil._getWeekday=function(e){
var t=e.getDay();
return AjxDateUtil.WEEKDAY_LONG[t]
};
AjxDateUtil._getWeekdayMedium=function(e){
var t=e.getDay();
return AjxDateUtil.WEEKDAY_MEDIUM[t]
};
AjxDateUtil._getFullYear=function(e){
return e.getFullYear()
};
AjxDateUtil.getFirstDayOfWeek=function(o,e){
e=e||0;
var t=o.getDay();
var a=(t-e+7)%7;
o.setDate(o.getDate()-a);
return o
};
AjxDateUtil.getWeekNumber=function(n,t,h){
t=t||0;
h=h||AjxDateUtil.WEEK_ONE_JAN_DATE;
n=n||new Date();
n.setHours(12,0,0,0);
var c=n,f,p;
if(c.getDay()===t){
f=c
}else{
f=AjxDateUtil.getFirstDayOfWeek(c,t)
}
var d=f.getFullYear(),a=f.getTime();
p=new Date(f.getTime()+6*AjxDateUtil.MSEC_PER_DAY);
var r;
if(d!==p.getFullYear()&&p.getDate()>=h){
r=1
}else{
var s=(new Date(d,0,h));
s.setHours(12,0,0,0);
var e=AjxDateUtil.getFirstDayOfWeek(s,t);
var u=Math.round((c.getTime()-e.getTime())/AjxDateUtil.MSEC_PER_DAY);
var m=u%7;
var o=(u-m)/7;
r=o+1
}
return r
};
AjxDateUtil.getTimeStr=function(e,a){
var t=a;
t=t.replace(/%d/g,AjxDateUtil._getDate(e,true));
t=t.replace(/%D/g,AjxDateUtil._getDate(e,false));
t=t.replace(/%w/g,AjxDateUtil._getWeekday(e));
t=t.replace(/%M/g,AjxDateUtil._getMonthName(e));
t=t.replace(/%t/g,AjxDateUtil._getMonthName(e,true));
t=t.replace(/%n/g,AjxDateUtil._getMonth(e,true));
t=t.replace(/%Y/g,AjxDateUtil._getFullYear(e));
t=t.replace(/%h/g,AjxDateUtil._getHoursStr(e,false,false));
t=t.replace(/%H/g,AjxDateUtil._getHoursStr(e,true,false));
t=t.replace(/%m/g,AjxDateUtil._getMinutesStr(e));
t=t.replace(/%s/g,AjxDateUtil._getSecondsStr(e));
t=t.replace(/%P/g,AjxDateUtil._getAMPM(e,true));
t=t.replace(/%p/g,AjxDateUtil._getAMPM(e,false));
return t
};
AjxDateUtil.getRoundedMins=function(e,a){
var t=e.getMinutes();
if(t!=0&&a){
t=(Math.ceil((t/a)))*a
}
return t
};
AjxDateUtil.roundTimeMins=function(t,o){
var a=t.getMinutes();
var e=t.getHours();
if(a!=0&&o){
a=(Math.ceil((a/o)))*o;
if(a==60){
a=0;
e++
}
t.setMinutes(a);
t.setHours(e)
}
return t
};
AjxDateUtil.isInRange=function(o,t,a,e){
return(o<e&&t>a)
};
AjxDateUtil.getSimpleDateFormat=function(){
return AjxDateUtil._dateFormat
};
AjxDateUtil.getServerDate=function(e){
if(!AjxDateUtil._serverDateFormatter){
AjxDateUtil._serverDateFormatter=new AjxDateFormat("yyyyMMdd")
}
return AjxDateUtil._serverDateFormatter.format(e)
};
AjxDateUtil.getServerDateTime=function(t,o){
var e=t;
var a=null;
if(o){
if(!AjxDateUtil._serverDateTimeFormatterUTC){
AjxDateUtil._serverDateTimeFormatterUTC=new AjxDateFormat("yyyyMMdd'T'HHmmss'Z'")
}
a=AjxDateUtil._serverDateTimeFormatterUTC;
e=new Date(t.getTime());
e.setMinutes(e.getMinutes()+e.getTimezoneOffset())
}else{
if(!AjxDateUtil._serverDateTimeFormatter){
AjxDateUtil._serverDateTimeFormatter=new AjxDateFormat("yyyyMMdd'T'HHmmss")
}
a=AjxDateUtil._serverDateTimeFormatter
}
return a.format(e)
};
AjxDateUtil.parseServerTime=function(o,e){
if(o.charAt(8)=="T"){
var a=parseInt(o.substr(9,2),10);
var n=parseInt(o.substr(11,2),10);
var t=parseInt(o.substr(13,2),10);
if(o.charAt(15)=="Z"){
n+=AjxTimezone.getOffset(AjxTimezone.DEFAULT,e)
}
e.setHours(a,n,t,0)
}
return e
};
AjxDateUtil.parseServerDateTime=function(t){
if(t==null){
return null
}
var a=new Date();
var n=parseInt(t.substr(0,4),10);
var o=parseInt(t.substr(4,2),10);
var e=parseInt(t.substr(6,2),10);
a.setFullYear(n);
a.setMonth(o-1);
a.setMonth(o-1);
a.setDate(e);
AjxDateUtil.parseServerTime(t,a);
return a
};
AjxDateUtil._pad=function(e){
return e<10?("0"+e):e
};
AjxDurationFormatVerbose=function(){};
AjxDurationFormatVerbose.formatYears=function(a,e){
var t=a+" ";
t+=(a>1)?AjxMsg.years:AjxMsg.year;
if(a<=3&&e>0){
t+=" "+e;
t+=" "+((e>1)?AjxMsg.months:AjxMsg.months)
}
return t
};
AjxDurationFormatVerbose.formatMonths=function(e,a){
var t=e+" ";
t+=(e>1)?AjxMsg.months:AjxMsg.month;
if(e<=3&&a>0){
t+=" "+a;
t+=" "+((a>1)?AjxMsg.days:AjxMsg.day)
}
return t
};
AjxDurationFormatVerbose.formatDays=function(a,e){
var t=a+" ";
t+=(a>1)?AjxMsg.days:AjxMsg.day;
if(a<=2&&e>0){
t+=" "+e;
t+=" "+((e>1)?AjxMsg.hours:AjxMsg.hour)
}
return t
};
AjxDurationFormatVerbose.formatHours=function(e,a){
var t=e+" ";
t+=(e>1)?AjxMsg.hours:AjxMsg.hour;
if(e<5&&a>0){
t+=" "+a;
t+=" "+((a>1)?AjxMsg.minutes:AjxMsg.minute)
}
return t
};
AjxDurationFormatVerbose.formatMinutes=function(a,t){
var e=a+" ";
e+=((a>1)?AjxMsg.minutes:AjxMsg.minute);
if(a<5&&t>0){
e+=" "+t;
e+=" "+((t>1)?AjxMsg.seconds:AjxMsg.second)
}
return e
};
AjxDurationFormatVerbose.formatSeconds=function(e){
return(e+" "+((e>1)?AjxMsg.seconds:AjxMsg.second))
};
AjxDurationFormatConcise=function(){};
AjxDurationFormatConcise.formatYears=function(t,e){
return this._format(t,e)
};
AjxDurationFormatConcise.formatMonths=function(e,t){
return this._format(e,t)
};
AjxDurationFormatConcise.formatDays=function(t,e){
return this._format(t,e)
};
AjxDurationFormatConcise.formatHours=function(e,t){
return this._format(e,t)
};
AjxDurationFormatConcise.formatMinutes=function(t,e){
return this._format(t,e)
};
AjxDurationFormatConcise.formatSeconds=function(e){
return this._format(0,e)
};
AjxDurationFormatConcise._format=function(o,t){
var n=0;
var e=[];
e[n++]=o;
e[n++]=":";
if(t<10){
e[n++]="0"
}
e[n++]=t;
return e.join("")
};
AjxDateUtil.SUNDAY=0;
AjxDateUtil.MONDAY=1;
AjxDateUtil.TUESDAY=2;
AjxDateUtil.WEDNESDAY=3;
AjxDateUtil.THURSDAY=4;
AjxDateUtil.FRIDAY=5;
AjxDateUtil.SATURDAY=6;
AjxDateUtil.getDateForNextDay=function(t,n,o){
o=o||1;
var a=new Date(t);
for(var e=0;
e<o;
e++){
a=AjxDateUtil._getDateForNextWeekday(a,n);
if(e<o-1){
a.setDate(a.getDate()+1)
}}
return a
};
AjxDateUtil.getDateForNextWorkWeekDay=function(t,o){
o=o?o:1;
var a=new Date(t);
for(var e=0;
e<o;
e++){
a=AjxDateUtil._getDateForNextWorkWeekday(a);
if(e<o-1){
a.setDate(a.getDate()+1)
}}
return a
};
AjxDateUtil.getDateForThisDay=function(e,a,t){
if(t<0){
return AjxDateUtil.getDateForPrevDay(e,a,-t)
}else{
return AjxDateUtil.getDateForNextDay(e,a,t)
}};
AjxDateUtil.getDateForThisWorkWeekDay=function(e,t){
if(t<0){
return AjxDateUtil.getDateForPrevWorkWeekDay(e,-t)
}else{
return AjxDateUtil.getDateForNextWorkWeekDay(e,t)
}};
AjxDateUtil.getDateForPrevDay=function(t,n,o){
o=o||1;
var a=new Date(t);
for(var e=0;
e<o;
e++){
a=AjxDateUtil._getDateForPrevWeekday(a,n);
if(e<o-1){
a.setDate(a.getDate()-1)
}}
return a
};
AjxDateUtil.getDateForPrevWorkWeekDay=function(t,o){
o=o||1;
var a=new Date(t);
for(var e=0;
e<o;
e++){
a=AjxDateUtil._getDateForPrevWorkWeekday(a);
if(e<o-1){
a.setDate(a.getDate()-1)
}}
return a
};
AjxDateUtil._getDateForNextWeekday=function(a,n){
var e=new Date(a);
var t=a.getDay();
if(t==n){
return e
}
var o=(n-t);
if(o>0){
e.setDate(a.getDate()+o)
}else{
e.setDate(a.getDate()+(7+o))
}
return e
};
AjxDateUtil._getDateForNextWorkWeekday=function(a){
var e=new Date(a);
var t=a.getDay();
if(t==AjxDateUtil.SUNDAY){
e.setDate(a.getDate()+1)
}else{
if(t==AjxDateUtil.SATURDAY){
e.setDate(a.getDate()+2)
}}
return e
};
AjxDateUtil._getDateForPrevWeekday=function(a,n){
var e=new Date(a);
var t=a.getDay();
if(t==n){
return e
}
var o=(t-n);
if(o>0){
e.setDate(a.getDate()-o)
}else{
e.setDate(a.getDate()-(7+o))
}
return e
};
AjxDateUtil._getDateForPrevWorkWeekday=function(a){
var e=new Date(a);
var t=a.getDay();
if(t==AjxDateUtil.SUNDAY){
e.setDate(a.getDate()-2)
}else{
if(t==AjxDateUtil.SATURDAY){
e.setDate(a.getDate()-1)
}}
return e
};
AjxDateUtil.calculate=function(f,n){
if(!AjxDateUtil.__calculate_initialized){
AjxDateUtil.__calculate_initialized=true;
AjxDateUtil.__calculate_init()
}
var e=n||new Date;
f=f.replace(/^\s*|\s*$/,"").replace(/\s*=\s*/g,"=").replace(/\s*,\s*/g,",");
var p=f.split(/\s+/g);
var y,r,o,h,u,d,g,t;
for(var c=0;
c<p.length;
c++){
y=p[c];
if(y.match(AjxDateUtil.RE_COMMENT)){
break
}
if(y.match(AjxDateUtil.RE_NOW)){
n=new Date(e.getTime());
continue
}
if(r=y.match(AjxDateUtil.RE_ADD_NUMBER)){
o=r[1];
h=AjxDateUtil.__calculate_parseInt(r[2]);
u=p[++c];
d=o=="+"?h:h*-1;
AjxDateUtil.__calculate_add(n,u,d);
continue
}
if(r=y.match(AjxDateUtil.RE_ADD_WEEKORD)){
o=r[1];
g=r[2];
t=p[++c];
d=o=="+"?h:h*-1;
AjxDateUtil.__calculate_add_ordinal(n,u,d);
continue
}
if(r=y.match(AjxDateUtil.RE_SET)){
AjxDateUtil.__calculate_set(n,r[1],r[2]);
continue
}
n=AjxDateFormat.parse("yyyyy-MM-dd",y);
if(!n&&(n=AjxDateFormat.parse("yyyy-MM-dd'T'hh:mm:ss'Z'",y))){
n.setMinutes(n.getMinutes()-n.getTimezoneOffset())
}
if(!n){
n=AjxDateFormat.parse("yyyy-MM-dd'T'HH:mm:ss",y)
}
if(!n){
throw'invalid date pattern: "'+y+'"'
}}
return n
};
AjxDateUtil.S_DAYNAME=[AjxMsg["calc.dayname.sunday"],AjxMsg["calc.dayname.monday"],AjxMsg["calc.dayname.tuesday"],AjxMsg["calc.dayname.wednesday"],AjxMsg["calc.dayname.thursday"],AjxMsg["calc.dayname.friday"],AjxMsg["calc.dayname.saturday"]].join("|");
AjxDateUtil.S_MONTHNAME=[AjxMsg["calc.monthname.january"],AjxMsg["calc.monthname.february"],AjxMsg["calc.monthname.march"],AjxMsg["calc.monthname.april"],AjxMsg["calc.monthname.may"],AjxMsg["calc.monthname.june"],AjxMsg["calc.monthname.july"],AjxMsg["calc.monthname.august"],AjxMsg["calc.monthname.september"],AjxMsg["calc.monthname.october"],AjxMsg["calc.monthname.november"],AjxMsg["calc.monthname.december"]].join("|");
AjxDateUtil.S_WEEKORD=[AjxMsg["calc.ordinal.first"],AjxMsg["calc.ordinal.second"],AjxMsg["calc.ordinal.third"],AjxMsg["calc.ordinal.fourth"],AjxMsg["calc.ordinal.fifth"],AjxMsg["calc.ordinal.last"]].join("|");
AjxMsg["calc.now"]="now";
AjxMsg["calc.date"]="date";
AjxMsg["calc.duration.year"]="year|years";
AjxMsg["calc.duration.month"]="month|months";
AjxMsg["calc.duration.day"]="day|days";
AjxMsg["calc.duration.hour"]="hour|hours";
AjxMsg["calc.duration.minute"]="min|mins|minute|minutes";
AjxMsg["calc.duration.second"]="sec|secs|second|seconds";
AjxMsg["calc.duration.millisecond"]="milli|millis|millisecond|milliseconds";
AjxDateUtil.S_DURATION=[AjxMsg["calc.duration.year"],AjxMsg["calc.duration.month"],AjxMsg["calc.duration.day"],AjxMsg["calc.duration.hour"],AjxMsg["calc.duration.minute"],AjxMsg["calc.duration.second"],AjxMsg["calc.duration.millisecond"]].join("|");
AjxDateUtil.__calculate_init=function(){
AjxDateUtil.WEEKDAYS={};
var t=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"];
for(var o=0;
o<t.length;
o++){
var n=AjxMsg["calc.dayname."+t[o]].split("|");
for(var a=0;
a<n.length;
a++){
AjxDateUtil.WEEKDAYS[n[a].toLowerCase()]=o
}}
AjxDateUtil.MONTHNAME2MONTHNUM={};
var e=["january","february","march","april","may","june","july","august","september","october","november","december"];
for(var o=0;
o<e.length;
o++){
var s=AjxMsg["calc.monthname."+e[o]].split("|");
for(var a=0;
a<s.length;
a++){
AjxDateUtil.MONTHNAME2MONTHNUM[s[a].toLowerCase()]=o
}}
AjxDateUtil.RE_YEAR=new RegExp("^("+AjxMsg["calc.duration.year"]+")$","i");
AjxDateUtil.RE_MONTH=new RegExp("^("+AjxMsg["calc.duration.month"]+")$","i");
AjxDateUtil.RE_WEEK=new RegExp("^("+AjxMsg["calc.duration.week"]+")$","i");
AjxDateUtil.RE_DAY=new RegExp("^("+AjxMsg["calc.duration.day"]+")$","i");
AjxDateUtil.RE_HOUR=new RegExp("^("+AjxMsg["calc.duration.hour"]+")$","i");
AjxDateUtil.RE_MINUTE=new RegExp("^("+AjxMsg["calc.duration.minute"]+")$","i");
AjxDateUtil.RE_SECOND=new RegExp("^("+AjxMsg["calc.duration.second"]+")$","i");
AjxDateUtil.RE_MILLISECOND=new RegExp("^("+AjxMsg["calc.duration.millisecond"]+")$","i");
AjxDateUtil.RE_DATE=new RegExp("^("+AjxMsg["calc.date"]+")$","i");
AjxDateUtil.RE_DAYNAME=new RegExp("^("+AjxDateUtil.S_DAYNAME+")$","i");
AjxDateUtil.RE_MONTHNAME=new RegExp("^("+AjxDateUtil.S_MONTHNAME+")$","i");
AjxDateUtil.RE_WEEKORD=new RegExp("^("+AjxDateUtil.S_WEEKORD+")$","i");
AjxDateUtil.RE_COMMENT=/^#/;
AjxDateUtil.RE_NOW=new RegExp("^("+AjxMsg["calc.now"]+")$","i");
AjxDateUtil.RE_ADD_NUMBER=new RegExp("^([+\\-])(\\d+)$","i");
AjxDateUtil.RE_ADD_WEEKORD=new RegExp("^([+\\-])("+AjxDateUtil.S_WEEKORD+")$","i");
AjxDateUtil.RE_SET=new RegExp("^("+AjxDateUtil.S_DURATION+"|"+AjxMsg["calc.date"]+")=(.*)$","i")
};
AjxDateUtil.__calculate_normalizeFullWidthDigit=function(t){
var e="0".charCodeAt(0)+t.charCodeAt(0)-"\uff10".charCodeAt(0);
return String.fromCharCode(e)
};
AjxDateUtil.__calculate_replaceFullWidthDigit=function(e,t){
return AjxDateUtil.__calculate_normalizeFullWidthDigit(t)
};
AjxDateUtil.__calculate_parseInt=function(e){
e=e.replace(/([\uFF10-\uFF19])/g,AjxDateUtil.__calculate_normalizeFullWidthDigit);
return parseInt(e,10)
};
AjxDateUtil.__calculate_add=function(a,n,o){
if(n.match(AjxDateUtil.RE_YEAR)){
a.setFullYear(a.getFullYear()+o);
return
}
if(n.match(AjxDateUtil.RE_MONTH)){
var s=a.getMonth();
a.setMonth(s+o);
if(Math.abs(s+o)%12!=a.getMonth()){
a.setDate(0)
}
return
}
if(n.match(AjxDateUtil.RE_WEEK)){
a.setDate(a.getDate()+o*7);
return
}
if(n.match(AjxDateUtil.RE_DAY)){
a.setDate(a.getDate()+o);
return
}
if(n.match(AjxDateUtil.RE_HOUR)){
a.setHours(a.getHours()+o);
return
}
if(n.match(AjxDateUtil.RE_MINUTE)){
a.setMinutes(a.getMinutes()+o);
return
}
if(n.match(AjxDateUtil.RE_SECOND)){
a.setSeconds(a.getSeconds()+o);
return
}
if(n.match(AjxDateUtil.RE_MILLISECOND)){
a.setMilliseconds(a.getMilliseconds()+o);
return
}
if(n.match(AjxDateUtil.RE_MONTHNAME)){
var e=AjxDateUtil.MONTHNAME2MONTHNUM[n.toLowerCase()];
if(e<a.getMonth()){
o+=o>0?0:1
}else{
if(e>a.getMonth()){
o+=o>0?-1:0
}}
a.setFullYear(a.getFullYear()+o,e,1);
return
}
if(n.match(AjxDateUtil.RE_DAYNAME)){
var t=AjxDateUtil.WEEKDAYS[n.toLowerCase()];
if(t<a.getDay()){
o+=o>0?0:1
}else{
if(t>a.getDay()){
o+=o>0?-1:0
}}
a.setDate(a.getDate()+(t-a.getDay())+7*o);
return
}
throw"unknown type: "+n
};
AjxDateUtil.__calculate_add_ordinal=function(){
throw"TODO: not implemented"
};
AjxDateUtil.__calculate_set=function(t,a,o){
var e=o.split(/,/);
if(a.match(AjxDateUtil.RE_YEAR)){
e[0]=AjxDateUtil.__calculate_fullYear(e[0]);
if(e[1]!=null){
e[1]=AjxDateUtil.__calculate_month(e[1])
}
if(e[2]!=null){
e[2]=parseInt(e[2],10)
}
t.setFullYear.apply(t,e);
return
}
if(a.match(AjxDateUtil.RE_MONTH)){
e[0]=AjxDateUtil.__calculate_month(e[0]);
if(e[1]!=null){
e[1]=parseInt(e[1],10)
}
t.setMonth.apply(t,e);
return
}
if(a.match(AjxDateUtil.RE_DATE)){
e[0]=parseInt(e[0],10);
t.setDate.apply(t,e);
return
}
if(a.match(AjxDateUtil.RE_HOUR)){
e[0]=parseInt(e[0],10);
if(e[1]!=null){
e[1]=parseInt(e[1],10)
}
if(e[2]!=null){
e[2]=parseInt(e[2],10)
}
if(e[3]!=null){
e[3]=parseInt(e[3],10)
}
t.setHours.apply(t,e);
return
}
if(a.match(AjxDateUtil.RE_MINUTE)){
e[0]=parseInt(e[0],10);
if(e[1]!=null){
e[1]=parseInt(e[1],10)
}
if(e[2]!=null){
e[2]=parseInt(e[2],10)
}
t.setMinutes.apply(t,e);
return
}
if(a.match(AjxDateUtil.RE_SECOND)){
e[0]=parseInt(e[0],10);
if(e[1]!=null){
e[1]=parseInt(e[1],10)
}
t.setSeconds.apply(t,e);
return
}
if(a.match(AjxDateUtil.RE_MILLISECOND)){
t.setMilliseconds.apply(t,e);
return
}
throw"unknown type: "+a
};
AjxDateUtil.__calculate_fullYear=function(e){
if(e.length==2){
var t=new Date;
t.setYear(parseInt(e,10));
e=String(t.getFullYear()).substr(0,2)+e
}
return parseInt(e,10)
};
AjxDateUtil.__calculate_month=function(t){
var e=AjxDateUtil.MONTHNAME2MONTHNUM[t.toLowerCase()];
return e!=null?e:parseInt(t,10)-1
};
AjxDateUtil.__calculate_day=function(t){
var e=AjxDateUtil.WEEKDAYS[t.toLowerCase()];
return e!=null?e:parseInt(t,10)
}
}
if(AjxPackage.define("ajax.util.AjxTimezoneData")){
AjxTimezoneData={};
AjxTimezoneData.TRANSITION_YEAR=2010;
AjxTimezoneData.TIMEZONE_RULES=[{
serverId:"Etc/GMT+12",clientId:"Etc/GMT+12",standard:{
offset:-720,tzname:"GMT+12"}}
,{
serverId:"Pacific/Midway",clientId:"Pacific/Midway",standard:{
offset:-660,tzname:"SST"}}
,{
serverId:"Pacific/Honolulu",clientId:"Pacific/Honolulu",standard:{
offset:-600,tzname:"HST"}}
,{
serverId:"America/Anchorage",clientId:"America/Anchorage",standard:{
offset:-540,mon:11,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2010,11,7],tzname:"AKST"}
,daylight:{
offset:-480,mon:3,week:2,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,14],tzname:"AKDT"}}
,{
serverId:"America/Los_Angeles",clientId:"America/Los_Angeles",standard:{
offset:-480,mon:11,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2010,11,7],tzname:"PST"}
,daylight:{
offset:-420,mon:3,week:2,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,14],tzname:"PDT"}}
,{
serverId:"America/Tijuana",clientId:"America/Tijuana",standard:{
offset:-480,mon:10,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,10,31],tzname:"PST"}
,daylight:{
offset:-420,mon:4,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2010,4,4],tzname:"PDT"}}
,{
serverId:"America/Chihuahua",clientId:"America/Chihuahua",standard:{
offset:-420,mon:10,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,10,31],tzname:"MST"}
,daylight:{
offset:-360,mon:4,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2010,4,4],tzname:"MDT"}}
,{
serverId:"America/Denver",clientId:"America/Denver",standard:{
offset:-420,mon:11,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2010,11,7],tzname:"MST"}
,daylight:{
offset:-360,mon:3,week:2,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,14],tzname:"MDT"}}
,{
serverId:"America/Phoenix",clientId:"America/Phoenix",standard:{
offset:-420,tzname:"MST"}}
,{
serverId:"America/Chicago",clientId:"America/Chicago",standard:{
offset:-360,mon:11,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2010,11,7],tzname:"CST"}
,daylight:{
offset:-300,mon:3,week:2,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,14],tzname:"CDT"}}
,{
serverId:"America/Guatemala",clientId:"America/Guatemala",standard:{
offset:-360}}
,{
serverId:"America/Mexico_City",clientId:"America/Mexico_City",standard:{
offset:-360,mon:10,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,10,31],tzname:"CST"}
,daylight:{
offset:-300,mon:4,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2010,4,4],tzname:"CDT"}}
,{
serverId:"America/Regina",clientId:"America/Regina",standard:{
offset:-360,tzname:"CST"}}
,{
serverId:"America/Bogota",clientId:"America/Bogota",standard:{
offset:-300}}
,{
serverId:"America/Indiana/Indianapolis",clientId:"America/Indiana/Indianapolis",standard:{
offset:-300,mon:11,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2010,11,7],tzname:"EST"}
,daylight:{
offset:-240,mon:3,week:2,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,14],tzname:"EDT"}}
,{
serverId:"America/New_York",clientId:"America/New_York",standard:{
offset:-300,mon:11,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2010,11,7],tzname:"EST"}
,daylight:{
offset:-240,mon:3,week:2,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,14],tzname:"EDT"}}
,{
serverId:"America/Caracas",clientId:"America/Caracas",standard:{
offset:-270,tzname:"VET"}}
,{
serverId:"America/Guyana",clientId:"America/Guyana",standard:{
offset:-240,tzname:"GYT"}}
,{
serverId:"America/Halifax",clientId:"America/Halifax",standard:{
offset:-240,mon:11,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2010,11,7],tzname:"AST"}
,daylight:{
offset:-180,mon:3,week:2,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,14],tzname:"ADT"}}
,{
serverId:"America/La_Paz",clientId:"America/La_Paz",standard:{
offset:-240,tzname:"BOT"}}
,{
serverId:"America/Manaus",clientId:"America/Manaus",standard:{
offset:-240,tzname:"AMT"}}
,{
serverId:"America/Santiago",clientId:"America/Santiago",standard:{
offset:-240,mon:3,week:3,wkday:1,hour:0,min:0,sec:0,trans:[2010,3,21],tzname:"CLT"}
,daylight:{
offset:-180,mon:10,week:2,wkday:1,hour:0,min:0,sec:0,trans:[2010,10,10],tzname:"CLST"}}
,{
serverId:"America/St_Johns",clientId:"America/St_Johns",standard:{
offset:-210,mon:11,week:1,wkday:1,hour:0,min:1,sec:0,trans:[2010,11,7],tzname:"NST"}
,daylight:{
offset:-150,mon:3,week:2,wkday:1,hour:0,min:1,sec:0,trans:[2010,3,14],tzname:"NDT"}}
,{
serverId:"America/Argentina/Buenos_Aires",clientId:"America/Argentina/Buenos_Aires",standard:{
offset:-180}}
,{
serverId:"America/Godthab",clientId:"America/Godthab",standard:{
offset:-180,mon:10,week:-1,wkday:1,hour:1,min:0,sec:0,trans:[2010,10,31],tzname:"WGT"}
,daylight:{
offset:-120,mon:3,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,28],tzname:"WGST"}}
,{
serverId:"America/Montevideo",clientId:"America/Montevideo",standard:{
offset:-180,mon:3,week:2,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,14],tzname:"UYT"}
,daylight:{
offset:-120,mon:10,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2010,10,3],tzname:"UYST"}}
,{
serverId:"America/Sao_Paulo",clientId:"America/Sao_Paulo",standard:{
offset:-180,mon:2,week:3,wkday:1,hour:0,min:0,sec:0,trans:[2010,2,21],tzname:"BRT"}
,daylight:{
offset:-120,mon:10,week:3,wkday:1,hour:0,min:0,sec:0,trans:[2010,10,17],tzname:"BRST"}}
,{
serverId:"Atlantic/South_Georgia",clientId:"Atlantic/South_Georgia",standard:{
offset:-120,tzname:"GST"}}
,{
serverId:"Atlantic/Azores",clientId:"Atlantic/Azores",standard:{
offset:-60,mon:10,week:-1,wkday:1,hour:1,min:0,sec:0,trans:[2010,10,31],tzname:"AZOT"}
,daylight:{
offset:0,mon:3,week:-1,wkday:1,hour:0,min:0,sec:0,trans:[2010,3,28],tzname:"AZOST"}}
,{
serverId:"Atlantic/Cape_Verde",clientId:"Atlantic/Cape_Verde",standard:{
offset:-60,tzname:"CVT"}}
,{
serverId:"Africa/Casablanca",clientId:"Africa/Casablanca",standard:{
offset:0,mon:8,week:3,wkday:6,hour:0,min:0,sec:0,trans:[2010,8,20],tzname:"WET"}
,daylight:{
offset:60,mon:6,week:1,wkday:2,hour:0,min:0,sec:0,trans:[2010,6,7],tzname:"WEST"}}
,{
serverId:"Africa/Monrovia",clientId:"Africa/Monrovia",standard:{
offset:0,tzname:"GMT"}}
,{
serverId:"Europe/London",clientId:"Europe/London",standard:{
offset:0,mon:10,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,10,31],tzname:"GMT/BST"}
,daylight:{
offset:60,mon:3,week:-1,wkday:1,hour:1,min:0,sec:0,trans:[2010,3,28],tzname:"GMT/BST"}}
,{
serverId:"Africa/Algiers",clientId:"Africa/Algiers",standard:{
offset:60,tzname:"CET"}}
,{
serverId:"Africa/Windhoek",clientId:"Africa/Windhoek",standard:{
offset:60,mon:4,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2010,4,4],tzname:"WAT"}
,daylight:{
offset:120,mon:9,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2010,9,5],tzname:"WAST"}}
,{
serverId:"Europe/Belgrade",clientId:"Europe/Belgrade",standard:{
offset:60,mon:10,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2010,10,31],tzname:"CET"}
,daylight:{
offset:120,mon:3,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,28],tzname:"CEST"}}
,{
serverId:"Europe/Berlin",clientId:"Europe/Berlin",standard:{
offset:60,mon:10,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2010,10,31],tzname:"CET"}
,daylight:{
offset:120,mon:3,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,28],tzname:"CEST"}}
,{
serverId:"Europe/Brussels",clientId:"Europe/Brussels",standard:{
offset:60,mon:10,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2010,10,31],tzname:"CET"}
,daylight:{
offset:120,mon:3,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,28],tzname:"CEST"}}
,{
serverId:"Europe/Warsaw",clientId:"Europe/Warsaw",standard:{
offset:60,mon:10,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2010,10,31],tzname:"CET"}
,daylight:{
offset:120,mon:3,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,28],tzname:"CEST"}}
,{
serverId:"Africa/Cairo",clientId:"Africa/Cairo",standard:{
offset:120,mon:8,week:3,wkday:5,hour:0,min:0,sec:0,trans:[2010,8,19],tzname:"EET"}
,daylight:{
offset:180,mon:4,week:-1,wkday:6,hour:0,min:0,sec:0,trans:[2010,4,30],tzname:"EEST"}}
,{
serverId:"Africa/Harare",clientId:"Africa/Harare",standard:{
offset:120,tzname:"CAT"}}
,{
serverId:"Asia/Amman",clientId:"Asia/Amman",standard:{
offset:120,mon:10,week:-1,wkday:6,hour:1,min:0,sec:0,trans:[2010,10,29],tzname:"EET"}
,daylight:{
offset:180,mon:3,week:-1,wkday:5,hour:23,min:59,sec:59,trans:[2010,3,25],tzname:"EEST"}}
,{
serverId:"Asia/Beirut",clientId:"Asia/Beirut",standard:{
offset:120,mon:10,week:-1,wkday:1,hour:0,min:0,sec:0,trans:[2010,10,31],tzname:"EET"}
,daylight:{
offset:180,mon:3,week:-1,wkday:1,hour:0,min:0,sec:0,trans:[2010,3,28],tzname:"EEST"}}
,{
serverId:"Asia/Jerusalem",clientId:"Asia/Jerusalem",standard:{
offset:120,mon:9,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,9,26],tzname:"IST"}
,daylight:{
offset:180,mon:3,week:-1,wkday:6,hour:2,min:0,sec:0,trans:[2010,3,26],tzname:"IDT"}}
,{
serverId:"Europe/Athens",clientId:"Europe/Athens",standard:{
offset:120,mon:10,week:-1,wkday:1,hour:4,min:0,sec:0,trans:[2010,10,31],tzname:"EET"}
,daylight:{
offset:180,mon:3,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2010,3,28],tzname:"EEST"}}
,{
serverId:"Europe/Helsinki",clientId:"Europe/Helsinki",standard:{
offset:120,mon:10,week:-1,wkday:1,hour:4,min:0,sec:0,trans:[2010,10,31],tzname:"EET"}
,daylight:{
offset:180,mon:3,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2010,3,28],tzname:"EEST"}}
,{
serverId:"Europe/Minsk",clientId:"Europe/Minsk",standard:{
offset:120,mon:10,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2010,10,31],tzname:"EET"}
,daylight:{
offset:180,mon:3,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,28],tzname:"EEST"}}
,{
serverId:"Africa/Nairobi",clientId:"Africa/Nairobi",standard:{
offset:180,tzname:"EAT"}}
,{
serverId:"Asia/Baghdad",clientId:"Asia/Baghdad",standard:{
offset:180}}
,{
serverId:"Asia/Kuwait",clientId:"Asia/Kuwait",standard:{
offset:180,tzname:"AST"}}
,{
serverId:"Europe/Moscow",clientId:"Europe/Moscow",standard:{
offset:180,mon:10,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2010,10,31],tzname:"MSK/MSD"}
,daylight:{
offset:240,mon:3,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,28],tzname:"MSK/MSD"}}
,{
serverId:"Asia/Tehran",clientId:"Asia/Tehran",standard:{
offset:210,mon:9,week:4,wkday:3,hour:0,min:0,sec:0,trans:[2010,9,28],tzname:"IRST"}
,daylight:{
offset:270,mon:3,week:4,wkday:1,hour:0,min:0,sec:0,trans:[2010,3,28],tzname:"IRDT"}}
,{
serverId:"Asia/Baku",clientId:"Asia/Baku",standard:{
offset:240,mon:10,week:-1,wkday:1,hour:5,min:0,sec:0,trans:[2010,10,31],tzname:"AZT"}
,daylight:{
offset:300,mon:3,week:-1,wkday:1,hour:4,min:0,sec:0,trans:[2010,3,28],tzname:"AZST"}}
,{
serverId:"Asia/Muscat",clientId:"Asia/Muscat",standard:{
offset:240,tzname:"GST"}}
,{
serverId:"Asia/Tbilisi",clientId:"Asia/Tbilisi",standard:{
offset:240,tzname:"GET"}}
,{
serverId:"Asia/Yerevan",clientId:"Asia/Yerevan",standard:{
offset:240,mon:10,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2010,10,31],tzname:"AMT"}
,daylight:{
offset:300,mon:3,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,28],tzname:"AMST"}}
,{
serverId:"Asia/Kabul",clientId:"Asia/Kabul",standard:{
offset:270,tzname:"AFT"}}
,{
serverId:"Asia/Karachi",clientId:"Asia/Karachi",standard:{
offset:300,mon:11,week:1,wkday:1,hour:0,min:0,sec:0,trans:[2010,11,7],tzname:"PKT"}
,daylight:{
offset:360,mon:4,week:3,wkday:4,hour:0,min:0,sec:0,trans:[2010,4,21],tzname:"PKST"}}
,{
serverId:"Asia/Tashkent",clientId:"Asia/Tashkent",standard:{
offset:300,tzname:"UZT"}}
,{
serverId:"Asia/Yekaterinburg",clientId:"Asia/Yekaterinburg",standard:{
offset:300,mon:10,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2010,10,31],tzname:"YEKT"}
,daylight:{
offset:360,mon:3,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,28],tzname:"YEKST"}}
,{
serverId:"Asia/Colombo",clientId:"Asia/Colombo",standard:{
offset:330,tzname:"IST"}}
,{
serverId:"Asia/Kolkata",clientId:"Asia/Kolkata",standard:{
offset:330,tzname:"IST"}}
,{
serverId:"Asia/Dhaka",clientId:"Asia/Dhaka",standard:{
offset:360,tzname:"BDT"}}
,{
serverId:"Asia/Novosibirsk",clientId:"Asia/Novosibirsk",standard:{
offset:360,mon:10,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2010,10,31],tzname:"NOVT"}
,daylight:{
offset:420,mon:3,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,28],tzname:"NOVST"}}
,{
serverId:"Asia/Rangoon",clientId:"Asia/Rangoon",standard:{
offset:390,tzname:"MMT"}}
,{
serverId:"Asia/Bangkok",clientId:"Asia/Bangkok",standard:{
offset:420,tzname:"ICT"}}
,{
serverId:"Asia/Krasnoyarsk",clientId:"Asia/Krasnoyarsk",standard:{
offset:420,mon:10,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2010,10,31],tzname:"KRAT"}
,daylight:{
offset:480,mon:3,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,28],tzname:"KRAST"}}
,{
serverId:"Asia/Hong_Kong",clientId:"Asia/Hong_Kong",standard:{
offset:480}}
,{
serverId:"Asia/Irkutsk",clientId:"Asia/Irkutsk",standard:{
offset:480,mon:10,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2010,10,31],tzname:"IRKT"}
,daylight:{
offset:540,mon:3,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,28],tzname:"IRKST"}}
,{
serverId:"Asia/Kuala_Lumpur",clientId:"Asia/Kuala_Lumpur",standard:{
offset:480,tzname:"MYT"}}
,{
serverId:"Asia/Taipei",clientId:"Asia/Taipei",standard:{
offset:480}}
,{
serverId:"Australia/Perth",clientId:"Australia/Perth",standard:{
offset:480,tzname:"WST"}}
,{
serverId:"Asia/Seoul",clientId:"Asia/Seoul",standard:{
offset:540}}
,{
serverId:"Asia/Tokyo",clientId:"Asia/Tokyo",standard:{
offset:540}}
,{
serverId:"Asia/Yakutsk",clientId:"Asia/Yakutsk",standard:{
offset:540,mon:10,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2010,10,31],tzname:"YAKT"}
,daylight:{
offset:600,mon:3,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,28],tzname:"YAKST"}}
,{
serverId:"Australia/Adelaide",clientId:"Australia/Adelaide",standard:{
offset:570,mon:4,week:1,wkday:1,hour:3,min:0,sec:0,trans:[2010,4,4],tzname:"CST"}
,daylight:{
offset:630,mon:10,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2010,10,3],tzname:"CST"}}
,{
serverId:"Australia/Darwin",clientId:"Australia/Darwin",standard:{
offset:570,tzname:"CST"}}
,{
serverId:"Asia/Vladivostok",clientId:"Asia/Vladivostok",standard:{
offset:600,mon:10,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2010,10,31],tzname:"VLAT"}
,daylight:{
offset:660,mon:3,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,28],tzname:"VLAST"}}
,{
serverId:"Australia/Brisbane",clientId:"Australia/Brisbane",standard:{
offset:600,tzname:"EST"}}
,{
serverId:"Australia/Hobart",clientId:"Australia/Hobart",standard:{
offset:600,mon:4,week:1,wkday:1,hour:3,min:0,sec:0,trans:[2010,4,4],tzname:"EST"}
,daylight:{
offset:660,mon:10,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2010,10,3],tzname:"EST"}}
,{
serverId:"Australia/Sydney",clientId:"Australia/Sydney",standard:{
offset:600,mon:4,week:1,wkday:1,hour:3,min:0,sec:0,trans:[2010,4,4],tzname:"EST"}
,daylight:{
offset:660,mon:10,week:1,wkday:1,hour:2,min:0,sec:0,trans:[2010,10,3],tzname:"EST"}}
,{
serverId:"Pacific/Guam",clientId:"Pacific/Guam",standard:{
offset:600,tzname:"ChST"}}
,{
serverId:"Asia/Magadan",clientId:"Asia/Magadan",standard:{
offset:660,mon:10,week:-1,wkday:1,hour:3,min:0,sec:0,trans:[2010,10,31],tzname:"MAGT"}
,daylight:{
offset:720,mon:3,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,3,28],tzname:"MAGST"}}
,{
serverId:"Pacific/Auckland",clientId:"Pacific/Auckland",standard:{
offset:720,mon:4,week:1,wkday:1,hour:3,min:0,sec:0,trans:[2010,4,4],tzname:"NZST"}
,daylight:{
offset:780,mon:9,week:-1,wkday:1,hour:2,min:0,sec:0,trans:[2010,9,26],tzname:"NZDT"}}
,{
serverId:"Pacific/Fiji",clientId:"Pacific/Fiji",standard:{
offset:720}}
,{
serverId:"Pacific/Tongatapu",clientId:"Pacific/Tongatapu",standard:{
offset:780}}
]
}
if(AjxPackage.define("ajax.util.AjxTimezone")){
AjxTimezone=function(){};
AjxTimezone.getTransition=function(o,a){
var t=[a||new Date().getFullYear(),o.mon,1];
if(o.mday){
t[2]=o.mday
}else{
if(o.wkday){
var e=new Date(a,o.mon-1,1,o.hour,o.min,o.sec);
if(o.week==-1){
var s=new Date(new Date(e.getTime()).setMonth(o.mon,0));
var n=s.getDate();
var h=s.getDay()+1;
var r=h>=o.wkday?h-o.wkday:7-o.wkday-h;
t[2]=n-r
}else{
var h=e.getDay()+1;
var r=o.wkday==h?1:0;
t[2]=o.wkday+7*(o.week-r)-h+1
}}}
return t
};
AjxTimezone.createMDayTransition=function(e,a){
if(e instanceof Date){
a=a!=null?a:e.getTimezoneOffset();
e=[e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()]
}
var t={
offset:a,trans:e};
return AjxTimezone.addMDayTransition(t)
};
AjxTimezone.addMDayTransition=function(t){
var e=t.trans;
t.mon=e[1];
t.mday=e[2];
t.hour=e[3];
t.min=e[4];
t.sec=e[5];
return t
};
AjxTimezone.createWkDayTransition=function(e,a){
if(e instanceof Date){
a=a!=null?a:e.getTimezoneOffset();
e=[e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()]
}
var t={
offset:a,trans:e};
return AjxTimezone.addWkDayTransition(t)
};
AjxTimezone.addWkDayTransition=function(n){
var a=n.trans;
var o=a[1];
var h=a[2];
var t=Math.floor((h-1)/7);
var e=new Date(a[0],a[1]-1,a[2],12,0,0);
var r=new Date(new Date(e.getTime()).setMonth(o-1,0)).getDate();
var s=r-h<7;
n.mon=o;
n.week=s?-1:t+1;
n.wkday=e.getDay()+1;
n.hour=a[3];
n.min=a[4];
n.sec=a[5];
return n
};
AjxTimezone.createTransitionDate=function(o){
var e=new Date(AjxTimezoneData.TRANSITION_YEAR,o.mon-1,1,12,0,0);
if(o.mday){
e.setDate(o.mday)
}else{
if(o.week==-1){
e.setMonth(e.getMonth()+1,0);
for(var a=0;
a<7;
a++){
if(e.getDay()+1==o.wkday){
break
}
e.setDate(e.getDate()-1)
}}else{
for(var a=0;
a<7;
a++){
if(e.getDay()+1==o.wkday){
break
}
e.setDate(e.getDate()+1)
}
e.setDate(e.getDate()+7*(o.week-1))
}}
var t=[e.getFullYear(),e.getMonth()+1,e.getDate()];
return t
};
AjxTimezone.getZonePreferences=function(){
if(AjxTimezone._PREF_ZONE_DISPLAY){
var a=AjxTimezone._PREF_ZONE_DISPLAY.length;
var t=AjxTimezone.STANDARD_RULES.length+AjxTimezone.DAYLIGHT_RULES.length;
if(a!=t){
AjxTimezone._PREF_ZONE_DISPLAY=null
}}
if(!AjxTimezone._PREF_ZONE_DISPLAY){
AjxTimezone._PREF_ZONE_DISPLAY=[];
AjxTimezone.getAbbreviatedZoneChoices();
for(var e=0;
e<AjxTimezone._ABBR_ZONE_OPTIONS.length;
e++){
AjxTimezone._PREF_ZONE_DISPLAY.push(AjxTimezone._ABBR_ZONE_OPTIONS[e].displayValue)
}}
return AjxTimezone._PREF_ZONE_DISPLAY
};
AjxTimezone.getZonePreferencesOptions=function(){
if(AjxTimezone._PREF_ZONE_OPTIONS){
var a=AjxTimezone._PREF_ZONE_OPTIONS.length;
var t=AjxTimezone.STANDARD_RULES.length+AjxTimezone.DAYLIGHT_RULES.length;
if(a!=t){
AjxTimezone._PREF_ZONE_OPTIONS=null
}}
if(!AjxTimezone._PREF_ZONE_OPTIONS){
AjxTimezone._PREF_ZONE_OPTIONS=[];
AjxTimezone.getAbbreviatedZoneChoices();
for(var e=0;
e<AjxTimezone._ABBR_ZONE_OPTIONS.length;
e++){
AjxTimezone._PREF_ZONE_OPTIONS.push(AjxTimezone._ABBR_ZONE_OPTIONS[e].serverid)
}}
return AjxTimezone._PREF_ZONE_OPTIONS
};
AjxTimezone.getServerId=function(e){
return AjxTimezone._CLIENT2SERVER[e]||e
};
AjxTimezone.getClientId=function(e){
return AjxTimezone._SERVER2CLIENT[e]||e
};
AjxTimezone.getShortName=function(e){
var t=AjxTimezone.getRule(e);
if(!t.shortName){
t.shortName=["GMT",AjxTimezone._SHORT_NAMES[e]].join("")
}
return t.shortName
};
AjxTimezone.getMediumName=function(e){
var t=AjxTimezone.getRule(e);
if(!t.mediumName){
t.mediumName=AjxMsg[e]||["(",AjxTimezone.getShortName(e),") ",e].join("")
}
return t.mediumName
};
AjxTimezone.getLongName=AjxTimezone.getMediumName;
AjxTimezone.addRule=function(a){
var t=a.serverId;
var e=a.clientId;
AjxTimezone._CLIENT2SERVER[e]=t;
AjxTimezone._SERVER2CLIENT[t]=e;
AjxTimezone._SHORT_NAMES[e]=AjxTimezone._generateShortName(a.standard.offset);
AjxTimezone._CLIENT2RULE[e]=a;
var o=a.daylight?AjxTimezone.DAYLIGHT_RULES:AjxTimezone.STANDARD_RULES;
o.push(a)
};
AjxTimezone.getRule=function(e,o){
var d=AjxTimezone._CLIENT2RULE[e];
if(!d){
e=AjxTimezone._SERVER2CLIENT[e];
d=AjxTimezone._CLIENT2RULE[e]
}
if(!d&&o){
var c=["standard","daylight"];
var u=o.daylight?AjxTimezone.DAYLIGHT_RULES:AjxTimezone.STANDARD_RULES;
for(var s=0;
s<u.length;
s++){
d=u[s];
var m=true;
for(var n=0;
n<c.length;
n++){
var t=c[n];
var r=d[t];
if(!r){
continue
}
var h=false;
for(var a in o[t]){
if(o[t][a]!=r[a]){
m=false;
h=true;
break
}}
if(h){
break
}}
if(m){
return d
}}
return null
}
return d
};
AjxTimezone.getOffset=function(e,n){
var f=AjxTimezone.getRule(e||AjxTimezone.DEFAULT);
if(f&&f.daylight){
var u=n.getFullYear();
var r=f.standard,t=f.daylight;
var d=AjxTimezone.getTransition(r,u);
var g=AjxTimezone.getTransition(t,u);
var c=n.getMonth()+1,m=n.getDate();
var s=d[1],p=d[2];
var h=g[1],o=g[2];
var a=false;
if(h<s){
a=c>h&&c<s;
a=a||(c==h&&m>=o);
a=a||(c==s&&m<p)
}else{
a=c<h||c>s;
a=a||(c==h&&m<o);
a=a||(c==s&&m>=p)
}
return a?t.offset:r.offset
}
return f?f.standard.offset:-(new Date().getTimezoneOffset())
};
AjxTimezone.guessMachineTimezone=function(){
return AjxTimezone._guessMachineTimezone().clientId
};
AjxTimezone.getAbbreviatedZoneChoices=function(){
if(AjxTimezone._ABBR_ZONE_OPTIONS){
var n=AjxTimezone._ABBR_ZONE_OPTIONS.length;
var o=AjxTimezone.STANDARD_RULES.length+AjxTimezone.DAYLIGHT_RULES.length;
if(n!=o){
AjxTimezone._ABBR_ZONE_OPTIONS=null
}}
if(!AjxTimezone._ABBR_ZONE_OPTIONS){
AjxTimezone._ABBR_ZONE_OPTIONS=[];
for(var e in AjxTimezone._CLIENT2SERVER){
var s=AjxTimezone._CLIENT2RULE[e];
var t=s.serverId;
var a={
displayValue:AjxTimezone.getMediumName(e),value:t,standard:s.standard,serverid:t,clientId:e};
AjxTimezone._ABBR_ZONE_OPTIONS.push(a)
}
AjxTimezone._ABBR_ZONE_OPTIONS.sort(AjxTimezone._BY_OFFSET)
}
return AjxTimezone._ABBR_ZONE_OPTIONS
};
AjxTimezone.getMatchingTimezoneChoices=function(){
if(AjxTimezone._MATCHING_ZONE_OPTIONS){
var s=AjxTimezone._MATCHING_ZONE_OPTIONS.length;
var n=AjxTimezone.STANDARD_RULES.length+AjxTimezone.DAYLIGHT_RULES.length;
if(s!=n){
AjxTimezone._MATCHING_ZONE_OPTIONS=null
}}
if(!AjxTimezone._MATCHING_ZONE_OPTIONS){
AjxTimezone._MATCHING_ZONE_OPTIONS=[];
for(var a in AjxTimezone.MATCHING_RULES){
var r=AjxTimezone.MATCHING_RULES[a];
var e=r.clientId;
var t=r.serverId;
if(e==AjxTimezone.AUTO_DETECTED){
continue
}
var o={
displayValue:AjxTimezone.getMediumName(e),value:t,standard:r.standard,serverid:t,clientId:e};
AjxTimezone._MATCHING_ZONE_OPTIONS.push(o)
}
AjxTimezone._MATCHING_ZONE_OPTIONS.sort(AjxTimezone._BY_OFFSET)
}
return AjxTimezone._MATCHING_ZONE_OPTIONS
};
AjxTimezone._BY_OFFSET=function(a,t){
var n=a.standard.offset-t.standard.offset;
if(n==0){
var e=a.serverId;
var o=t.serverId;
if(e<o){
n=-1
}else{
if(e>o){
n=1
}}}
return n
};
AjxTimezone.GMT="Europe/London";
AjxTimezone.GMT_NO_DST="Africa/Casablanca";
AjxTimezone.AUTO_DETECTED="Auto-Detected";
AjxTimezone.DEFAULT;
AjxTimezone.DEFAULT_RULE;
AjxTimezone._CLIENT2SERVER={};
AjxTimezone._SERVER2CLIENT={};
AjxTimezone._SHORT_NAMES={};
AjxTimezone._CLIENT2RULE={};
AjxTimezone.STANDARD_RULES=[];
AjxTimezone.DAYLIGHT_RULES=[];
(function(){
for(var e=0;
e<AjxTimezoneData.TIMEZONE_RULES.length;
e++){
var t=AjxTimezoneData.TIMEZONE_RULES[e];
var a=t.daylight?AjxTimezone.DAYLIGHT_RULES:AjxTimezone.STANDARD_RULES;
a.push(t)
}}
)();
AjxTimezone._guessMachineTimezone=function(p){
var m=new Date(AjxTimezoneData.TRANSITION_YEAR,11,1,0,0,0);
var k=new Date(AjxTimezoneData.TRANSITION_YEAR,5,1,0,0,0);
var t=-m.getTimezoneOffset();
var y=-k.getTimezoneOffset();
AjxTimezone.MATCHING_RULES=[];
AjxTimezone.TIMEZONE_CONFLICT=false;
var d=[];
var s={};
var r=[];
var g=false;
if(y==t){
var f=AjxTimezone.STANDARD_RULES;
for(var w=0;
w<f.length;
++w){
var h=f[w];
if(h.standard.offset==y){
if(!s[h.serverId]){
d.push(h);
s[h.serverId]=true
}
AjxTimezone.MATCHING_RULES.push(h)
}}}else{
var f=AjxTimezone.DAYLIGHT_RULES;
var j=Math.max(t,y);
var x=Math.min(t,y);
var o=new Date();
var v=-o.getTimezoneOffset();
for(var w=0;
w<f.length;
++w){
var h=f[w];
if(h.standard.offset==x&&h.daylight.offset==j){
var c=h.standard.trans;
var u=h.daylight.trans;
var n=new Date(c[0],c[1]-1,c[2]-1);
var a=new Date(c[0],c[1]-1,c[2]+2);
var e=new Date(u[0],u[1]-1,u[2]-1);
var q=new Date(u[0],u[1]-1,u[2]+2);
if(-a.getTimezoneOffset()==x&&-q.getTimezoneOffset()==j&&-n.getTimezoneOffset()==j&&-e.getTimezoneOffset()==x){
if(!s[h.serverId]){
d.push(h);
s[h.serverId]=true
}
g=true
}}
if(h.standard.offset==v||h.daylight.offset==v){
AjxTimezone.MATCHING_RULES.push(h)
}}}
if((d.length>0)&&p!=null){
var f=d;
for(var w in f){
if(f[w].serverId==p){
return f[w]
}}}
if(d.length>0){
AjxTimezone.TIMEZONE_CONFLICT=(d.length>1);
return d[0]
}
if((AjxTimezone.MATCHING_RULES.length>0)&&p!=null){
var f=AjxTimezone.MATCHING_RULES;
for(var w in f){
if(f[w].serverId==p){
return f[w]
}}}
return AjxTimezone._generateDefaultRule()
};
AjxTimezone._generateDefaultRule=function(){
var d=0;
var a=1;
var o=2;
var r=3;
var n=4;
function u(f,m,k,x){
var g=m.getTime();
var v=new Date();
v.setTime(f.getTime());
var w=new Date();
w.setTime(v.getTime());
var q=f.getTimezoneOffset()*-1;
if(!x){
x={
clientId:AjxTimezone.AUTO_DETECTED,autoDetected:true}
}
while(v.getTime()<=g){
if(k==d){
v.setUTCMonth(v.getUTCMonth()+1)
}else{
if(k==a){
v.setUTCDate(v.getUTCDate()+1)
}else{
if(k==o){
v.setUTCHours(v.getUTCHours()+1)
}else{
if(k==r){
v.setUTCMinutes(v.getUTCMinutes()+1)
}else{
if(k==n){
v.setUTCSeconds(v.getUTCSeconds()+1)
}else{
return x
}}}}}
var p=v.getTimezoneOffset()*-1;
if(p!=q){
if(k<n){
x=u(w,v,k+1,x)
}else{
var j=new Date();
j.setUTCFullYear(w.getFullYear(),w.getMonth(),w.getDate());
j.setUTCHours(w.getHours(),w.getMinutes(),w.getSeconds()+1);
var y=x[q<p?"daylight":"standard"]={
offset:p,trans:[j.getUTCFullYear(),j.getUTCMonth()+1,j.getUTCDate(),j.getUTCHours(),j.getUTCMinutes(),j.getUTCSeconds()]};
AjxTimezone.addWkDayTransition(y);
return x
}}
w.setTime(v.getTime());
q=p
}
return x
}
var t=new Date();
var e=new Date();
var h=t.getFullYear();
t.setUTCFullYear(h,t.getMonth(),t.getDate()-1);
t.setUTCHours(0,0,0,0);
e.setTime(t.getTime());
e.setUTCFullYear(h+1,t.getMonth(),t.getDate()+1);
var c=u(t,e,d);
if(!c.daylight||!c.standard){
c.standard={
offset:t.getTimezoneOffset()*-1};
delete c.daylight
}
c.serverId=["(GMT",AjxTimezone._generateShortName(c.standard.offset,true),") ",AjxTimezone.AUTO_DETECTED].join("");
if(c.daylight&&c.daylight.offset<c.standard.offset){
var s=c.daylight;
c.daylight=c.standard;
c.standard=s
}
return c
};
AjxTimezone._generateShortName=function(s,n){
if(s==0){
return""
}
var t=s<0?"-":"+";
var a=Math.abs(s);
var e=Math.floor(a/60);
var o=a%60;
e=e<10?"0"+e:e;
o=o<10?"0"+o:o;
return[t,e,n?".":"",o].join("")
};
AjxTimezone.DEFAULT_RULE=AjxTimezone._guessMachineTimezone();
(function(){
AjxTimezoneData.TIMEZONE_RULES.sort(AjxTimezone._BY_OFFSET);
for(var e=0;
e<AjxTimezoneData.TIMEZONE_RULES.length;
e++){
var t=AjxTimezoneData.TIMEZONE_RULES[e];
AjxTimezone.addRule(t)
}}
)();
AjxTimezone.DEFAULT=AjxTimezone.getClientId(AjxTimezone.DEFAULT_RULE.serverId)
}
if(AjxPackage.define("ajax.util.AjxEmailAddress")){
AjxEmailAddress=function(e,o,t,a,n){
this.address=e;
this.name=this._setName(t);
this.dispName=a;
this.type=o||AjxEmailAddress.TO;
this.isGroup=n;
this.isAjxEmailAddress=true
};
AjxEmailAddress.FROM="FROM";
AjxEmailAddress.TO="TO";
AjxEmailAddress.CC="CC";
AjxEmailAddress.BCC="BCC";
AjxEmailAddress.REPLY_TO="REPLY_TO";
AjxEmailAddress.SENDER="SENDER";
AjxEmailAddress.READ_RECEIPT="READ_RECEIPT";
AjxEmailAddress.TYPE_STRING={};
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.FROM]="from";
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.TO]="to";
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.CC]="cc";
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.BCC]="bcc";
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.REPLY_TO]="replyTo";
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.SENDER]="sender";
AjxEmailAddress.TYPE_STRING[AjxEmailAddress.READ_RECEIPT]="readReceipt";
AjxEmailAddress.fromSoapType={};
AjxEmailAddress.fromSoapType.f=AjxEmailAddress.FROM;
AjxEmailAddress.fromSoapType.t=AjxEmailAddress.TO;
AjxEmailAddress.fromSoapType.c=AjxEmailAddress.CC;
AjxEmailAddress.fromSoapType.b=AjxEmailAddress.BCC;
AjxEmailAddress.fromSoapType.r=AjxEmailAddress.REPLY_TO;
AjxEmailAddress.fromSoapType.s=AjxEmailAddress.SENDER;
AjxEmailAddress.fromSoapType.n=AjxEmailAddress.READ_RECEIPT;
AjxEmailAddress.toSoapType={};
AjxEmailAddress.toSoapType[AjxEmailAddress.FROM]="f";
AjxEmailAddress.toSoapType[AjxEmailAddress.TO]="t";
AjxEmailAddress.toSoapType[AjxEmailAddress.CC]="c";
AjxEmailAddress.toSoapType[AjxEmailAddress.BCC]="b";
AjxEmailAddress.toSoapType[AjxEmailAddress.REPLY_TO]="r";
AjxEmailAddress.toSoapType[AjxEmailAddress.SENDER]="s";
AjxEmailAddress.toSoapType[AjxEmailAddress.READ_RECEIPT]="n";
AjxEmailAddress.SEPARATOR="; ";
AjxEmailAddress.DELIMS=[";",",","\n"," "];
AjxEmailAddress.IS_DELIM={};
for(var i=0;
i<AjxEmailAddress.DELIMS.length;
i++){
AjxEmailAddress.IS_DELIM[AjxEmailAddress.DELIMS[i]]=true
}
AjxEmailAddress.addrAnglePat=/(\s*<(((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))\@((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*\[(\s*(([^\[\]\\])|(\\([^\x0A\x0D])))+)*\s*\]\s*)))>\s*)/;
AjxEmailAddress.addrAngleQuotePat=/(\s*<'(((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))\@((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*\[(\s*(([^\[\]\\])|(\\([^\x0A\x0D])))+)*\s*\]\s*)))'>\s*)/;
AjxEmailAddress.addrPat=/(((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))\@((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*\[(\s*(([^\[\]\\])|(\\([^\x0A\x0D])))+)*\s*\]\s*)))/;
AjxEmailAddress.addrPat1=/(^|"|\s)(((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))\@((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*\[(\s*(([^\[\]\\])|(\\([^\x0A\x0D])))+)*\s*\]\s*)))/;
AjxEmailAddress.accountPat=/((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))/;
AjxEmailAddress.commentPat=/\((.*)\)/g;
AjxEmailAddress.phrasePat=/(((\s*[^\x00-\x1F\x7F()<>\[\]:;@\"\s]+\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))+)/;
AjxEmailAddress.boundAddrPat=/(\s*<?(((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*"(([^\\"])|(\\([^\x0A\x0D])))+"\s*))\@((\s*([^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+(\.[^\x00-\x1F\x7F()<>\[\]:;@\,."\s]+)*)\s*)|(\s*\[(\s*(([^\[\]\\])|(\\([^\x0A\x0D])))+)*\s*\]\s*)))>?\s*)$/;
AjxEmailAddress.parse=function(o){
var n,e;
var o=AjxStringUtil.trim(o);
var t=AjxEmailAddress._prelimCheck(o);
if(!(t&&o.match(AjxEmailAddress.addrPat))){
return null
}
var a=o.match(AjxEmailAddress.addrAngleQuotePat)||o.match(AjxEmailAddress.addrAnglePat);
if(a&&a.length){
n=a[2];
o=o.replace(AjxEmailAddress.addrAnglePat,"")
}else{
a=o.match(AjxEmailAddress.addrPat1);
if(a&&a.length){
n=o.match(AjxEmailAddress.addrPat);
n=(n&&n.length&&n[0]!="")?AjxStringUtil.trim(n[0]):a[0];
o=o.replace(AjxEmailAddress.addrPat,"")
}}
a=o.match(AjxEmailAddress.phrasePat);
if(a){
e=AjxStringUtil.trim(AjxStringUtil.trim(a[0]),false,'"')
}
return new AjxEmailAddress(n,null,e)
};
AjxEmailAddress.parseEmailString=function(a,u,m){
var n=new AjxVector();
var t=new AjxVector();
var f=new AjxVector();
var h=AjxEmailAddress.split(a);
for(var r=0;
r<h.length;
r++){
var c=AjxStringUtil.trim(h[r]);
if(c){
var d=AjxEmailAddress.parse(c);
if(!d&&!m){
var p=c;
var s=p.match(AjxEmailAddress.addrAnglePat);
if(s&&s.length){
var e=p.replace(AjxEmailAddress.addrAnglePat,"");
var o=['"',e,'" ',s[0]].join("");
d=AjxEmailAddress.parse(o);
if(d){
d.name=e
}}}
if(d){
d.type=u;

n.add(d);
f.add(d)
}else{
t.add(c);
f.add(new AjxEmailAddress(c))
}}}
return{
good:n,bad:t,all:f}
};
AjxEmailAddress.isValid=function(t){
t=AjxStringUtil.trim(t);
var e=AjxEmailAddress._prelimCheck(t);
return(e&&(t.match(AjxEmailAddress.addrPat)!=null))
};
AjxEmailAddress._prelimCheck=function(a){
var e=a.indexOf("@");
var t=a.lastIndexOf(".");
return((e!=-1)&&(t!=-1)&&(t>e))
};
AjxEmailAddress.split=function(g){
g=AjxStringUtil.trim(g);
var p=[];
var y=0,m=0;
var w="",s="";
var r=false;
while(y<g.length){
var a=g.charAt(y);
if((a=='"'||a=="(")&&w!="\\"){
r=true;
s=a;
m=y;
y++;
while(r&&y<g.length){
var a=g.charAt(y);
if(((s=='"'&&a=='"')||(s=="("&&a==")"))&&(w!="\\")){
p.push({
start:m,end:y}
);
r=false
}
y++;
w=a
}}else{
y++
}
w=a
}
if(p.length){
AjxEmailAddress.IS_DELIM[" "]=false
}
m=0;
var u=[];
while(m<g.length){
var t=g.substring(m,g.length);
y=0;
var n=t.length;
while((n==t.length)&&(y<t.length)){
var a=t.charAt(y);
if(AjxEmailAddress.IS_DELIM[a]){
var o=false;
if(a!="\n"){
for(var c=0;
c<p.length;
c++){
var d=p[c];
var e=m+y;
o=(e>=d.start&&e<=d.end);
if(o){
break
}}}
if(!o){
var h=true;
var f=t.substring(0,y);
if(a==","||a==" "){
h=f.match(AjxEmailAddress.boundAddrPat)
}
if(h){
u.push(f);
n=y;
m+=f.length+1
}}
a=g.charAt(m);
while((m<g.length)&&AjxEmailAddress.IS_DELIM[a]){
m++;
a=g.charAt(m)
}
y++
}else{
y++
}}
if(n==t.length){
u.push(t);
m+=t.length+1
}}
AjxEmailAddress.IS_DELIM[" "]=true;
return u
};
AjxEmailAddress.prototype.toString=function(){
if(this.name&&!this.isGroup){
var e=this.name.replace(/\\+"/g,'"');
e=e.replace(/"/g,'\\"');
return['"',e,'" <',this.address,">"].join("")
}else{
return this.address
}};
AjxEmailAddress.prototype.getAddress=function(){
return this.address
};
AjxEmailAddress.prototype.setAddress=function(e){
this.address=e
};
AjxEmailAddress.prototype.getType=function(){
return this.type
};
AjxEmailAddress.prototype.setType=function(e){
this.type=e
};
AjxEmailAddress.prototype.getTypeAsString=function(){
return AjxEmailAddress.TYPE_STRING[this.type]
};
AjxEmailAddress.prototype.getName=function(){
return this.name
};
AjxEmailAddress.prototype.getDispName=function(){
return this.dispName
};
AjxEmailAddress.prototype.clone=function(){
var e=new AjxEmailAddress(this.address,this.type,this.name,this.dispName);
e.icon=this.icon;
return e
};
AjxEmailAddress.copy=function(e){
var t=new AjxEmailAddress(e.address,e.type,e.name,e.dispName);
t.icon=e.icon;
return t
};
AjxEmailAddress.prototype._setName=function(e){
if(!e){
return""
}
if(e&&e.charAt(0)=="'"&&e.charAt(e.length-1)=="'"){
e=e.substring(1,e.length-1)
}
return e
}
}
if(AjxPackage.define("ajax.util.AjxHistoryMgr")){
AjxHistoryMgr=function(){
this.currentLocation=null;
this.listener=null;
this.iframe=null;
this.ignoreLocationChange=null;
this.WAIT_TIME=AjxEnv.isIE?400:200;
this.currentWaitTime=0;
this.ieAtomicLocationChange=null;
this._eventMgr=new AjxEventMgr();
this._evt=new AjxEvent();
this._initialize()
};
AjxHistoryMgr.BLANK_FILE="blankHistory.html";
AjxHistoryMgr.IFRAME_ID="DhtmlHistoryFrame";
AjxHistoryMgr.LOCATION_CHECK_INTERVAL=100;
AjxHistoryMgr.prototype.addListener=function(e){
return this._eventMgr.addListener(AjxEvent.HISTORY,e)
};
AjxHistoryMgr.prototype.removeListener=function(e){
return this._eventMgr.removeListener(AjxEvent.HISTORY,e)
};
AjxHistoryMgr.prototype.add=function(a){
var e=this;
var t=function(){
if(e.currentWaitTime>0){
e.currentWaitTime=e.currentWaitTime-e.WAIT_TIME
}
a=e._removeHash(a);
if(AjxEnv.isIE){
if(document.getElementById(a)){
throw new DwtException("AjxHistoryMgr: location has same ID as DOM element")
}}
e.ignoreLocationChange=true;
this.ieAtomicLocationChange=true;
e.currentLocation=a;
window.location.hash=a;
if(AjxEnv.isIE){
e.iframe.src=AjxHistoryMgr.BLANK_FILE+"?"+a
}
this.ieAtomicLocationChange=false
};
window.setTimeout(t,this.currentWaitTime);
this.currentWaitTime=this.currentWaitTime+e.WAIT_TIME
};
AjxHistoryMgr.prototype.getCurrentLocation=function(){
return this._removeHash(window.location.hash)
};
AjxHistoryMgr.prototype._initialize=function(){
var e=this.getCurrentLocation();
this.currentLocation=e;
if(AjxEnv.isIE){
var n=[];
var o=0;
n[o++]="<iframe style='border: 0px; width: 1px; ";
n[o++]="height: 1px; position: absolute; bottom: 0px; ";
n[o++]="right: 0px; visibility: visible;' ";
n[o++]="id='"+AjxHistoryMgr.IFRAME_ID+"' ";
n[o++]="src='"+AjxHistoryMgr.BLANK_FILE+"?"+e+"'>";
n[o++]="</iframe>";
var s=document.createElement("div");
document.body.appendChild(s);
s.innerHTML=n.join("")
}
if(AjxEnv.isIE){
this.iframe=document.getElementById(AjxHistoryMgr.IFRAME_ID)
}
var t=this;
var a=function(){
t._checkLocation()
};
setInterval(a,AjxHistoryMgr.LOCATION_CHECK_INTERVAL)
};
AjxHistoryMgr.prototype._checkLocation=function(){
if(!AjxEnv.isIE&&this.ignoreLocationChange){
this.ignoreLocationChange=false;
return
}
if(!AjxEnv.isIE&&this.ieAtomicLocationChange){
return
}
var e=this.getCurrentLocation();
if(e==this.currentLocation){
return
}
this.ieAtomicLocationChange=true;
if(AjxEnv.isIE&&this._getIFrameHash()!=e){
this.iframe.src=AjxHistoryMgr.BLANK_FILE+"?"+e
}else{
if(AjxEnv.isIE){
return
}}
this.currentLocation=e;
this.ieAtomicLocationChange=false;
this._evt.data=e;
this._eventMgr.notifyListeners(AjxEvent.HISTORY,this._evt)
};
AjxHistoryMgr.prototype._getIFrameHash=function(){
var e=document.getElementById(AjxHistoryMgr.IFRAME_ID);
var a=e.contentWindow.document;
var t=new String(a.location.search);
if(t.length==1&&t.charAt(0)=="?"){
t=""
}else{
if(t.length>=2&&t.charAt(0)=="?"){
t=t.substring(1)
}}
return t
};
AjxHistoryMgr.prototype._removeHash=function(e){
if(e==null||e==undefined){
return null
}else{
if(e==""){
return""
}else{
if(e.length==1&&e.charAt(0)=="#"){
return""
}else{
if(e.length>1&&e.charAt(0)=="#"){
return e.substring(1)
}else{
return e
}}}}};
AjxHistoryMgr.prototype.iframeLoaded=function(e){
if(this.ignoreLocationChange){
this.ignoreLocationChange=false;
return
}
var t=new String(e.search);
if(t.length==1&&t.charAt(0)=="?"){
t=""
}else{
if(t.length>=2&&t.charAt(0)=="?"){
t=t.substring(1)
}}
window.location.hash=t;
this._evt.data=t;
this._eventMgr.notifyListeners(AjxEvent.HISTORY,this._evt)
}
}
if(AjxPackage.define("ajax.xml.AjxSerializer")){
AjxSerializer=function(){
if(arguments.length==0){
return
}};
AjxSerializer.prototype.serialize=function(e){
throw"NOT IMPLEMENTED"
};
AjxJsonSerializer=function(e){
AjxSerializer.call(this,null);
this._minimize=Boolean(e)
};
AjxJsonSerializer.prototype=new AjxSerializer;
AjxJsonSerializer.prototype.constructor=AjxJsonSerializer;
AjxJsonSerializer.E_ATTRS="_attrs";
AjxJsonSerializer.A_CONTENT="_content";
AjxJsonSerializer.A_NAMESPACE="_jsns";
AjxJsonSerializer.prototype.serialize=function(r){
var t={};
var p=0;
var u=null;
for(var o=r.firstChild;
o;
o=o.nextSibling){
var m=o.nodeType;
if(m==1){
var e=o.nodeName;
if(!t[e]){
t[e]=[];
p++
}
t[e].push(o);
continue
}
if(m==3||m==4){
if(!u){
u=[]
}
u.push(o.nodeValue);
continue
}}
var y={};
var s=0;
if(r.attributes){
for(var c=0;
c<r.attributes.length;
c++){
var d=r.attributes[c];
var e=d.nodeName;
var g=this.quote(d.nodeValue);
if(t[e]){
y[e]=g;
s++
}else{
t[e]=g;
p++
}}}
u=u&&u.join("");
if(u&&u.match(/^\s*$/)){
u=null
}
if(u){
u=this.quote(u);
if(s==0&&p==0){
return u
}}
if(u==null&&p==0&&s==0){
return"{}"
}
var f=["{"];
if(u){
f.push(this.quote(AjxJsonSerializer.A_CONTENT),":",u);
if(s>0||p>0){
f.push(",")
}}
if(s>0){
f.push(this.quote(AjxJsonSerializer.E_ATTRS),": { ");
var c=0;
for(var e in y){
if(c>0){
f.push(",")
}
f.push(this.quote(e),":",y[e]);
c++
}
f.push("}");
if(p>0){
f.push(", ")
}}
var h=0;
for(var e in t){
if(h>0){
f.push(",")
}
var n=t[e];
if(typeof n=="string"){
f.push(this.quote(e),":",n);
h++;
continue
}
f.push(this.quote(e),":");
if(!this._minimize||n.length>1){
f.push("[")
}
for(var c=0;
c<n.length;
c++){
if(c>0){
f.push(",")
}

f.push(this.serialize(n[c]))
}
if(!this._minimize||n.length>1){
f.push("]")
}
h++
}
f.push("}");
return f.join("")
};
AjxJsonSerializer.prototype.quote=function(e){
return['"',this.escape(e),'"'].join("")
};
AjxJsonSerializer.prototype.escape=function(e){
return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n")
}
}
if(AjxPackage.define("ajax.dwt.core.DwtId")){
DwtId=function(){};
DwtId.SEP="__";
DwtId.WIDGET_LIST_VIEW="zl";
DwtId.WIDGET_HDR="zlh";
DwtId.WIDGET_HDR_TABLE="zlht";
DwtId.WIDGET_HDR_ICON="zlhi";
DwtId.WIDGET_HDR_LABEL="zlhl";
DwtId.WIDGET_HDR_ARROW="zlha";
DwtId.WIDGET_HDR_SASH="zlhs";
DwtId.WIDGET_ITEM="zli";
DwtId.WIDGET_ITEM_ROW="zlir";
DwtId.WIDGET_ITEM_CELL="zlic";
DwtId.WIDGET_ITEM_FIELD="zlif";
DwtId.LIST_VIEW_HEADERS="headers";
DwtId.LIST_VIEW_ROWS="rows";
DwtId.IFRAME="iframe";
DwtId.DND_PLUS_ID="z__roundPlus";
DwtId._makeId=function(){
var a=[];
for(var t=0;
t<arguments.length;
t++){
var e=arguments[t];
if(e!=null&&e!=""){
a.push(e)
}}
return a.join(DwtId.SEP)
};
DwtId.getListViewId=function(t,e){
return DwtId._makeId(DwtId.WIDGET_LIST_VIEW,t,e)
};
DwtId.getListViewHdrId=function(t,e,a){
return DwtId._makeId(t,e,a)
};
DwtId.getListViewItemId=function(t,e,o,a){
return DwtId._makeId(t,e,o,a)
};
DwtId.getIframeId=function(e){
return DwtId._makeId(e,DwtId.IFRAME)
}
}
if(AjxPackage.define("ajax.dwt.core.Dwt")){
Dwt=function(){};
Dwt.STATIC_STYLE="static";
Dwt.ABSOLUTE_STYLE="absolute";
Dwt.RELATIVE_STYLE="relative";
Dwt.FIXED_STYLE="fixed";
Dwt.NO_REPEAT="no-repeat";
Dwt.REPEAT="repeat";
Dwt.REPEAT_X="repeat-x";
Dwt.REPEAT_Y="repeat-y";
Dwt.DISPLAY_INLINE="inline";
Dwt.DISPLAY_BLOCK="block";
Dwt.DISPLAY_NONE="none";
Dwt.DISPLAY_TABLE_ROW=AjxEnv.isIE?Dwt.DISPLAY_BLOCK:"table-row";
Dwt.DISPLAY_TABLE_CELL=AjxEnv.isIE?Dwt.DISPLAY_BLOCK:"table-cell";
Dwt.CLIP=1;
Dwt.VISIBLE=2;
Dwt.SCROLL=3;
Dwt.FIXED_SCROLL=4;
Dwt.SCROLL_Y=5;
Dwt.SCROLL_X=6;
Dwt.Z_HIDDEN=100;
Dwt.Z_CURTAIN=200;
Dwt.Z_VIEW=300;
Dwt.Z_MENU=500;
Dwt.Z_VEIL=600;
Dwt.Z_DIALOG=700;
Dwt.Z_DIALOG_MENU=750;
Dwt.Z_TOOLTIP=775;
Dwt.Z_DND=800;
Dwt.Z_BUSY=900;
Dwt.Z_TOAST=950;
Dwt.Z_SPLASH=1000;
Dwt.DEFAULT=-123456789;
Dwt.CLEAR=-20000;
Dwt.LOC_NOWHERE=-10000;
Dwt.DND_DROP_NONE=0;
Dwt.DND_DROP_COPY=1;
Dwt.DND_DROP_MOVE=2;
Dwt.SCROLLBAR_WIDTH=22;
Dwt.KEY_OBJECT="_object_";
Dwt.KEY_ID="_id_";
Dwt._Z_INC=1;
Dwt.__nextId={};
Dwt.getNextId=function(e){
if(arguments.length==0){
e="DWT"
}
if(!Dwt.__nextId[e]){
Dwt.__nextId[e]=1
}
return e+Dwt.__nextId[e]++
};
Dwt.associateElementWithObject=function(a,e,t){
a[t||"dwtObj"]=e.__internalId=AjxCore.assignId(e)
};
Dwt.disassociateElementFromObject=function(a,e,t){
if(a){
a.removeAttribute(t||"dwtObj")
}
if(e.__internalId){
AjxCore.unassignId(e.__internalId)
}};
Dwt.getObjectFromElement=function(t,e){
return AjxCore.objectWithId(t[e||"dwtObj"])
};
Dwt.findAncestor=function(t,e){
while(t&&(Dwt.getAttr(t,e)==null)){
t=t.parentNode
}
return t
};
Dwt.setHandler=function(a,t,e){
if(t==DwtEvent.ONMOUSEWHEEL&&AjxEnv.isGeckoBased){
Dwt.clearHandler(a,t)
}
a[t]=e;
if(t==DwtEvent.ONMOUSEWHEEL&&AjxEnv.isGeckoBased){
a.addEventListener("DOMMouseScroll",e,true)
}};
Dwt.clearHandler=function(a,t){
if(t==DwtEvent.ONMOUSEWHEEL&&AjxEnv.isGeckoBased){
if(a[t]){
var e=a[t];
a.removeEventListener("DOMMouseScroll",e,true)
}}
a[t]=null
};
Dwt.getBackgroundRepeat=function(e){
return DwtCssStyle.getProperty(e,"background-repeat")
};
Dwt.setBackgroundRepeat=function(t,e){
t.style.backgroundRepeat=e
};
Dwt.getBounds=function(n,a){
var o=DwtPoint.tmp;
Dwt.getLocation(n,o);
var t=o.x;
var e=o.y;
Dwt.getSize(n,o);
if(!a){
return new DwtRectangle(t,e,o.x,o.y)
}else{
a.set(t,e,o.x,o.y);
return a
}};
Dwt.setBounds=function(o,t,n,a,e){
Dwt.setLocation(o,t,n);
Dwt.setSize(o,a,e)
};
Dwt.getCursor=function(e){
return DwtCssStyle.getProperty(e,"cursor")
};
Dwt.setCursor=function(t,e){
t.style.cursor=e
};
Dwt.getLocation=function(t,e){
var e=(e)?e:new DwtPoint(0,0);
if(t.style.position==Dwt.ABSOLUTE_STYLE){
e.set(parseInt(DwtCssStyle.getProperty(t,"left")),parseInt(DwtCssStyle.getProperty(t,"top")));
return e
}else{
return Dwt.toWindow(t,0,0,null,null,e)
}};
Dwt.setLocation=function(a,t,o){
var e=a.style.position;
if(e!=Dwt.ABSOLUTE_STYLE&&e!=Dwt.RELATIVE_STYLE&&e!=Dwt.FIXED_STYLE){
throw new DwtException("Static widgets may not be positioned",DwtException.INVALID_OP,"Dwt.setLocation")
}
if(t=Dwt.__checkPxVal(t)){
a.style.left=t
}
if(o=Dwt.__checkPxVal(o)){
a.style.top=o
}};
Dwt.getPosition=function(e){
return e.style.position
};
Dwt.setPosition=function(t,e){
t.style.position=e
};
Dwt.getScrollStyle=function(a){
var o=DwtCssStyle.getProperty(a,"overflow");
if(o=="hidden"){
return Dwt.CLIP
}else{
if(o=="auto"){
return Dwt.SCROLL
}else{
if(o=="scroll"){
return Dwt.FIXED_SCROLL
}else{
var t=DwtCssStyle.getProperty(a,"overflowX");
var e=DwtCssStyle.getProperty(a,"overflowY");
if(o==""){
if(t=="scroll"){
return Dwt.SCROLL_X
}else{
if(e=="scroll"){
return Dwt.SCROLL_Y
}}}
return Dwt.VISIBLE
}}}};
Dwt.setScrollStyle=function(t,e){
if(e==Dwt.CLIP){
t.style.overflow="hidden"
}else{
if(e==Dwt.SCROLL){
t.style.overflow="auto"
}else{
if(e==Dwt.FIXED_SCROLL){
t.style.overflow="scroll"
}else{
if(e==Dwt.SCROLL_Y){
t.style.overflowX="hidden";
t.style.overflowY="auto"
}else{
if(e==Dwt.SCROLL_X){
t.style.overflowY="hidden";
t.style.overflowX="auto"
}else{
t.style.overflow="visible"
}}}}}};
Dwt.getSize=function(a,e){
var t;
if(!e){
t=new DwtPoint(0,0)
}else{
t=e;
t.set(0,0)
}
if(!a){
return t
}
t.x=a.offsetWidth;
if(t.x!=null){
t.y=a.offsetHeight
}else{
if(a.clip&&a.clip.width!=null){
t.x=a.clip.width;
t.y=a.clip.height;
t.x=parseInt(t.x);
t.y=parseInt(t.y)
}else{
if(a.style&&a.style.pixelWidth!=null){
t.x=a.style.pixelWidth;
t.y=a.style.pixelHeight;
t.x=parseInt(t.x);
t.y=parseInt(t.y)
}}}
return t
};
Dwt.setSize=function(a,t,e){
if(!a.style){
return
}
if(t==Dwt.CLEAR){
a.style.width=null
}else{
if(t=Dwt.__checkPxVal(t,true)){
a.style.width=t
}}
if(e==Dwt.CLEAR){
a.style.height=null
}else{
if(e=Dwt.__checkPxVal(e,true)){
a.style.height=e
}}};
Dwt.getHtmlExtent=function(e){
var t=AjxStringUtil.calcDIV();
t.innerHTML=e;
return Dwt.getSize(t)
};
Dwt.toDocumentFragment=function(a,s){
var n=AjxStringUtil.calcDIV();
n.innerHTML=a;
var t=document.createDocumentFragment();
var e=s&&document.getElementById(s);
if(e){
t.appendChild(e)
}else{
for(var o=n.firstChild;
o;
o=n.firstChild){
t.appendChild(o)
}}
return t
};
Dwt.getAttr=function(a,e,t){
if(!t){
return a&&a.tagName?(a.getAttribute(e)||a[e]):null
}else{
while(a){
if(Dwt.getAttr(a,e)!=null){
return a
}
a=a.parentNode
}
return null
}};
Dwt.getVisible=function(t){
var e=DwtCssStyle.getProperty(t,"display");
return(e!=Dwt.DISPLAY_NONE)
};
Dwt.setVisible=function(t,a){
if(a){
if(t.nodeName.match(/tr/i)){
t.style.display=Dwt.DISPLAY_TABLE_ROW
}else{
if(t.nodeName.match(/td|th/i)){
t.style.display=Dwt.DISPLAY_TABLE_CELL
}else{
t.style.display=t.getAttribute("x-display")||Dwt.DISPLAY_BLOCK
}}}else{
var e=DwtCssStyle.getComputedStyleObject(t).display;
if(e!="none"){
t.setAttribute("x-display",e)
}
t.style.display=Dwt.DISPLAY_NONE
}};
Dwt.getVisibility=function(t){
var e=DwtCssStyle.getProperty(t,"visibility");
return(e=="visible")
};
Dwt.setVisibility=function(e,t){
e.style.visibility=t?"visible":"hidden"
};
Dwt.__MSIE_OPACITY_RE=/alpha\(opacity=(\d+)\)/;
Dwt.getOpacity=function(a){
if(AjxEnv.isIE){
var t=a.style.filter;
var e=Dwt.__MSIE_OPACITY_RE.exec(t)||[t,"100"];
return Number(e[1])
}
return Number(a.style.opacity||1)*100
};
Dwt.setOpacity=function(t,e){
if(AjxEnv.isIE){
t.style.filter="alpha(opacity="+e+")"
}else{
t.style.opacity=e/100
}};
Dwt.getZIndex=function(e){
return DwtCssStyle.getProperty(e,"z-index")
};
Dwt.setZIndex=function(t,e){
t.style.zIndex=e
};
Dwt.getDisplay=function(e){
DwtCssStyle.getProperty(e,"display")
};
Dwt.setDisplay=function(t,e){
t.style.display=e
};
Dwt.getWindowSize=function(e){
var t=(!e)?new DwtPoint(0,0):e;
if(window.innerWidth){
t.x=window.innerWidth;
t.y=window.innerHeight
}else{
if(AjxEnv.isIE6CSS){
t.x=document.body.parentElement.clientWidth;
t.y=document.body.parentElement.clientHeight
}else{
if(document.body&&document.body.clientWidth){
t.x=document.body.clientWidth;
t.y=document.body.clientHeight
}}}
return t
};
Dwt.toWindow=function(o,r,s,d,h,c){
var t;
if(!c){
t=new DwtPoint(r,s)
}else{
t=c;
t.set(r,s)
}
var e=o;
while(e&&e!=d){
t.x+=e.offsetLeft-e.scrollLeft;
t.y+=e.offsetTop;
if(!h){
var a=AjxEnv.isOpera?e.pageYOffset:e.scrollTop;
if(a){
t.y-=a
}
var n=e.parentNode;
while(n!=e.offsetParent&&n!=d){
a=AjxEnv.isOpera?n.pageYOffset:n.scrollTop;
if(a){
t.y-=a
}
n=n.parentNode
}}
e=e.offsetParent
}
return t
};
Dwt.getInsets=function(o){
var t=DwtCssStyle.getComputedStyleObject(o);
var a=parseInt(t.borderLeftWidth)||0;
var h=parseInt(t.borderTopWidth)||0;
var c=parseInt(t.borderRightWidth)||0;
var s=parseInt(t.borderBottomWidth)||0;
var n=parseInt(t.paddingLeft)||0;
var d=parseInt(t.paddingTop)||0;
var e=parseInt(t.paddingRight)||0;
var r=parseInt(t.paddingBottom)||0;
return{
left:a+n,top:h+d,right:c+e,bottom:s+r}
};
Dwt.insetBounds=function(t,e){
if(isNaN(t.x)||isNaN(e.left)){
return t
}
t.x+=e.left;
t.y+=e.top;
t.width-=e.left+e.right;
t.height-=e.top+e.bottom;
return t
};
Dwt.setStatus=function(e){
window.status=e
};
Dwt.getTitle=function(){
return window.document.title
};
Dwt.setTitle=function(e){
window.document.title=e
};
Dwt.getIframeDoc=function(e){
if(e){
return AjxEnv.isIE?e.contentWindow.document:e.contentDocument
}
return null
};
Dwt.getIframeWindow=function(e){
return e.contentWindow
};
Dwt.parseHtmlFragment=function(o,a){
if(!Dwt._div){
Dwt._div=document.createElement("div")
}
if(a){
o="<table style='table-layout:fixed'>"+o+"</table>"
}
Dwt._div.innerHTML=o;
if(a){
var e=document.createDocumentFragment();
var n=Dwt._div.firstChild.rows;
for(var t=n.length-1;
t>=0;
t--){
e.appendChild(n[0])
}
return e.childNodes.length>1?e:e.firstChild
}
return Dwt._div.firstChild
};
Dwt.contains=function(a,t){
var o=false;
if(a.compareDocumentPosition){
var e=a.compareDocumentPosition(t);
if((e==(document.DOCUMENT_POSITION_CONTAINED_BY|document.DOCUMENT_POSITION_FOLLOWING))){
o=true
}}else{
if(a.contains){
o=a.contains(t)
}}
return o
};
Dwt.removeChildren=function(e){
while(e.hasChildNodes()){
e.removeChild(e.firstChild)
}};
Dwt.getCellIndex=function(t){
if(AjxEnv.isOpera){
if(t.tagName&&t.tagName.toLowerCase()=="td"){
var a=t.parentNode.cells;
var e=a.length;
for(var o=0;
o<e;
o++){
if(a[o]==t){
return o
}}}}else{
return t.cellIndex
}
return -1
};
Dwt.delClass=function(a,e,o){
if(a==null){
return
}
if(typeof e=="string"){
e=Dwt._DELCLASS_CACHE[e]||(Dwt._DELCLASS_CACHE[e]=new RegExp("\\b"+e+"\\b","ig"))
}
var t=a.className||"";
t=t.replace(e," ");
a.className=o?t+" "+o:t
};
Dwt._DELCLASS_CACHE={};
Dwt.addClass=function(e,t){
Dwt.delClass(e,t,t)
};
Dwt.condClass=function(o,n,t,e){
if(!!n){
if(e){
Dwt.delClass(o,e)
}
Dwt.addClass(o,t)
}else{
Dwt.delClass(o,t);
if(e){
Dwt.addClass(o,e)
}}};
Dwt.setSelectionRange=function(a,o,e){
if(AjxEnv.isGeckoBased||AjxEnv.isSafari){
a.setSelectionRange(o,e)
}else{
if(AjxEnv.isIE){
var t=a.createTextRange();
t.collapse(true);
t.moveStart("character",o);
t.moveEnd("character",e-o);
t.select()
}else{
a.select()
}}};
Dwt.getSelectionStart=function(o){
if(AjxEnv.isGeckoBased){
return o.selectionStart
}else{
if(AjxEnv.isIE){
var a=document.selection.createRange();
var t=a.compareEndPoints("StartToEnd",a)==0;
if(!t){
a.collapse(true)
}
var e=a.getBookmark();
return e.charCodeAt(2)-2
}}
return o.value.length
};
Dwt.getSelectionEnd=function(o){
if(AjxEnv.isGeckoBased){
return o.selectionEnd
}else{
if(AjxEnv.isIE){
var a=document.selection.createRange();
var t=a.compareEndPoints("StartToEnd",a)==0;
if(!t){
a.collapse(false)
}
var e=a.getBookmark();
return e.charCodeAt(2)-2
}}
return o.value.length
};
Dwt.setSelectionText=function(t,n){
var s=Dwt.getSelectionStart(t);
var e=Dwt.getSelectionEnd(t);
var o=t.value;
var a=[o.substr(0,s),n,o.substr(e)].join("");
if(typeof t.setValue=="function"){
t.setValue(a)
}else{
t.value=a
}
Dwt.setSelectionRange(t,s,s+n.length)
};
Dwt.instanceOf=function(t,e){
if(typeof t=="string"){
return window[t]&&(t==e||window[t].prototype instanceof window[e])
}
return(window[e]&&t instanceof window[e])
};
Dwt.getParams=function(e,o){
if(!(e&&e.length)){
return
}
if(e.length>1||e[0]._eventMgr){
var a={};
for(var t=0;
t<e.length;
t++){
a[o[t]]=e[t]
}
return a
}else{
if(e.length==1){
return e[0]
}else{
return{}
}}};
Dwt.__checkPxVal=function(t,e){
if(t==Dwt.DEFAULT){
return false
}
if(e&&t<0&&t!=Dwt.LOC_NOWHERE){
t=0
}
if(typeof(t)=="number"){
t=t+"px"
}
return t
};
Dwt.byId=function(e){
return(typeof e=="string"?document.getElementById(e):e)
};
Dwt.byTag=function(e){
return document.getElementsByTagName(e)
};
Dwt.show=function(e){
Dwt.setVisible(Dwt.byId(e),true)
};
Dwt.hide=function(e){
Dwt.setVisible(Dwt.byId(e),false)
};
Dwt.toggle=function(t,e){
t=Dwt.byId(t);
if(e==null){
e=(Dwt.getVisible(t)!=true)
}
Dwt.setVisible(t,e)
};
Dwt.setText=function(e,t){
e.appendChild(document.createTextNode(t))
};
Dwt.populateText=function(){
if(arguments.length==0){
return
}
var a,e=0,t=arguments.length;
while(e<t){
a=document.getElementById(arguments[e]);
if(a){
Dwt.setText(a,arguments[e+1])
}
e+=2
}};
Dwt.setInnerHtml=function(t,e){
t.innerHTML=e
};
Dwt.setFavIcon=function(r){
if(AjxEnv.isIE){
return
}
var e=null;
if(Dwt._favIconId){
e=document.getElementById(Dwt._favIconId)
}else{
var h=document.getElementsByTagName("head")[0];
var t=h.getElementsByTagName("link");
for(var o=0;
o<t.length;
o++){
var s=t[o];
if(s.rel.toUpperCase()=="SHORTCUT ICON"){
if(!s.id){
s.id=Dwt._favIconId=Dwt.getNextId()
}
e=s;
break
}}}
if(e){
e.href=r;
var n=e.parentNode;
n.removeChild(e);
n.appendChild(e)
}else{
var a=document.createElement("link");
a.id=Dwt._favIconId=Dwt.getNextId();
a.rel="SHORTCUT ICON";
a.href=r;
h=h||document.getElementsByTagName("head")[0];
h.appendChild(a)
}}
}
if(AjxPackage.define("ajax.dwt.core.DwtException")){
DwtException=function(a,t,o,e){
if(arguments.length===0){
return
}
AjxException.call(this,a,t,o,e)
};
DwtException.prototype=new AjxException();
DwtException.prototype.constructor=DwtException;
DwtException.prototype.toString=function(){
return"DwtException"
};
DwtException.INVALIDPARENT=-1;
DwtException.INVALID_OP=-2;
DwtException.INTERNAL_ERROR=-3;
DwtException.INVALID_PARAM=-4
}
if(AjxPackage.define("ajax.dwt.graphics.DwtCssStyle")){
DwtCssStyle=function(){};
DwtCssStyle.HOVER="hover";
DwtCssStyle.ACTIVE="active";
DwtCssStyle.SELECTED="selected";
DwtCssStyle.DISABLED="disabled";
DwtCssStyle.FOCUSED="focused";
DwtCssStyle.ACTIONED="actioned";
DwtCssStyle.MATCHED="matched";
DwtCssStyle.DRAG_OVER="dragOver";
DwtCssStyle.DROPPABLE="droppable";
DwtCssStyle.NOT_DROPPABLE="notDroppable";
DwtCssStyle.DRAG_PROXY="dragProxy";
DwtCssStyle.LINUX="linux";
DwtCssStyle.getProperty=function(t,a){
var d;
if(t.ownerDocument==null){
for(var c=t.parentNode;
c.parentNode!=null;
c=c.parentNode){}
var h=c
}else{
var h=t.ownerDocument
}
if(h.defaultView&&!AjxEnv.isSafari){
var e=h.defaultView.getComputedStyle(t,"");
d=e.getPropertyValue(a)
}else{
var r=a.split("-");
var n="";
var o;
var s=r.length;
for(o=0;
o<s;
o++){
if(o!=0){
n+=r[o].substring(0,1).toUpperCase()
}else{
n+=r[o].substring(0,1)
}
n+=r[o].substring(1)
}
if(t.currentStyle){
d=t.currentStyle[n]
}else{
if(t.style){
d=t.style[n]
}}}
return d
};
DwtCssStyle.getComputedStyleObject=function(o){
if(o.ownerDocument==null){
for(var t=o.parentNode;
t.parentNode!=null;
t=t.parentNode){}
var a=t
}else{
var a=o.ownerDocument
}
if(a.defaultView){
var e=a.defaultView.getComputedStyle(o,null);
if(!e&&o.style){
o.style.display="";
e=a.defaultView.getComputedStyle(o,null)
}
return e||{}
}else{
if(o.currentStyle){
return o.currentStyle
}else{
if(o.style){
return o.style
}}}};
DwtCssStyle.removeProperty=function(t,a){
if(a instanceof Array){
for(var e=a.length;
--e>=0;
){
DwtCssStyle.removeProperty(t,a[e])
}}else{
if(AjxEnv.isIE){
t.style.removeAttribute(a,true)
}else{
a=a.replace(/([A-Z])/g,"-$1");
t.style.removeProperty(a)
}}}
}
if(AjxPackage.define("ajax.dwt.graphics.DwtPoint")){
DwtPoint=function(e,t){
this.x=e;
this.y=t
};
DwtPoint.tmp=new DwtPoint(0,0);
DwtPoint.prototype.toString=function(){
return"DwtPoint"
};
DwtPoint.prototype.set=function(e,t){
this.x=e;
this.y=t
}
}
if(AjxPackage.define("ajax.dwt.graphics.DwtRectangle")){
DwtRectangle=function(t,o,a,e){
this.x=t;
this.y=o;
this.width=a;
this.height=e
};
DwtRectangle.prototype.toString=function(){
return"DwtRectangle"
};
DwtRectangle.prototype.set=function(t,o,a,e){
this.x=t;
this.y=o
}
}
if(AjxPackage.define("ajax.dwt.graphics.DwtUnits")){
DwtUnits=function(){};
DwtUnits.PIXEL_UNIT="px";
DwtUnits.CM_UNIT="cm";
DwtUnits.MM_UNIT="mm";
DwtUnits.INCH_UNIT="in";
DwtUnits.PCT_UNIT="%";
DwtUnits.POINT="pt";
DwtUnits.WIDTH_EM=AjxEnv.isIE?9:11;
DwtUnits.WIDTH_SEP=AjxEnv.isIE?6:8;
DwtUnits.WIDTH_ELLIPSIS=15
}
if(AjxPackage.define("ajax.dwt.events.DwtEvent")){
DwtEvent=function(e){
if(arguments.length==0){
return
}
this.dwtObj=null
};
DwtEvent.prototype.toString=function(){
return"DwtEvent"
};
DwtEvent.ONCHANGE="onchange";
DwtEvent.ONCLICK="onclick";
DwtEvent.ONCONTEXTMENU="oncontextmenu";
DwtEvent.ONDBLCLICK="ondblclick";
DwtEvent.ONFOCUS="onfocus";
DwtEvent.ONBLUR="onblur";
DwtEvent.ONKEYDOWN="onkeydown";
DwtEvent.ONKEYPRESS="onkeypress";
DwtEvent.ONKEYUP="onkeyup";
DwtEvent.ONMOUSEDOWN="onmousedown";
DwtEvent.ONMOUSEENTER="onmouseenter";
DwtEvent.ONMOUSELEAVE="onmouseleave";
DwtEvent.ONMOUSEMOVE="onmousemove";
DwtEvent.ONMOUSEOUT="onmouseout";
DwtEvent.ONMOUSEOVER="onmouseover";
DwtEvent.ONMOUSEUP="onmouseup";
DwtEvent.ONMOUSEWHEEL="onmousewheel";
DwtEvent.ONSELECTSTART="onselectstart";
DwtEvent.ONSCROLL="onscroll";
DwtEvent.ACTION="ACTION";
DwtEvent.CONTROL="CONTROL";
DwtEvent.DATE_RANGE="DATE_RANGE";
DwtEvent.DISPOSE="DISPOSE";
DwtEvent.ENTER="ENTER";
DwtEvent.HOVEROVER="HOVEROVER";
DwtEvent.HOVEROUT="HOVEROUT";
DwtEvent.POPDOWN="POPDOWN";
DwtEvent.POPUP="POPUP";
DwtEvent.SELECTION="SELECTION";
DwtEvent.TREE="TREE";
DwtEvent.STATE_CHANGE="STATE_CHANGE";
DwtEvent.TAB="TAB";
DwtEvent.XFORMS_READY="xforms-ready";
DwtEvent.XFORMS_DISPLAY_UPDATED="xforms-display-updated";
DwtEvent.XFORMS_VALUE_CHANGED="xforms-value-changed";
DwtEvent.XFORMS_FORM_DIRTY_CHANGE="xforms-form-dirty-change";
DwtEvent.XFORMS_CHOICES_CHANGED="xforms-choices-changed";
DwtEvent.XFORMS_VALUE_ERROR="xforms-value-error";
DwtEvent.XFORMS_INSTANCE_CHANGED="xforms-instance-cahnged";
DwtEvent.KEY_EVENTS=[DwtEvent.ONKEYDOWN,DwtEvent.ONKEYPRESS,DwtEvent.ONKEYUP];
DwtEvent.MOUSE_EVENTS=[DwtEvent.ONCONTEXTMENU,DwtEvent.ONDBLCLICK,DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEMOVE,DwtEvent.ONMOUSEUP,DwtEvent.ONSELECTSTART,DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT]
}
if(AjxPackage.define("ajax.dwt.events.DwtEventManager")){
DwtEventManager=function(){};
DwtEventManager._instance=new AjxEventMgr();
DwtEventManager._domEventToDwtMap={
ondblclick:DwtEvent.ONDBLCLICK,onmousedown:DwtEvent.ONMOUSEDOWN,onmouseup:DwtEvent.ONMOUSEUP,onmousemove:DwtEvent.ONMOUSEMOVE,onmouseout:DwtEvent.ONMOUSEOUT,onmouseover:DwtEvent.ONMOUSEOVER,onselectstart:DwtEvent.ONSELECTSTART,onchange:DwtEvent.ONCHANGE};
DwtEventManager.addListener=function(e,t){
DwtEventManager._instance.addListener(e,t)
};
DwtEventManager.notifyListeners=function(e,t){
DwtEventManager._instance.notifyListeners(e,t)
};
DwtEventManager.removeListener=function(e,t){
DwtEventManager._instance.removeListener(e,t)
}
}
if(AjxPackage.define("ajax.dwt.events.DwtUiEvent")){
DwtUiEvent=function(e){
if(arguments.length==0){
return
}
DwtEvent.call(this,true);
this.reset()
};
DwtUiEvent.prototype=new DwtEvent;
DwtUiEvent.prototype.constructor=DwtUiEvent;
DwtUiEvent.prototype.toString=function(){
return"DwtUiEvent"
};
DwtUiEvent.prototype.reset=function(){
this.dwtObj=null;
this.altKey=false;
this.ctrlKey=false;
this.metaKey=false;
this.shiftKey=false;
this.target=null;
this.type=null;
this.docX=-1;
this.docY=-1;
this.elementX=-1;
this.elementY=-1;
this.ersatz=false;
this._stopPropagation=false;
this._returnValue=true;
this._dontCallPreventDefault=false
};
DwtUiEvent.getEvent=function(t,a){
t=t||window.event;
if(t){
return t
}
if(a){
var e=(a.ownerDocument||a.document||a).parentWindow;
return e?e.event:null
}};
DwtUiEvent.getTarget=function(e,t){
e=DwtUiEvent.getEvent(e);
if(!e){
return null
}
if(!t){
if(e.target){
return(e.target.nodeType==3)?e.target.parentNode:e.target
}else{
if(e.srcElement){
return e.srcElement
}}}else{
if(e.relatedTarget){
return e.relatedTarget
}else{
if(e.toElement){
return e.toElement
}else{
if(e.fromElement){
return e.fromElement
}}}}
return null
};
DwtUiEvent.getTargetWithProp=function(e,o,a){
var t=DwtUiEvent.getTarget(e,a);
while(t){
if(Dwt.getAttr(t,o)!=null){
return t
}
t=t.parentNode
}
return null
};
DwtUiEvent.getTargetWithProps=function(o,a){
var n=DwtUiEvent.getTarget(o);
while(n){
var t=true;
for(var e in a){
var s=Dwt.getAttr(n,a[e]);
if(s==null){
n=n.parentNode;
t=false;
break
}}
if(t){
return n
}}
return null
};
DwtUiEvent.copy=function(e,t){
e.altKey=t.altKey;
e.ctrlKey=t.ctrlKey;
e.metaKey=t.metaKey;
e.shiftKey=t.shiftKey;
e.target=t.target;
e.type=t.type;
e.dwtObj=t.dwtObj;
e.docX=t.docX;
e.docY=t.docY;
e.elementX=t.elementX;
e.elementY=t.elementY;
e.ersatz=t.ersatz;
e._stopPropagation=t._stopPropagation;
e._returnValue=t._returnValue
};
DwtUiEvent.prototype.setFromDhtmlEvent=function(t,a){
t=DwtUiEvent.getEvent(t);
if(!t){
return
}
this.altKey=t.altKey;
this.ctrlKey=t.ctrlKey;
this.metaKey=t.metaKey;
this.shiftKey=t.shiftKey;
this.type=t.type;
this.target=DwtUiEvent.getTarget(t);
this.dwtObj=(a===true)?DwtControl.getTargetControl(t):a;
if(t.pageX!=null){
this.docX=t.pageX;
this.docY=t.pageY
}else{
if(t.clientX!=null){
this.docX=t.clientX+document.body.scrollLeft-document.body.clientLeft;
this.docY=t.clientY+document.body.scrollTop-document.body.clientTop;
if(document.body.parentElement){
var e=document.body.parentElement;
this.docX+=e.scrollLeft-e.clientLeft;
this.docY+=e.scrollTop-e.clientTop
}}}
if(t.offsetX!=null){
this.elementX=t.offsetX;
this.elementY=t.offsetY
}else{
if(t.layerX!=null){
this.elementX=t.layerX;
this.elementY=t.layerY
}else{
this.elementX=Dwt.DEFAULT;
this.elementY=Dwt.DEFAULT
}}
this.ersatz=false;
return t
};
DwtUiEvent.prototype.setToDhtmlEvent=function(e){
DwtUiEvent.setBehaviour(e,this._stopPropagation,this._returnValue,this._dontCallPreventDefault)
};
DwtUiEvent.setBehaviour=function(n,e,t,a){
var o=DwtUiEvent.getEvent(n);
DwtUiEvent.setDhtmlBehaviour(o,e,t,a)
};
DwtUiEvent.setDhtmlBehaviour=function(o,e,t,a){
o=o||window.event;
if(o.stopPropagation!=null){
if(e){
o.stopPropagation()
}
if(!t&&!a){
o.preventDefault()
}}else{
o.returnValue=t;
o.cancelBubble=e
}};
DwtUiEvent.getDwtObjFromEvent=function(e,a){
var t=DwtUiEvent.getTargetWithProp(e,"dwtObj",a);
return t?Dwt.getObjectFromElement(t):null
};
DwtUiEvent.getDwtObjWithProp=function(e,a){
var t=DwtUiEvent.getTargetWithProps(e,["dwtObj",a]);
return t?Dwt.getObjectFromElement(t):null
}
}
if(AjxPackage.define("ajax.dwt.events.DwtDisposeEvent")){
DwtDisposeEvent=function(e){
if(arguments.length==0){
return
}
DwtEvent.call(this,true)
};
DwtDisposeEvent.prototype=new DwtEvent;
DwtDisposeEvent.prototype.constructor=DwtDisposeEvent;
DwtDisposeEvent.prototype.toString=function(){
return"DwtDisposeEvent"
}
}
if(AjxPackage.define("ajax.dwt.events.DwtControlEvent")){
DwtControlEvent=function(){
this.reset()
};
DwtControlEvent.prototype=new DwtEvent;
DwtControlEvent.prototype.constructor=DwtControlEvent;
DwtControlEvent.RESIZE=1;
DwtControlEvent.MOVE=2;
DwtControlEvent.prototype.toString=function(){
return"DwtControlEvent"
};
DwtControlEvent.prototype.reset=function(e){
this.oldX=Dwt.DEFAULT;
this.oldY=Dwt.DEFAULT;
this.oldWidth=Dwt.DEFAULT;
this.oldHeight=Dwt.DEFAULT;
this.newX=Dwt.DEFAULT;
this.newY=Dwt.DEFAULT;
this.newWidth=Dwt.DEFAULT;
this.newHeight=Dwt.DEFAULT;
this.type=e||null
}
}
if(AjxPackage.define("ajax.dwt.events.DwtFocusEvent")){
DwtFocusEvent=function(e){
if(arguments.length==0){
return
}
DwtEvent.call(this,true);
this.reset()
};
DwtFocusEvent.prototype=new DwtEvent;
DwtFocusEvent.prototype.constructor=DwtFocusEvent;
DwtFocusEvent.FOCUS=1;
DwtFocusEvent.BLUR=2;
DwtFocusEvent.prototype.toString=function(){
return"DwtFocusEvent"
};
DwtFocusEvent.prototype.reset=function(){
this.dwtObj=null;
this.state=DwtFocusEvent.FOCUS
}
}
if(AjxPackage.define("ajax.dwt.events.DwtKeyEvent")){
DwtKeyEvent=function(){
DwtUiEvent.call(this,true);
this.reset(true)
};
DwtKeyEvent.KEY_END_OF_TEXT=3;
DwtKeyEvent.KEY_TAB=9;
DwtKeyEvent.KEY_RETURN=13;
DwtKeyEvent.KEY_ENTER=13;
DwtKeyEvent.KEY_ESCAPE=27;
DwtKeyEvent.MAC_FF_CODE={};
DwtKeyEvent.MAC_FF_CODE["~"]=192;
DwtKeyEvent.MAC_FF_CODE["!"]=49;
DwtKeyEvent.MAC_FF_CODE["@"]=50;
DwtKeyEvent.MAC_FF_CODE["#"]=51;
DwtKeyEvent.MAC_FF_CODE["$"]=52;
DwtKeyEvent.MAC_FF_CODE["%"]=53;
DwtKeyEvent.MAC_FF_CODE["^"]=54;
DwtKeyEvent.MAC_FF_CODE["&"]=55;
DwtKeyEvent.MAC_FF_CODE["*"]=56;
DwtKeyEvent.MAC_FF_CODE["("]=57;
DwtKeyEvent.MAC_FF_CODE[")"]=48;
DwtKeyEvent.MAC_FF_CODE["-"]=189;
DwtKeyEvent.MAC_FF_CODE._=189;
DwtKeyEvent.MAC_FF_CODE["+"]=187;
DwtKeyEvent.MAC_FF_CODE["|"]=220;
DwtKeyEvent.MAC_FF_CODE[":"]=186;
DwtKeyEvent.MAC_FF_CODE["<"]=188;
DwtKeyEvent.MAC_FF_CODE[">"]=190;
DwtKeyEvent.MAC_FF_CODE["?"]=191;
DwtKeyEvent.prototype=new DwtUiEvent;
DwtKeyEvent.prototype.constructor=DwtKeyEvent;
DwtKeyEvent.prototype.toString=function(){
return"DwtKeyEvent"
};
DwtKeyEvent.isKeyEvent=function(e){
return(e.type.search(/^key/i)!=-1)
};
DwtKeyEvent.isKeyPressEvent=function(e){
return(AjxEnv.isIE&&e.type=="keydown")||(e.type=="keypress")
};
DwtKeyEvent.prototype.reset=function(e){
if(!e){
DwtUiEvent.prototype.reset.call(this)
}
this.keyCode=0;
this.charCode=0
};
DwtKeyEvent.prototype.isCommand=function(e){
return AjxEnv.isMac&&this.metaKey||this.ctrlKey
};
DwtKeyEvent.prototype.setFromDhtmlEvent=function(e,t){
e=DwtUiEvent.prototype.setFromDhtmlEvent.apply(this,arguments);
this.charCode=e.charCode||e.keyCode;
this.keyCode=e.keyCode
};
DwtKeyEvent.getCharCode=function(t){
t=DwtUiEvent.getEvent(t);
var e=AjxEnv.isSafari?t.keyCode:(t.charCode||t.keyCode);
if(e==0&&AjxEnv.isMac&&AjxEnv.isGeckoBased&&t.type=="keyup"&&DwtKeyEvent._geckoCode){
e=DwtKeyEvent._geckoCode
}
return e
};
DwtKeyEvent.copy=function(e,t){
DwtUiEvent.copy(e,t);
e.charCode=t.charCode;
e.keyCode=t.keyCode
};
DwtKeyEvent.geckoCheck=function(t){
t=DwtUiEvent.getEvent(t);
if(t.type=="keypress"){
DwtKeyEvent._geckoCode=null;
if(AjxEnv.isMac&&AjxEnv.isGeckoBased){
var e=String.fromCharCode(t.charCode);
DwtKeyEvent._geckoCode=DwtKeyEvent.MAC_FF_CODE[e]
}}}
}
if(AjxPackage.define("ajax.dwt.events.DwtMouseEvent")){
DwtMouseEvent=function(){
DwtUiEvent.call(this,true);
this.reset(true)
};
DwtMouseEvent.prototype=new DwtUiEvent;
DwtMouseEvent.prototype.constructor=DwtMouseEvent;
DwtMouseEvent.prototype.toString=function(){
return"DwtMouseEvent"
};
DwtMouseEvent.NONE=0;
DwtMouseEvent.LEFT=1;
DwtMouseEvent.MIDDLE=2;
DwtMouseEvent.RIGHT=3;
DwtMouseEvent.prototype.reset=function(e){
if(!e){
DwtUiEvent.prototype.reset.call(this)
}
this.button=0;
this._populated=false
};
DwtMouseEvent.prototype.setFromDhtmlEvent=function(e,t){
e=DwtUiEvent.prototype.setFromDhtmlEvent.apply(this,arguments);
if(e.which){
switch(e.which){
case 1:this.button=DwtMouseEvent.LEFT;
break;
case 2:this.button=DwtMouseEvent.MIDDLE;
break;
case 3:this.button=DwtMouseEvent.RIGHT;
break;
default:this.button=DwtMouseEvent.NONE
}}else{
if(e.button){
if((e.button&1)!=0){
this.button=DwtMouseEvent.LEFT
}else{
if((e.button&2)!=0){
this.button=DwtMouseEvent.RIGHT
}else{
if((e.button&4)!=0){
this.button=DwtMouseEvent.MIDDLE
}else{
this.button=DwtMouseEvent.NONE
}}}}}
if(AjxEnv.isMac&&this.button){
if(this.ctrlKey&&(this.button==DwtMouseEvent.LEFT||this.button==DwtMouseEvent.RIGHT)){
this.button=DwtMouseEvent.RIGHT;
this.ctrlKey=false
}
if(this.altKey){
this.ctrlKey=true;
this.altKey=false
}}}
}
if(AjxPackage.define("ajax.dwt.events.DwtMouseEventCapture")){
DwtMouseEventCapture=function(e){
e=Dwt.getParams(arguments,DwtMouseEventCapture.PARAMS);
this.targetObj=e.targetObj;
this._id=e.id;
this._mouseOverHdlr=e.mouseOverHdlr||DwtMouseEventCapture.emptyHdlr;
this._mouseDownHdlr=e.mouseDownHdlr||DwtMouseEventCapture.emptyHdlr;
this._mouseMoveHdlr=e.mouseMoveHdlr||DwtMouseEventCapture.emptyHdlr;
this._mouseUpHdlr=e.mouseUpHdlr||DwtMouseEventCapture.emptyHdlr;
this._mouseOutHdlr=e.mouseOutHdlr||DwtMouseEventCapture.emptyHdlr;
this._mouseWheelHdlr=e.mouseWheelHdlr||DwtMouseEventCapture.emptyHdlr;
this._hardCapture=(e.hardCapture!==false)
};
DwtMouseEventCapture.PARAMS=["targetObj","id","mouseOverHdlr","mouseDownHdlr","mouseMoveHdlr","mouseUpHdlr","mouseOutHdlr","mouseWheelHdlr","hardCapture"];
DwtMouseEventCapture._capturing=false;
DwtMouseEventCapture.getCaptureObj=function(){
return window._mouseEventCaptureObj
};
DwtMouseEventCapture.getTargetObj=function(){
return window._mouseEventCaptureObj?window._mouseEventCaptureObj.targetObj:null
};
DwtMouseEventCapture.getId=function(){
return window._mouseEventCaptureObj?window._mouseEventCaptureObj._id:null
};
DwtMouseEventCapture.prototype.toString=function(){
return"DwtMouseEventCapture"
};
DwtMouseEventCapture.prototype.capturing=function(){
return DwtMouseEventCapture._capturing
};
DwtMouseEventCapture.prototype.capture=function(){
if(window._mouseEventCaptureObj){
window._mouseEventCaptureObj.release()
}
if(document.body!=null&&document.body.addEventListener!=null){
document.body.addEventListener("mouseover",this._mouseOverHdlr,true);
document.body.addEventListener("mousedown",this._mouseDownHdlr,true);
document.body.addEventListener("mousemove",this._mouseMoveHdlr,true);
document.body.addEventListener("mouseup",this._mouseUpHdlr,true);
document.body.addEventListener("mouseout",this._mouseOutHdlr,true);
document.body.addEventListener("DOMMouseScroll",this._mouseWheelHdlr,true)
}else{
this._savedMouseOverHdlr=document.onmouseover;
this._savedMouseDownHdlr=document.onmousedown;
this._savedMouseMoveHdlr=document.onmousemove;
this._savedMouseUpHdlr=document.onmouseup;
this._savedMouseOutHdlr=document.onmouseout;
this._savedMouseWheelHdlr=document.onmousewheel;
document.onmouseover=this._mouseOverHdlr;
document.onmousedown=this._mouseDownHdlr;
document.onmousemove=this._mouseMoveHdlr;
document.onmouseup=this._mouseUpHdlr;
document.onmouseout=this._mouseOutHdlr;
document.onmousewheel=this._mouseWheelHdlr
}
if(this._hardCapture&&document.body&&document.body.setCapture){
document.body.setCapture()
}
window._mouseEventCaptureObj=this;
DwtMouseEventCapture._capturing=true
};
DwtMouseEventCapture.prototype.release=function(){
if(window._mouseEventCaptureObj==null){
return
}
var e=window._shellCaptureObj;
if(document.body&&document.body.addEventListener){
document.body.removeEventListener("mouseover",this._mouseOverHdlr,true);
document.body.removeEventListener("mousedown",this._mouseDownHdlr,true);
document.body.removeEventListener("mousemove",this._mouseMoveHdlr,true);
document.body.removeEventListener("mouseup",this._mouseUpHdlr,true);
document.body.removeEventListener("mouseout",this._mouseOutHdlr,true);
document.body.removeEventListener("DOMMouseScroll",this._mouseWheelHdlr,true)
}else{
document.onmouseover=this._savedMouseOverHdlr;
document.onmousedown=this._savedMouseDownHdlr;
document.onmousemove=this._savedMouseMoveHdlr;
document.onmouseup=this._savedMouseUpHdlr;

document.onmouseout=this._savedMouseOutHdlr;
document.onmousewheel=this._savedMouseWheelHdlr
}
if(this._hardCapture&&document.body&&document.body.releaseCapture){
document.body.releaseCapture()
}
window._mouseEventCaptureObj=null;
DwtMouseEventCapture._capturing=false
};
DwtMouseEventCapture.emptyHdlr=function(t){
var a=DwtMouseEventCapture.getCaptureObj();
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
if(a._hardCapture){
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
}else{
e._stopPropagation=false;
e._returnValue=true;
e.setToDhtmlEvent(t);
return true
}}
}
if(AjxPackage.define("ajax.dwt.events.DwtListViewActionEvent")){
DwtListViewActionEvent=function(){
DwtMouseEvent.call(this);
this.reset(true)
};
DwtListViewActionEvent.prototype=new DwtMouseEvent;
DwtListViewActionEvent.prototype.constructor=DwtListViewActionEvent;
DwtListViewActionEvent.prototype.toString=function(){
return"DwtListViewActionEvent"
};
DwtListViewActionEvent.prototype.reset=function(e){
if(!e){
DwtMouseEvent.prototype.reset.call(this)
}
this.field=null;
this.item=null;
this.detail=null
}
}
if(AjxPackage.define("ajax.dwt.events.DwtSelectionEvent")){
DwtSelectionEvent=function(e){
if(arguments.length==0){
return
}
DwtUiEvent.call(this,true);
this.reset(true)
};
DwtSelectionEvent.prototype=new DwtUiEvent;
DwtSelectionEvent.prototype.constructor=DwtSelectionEvent;
DwtSelectionEvent.prototype.toString=function(){
return"DwtSelectionEvent"
};
DwtSelectionEvent.prototype.reset=function(e){
if(!e){
DwtUiEvent.prototype.reset.call(this)
}
this.button=0;
this.detail=null;
this.item=null
}
}
if(AjxPackage.define("ajax.dwt.events.DwtHtmlEditorStateEvent")){
DwtHtmlEditorStateEvent=function(e){
if(arguments.length==0){
return
}
DwtEvent.call(this,true);
this.reset()
};
DwtHtmlEditorStateEvent.prototype=new DwtEvent;
DwtHtmlEditorStateEvent.prototype.constructor=DwtHtmlEditorStateEvent;
DwtHtmlEditorStateEvent.prototype.toString=function(){
return"DwtHtmlEditorStateEvent"
};
DwtHtmlEditorStateEvent.prototype.reset=function(){
this.isBold=null;
this.isItalic=null;
this.isUnderline=null;
this.isStrikeThru=null;
this.isSuperscript=null;
this.isSubscript=null;
this.isOrderedList=null;
this.isNumberedList=null;
this.fontName=null;
this.fontSize=null;
this.style=null;
this.backgroundColor=null;
this.color=null;
this.justification=null;
this.direction=null
}
}
if(AjxPackage.define("ajax.dwt.events.DwtTreeEvent")){
DwtTreeEvent=function(){
DwtSelectionEvent.call(this,true)
};
DwtTreeEvent.prototype=new DwtSelectionEvent;
DwtTreeEvent.prototype.constructor=DwtTreeEvent;
DwtTreeEvent.prototype.toString=function(){
return"DwtTreeEvent"
};
DwtTreeEvent.prototype.setFromDhtmlEvent=function(e,t){
e=DwtSelectionEvent.prototype.setFromDhtmlEvent.apply(this,arguments)
}
}
if(AjxPackage.define("ajax.dwt.events.DwtHoverEvent")){
DwtHoverEvent=function(o,a,t,e,n){
if(arguments.length==0){
return
}
DwtEvent.call(this,true);
this.type=o;
this.delay=a;
this.object=t;
this.x=e||-1;
this.y=n||-1
};
DwtHoverEvent.prototype=new DwtEvent;
DwtHoverEvent.prototype.constructor=DwtHoverEvent;
DwtHoverEvent.prototype.reset=function(){
this.type=0;
this.delay=0;
this.object=null;
this.x=-1;
this.y=-1
}
}
if(AjxPackage.define("ajax.dwt.keyboard.DwtTabGroupEvent")){
DwtTabGroupEvent=function(){
this.tabGroup=null;
this.newFocusMember=null
};
DwtTabGroupEvent.prototype.toString=function(){
return"DwtTabGroupEvent"
};
DwtTabGroupEvent.prototype.reset=function(){
this.tabGroup=null;
this.newFocusMember=null
}
}
if(AjxPackage.define("ajax.dwt.keyboard.DwtKeyMap")){
DwtKeyMap=function(e){
if(e){
return
}
this._map={};
this._args={};
this._checkedMap={};
this._repeat={};
this._load(this._map,AjxKeys);
DwtKeyMap.MOD_ORDER[DwtKeyMap.ALT]=1;
DwtKeyMap.MOD_ORDER[DwtKeyMap.CTRL]=2;
DwtKeyMap.MOD_ORDER[DwtKeyMap.META]=3;
DwtKeyMap.MOD_ORDER[DwtKeyMap.SHIFT]=4
};
DwtKeyMap.deserialize=function(e){
alert("DwtKeyMap.deserialize: NOT IMPLEMENTED")
};
DwtKeyMap.serialize=function(e){
alert("DwtKeyMap.serialize: NOT IMPLEMENTED")
};
DwtKeyMap.MAP_NAME={};
DwtKeyMap.MAP_NAME.dialog="DwtDialog";
DwtKeyMap.MAP_NAME.button="DwtButton";
DwtKeyMap.MAP_NAME.list="DwtListView";
DwtKeyMap.MAP_NAME.menu="DwtMenu";
DwtKeyMap.MAP_NAME.editor="DwtHtmlEditor";
DwtKeyMap.MAP_NAME.toolbar="DwtToolBar";
DwtKeyMap.MAP_NAME.toolbarHorizontal="DwtToolBar-horiz";
DwtKeyMap.MAP_NAME.toolbarVertical="DwtToolBar-vert";
DwtKeyMap.MAP_NAME.tabView="DwtTabView";
DwtKeyMap.MAP_NAME.tree="DwtTreeItem";
DwtKeyMap.MAP_NAME_R={};
(function(){
for(var e in DwtKeyMap.MAP_NAME){
DwtKeyMap.MAP_NAME_R[DwtKeyMap.MAP_NAME[e]]=e
}}
)();
DwtKeyMap.IS_MODIFIER={};
DwtKeyMap.MOD_ORDER={};
DwtKeyMap.ARROW_DOWN="ArrowDown";
DwtKeyMap.ARROW_LEFT="ArrowLeft";
DwtKeyMap.ARROW_RIGHT="ArrowRight";
DwtKeyMap.ARROW_UP="ArrowUp";
DwtKeyMap.BACKSLASH="Backslash";
DwtKeyMap.BACKSPACE="Backspace";
DwtKeyMap.COMMA="Comma";
DwtKeyMap.SEMICOLON="Semicolon";
DwtKeyMap.DELETE="Del";
DwtKeyMap.END="End";
DwtKeyMap.ENTER="Enter";
DwtKeyMap.ESC="Esc";
DwtKeyMap.HOME="Home";
DwtKeyMap.PAGE_DOWN="PgDown";
DwtKeyMap.PAGE_UP="PgUp";
DwtKeyMap.SPACE="Space";
DwtKeyMap.TAB="Tab";
DwtKeyMap.ACTION="ContextMenu";
DwtKeyMap.SELECT_CURRENT="SelectCurrent";
DwtKeyMap.ADD_SELECT_NEXT="AddNext";
DwtKeyMap.ADD_SELECT_PREV="AddPrevious";
DwtKeyMap.CANCEL="Cancel";
DwtKeyMap.COLLAPSE="Collapse";
DwtKeyMap.DBLCLICK="DoubleClick";
DwtKeyMap.EXPAND="Expand";
DwtKeyMap.GOTO_TAB="GoToTab";
DwtKeyMap.HEADER1="Header1";
DwtKeyMap.HEADER2="Header2";
DwtKeyMap.HEADER3="Header3";
DwtKeyMap.HEADER4="Header4";
DwtKeyMap.HEADER5="Header5";
DwtKeyMap.HEADER6="Header6";
DwtKeyMap.JUSTIFY_CENTER="CenterJustify";
DwtKeyMap.JUSTIFY_LEFT="LeftJustify";
DwtKeyMap.JUSTIFY_RIGHT="RightJustify";
DwtKeyMap.NEXT="Next";
DwtKeyMap.NEXT_TAB="NextTab";
DwtKeyMap.NO="No";
DwtKeyMap.PARENTMENU="ParentMenu";
DwtKeyMap.PREV="Previous";
DwtKeyMap.PREV_TAB="PreviousTab";
DwtKeyMap.SELECT_ALL="SelectAll";
DwtKeyMap.SELECT="Select";
DwtKeyMap.SELECT_FIRST="SelectFirst";
DwtKeyMap.SELECT_LAST="SelectLast";
DwtKeyMap.SELECT_NEXT="SelectNext";
DwtKeyMap.SELECT_PREV="SelectPrevious";
DwtKeyMap.SUBMENU="SubMenu";
DwtKeyMap.SWITCH_MODE="SwitchMode";
DwtKeyMap.TEXT_BOLD="Bold";
DwtKeyMap.TEXT_ITALIC="Italic";
DwtKeyMap.TEXT_UNDERLINE="Underline";
DwtKeyMap.TEXT_STRIKETHRU="Strikethru";
DwtKeyMap.YES="Yes";
DwtKeyMap.GOTO_TAB_RE=new RegExp(DwtKeyMap.GOTO_TAB+"(\\d+)");
DwtKeyMap.JOIN="+";
DwtKeyMap.SEP=",";
DwtKeyMap.INHERIT="INHERIT";
DwtKeyMap.prototype.getMap=function(){
return this._map
};
DwtKeyMap.prototype._load=function(q,d,g){
g=g||{};
var w=AjxEnv.platform.toLowerCase();
for(var c in d){
var f=c.split(".");
var h=f[f.length-1];
if(h=="win"||h=="mac"||h=="linux"){
if(h==w){
var k=f.slice(0,f.length-1).join(".");
d[k]=d[c]
}
d[c]=null
}}
for(var c in d){
var s=AjxStringUtil.trim(d[c]);
if(!s||(typeof d[c]!="string")){
continue
}
var f=c.split(".");
var e=f[f.length-1];
var a=(f.length==2);
var y=a?null:f[1];
if(f[0]=="keys"){
this._processKeyDef(y,e,s);
continue
}
if(e!=DwtKeyMap.INHERIT&&e!="keycode"){
continue
}
var m=DwtKeyMap.MAP_NAME[f[0]]||g[f[0]];
if((this._checkedMap[m]===false)||(!this._checkedMap[m]&&!this._checkMap(m))){
continue
}
if(!q[m]){
q[m]={}
}
if(!this._checkAction(m,y)){
continue
}
var o=s.split(/\s*;\s*/);
for(var v=0;
v<o.length;
v++){
var j=this._canonicalize(o[v]);
if(e==DwtKeyMap.INHERIT){
var x=j.split(/\s*,\s*/);
var t=[];
for(var u=0;
u<x.length;
u++){
t[u]=DwtKeyMap.MAP_NAME[x[u]]||g[x[u]]
}
q[m][f[1]]=t.join(",")
}else{
if(e=="keycode"){
q[m][j]=y
}}}
var n=[f[0],y,"repeat"].join(".");
var r=d[n];
if(r&&r.toLowerCase()!="false"){
if(!this._repeat[m]){
this._repeat[m]={}
}
this._repeat[m][y]=true
}}};
DwtKeyMap.prototype._checkMap=function(t){
var e=true;
this._checkedMap[t]=e;
return e
};
DwtKeyMap.prototype._checkAction=function(e,t){
return true
};
DwtKeyMap.prototype._processKeyDef=function(e,a,t){
if(!e||!a||!t){
return
}
if(a=="display"){
DwtKeyMap[e.toUpperCase()]=t
}else{
if(a=="keycode"){
DwtKeyMap.IS_MODIFIER[t]=true
}}};
DwtKeyMap.prototype._canonicalize=function(r){
var n=r.split(DwtKeyMap.SEP);
var e=[];
for(var a=0;
a<n.length;
a++){
var t=n[a];
var s=t.split(DwtKeyMap.JOIN);
if(s.length>2){
var o=s.slice(0,s.length-1);
o.sort(function(u,c){
var d=DwtKeyMap.MOD_ORDER[u]||0;
var h=DwtKeyMap.MOD_ORDER[c]||0;
return Number(d-h)
}
);
o.push(s[s.length-1]);
e.push(o.join(DwtKeyMap.JOIN))
}else{
e.push(t)
}}
return e.join(",")
}
}
if(AjxPackage.define("ajax.dwt.keyboard.DwtKeyMapMgr")){
DwtKeyMapMgr=function(a){
var t=this._map=a.getMap();
this._repeat=a._repeat;
this._args=a._args;
this._fsas={};
for(var e in t){
this._fsas[e]=DwtKeyMapMgr.__buildFSA({}
,t[e],e)
}};
DwtKeyMapMgr.NOT_A_TERMINAL=-999;
DwtKeyMapMgr.TAB_KEYCODE=9;
DwtKeyMapMgr.prototype.toString=function(){
return"DwtKeyMapMgr"
};
DwtKeyMapMgr.prototype.getActionCode=function(a,r,h){
var e=this._fsas[r];
if(!e){
return null
}
var s=a.length;
var d=e;
var c;
for(var t=0;
t<s&&d;
t++){
c=a[t];
if(!d||!d[c]){
break
}
if(t<s-1){
d=d[c].subMap
}}
if(d&&d[c]){
var n=d[c];
if(!n.subMap||h){
var o=this.__getInheritedActionCode(a,e,h);
return o==DwtKeyMapMgr.NOT_A_TERMINAL?DwtKeyMapMgr.NOT_A_TERMINAL:(n.actionCode||o)
}else{
return DwtKeyMapMgr.NOT_A_TERMINAL
}}else{
return this.__getInheritedActionCode(a,e,h)
}};
DwtKeyMapMgr.prototype.getAction=function(t,e){
return this._map[t][e]
};
DwtKeyMapMgr.prototype.getKeySequences=function(t,a){
var e=[];
for(var o in this._map[t]){
if(this._map[t][o]==a){
e.push(o)
}}
return e
};
DwtKeyMapMgr.prototype.setMapping=function(t,e,a){
this._map[t][e]=a
};
DwtKeyMapMgr.prototype.removeMapping=function(t,e){
delete this._map[t][e]
};
DwtKeyMapMgr.prototype.replaceMapping=function(a,e,t){
var o=this._map[a][e];
if(!o){
return
}
this.removeMapping(a,e);
this.setMapping(a,t,o)
};
DwtKeyMapMgr.prototype.setArg=function(t,a,e){
if(!this._args[t]){
this._args[t]={}
}
this._args[t][a]=e
};
DwtKeyMapMgr.prototype.removeArg=function(e,t){
delete this._args[e][t]
};
DwtKeyMapMgr.prototype.getArg=function(e,t){
return this._args[e]?this._args[e][t]:null
};
DwtKeyMapMgr.prototype.reloadMap=function(e){
this._fsas[e]=DwtKeyMapMgr.__buildFSA({}
,this._map[e],e)
};
DwtKeyMapMgr.prototype.getAncestors=function(o,n){
n=n||[];
var e=this._fsas[o];
var t=e&&e.inherit;
if(t&&t.length){
for(var a=0;
a<t.length;
a++){
n.push(t[a]);
n=this.getAncestors(t[a],n)
}}
return n
};
DwtKeyMapMgr.isInputElement=function(a){
if(!a){
return false
}
var t=a.ownerDocument?a.ownerDocument.designMode:null;
if(t&&(t.toLowerCase()=="on")){
return true
}
var e=a.tagName.toUpperCase();
return(e=="INPUT"||e=="TEXTAREA")
};
DwtKeyMapMgr.prototype.repeats=function(t,e){
return this._repeat[t]&&this._repeat[t][e]
};
DwtKeyMapMgr.__buildFSA=function(c,e,n){
for(var a in e){
if(a==DwtKeyMap.INHERIT){
c.inherit=e[a].split(/\s*,\s*/);
continue
}
var o=a.split(DwtKeyMap.SEP);
var s=o.length;
var h=c;
for(var t=0;
t<s;
t++){
var r=o[t];
if(!h[r]){
h[r]={}
}
if(t==s-1){
h[r].actionCode=e[a]
}else{
if(!h[r].subMap){
h[r].subMap={}
}
h=h[r].subMap
}}}
return c
};
DwtKeyMapMgr.prototype.__getInheritedActionCode=function(s,t,n){
if(t.inherit&&t.inherit.length){
var o=null;
var e=t.inherit.length;
for(var a=0;
a<e;
a++){
o=this.getActionCode(s,t.inherit[a],n);
if(o!=null){
return o
}}}
return null
};
DwtKeyMapMgr.hasModifier=function(e){
return(e.altKey||e.ctrlKey||e.metaKey)
}
}
if(AjxPackage.define("ajax.dwt.keyboard.DwtKeyboardMgr")){
DwtKeyboardMgr=function(e){
DwtKeyboardMgr.__shell=e;
this.__tabGrpStack=[];
this.__defaultHandlerStack=[];
this.__tabGroupChangeListenerObj=new AjxListener(this,this.__tabGrpChangeListener);
this.__kbEventStatus=DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED;
this.__keyTimeout=750;
this.__currTabGroup=null;
this.__currDefaultHandler=null
};
DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED=1;
DwtKeyboardMgr.__KEYSEQ_HANDLED=2;
DwtKeyboardMgr.__KEYSEQ_PENDING=3;
DwtKeyboardMgr.__KEYSEQ_REPEAT=4;
DwtKeyboardMgr.FOCUS_FIELD_ID="kbff";
DwtKeyboardMgr.isPossibleInputShortcut=function(e){
var t=DwtUiEvent.getTarget(e);
return(!DwtKeyMap.IS_MODIFIER[e.keyCode]&&(e.keyCode==27||DwtKeyMapMgr.hasModifier(e))||(t&&t.nodeName.toUpperCase()=="INPUT"&&(e.keyCode==13||e.keyCode==3)))
};
DwtKeyboardMgr.prototype.toString=function(){
return"DwtKeyboardMgr"
};
DwtKeyboardMgr.prototype.pushTabGroup=function(t){
if(!this.__keyboardHandlingInited||!t){
return
}
this.__tabGrpStack.push(t);
this.__currTabGroup=t;
var e=t.getFocusMember();
if(!e){
e=t.resetFocusMember(true)
}
if(!e){
return
}
t.addFocusChangeListener(this.__tabGroupChangeListenerObj);
this.grabFocus(e)
};
DwtKeyboardMgr.prototype.popTabGroup=function(r){
if(!this.__keyboardHandlingInited){
return
}
if(!r){
return
}
if(this.__tabGrpStack.length<=1){
return null
}
if(r&&this.__tabGrpStack[this.__tabGrpStack.length-1]!=r){
var t=this.__tabGrpStack;
var e=t.length;
for(var s=e-1;
s>=0;
s--){
if(r==t[s]){
t[s].dump();
break
}}
if(s<0){
return null
}else{
if(s!=e-1){
t.splice(s,1);
return r
}}}
var r=this.__tabGrpStack.pop();
r.removeFocusChangeListener(this.__tabGroupChangeListenerObj);
var n=null;
if(this.__tabGrpStack.length>0){
n=this.__tabGrpStack[this.__tabGrpStack.length-1];
var o=n.getFocusMember();
if(!o){
o=n.resetFocusMember(true)
}
if(o){
this.grabFocus(o)
}}
this.__currTabGroup=n;
return r
};
DwtKeyboardMgr.prototype.setTabGroup=function(t){
if(!this.__enabled||!this.__keyboardHandlingInited){
return
}
var e=this.popTabGroup();
this.pushTabGroup(t);
return e
};
DwtKeyboardMgr.prototype.pushDefaultHandler=function(e){
if(!this.__enabled||!this.__keyboardHandlingInited||!e){
return
}
this.__defaultHandlerStack.push(e);
this.__currDefaultHandler=e
};
DwtKeyboardMgr.prototype.popDefaultHandler=function(){
if(!this.__keyboardHandlingInited||(this.__defaultHandlerStack.length<=1)){
return
}
var e=this.__defaultHandlerStack.pop();
this.__currDefaultHandler=this.__defaultHandlerStack[this.__defaultHandlerStack.length-1];
return e
};
DwtKeyboardMgr.prototype.grabFocus=function(e){
if(!this.__enabled){
return
}
if(!this.__keyboardHandlingInited){
return
}
if(!e){
return
}
if(this.__currTabGroup){
this.__currTabGroup.setFocusMember(e,false,true)
}
this.__doGrabFocus(e)
};
DwtKeyboardMgr.prototype.getFocusObj=function(e){
return this.__focusObj
};
DwtKeyboardMgr.prototype.dwtControlHasFocus=function(e){
if(!this.__enabled){
return false
}
if(!this.__keyboardHandlingInited){
return false
}
return(this.__dwtCtrlHasFocus&&this.__focusObj==e)
};
DwtKeyboardMgr.prototype.registerDefaultKeyActionHandler=function(e){
if(!this.__enabled){
return
}
this.__defaultKeyActionHdlr=e
};
DwtKeyboardMgr.prototype.registerKeyMap=function(e){
if(!this.__checkStatus()){
return
}
this.__keyMapMgr=new DwtKeyMapMgr(e)
};
DwtKeyboardMgr.prototype.setKeyTimeout=function(e){
this.__keyTimeout=e
};
DwtKeyboardMgr.prototype.clearKeySeq=function(){
this.__killKeySeqTimedActionId=-1;
this.__keySequence.length=0
};
DwtKeyboardMgr.prototype.enable=function(e){
this.__enabled=e;
if(e){
this.__checkStatus();
Dwt.setHandler(document,DwtEvent.ONKEYDOWN,DwtKeyboardMgr.__keyDownHdlr);
Dwt.setHandler(document,DwtEvent.ONKEYUP,DwtKeyboardMgr.__keyUpHdlr);
Dwt.setHandler(document,DwtEvent.ONKEYPRESS,DwtKeyboardMgr.__keyPressHdlr)
}else{
Dwt.clearHandler(document,DwtEvent.ONKEYDOWN);
Dwt.clearHandler(document,DwtEvent.ONKEYUP);
Dwt.clearHandler(document,DwtEvent.ONKEYPRESS)
}};
DwtKeyboardMgr.prototype.isEnabled=function(){
return this.__enabled
};
DwtKeyboardMgr.prototype.__initKeyboardHandling=function(){
var e=this._kbFocusField=document.createElement("textarea");
e.id=DwtKeyboardMgr.FOCUS_FIELD_ID;
e.tabIndex=0;
e.style.position=Dwt.ABSOLUTE_STYLE;
e.style.top=e.style.left=Dwt.LOC_NOWHERE;
e.onblur=DwtKeyboardMgr.__onBlurHdlr;
e.onfocus=DwtKeyboardMgr.__onFocusHdlr;
document.body.appendChild(e);
this.__killKeySeqTimedAction=new AjxTimedAction(this,this.__killKeySequenceAction);
this.__killKeySeqTimedActionId=-1;
this.__keySequence=[];
this.__keyboardHandlingInited=true
};
DwtKeyboardMgr.prototype.__checkStatus=function(){
if(!this.__enabled){
return false
}
if(!this.__keyboardHandlingInited){
this.__initKeyboardHandling()
}
return true
};
DwtKeyboardMgr.prototype.__doGrabFocus=function(e){
if(!e){
return
}
var o=(Dwt.instanceOf(e,"DwtInputField")||Dwt.instanceOf(e,"DwtHtmlEditor")||Dwt.instanceOf(e,"DwtCheckbox")||Dwt.instanceOf(e,"DwtRadioButton"));
if(o||!(e instanceof DwtControl)){
if(this.__focusObj instanceof DwtControl&&!this.__dwtInputCtrl){
this.__oldFocusObj=this.__focusObj
}
this.__focusObj=e;
this.__dwtInputCtrl=o;
var a=o?e.getInputElement():e;
if((!AjxEnv.isIE&&e.focus)||(AjxEnv.isIE&&e.focus&&!a.disabled&&Dwt.getVisible(a))){
try{
e.focus()
}
catch(t){}}}else{
if(this.__dwtCtrlHasFocus&&(this.__focusObj instanceof DwtControl)){
DwtKeyboardMgr.__onBlurHdlr();
this.__dwtCtrlHasFocus=true
}
this.__focusObj=e;
this.__dwtInputCtrl=false;
if(this.__dwtCtrlHasFocus){
DwtKeyboardMgr.__onFocusHdlr()
}else{
DwtKeyboardMgr.__onFocusHdlr();
this._kbFocusField.focus()
}}};
DwtKeyboardMgr.__onFocusHdlr=function(t){
var a=DwtKeyboardMgr.__shell.getKeyboardMgr();
a.__dwtCtrlHasFocus=true;
var e=a.__focusObj;
if(e&&e.__doFocus){
e.__doFocus()
}};
DwtKeyboardMgr.__onBlurHdlr=function(t){
var a=DwtKeyboardMgr.__shell.getKeyboardMgr();
var e=a.__oldFocusObj||a.__focusObj;
if(e&&e.__doBlur){
e.__doBlur()
}
a.__oldFocusObj=null;
a.__dwtCtrlHasFocus=false
};
DwtKeyboardMgr.__keyUpHdlr=function(e){
e=DwtUiEvent.getEvent(e);
DwtKeyboardMgr.__keyCode=null;
if(AjxEnv.isMac&&AjxEnv.isGeckoBased&&e.keyCode==0){
return DwtKeyboardMgr.__keyDownHdlr(e)
}else{
return DwtKeyboardMgr.__handleKeyEvent(e)
}};
DwtKeyboardMgr.__keyPressHdlr=function(e){
e=DwtUiEvent.getEvent(e);
if(DwtKeyboardMgr.__keyCode&&AjxEnv.isGeckoBased){
return DwtKeyboardMgr.__keyDownHdlr(e)
}else{
return DwtKeyboardMgr.__handleKeyEvent(e)
}};
DwtKeyboardMgr.__handleKeyEvent=function(e){
if(DwtKeyboardMgr.__shell._blockInput){
return false
}
if(e.type=="keypress"){
DwtKeyEvent.geckoCheck(e)
}
e=DwtUiEvent.getEvent(e,this);
var a=DwtKeyboardMgr.__shell.getKeyboardMgr();
var t=DwtShell.keyEvent;
t.setFromDhtmlEvent(e);
if(a.__kbEventStatus!=DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED){
return a.__processKeyEvent(e,t,false)
}};
DwtKeyboardMgr.__syncFocus=function(t,e){
if((e!=t._kbFocusField)&&t.__dwtCtrlHasFocus){
DwtKeyboardMgr.__onBlurHdlr()
}
if(!t.__dwtCtrlHasFocus){
if((e!=t.__focusObj)&&!t.__dwtInputCtrl){
if(t.__currTabGroup&&t.__currTabGroup.setFocusMember(e)){
t.__focusObj=e;
t.__oldFocusObj=null
}else{
return false
}}}
return true
};
DwtKeyboardMgr.__keyDownHdlr=function(r){
if(DwtKeyboardMgr.__shell._blockInput){
return false
}
r=DwtUiEvent.getEvent(r,this);
var e=DwtKeyboardMgr.__shell.getKeyboardMgr();
if(!e||!e.__checkStatus()){
return false
}
var d=DwtShell.keyEvent;
d.setFromDhtmlEvent(r);
var c=DwtKeyboardMgr.__keyCode||DwtKeyEvent.getCharCode(r);
var h=(DwtKeyboardMgr.__keyCode!=null);
DwtKeyboardMgr.__shell.getToolTip().popdown();
var o=DwtKeyboardMgr.__syncFocus(e,d.target);
if(!o){}
if(c==DwtKeyMapMgr.TAB_KEYCODE){
if(e.__currTabGroup&&!DwtKeyMapMgr.hasModifier(d)){
if(!DwtMenu.menuShowing()){
if(o||e.__currTabGroup.getFocusMember()){
if(!d.shiftKey){
e.__currTabGroup.getNextFocusMember(true)
}else{
e.__currTabGroup.getPrevFocusMember(true)
}}else{
e.__currTabGroup.resetFocusMember(true)
}}
return e.__processKeyEvent(r,d,false,DwtKeyboardMgr.__KEYSEQ_HANDLED)
}else{
return e.__processKeyEvent(r,d,true,DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED)
}}else{
if(e.__currTabGroup&&!o&&AjxEnv.isGecko&&d.target instanceof HTMLHtmlElement){
e.__currTabGroup.resetFocusMember(true)
}}
if(e.__dwtCtrlHasFocus){
e._kbFocusField.value=""
}
if(DwtKeyMap.IS_MODIFIER[c]||(!e.__dwtCtrlHasFocus&&(e.__killKeySeqTimedActionId==-1)&&DwtKeyMapMgr.isInputElement(d.target)&&!DwtKeyboardMgr.isPossibleInputShortcut(d))){
return e.__processKeyEvent(r,d,true,DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED)
}
if(e.__killKeySeqTimedActionId!=-1){
AjxTimedAction.cancelAction(e.__killKeySeqTimedActionId);
e.__killKeySeqTimedActionId=-1
}
var t=[];
if(d.altKey){
t.push(DwtKeyMap.ALT)
}
if(d.ctrlKey){
t.push(DwtKeyMap.CTRL)
}
if(d.metaKey){
t.push(DwtKeyMap.META)
}
if(d.shiftKey){
t.push(DwtKeyMap.SHIFT)
}
t.push(c);
e.__keySequence[e.__keySequence.length]=t.join(DwtKeyMap.JOIN);
var s=DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED;
var a=e.__focusObj;
if(a&&(a.handleKeyAction)&&(e.__dwtCtrlHasFocus||e.__dwtInputCtrl||(a.hasFocus&&a.hasFocus()))){
s=e.__dispatchKeyEvent(a,d,false,h);
while((s==DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED)&&a.parent&&a.parent.getKeyMapName){
a=a.parent;
s=e.__dispatchKeyEvent(a,d,false,h)
}}
if((s==DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED)&&e.__currDefaultHandler&&!(e.__currTabGroup&&e.__currTabGroup.isDefaultHandlingBlocked())){
s=e.__dispatchKeyEvent(e.__currDefaultHandler,d,false,h)
}
e.__kbEventStatus=s;
var n=(s==DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED);
if(s!=DwtKeyboardMgr.__KEYSEQ_PENDING){
e.clearKeySeq()
}
if(s==DwtKeyboardMgr.__KEYSEQ_REPEAT){
DwtKeyboardMgr.__keyCode=c
}
return e.__processKeyEvent(r,d,n)
};
DwtKeyboardMgr.prototype.__dispatchKeyEvent=function(s,r,o,a){
if(s&&s.handleKeyEvent){
var h=s.handleKeyEvent(r);
return h?DwtKeyboardMgr.__KEYSEQ_HANDLED:DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}
var n=(s&&s.getKeyMapName)?s.getKeyMapName():null;
if(!n){
return DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}
var t=this.__keyMapMgr.getActionCode(this.__keySequence,n,o);
if(t==DwtKeyMapMgr.NOT_A_TERMINAL){
this.__hdlr=s;
this.__mapName=n;
this.__ev=r;
this.__killKeySeqTimedActionId=AjxTimedAction.scheduleAction(this.__killKeySeqTimedAction,this.__keyTimeout);
return DwtKeyboardMgr.__KEYSEQ_PENDING
}else{
if(t!=null){
if(!s.handleKeyAction){
return DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}
if(!a&&this.__keyMapMgr.repeats(n,t)){
if(AjxEnv.isGeckoBased){
return DwtKeyboardMgr.__KEYSEQ_REPEAT
}else{
var e=s.handleKeyAction(t,r);
return e?DwtKeyboardMgr.__KEYSEQ_REPEAT:DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}}
var e=s.handleKeyAction(t,r);
return e?DwtKeyboardMgr.__KEYSEQ_HANDLED:DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}else{
return DwtKeyboardMgr.__KEYSEQ_NOT_HANDLED
}}};
DwtKeyboardMgr.prototype.__killKeySequenceAction=function(){
this.__dispatchKeyEvent(this.__hdlr,this.__ev,true);
this.clearKeySeq()
};
DwtKeyboardMgr.prototype.__tabGrpChangeListener=function(e){
this.__doGrabFocus(e.newFocusMember)
};
DwtKeyboardMgr.prototype.__processKeyEvent=function(a,o,e,t){
if(t){
this.__kbEventStatus=t
}
o._stopPropagation=!e;
o._returnValue=e;
o.setToDhtmlEvent(a);
return e
}
}
if(AjxPackage.define("ajax.dwt.keyboard.DwtTabGroup")){
DwtTabGroup=function(t,e){
this.__members=new AjxVector();
this.__parent=null;
this.__name=t;
this.__blockApplicationHandling=e;
this.__currFocusMember=null;
this.__evtMgr=new AjxEventMgr()
};
DwtTabGroup.NOT_ROOT_TABGROUP="NOT ROOT TAB GROUP";
DwtTabGroup.__changeEvt=new DwtTabGroupEvent();
DwtTabGroup.prototype.toString=function(){
return"DwtTabGroup"
};
DwtTabGroup.prototype.getName=function(){
return this.__name
};
DwtTabGroup.prototype.addFocusChangeListener=function(e){
this.__checkRoot();
this.__evtMgr.addListener(DwtEvent.STATE_CHANGE,e)
};
DwtTabGroup.prototype.removeFocusChangeListener=function(e){
this.__checkRoot();
this.__evtMgr.removeListener(DwtEvent.STATE_CHANGE,e)
};
DwtTabGroup.prototype.addMember=function(n,a){
if(!n){
return
}
var t=(n instanceof Array)?n:[n];
for(var o=0,e=t.length;
o<e;
o++){
this.__members.add(t[o],a);
if(t[o] instanceof DwtTabGroup){
t[o].newParent(this)
}}};
DwtTabGroup.prototype.addMemberAfter=function(e,t){
this.addMember(e,this.__members.indexOf(t)+1)
};
DwtTabGroup.prototype.addMemberBefore=function(e,t){

this.addMember(e,this.__members.indexOf(t))
};
DwtTabGroup.prototype.removeMember=function(a,e,t){
return this.replaceMember(a,null,e,t)
};
DwtTabGroup.prototype.removeAllMembers=function(){
this.__members.removeAll()
};
DwtTabGroup.prototype.replaceMember=function(n,s,c,r,e,o){
var t=this.__getTabGroupForMember(n);
if(!t){
this.addMember(s);
return null
}
var h=this.__getRootTabGroup();
var a;
if(e){
a=e
}else{
if(h.__currFocusMember==n||((n instanceof DwtTabGroup)&&n.contains(h.__currFocusMember))){
if(s){
a=(s instanceof DwtTabGroup)?s.getFirstMember():s
}else{
a=this.__getPrevMember(n,c);
if(!a){
a=this.__getNextMember(n,c)
}}}}
if(a&&!o){
h.__currFocusMember=a;
if(!r){
this.__notifyListeners(a)
}}
return s?this.__members.replaceObject(n,s):this.__members.remove(n)
};
DwtTabGroup.prototype.contains=function(e){
return(Boolean(this.__getTabGroupForMember(e)))
};
DwtTabGroup.prototype.newParent=function(e){
this.__parent=e
};
DwtTabGroup.prototype.getFirstMember=function(e){
return this.__getLeftMostMember(e)
};
DwtTabGroup.prototype.getTabGroupMemberByName=function(t){
var e=this.__members.getArray();
for(var a=0;
a<e.length;
a++){
var o=e[a];
if(o instanceof DwtTabGroup&&o.getName()==t){
return o
}}};
DwtTabGroup.prototype.getLastMember=function(e){
return this.__getRightMostMember(e)
};
DwtTabGroup.prototype.getFocusMember=function(){
this.__checkRoot();
return this.__currFocusMember
};
DwtTabGroup.prototype.setFocusMember=function(o,e,t){
this.__checkRoot();
if(!this.__checkEnabled(o,e)){
return false
}
var a=this.__getTabGroupForMember(o);
if(a){
this.__currFocusMember=o;
if(!t){
this.__notifyListeners(this.__currFocusMember)
}
return true
}
return false
};
DwtTabGroup.prototype.getNextFocusMember=function(e,t){
this.__checkRoot();
return this.__setFocusMember(true,e,t)
};
DwtTabGroup.prototype.getPrevFocusMember=function(e,t){
this.__checkRoot();
return this.__setFocusMember(false,e,t)
};
DwtTabGroup.prototype.resetFocusMember=function(t,a){
this.__checkRoot();
var e=this.__getLeftMostMember(t);
if((e!=this.__currFocusMember)&&!a){
this.__notifyListeners(this.__currFocusMember)
}
this.__currFocusMember=e;
return this.__currFocusMember
};
DwtTabGroup.prototype.blockDefaultHandling=function(e){
this.__blockDefaultHandling=blockDefaultHandling
};
DwtTabGroup.prototype.isDefaultHandlingBlocked=function(e){
return this.__blockDefaultHandling
};
DwtTabGroup.prototype.dump=function(e){
if(!window.AjxDebug&&window.DBG){
return
}
this.__dump(this,e)
};
DwtTabGroup.prototype.size=function(){
return this.__members.size()
};
DwtTabGroup.prototype.__getPrevMember=function(s,t){
var e=this.__members.getArray();
for(var o=this.__members.indexOf(s)-1;
o>-1;
o--){
var n=e[o];
if(!(n instanceof DwtTabGroup)){
if(this.__checkEnabled(n,t)){
return n
}}else{
n=n.__getRightMostMember(t);
if(n&&this.__checkEnabled(n,t)){
return n
}}}
return this.__parent?this.__parent.__getPrevMember(this,t):null
};
DwtTabGroup.prototype.__checkEnabled=function(t,e){
if(!e){
return true
}
if(!t||t.noTab){
return false
}
if(t instanceof DwtControl){
return(t.getEnabled()&&t.getVisible())
}else{
return !t.disabled&&Dwt.getVisible(t)
}};
DwtTabGroup.prototype.__getNextMember=function(r,t){
var e=this.__members.getArray();
var s=this.__members.size();
for(var n=this.__members.indexOf(r)+1;
n<s;
n++){
var o=e[n];
if(!(o instanceof DwtTabGroup)){
if(this.__checkEnabled(o,t)){
return o
}}else{
o=o.__getLeftMostMember(t);
if(o&&this.__checkEnabled(o,t)){
return o
}}}
return this.__parent?this.__parent.__getNextMember(this,t):null
};
DwtTabGroup.prototype.__getRightMostMember=function(t){
var e=this.__members.getArray();
var n=null;
for(var o=this.__members.size()-1;
o>=0;
o--){
n=e[o];
if(!(n instanceof DwtTabGroup)){
if(this.__checkEnabled(n,t)){
break
}}else{
n=n.__getRightMostMember(t);
if(n&&this.__checkEnabled(n,t)){
break
}}}
return(n&&this.__checkEnabled(n,t))?n:null
};
DwtTabGroup.prototype.__getLeftMostMember=function(t){
var n=this.__members.size();
var e=this.__members.getArray();
var s=null;
for(var o=0;
o<n;
o++){
s=e[o];
if(!(s instanceof DwtTabGroup)){
if(this.__checkEnabled(s,t)){
break
}}else{
s=s.__getLeftMostMember(t);
if(s&&this.__checkEnabled(s,t)){
break
}}}
return(s&&this.__checkEnabled(s,t))?s:null
};
DwtTabGroup.prototype.__notifyListeners=function(t){
var a=this.__getRootTabGroup();
if(a.__evtMgr){
var e=DwtTabGroup.__changeEvt;
e.reset();
e.tabGroup=this;
e.newFocusMember=t;
a.__evtMgr.notifyListeners(DwtEvent.STATE_CHANGE,e)
}};
DwtTabGroup.prototype.__getRootTabGroup=function(){
var e=this;
while(e.__parent){
e=e.__parent
}
return e
};
DwtTabGroup.prototype.__dump=function(n,t,h){
h=h||0;
var r="";
for(var o=0;
o<h;
o++){
r+="&nbsp;&nbsp;&nbsp;&nbsp;"
}
t=t||AjxDebug.DBG1;
r+="&nbsp;&nbsp;&nbsp;&nbsp;";
var s=n.__members.size();
var e=n.__members.getArray();
for(var o=0;
o<s;
o++){
if(e[o] instanceof DwtTabGroup){
n.__dump(e[o],t,h+1)
}else{
if(e[o].toString){}else{}}}};
DwtTabGroup.prototype.__setFocusMember=function(n,t,a){
if(!this.__currFocusMember){
return this.resetFocusMember(t,a)
}
var o=this.__getTabGroupForMember(this.__currFocusMember);
if(!o){
return null
}
var e=(n)?o.__getNextMember(this.__currFocusMember,t):o.__getPrevMember(this.__currFocusMember,t);
if(!e){
e=(n)?this.__getLeftMostMember(t):this.__getRightMostMember(t);
if(e==this.__currFocusMember){
return null
}}
this.__currFocusMember=e;
if(!a){
this.__notifyListeners(this.__currFocusMember)
}
return this.__currFocusMember
};
DwtTabGroup.prototype.__getTabGroupForMember=function(s){
if(!s){
return null
}
var n=this.__members.size();
var t=this.__members.getArray();
var e;
for(var o=0;
o<n;
o++){
e=t[o];
if(e==s){
return this
}else{
if(e instanceof DwtTabGroup&&(e=e.__getTabGroupForMember(s))){
return e
}}}
return null
};
DwtTabGroup.prototype.__checkRoot=function(){
if(this.__parent){
throw DwtTabGroup.NOT_ROOT_TABGROUP
}}
}
if(AjxPackage.define("ajax.dwt.dnd.DwtDragEvent")){
DwtDragEvent=function(){
this.operation=null;
this.srcControl=null;
this.action=null;
this.doIt=false;
this.srcData=null
};
DwtDragEvent.DRAG_START=1;
DwtDragEvent.SET_DATA=2;
DwtDragEvent.DRAG_END=3;
DwtDragEvent.DRAG_CANCEL=4
}
if(AjxPackage.define("ajax.dwt.dnd.DwtDragSource")){
DwtDragSource=function(e){
this.__supportedOps=e;
this.__evtMgr=new AjxEventMgr()
};
DwtDragSource.__DRAG_LISTENER="DwtDragSource.__DRAG_LISTENER";
DwtDragSource.__dragEvent=new DwtDragEvent();
DwtDragSource.prototype.toString=function(){
return"DwtDragSource"
};
DwtDragSource.prototype.addDragListener=function(e){
this.__evtMgr.addListener(DwtDragSource.__DRAG_LISTENER,e)
};
DwtDragSource.prototype.removeDragListener=function(e){
this.__evtMgr.removeListener(DwtDragSource.__DRAG_LISTENER,e)
};
DwtDragSource.prototype._beginDrag=function(e,t){
if(!(this.__supportedOps&e)){
return Dwt.DND_DROP_NONE
}
DwtDragSource.__dragEvent.operation=e;
DwtDragSource.__dragEvent.srcControl=t;
DwtDragSource.__dragEvent.action=DwtDragEvent.DRAG_START;
DwtDragSource.__dragEvent.srcData=null;
DwtDragSource.__dragEvent.doit=true;
this.__evtMgr.notifyListeners(DwtDragSource.__DRAG_LISTENER,DwtDragSource.__dragEvent);
return DwtDragSource.__dragEvent.operation
};
DwtDragSource.prototype._getData=function(){
DwtDragSource.__dragEvent.action=DwtDragEvent.SET_DATA;
this.__evtMgr.notifyListeners(DwtDragSource.__DRAG_LISTENER,DwtDragSource.__dragEvent);
return DwtDragSource.__dragEvent.srcData
};
DwtDragSource.prototype._endDrag=function(){
DwtDragSource.__dragEvent.action=DwtDragEvent.DRAG_END;
DwtDragSource.__dragEvent.doit=false;
this.__evtMgr.notifyListeners(DwtDragSource.__DRAG_LISTENER,DwtDragSource.__dragEvent);
return DwtDragSource.__dragEvent.doit
};
DwtDragSource.prototype._cancelDrag=function(){
DwtDragSource.__dragEvent.action=DwtDragEvent.DRAG_CANCEL;
DwtDragSource.__dragEvent.doit=false;
this.__evtMgr.notifyListeners(DwtDragSource.__DRAG_LISTENER,DwtDragSource.__dragEvent);
return DwtDragSource.__dragEvent.doit
}
}
if(AjxPackage.define("ajax.dwt.dnd.DwtDropEvent")){
DwtDropEvent=function(){
this.operation=null;
this.targetControl=null;
this.action=null;
this.srcData=null;
this.doIt=false
};
DwtDropEvent.DRAG_ENTER=1;
DwtDropEvent.DRAG_LEAVE=2;
DwtDropEvent.DRAG_OP_CHANGED=3;
DwtDropEvent.DRAG_DROP=4
}
if(AjxPackage.define("ajax.dwt.dnd.DwtDropTarget")){
DwtDropTarget=function(t){
this._evtMgr=new AjxEventMgr();
this.__hasMultiple=false;
this._types={};
if(typeof t=="string"){
t=[t]
}
if(t&&t.length){
for(var e=0;
e<t.length;
e++){
this.addTransferType(t[e])
}}};
DwtDropTarget.__DROP_LISTENER="DwtDropTarget.__DROP_LISTENER";
DwtDropTarget.__dropEvent=new DwtDropEvent();
DwtDropTarget.prototype.toString=function(){
return"DwtDropTarget"
};
DwtDropTarget.prototype.addDropListener=function(e){
this._evtMgr.addListener(DwtDropTarget.__DROP_LISTENER,e)
};
DwtDropTarget.prototype.removeDropListener=function(e){
this._evtMgr.removeListener(DwtDropTarget.__DROP_LISTENER,e)
};
DwtDropTarget.prototype.isValidTarget=function(t){
if(t instanceof Array){
var e=t.length;
for(var a=0;
a<e;
a++){
if(!this.__checkTarget(t[a])){
return false
}}
return true
}else{
return this.__checkTarget(t)
}};
DwtDropTarget.prototype.markAsMultiple=function(){
this.__hasMultiple=true
};
DwtDropTarget.prototype.hasMultipleTargets=function(){
return this.__hasMultiple
};
DwtDropTarget.prototype.getTransferTypes=function(){
return this._types
};
DwtDropTarget.prototype.addTransferType=function(e){
this._types[e]=null
};
DwtDropTarget.prototype._dragEnter=function(e,a,n,t,o){
DwtDropTarget.__dropEvent.operation=e;
DwtDropTarget.__dropEvent.targetControl=a;
DwtDropTarget.__dropEvent.action=DwtDropEvent.DRAG_ENTER;
DwtDropTarget.__dropEvent.srcData=n;
DwtDropTarget.__dropEvent.uiEvent=t;
DwtDropTarget.__dropEvent.doIt=true;
DwtDropTarget.__dropEvent.dndProxy=o;
this._evtMgr.notifyListeners(DwtDropTarget.__DROP_LISTENER,DwtDropTarget.__dropEvent);
return DwtDropTarget.__dropEvent.doIt
};
DwtDropTarget.prototype._dragLeave=function(){
DwtDropTarget.__dropEvent.action=DwtDropEvent.DRAG_LEAVE;
this._evtMgr.notifyListeners(DwtDropTarget.__DROP_LISTENER,DwtDropTarget.__dropEvent)
};
DwtDropTarget.prototype._dragOpChanged=function(e){
DwtDropTarget.__dropEvent.operation=e;
DwtDropTarget.__dropEvent.action=DwtDropEvent.DRAG_OP_CHANGED;
this._evtMgr.notifyListeners(DwtDropTarget.__DROP_LISTENER,DwtDropTarget.__dropEvent);
return DwtDropTarget.__dropEvent.doIt
};
DwtDropTarget.prototype._drop=function(t,e){
DwtDropTarget.__dropEvent.action=DwtDropEvent.DRAG_DROP;
DwtDropTarget.__dropEvent.srcData=t;
DwtDropTarget.__dropEvent.uiEvent=e;
this._evtMgr.notifyListeners(DwtDropTarget.__DROP_LISTENER,DwtDropTarget.__dropEvent);
return DwtDropTarget.__dropEvent.doIt
};
DwtDropTarget.prototype.__checkTarget=function(item){
if(this._types){
for(var i in this._types){
var ctor;
if(this._types[i]){
ctor=this._types[i]
}else{
ctor=this._types[i]=eval(i)
}
if(ctor&&(typeof ctor=="function")&&(item instanceof ctor)){
return true
}}
return false
}}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtHoverMgr")){
DwtHoverMgr=function(){
this._hoverOverAction=new AjxTimedAction(this,this._notifyHoverOver);
this._hoverOutAction=new AjxTimedAction(this,this._notifyHoverOut)
};
DwtHoverMgr.prototype._hoverObject;
DwtHoverMgr.prototype._hoverOverDelay=750;
DwtHoverMgr.prototype._hoverOverData;
DwtHoverMgr.prototype._hoverOverAction;
DwtHoverMgr.prototype._hoverOverActionId=-1;
DwtHoverMgr.prototype._hoverOverListener;
DwtHoverMgr.prototype._hoverOutDelay=50;
DwtHoverMgr.prototype._hoverOutData;
DwtHoverMgr.prototype._hoverOutAction;
DwtHoverMgr.prototype._hoverOutActionId=-1;
DwtHoverMgr.prototype._hoverOutListener;
DwtHoverMgr.prototype._isHovering=false;
DwtHoverMgr.prototype.setHoverObject=function(e){
this._hoverObject=e
};
DwtHoverMgr.prototype.getHoverObject=function(){
return this._hoverObject
};
DwtHoverMgr.prototype.reset=function(){
this._hoverObject=null;
this._hoverOverDelay=DwtHoverMgr.prototype._hoverOverDelay;
this._hoverOverData=null;
if(this._hoverOverActionId!=-1){
AjxTimedAction.cancelAction(this._hoverOverActionId)
}
this._hoverOverActionId=-1;
this._hoverOverListener=null;
this._hoverOutDelay=DwtHoverMgr.prototype._hoverOutDelay;
this._hoverOutData=null;
if(this._hoverOutActionId!=-1){
AjxTimedAction.cancelAction(this._hoverOutActionId);
this._notifyHoverOut()
}
this._hoverOutActionId=-1;
this._hoverOutListener=null
};
DwtHoverMgr.prototype.isHovering=function(){
return this._isHovering
};
DwtHoverMgr.prototype.setHoverOverDelay=function(e){
this._hoverOverDelay=e
};
DwtHoverMgr.prototype.setHoverOverData=function(e){
this._hoverOverData=e
};
DwtHoverMgr.prototype.setHoverOverListener=function(e){
this._hoverOverListener=e
};
DwtHoverMgr.prototype.setHoverOutDelay=function(e){
this._hoverOutDelay=e
};
DwtHoverMgr.prototype.setHoverOutData=function(e){
this._hoverOutData=e
};
DwtHoverMgr.prototype.setHoverOutListener=function(e){
this._hoverOutListener=e
};
DwtHoverMgr.prototype.hoverOver=function(e,t){
this._isHovering=true;
if(this._hoverOverActionId!=-1){
AjxTimedAction.cancelAction(this._hoverOverActionId)
}
this._hoverOverAction.args=[e,t];
this._hoverOverActionId=AjxTimedAction.scheduleAction(this._hoverOverAction,this._hoverOverDelay)
};
DwtHoverMgr.prototype.hoverOut=function(){
this._isHovering=false;
if(this._hoverOverActionId!=-1){
AjxTimedAction.cancelAction(this._hoverOverActionId)
}
if(this._hoverOutActionId==-1){
if(this._hoverOutDelay>0){
this._hoverOutActionId=AjxTimedAction.scheduleAction(this._hoverOutAction,this._hoverOutDelay)
}else{
this._notifyHoverOut()
}}};
DwtHoverMgr.prototype._notifyHoverOver=function(){
this._hoverOverActionId=-1;
if(this._hoverOverListener!=null){
var e=this._hoverOverAction.args[0];
var a=this._hoverOverAction.args[1];
var t=new DwtHoverEvent(DwtEvent.HOVEROVER,this._hoverOverDelay,this._hoverOverData,e,a);
this._hoverOverListener.handleEvent(t)
}};
DwtHoverMgr.prototype._notifyHoverOut=function(){
this._hoverOutActionId=-1;
if(this._hoverOutListener!=null){
var e=new DwtHoverEvent(DwtEvent.HOVEROUT,this._hoverOutDelay,this._hoverOutData);
this._hoverOutListener.handleEvent(e)
}}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtControl")){
DwtControl=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtControl.PARAMS);
var e=this.parent=t.parent;
if(e&&!(e instanceof DwtComposite)){
throw new DwtException("Parent must be a subclass of Composite",DwtException.INVALIDPARENT,"DwtControl")
}
this.shell=null;
this._data={};
this._eventMgr=new AjxEventMgr();
this._disposed=false;
if(!e){
return
}
this._className=t.className||"DwtControl";
this.__posStyle=t.posStyle;
if(t.id){
this._htmlElId=t.id
}
this.__index=t.index;
this.__parentElement=t.parentElement;
this._enabled=false;
this._dragging=null;
this._dndProxy=null;
this._hasFocus=false;
if(!t.deferred){
this.__initCtrl()
}
this._hoverOverListener=new AjxListener(this,this.__handleHoverOver);
this._hoverOutListener=new AjxListener(this,this.__handleHoverOut);
this._dblClickIsolation=false;
this._ignoreInternalOverOut=false;
this.TEMPLATE=t.template||this.TEMPLATE
};
DwtControl.PARAMS=["parent","className","posStyle","deferred","id","index","template"];
DwtControl.ALL_BY_ID={};
DwtControl.prototype.toString=function(){
return"DwtControl"
};
DwtControl.NORMAL="";
DwtControl.ACTIVE="ZActive";
DwtControl.FOCUSED="ZFocused";
DwtControl.DISABLED="ZDisabled";
DwtControl.HOVER="ZHover";
DwtControl.SELECTED="ZSelected";
DwtControl.DEFAULT="ZDefault";
DwtControl.ERROR="ZError";
DwtControl._RE_STATES=new RegExp("\\b("+[DwtControl.ACTIVE,DwtControl.FOCUSED,DwtControl.DISABLED,DwtControl.HOVER,DwtControl.SELECTED,DwtControl.DEFAULT,DwtControl.ERROR].join("|")+")\\b","g");
DwtControl.STATIC_STYLE=Dwt.STATIC_STYLE;
DwtControl.ABSOLUTE_STYLE=Dwt.ABSOLUTE_STYLE;
DwtControl.RELATIVE_STYLE=Dwt.RELATIVE_STYLE;
DwtControl.FIXED_STYLE=Dwt.FIXED_STYLE;
DwtControl.CLIP=Dwt.CLIP;
DwtControl.VISIBLE=Dwt.VISIBLE;
DwtControl.SCROLL=Dwt.SCROLL;
DwtControl.FIXED_SCROLL=Dwt.FIXED_SCROLL;
DwtControl.DEFAULT=Dwt.DEFAULT;
DwtControl._NO_DRAG=1;
DwtControl._DRAGGING=2;
DwtControl._DRAG_REJECTED=3;
DwtControl.__DRAG_THRESHOLD=3;
DwtControl.__TOOLTIP_THRESHOLD=5;
DwtControl.__DND_HOVER_DELAY=750;
DwtControl.__controlEvent=new DwtControlEvent();
DwtControl.__DBL_CLICK_TIMEOUT=300;
DwtControl.prototype._displayState="";
DwtControl.prototype.addControlListener=function(e){
this.addListener(DwtEvent.CONTROL,e)
};
DwtControl.prototype.removeControlListener=function(e){
this.removeListener(DwtEvent.CONTROL,e)
};
DwtControl.prototype.addDisposeListener=function(e){
this.addListener(DwtEvent.DISPOSE,e)
};
DwtControl.prototype.removeDisposeListener=function(e){
this.removeListener(DwtEvent.DISPOSE,e)
};
DwtControl.prototype.addListener=function(t,a,e){
return this._eventMgr.addListener(t,a,e)
};
DwtControl.prototype.removeListener=function(e,t){
return this._eventMgr.removeListener(e,t)
};
DwtControl.prototype.removeAllListeners=function(e){
return this._eventMgr.removeAll(e)
};
DwtControl.prototype.isListenerRegistered=function(e){
return this._eventMgr.isListenerRegistered(e)
};
DwtControl.prototype.notifyListeners=function(e,t){
return this._eventMgr.notifyListeners(e,t)
};
DwtControl.prototype.dispose=function(){
if(this._disposed){
return
}
if(this.parent!=null&&this.parent instanceof DwtComposite){
this.parent.removeChild(this)
}
this._elRef=null;
if(DwtControl.ALL_BY_ID){
DwtControl.ALL_BY_ID[this._htmlElId]=null;
delete DwtControl.ALL_BY_ID[this._htmlElId]
}
this._disposed=true;
var e=new DwtDisposeEvent();
e.dwtObj=this;
this.notifyListeners(DwtEvent.DISPOSE,e)
};
DwtControl.prototype.getDocument=function(){
return document
};
DwtControl.prototype.getTabGroupMember=function(){
return this
};
DwtControl.prototype.getData=function(e){
return this._data[e]
};
DwtControl.prototype.setData=function(e,t){
this._data[e]=t
};
DwtControl.prototype.isDisposed=function(){
return this._isDisposed
};
DwtControl.prototype.isInitialized=function(){
return this.__ctrlInited
};
DwtControl.prototype.focus=function(){
DwtShell.getShell(window).getKeyboardMgr().grabFocus(this)
};
DwtControl.prototype.hasFocus=function(){
return this._hasFocus
};
DwtControl.prototype.handleKeyAction=function(e,t){
return false
};
DwtControl.prototype.reparent=function(t,e){
if(!this._checkState()){
return
}
var a=this.getHtmlElement();
this.parent.removeChild(this,true);
DwtComposite._pendingElements[this._htmlElId]=a;
t.addChild(this,e);
this.parent=t
};
DwtControl.prototype.reparentHtmlElement=function(a,e){
if(typeof a=="string"){
a=document.getElementById(a)
}
if(!a){
return
}
var t=this.getHtmlElement();
if(e==null){
a.appendChild(t)
}else{
if(typeof e=="object"){
a.insertBefore(t,e)
}else{
if(a.childNodes[e]){
a.insertBefore(t,a.childNodes[e])
}else{
a.appendChild(t)
}}}};
DwtControl.prototype.setHandler=function(t,e){
if(!this._checkState()){
return
}
var a=this.getHtmlElement();
Dwt.setHandler(a,t,e)
};
DwtControl.prototype.clearHandler=function(e){
if(!this._checkState()){
return
}
var t=this.getHtmlElement();
Dwt.clearHandler(t,e)
};
DwtControl.prototype.getBounds=function(){
if(!this._checkState()){
return
}
return Dwt.getBounds(this.getHtmlElement())
};
DwtControl.prototype.setBounds=function(a,s,o,t){
if(!this._checkState()){
return
}
var n=this.getHtmlElement();
if(this.isListenerRegistered(DwtEvent.CONTROL)){
this.__controlEvent.reset(DwtControlEvent.RESIZE|DwtControlEvent.MOVE);
var e=Dwt.getBounds(n);
this.__controlEvent.oldX=e.x;
this.__controlEvent.oldY=e.y;
this.__controlEvent.oldWidth=e.width;
this.__controlEvent.oldHeight=e.height;
this.setLocation(a,s);
this.setSize(o,t);
e=Dwt.getBounds(n);
this.__controlEvent.newX=e.x;
this.__controlEvent.newY=e.y;
this.__controlEvent.newWidth=e.width;
this.__controlEvent.newHeight=e.height;
this.__controlEvent.requestedWidth=o;
this.__controlEvent.requestedHeight=t;
this.notifyListeners(DwtEvent.CONTROL,this.__controlEvent)
}else{
this.setLocation(a,s);
this.setSize(o,t)
}
return this
};
DwtControl.prototype.getClassName=function(){
return this._className
};
DwtControl.prototype.setClassName=function(t){
if(!this._checkState()){
return
}
this._className=t;
var e=this.getHtmlElement();
e.className=t;
Dwt.addClass(e,this._displayState)
};
DwtControl.prototype.addClassName=function(e){
Dwt.addClass(this.getHtmlElement(),e)
};
DwtControl.prototype.delClassName=function(e,t){
Dwt.delClass(this.getHtmlElement(),e,t)
};
DwtControl.prototype.condClassName=function(a,e,t){
Dwt.condClass(this.getHtmlElement(),a,e,t)
};
DwtControl.prototype.setDisplayState=function(o){
if(!this._enabled){
o=DwtControl.DISABLED
}
if(arguments.length>1){
var e=[];
for(var t=0;
t<arguments.length;
t++){
e.push(arguments[t])
}
o=e.join(" ")
}
if(this._displayState!=o){
this._displayState=o;
Dwt.delClass(this.getHtmlElement(),DwtControl._RE_STATES,o)
}};
DwtControl.prototype.showAlert=function(e){
if(e&&!this._alert){
this.delClassName(null,"ZAlert")
}else{
if(!e&&this._alert){
this.delClassName("ZAlert",null)
}}
this._alert=e
};
DwtControl.prototype.isAlertShown=function(){
return this._alert
};
DwtControl.prototype._createHtmlFromTemplate=function(e,a){
this.getHtmlElement().innerHTML=AjxTemplate.expand(e,a);
var o=AjxTemplate.getParams(e);
var t=o&&o["class"];
if(t){
t=[this._className,t].join(" ");
this.setClassName(t)
}};
DwtControl.prototype.getCursor=function(){
if(!this._checkState()){
return
}
return Dwt.getCursor(this.getHtmlElement())
};
DwtControl.prototype.setCursor=function(e){
if(!this._checkState()){
return
}
Dwt.setCursor(this.getHtmlElement(),e)
};
DwtControl.prototype.getDragSource=function(){
return this._dragSource
};
DwtControl.prototype.setDragSource=function(e){
this._dragSource=e;
if(e!=null&&this._ctrlCaptureObj==null){
this._ctrlCaptureObj=new DwtMouseEventCapture({
targetObj:this,id:"DwtControl",mouseOverHdlr:DwtControl.__mouseOverHdlr,mouseDownHdlr:DwtControl.__mouseDownHdlr,mouseMoveHdlr:DwtControl.__mouseMoveHdlr,mouseUpHdlr:DwtControl.__mouseUpHdlr,mouseOutHdlr:DwtControl.__mouseOutHdlr}
);
this._dndHoverAction=new AjxTimedAction(null,this.__dndDoHover)
}};
DwtControl.prototype.getDropTarget=function(){
return this._dropTarget
};
DwtControl.prototype.setDropTarget=function(e){
this._dropTarget=e
};
DwtControl.prototype.getEnabled=function(){
if(!this._checkState()){
return
}
return this._enabled
};
DwtControl.prototype.setEnabled=function(e,t){
if(!this._checkState()){
return
}
if(e!=this._enabled){
this._enabled=e;
this.setDisplayState(e?DwtControl.NORMAL:DwtControl.DISABLED);
if(t){
this.getHtmlElement().disabled=!e
}}};
DwtControl.prototype.getHTMLElId=function(){
return this._htmlElId
};
DwtControl.prototype.getHtmlElement=function(){
if(!this._checkState()){
return
}
var e=this._elRef||document.getElementById(this._htmlElId);
if(e==null){
e=DwtComposite._pendingElements[this._htmlElId]
}else{
if(!e._rendered){
delete DwtComposite._pendingElements[this._htmlElId];
e._rendered=true
}}
return this._elRef=e
};
DwtControl.fromElement=function(e){
return DwtControl.ALL_BY_ID&&DwtControl.ALL_BY_ID[e.id]
};
DwtControl.fromElementId=function(e){
return DwtControl.ALL_BY_ID&&DwtControl.ALL_BY_ID[e]
};
DwtControl.findControl=function(t){
while(t){
try{
if(t.id&&DwtControl.ALL_BY_ID&&DwtControl.ALL_BY_ID[t.id]){
return DwtControl.ALL_BY_ID[t.id]
}}
catch(e){
return null
}
t=t.parentNode
}
return null
};
DwtControl.getTargetControl=function(e,a){
var t=DwtUiEvent.getTarget(e,a);
return t?DwtControl.findControl(t):null
};
DwtControl.prototype.setHtmlElementId=function(t){
if(this._disposed){
return
}
if(this.__ctrlInited){
var e=this.getHtmlElement();
if(!e._rendered){
delete DwtComposite._pendingElements[this._htmlElId];
DwtComposite._pendingElements[t]=e
}else{
delete DwtControl.ALL_BY_ID[this._htmlElId];
DwtControl.ALL_BY_ID[t]=this
}
e.id=t
}
this._htmlElId=t
};
DwtControl.prototype.getX=function(){
if(!this._checkState()){
return
}
return Dwt.getLocation(this.getHtmlElement()).x
};
DwtControl.prototype.getXW=function(){
if(!this._checkState()){
return
}
var e=this.getBounds();
return e.x+e.width
};
DwtControl.prototype.getY=function(){
if(!this._checkState()){
return
}
return Dwt.getLocation(this.getHtmlElement()).y
};
DwtControl.prototype.getYH=function(){
if(!this._checkState()){
return
}
var e=this.getBounds();
return e.y+e.height
};
DwtControl.prototype.getLocation=function(){
if(!this._checkState()){
return
}
return Dwt.getLocation(this.getHtmlElement())
};
DwtControl.prototype.setLocation=function(e,o){
if(!this._checkState()){
return
}
if(this.isListenerRegistered(DwtEvent.CONTROL)){
var t=this.getHtmlElement();
this.__controlEvent.reset(DwtControlEvent.MOVE);
var a=Dwt.getLocation(t);
this.__controlEvent.oldX=a.x;
this.__controlEvent.oldY=a.y;
Dwt.setLocation(t,e,o);
a=Dwt.getLocation(t);
this.__controlEvent.newX=a.x;
this.__controlEvent.newY=a.y;
this.notifyListeners(DwtEvent.CONTROL,this.__controlEvent)
}else{
Dwt.setLocation(this.getHtmlElement(),e,o)
}
return this
};
DwtControl.prototype.getScrollStyle=function(){
if(!this._checkState()){
return
}
return Dwt.getScrollStyle(this.getHtmlElement())
};
DwtControl.prototype.setScrollStyle=function(e){
if(!this._checkState()){
return
}
Dwt.setScrollStyle(this.getHtmlElement(),e)
};
DwtControl.prototype.setPosition=function(e){
if(!this._checkState()){
return
}
if(e==DwtControl.STATIC_STYLE||e==DwtControl.ABSOLUTE_STYLE||e==DwtControl.RELATIVE_STYLE){
this.__posStyle=e;
Dwt.setPosition(this.getHtmlElement(),e)
}};
DwtControl.prototype.getW=function(){
if(!this._checkState()){
return
}
return Dwt.getSize(this.getHtmlElement()).x
};
DwtControl.prototype.getH=function(){
if(!this._checkState()){
return
}
return Dwt.getSize(this.getHtmlElement()).y
};
DwtControl.prototype.getSize=function(){
if(!this._checkState()){
return
}
return Dwt.getSize(this.getHtmlElement())
};
DwtControl.prototype.setSize=function(t,e){
if(!this._checkState()){
return
}
if(this.isListenerRegistered(DwtEvent.CONTROL)){
var o=this.getHtmlElement();
this.__controlEvent.reset(DwtControlEvent.RESIZE);
var a=Dwt.getSize(o);
this.__controlEvent.oldWidth=a.x;
this.__controlEvent.oldHeight=a.y;
Dwt.setSize(o,t,e);
a=Dwt.getSize(o);
this.__controlEvent.newWidth=a.x;
this.__controlEvent.newHeight=a.y;
this.notifyListeners(DwtEvent.CONTROL,this.__controlEvent)
}else{
Dwt.setSize(this.getHtmlElement(),t,e)
}
return this
};
DwtControl.prototype.getToolTipContent=function(e){
if(this._disposed){
return
}
return this.__toolTipContent
};
DwtControl.prototype.setToolTipContent=function(e){
if(this._disposed){
return
}
this.__toolTipContent=e
};
DwtControl.prototype.getVisible=function(){
if(!this._checkState()){
return
}
return Dwt.getVisible(this.getHtmlElement())
};
DwtControl.prototype.setVisible=function(e){
if(!this._checkState()){
return
}
Dwt.setVisible(this.getHtmlElement(),e)
};
DwtControl.prototype.setVisibility=function(e){
if(!this._checkState()){
return
}
Dwt.setVisibility(this.getHtmlElement(),e)
};
DwtControl.prototype.getVisibility=function(){
if(!this._checkState()){
return
}
return Dwt.getVisiblility(this.getHtmlElement())
};
DwtControl.prototype.getZIndex=function(){
if(!this._checkState()){
return
}
return Dwt.getZIndex(this.getHtmlElement())
};
DwtControl.prototype.setZIndex=function(e){
if(!this._checkState()){
return
}
Dwt.setZIndex(this.getHtmlElement(),e)
};
DwtControl.prototype.zShow=function(e){
this.setZIndex(e?Dwt.Z_VIEW:Dwt.Z_HIDDEN)
};
DwtControl.prototype.setDisplay=function(e){
if(!this._checkState()){
return
}
Dwt.setDisplay(this.getHtmlElement(),e)
};
DwtControl.prototype.preventSelection=function(e){
return !this.__isInputEl(e)
};
DwtControl.prototype.preventContextMenu=function(e){
return e?(!this.__isInputEl(e)):true
};
DwtControl.prototype.setContent=function(e){
if(e){
this.getHtmlElement().innerHTML=e
}};
DwtControl.prototype.clearContent=function(){
this.getHtmlElement().innerHTML=""
};
DwtControl.prototype.appendElement=function(t){
var e=AjxUtil.isString(t)?document.getElementById(t):t;
if(e){
e.appendChild(this.getHtmlElement(),e)
}};
DwtControl.prototype.replaceElement=function(o,e,n){
var t=AjxUtil.isString(o)?document.getElementById(o):o;
if(t){
var a=this.getHtmlElement();
t.parentNode.replaceChild(a,t);
this._replaceElementHook(t,a,e,n)
}};
DwtControl.prototype._replaceElementHook=function(t,o,e,n){
if((e==null||e)&&t.className){
Dwt.addClass(o,t.className)
}
if(n==null||n){
var a=t.getAttribute("style");
if(a){
o.setAttribute("style",[o.getAttribute("style"),a].join(";"))
}}};
DwtControl.prototype._blur=function(){};
DwtControl.prototype._focus=function(){};
DwtControl.prototype._focusByMouseUpEvent=function(e){
if(this.getEnabled()){
this.focus()
}};
DwtControl.prototype._focusByMouseDownEvent=function(e){
this._focusByMouseUpEvent(e)
};
DwtControl.prototype._getDragProxy=function(e){
return null
};
DwtControl.prototype._setDragProxyState=function(e){
Dwt.condClass(this._dndProxy,e,DwtCssStyle.DROPPABLE,DwtCssStyle.NOT_DROPPABLE)
};
DwtControl.__junkIconId=0;
DwtControl.prototype._destroyDragProxy=function(e){
if(e){
if(e.parentNode){
e.parentNode.removeChild(e)
}else{
e.style.zIndex=-100;
e.id="DwtJunkIcon"+DwtControl.__junkIconId++;
e=null
}}};
DwtControl.prototype._isValidDragObject=function(e){
return true
};
DwtControl.prototype._dragEnter=function(e){};
DwtControl.prototype._dragOver=function(e){};
DwtControl.prototype._dragHover=function(e){};
DwtControl.prototype._dragLeave=function(e){};
DwtControl.prototype._drop=function(e){};
DwtControl.prototype._setKeyPressEventHdlr=function(e){
this._setEventHdlrs([DwtEvent.ONKEYPRESS],e)
};
DwtControl.prototype._setMouseEventHdlrs=function(e){
this._setEventHdlrs(DwtEvent.MOUSE_EVENTS,e)
};
DwtControl.prototype._setEventHdlrs=function(a,e){
if(!this._checkState()){
return
}
var o=this.getHtmlElement();
for(var t=0;
t<a.length;
t++){
if(e!==true){
Dwt.setHandler(o,a[t],DwtControl.__HANDLER[a[t]])
}else{
Dwt.clearHandler(o,a[t])
}}};
DwtControl.prototype._setMouseEvents=function(){
var e=[DwtEvent.ONCONTEXTMENU,DwtEvent.ONDBLCLICK,DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEMOVE,DwtEvent.ONMOUSEUP,DwtEvent.ONSELECTSTART];
if(AjxEnv.isIE){
e.push(DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE)
}else{
e.push(DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT)
}
this._setEventHdlrs(e)
};
DwtControl.prototype._setMouseEvent=function(t,e){
t.reset();
e.ersatz=true;
DwtUiEvent.copy(t,e);
t.button=e.button
};
DwtControl.prototype._getStopPropagationValForMouseEv=function(e){
return true
};
DwtControl.prototype._getEventReturnValForMouseEv=function(e){
return false
};
DwtControl.prototype._checkState=function(){
if(this._disposed){
return false
}
if(!this.__ctrlInited){
this.__initCtrl()
}
return true
};
DwtControl.prototype._position=function(o){
this._checkState();
var a=this.shell.getSize();
var t=this.getSize();
var e,n;
if(!o){
e=Math.round((a.x-t.x)/2);
n=Math.round((a.y-t.y)/2)
}else{
e=o.x;
n=o.y
}
if((e+t.x)>a.x){
e=a.x-t.x
}
if((n+t.y)>a.y){
n=a.y-t.y
}
this.setLocation(e,n)
};
DwtControl._scrollIntoView=function(a,t){
var e=Dwt.toWindow(a,0,0,null,null,DwtPoint.tmp).y;
var r=Dwt.toWindow(t,0,0,null,null,DwtPoint.tmp).y+t.scrollTop;
var s=e-r;
if(s<0){
t.scrollTop+=s
}else{
var n=Dwt.getSize(t,DwtPoint.tmp).y;
var o=Dwt.getSize(a,DwtPoint.tmp).y;
s=(e+o)-(r+n);
if(s>0){
t.scrollTop+=s
}}};
DwtControl._dndScrollCallback=function(a,r){
var t=a.container;
if(!t){
return
}
var u=r.dwtObj&&r.dwtObj._dndScrollId;
if(r.type=="mouseup"||!u||(a.id&&u!=a.id)){
if(t._dndScrollActionId!=-1){
AjxTimedAction.cancelAction(t._dndScrollActionId);
t._dndScrollActionId=-1
}
return
}
t._scrollAmt=0;
if(t.clientHeight<t.scrollHeight){
var o=Dwt.toWindow(t,0,0,null,null,DwtPoint.tmp).y;
var m=o+t.scrollTop;
var h=t.scrollTop;
var c=r.docY-m;
var n=(t.clientWidth<t.scrollWidth)?a.threshold+Dwt.SCROLLBAR_WIDTH:a.threshold;
var s=(c<=n)?-1*a.amount:0;
if(s==0){
var e=Dwt.getSize(t,DwtPoint.tmp).y;
var d=m+e;
c=d-r.docY;
s=(c<=n)?a.amount:0
}
t._scrollAmt=s;
if(s){
if(!t._dndScrollAction){
t._dndScrollAction=new AjxTimedAction(null,DwtControl._dndScroll,[a]);
t._dndScrollActionId=-1
}
if(t._dndScrollActionId==-1){
t._dndScrollActionId=AjxTimedAction.scheduleAction(t._dndScrollAction,0)
}}else{
if(t._dndScrollActionId!=-1){
AjxTimedAction.cancelAction(t._dndScrollActionId);
t._dndScrollActionId=-1
}}}};
DwtControl._dndScroll=function(n){
var t=n.container;
var o=Dwt.toWindow(t,0,0,null,null,DwtPoint.tmp).y;
var a=Dwt.getSize(t,DwtPoint.tmp).y;
var e=t.scrollTop;
if((t._scrollAmt<0&&e>0)||(t._scrollAmt>0&&(e+a<t.scrollHeight))){
t.scrollTop+=t._scrollAmt;
t._dndScrollActionId=AjxTimedAction.scheduleAction(t._dndScrollAction,n.interval)
}};
DwtControl.__keyPressHdlr=function(a){
var o=o?o:DwtControl.getTargetControl(a);
if(!o){
return false
}
if(o.__hasToolTipContent()){
var t=DwtShell.getShell(window);
var e=t.getHoverMgr();
e.setHoverOutListener(o._hoverOutListener);
e.hoverOut();
o.__tooltipClosed=false
}};
DwtControl.prototype.__hasToolTipContent=function(){
if(this._disposed){
return false
}
return Boolean(this.__toolTipContent||(this.getToolTipContent!=DwtControl.prototype.getToolTipContent))
};
DwtControl.prototype.__doBlur=function(){
this._hasFocus=false;
if(this.isListenerRegistered(DwtEvent.ONBLUR)){
var e=DwtShell.focusEvent;
e.dwtObj=this;
e.state=DwtFocusEvent.BLUR;
obj.notifyListeners(DwtEvent.ONBLUR,mouseEv)
}
this._blur()
};
DwtControl.prototype.__doFocus=function(){
this._hasFocus=true;
if(this.isListenerRegistered(DwtEvent.ONFOCUS)){
var e=DwtShell.focusEvent;
e.dwtObj=this;
e.state=DwtFocusEvent.FOCUS;
obj.notifyListeners(DwtEvent.ONFOCUS,mouseEv)
}
this._focus()
};
DwtControl.__dblClickHdlr=function(e){
var t=DwtControl.getTargetControl(e);
if(t&&t._dblClickIsolation){
t._clickPending=false;
AjxTimedAction.cancelAction(t._dblClickActionId)
}
return DwtControl.__mouseEvent(e,DwtEvent.ONDBLCLICK)
};
DwtControl.__mouseOverHdlr=function(s,n){
var h=(DwtMouseEventCapture.getId()=="DwtControl")?DwtMouseEventCapture.getCaptureObj():null;
if(h!=null){
s=DwtUiEvent.getEvent(s);
s._stopPropagation=true;
return false
}
var r=DwtControl.getTargetControl(s);
if(!r){
return false
}
n=n||DwtEvent.ONMOUSEOVER;
if((n==DwtEvent.ONMOUSEOVER)&&r._ignoreInternalOverOut){
var e=DwtControl.getTargetControl(s,true);
if(r==e){
return false
}}
var o=DwtShell.mouseEvent;
if(r._dragging==DwtControl._NO_DRAG){
o.setFromDhtmlEvent(s,r);
if(r.isListenerRegistered(n)){
r.notifyListeners(n,o)
}
if(r.__hasToolTipContent()){
var a=DwtShell.getShell(window);
var t=a.getHoverMgr();
if((!t.isHovering()||t.getHoverObject()!=r)&&!DwtMenu.menuShowing()){
t.reset();
t.setHoverObject(r);
t.setHoverOverData(o);
t.setHoverOverDelay(DwtToolTip.TOOLTIP_DELAY);
t.setHoverOverListener(r._hoverOverListener);
t.hoverOver(o.docX,o.docY)
}}}
o._stopPropagation=true;
o._returnValue=false;
o.setToDhtmlEvent(s);
return false
};
DwtControl.__mouseEnterHdlr=function(e){
return DwtControl.__mouseOverHdlr(e,DwtEvent.ONMOUSEENTER)
};
DwtControl.__mouseDownHdlr=function(n){
var s=DwtControl.getTargetControl(n);
if(!s){
return false
}
n=DwtUiEvent.getEvent(n);
s._focusByMouseDownEvent(n);
if(s.__hasToolTipContent()){
var a=DwtShell.getShell(window);
var t=a.getHoverMgr();
t.setHoverOutListener(s._hoverOutListener);
t.hoverOut()
}
var o=DwtShell.mouseEvent;
o.setFromDhtmlEvent(n,s);
if(s._dragSource&&(o.button==DwtMouseEvent.LEFT)&&s._isValidDragObject(o)){
try{
s._ctrlCaptureObj.capture()
}
catch(e){}
s._dragOp=(o.ctrlKey)?Dwt.DND_DROP_COPY:Dwt.DND_DROP_MOVE;
s.__dragStartX=o.docX;
s.__dragStartY=o.docY
}
return DwtControl.__mouseEvent(n,DwtEvent.ONMOUSEDOWN,s,o)
};
DwtControl.__mouseMoveHdlr=function(r){
var n=(DwtMouseEventCapture.getId()=="DwtControl")?DwtMouseEventCapture.getCaptureObj():null;
var o=n?n.targetObj:DwtControl.getTargetControl(r);
if(!o){
return false
}
if(o.__dndHoverActionId!=-1){
AjxTimedAction.cancelAction(o.__dndHoverActionId);
o.__dndHoverActionId=-1
}
var h=DwtShell.mouseEvent;
h.setFromDhtmlEvent(r,n?true:o);
if(h.docX<0||h.docY<0){
h._stopPropagation=true;
h._returnValue=false;
h.setToDhtmlEvent(r);
return false
}
if(o._dragSource==null||n==null||(o!=null&&o._dragging==DwtControl._NO_DRAG&&Math.abs(o.__dragStartX-h.docX)<DwtControl.__DRAG_THRESHOLD&&Math.abs(o.__dragStartY-h.docY)<DwtControl.__DRAG_THRESHOLD)){
if(o.__hasToolTipContent()){
var s=DwtShell.getShell(window);
var e=s.getHoverMgr();
if(!e.isHovering()&&!o.__tooltipClosed&&!DwtMenu.menuShowing()){
e.hoverOver(h.docX,h.docY)
}else{
var a=o.__lastTooltipX?Math.abs(h.docX-o.__lastTooltipX):null;
var t=o.__lastTooltipY?Math.abs(h.docY-o.__lastTooltipY):null;
if((a!=null&&a>DwtControl.__TOOLTIP_THRESHOLD)||(t!=null&&t>DwtControl.__TOOLTIP_THRESHOLD)){
e.setHoverOutListener(o._hoverOutListener);
e.hoverOut();
o.__tooltipClosed=true
}}}
return DwtControl.__mouseEvent(r,DwtEvent.ONMOUSEMOVE,o,h)
}else{
if(o._dragging==DwtControl._NO_DRAG){
o._dragOp=o._dragSource._beginDrag(o._dragOp,o);
if(o._dragOp!=Dwt.DND_DROP_NONE){
o._dragging=DwtControl._DRAGGING;
o._dndProxy=o._getDragProxy(o._dragOp);
Dwt.addClass(o._dndProxy,"DwtDragProxy");
if(o._dndProxy==null){
o._dragging=DwtControl._DRAG_REJECTED
}}else{
o._dragging=DwtControl._DRAG_REJECTED
}}
if(o._dragging!=DwtControl._DRAG_REJECTED){
var c=h.dwtObj;
if(c){
o._dndHoverAction.args=[c];
o.__dndHoverActionId=AjxTimedAction.scheduleAction(o._dndHoverAction,DwtControl.__DND_HOVER_DELAY)
}
if(c&&c._dropTarget&&c!=o){
if(c!=o.__lastDestDwtObj||c._dropTarget.hasMultipleTargets()){
if(c._dropTarget._dragEnter(o._dragOp,c,o._dragSource._getData(),h,o._dndProxy)){
o._setDragProxyState(true);
o.__dropAllowed=true;
c._dragEnter(h)
}else{
o._setDragProxyState(false);
o.__dropAllowed=false
}}else{
if(o.__dropAllowed){
c._dragOver(h)
}}}else{
o._setDragProxyState(false)
}
if(o.__lastDestDwtObj&&o.__lastDestDwtObj!=c&&o.__lastDestDwtObj._dropTarget&&o.__lastDestDwtObj!=o){
if(c&&!c._dndScrollCallback&&o.__lastDestDwtObj._dndScrollCallback){
o.__lastDestDwtObj._dndScrollCallback.run(h)
}
o.__lastDestDwtObj._dragLeave(h);
o.__lastDestDwtObj._dropTarget._dragLeave()
}
o.__lastDestDwtObj=c;
if((c!=o)&&c&&c._dndScrollCallback){
c._dndScrollCallback.run(h)
}
Dwt.setLocation(o._dndProxy,h.docX+2,h.docY+2)
}else{
DwtControl.__mouseEvent(r,DwtEvent.ONMOUSEMOVE,o,h)
}
h._stopPropagation=true;
h._returnValue=false;
h.setToDhtmlEvent(r);
return false
}};
DwtControl.__mouseUpHdlr=function(t){
var n=(DwtMouseEventCapture.getId()=="DwtControl")?DwtMouseEventCapture.getCaptureObj():null;
var o=n?n.targetObj:DwtControl.getTargetControl(t);
if(!o){
return false
}
if(o.__dndHoverActionId!=-1){
AjxTimedAction.cancelAction(o.__dndHoverActionId);
o.__dndHoverActionId=-1
}
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t,n?true:o);
if(!o._dragSource||!n){
return DwtControl.__processMouseUpEvent(t,o,e)
}else{
n.release();
if(o._dragging!=DwtControl._DRAGGING){
o._dragging=DwtControl._NO_DRAG;
return DwtControl.__processMouseUpEvent(t,o,e)
}else{
o.__lastDestDwtObj=null;
var a=e.dwtObj;
if(a&&a._dropTarget&&o.__dropAllowed&&a!=o){
a._drop(e);
a._dropTarget._drop(o._dragSource._getData(),e);
o._dragSource._endDrag();
o._destroyDragProxy(o._dndProxy);
o._dragging=DwtControl._NO_DRAG
}else{
DwtControl.__badDrop(o,e)
}
if(a&&a._dndScrollCallback){
a._dndScrollCallback.run(e)
}
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
}}};
DwtControl.__badDrop=function(a,t){
a._dragSource._cancelDrag();
a.__dragEndX=t.docX;
a.__dragEndY=t.docY;
if(a.__badDropAction==null){
a.__badDropAction=new AjxTimedAction(a,a.__badDropEffect)
}
var e=(a.__dragEndY-a.__dragStartY)/(a.__dragEndX-a.__dragStartX);
a.__badDropAction.args=[e,a.__dragStartY-(e*a.__dragStartX),(a.__dragStartX-a.__dragEndX<0)?-1:1];
AjxTimedAction.scheduleAction(a.__badDropAction,0)
};
DwtControl.__processMouseUpEvent=function(a,o,t){
if(o._dblClickIsolation&&t&&(t.button==DwtMouseEvent.LEFT)){
if(o._clickPending){
return false
}else{
o._clickPending=true;
var e=new AjxTimedAction(null,DwtControl.__timedClick,[a,o,t]);
o._dblClickActionId=AjxTimedAction.scheduleAction(e,DwtControl.__DBL_CLICK_TIMEOUT);
DwtUiEvent.setBehaviour(a,true,false);
o._st=new Date();
return false
}}else{
o._clickPending=false;
return DwtControl.__mouseEvent(a,DwtEvent.ONMOUSEUP,o,t)
}};
DwtControl.__timedClick=function(t,a,e){
a._clickPending=false;
DwtControl.__mouseEvent(t,DwtEvent.ONMOUSEUP,a,e)
};
DwtControl.__mouseOutHdlr=function(n,o){
var s=DwtControl.getTargetControl(n);
if(!s){
return false
}
o=o||DwtEvent.ONMOUSEOUT;
if((o==DwtEvent.ONMOUSEOUT)&&s._ignoreInternalOverOut){
var e=DwtControl.getTargetControl(n,true);
if(s==e){
return false
}}
if(s.__hasToolTipContent()){
var a=DwtShell.getShell(window);
var t=a.getHoverMgr();
t.setHoverOutListener(s._hoverOutListener);
t.hoverOut();
s.__tooltipClosed=false
}
return DwtControl.__mouseEvent(n,o||DwtEvent.ONMOUSEOUT,s)
};
DwtControl.__mouseLeaveHdlr=function(e){
return DwtControl.__mouseOutHdlr(e,DwtEvent.ONMOUSELEAVE)
};
DwtControl.__mouseWheelHdlr=function(e){
var t=DwtControl.getTargetControl(e);
if(!t){
return false
}
return DwtControl.__mouseEvent(e,DwtEvent.ONMOUSEWHEEL,t)
};
DwtControl.__selectStartHdlr=function(e){
return DwtControl.__mouseEvent(e,DwtEvent.ONSELECTSTART)
};
DwtControl.__contextMenuHdlr=function(t){
if(AjxEnv.isSafari){
var a=DwtControl.getTargetControl(t);
var e=a?a.preventContextMenu():true;
if(e){
DwtControl.__mouseEvent(t,DwtEvent.ONMOUSEDOWN);
return DwtControl.__mouseEvent(t,DwtEvent.ONMOUSEUP)
}}
return DwtControl.__mouseEvent(t,DwtEvent.ONCONTEXTMENU)
};
DwtControl.__mouseEvent=function(o,t,n,a){
var n=n?n:DwtControl.getTargetControl(o);
if(!n){
return false
}
if(!a){
a=DwtShell.mouseEvent;
a.setFromDhtmlEvent(o,n)
}
var e=a.target.tagName.toLowerCase();
if(e!="input"&&e!="textarea"&&e!="a"){
a._stopPropagation=true;
a._returnValue=false
}else{
a._stopPropagation=false;
a._returnValue=true
}
DwtEventManager.notifyListeners(t,a);
if(n.isListenerRegistered&&n.isListenerRegistered(t)){
n.notifyListeners(t,a)
}
a.setToDhtmlEvent(o);
return a._returnValue
};
DwtControl.__HANDLER={};
DwtControl.__HANDLER[DwtEvent.ONCONTEXTMENU]=DwtControl.__contextMenuHdlr;
DwtControl.__HANDLER[DwtEvent.ONDBLCLICK]=DwtControl.__dblClickHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEDOWN]=DwtControl.__mouseDownHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEENTER]=DwtControl.__mouseEnterHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSELEAVE]=DwtControl.__mouseLeaveHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEMOVE]=DwtControl.__mouseMoveHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEOUT]=DwtControl.__mouseOutHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEOVER]=DwtControl.__mouseOverHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEUP]=DwtControl.__mouseUpHdlr;
DwtControl.__HANDLER[DwtEvent.ONMOUSEWHEEL]=DwtControl.__mouseWheelHdlr;
DwtControl.__HANDLER[DwtEvent.ONSELECTSTART]=DwtControl.__selectStartHdlr;
DwtControl.__HANDLER[DwtEvent.ONKEYPRESS]=DwtControl.__keyPressHdlr;
DwtControl.prototype.__initCtrl=function(){
this.shell=this.parent.shell||this.parent;
this._htmlElId=this.__internalId=this._htmlElId||Dwt.getNextId();
var e=this._elRef=this._createElement(this._htmlElId);
e.id=this._htmlElId;
if(DwtControl.ALL_BY_ID){
if(DwtControl.ALL_BY_ID[this._htmlElId]){
this._htmlElId=e.id=this.__internalId=DwtId._makeId(this._htmlElId,Dwt.getNextId())
}
DwtControl.ALL_BY_ID[this._htmlElId]=this
}
DwtComposite._pendingElements[this._htmlElId]=e;
if(this.__posStyle==null||this.__posStyle==DwtControl.STATIC_STYLE){
e.style.position=DwtControl.STATIC_STYLE
}else{
e.style.position=this.__posStyle
}
e.className=this._className;
e.style.overflow="visible";
this._enabled=true;
this.__controlEvent=DwtControl.__controlEvent;
this._dragging=DwtControl._NO_DRAG;
this.__ctrlInited=true;
this.parent.addChild(this,this.__index)
};
DwtControl.prototype._createElement=function(e){
return document.createElement("DIV")
};
DwtControl.prototype.__dndDoHover=function(e){
e._dragHover()
};
DwtControl.prototype.__badDropEffect=function(e,n,a){
var t=(Math.abs(e)<=1);
var o=t?this.__dragStartX-this.__dragEndX:this.__dragStartY-this.__dragEndY;
if(o*a>0&&!(this.__dragEndY==this.__dragStartY||this.__dragEndX==this.__dragStartX)){
if(t){
this.__dragEndX+=(30*a);
this._dndProxy.style.top=e*this.__dragEndX+n;
this._dndProxy.style.left=this.__dragEndX
}else{
this.__dragEndY+=(30*a);
this._dndProxy.style.top=this.__dragEndY;
this._dndProxy.style.left=(this.__dragEndY-n)/e
}
AjxTimedAction.scheduleAction(this.__badDropAction,0)
}else{
this._destroyDragProxy(this._dndProxy);
this._dragging=DwtControl._NO_DRAG
}};
DwtControl.prototype.__handleHoverOver=function(o){
if(this._eventMgr.isListenerRegistered(DwtEvent.HOVEROVER)){
this._eventMgr.notifyListeners(DwtEvent.HOVEROVER,o)
}
var a=o&&o.object;
var n=this.getToolTipContent(a);
var t,s;
if(!n){
t=""
}else{
if(typeof(n)=="string"){
t=n
}else{
if(n instanceof AjxCallback){
s=n
}else{
if(typeof(n)=="object"){
t=n.content;
s=n.callback
}}}}
if(!t&&s&&n.loading){
t=AjxMsg.loading
}
if(t){
this.__showToolTip(o,t)
}
if(s){
var e=new AjxCallback(this,this.__showToolTip,[o]);
AjxTimedAction.scheduleAction(new AjxTimedAction(null,function(){
s.run(e)
}
),0)
}};
DwtControl.prototype.__showToolTip=function(a,t){
if(!t){
return
}
var e=DwtShell.getShell(window);
var o=e.getToolTip();
o.setContent(t);
o.popup(a.x,a.y);
this.__lastTooltipX=a.x;
this.__lastTooltipY=a.y;
this.__tooltipClosed=false
};
DwtControl.prototype.__handleHoverOut=function(t){
if(this._eventMgr.isListenerRegistered(DwtEvent.HOVEROUT)){
this._eventMgr.notifyListeners(DwtEvent.HOVEROUT,t)
}
var e=DwtShell.getShell(window);
var a=e.getToolTip();
a.popdown();
this.__lastTooltipX=null;
this.__lastTooltipY=null
};
DwtControl.prototype.__isInputEl=function(a){
var o=false;
if(!a||!a.tagName){
return o
}
var e=a.tagName.toLowerCase();
var t=e=="input"?a.type.toLowerCase():null;
if(e=="textarea"||(t&&(t=="text"||t=="password"))){
o=true
}
return o
};
DwtControl.ON_UNLOAD=function(){
var t=DwtControl.ALL_BY_ID,e;
for(e in t){
t[e]._elRef=null
}
DwtControl.ALL_BY_ID=null
};
if(AjxEnv.isIE){
window.attachEvent("onunload",DwtControl.ON_UNLOAD)
}else{
window.addEventListener("unload",DwtControl.ON_UNLOAD,false)
}}
if(AjxPackage.define("ajax.dwt.widgets.DwtComposite")){
DwtComposite=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtComposite.PARAMS);
e.className=e.className||"DwtComposite";
DwtControl.call(this,e);
this._children=new AjxVector()
};
DwtComposite.PARAMS=DwtControl.PARAMS.concat();
DwtComposite.prototype=new DwtControl;
DwtComposite.prototype.constructor=DwtComposite;
DwtComposite._pendingElements=new Object();
DwtComposite.prototype.toString=function(){
return"DwtComposite"
};
DwtComposite.prototype.dispose=function(){
if(this._disposed){
return
}
var e=this._children.getArray();
while(e.length>0){
e[0].dispose()
}
DwtControl.prototype.dispose.call(this)
};
DwtComposite.prototype.getChildren=function(){
return this._children.getArray().slice(0)
};
DwtComposite.prototype.getNumChildren=function(){
return this._children.size()
};
DwtComposite.prototype.removeChildren=function(){
var e=this._children.getArray();
while(e.length>0){
e[0].dispose()
}};
DwtComposite.prototype.clear=function(){
this.removeChildren();
this.getHtmlElement().innerHTML=""
};
DwtComposite.prototype.addChild=function(a,e){
this._children.add(a,e);
var t=a.getHtmlElement();
t.setAttribute("parentId",this._htmlElId);
if(this instanceof DwtShell&&this.isVirtual()){
document.body.appendChild(t)
}else{
a.reparentHtmlElement(a.__parentElement||this.getHtmlElement(),e);
a.__parentElement=null
}};
DwtComposite.prototype.removeChild=function(a){
if(a.isInitialized()){
this._children.remove(a);
var t=a.getHtmlElement();
if(t){
t.removeAttribute("parentId");
if(t.parentNode){
var e=t.parentNode.removeChild(t)
}}}};
DwtComposite.prototype._setAllowSelection=function(){
if(!this._allowSelection){
this._allowSelection=true;
this.addListener(DwtEvent.ONMOUSEDOWN,new AjxListener(this,this._mouseDownListener));
this.addListener(DwtEvent.ONCONTEXTMENU,new AjxListener(this,this._contextMenuListener))
}};
DwtComposite.prototype.preventSelection=function(e){
return this._allowSelection?false:DwtControl.prototype.preventSelection.call(this,e)
};
DwtComposite.prototype.preventContextMenu=function(a){
if(!this._allowSelection){
return DwtControl.prototype.preventContextMenu.apply(this,arguments)
}
var e=a?(a.id.indexOf("OBJ_")==0):false;
var t=false;
if(document.selection){
t=document.selection.type=="Text"
}else{
if(getSelection()){
t=getSelection().toString().length>0
}}
return(t&&!e)?false:true
};
DwtComposite.prototype._focusByMouseUpEvent=function(){
if(!this._allowSelection){
DwtControl.prototype._focusByMouseUpEvent.apply(this,arguments)
}};
DwtComposite.prototype._mouseDownListener=function(e){
if(e.button==DwtMouseEvent.LEFT){
e._stopPropagation=true;
e._returnValue=true
}};
DwtComposite.prototype._contextMenuListener=function(e){
e._stopPropagation=false;
e._returnValue=true
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtShell")){
DwtShell=function(n){
if(window._dwtShellId){
throw new DwtException("DwtShell already exists for window",DwtException.INVALID_OP,"DwtShell")
}
var a=n.className||"DwtShell";
DwtComposite.call(this,{
className:a}
);
this.__ctrlInited=true;
document.body.style.margin=0;
if(!n.docBodyScrollable){
if(AjxEnv.isIE){
document.body.onscroll=DwtShell.__onBodyScroll
}
document.body.style.overflow="hidden"
}
document.body.onselect=DwtShell._preventDefaultSelectPrt;
document.body.onselectstart=DwtShell._preventDefaultSelectPrt;
document.body.oncontextmenu=DwtShell._preventDefaultPrt;
window.onresize=DwtShell._resizeHdlr;
var o=document.createElement("div");
this._htmlElId=window._dwtShellId=o.id=n.id||Dwt.getNextId();
DwtControl.ALL_BY_ID[this._htmlElId]=this;
o.className=a;
o.style.width=o.style.height="100%";
if(o.style.overflow){
o.style.overflow=null
}
try{
if(n.userShell){
document.body.removeChild(n.userShell)
}}
catch(t){}
document.body.appendChild(o);
if(n.userShell){
var e=new DwtControl({
parent:this,posStyle:Dwt.ABSOLUTE_STYLE}
);
e.getHtmlElement().appendChild(n.userShell);
e.setSize("100%","100%");
e.zShow(true)
}
this.shell=this;
this._createBusyOverlay(o);
this._veilOverlay=document.createElement("div");
this._veilOverlay.className=(!AjxEnv.isLinux)?"VeilOverlay":"VeilOverlay-linux";
this._veilOverlay.style.position="absolute";
this._veilOverlay.style.cursor=AjxEnv.isIE6up?"not-allowed":"wait";
Dwt.setBounds(this._veilOverlay,0,0,"100%","100%");
Dwt.setZIndex(this._veilOverlay,Dwt.Z_HIDDEN);
this._veilOverlay.veilZ=new Array();
this._veilOverlay.veilZ.push(Dwt.Z_HIDDEN);
this._veilOverlay.dialogZ=new Array();
this._veilOverlay.activeDialogs=new Array();
this._veilOverlay.innerHTML="<table cellspacing=0 cellpadding=0 style='width:100%; height:100%'><tr><td>&nbsp;</td></tr></table>";
o.appendChild(this._veilOverlay);
if(n.useCurtain){
this._curtainOverlay=document.createElement("div");
this._curtainOverlay.className="CurtainOverlay";
this._curtainOverlay.style.position="absolute";
Dwt.setBounds(this._curtainOverlay,0,0,"100%","100%");
Dwt.setZIndex(this._curtainOverlay,Dwt.Z_CURTAIN);
this._curtainOverlay.innerHTML="<table cellspacing=0 cellpadding=0 style='width:100%; height:100%'><tr><td>&nbsp;</td></tr></table>";
o.appendChild(this._curtainOverlay)
}
this._uiEvent=new DwtUiEvent(true);
this._currWinSize=Dwt.getWindowSize();
this._toolTip=new DwtToolTip(this);
this._hoverMgr=new DwtHoverMgr();
this._keyboardMgr=new DwtKeyboardMgr(this)
};
DwtShell.prototype=new DwtComposite;
DwtShell.prototype.constructor=DwtShell;
DwtShell.CANCEL_BUTTON=-1;
DwtShell.controlEvent=new DwtControlEvent();
DwtShell.focusEvent=new DwtFocusEvent();
DwtShell.keyEvent=new DwtKeyEvent();
DwtShell.mouseEvent=new DwtMouseEvent();
DwtShell.selectionEvent=new DwtSelectionEvent(true);
DwtShell.treeEvent=new DwtTreeEvent();
DwtShell.prototype.toString=function(){
return"DwtShell"
};
DwtShell.getShell=function(e){
return DwtControl.fromElementId(e._dwtShellId)
};
DwtShell.prototype.getKeyboardMgr=function(){
return this._keyboardMgr
};
DwtShell.prototype.setBusy=function(o,n,t,a,e){
if(o){
this._setBusyCount++
}else{
if(this._setBusyCount>0){
this._setBusyCount--
}}
if(!this._setBusy&&(this._setBusyCount>0)){
Dwt.setCursor(this._busyOverlay,"wait");
Dwt.setVisible(this._busyOverlay,true);
this._setBusy=this._blockInput=true
}else{
if(this._setBusy&&(this._setBusyCount<=0)){
Dwt.setCursor(this._busyOverlay,"default");
Dwt.setVisible(this._busyOverlay,false);
this._setBusy=this._blockInput=false
}}
if(o&&t){
if(a&&a>0){
this._busyActionId[n]=AjxTimedAction.scheduleAction(this._busyTimedAction,a)
}else{
this._showBusyDialogAction(n)
}
this._cancelBusyCallback=e;
if(this._busyDialog){
this._busyDialog.setButtonEnabled(DwtShell.CANCEL_BUTTON,(e!=null))
}}else{
if(this._busyActionId[n]&&(this._busyActionId[n]!=-1)){
AjxTimedAction.cancelAction(this._busyActionId[n]);
this._busyActionId[n]=-1
}
if(this._busyDialog&&this._busyDialog.isPoppedUp){
this._busyDialog.popdown()
}}};
DwtShell.prototype.getBusy=function(){
return this._setBusy
};
DwtShell.prototype.setBusyDialogText=function(e){
this._busyDialogText=e;
if(this._busyDialogTxt){
this._busyDialogTxt.innerHTML=(e)?e:""
}};
DwtShell.prototype.setBusyDialogTitle=function(e){
this._busyDialogTitle=e;
if(this._busyDialog){
this._busyDialog.setTitle((e)?e:AjxMsg.workInProgress)
}};
DwtShell.prototype.getHoverMgr=function(){
return this._hoverMgr
};
DwtShell.prototype.getToolTip=function(){
return this._toolTip
};
DwtShell.prototype.getH=function(e){
return(!this._virtual)?Dwt.getSize(this.getHtmlElement(),e).y:Dwt.getSize(document.body,e).y
};
DwtShell.prototype.getW=function(e){
return(!this._virtual)?Dwt.getSize(this.getHtmlElement(),e).x:Dwt.getSize(document.body,e).x
};
DwtShell.prototype.getSize=function(e){
return(!this._virtual)?Dwt.getSize(this.getHtmlElement(),e):Dwt.getSize(document.body,e)
};
DwtShell.prototype.getLocation=function(){
return(!this._virtual)?Dwt.getLocation(this.getHtmlElement()):Dwt.getLocation(document.body)
};
DwtShell.prototype.getX=function(){
return(!this._virtual)?Dwt.getLocation(this.getHtmlElement()).x:Dwt.getLocation(document.body).x
};
DwtShell.prototype.getY=function(){
return(!this._virtual)?Dwt.getLocation(this.getHtmlElement()).y:Dwt.getLocation(document.body).y
};
DwtShell.prototype.getBounds=function(e){
return(!this._virtual)?Dwt.getBounds(this.getHtmlElement(),e):Dwt.getBounds(document.body,e)
};
DwtShell.prototype.setVirtual=function(){
this._virtual=true;
this.setVisible(false)
};
DwtShell.prototype.addFocusListener=function(e){
if(!this._hasFocusHandler){
var t=document;
if(typeof t.onfocusin!="undefined"){
t.attachEvent("onfocusin",DwtShell.__focusHdlr)
}else{
window.addEventListener("focus",DwtShell.__focusHdlr,false)
}
this._hasFocusHandler=true
}
this.addListener(DwtEvent.ONFOCUS,e)
};
DwtShell.prototype.addBlurListener=function(e){
if(!this._hasBlurHandler){
var t=document;
if(typeof t.onfocusout!="undefined"){
t.attachEvent("onfocusout",DwtShell.__blurHdlr)
}else{
window.addEventListener("blur",DwtShell.__blurHdlr,false)
}
this._hasBlurHandler=true
}
this.addListener(DwtEvent.ONBLUR,e)
};
DwtShell.prototype.isVirtual=function(){
return this._virtual
};
DwtShell.prototype._showBusyDialogAction=function(t){
var e=this._getBusyDialog();
e.popup();
this._busyActionId[t]=-1
};
DwtShell.prototype._createBusyOverlay=function(e){
this._busyOverlay=document.createElement("div");
this._busyOverlay.className=(!AjxEnv.isLinux)?"BusyOverlay":"BusyOverlay-linux";
this._busyOverlay.style.position="absolute";
Dwt.setBounds(this._busyOverlay,0,0,"100%","100%");
Dwt.setZIndex(this._busyOverlay,Dwt.Z_VEIL);
this._busyOverlay.innerHTML="<table cellspacing=0 cellpadding=0 style='width:100%; height:100%'><tr><td>&nbsp;</td></tr></table>";
e.appendChild(this._busyOverlay);
Dwt.setVisible(this._busyOverlay,false);
this._busyTimedAction=new AjxTimedAction(this,this._showBusyDialogAction);
this._busyActionId={};
this._setBusyCount=0;
this._setBusy=false
};
DwtShell.prototype._getBusyDialog=function(a){
if(!this._busyDialog){
var o=new DwtDialog_ButtonDescriptor(DwtShell.CANCEL_BUTTON,AjxMsg.cancelRequest,DwtDialog.ALIGN_CENTER);
this._busyDialog=new DwtDialog({
parent:this,className:"DwtShellBusyDialog",title:AjxMsg.workInProgress,standardButtons:DwtDialog.NO_BUTTONS,extraButtons:[o],zIndex:Dwt.BUSY+10}
);
this._busyDialog.registerCallback(DwtShell.CANCEL_BUTTON,this._busyCancelButtonListener,this);
var t=Dwt.getNextId();
var e=["<table class='DialogContent'><tr>","<td><div class='WaitIcon'></div></td><td class='MsgText' id='",t,"'>&nbsp;</td>","</tr></table>"].join("");
this._busyDialog.setContent(e);
this._busyDialogTxt=document.getElementById(t);
if(this._busyDialogText){
this._busyDialogTxt.innerHTML=this._busyDialogText
}
if(this._busyDialogTitle){
this._busyDialog.setTitle(this._busyDialogTitle)
}
this._busyDialog.setButtonEnabled(DwtShell.CANCEL_BUTTON,(this._cancelBusyCallback!=null))
}
return this._busyDialog
};
DwtShell.prototype._busyCancelButtonListener=function(e){
this._cancelBusyCallback.run();
if(this._busyDialog){
this._busyDialog.popdown()
}};
DwtShell._preventDefaultSelectPrt=function(t){
var e=DwtControl.fromElementId(window._dwtShellId)._uiEvent;
e.setFromDhtmlEvent(t,true);
if(e.dwtObj&&e.dwtObj instanceof DwtControl&&!e.dwtObj.preventSelection(e.target)){
e._stopPropagation=false;
e._returnValue=true
}else{
e._stopPropagation=true;
e._returnValue=false
}
e.setToDhtmlEvent(t);
return !e._stopPropagation
};
DwtShell._preventDefaultPrt=function(t){
t=DwtUiEvent.getEvent(t);
var a=t.target?t.target:t.srcElement;
var e=DwtControl.fromElementId(window._dwtShellId)._uiEvent;
e.setFromDhtmlEvent(t,true);
e._stopPropagation=true;
e._returnValue=false;
if(e.dwtObj&&e.dwtObj instanceof DwtControl&&!e.dwtObj.preventContextMenu(e.target)){
e._stopPropagation=false;
e._returnValue=true
}else{
if(a!=null&&typeof(a)=="object"){
if((a.tagName=="A"||a.tagName=="a")&&a.href){
e._stopPropagation=false;
e._returnValue=true
}}}
e.setToDhtmlEvent(t);
return e._returnValue
};
DwtShell._resizeHdlr=function(a){
var t=DwtControl.fromElementId(window._dwtShellId);
if(t.isListenerRegistered(DwtEvent.CONTROL)){
var e=DwtShell.controlEvent;
e.reset();
e.oldWidth=t._currWinSize.x;
e.oldHeight=t._currWinSize.y;
t._currWinSize=Dwt.getWindowSize();
e.newWidth=t._currWinSize.x;
e.newHeight=t._currWinSize.y;
t.notifyListeners(DwtEvent.CONTROL,e)
}else{
t._currWinSize=Dwt.getWindowSize()
}};
DwtShell.__onBodyScroll=function(){
document.body.scrollTop=0;
document.body.scrollLeft=0
};
DwtShell.__focusHdlr=function(){
var t=DwtShell.focusEvent;
var e=DwtShell.getShell(window);
t.dwtObj=e;
t.state=DwtFocusEvent.FOCUS;
e.notifyListeners(DwtEvent.ONFOCUS,t)
};
DwtShell.__blurHdlr=function(){
var t=DwtShell.focusEvent;
var e=DwtShell.getShell(window);
t.dwtObj=e;
t.state=DwtFocusEvent.BLUR;
e.notifyListeners(DwtEvent.ONBLUR,t)
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtLabel")){
DwtLabel=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtLabel.PARAMS);
e.className=e.className||"DwtLabel";
DwtControl.call(this,e);
this._style=e.style||(DwtLabel.IMAGE_LEFT|DwtLabel.ALIGN_CENTER);
this._textBackground=null;
this._textForeground=null;
this._createHtml()
};
DwtLabel.PARAMS=["parent","style","className","posStyle","id","index"];
DwtLabel.prototype=new DwtControl;
DwtLabel.prototype.constructor=DwtLabel;
DwtLabel.prototype.toString=function(){
return"DwtLabel"
};
DwtLabel.IMAGE_LEFT=1;
DwtLabel.IMAGE_RIGHT=2;
DwtLabel.ALIGN_LEFT=4;
DwtLabel.ALIGN_RIGHT=8;
DwtLabel.ALIGN_CENTER=16;
DwtLabel._LAST_STYLE=16;
DwtLabel.prototype.TEMPLATE="dwt.Widgets#ZLabel";
DwtLabel.prototype.dispose=function(){
delete this._dropDownEl;
delete this._iconEl;
delete this._textEl;
DwtControl.prototype.dispose.call(this)
};
DwtLabel.prototype.setEnabled=function(e){
if(e!=this._enabled){
DwtControl.prototype.setEnabled.call(this,e);
this.__setImage(this.__imageInfo)
}};
DwtLabel.prototype.getImage=function(){
return this.__imageInfo
};
DwtLabel.prototype.setImage=function(e){
this.__imageInfo=e;
this.__setImage(e)
};
DwtLabel.prototype.setDisabledImage=function(e){};
DwtLabel.prototype.getText=function(){
return(this.__text!=null)?this.__text:null
};
DwtLabel.prototype.setText=function(e){
if(!this._textEl){
return
}
if(e==null||e==""){
this.__text=null;
this._textEl.innerHTML=""
}else{
this.__text=e;
this._textEl.innerHTML=e
}};
DwtLabel.prototype.setTextBackground=function(e){
this._textBackground=e;
if(this._textEl){
this._textEl.style.backgroundColor=e
}};
DwtLabel.prototype.setTextForeground=function(e){
this._textForeground=e;
if(this._textEl){
this._textEl.style.color=e
}};
DwtLabel.prototype.setAlign=function(e){
this._style=e;
this.__setImage(this.__imageInfo)
};
DwtLabel.prototype.isStyle=function(e){
return this._style&e
};
DwtLabel.prototype._createHtml=function(e){
var t={
id:this._htmlElId};
this._createHtmlFromTemplate(e||this.TEMPLATE,t)
};
DwtLabel.prototype._createHtmlFromTemplate=function(e,t){
DwtControl.prototype._createHtmlFromTemplate.call(this,e,t);
this._textEl=document.getElementById(t.id+"_title")
};
DwtLabel.prototype._getIconEl=function(){
var e=(this._style&DwtLabel.IMAGE_RIGHT?"right":"left");
return this._iconEl||(this._iconEl=document.getElementById(this._htmlElId+"_"+e+"_icon"))
};
DwtLabel.prototype.__setImage=function(t){
var e=this._getIconEl();
if(e){
if(t){
AjxImg.setImage(e,t,null,!this._enabled);
var a=(this._style&DwtLabel.IMAGE_RIGHT?"ZHasRightIcon":"ZHasLeftIcon");
Dwt.addClass(this.getHtmlElement(),a)
}else{
e.innerHTML=""
}}}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtListView")){
DwtListView=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtListView.PARAMS);
t.className=t.className||"DwtListView";
DwtComposite.call(this,t);
this._view=t.view||Dwt.getNextId();
if(t.headerList){
var e=this.getHtmlElement();
this._listColDiv=document.createElement("div");
this._listColDiv.id=DwtId.getListViewId(this._view,DwtId.LIST_VIEW_HEADERS);
this._listColDiv.className="DwtListView-ColHeader";
e.appendChild(this._listColDiv);
this._listDiv=document.createElement("div");
this._listDiv.id=DwtId.getListViewId(this._view,DwtId.LIST_VIEW_ROWS);
this._listDiv.className="DwtListView-Rows";
e.appendChild(this._listDiv);
this._bSortAsc=false;
this._currentColId=null;
this.sortingEnabled=true
}else{
this.setScrollStyle(DwtControl.SCROLL)
}
this._setMouseEventHdlrs();
this._listenerMouseOver=new AjxListener(this,this._mouseOverListener);
this._listenerMouseOut=new AjxListener(this,this._mouseOutListener);
this._listenerMouseDown=new AjxListener(this,this._mouseDownListener);
this._listenerMouseUp=new AjxListener(this,this._mouseUpListener);
this._listenerMouseMove=new AjxListener(this,this._mouseMoveListener);
this._listenerDoubleClick=new AjxListener(this,this._doubleClickListener);
this.addListener(DwtEvent.ONMOUSEOVER,this._listenerMouseOver);
this.addListener(DwtEvent.ONMOUSEOUT,this._listenerMouseOut);
this.addListener(DwtEvent.ONMOUSEDOWN,this._listenerMouseDown);
this.addListener(DwtEvent.ONMOUSEUP,this._listenerMouseUp);
this.addListener(DwtEvent.ONMOUSEMOVE,this._listenerMouseMove);
this.addListener(DwtEvent.ONDBLCLICK,this._listenerDoubleClick);
this._evtMgr=new AjxEventMgr();
this._selectedItems=new AjxVector();
this._selAnchor=null;
this._kbAnchor=null;
this._selEv=new DwtSelectionEvent(true);
this._actionEv=new DwtListViewActionEvent(true);
this._stateChangeEv=new DwtEvent(true);
this._headerList=t.headerList;
this._noMaximize=t.noMaximize;
this._parentEl=this._headerList?this._listDiv:this.getHtmlElement();
this._list=null;
this.offset=0;
this.headerColCreated=false;
this.multiSelectEnabled=true;
this.firstSelIndex=-1;
this._data={};
this._rowClass=[this._className,DwtListView.ROW_CLASS].join("");
var a=this._normalClass=DwtListView.ROW_CLASS;
this._selectedClass=[a,DwtCssStyle.SELECTED].join("-");
this._disabledSelectedClass=[this._selectedClass,DwtCssStyle.DISABLED].join("-");
this._kbFocusClass=[a,DwtCssStyle.FOCUSED].join("-");
this._dndClass=[a,DwtCssStyle.DRAG_PROXY].join("-");
this._rightClickClass=[this._selectedClass,DwtCssStyle.ACTIONED].join("-");
this._styleRe=this._getStyleRegex()
};
DwtListView.prototype=new DwtComposite;
DwtListView.prototype.constructor=DwtListView;
DwtListView.PARAMS=["parent","className","posStyle","headerList","noMaximize"];
DwtListView.ITEM_SELECTED=1;
DwtListView.ITEM_DESELECTED=2;
DwtListView.ITEM_DBL_CLICKED=3;
DwtListView._LAST_REASON=3;
DwtListView._TOOLTIP_DELAY=250;
DwtListView.HEADERITEM_HEIGHT=24;
DwtListView.TYPE_HEADER_ITEM="1";
DwtListView.TYPE_LIST_ITEM="2";
DwtListView.TYPE_HEADER_SASH="3";
DwtListView.DEFAULT_LIMIT=25;
DwtListView.MAX_REPLENISH_THRESHOLD=10;
DwtListView.MIN_COLUMN_WIDTH=20;
DwtListView.COL_MOVE_THRESHOLD=3;
DwtListView.ROW_CLASS="Row";
DwtListView.ROW_CLASS_ODD="RowEven";
DwtListView.ROW_CLASS_EVEN="RowOdd";
DwtListView._STYLE_CLASS="_sc";
DwtListView._SELECTED_STYLE_CLASS="_ssc";
DwtListView._SELECTED_DIS_STYLE_CLASS="_sdsc";
DwtListView._KBFOCUS_CLASS="_kfc";
DwtListView.prototype.toString=function(){
return"DwtListView"
};
DwtListView.prototype.dispose=function(){
this._listColDiv=null;
this._listDiv=null;
this._parentEl=null;
this._clickDiv=null;
this._selectedItems=null;
DwtComposite.prototype.dispose.call(this)
};
DwtListView.prototype.setEnabled=function(e){
DwtComposite.prototype.setEnabled.call(this,e);
this.removeListener(DwtEvent.ONMOUSEOVER,this._listenerMouseOver);
this.removeListener(DwtEvent.ONMOUSEOUT,this._listenerMouseOut);
this.removeListener(DwtEvent.ONMOUSEDOWN,this._listenerMouseDown);
this.removeListener(DwtEvent.ONMOUSEUP,this._listenerMouseUp);
this.removeListener(DwtEvent.ONMOUSEMOVE,this._listenerMouseMove);
this.removeListener(DwtEvent.ONDBLCLICK,this._listenerDoubleClick);
if(e){
this.addListener(DwtEvent.ONMOUSEOVER,this._listenerMouseOver);
this.addListener(DwtEvent.ONMOUSEOUT,this._listenerMouseOut);
this.addListener(DwtEvent.ONMOUSEDOWN,this._listenerMouseDown);
this.addListener(DwtEvent.ONMOUSEUP,this._listenerMouseUp);
this.addListener(DwtEvent.ONMOUSEMOVE,this._listenerMouseMove);
this.addListener(DwtEvent.ONDBLCLICK,this._listenerDoubleClick)
}
var a=this.getSelectedItems();
if(a){
var o=a.getArray();
for(var t=0;
t<o.length;
t++){
Dwt.delClass(o[t],this._styleRe,e?this._selectedClass:this._disabledSelectedClass)
}}};
DwtListView.prototype.createHeaderHtml=function(u){
if(!this._headerList||this.headerColCreated){
return
}
this._headerHash={};
this._headerIdHash={};
var m=0;
var p=[];
p[m++]="<table id='";
p[m++]=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_TABLE,this._view);
p[m++]="' cellpadding=0 cellspacing=0 border=0 height=100%";
p[m++]=this._noMaximize?">":" width=100%>";
p[m++]="<tr>";
var o=this._headerList.length;
for(var s=0;
s<o;
s++){
var c=this._headerList[s];
var d=c._field;
c._index=s;
var t=c._id=DwtId.getListViewHdrId(DwtId.WIDGET_HDR,this._view,d);
this._headerHash[d]=c;
this._headerIdHash[t]=c;
if(c._variable){
this._variableHeaderCol=c
}
if(c._visible){
m=this._createHeader(p,m,c,s,o,t,u)
}}
p[m++]="</tr></table>";
this._listColDiv.innerHTML=p.join("");
var e=0,h;
for(var n=0;
n<this._headerList.length;
n++){
var c=this._headerList[n];
var f=document.getElementById(c._id);
if(!f){
continue
}
if(c._sortable&&c._field==u){
f.className="DwtListView-Column DwtListView-ColumnActive"
}
if(c._resizeable){
var r=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_SASH,this._view,c._field);
var a=document.getElementById(r);
if(a){
this.associateItemWithElement(c,a,DwtListView.TYPE_HEADER_SASH,r,{
index:n}
)
}
e++;
h=c
}
this.associateItemWithElement(c,f,DwtListView.TYPE_HEADER_ITEM,c._id,{
index:n}
)
}
if(e==1){
h._resizeable=false
}
this.headerColCreated=true
};
DwtListView.prototype._createHeader=function(m,u,h,n,o,t,d){
var c=h._field;
m[u++]="<td id='";
m[u++]=t;
m[u++]="' class='";
m[u++]=(t==this._currentColId)?"DwtListView-Column DwtListView-ColumnActive'":"DwtListView-Column'";
if(h._width){
m[u++]=" width=";
m[u++]=h._width;
if(h._widthUnits){
m[u++]=h._widthUnits
}}
m[u++]=">";
m[u++]="<div";
var s=null;
if(h._width&&h._width!="auto"){
if(AjxEnv.isIE){
s=h._width
}else{
s=h._width+2
}
if(h._widthUnits){
s+=h._widthUnits
}}
if(!!s){
m[u++]=" style='overflow: hidden; width: ";
m[u++]=s;
m[u++]="'>"
}else{
m[u++]=">"
}
m[u++]="<table border=0 cellpadding=0 cellspacing=0 width=100%><tr>";
if(h._iconInfo){
var r=["id='",DwtId.getListViewHdrId(DwtId.WIDGET_HDR_ICON,this._view,c),"'"].join("");
m[u++]="<td><center>";
m[u++]=AjxImg.getImageHtml(h._iconInfo,null,r);
m[u++]="</center></td>"
}
if(h._label){
m[u++]="<td id='";
m[u++]=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_LABEL,this._view,c);
m[u++]="' class='DwtListHeaderItem-label'>";
m[u++]=h._label;
m[u++]="</td>"
}
if(h._sortable&&!h._noSortArrow){
var e=this._bSortAsc?"ColumnUpArrow":"ColumnDownArrow";
m[u++]="<td align=right style='padding-right:2px' width=100% id='";
m[u++]=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_ARROW,this._view,c);
m[u++]="'>";
var a=(c==d);
m[u++]=AjxImg.getImageHtml(e,a?null:"visibility:hidden");
m[u++]="</td>";
if(a){
this._currentColId=t
}}
if(n<(o-1)){
m[u++]="<td width=4>";
m[u++]="<table align=right border=0 cellpadding=0 cellspacing=0 width=2 height=100%><tr>";
m[u++]="<td class='DwtListView-Sash'><div style='width: 1px; height: ";
m[u++]=(DwtListView.HEADERITEM_HEIGHT-2);
m[u++]="px; background-color: #8A8A8A'></div></td><td id='";
m[u++]=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_SASH,this._view,c);
m[u++]="' class='DwtListView-Sash'><div style='width: 1px; height: ";
m[u++]=(DwtListView.HEADERITEM_HEIGHT-2);
m[u++]="px; background-color: #FFFFFF'></div></td></tr></table>";
m[u++]="</td>"
}
m[u++]="</tr></table>";
m[u++]="</div></td>";
return u
};
DwtListView.prototype.getItemIndex=function(a){
var o=this._list;
if(o){
var e=o.size();
for(var t=0;
t<e;
++t){
if(o.get(t).id==a.id){
return t
}}}
return null
};
DwtListView.prototype.setSize=function(t,e){
DwtComposite.prototype.setSize.call(this,t,e);
this._sizeChildren(e)
};
DwtListView.prototype.size=function(){
return this._list?this._list.size():0
};
DwtListView.prototype.set=function(a,t,e){
if(this._selectedItems){
this._selectedItems.removeAll()
}
this._rightSelItem=null;
this.sortingEnabled=true;
this._resetList();
this._list=a;
this.setUI(t,e)
};
DwtListView.prototype.setUI=function(t,e){
this.removeAll();
this.createHeaderHtml(t);
this._renderList(this._list,e)
};
DwtListView.prototype._renderList=function(r,s,a){
if(r instanceof AjxVector&&r.size()){
var t=new Date();
var d=r.size();
var h=[];
for(var n=0;
n<d;
n++){
var c=r.get(n);
var e=this._createItemHtml(c,{
now:t}
,!a,n);
if(e){
if(e instanceof Array){
for(var o=0;
o<e.length;
o++){
this._addRow(e[o])
}}else{
if(e.tagName||a){
this._addRow(e)
}else{
h.push(e)
}}}}
if(h.length){
this._parentEl.innerHTML=h.join("")
}}else{
if(!s){
this._setNoResultsHtml()
}}};
DwtListView.prototype.addItems=function(e){
if(AjxUtil.isArray(e)){
if(!this._list){
this._list=new AjxVector()
}
if(this._list.size()==0){
this._resetList()
}
this._renderList(AjxVector.fromArray(e),null,true);
this._list.addList(e)
}};
DwtListView.prototype.addItem=function(n,t,a,o){
if(!this._list){
this._list=new AjxVector()
}
if(this._list.size()==0){
this._resetList()
}
this._list.add(n,(o!=null)?o:t);
var s=this._createItemHtml(n);
if(s){
if(s instanceof Array){
for(var e=0;
e<s.length;
e++){
this._addRow(s[e])
}}else{
this._addRow(s,t)
}}
if(!a&&this._evtMgr.isListenerRegistered(DwtEvent.STATE_CHANGE)){
this._evtMgr.notifyListeners(DwtEvent.STATE_CHANGE,this._stateChangeEv)
}};
DwtListView.prototype.removeItem=function(o,t){
var e=this._getElFromItem(o);
if(!e){
return
}
var a=e.nextSibling;
if(a){
var n=Boolean(e.className&&(e.className.indexOf(DwtListView.ROW_CLASS_ODD)!=-1));
while(a){
n=!n;
var s=n?DwtListView.ROW_CLASS_ODD:DwtListView.ROW_CLASS_EVEN;
var r=n?DwtListView.ROW_CLASS_EVEN:DwtListView.ROW_CLASS_ODD;
Dwt.delClass(a,s,r);
a=a.nextSibling
}}
this._selectedItems.remove(e);
if(this._rightSelItem==e){
this._rightSelItem=null
}
if(this._kbAnchor==e){
this._kbAnchor=null
}
this._parentEl.removeChild(e);
if(this._list){
this._list.remove(o)
}
var h=e.id;
if(this._data[h]){
this._data[h]=null;
delete this._data[h]
}
if(!t&&this._evtMgr.isListenerRegistered(DwtEvent.STATE_CHANGE)){
this._evtMgr.notifyListeners(DwtEvent.STATE_CHANGE,this._stateChangeEv)
}};
DwtListView.prototype.redrawItem=function(o){
var n=this._getElFromItem(o);
if(n){
var s=this._createItemHtml(o);
n.parentNode.replaceChild(s,n);
var a=this.getSelectedItems().getArray();
for(var t=0;
t<a.length;
t++){
var e=a[t];
if(e===o){
this.setSelectedItems([].concat(a));
break
}}}};
DwtListView.prototype.addSelectionListener=function(e){
this._evtMgr.addListener(DwtEvent.SELECTION,e)
};
DwtListView.prototype.removeSelectionListener=function(e){
this._evtMgr.removeListener(DwtEvent.SELECTION,e)
};
DwtListView.prototype.addActionListener=function(e){
this._evtMgr.addListener(DwtEvent.ACTION,e)
};
DwtListView.prototype.removeActionListener=function(e){
this._evtMgr.removeListener(DwtEvent.ACTION,e)
};
DwtListView.prototype.addStateChangeListener=function(e){
this._evtMgr.addListener(DwtEvent.STATE_CHANGE,e)
};
DwtListView.prototype.removeStateChangeListener=function(e){
this._evtMgr.removeListener(DwtEvent.STATE_CHANGE,e)
};
DwtListView.prototype.removeAll=function(e){
if(this._parentEl){
this._parentEl.innerHTML=""
}
if(this._selectedItems){
this._selectedItems.removeAll()
}
this._rightSelItem=this._selAnchor=this._kbAnchor=null;
if(!e&&this._evtMgr.isListenerRegistered(DwtEvent.STATE_CHANGE)){
this._evtMgr.notifyListeners(DwtEvent.STATE_CHANGE,this._stateChangeEv)
}};
DwtListView.prototype.selectAll=function(){
if(this._list&&this._list.size()){
this.setSelectedItems(this._list.getArray())
}};
DwtListView.prototype.deselectAll=function(){
var e=this._selectedItems.getArray();
var o=this._selectedItems.size();
for(var t=0;
t<o;
t++){
Dwt.delClass(e[t],this._styleRe)
}
this._selectedItems.removeAll();
this._rightSelItem=this._selAnchor=null;
if(this._kbAnchor!=null&&this.hasFocus()){
Dwt.addClass(this._kbAnchor,this._kbFocusClass)
}};
DwtListView.prototype.getDnDSelection=function(){
if(this._dndSelection instanceof AjxVector){
return this.getSelection()
}else{
return this.getItemFromElement(this._dndSelection)
}};
DwtListView.prototype.getSelection=function(){
var t=[];
if(this._rightSelItem){
t.push(this.getItemFromElement(this._rightSelItem))
}else{
if(this._selectedItems){
var e=this._selectedItems.getArray();
var n=this._selectedItems.size();
for(var o=0;
o<n;
o++){
t[o]=this.getItemFromElement(e[o])
}}}
return t
};
DwtListView.prototype.getSelectedItems=function(){
return this._selectedItems
};
DwtListView.prototype.setSelection=function(a,e){
if(!a){
return
}
var t=this._getElFromItem(a);
if(t){
if((this._selectedItems.size()==1)&&(this._selectedItems.get(0)==t)){
return
}
this.deselectAll();
this._unmarkKbAnchorElement(true);
this._selectedItems.add(t);
this._selAnchor=this._kbAnchor=t;
Dwt.delClass(t,this._styleRe,this.getEnabled()?this._selectedClass:this._disabledSelectedClass);
if(this.hasFocus()){
Dwt.addClass(t,this._kbFocusClass)
}
this.firstSelIndex=(this._list&&this._list.size()>0)?this._list.indexOf(a):-1;
this._scrollList(t);
if(!e&&this._evtMgr.isListenerRegistered(DwtEvent.SELECTION)){
var o=new DwtSelectionEvent(true);
o.button=DwtMouseEvent.LEFT;
o.target=t;
o.item=this.getItemFromElement(t);
o.detail=DwtListView.ITEM_SELECTED;
o.ersatz=true;
this._evtMgr.notifyListeners(DwtEvent.SELECTION,o)
}}};
DwtListView.prototype.setMultiSelection=function(e,n,a){
if(n){
this._selectedItems.remove(e);
Dwt.delClass(e,this._styleRe);
this._selEv.detail=DwtListView.ITEM_DESELECTED
}else{
this._selectedItems.add(e,null,true);
Dwt.delClass(e,this._styleRe,this._selectedClass);
this._selEv.detail=DwtListView.ITEM_SELECTED
}
if(this._kbAnchor&&this._kbAnchor!=e){
var o=this._kbAnchor;
var t=this._selectedClass;
if(o.className.indexOf(t)!=-1){
Dwt.delClass(o,this._styleRe,t)
}else{
Dwt.delClass(o,this._styleRe)
}}
this._selAnchor=this._kbAnchor=e;
Dwt.addClass(this._kbAnchor,this._kbFocusClass)
};
DwtListView.prototype.setSelectedItems=function(a){
this.deselectAll();
var o=a.length;
for(var e=0;
e<o;
++e){
var t=this._getElFromItem(a[e]);
if(t){
Dwt.delClass(t,this._styleRe,this.getEnabled()?this._selectedClass:this._disabledSelectedClass);
if(this._kbAnchor==t&&this.hasFocus()){
Dwt.addClass(t,this._kbFocusClass)
}
this._selectedItems.add(t)
}}};
DwtListView.prototype.getSelectionCount=function(){
return this._rightSelItem?1:this._selectedItems.size()
};
DwtListView.prototype.handleActionPopdown=function(){
this._clearRightSel()
};
DwtListView.prototype.associateItemWithElement=function(o,t,a,s,n){
s=s||this._getItemId(o);
if(t){
t.id=s
}
a=a||DwtListView.TYPE_LIST_ITEM;
this._data[s]={
item:o,id:s,type:a};
if(n){
for(var e in n){
this._data[s][e]=n[e]
}}
return s
};
DwtListView.prototype.getItemFromElement=function(e){
return this._getItemData(e,"item")
};
DwtListView.prototype.findItem=function(e){
if(!e){
return
}
var t=this.findItemDiv(e);
return this._getItemData(t,"item")
};
DwtListView.prototype.findItemDiv=function(e){
if(!e){
return
}
while(e&&(e.id!=this._htmlElId)){
if(e.id&&this._data[e.id]){
return e
}
e=e.parentNode
}
return null
};
DwtListView.prototype.getTargetItem=function(e){
return this.findItem(DwtUiEvent.getTarget(e))
};
DwtListView.prototype.getTargetItemDiv=function(e){
return this.findItemDiv(DwtUiEvent.getTarget(e))
};
DwtListView.prototype.dragSelect=function(t){
if(this._dragHighlight){
var e=document.getElementById(this._dragHighlight);
if(!t||t.id!=e.id){
this._updateDragSelection(e,false)
}}
if(!t){
return
}
if(this._getItemData(t,"type")!=DwtListView.TYPE_LIST_ITEM){
return
}
if(t.id!=this._dragHighlight){
this._dragHighlight=t.id;
this._updateDragSelection(t,true)
}};
DwtListView.prototype.dragDeselect=function(t){
if(this._dragHighlight){
var e=document.getElementById(this._dragHighlight);
this._updateDragSelection(e,false);
this._dragHighlight=null
}};
DwtListView.prototype.scrollToTop=function(){
this._listDiv.scrollTop=0
};
DwtListView.prototype.setSortByAsc=function(a,t){
if(!this._headerList){
return
}
this._bSortAsc=t;
var o=null;
for(var e=0;
e<this._headerList.length;
e++){
if(this._headerList[e]._sortable&&this._headerList[e]._field==a){
o=this._headerList[e]._id;
break
}}
if(o){
this._setSortedColStyle(o)
}};
DwtListView.prototype.getNewOffset=function(t){
var e=this.getLimit();
var a=t?(this.offset+e):(this.offset-e);
return(a<0)?0:a
};
DwtListView.prototype.getLimit=function(){
return DwtListView.DEFAULT_LIMIT
};
DwtListView.prototype.getReplenishThreshold=function(){
return DwtListView.MAX_REPLENISH_THRESHOLD
};
DwtListView.prototype.getList=function(){
return this._list
};
DwtListView.prototype.replenish=function(o){
this._list.addList(o);
var t=o.size();
for(var e=0;
e<t;
e++){
var a=o.get(e);
var n=this._createItemHtml(a);
if(n){
this._addRow(n)
}}};
DwtListView.prototype.getKeyMapName=function(){
return"DwtListView"
};
DwtListView.prototype.handleKeyAction=function(n,h){
switch(n){
case DwtKeyMap.SELECT:this._emulateSingleClick({
target:this._kbAnchor,button:DwtMouseEvent.LEFT,kbNavEvent:true}
);
break;
case DwtKeyMap.SELECT_CURRENT:this._emulateSingleClick({
target:this._kbAnchor,button:DwtMouseEvent.LEFT,ctrlKey:true,kbNavEvent:true}
);
break;
case DwtKeyMap.SELECT_NEXT:this._selectItem(true,false,true);
break;
case DwtKeyMap.SELECT_PREV:this._selectItem(false,false,true);
break;
case DwtKeyMap.ADD_SELECT_NEXT:this._selectItem(true,true,true);
break;
case DwtKeyMap.ADD_SELECT_PREV:this._selectItem(false,true,true);
break;
case DwtKeyMap.PREV:this._setKbFocusElement(false);
break;
case DwtKeyMap.NEXT:this._setKbFocusElement(true);
break;
case DwtKeyMap.DBLCLICK:if(!this._kbAnchor){
break
}
var t=false;
var d=this.getSelectedItems().getArray();
for(var o=0;
o<d.length;
o++){
if(d[o]==this._kbAnchor){
t=true;
break
}}
if(t){
this.emulateDblClick(this.getItemFromElement(this._kbAnchor),true)
}else{
this._emulateSingleClick({
target:this._kbAnchor,button:DwtMouseEvent.LEFT,kbNavEvent:true}
)
}
break;
case DwtKeyMap.SELECT_ALL:this.selectAll();
break;
case DwtKeyMap.SELECT_FIRST:case DwtKeyMap.SELECT_LAST:var u=(n==DwtKeyMap.SELECT_FIRST)?this._getFirstItem():this._getLastItem();
if(u){
this.setSelection(u);
this._scrollList(this._kbAnchor)
}
break;
case DwtKeyMap.ACTION:if(this._evtMgr.isListenerRegistered(DwtEvent.ACTION)){
var e=Dwt.toWindow(this._kbAnchor,0,0);
var m=Dwt.getSize(this._kbAnchor);
var c=e.x+m.x/4;
var r=e.y+m.y/2;
this._emulateSingleClick({
target:this._kbAnchor,button:DwtMouseEvent.RIGHT,docX:c,docY:r,kbNavEvent:true}
)
}
break;
default:return false
}
return true
};
DwtListView.prototype.setMultiSelect=function(e){
this.multiSelectEnabled=e
};
DwtListView.prototype.isMultiSelectEnabled=function(){
return this.multiSelectEnabled
};
DwtListView.prototype.setListDivHeight=function(a){
if(this._listDiv&&this._listColDiv){
var t=Dwt.getSize(this._listColDiv).y;
var e=a-t;
Dwt.setSize(this._listDiv,Dwt.DEFAULT,e)
}};
DwtListView.prototype._getStyleRegex=function(){
return new RegExp("\\b("+[this._disabledSelectedClass,this._selectedClass,this._kbFocusClass,this._dndClass,this._rightClickClass].join("|")+")\\b","g")
};
DwtListView.prototype._addRow=function(h,t){
if(!h||!this._parentEl){
return
}
var e=this._parentEl.childNodes.length;
var o=Boolean((t!=null?t:e)%2);
var n=o?DwtListView.ROW_CLASS_ODD:DwtListView.ROW_CLASS_EVEN;
var r=o?DwtListView.ROW_CLASS_EVEN:DwtListView.ROW_CLASS_ODD;
Dwt.delClass(h,n,r);
if(t!=null&&e>0&&t!=e){
var s=this._parentEl.childNodes;
this._parentEl.insertBefore(h,s[t]);
var a=h.nextSibling;
while(a){
o=!o;
n=o?DwtListView.ROW_CLASS_ODD:DwtListView.ROW_CLASS_EVEN;
r=o?DwtListView.ROW_CLASS_EVEN:DwtListView.ROW_CLASS_ODD;
Dwt.delClass(a,n,r);
a=a.nextSibling
}}else{
this._parentEl.appendChild(h)
}};
DwtListView.prototype._createItemHtml=function(d,a,s,n){
a=a||{};
this._addParams(d,a,c,h);
var e;
var c=[];
var h=0;
if(s){
h=this._getDivHtml(d,a,c,h,n)
}else{
e=a.div||this._getDiv(d,a)
}
h=this._getTable(c,h,a);
h=this._getRow(c,h,d,a);
var t=a.headerList||this._headerList;
if(t&&t.length){
for(var o=0;
o<t.length;
o++){
if(!t[o]._visible){
continue
}
var r=t[o]._field;
h=this._getCell(c,h,d,r,o,a)
}}else{
h=this._getCell(c,h,d,null,null,a)
}
c[h++]="</tr></table>";
if(s){
c[h++]="</div>";
return c.join("")
}
e.innerHTML=c.join("");
return e
};
DwtListView.prototype._addParams=function(e,t){};
DwtListView.prototype._getDiv=function(e,t){
var o=document.createElement("div");
if(t.isDragProxy&&AjxEnv.isMozilla){
o.style.overflow="visible"
}
o.className=this._getDivClass(this._normalClass,e,t);
if(t.isDragProxy){
Dwt.setPosition(o,Dwt.ABSOLUTE_STYLE)
}
var a=t.isDragProxy?this._getItemId(e)+"_dnd":null;
this.associateItemWithElement(e,o,null,a);
return o
};
DwtListView.prototype._getDivHtml=function(n,s,t,e,o){
t[e++]="<div class='";
t[e++]=this._getDivClass(this._normalClass,n,s);
t[e++]=" ";
t[e++]=(o%2)?DwtListView.ROW_CLASS_EVEN:DwtListView.ROW_CLASS_ODD;
t[e++]="'";
var a=[];
if(s.isDragProxy&&AjxEnv.isMozilla){
a.push("overflow:visible")
}
if(s.isDragProxy){
a.push("position:absolute")
}
if(a.length){
t[e++]=" style='";
t[e++]=a.join(";");
t[e++]="'"
}
var r=s.isDragProxy?this._getItemId(n)+"_dnd":null;
t[e++]=" id='";
t[e++]=this.associateItemWithElement(n,null,null,r);
t[e++]="'>";
return e
};
DwtListView.prototype._getDivClass=function(t,e,a){
return a.isDragProxy?([t," ",t,"-",DwtCssStyle.DRAG_PROXY].join("")):t
};
DwtListView.prototype._getTable=function(t,e,a){
t[e++]="<table cellpadding=0 cellspacing=0 border=0 width=";
t[e++]=!a.isDragProxy?"100%>":(this.getSize().x+">");
return e
};
DwtListView.prototype._getRow=function(t,e,o,s){
var n=this._getRowId(o,s)||Dwt.getNextId();
var a=this._getRowClass(o,s);
t[e++]=n?["<tr id='",n,"'"].join(""):"<tr";
t[e++]=a?([" class='",a,"'>"].join("")):">";
return e
};
DwtListView.prototype._getRowClass=function(e,t){
return null
};
DwtListView.prototype._getRowId=function(e,t){
return null
};
DwtListView.prototype._getCell=function(p,f,y,u,n,o){
var a=this._getCellId(y,u,o);
var m=a?[" id=","'",a,"'"].join(""):"";
var t=this._getCellWidth(n,o);
var h=t?([" width=",t].join("")):(" width='100%'");
var c=this._getCellClass(y,u,o);
var s=c?[" class=",c].join(""):"";
var g=this._getCellAlign(n,o);
var d=g?[" align=",g].join(""):"";
var e=(this._getCellAttrText(y,u,o))||"";
var r=[m,h,s,d,e].join(" ");
p[f++]="<td";
p[f++]=r?(" "+r):"";
p[f++]=">";
f=this._getCellContents(p,f,y,u,n,o);
p[f++]="</td>";
return f
};
DwtListView.prototype._getCellWidth=function(o,a){
if(o==null){
return null
}
var e=a.headerList||this._headerList;
var t=e[o]._width;
if(t){
if(AjxEnv.isIE){
return(t+2)
}
if(AjxEnv.isSafari){
return(t+5)
}
return t
}
return null
};
DwtListView.prototype._getCellAlign=function(a,t){
if(a==null){
return null
}
var e=t.headerList||this._headerList;
return e[a]._align
};
DwtListView.prototype._getCellId=function(e,t,a){
return null
};
DwtListView.prototype._getCellClass=function(e,t,a){
return null
};
DwtListView.prototype._getCellAttrText=function(e,t,a){
return null
};
DwtListView.prototype._getCellContents=function(t,e,a,o,s,n){
t[e++]=a.toString?a.toString():a;
return e
};
DwtListView.prototype._getFieldId=function(e,t){
return DwtId.getListViewItemId(DwtId.WIDGET_ITEM_FIELD,this._view,e.id,t)
};
DwtListView.prototype._getElement=function(e,t){
return document.getElementById(this._getFieldId(e,t))
};
DwtListView.prototype._getDragProxy=function(o){
var n=this.getDnDSelection();
if(!n){
return null
}
var r;
var e;
var t;
this._dndImg=null;
if(!(n instanceof Array)||n.length==1){
var c=(n instanceof Array)?n[0]:n;
r=this._createItemHtml(c,{
now:new Date(),isDragProxy:true}
);
this._setItemData(r,"origClassName",r.className);
Dwt.setPosition(r,Dwt.ABSOLUTE_STYLE);
t="position:absolute;top:18;left:-11;visibility:hidden"
}else{
r=document.createElement("div");
r.className="DragProxy";
Dwt.setPosition(r,Dwt.ABSOLUTE_STYLE);
AjxImg.setImage(r,"DndMultiYes_48");
this._dndImg=r;
e=document.createElement("div");
Dwt.setPosition(e,Dwt.ABSOLUTE_STYLE);
var h=this.allSelected?ZmMsg.all:n.length;
e.innerHTML="<table><tr><td class='DragProxyTextLabel'>"+h+"</td></tr></table>";
r.appendChild(e);
t="position:absolute;top:30;left:0;visibility:hidden";
Dwt.setBounds(r,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE,43+32-16,36+32-20)
}
var a=AjxImg.getImageHtml("RoundPlus",t,"id="+DwtId.DND_PLUS_ID);
if(!this._noDndPlusImage){
r.appendChild(Dwt.parseHtmlFragment(a))
}
this.shell.getHtmlElement().appendChild(r);
if(e){
var s=Dwt.getSize(e);
Dwt.setLocation(e,16+(32-s.x)/2,19+(32-s.y)/2)
}
Dwt.setZIndex(r,Dwt.Z_DND);

return r
};
DwtListView.prototype._setDragProxyState=function(t){
if(this._dndImg){
AjxImg.setImage(this._dndImg,t?"DndMultiYes_48":"DndMultiNo_48")
}else{
if(this._dndProxy){
var a=t?DwtCssStyle.DROPPABLE:DwtCssStyle.NOT_DROPPABLE;
var e=this._getItemData(this._dndProxy,"origClassName");
this._dndProxy.className=[e,a].join(" ")
}}};
DwtListView.prototype._setNoResultsHtml=function(){
var t=document.createElement("div");
var e={
message:this._getNoResultsMessage(),type:this.type};
t.innerHTML=AjxTemplate.expand("dwt.Widgets#DwtListView-NoResults",e);
this._addRow(t)
};
DwtListView.prototype._getNoResultsMessage=function(){
return AjxMsg.noResults
};
DwtListView.prototype._clearRightSel=function(){
if(this._rightSelItem){
Dwt.delClass(this._rightSelItem,this._styleRe);
this._rightSelItem=null
}};
DwtListView.prototype._getItemId=function(e){
return DwtId.getListViewItemId(DwtId.WIDGET_ITEM,this._view,(e&&e.id)?e.id:Dwt.getNextId())
};
DwtListView.prototype._getElFromItem=function(e){
return Dwt.byId(this._getItemId(e))
};
DwtListView.prototype._getRowIndex=function(t){
var o=this._getItemId(t);
var a=this._parentEl.childNodes;
for(var e=0;
e<a.length;
e++){
if(a[e].id==o){
return e
}}
return null
};
DwtListView.prototype._getItemData=function(e,a,o){
o=o||(e?e.id:null);
var t=this._data[o];
return t?t[a]:null
};
DwtListView.prototype._setItemData=function(e,o,a,n){
n=n||(e?e.id:null);
var t=this._data[n];
if(t){
t[o]=a
}};
DwtListView.prototype._isValidDragObject=function(e){
return(this.getTargetItemDiv(e)!=null)
};
DwtListView.prototype._updateDragSelection=function(t,e){
if(!e){
t.className=this._getItemData(t,"origClassName")
}else{
this._setItemData(t,"origClassName",t.className);
Dwt.delClass(t,this._styleRe,this._dndClass)
}};
DwtListView.prototype._mouseOverAction=function(t,o){
var e=this._getItemData(o,"type");
if(e==DwtListView.TYPE_HEADER_ITEM){
var a=this.getItemFromElement(o);
if(a&&this.sortingEnabled&&a._sortable&&!this._headerClone){
o.className="DwtListView-Column DwtListView-ColumnHover"
}}else{
if(e==DwtListView.TYPE_HEADER_SASH){
o.style.cursor=AjxEnv.isIE?"col-resize":"e-resize"
}}
return true
};
DwtListView.prototype._mouseOutAction=function(t,a){
var e=this._getItemData(a,"type");
if(e==DwtListView.TYPE_HEADER_ITEM&&!this._headerClone){
a.className=(a.id!=this._currentColId)?"DwtListView-Column":"DwtListView-Column DwtListView-ColumnActive"
}else{
if(e==DwtListView.TYPE_HEADER_SASH){
a.style.cursor="auto"
}}
return true
};
DwtListView.prototype._mouseOverListener=function(e){
var t=this.getTargetItemDiv(e);
if(!t){
return
}
this._mouseOverAction(e,t)
};
DwtListView.prototype._mouseOutListener=function(e){
var t=this.getTargetItemDiv(e);
if(!t){
return
}
this.setToolTipContent(null);
this._mouseOutAction(e,t)
};
DwtListView.prototype._mouseMoveListener=function(t){
if(!this._clickDiv){
return
}
var e=this._getItemData(this._clickDiv,"type");
if(e==DwtListView.TYPE_HEADER_ITEM){
this._handleColHeaderMove(t)
}else{
if(e==DwtListView.TYPE_HEADER_SASH){
this._handleColHeaderResize(t)
}}};
DwtListView.prototype._mouseUpAction=function(e,t){
return true
};
DwtListView.prototype._mouseDownListener=function(e){
var t=this.getTargetItemDiv(e);
if(!t){
this._dndSelection=null
}else{
this._clickDiv=t;
if(this._getItemData(t,"type")!=DwtListView.TYPE_LIST_ITEM){
this._dndSelection=null
}else{
this._dndSelection=(this._selectedItems.contains(t))?this._selectedItems:t
}}
this._mouseDownAction(e,t)
};
DwtListView.prototype._mouseDownAction=function(e,t){
return true
};
DwtListView.prototype._mouseUpListener=function(a){
var s=this.getTargetItemDiv(a);
var n=this._handleColHeaderDrop(a);
var e=this._handleColSashDrop(a);
if(!s||s!=this._clickDiv||n||e){
delete this._clickDiv;
return
}
delete this._clickDiv;
var t=this._getItemData(s,"type");
if(this._headerList&&t==DwtListView.TYPE_HEADER_ITEM){
if(a.button==DwtMouseEvent.LEFT){
this._columnClicked(s,a)
}else{
if(a.button==DwtMouseEvent.RIGHT){
var o=this._getActionMenuForColHeader();
if(o&&o instanceof DwtMenu){
o.popup(0,a.docX,a.docY)
}}}}else{
if(t==DwtListView.TYPE_LIST_ITEM){
if(a.button==DwtMouseEvent.LEFT||a.button==DwtMouseEvent.RIGHT){
this._itemClicked(s,a)
}}}};
DwtListView.prototype._doubleClickAction=function(e,t){
return true
};
DwtListView.prototype._doubleClickListener=function(t){
var a=this.getTargetItemDiv(t);
if(!a){
return
}
var e=this._getItemData(a,"type");
if(e==DwtListView.TYPE_LIST_ITEM){
if(!this._doubleClickAction(t,a)){
return
}
if(this._evtMgr.isListenerRegistered(DwtEvent.SELECTION)){
DwtUiEvent.copy(this._selEv,t);
this._selEv.item=this.getItemFromElement(a);
this._selEv.detail=DwtListView.ITEM_DBL_CLICKED;
this._evtMgr.notifyListeners(DwtEvent.SELECTION,this._selEv)
}}};
DwtListView.prototype.emulateDblClick=function(e,t){
var o=document.getElementById(this._getItemId(e));
if(o){
var a=new DwtMouseEvent();
this._setMouseEvent(a,{
target:o,button:DwtMouseEvent.LEFT}
);
a.kbNavEvent=t;
this._itemClicked(o,a);
this._doubleClickListener(a)
}};
DwtListView.prototype._selectItem=function(a,e,o){
if(!this.size()){
return
}
var t=(this._kbAnchor)?this._getSiblingElement(this._kbAnchor,a):this._parentEl.firstChild;
this._scrollList(t);
this._emulateSingleClick({
target:t,button:DwtMouseEvent.LEFT,shiftKey:e,kbNavEvent:o}
)
};
DwtListView.prototype._getSiblingElement=function(e,a){
if(!e){
return null
}
var t=a?e.nextSibling:e.previousSibling;
while(this._hasHiddenRows&&t&&!Dwt.getVisible(t)){
t=a?t.nextSibling:t.previousSibling
}
return(!t||(this._hasHiddenRows&&!Dwt.getVisible(t)))?e:t
};
DwtListView.prototype._scrollList=function(e){
DwtControl._scrollIntoView(e,e.parentNode)
};
DwtListView.prototype._emulateSingleClick=function(e){
this._clickDiv=this.findItemDiv(e.target);
var t=new DwtMouseEvent();
this._setMouseEvent(t,e);
t.kbNavEvent=e.kbNavEvent;
this.notifyListeners(DwtEvent.ONMOUSEUP,t)
};
DwtListView.prototype._setKbFocusElement=function(e){
if(!this._list){
return
}
var a=this._kbAnchor;
if(this._kbAnchor){
this._kbAnchor=this._getSiblingElement(this._kbAnchor,e)
}else{
this._kbAnchor=this._parentEl.firstChild
}
if(this._kbAnchor!=a){
if(a){
var t=this._selectedClass;
if(a.className.indexOf(t)!=-1){
Dwt.delClass(a,this._styleRe,t)
}else{
Dwt.delClass(a,this._styleRe)
}}
Dwt.addClass(this._kbAnchor,this._kbFocusClass)
}
if(this._kbAnchor){
this._scrollList(this._kbAnchor)
}};
DwtListView.prototype._itemSelected=function(e,a){
if(this._allowLeftSelection(e,a,a&&a.button)){
this._unmarkKbAnchorElement(true);
this.deselectAll();
this._selectedItems.add(e);
this._selAnchor=this._kbAnchor=e;
Dwt.delClass(e,this._styleRe,this._selectedClass);
if(this.hasFocus()){
Dwt.addClass(e,this._kbFocusClass)
}
var t=this.getItemFromElement(e);
this.firstSelIndex=(this._list&&t)?this._list.indexOf(t):-1
}};
DwtListView.prototype._itemClicked=function(s,u){
if(this._rightSelItem){
Dwt.delClass(this._rightSelItem,this._styleRe);
this._rightSelItem=null
}
var n=this._selectedItems.size();
var a=this._selectedItems.contains(s);
if((!u.shiftKey&&!u.ctrlKey)||!this.multiSelectEnabled){
if(u.button==DwtMouseEvent.LEFT||u.button==DwtMouseEvent.RIGHT){
this._selEv.detail=DwtListView.ITEM_SELECTED
}
if(u.button==DwtMouseEvent.LEFT){
this._itemSelected(s,u)
}else{
if(u.button==DwtMouseEvent.RIGHT&&!a&&this._evtMgr.isListenerRegistered(DwtEvent.ACTION)){
this._rightSelItem=s;
Dwt.delClass(s,this._styleRe,this._rightClickClass);
if(this._kbAnchor==s){
Dwt.addClass(s,this._kbFocusClass)
}}}}else{
if(u.ctrlKey){
this.setMultiSelection(s,a,u)
}else{
if(!this._selAnchor){
return
}
var r=this._getChildren()||s.parentNode.childNodes;
var c=r.length;
var o;
var e=0;
for(var h=0;
h<c;
h++){
o=r[h];
if(o==this._rightSelItem){
this._rightSelItem=null
}
if(o==s){
e++
}
var t=this._selectedClass;
if(o==this._selAnchor){
e++;
if(o.className.indexOf(t)==-1){
this._selectedItems.add(o)
}
Dwt.delClass(o,this._styleRe,t);
continue
}
if(e!=1&&o.className.indexOf(t)!=-1&&o!=s){
Dwt.delClass(o,this._styleRe);
this._selectedItems.remove(o)
}else{
if(e==1||o==s){
if(o.className.indexOf(t)==-1){
this._selectedItems.add(o)
}
Dwt.delClass(o,this._styleRe,t)
}}}
this._kbAnchor=s;
Dwt.addClass(this._kbAnchor,this._kbFocusClass);
var d=this._selectedItems.size();
if(n<d){
this._selEv.detail=DwtListView.ITEM_SELECTED
}else{
if(n>d){
this._selEv.detail=DwtListView.ITEM_DESELECTED
}else{
return
}}}}
if(u.button==DwtMouseEvent.LEFT&&this._evtMgr.isListenerRegistered(DwtEvent.SELECTION)){
if(this._setListEvent(u,this._selEv,s)){
this._evtMgr.notifyListeners(DwtEvent.SELECTION,this._selEv)
}}else{
if(u.button==DwtMouseEvent.RIGHT&&this._evtMgr.isListenerRegistered(DwtEvent.ACTION)){
if(this._setListEvent(u,this._actionEv,s)){
this._evtMgr.notifyListeners(DwtEvent.ACTION,this._actionEv)
}}}};
DwtListView.prototype._setListEvent=function(t,a,e){
DwtUiEvent.copy(a,t);
a.kbNavEvent=t.kbNavEvent;
a.item=this.findItem(e);
return true
};
DwtListView.prototype._columnClicked=function(o,t){
var n=this.getItemFromElement(o);
if(!(n._sortable&&this.sortingEnabled)){
return
}
var a=this.getList();
var e=a?a.size():null;
if(!e){
return
}
this._bSortAsc=(n._id==this._currentColId)?!this._bSortAsc:this._getDefaultSortbyForCol(n);
this._setSortedColStyle(n._id);
if(e>=1){
this._sortColumn(n,this._bSortAsc)
}};
DwtListView.prototype._sortColumn=function(e,t){};
DwtListView.prototype._getActionMenuForColHeader=function(){
return null
};
DwtListView.prototype._getDefaultSortbyForCol=function(e){
return true
};
DwtListView.prototype._allowLeftSelection=function(t,a,e){
return true
};
DwtListView.prototype._setSortedColStyle=function(e){
if(this._currentColId&&(e!=this._currentColId)){
var s=this._headerIdHash[this._currentColId];
if(s&&!s._noSortArrow){
var r=s._field;
var h=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_ARROW,this._view,r);
var o=document.getElementById(h);
if(o&&o.firstChild){
var t=(AjxImg._mode==AjxImg.SINGLE_IMG)?o.firstChild:o.firstChild.firstChild;
if(t){
t.style.visibility="hidden"
}}}
var d=document.getElementById(this._currentColId);
if(d){
d.className="DwtListView-Column"
}}
this._currentColId=e;
var s=this._headerIdHash[this._currentColId];
if(!s._noSortArrow){
var r=s._field;
var c=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_ARROW,this._view,r);
var a=document.getElementById(c);
if(a){
AjxImg.setImage(a,this._bSortAsc?"ColumnUpArrow":"ColumnDownArrow");
var t=(AjxImg._mode==AjxImg.SINGLE_IMG)?a.firstChild:a.firstChild.firstChild;
if(t){
t.style.visibility="visible"
}}}
var n=document.getElementById(e);
if(n){
n.className="DwtListView-Column DwtListView-ColumnActive"
}};
DwtListView.prototype._resetList=function(){
if(this._list&&this._list.size()){
this._list.removeAll()
}
this._resetListView()
};
DwtListView.prototype._resetListView=function(){
var e;
while(this._parentEl&&this._parentEl.hasChildNodes()){
var e=this._parentEl.removeChild(this._parentEl.firstChild);
this._data[e.id]=null
}
if(this._selectedItems){
this._selectedItems.removeAll()
}
this._rightSelItem=null
};
DwtListView.prototype._destroyDragProxy=function(e){
this._data[e.id]=null;
DwtControl.prototype._destroyDragProxy.call(this,e)
};
DwtListView.prototype._handleColHeaderMove=function(r){
if(!this._headerClone){
if(!this._headerColX){
this._headerColX=r.docX;
return
}else{
var n=Math.abs(this._headerColX-r.docX);
if(n<DwtListView.COL_MOVE_THRESHOLD){
return
}}
this._headerClone=document.createElement("div");
var u=Dwt.getSize(this._clickDiv);
var t=AjxEnv.isIE?u.x:u.x-3;
var d=AjxEnv.isIE?u.y:u.y-5;
Dwt.setSize(this._headerClone,t,d);
Dwt.setPosition(this._headerClone,Dwt.ABSOLUTE_STYLE);
Dwt.setZIndex(this._headerClone,Dwt.Z_DND);
Dwt.setLocation(this._headerClone,Dwt.DEFAULT,r.docY);
this._headerClone.className=this._clickDiv.className+" DragProxy";
this._headerClone.innerHTML=this._clickDiv.innerHTML;
this._clickDiv.className="DwtListView-Column DwtListView-ColumnEmpty";
this._headerClone.style.borderTop="1px solid #777777";
var h=this._headerIdHash[this._clickDiv.id];
var c=h._field;
var o=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_LABEL,this._view,c);
var a=document.getElementById(o);
if(a){
a.style.color="#FFFFFF"
}
this.shell.getHtmlElement().appendChild(this._headerClone)
}else{
var e=this.getTargetItemDiv(r);
var s=this._getItemData(e,"type");
if(s==DwtListView.TYPE_HEADER_ITEM){
if(this._headerCloneTarget&&(this._headerCloneTarget==this._clickDiv)){
this._headerCloneTarget=null
}else{
if(this._headerCloneTarget!=e){
this._headerCloneTarget=e
}}}else{
this._headerCloneTarget=null
}}
if(this._headerClone){
Dwt.setLocation(this._headerClone,r.docX+2)
}};
DwtListView.prototype._handleColHeaderResize=function(t){
if(!this._headerSash){
this._headerSash=document.createElement("div");
Dwt.setSize(this._headerSash,Dwt.DEFAULT,this.getSize().y);
Dwt.setPosition(this._headerSash,Dwt.ABSOLUTE_STYLE);
Dwt.setZIndex(this._headerSash,Dwt.Z_DND);
var a=this._getHeaderSashLocation();
this._headerSashFudgeX=a.x;
Dwt.setLocation(this._headerSash,Dwt.DEFAULT,a.y);
this._headerSash.className="DwtListView-ColumnSash";
this.getHtmlElement().appendChild(this._headerSash);
this._headerSashX=t.docX
}
var e=this._getParentForColResize();
var o=Dwt.toWindow(e.getHtmlElement(),0,0);
Dwt.setLocation(this._headerSash,(t.docX-o.x)+this._headerSashFudgeX)
};
DwtListView.prototype._getHeaderSashLocation=function(){
if(!this._tmpPoint){
this._tmpPoint=new DwtPoint()
}
this._tmpPoint.x=0;
this._tmpPoint.y=0;
return this._tmpPoint
};
DwtListView.prototype._handleColHeaderDrop=function(h){
this._headerColX=null;
if(this._headerClone==null||h.button==DwtMouseEvent.RIGHT){
return false
}
if(this._headerCloneTarget){
var e=this._getItemData(this._clickDiv,"index");
var a=this._getItemData(this._headerCloneTarget,"index");
this._reIndexColumn(e,a)
}
this._clickDiv.className=(this._clickDiv.id!=this._currentColId)?"DwtListView-Column":"DwtListView-Column DwtListView-ColumnActive";
var d=this._headerClone.parentNode;
if(d){
d.removeChild(this._headerClone)
}
delete this._headerClone;
var s=this._data[this._clickDiv.id];
if(s.type!=DwtListView.TYPE_HEADER_ITEM){
var c=this._headerIdHash[this._currentColId];
var r=c._sortable?c._field:null;
this.headerColCreated=false;
this.createHeaderHtml(r)
}else{
var c=this._headerIdHash[this._clickDiv.id];
var o=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_LABEL,this._view,c._field);
var t=document.getElementById(o);
if(t){
t.style.color="#000000"
}}
for(var n=0;
n<this._headerList.length;
n++){
this._headerList[n]._width=this._calcRelativeWidth(n)
}
this._resetColWidth();
return true
};
DwtListView.prototype._reIndexColumn=function(o,a){
if(!this._headerList){
return
}
var e=this._headerList.length;
if(o<0||a<0||o>=e||a>=e||o==a){
return
}
var t=this._headerList.splice(o,1);
this._headerList.splice(a,0,t[0]);
this._relayout()
};
DwtListView.prototype._handleColSashDrop=function(o){
if(this._headerSash==null||o.button==DwtMouseEvent.RIGHT){
return false
}
var a=this._headerSash.parentNode;
if(a){
a.removeChild(this._headerSash)
}
delete this._headerSash;
for(var t=0;
t<this._headerList.length;
t++){
this._headerList[t]._width=this._calcRelativeWidth(t)
}
var s=this._getItemData(this._clickDiv,"index");
if(s==null){
return false
}
var h=o.docX-this._headerSashX;
var r=this._headerList[s];
var n=this._variableHeaderCol;
if(r==n){
var e=this._getNextResizeableColumnIndex(n._index);
if(e!=null){
n=this._headerList[e]
}else{
return false
}}else{
if(!n){
var e=this._getNextResizeableColumnIndex(r._index);
if(e!=null){
n=this._headerList[e]
}else{
return false
}}}
r._width=Math.max(r._width+h,DwtListView.MIN_COLUMN_WIDTH);
n._width=Math.max(this._calcRelativeWidth(n._index)-h,DwtListView.MIN_COLUMN_WIDTH);
var e=this._getNextResizeableColumnIndex(-1,[r._index,n._index]);
if(e!=null){
this._headerList[e]._width="auto"
}
this._relayout();
this._resetColWidth();
return true
};
DwtListView.prototype._calcRelativeWidth=function(a){
var t=this._headerList[a];
if(!t._width||(t._width&&t._width=="auto")){
var e=document.getElementById(t._id);
return(e)?(e.clientWidth-(AjxEnv.isIE?4:5)):null
}
return t._width
};
DwtListView.prototype._resetColWidth=function(){
if(!this.headerColCreated){
return
}
var s=this._getLastColumnIndex();
if(s){
var a=this._headerList[s];
var t=document.getElementById(a._id);
if(t){
var r=t.firstChild;
var e=16;
var n=this._listColDiv.clientWidth;
var o=this._listDiv.clientWidth;
if(n!=o){
t.style.width=r.style.width=(a._width!=null&&a._width!="auto")?(a._width+e):(t.clientWidth+e)
}else{
t.style.width=r.style.width=(a._width||"")
}}}};
DwtListView.prototype._getLastColumnIndex=function(){
var t=null;
if(this._headerList){
var e=this._headerList.length-1;
while(t==null&&e>=0){
if(this._headerList[e]._visible){
t=e
}
e--
}}
return t
};
DwtListView.prototype._getNextResizeableColumnIndex=function(o,e){
e=e?AjxUtil.arrayAsHash(e):{};
e[o]=true;
if(this._headerList){
for(var a=o+1;
a<this._headerList.length;
a++){
var t=this._headerList[a];
if(e[a]){
continue
}
if(t._visible&&t._resizeable){
return a
}}
for(var a=0;
a<o;
a++){
if(e[a]){
continue
}
var t=this._headerList[a];
if(t._visible&&t._resizeable){
return a
}}}
return null
};
DwtListView.prototype._relayout=function(){
this.headerColCreated=false;
var a=this._headerIdHash[this._currentColId];
var e=(a&&a._sortable)?a._field:null;
this.setUI(e);
var t=this.getSelection()[0];
this.setSelection(t,true)
};
DwtListView.prototype._getParentForColResize=function(){
return this
};
DwtListView.prototype._sizeChildren=function(e){
if(this.headerColCreated&&this._listDiv&&(e!=Dwt.DEFAULT)){
Dwt.setSize(this._listDiv,Dwt.DEFAULT,e-DwtListView.HEADERITEM_HEIGHT);
return true
}else{
return false
}};
DwtListView.prototype._getChildren=function(){
return null
};
DwtListView.prototype._focus=function(){
if(this.size()==0){
return
}
if(this._kbAnchor){
Dwt.addClass(this._kbAnchor,this._kbFocusClass)
}else{
this._setKbFocusElement()
}};
DwtListView.prototype._blur=function(){
this._unmarkKbAnchorElement()
};
DwtListView.prototype._unmarkKbAnchorElement=function(e){
if(this._kbAnchor){
if(this._selectedItems.contains(this._kbAnchor)){
Dwt.delClass(this._kbAnchor,this._styleRe,this._selectedClass)
}else{
Dwt.delClass(this._kbAnchor,this._styleRe)
}}
if(e){
this._kbAnchor=null
}};
DwtListView.prototype._getFirstItem=function(){
var e=this._list.getArray();
if(e&&e.length>1){
return e[0]
}
return null
};
DwtListView.prototype._getLastItem=function(){
var e=this._list.getArray();
if(e&&e.length>1){
return e[e.length-1]
}
return null
};
DwtListHeaderItem=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtListView.PARAMS);
this._field=t.field;
this._label=t.text;
this._iconInfo=t.icon;
this._sortable=t.sortable;
this._noSortArrow=t.noSortArrow;
this._resizeable=t.resizeable;
this._visible=(t.visible!==false);
this._name=t.name||t.text;
this._align=t.align;
this._noRemove=t.noRemove;
var e=parseInt(t.width);
if(isNaN(e)||!e){
this._width="auto";
this._variable=true;
this._resizeable=true
}else{
if(String(e)==String(t.width)){
this._width=e
}else{
this._width=parseInt(String(t.width).substr(0,String(e).length));
this._widthUnits=AjxStringUtil.getUnitsFromSizeString(t.width)
}}};
DwtListHeaderItem.PARAMS=["id","text","icon","width","sortable","resizeable","visible","name","align","noRemove","view"];
DwtListHeaderItem.sortCompare=function(t,e){
return t._index<e._index?-1:(t._index>e._index?1:0)
};
DwtListHeaderItem.prototype.toString=function(){
return"DwtListHeaderItem"
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtButton")){
DwtButton=function(a){
if(arguments.length==0){
return
}
a=Dwt.getParams(arguments,DwtButton.PARAMS);
a.className=a.className||"ZButton";
DwtLabel.call(this,a);
var t=a.parent;
if(!t._hasSetMouseEvents||AjxEnv.isIE){
this._setMouseEvents()
}
var e;
if(t._hasSetMouseEvents){
e=AjxEnv.isIE?[DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE]:[]
}else{
e=AjxEnv.isIE?[DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE]:[DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT];
e=e.concat([DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP])
}
if(e&&e.length){
this._setEventHdlrs(e)
}
this._listeners=a.listeners||DwtButton._listeners;
this._addMouseListeners();
this._ignoreInternalOverOut=true;
this._dropDownEvtMgr=new AjxEventMgr();
this._selected=false;
this._actionTiming=a.actionTiming||DwtButton.ACTION_MOUSEUP;
this.__preventMenuFocus=null
};
DwtButton.prototype=new DwtLabel;
DwtButton.prototype.constructor=DwtButton;
DwtButton.prototype.toString=function(){
return"DwtButton"
};
DwtButton.PARAMS=["parent","style","className","posStyle","actionTiming","id","index","listeners"];
DwtButton.TOGGLE_STYLE=DwtLabel._LAST_STYLE*2;
DwtButton.ALWAYS_FLAT=DwtLabel._LAST_STYLE*4;
DwtButton._LAST_STYLE=DwtButton.ALWAYS_FLAT;
DwtButton.ACTION_MOUSEUP=1;
DwtButton.ACTION_MOUSEDOWN=2;
DwtButton.NOTIFY_WINDOW=500;
DwtButton.prototype.TEMPLATE="dwt.Widgets#ZButton";
DwtButton.prototype.dispose=function(){
if((this._menu instanceof DwtMenu)&&(this._menu.parent==this)){
this._menu.dispose();
this._menu=null
}
DwtLabel.prototype.dispose.call(this)
};
DwtButton.prototype.addSelectionListener=function(t,e){
this.addListener(DwtEvent.SELECTION,t,e);
if(DwtControl.globalSelectionListener){
this.addListener(DwtEvent.SELECTION,DwtControl.globalSelectionListener)
}};
DwtButton.prototype.removeSelectionListener=function(e){
this.removeListener(DwtEvent.SELECTION,e)
};
DwtButton.prototype.removeSelectionListeners=function(){
this.removeAllListeners(DwtEvent.SELECTION)
};
DwtButton.prototype.addDropDownSelectionListener=function(e){
return this._dropDownEvtMgr.addListener(DwtEvent.SELECTION,e)
};
DwtButton.prototype.removeDropDownSelectionListener=function(e){
this._dropDownEvtMgr.removeListener(DwtEvent.SELECTION,e)
};
DwtButton.prototype._dropDownImg="SelectPullDownArrow";
DwtButton.prototype._dropDownDepImg="SelectPullDownArrow";
DwtButton.prototype._dropDownHovImg="SelectPullDownArrowHover";
DwtButton.prototype.setDropDownImages=function(t,a,o,e){
this._dropDownImg=t;
this._dropDownHovImg=o;
this._dropDownDepImg=e
};
DwtButton.prototype._addEventListeners=function(a,t){
for(var e=0;
e<t.length;
e++){
this.addListener(event,a[event])
}};
DwtButton.prototype._removeEventListeners=function(a,t){
for(var e=0;
e<t.length;
e++){
this.removeListener(event,a[event])
}};
DwtButton.prototype._addMouseListeners=function(){
var t=[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP];
t=t.concat(AjxEnv.isIE?[DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE]:[DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT]);
for(var e=0;
e<t.length;
e++){
this.addListener(t[e],this._listeners[t[e]])
}};
DwtButton.prototype._removeMouseListeners=function(){
var t=[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP];
t=t.concat(AjxEnv.isIE?[DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE]:[DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT]);
for(var e=0;
e<t.length;
e++){
this.removeListener(t[e],this._listeners[t[e]])
}};
DwtButton.prototype.setDisplayState=function(t,e){
if(this._selected&&t!=DwtControl.SELECTED&&!e){
t=[DwtControl.SELECTED,t].join(" ")
}
DwtLabel.prototype.setDisplayState.call(this,t)
};
DwtButton.prototype.setEnabled=function(t){
if(t!=this._enabled){
DwtLabel.prototype.setEnabled.call(this,t);
if(t){
var a=(AjxEnv.isIE)?this.getHtmlElement().firstChild:null;
if(a){
var e=a.className;
a.className="";
a.className=e
}
this._addMouseListeners();
if(this._menu){
this._setDropDownCellMouseHandlers(true);
if(this._dropDownEl){
AjxImg.setImage(this._dropDownEl,this._dropDownImg)
}}}else{
this._removeMouseListeners();
if(this._menu){
this._setDropDownCellMouseHandlers(false);
if(this._dropDownEl){
AjxImg.setDisabledImage(this._dropDownEl,this._dropDownImg)
}}}}};
DwtButton.prototype.setImage=function(e){
DwtLabel.prototype.setImage.call(this,e);
this._setMinWidth()
};
DwtButton.prototype.setText=function(e){
DwtLabel.prototype.setText.call(this,e);
this._setMinWidth()
};
DwtButton.prototype._setMinWidth=function(){
if(this.getText()!=null){
Dwt.addClass(this.getHtmlElement(),"ZHasText")
}else{
Dwt.delClass(this.getHtmlElement(),"ZHasText")
}};
DwtButton.prototype.setHoverImage=function(e){
this._hoverImageInfo=e
};
DwtButton.prototype.setMenu=function(n,a,o,t){
this._menu=n;
this._shouldToggleMenu=(a===true);
this._followIconStyle=o;
this._popupAbove=t;
if(this._menu){
if(this._dropDownEl){
var e=(this._imageCell)?1:0;
if(this._textCell){
e++
}
Dwt.addClass(this.getHtmlElement(),"ZHasDropDown");
AjxImg.setImage(this._dropDownEl,this._dropDownImg);
if(this._enabled){
this._setDropDownCellMouseHandlers(true)
}
if(!(this._menu instanceof AjxCallback)){
this._menu.setAssociatedElementId(this._dropDownEl.id)
}}
if((this.__preventMenuFocus!=null)&&(this._menu instanceof DwtMenu)){
this._menu.dontStealFocus(this.__preventMenuFocus)
}}else{
if(this._dropDownEl){
Dwt.delClass(this.getHtmlElement(),"ZHasDropDown");
this._dropDownEl.innerHTML=""
}}};
DwtButton.prototype._setDropDownCellMouseHandlers=function(e){
this._dropDownEventsEnabled=e
};
DwtButton.prototype.getMenu=function(e){
if(this._menu instanceof AjxCallback){
if(e){
return null
}
var t=this._menu;
this.setMenu(t.run(this),this._shouldToggleMenu,this._followIconStyle,this._popupAbove);
if((this.__preventMenuFocus!=null)&&(this._menu instanceof DwtMenu)){
this._menu.dontStealFocus(this.__preventMenuFocus)
}}
if(this._menu){
this.getHtmlElement().setAttribute("menuId",this._menu._htmlElId)
}
return this._menu
};
DwtButton.prototype.resetClassName=function(){
this.setDisplayState(DwtControl.NORMAL)
};
DwtButton.prototype.setActionTiming=function(e){
this._actionTiming=e
};
DwtButton.prototype.setHovered=function(e){
this.setDisplayState(e?DwtControl.HOVER:DwtControl.NORMAL)
};
DwtButton.prototype.setEnabledImage=function(e){
this._enabledImageInfo=e;
this.setImage(e)
};
DwtButton.prototype.setDepressedImage=function(e){
this._depressedImageInfo=e
};
DwtButton.prototype.setSelected=function(e){
if(this._selected!=e){
this._selected=e;
this.setDisplayState(e?DwtControl.SELECTED:DwtControl.NORMAL)
}};
DwtButton.prototype.isToggled=function(){
return this._selected
};
DwtButton.prototype.popup=function(o){
o=o||this.getMenu();
if(!o){
return
}
var d=o.parent;
var s=d.getBounds();
var c=o.shell.getSize();
var e=o.getSize();
var u=d.getHtmlElement();
var a=Dwt.toWindow(u,0,0);
var t=(u.style.borderLeftWidth=="")?0:parseInt(u.style.borderLeftWidth);
var h=a.x+t;
h=((h+e.x)>=c.x)?c.x-e.x:h;
var r;
if(this._popupAbove){
r=a.y-e.y
}else{
var n=(u.style.borderTopWidth=="")?0:parseInt(u.style.borderTopWidth);
n+=(u.style.borderBottomWidth=="")?0:parseInt(u.style.borderBottomWidth);
r=a.y+s.height+n
}
o.popup(0,h,r)
};
DwtButton.prototype.getKeyMapName=function(){
return"DwtButton"
};
DwtButton.prototype.handleKeyAction=function(e,t){
switch(e){
case DwtKeyMap.SELECT:this._emulateSingleClick();
break;
case DwtKeyMap.SUBMENU:var a=this.getMenu();
if(!a){
return false
}
this._emulateDropDownClick();
a.setSelectedItem(0);
break
}
return true
};
DwtButton.prototype._emulateSingleClick=function(){
this.trigger();
var e=this.getHtmlElement();
var t=Dwt.toWindow(e);
var a=new DwtMouseEvent();
this._setMouseEvent(a,{
dwtObj:this,target:e,button:DwtMouseEvent.LEFT,docX:t.x,docY:t.y}
);
if(this._actionTiming==DwtButton.ACTION_MOUSEDOWN){
this.notifyListeners(DwtEvent.ONMOUSEDOWN,a)
}else{
this.notifyListeners(DwtEvent.ONMOUSEUP,a)
}};
DwtButton.prototype._emulateDropDownClick=function(){
var e=this._dropDownEl;
if(!e){
return
}
var t=Dwt.toWindow(e);
var a=new DwtMouseEvent();
this._setMouseEvent(a,{
dwtObj:this,target:e,button:DwtMouseEvent.LEFT,docX:t.x,docY:t.y}
);
DwtButton._dropDownCellMouseDownHdlr(a)
};
DwtButton.prototype._focusByMouseUpEvent=function(){
if(!(this.parent&&(this.parent instanceof DwtToolBar)&&this.parent.noFocus)){
DwtShell.getShell(window).getKeyboardMgr().grabFocus(this.getTabGroupMember())
}};
DwtButton.prototype._focus=function(){
this.setDisplayState(DwtControl.FOCUSED)
};
DwtButton.prototype._blur=function(){
this.setDisplayState(DwtControl.NORMAL)
};
DwtButton.prototype._toggleMenu=function(){
if(this._shouldToggleMenu){
var e=this.getMenu();
if(!e.isPoppedUp()){
this.popup();
this._menuUp=true
}else{
e.popdown();
this._menuUp=false;
this.deactivate()
}}else{
this.popup()
}};
DwtButton.prototype._isDropDownEvent=function(t){
if(this._dropDownEventsEnabled&&this._dropDownEl){
var e=t.docX;
var a=Dwt.toWindow(this._dropDownEl,0,0,window).x;
if(e>=a){
return true
}}
return false
};
DwtButton.prototype.trigger=function(){
if(this._depressedImageInfo){
this.setImage(this._depressedImageInfo)
}
this.setDisplayState(DwtControl.ACTIVE,true);
this.isActive=true
};
DwtButton.prototype.deactivate=function(){
this._showHoverImage(true);
if(this._style&DwtButton.TOGGLE_STYLE){
this._selected=!this._selected
}
this.setDisplayState(DwtControl.HOVER)
};
DwtButton.prototype.dontStealFocus=function(e){
if(e==null){
e=true
}
if(this._menu instanceof DwtMenu){
this._menu.dontStealFocus(e)
}
this.__preventMenuFocus=e
};
DwtButton.prototype._showHoverImage=function(t){
if(this._hoverImageInfo){
var e=this._getIconEl();
var a=t?this._hoverImageInfo:this.__imageInfo;
e.firstChild.className=AjxImg.getClassForImage(a)
}};
DwtButton.prototype._handleClick=function(t){
if(this.isListenerRegistered(DwtEvent.SELECTION)){
var e=(new Date()).getTime();
if(!this._lastNotify||(e-this._lastNotify>DwtButton.NOTIFY_WINDOW)){
var a=DwtShell.selectionEvent;
DwtUiEvent.copy(a,t);
a.item=this;
a.detail=(typeof this.__detail=="undefined")?0:this.__detail;
this.notifyListeners(DwtEvent.SELECTION,a);
this._lastNotify=e
}}else{
if(this._menu){
this._toggleMenu()
}}};
DwtButton.prototype._setMouseOutClassName=function(){
this.setDisplayState(DwtControl.NORMAL)
};
DwtButton.prototype._createHtmlFromTemplate=function(e,t){
DwtLabel.prototype._createHtmlFromTemplate.call(this,e,t);
this._dropDownEl=document.getElementById(t.id+"_dropdown")
};
DwtButton._dropDownCellMouseDownHdlr=function(t){
var a=DwtControl.getTargetControl(t);
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t,a);
if(e.button==DwtMouseEvent.LEFT){
if(this._depImg){
AjxImg.setImage(this,this._depImg)
}}
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtButton._dropDownCellMouseUpHdlr=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
if(e.button==DwtMouseEvent.LEFT){
if(this._hovImg&&!this.noMenuBar){
AjxImg.setImage(this,this._hovImg)
}
DwtEventManager.notifyListeners(DwtEvent.ONMOUSEDOWN,e);
var o=DwtControl.getTargetControl(t);
if(o){
if(o.getMenu()&&o.getMenu().isPoppedUp()){
o.getMenu().popdown()
}else{
if(o._menu instanceof AjxCallback){
o.popup()
}
if(o._dropDownEvtMgr.isListenerRegistered(DwtEvent.SELECTION)){
var a=DwtShell.selectionEvent;
DwtUiEvent.copy(a,e);
a.item=o;
o._dropDownEvtMgr.notifyListeners(DwtEvent.SELECTION,a)
}else{
o._toggleMenu()
}}}}
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtButton._mouseOverListener=function(t){
var e=t.dwtObj;
if(!e){
return false
}
e._showHoverImage(true);
e.setDisplayState(DwtControl.HOVER);
var a=e._dropDownEl;
if(e._menu&&a&&e._dropDownHovImg&&!e.noMenuBar&&e.isListenerRegistered(DwtEvent.SELECTION)){
AjxImg.setImage(a,e._dropDownHovImg)
}
t._stopPropagation=true
};
DwtButton._mouseOutListener=function(t){
var e=t.dwtObj;
if(!e){
return false
}
e._showHoverImage(false);
e._setMouseOutClassName();
e.isActive=false;
var a=e._dropDownEl;
if(e._menu&&a){
AjxImg.setImage(a,e._dropDownImg)
}};
DwtButton._mouseDownListener=function(t){
var e=t.dwtObj;
if(!e){
return false
}
if(e._isDropDownEvent(t)){
return DwtButton._dropDownCellMouseDownHdlr(t)
}
if(t.button!=DwtMouseEvent.LEFT){
return
}
var a=e._dropDownEl;
if(e._menu&&a&&e._dropDownDepImg){
AjxImg.setImage(a,e._dropDownDepImg)
}
switch(e._actionTiming){
case DwtButton.ACTION_MOUSEDOWN:e.trigger();
e._handleClick(t);
break;
case DwtButton.ACTION_MOUSEUP:e.trigger();
break
}};
DwtButton._mouseUpListener=function(a){
var e=a.dwtObj;
if(!e){
return false
}
if(e._isDropDownEvent(a)){
return DwtButton._dropDownCellMouseUpHdlr(a)
}
if(a.button!=DwtMouseEvent.LEFT){
return
}
var o=e._dropDownEl;
if(e._menu&&o&&e._dropDownHovImg&&!e.noMenuBar){
AjxImg.setImage(o,e._dropDownHovImg)
}
switch(e._actionTiming){
case DwtButton.ACTION_MOUSEDOWN:e.deactivate();
break;
case DwtButton.ACTION_MOUSEUP:var t=e.getHtmlElement();
if(e.isActive){
e.deactivate();
e._handleClick(a)
}
break
}};
DwtButton._listeners={};
DwtButton._listeners[DwtEvent.ONMOUSEOVER]=new AjxListener(null,DwtButton._mouseOverListener);
DwtButton._listeners[DwtEvent.ONMOUSEOUT]=new AjxListener(null,DwtButton._mouseOutListener);
DwtButton._listeners[DwtEvent.ONMOUSEDOWN]=new AjxListener(null,DwtButton._mouseDownListener);
DwtButton._listeners[DwtEvent.ONMOUSEUP]=new AjxListener(null,DwtButton._mouseUpListener);
DwtButton._listeners[DwtEvent.ONMOUSEENTER]=new AjxListener(null,DwtButton._mouseOverListener);
DwtButton._listeners[DwtEvent.ONMOUSELEAVE]=new AjxListener(null,DwtButton._mouseOutListener)
}
if(AjxPackage.define("ajax.dwt.widgets.DwtMenuItem")){
DwtMenuItem=function(a){
if(arguments.length==0){
return
}
a=Dwt.getParams(arguments,DwtMenuItem.PARAMS);
var t=a.parent;
if(!(t instanceof DwtMenu)){
throw new DwtException("Parent must be a DwtMenu object",DwtException.INVALIDPARENT,"DwtMenuItem")
}
var e=a.style=a.style||DwtMenuItem.NO_STYLE;
if(t._style==DwtMenu.BAR_STYLE&&e!=DwtMenuItem.PUSH_STYLE){
throw new DwtException("DwtMenuItemInit: invalid style",DwtException.INVALID_PARAM,"DwtMenuItem")
}
e&=~DwtLabel.IMAGE_RIGHT;
e|=DwtButton.ALWAYS_FLAT|DwtLabel.IMAGE_LEFT;
a.className=(e&DwtMenuItem.SEPARATOR_STYLE)?"ZMenuItemSeparator":(a.className||"ZMenuItem");
a.listeners=DwtMenuItem._listeners;
DwtButton.call(this,a);
this.setDropDownImages("Cascade","Cascade","Cascade","Cascade");
this._radioGroupId=a.radioGroupId;
if(t._addItem){
t._addItem(this,a.index)
}
if(!(e&DwtMenuItem.SEPARATOR_STYLE)){
this.addSelectionListener(new AjxListener(this,this.__handleItemSelect))
}};
DwtMenuItem.PARAMS=["parent","style","radioGroupId","index","className","posStyle"];
DwtMenuItem.prototype=new DwtButton;
DwtMenuItem.prototype.constructor=DwtMenuItem;
DwtMenuItem.prototype.toString=function(){
return"DwtMenuItem"
};
DwtMenuItem.CHECKED=1;
DwtMenuItem.UNCHECKED=2;
DwtMenuItem.NO_STYLE=0;
DwtMenuItem.CHECK_STYLE=DwtButton._LAST_STYLE*2;
DwtMenuItem.RADIO_STYLE=DwtButton._LAST_STYLE*4;
DwtMenuItem.SEPARATOR_STYLE=DwtButton._LAST_STYLE*8;
DwtMenuItem.CASCADE_STYLE=DwtButton._LAST_STYLE*16;
DwtMenuItem.PUSH_STYLE=DwtButton._LAST_STYLE*32;
DwtMenuItem.SELECT_STYLE=DwtButton._LAST_STYLE*64;
DwtMenuItem._LAST_STYLE=DwtMenuItem.SELECT_STYLE;
DwtMenuItem._MENU_POPUP_DELAY=250;
DwtMenuItem._MENU_POPDOWN_DELAY=250;
DwtMenuItem.prototype.TEMPLATE="dwt.Widgets#ZMenuItem";
DwtMenuItem.prototype.SEPARATOR_TEMPLATE="dwt.Widgets#ZMenuItemSeparator";
DwtMenuItem.prototype.BLANK_CHECK_TEMPLATE="dwt.Widgets#ZMenuItemBlankCheck";
DwtMenuItem.prototype.BLANK_ICON_TEMPLATE="dwt.Widgets#ZMenuItemBlankIcon";
DwtMenuItem.prototype.BLANK_CASCADE_TEMPLATE="dwt.Widgets#ZMenuItemBlankCascade";
DwtMenuItem.prototype.dispose=function(){
delete this._checkEl;
DwtButton.prototype.dispose.call(this)
};
DwtMenuItem.create=function(t){
var e=new DwtMenuItem(t);
if(t.imageInfo){
e.setImage(t.imageInfo)
}
if(t.text){
e.setText(t.text)
}
e.setEnabled(t.enabled!==false);
return e
};
DwtMenuItem.prototype.getChecked=function(){
return this._itemChecked
};
DwtMenuItem.prototype.setChecked=function(t,e){
this._setChecked(t,null,e);
this.parent._checkItemAdded(this)
};
DwtMenuItem.prototype.setImage=function(e){
DwtButton.prototype.setImage.call(this,e);
this.parent._iconItemAdded(this)
};
DwtMenuItem.prototype.setText=function(e){
DwtButton.prototype.setText.call(this,e);
if(this.parent.isPoppedUp()){
this.parent.render()
}};
DwtMenuItem.prototype.setMenu=function(a,e,t){
DwtButton.prototype.setMenu.call(this,a,e,t);
this.parent._submenuItemAdded(this)
};
DwtMenuItem.prototype.setHoverDelay=function(e){
this._hoverDelay=e
};
DwtMenuItem.prototype.setShortcut=function(e){
if(e&&this._dropDownEl){
this._dropDownEl.innerHTML=e
}};
DwtMenuItem.prototype._createHtml=function(e){
var t=(this._style&DwtMenuItem.SEPARATOR_STYLE)?this.SEPARATOR_TEMPLATE:this.TEMPLATE;
DwtButton.prototype._createHtml.call(this,e||t)
};
DwtMenuItem.prototype._createHtmlFromTemplate=function(e,t){
DwtButton.prototype._createHtmlFromTemplate.call(this,e,t);
this._checkEl=document.getElementById(t.id+"_check")
};
DwtMenuItem.prototype._setChecked=function(s,n,t){
var e=this._style&DwtMenuItem.CHECK_STYLE;
var o=this._style&DwtMenuItem.RADIO_STYLE;
if((e||o)&&this._itemChecked!=s){
this._itemChecked=s;
if(this._checkEl){
this._checkEl.innerHTML="";
var a=s?(e?"MenuCheck":"MenuRadio"):"Blank_9";
AjxImg.setImage(this._checkEl,a);
if(s){
if(o){
this.parent._radioItemSelected(this,t)
}}}}};
DwtMenuItem.prototype._checkItemAdded=function(e){};
DwtMenuItem.prototype._checkedItemsRemoved=function(){};
DwtMenuItem.prototype._submenuItemAdded=function(){
if(this._style&DwtMenuItem.SEPARATOR_STYLE){
return
}
if(this._cascCell==null){
this._cascCell=this._row.insertCell(-1);
this._cascCell.noWrap=true;
this._cascCell.style.width=DwtMenuItem._CASCADE_DIM;
this._cascCell.style.height=(this._style!=DwtMenuItem.SEPARATOR_STYLE)?DwtMenuItem._CASCADE_DIM:DwtMenuItem._SEPAARATOR_DIM
}};
DwtMenuItem.prototype._submenuItemRemoved=function(){
if(this._dropDownEl){
this._dropDownEl.innerHTML=""
}};
DwtMenuItem.prototype._popupMenu=function(n,m){
var e=this.getMenu();
var t=this.parent.parent;
var d=this.getBounds();
var r=e.shell.getSize();
var f=e.getSize();
var u;
var h;
var o;
var c;
var a=t.getHtmlElement();
if(t._style==DwtMenu.BAR_STYLE){
o=(a.style.borderLeftWidth=="")?0:parseInt(a.style.borderLeftWidth);
u=d.x+o;
c=(a.style.borderTopWidth=="")?0:parseInt(a.style.borderTopWidth);
c+=(a.style.borderBottomWidth=="")?0:parseInt(a.style.borderBottonWidth);
h=d.y+d.height+c;
u=((u+f.x)>=r.x)?u-(u+f.x-r.x):u
}else{
o=(a.style.borderLeftWidth=="")?0:parseInt(a.style.borderLeftWidth);
o+=(a.style.borderRightWidth=="")?0:parseInt(a.style.borderRightWidth);
u=d.x+d.width+o;
c=(a.style.borderTopWidth=="")?0:parseInt(a.style.borderTopWidth);
h=d.y+c;
u=((u+f.x)>=r.x)?d.x-f.x-o:u
}
e.popup(n,u,h,m)
};
DwtMenuItem.prototype._popdownMenu=function(){
var e=this.getMenu();
if(e){
e.popdown()
}};
DwtMenuItem.prototype._isMenuPoppedUp=function(){
var e=this.getMenu();
return(e&&e.isPoppedUp())
};
DwtMenuItem.prototype.__handleItemSelect=function(e){
this.setDisplayState(DwtControl.NORMAL);
if(this.isStyle(DwtMenuItem.CHECK_STYLE)){
this._setChecked(!this._itemChecked,null,true);
e.detail=this.getChecked()?DwtMenuItem.CHECKED:DwtMenuItem.UNCHECKED
}else{
if(this.isStyle(DwtMenuItem.RADIO_STYLE)){
this._setChecked(true,true);
this.parent._radioItemSelected(this,true);
e.detail=this.getChecked()?DwtMenuItem.CHECKED:DwtMenuItem.UNCHECKED
}else{
if(this.isStyle(DwtMenuItem.PUSH_STYLE)){
if(this._menu){
if(this._isMenuPoppedUp()){
DwtMenu.closeActiveMenu()
}else{
this._popupMenu()
}}
return
}}}
if(!this.isStyle(DwtMenuItem.CASCADE_STYLE)){
if(!this._menu||!this._menu.isPoppedUp||!this._menu.isPoppedUp()){
DwtMenu.closeActiveMenu()
}}};
DwtMenuItem._mouseOverListener=function(a){
var e=a.dwtObj;
if(!e){
return false
}
var o=e.parent;
if(o._hoveredItem){
var t=new DwtMouseEvent();
t.dwtObj=o._hoveredItem;
DwtButton._mouseOutListener(t)
}
if(e._style&DwtMenuItem.SEPARATOR_STYLE){
return false
}
DwtButton._mouseOverListener(a,e);
o._hoveredItem=e;
o._popdownSubmenus();
if(e._menu&&!a.ersatz){
e._popupMenu(e._hoverDelay)
}};
DwtMenuItem._mouseOutListener=function(a){
var t=a.dwtObj;
var e=t&&t.getMenu();
if(e&&e.isPoppedUp()){
return
}
DwtButton._mouseOutListener(a);
if(t){
t.parent._hoveredItem=null
}};
DwtMenuItem._listeners={};
DwtMenuItem._listeners[DwtEvent.ONMOUSEOVER]=new AjxListener(null,DwtMenuItem._mouseOverListener);
DwtMenuItem._listeners[DwtEvent.ONMOUSEOUT]=new AjxListener(null,DwtMenuItem._mouseOutListener);
DwtMenuItem._listeners[DwtEvent.ONMOUSEDOWN]=new AjxListener(null,DwtButton._mouseDownListener);
DwtMenuItem._listeners[DwtEvent.ONMOUSEUP]=new AjxListener(null,DwtButton._mouseUpListener);
DwtMenuItem._listeners[DwtEvent.ONMOUSEENTER]=new AjxListener(null,DwtMenuItem._mouseOverListener);
DwtMenuItem._listeners[DwtEvent.ONMOUSELEAVE]=new AjxListener(null,DwtButton._mouseOutListener)
}
if(AjxPackage.define("ajax.dwt.widgets.DwtMenu")){
DwtMenu=function(n){
if(arguments.length==0){
return
}
n=Dwt.getParams(arguments,DwtMenu.PARAMS);
this._origStyle=n.style;
var a=n.parent;
if(a){
if(a instanceof DwtMenuItem||a instanceof DwtButton){
if(n.style==DwtMenu.GENERIC_WIDGET_STYLE){
this._style=n.style
}else{
this._style=DwtMenu.DROPDOWN_STYLE
}}else{
this._style=n.style||DwtMenu.POPUP_STYLE
}
if(!n.posStyle){
n.posStyle=(this._style==DwtMenu.BAR_STYLE)?DwtControl.STATIC_STYLE:DwtControl.ABSOLUTE_STYLE
}}
n.className=n.className||"DwtMenu";
this._cascade=n.cascade==null||n.cascade;
n.parent=(a instanceof DwtShell)?a:a.shell;
DwtComposite.call(this,n);
this.parent=a;
var e=(this._style==DwtMenu.POPUP_STYLE||this._style==DwtMenu.DROPDOWN_STYLE);
if(e&&!this._cascade){
this.setScrollStyle(DwtControl.SCROLL)
}
if(!a){
return
}
var t=AjxEnv.isIE?[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP]:[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP,DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT];
this._setEventHdlrs(t);
this._hasSetMouseEvents=true;
var o=this.getHtmlElement();
if(n.posStyle!=DwtControl.STATIC_STYLE){
Dwt.setLocation(o,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE)
}
if(this._style!=DwtMenu.COLOR_PICKER_STYLE&&this._style!=DwtMenu.CALENDAR_PICKER_STYLE&&this._style!=DwtMenu.GENERIC_WIDGET_STYLE){
this._table=document.createElement("table");
this._table.border=this._table.cellPadding=this._table.cellSpacing=0;
this._table.className="DwtMenuTable";
o.appendChild(this._table);
this._table.backgroundColor=DwtCssStyle.getProperty(o,"background-color")
}
if(n.style!=DwtMenu.BAR_STYLE){
this.setZIndex(Dwt.Z_HIDDEN);
this._isPoppedUp=false
}else{
DwtMenu._activeMenuIds.add(o.id,null,true);
this._isPoppedUp=true
}
this._popdownAction=new AjxTimedAction(this,this._doPopdown);
this._popdownActionId=-1;
this._popupAction=new AjxTimedAction(this,this._doPopup);
this._popupActionId=-1;
if(AjxEnv.isIE){
if((this.parent instanceof DwtMenuItem&&this.parent.parent._style==DwtMenu.BAR_STYLE)||!(this.parent instanceof DwtMenuItem)){
this._outsideListener=new AjxListener(null,DwtMenu._outsideMouseDownListener)
}}
this._menuItemsHaveChecks=false;
this._menuItemsHaveIcons=false;
this._menuItemsWithSubmenus=0;
this.__currentItem=null;
this.__preventMenuFocus=false;
this._menuCapObj=new DwtMouseEventCapture({
targetObj:this,id:"DwtMenu",mouseDownHdlr:DwtMenu._capMouseDownHdlr,mouseWheelHdlr:DwtMenu._capMouseWheelHdlr,hardCapture:false}
);
this._tabGroup=new DwtTabGroup(this.toString(),true);
this._tabGroup.addMember(this)
};
DwtMenu.PARAMS=["parent","style","className","posStyle","cascade"];
DwtMenu.prototype=new DwtComposite;
DwtMenu.prototype.constructor=DwtMenu;
DwtMenu.prototype.toString=function(){
return"DwtMenu"
};
DwtMenu.BAR_STYLE=1;
DwtMenu.POPUP_STYLE=2;
DwtMenu.DROPDOWN_STYLE=3;
DwtMenu.COLOR_PICKER_STYLE=4;
DwtMenu.CALENDAR_PICKER_STYLE=5;
DwtMenu.GENERIC_WIDGET_STYLE=6;
DwtMenu.HAS_ICON="ZHasIcon";
DwtMenu.HAS_CHECK="ZHasCheck";
DwtMenu.HAS_SUBMENU="ZHasSubMenu";
DwtMenu._activeMenuUp=false;
DwtMenu._activeMenuIds=new AjxVector();
DwtMenu._activeMenus=new AjxVector();
DwtMenu.prototype.dispose=function(){
this._table=null;
DwtComposite.prototype.dispose.call(this);
if(!(this.parent instanceof DwtShell)){
this.shell.removeChild(this)
}};
DwtMenu.prototype.addPopupListener=function(e){
this.addListener(DwtEvent.POPUP,e)
};
DwtMenu.prototype.removePopupListener=function(e){
this.removeListener(DwtEvent.POPUP,e)
};
DwtMenu.prototype.addPopdownListener=function(e){
this.addListener(DwtEvent.POPDOWN,e)
};
DwtMenu.prototype.removePopdownListener=function(e){
this.removeListener(DwtEvent.POPDOWN,e)
};
DwtMenu.prototype.getItem=function(e){
return this._children.get(e)
};
DwtMenu.prototype.getItemById=function(a,n){
var e=this.getItems();
for(var t=0;
t<e.length;
t++){
var o=e[t].getData(a);
if(o==n){
return e[t]
}}
return null
};
DwtMenu.prototype.getItemCount=function(){
return this._children.size()
};
DwtMenu.prototype.getItems=function(){
return this._children.getArray()
};
DwtMenu.prototype.getSelectedItem=function(n){
var e=this._children.getArray();
for(var o=0;
o<e.length;
o++){
var t=e[o];
if((n==null||(t._style&&n!=0))&&t.getChecked()){
return t
}}
return null
};
DwtMenu.prototype.isPoppedUp=function(){
return this._isPoppedUp
};
DwtMenu.prototype.popup=function(a,e,o,t){
if(this._style==DwtMenu.BAR_STYLE){
return
}
if(this._popdownActionId!=-1){
AjxTimedAction.cancelAction(this._popdownActionId);
this._popdownActionId=-1
}else{
if(this._isPoppedUp||(this._popupActionId!=-1&&a&&a>0)){
return
}else{
if(this._popupActionId!=-1){
AjxTimedAction.cancelAction(this._popupActionId);
this._popupActionId=-1
}}
if(!a){
this._doPopup(e,o,t)
}else{
this._popupAction.args=[e,o,t];
this._popupActionId=AjxTimedAction.scheduleAction(this._popupAction,a)
}}};
DwtMenu.prototype.popdown=function(e){
if(this._style==DwtMenu.BAR_STYLE){
return
}
if(this._popupActionId!=-1){
AjxTimedAction.cancelAction(this._popupActionId);
this._popupActionId=-1
}else{
if(!this._isPoppedUp||this._popdownActionId!=-1){
return
}
if(e==null||e==0){
this._doPopdown()
}else{
this._popdownActionId=AjxTimedAction.scheduleAction(this._popdownAction,e)
}}};
DwtMenu.prototype.render=function(m,d){
var p=this.shell.getSize();
var q=this.getSize();
p.y-=10+(AjxEnv.isIE?20:0);
p.x-=28;
var t=(this._style==DwtMenu.POPUP_STYLE||this._style==DwtMenu.DROPDOWN_STYLE);
var w=this._cascade;
if(t&&w){
var z=p.y;
var T=null;
var u=this._table.rows;
var a=u.length;
var g=q.y;
var c=z-25;
for(var k=a-1;
k>=0;
k--){
g-=Dwt.getSize(u[k]).y;
if(g<c){
break
}}
var h=k+1;
for(var v=h;
v<a;
v++){
var r=u[(v-h)%h];
var e=r.insertCell(-1);
e.className="DwtMenuCascadeCell";
var s=u[v].cells[0].firstChild;
while(s!=null){
e.appendChild(s);
s=s.nextSibling
}}
for(v=u.length-1;
v>=h;
v--){
this._table.deleteRow(h)
}
var n=a%h;
if(n>0){
for(var v=n;
v<h;
v++){
var r=u[v];
var e=r.insertCell(-1);
e.className="DwtMenuCascadeCell";
e.empty=true;
e.innerHTML="&nbsp;"
}}
q=this.getSize();
if(T){
d=T-q.y
}}else{
if(t&&!w){
if(d+q.y>p.y){
q.y=p.y-d
}}}
var O=m+q.x>=p.x?p.x-q.x:m;
var T=t&&d+q.y>=p.y?p.y-q.y:d;
this.setLocation(O,T);
var A="auto";
var o=(t&&w)||d+q.y<p.y-5?"auto":p.y-d-5;
this.setSize(A,o);
if((AjxEnv.isGeckoBased||AjxEnv.isSafari||(this._origStyle==DwtMenu.CALENDAR_PICKER_STYLE))&&this._table){
var f=this.getHtmlElement();
f.style.width=(q.x+(t&&!w?10:0))+"px"
}};
DwtMenu.prototype.getKeyMapName=function(){
return"DwtMenu"
};
DwtMenu.prototype.handleKeyAction=function(e,t){
switch(this._style){
case DwtMenu.BAR_STYLE:case DwtMenu.POPUP_STYLE:case DwtMenu.DROPDOWN_STYLE:break;
default:return false
}
switch(e){
case DwtKeyMap.SELECT_NEXT:case DwtKeyMap.SELECT_PREV:this.setSelectedItem(e==DwtKeyMap.SELECT_NEXT);
break;
case DwtKeyMap.SELECT:if(this.__currentItem){
this.__currentItem._emulateSingleClick()
}
break;
case DwtKeyMap.SUBMENU:if(this.__currentItem&&this.__currentItem._menu){
this.__currentItem._popupMenu(0,true)
}
break;
case DwtKeyMap.PARENTMENU:if(this.parent instanceof DwtMenuItem){
this.popdown(0)
}
break;
case DwtKeyMap.CANCEL:if(this.__currentItem){
var a=new DwtMouseEvent();
this._setMouseEvent(a,{
dwtObj:this.__currentItem}
);
this.notifyListeners(DwtEvent.ONMOUSEOUT,a);
this.__currentItem=null
}
this.popdown(0);
break;
default:return false
}
return true
};
DwtMenu.prototype._focus=function(){};
DwtMenu.prototype._blur=function(){};
DwtMenu.prototype.setAssociatedObj=function(e){
this._associatedObj=e
};
DwtMenu.prototype.setAssociatedElementId=function(e){
this._associatedElId=e
};
DwtMenu.prototype.checkItem=function(s,n,a){
var e=this._children.getArray();
for(var t=0;
t<e.length;
t++){
var o=e[t];
if(!(o.isStyle(DwtMenuItem.CHECK_STYLE)||o.isStyle(DwtMenuItem.RADIO_STYLE))){
continue
}
var r=o.getData(s);
if(r==n){
o.setChecked(true,a)
}}};
DwtMenu.prototype.setSelectedItem=function(t){
var e=this.__currentItem;
if(typeof(t)=="boolean"){
e=!e?this._children.get(0):t?this._children.getNext(e):this._children.getPrev(e)
}else{
e=this._children.get(t)
}
while(e&&(e.isStyle(DwtMenuItem.SEPARATOR_STYLE)||!e.getEnabled()||!e.getVisible())){
e=(t===false)?this._children.getPrev(e):this._children.getNext(e)
}
if(!e){
return
}
var a=new DwtMouseEvent();
if(this.__currentItem){
this._setMouseEvent(a,{
dwtObj:this.__currentItem}
);
this.__currentItem.notifyListeners(DwtEvent.ONMOUSEOUT,a)
}
this._setMouseEvent(a,{
dwtObj:e}
);
e.notifyListeners(DwtEvent.ONMOUSEOVER,a);
this.__currentItem=e
};
DwtMenu.prototype.clearExternallySelectedItems=function(){
if(this._externallySelected!=null){
this._externallySelected._deselect();
this._externallySelected=null
}};
DwtMenu.prototype.removeChild=function(a){
if(this._table){
if(this._style==DwtMenu.BAR_STYLE){
var e=a.getHtmlElement().parentNode;
this._table.rows[0].deleteCell(Dwt.getCellIndex(e))
}else{
var t=a.getHtmlElement();
if(t){
this._table.deleteRow(t.parentNode.parentNode.rowIndex)
}}}
this._children.remove(a)
};
DwtMenu.prototype.addChild=function(e){
DwtComposite.prototype.addChild.apply(this,arguments);
if(Dwt.instanceOf(e,"DwtColorPicker")||Dwt.instanceOf(e,"DwtCalendar")||(this._style==DwtMenu.GENERIC_WIDGET_STYLE)){
this._addItem(e)
}};
DwtMenu.prototype._addItem=function(o,t){
if(this._style==DwtMenu.COLOR_PICKER_STYLE||this._style==DwtMenu.CALENDAR_PICKER_STYLE||this._style==DwtMenu.GENERIC_WIDGET_STYLE){
return
}
var s;
var e;
if(this._style==DwtMenu.BAR_STYLE){
var n=this._table.rows;
s=(n.length!=0)?n[0]:this._table.insertRow(0);
if(t==null||t>s.cells.length){
t=n.cells.length
}
e=s.insertCell(t);
e.align="center";
e.vAlign="middle";
var a=s.insertCell(-1);
a.nowrap=true;
a.width="7px"
}else{
if(o.isStyle&&(o.isStyle(DwtMenuItem.CHECK_STYLE)||o.isStyle(DwtMenuItem.RADIO_STYLE))){
this._checkItemAdded()
}
if(t==null||t>this._table.rows.length){
t=-1
}
s=this._table.insertRow(t);
e=s.insertCell(0)
}
e.noWrap=true;
e.appendChild(o.getHtmlElement())
};
DwtMenu.prototype._radioItemSelected=function(r,n){
var t=r._radioGroupId;
var s=this._children.size();
var e=this._children.getArray();
for(var o=0;
o<s;
o++){
if(e[o]!=r&&e[o].isStyle(DwtMenuItem.RADIO_STYLE)&&e[o]._radioGroupId==t&&e[o]._itemChecked){
e[o].setChecked(false,n);
break
}}};
DwtMenu.prototype._menuHasCheckedItems=function(){
return this._menuItemsHaveChecks
};
DwtMenu.prototype._menuHasItemsWithIcons=function(){
return this._menuItemsHaveIcons
};
DwtMenu.prototype._menuHasSubmenus=function(){
return(this._menuItemsWithSubmenus>0)
};
DwtMenu.prototype._iconItemAdded=function(e){
if(!this._menuItemsHaveIcons){
Dwt.addClass(this.getHtmlElement(),DwtMenu.HAS_ICON)
}
this._menuItemsHaveIcons=true
};
DwtMenu.prototype._checkItemAdded=function(e){
if(!this._menuItemsHaveChecks){
Dwt.addClass(this.getHtmlElement(),DwtMenu.HAS_CHECK)
}
this._menuItemsHaveChecks=true
};
DwtMenu.prototype._submenuItemAdded=function(){
Dwt.addClass(this.getHtmlElement(),DwtMenu.HAS_SUBMENU);
this._menuItemsWithSubmenus++
};
DwtMenu.prototype._submenuItemRemoved=function(){
if(this._menuItemsWithSubmenus==1){
var o=this._children.size();
var e=this._children.getArray();
for(var t=0;
t<o;
t++){
e[t]._submenuItemRemoved()
}}
this._menuItemsWithSubmenus--;
if(this._menuItemsWithSubmenus==0){
Dwt.delClass(this.getHtmlElement(),DwtMenu.HAS_SUBMENU)
}};
DwtMenu.prototype._popdownSubmenus=function(){
var o=this._children.size();
var e=this._children.getArray();
for(var t=0;
t<o;
t++){
e[t]._popdownMenu()
}};
DwtMenu.prototype.dontStealFocus=function(e){
if(e==null){
e=true
}
this.__preventMenuFocus=!!e
};
DwtMenu.prototype._doPopup=function(e,r,n){
this.render(e,r);
var t=(this._style==DwtMenu.POPUP_STYLE||this._style==DwtMenu.DROPDOWN_STYLE);
var a=this._cascade;
this.setScrollStyle(t&&a?Dwt.CLIP:Dwt.SCROLL);
this.notifyListeners(DwtEvent.POPUP,this);
var o=this.shell.getToolTip();
if(o){
o.popdown()
}
var s=DwtBaseDialog.getActiveDialog()?Dwt.Z_DIALOG_MENU:Dwt.Z_MENU;
this.setZIndex(s);
this._popupActionId=-1;
this._isPoppedUp=true;
if(AjxEnv.isIE&&this._outsideListener){
this.shell._setEventHdlrs([DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEWHEEL]);
this.shell.addListener(DwtEvent.ONMOUSEDOWN,this._outsideListener);
this.shell.addListener(DwtEvent.ONMOUSEWHEEL,this._outsideListener)
}
if(!DwtMenu._activeMenu){
DwtMenu._activeMenu=this;
DwtMenu._activeMenuUp=true;
if(AjxEnv.isIE){
DwtEventManager.addListener(DwtEvent.ONMOUSEDOWN,DwtMenu._outsideMouseDownListener);
DwtEventManager.addListener(DwtEvent.ONMOUSEWHEEL,DwtMenu._outsideMouseDownListener)
}}
DwtMenu._activeMenuIds.add(this._htmlElId,null,true);
DwtMenu._activeMenuIds.sort();
DwtMenu._activeMenus.add(this,null,true);
if(!this._menuCapObj.capturing()){
this._menuCapObj.capture();
this._capturing=true
}else{
this._capturing=false
}
if(!this.__preventMenuFocus){
DwtShell.getShell(window).getKeyboardMgr().pushTabGroup(this._tabGroup)
}
if(n){
this.handleKeyAction(DwtKeyMap.SELECT_NEXT)
}};
DwtMenu.prototype.getSize=function(e){
if(this._table){
return Dwt.getSize(this._table,e)
}
return DwtComposite.prototype.getSize.call(this,e)
};
DwtMenu.prototype._doPopdown=function(){
var c=this._children.getArray();
var m=this._children.size();
for(var n=0;
n<m;
n++){
if((c[n] instanceof DwtMenuItem)&&!(c[n].isStyle(DwtMenuItem.SEPARATOR_STYLE))){
c[n]._popdownMenu()
}}
this.setZIndex(Dwt.Z_HIDDEN);
this.setLocation(Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
this.notifyListeners(DwtEvent.POPDOWN,this);
if(AjxEnv.isIE&&this._outsideListener){
this.shell._setEventHdlrs([DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEWHEEL],true);
this.shell.removeListener(DwtEvent.ONMOUSEDOWN,this._outsideListener);
this.shell.removeListener(DwtEvent.ONMOUSEWHEEL,this._outsideListener)
}
if(DwtMenu._activeMenu==this){
DwtMenu._activeMenu=null;
DwtMenu._activeMenuUp=false;
if(AjxEnv.isIE){
DwtEventManager.removeListener(DwtEvent.ONMOUSEDOWN,DwtMenu._outsideMouseDownListener);
DwtEventManager.removeListener(DwtEvent.ONMOUSEWHEEL,DwtMenu._outsideMouseDownListener)
}}
DwtMenu._activeMenuIds.remove(this._htmlElId);
DwtMenu._activeMenus.remove(this);
this._popdownActionId=-1;
this._isPoppedUp=false;
if(this._capturing&&(DwtMouseEventCapture.getId()=="DwtMenu")){
this._menuCapObj.release();
this._capturing=false
}
if((this._style==DwtMenu.POPUP_STYLE||this._style==DwtMenu.DROPDOWN_STYLE)&&this._table.rows.length&&this._table.rows[0].cells.length){
var t=this._table.rows[0].cells.length;
var r=this._table.rows.length;
for(var n=1;
n<t;
n++){
for(var o=0;
o<r;
o++){
var d=this._table.rows[o].cells[n];
if(!d.empty){
var e=d.firstChild;
var u=this._table.insertRow(this._table.rows.length);
var d=u.insertCell(0);
while(e!=null){
d.appendChild(e);
e=e.nextSibling
}}}}
for(var o=0;
o<r;
o++){
var u=this._table.rows[o];
for(var n=u.cells.length-1;
n>0;
n--){
u.deleteCell(n)
}}}
this.__currentItem=null;
if(this._hoveredItem){
var h=new DwtMouseEvent();
h.dwtObj=this._hoveredItem;
DwtButton._mouseOutListener(h)
}
DwtShell.getShell(window).getKeyboardMgr().popTabGroup(this._tabGroup)
};
DwtMenu.prototype._getActiveItem=function(){
var e=this._children.getArray();
var o=this._children.size();
for(var t=0;
t<o;
t++){
if(e[t]._isMenuPoppedUp()){
return e[t]
}}
return null
};
DwtMenu._outsideMouseDownListener=function(a){
if(DwtMenu._activeMenuUp){
var n=DwtMenu._activeMenu;
var e=DwtControl.getTargetControl(a);
if(n._associatedObj&&n._associatedObj==e){
return false
}
var s=n._htmlElId;
var o=DwtUiEvent.getTarget(a);
while(o!=null){
if(o.id&&o.id!=""&&(o.id==s||o.id==n._associatedElId||DwtMenu._activeMenuIds.binarySearch(o.id)!=-1)){
return false
}
o=o.parentNode
}
n.popdown();
var t=null;
do{
t=DwtMenu._activeMenus.getLast();
if(t!=null&&t instanceof DwtMenu){
t.popdown()
}}
while(t!=null)
}
a._stopPropagation=false;
a._returnValue=true;
return true
};
DwtMenu._capMouseDownHdlr=function(t){
var a=DwtMouseEventCapture.getTargetObj();
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
DwtMenu._outsideMouseDownListener(e);
DwtUiEvent.setBehaviour(t,false,true);
return true
};
DwtMenu._capMouseWheelHdlr=function(e){
return DwtMenu._capMouseDownHdlr(e)
};
DwtMenu.menuShowing=function(){
return DwtMenu._activeMenuUp
};
DwtMenu.closeActiveMenu=function(){
if(DwtMenu._activeMenuUp){
DwtMenu._activeMenu.popdown()
}}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtInputField")){
DwtInputField=function(h){
if(arguments.length==0){
return
}
this._origClassName=h.className?h.className:"DwtInputField";
this._errorClassName=this._origClassName+"-Error";
this._hintClassName=this._origClassName+"-hint";
this._disabledClassName=this._origClassName+"-disabled";
this._errorHintClassName=this._origClassName+"-errorhint";
DwtComposite.call(this,h);
this._inputEventHandlers={};
this._type=h.type?h.type:DwtInputField.STRING;
this._rows=h.rows?h.rows:1;
this._size=h.size;
this._errorIconStyle=h.errorIconStyle?h.errorIconStyle:h.validator?DwtInputField.ERROR_ICON_RIGHT:DwtInputField.ERROR_ICON_NONE;
this._validationStyle=h.validationStyle?h.validationStyle:DwtInputField.ONEXIT_VALIDATION;
this._hasError=false;
this._hintIsVisible=false;
this._hint=h.hint;
var r=h.inputID||Dwt.getNextId();
var s=Dwt.getNextId();
var n=this.getHtmlElement();
if(this._errorIconStyle==DwtInputField.ERROR_ICON_NONE){
if(h.forceMultiRow||(h.rows&&h.rows>1)){
var e=["<textarea id='",r,"' rows=",h.rows];
var o=e.length;
if(h.forceMultiRow||h.size){
e[o++]=" cols=";
e[o++]=h.size||1
}
if(h.wrap){
e[o++]=" wrap=";
e[o++]=h.wrap
}
e[o++]="></textarea>";
n.innerHTML=e.join("")
}else{
n.innerHTML=["<input id='",r,"'>"].join("")
}}else{
var e=["<table cellspacing='0' cellpadding='0'><tr>"];
var o=1;
if(this._errorIconStyle==DwtInputField.ERROR_ICON_LEFT){
e[o++]=["<td style='padding-right:2px;'id='",s,"'></td>"].join("")
}
e[o++]=["<td>","<input id='",r,"'>","</td>"].join("");
if(this._errorIconStyle==DwtInputField.ERROR_ICON_RIGHT){
e[o++]=["<td style='padding-left:2px;' id='",s,"'></td>"].join("")
}
e[o++]="</tr></table>";
n.innerHTML=e.join("");
if(this._errorIconStyle!=DwtInputField.ERROR_ICON_NONE){
this._errorIconTd=document.getElementById(s);
this._errorIconTd.vAlign="middle";
this._errorIconTd.innerHTML=DwtInputField._NOERROR_ICON_HTML
}}
this._tabGroup=new DwtTabGroup(this._htmlElId);
if(h.forceMultiRow||this._rows>1){
this._inputField=document.getElementById(r);
this._inputField.onkeyup=DwtInputField._keyUpHdlr;
this._inputField.onblur=DwtInputField._blurHdlr;
this._inputField.onfocus=DwtInputField._focusHdlr;
if(h.size){
this._inputField.size=h.size
}
if(h.maxLen){
this._inputField.maxLength=this._maxLen=h.maxLen
}
this._inputField.value=h.initialValue||"";
this._tabGroup.addMember(this._inputField)
}else{
var t=document.getElementById(r);
var a=this.__createInputEl(h);
if(AjxEnv.isCamino){
t.parentNode.style.overflow="hidden"
}
t.parentNode.replaceChild(a,t)
}
this.setValidatorFunction(h.validatorCtxtObj,h.validator);
this._setMouseEventHdlrs(false);
this._setKeyPressEventHdlr(false);
if(h.required!=null){
this.setRequired(h.required)
}};
DwtInputField.prototype=new DwtComposite;
DwtInputField.prototype.constructor=DwtInputField;
DwtInputField.prototype.toString=function(){
return"DwtInputField"
};
DwtInputField.ERROR_ICON_LEFT=1;
DwtInputField.ERROR_ICON_RIGHT=2;
DwtInputField.ERROR_ICON_NONE=3;
DwtInputField.CONTINUAL_VALIDATION=1;
DwtInputField.ONEXIT_VALIDATION=2;
DwtInputField.MANUAL_VALIDATION=3;
DwtInputField.NUMBER=1;
DwtInputField.INTEGER=2;
DwtInputField.FLOAT=3;
DwtInputField.STRING=4;
DwtInputField.PASSWORD=5;
DwtInputField.DATE=6;
DwtInputField._ERROR_ICON_HTML=AjxImg.getImageHtml("ClearSearch");
DwtInputField._NOERROR_ICON_HTML=AjxImg.getImageHtml("Blank_9");
DwtInputField.prototype.dispose=function(){
this._errorIconTd=null;
this._inputField=null;
DwtComposite.prototype.dispose.call(this)
};
DwtInputField.prototype.getTabGroupMember=function(){
return this._tabGroup
};
DwtInputField.prototype.setHandler=function(t,e){
if(!this._checkState()){
return
}
this._inputEventHandlers[t]=e;
Dwt.setHandler(this.getInputElement(),t,e)
};
DwtInputField.prototype.setInputType=function(a){
if(a!=this._type&&this._rows==1){
this._type=a;
if(AjxEnv.isIE){
var e=this._inputField;
var t=this.__createInputEl();
e.parentNode.replaceChild(t,e)
}else{
this._inputField.type=this._type!=DwtInputField.PASSWORD?"text":"password"
}}};
DwtInputField.prototype.setValidatorFunction=function(t,e){
if(e){
this._validator=e;
this._validatorObj=t
}else{
switch(this._type){
case DwtInputField.NUMBER:this._validator=DwtInputField.validateNumber;
break;
case DwtInputField.INTEGER:this._validator=DwtInputField.validateInteger;
break;
case DwtInputField.FLOAT:this._validator=DwtInputField.validateFloat;
break;
case DwtInputField.STRING:case DwtInputField.PASSWORD:this._validator=DwtInputField.validateString;
break;
case DwtInputField.DATE:this._validator=DwtInputField.validateDate;
break;
default:this._validator=DwtInputField.validateAny
}}};
DwtInputField.prototype.setValidatorRegExp=function(e,t){
this._validator=e;
this._validatorObj=null;
this._errorString=t||""
};
DwtInputField.prototype.setValidationCallback=function(e){
this._validationCallback=e
};
DwtInputField.prototype.getInputElement=function(){
return this._inputField
};
DwtInputField.prototype.getValue=function(){
return this._hintIsVisible?"":this._inputField.value
};
DwtInputField.prototype.setValue=function(t,e){
t=t||"";
this._inputField.value=t;
if(!e){
t=this._validateInput(t);
if(t!=null){
this._inputField.value=t
}}
if(this._hintIsVisible&&t){
this._hideHint(t)
}else{
if(!t){
this._showHint()
}}};
DwtInputField.prototype.setHint=function(t){
var e=this._hint;
this._hint=t;
if(this._hintIsVisible){
this.getInputElement().value=t;
if(!t){
this._hintIsVisible=false;
this._updateClassName()
}}else{
if(this._inputField.value==""){
this._showHint()
}}};
DwtInputField.prototype.setValidNumberRange=function(t,e){
this._minNumVal=t;
this._maxNumVal=e;
var a=this._validateInput(this.getValue());
if(a!=null){
this.setValue(a)
}};
DwtInputField.prototype.setValidStringLengths=function(t,e){
this._minLen=t||0;
if(e!=null){
this._inputField.maxLength=e;
this._maxLen=e
}};
DwtInputField.prototype.setNumberPrecision=function(e){
this._decimals=e
};
DwtInputField.prototype.setReadOnly=function(e){
this._inputField.setAttribute("readonly",(e==null?true:e))
};
DwtInputField.prototype.setRequired=function(t){
var e=t==null?true:t;
if(this._required!=e){
this._required=e;
this.validate()
}};
DwtInputField.prototype.getEnabled=function(){
return !this.getInputElement().disabled
};
DwtInputField.prototype.setEnabled=function(e){
DwtControl.prototype.setEnabled.call(this,e);
this.getInputElement().disabled=!e;
this._validateInput(this.getValue())
};
DwtInputField.prototype.focus=function(){
if(this.getEnabled()){
this._hasFocus=true;
this.getInputElement().focus()
}};
DwtInputField.prototype.blur=function(){
this.getInputElement().blur()
};
DwtInputField.prototype.setVisible=function(e){
DwtComposite.prototype.setVisible.apply(this,arguments);
Dwt.setVisible(this.getInputElement(),e)
};
DwtInputField.prototype.isValid=function(){
if(!this.getEnabled()){
return this.getValue()
}
try{
if(typeof this._validator=="function"){
return this._validatorObj?this._validator.call(this._validatorObj,this.getValue(),this):this._validator(this.getValue())
}else{
return this._validator.test(this._inputField.value)
}}
catch(e){
if(typeof e=="string"){
return null
}else{
throw e
}}};
DwtInputField.prototype.validate=function(){
var e=this._validateInput(this.getValue());
if(e!=null){
this.setValue(e);
return true
}else{
return false
}};
DwtInputField.validateNumber=function(e){
var t=new Number(e);
if(isNaN(t)||(Math.round(t)!=t)){
throw AjxMsg.notAnInteger
}
return DwtInputField.validateFloat.call(this,e)
};
DwtInputField.validateInteger=function(e){
var t=new Number(e);
if(isNaN(t)||(Math.round(t)!=t)||(t.toString()!=e)){
throw AjxMsg.notAnInteger
}
if(this._minNumVal&&e<this._minNumVal){
throw AjxMessageFormat.format(AjxMsg.numberLessThanMin,this._minNumVal)
}
if(this._maxNumVal&&e>this._maxNumVal){
throw AjxMessageFormat.format(AjxMsg.numberMoreThanMax,this._maxNumVal)
}
return e
};
DwtInputField.validateFloat=function(e){
if(this._required&&e==""){
throw AjxMsg.valueIsRequired
}
var o=new Number(e);
if(isNaN(o)){
throw AjxMsg.notANumber
}
if(this._minNumVal&&e<this._minNumVal){
throw AjxMessageFormat.format(AjxMsg.numberLessThanMin,this._minNumVal)
}
if(this._maxNumVal&&e>this._maxNumVal){
throw AjxMessageFormat.format(AjxMsg.numberMoreThanMax,this._maxNumVal)
}
if(this._decimals!=null){
var t=o.toString();
var a=t.indexOf(".");
if(a==-1){
a=t.length
}
e=o.toPrecision(a+this._decimals)
}else{
e=o.toString()
}
return e
};
DwtInputField.validateString=function(e){
if(this._required&&e==""){
throw AjxMsg.valueIsRequired
}
if(this._minLen!=null&&e.length<this._minLen){
throw AjxMessageFormat.format(AjxMsg.stringTooShort,this._minLen)
}
if(this._maxLen!=null&&e.length>this._maxLen){
throw AjxMessageFormat.format(AjxMsg.stringTooLong,this._maxLen)
}
return e
};
DwtInputField.validateDate=function(e){
if(this._required&&e==""){
throw AjxMsg.valueIsRequired
}
if(AjxDateUtil.simpleParseDateStr(e)==null){
throw AjxMsg.invalidDatetimeString
}
return e
};
DwtInputField.validateEmail=function(e){
if(this._required&&e==""){
throw AjxMsg.valueIsRequired
}
if(!AjxEmailAddress.isValid(e)){
throw AjxMsg.invalidEmailAddr
}
return e
};
DwtInputField.validateAny=function(e){
if(this._required&&e==""){
throw AjxMsg.valueIsRequired
}
return e
};
DwtInputField.prototype._validateRegExp=function(e){
if(this._required&&e==""){
throw AjxMsg.valueIsRequired
}
if(this._regExp&&!this._regExp.test(e)){
throw this._errorString
}
return e
};
DwtInputField._keyUpHdlr=function(t){
var e=DwtShell.keyEvent;
e.setFromDhtmlEvent(t,true);
var o=e.dwtObj;
var a=e.keyCode;
if(o.notifyListeners(DwtEvent.ONKEYUP,e)){
return true
}
var n=null;
if((a==13||a==9)&&o._validationStyle==DwtInputField.ONEXIT_VALIDATION){
n=o._validateInput(o.getValue())
}else{
if(o._validationStyle==DwtInputField.CONTINUAL_VALIDATION){
n=o._validateInput(o.getValue())
}}
if(n!=null&&n!=o.getValue()){
o.setValue(n)
}
return true
};
DwtInputField._blurHdlr=function(e){
var t=DwtControl.getTargetControl(e);
if(t){
t._hasFocus=false;
if(t._validationStyle==DwtInputField.ONEXIT_VALIDATION){
var a=t._validateInput(t.getValue());
if(a!=null){
t.setValue(a)
}}
if(!t._hintIsVisible&&t._hint){
t._showHint()
}}};
DwtInputField._focusHdlr=function(e){
var t=DwtControl.getTargetControl(e);
if(t){
DwtShell.getShell(window).getKeyboardMgr().grabFocus(t.getTabGroupMember());
if(t._hintIsVisible){
t._hideHint("")
}}};
DwtInputField.prototype._hideHint=function(e){
this.getInputElement().value=e;
this._hintIsVisible=false;
this._updateClassName()
};
DwtInputField.prototype._showHint=function(){
if(this._hint){
var e=this.getInputElement();
if(!e.value){
e.value=this._hint;
this._hintIsVisible=true;
this._updateClassName()
}}};
DwtInputField.prototype._updateClassName=function(){
var e;
if(!this.getEnabled()){
e=this._disabledClassName
}else{
if(this._hasError){
if(this._hintIsVisible&&!this._hasFocus){
e=this._errorHintClassName
}else{
e=this._errorClassName
}}else{
if(this._hintIsVisible&&!this._hasFocus){
e=this._hintClassName
}else{
e=this._origClassName
}}}
this.getHtmlElement().className=e
};
DwtInputField.prototype._validateInput=function(a){
var n=true;
var o;
var t;
if(!this.getEnabled()){
o=this.getValue()
}else{
try{
if(typeof this._validator=="function"){
o=a=this._validatorObj?this._validator.call(this._validatorObj,a,this):this._validator(a)
}else{
if(!this._validator.test(a)){
t=this._errorString
}}}
catch(e){
if(typeof e=="string"){
t=e
}else{
throw e
}}}
if(t){
this._hasError=true;
if(this._errorIconTd){
this._errorIconTd.innerHTML=DwtInputField._ERROR_ICON_HTML
}
this.setToolTipContent(t);
n=false;
o=null
}else{
this._hasError=false;
if(this._errorIconTd){
this._errorIconTd.innerHTML=DwtInputField._NOERROR_ICON_HTML
}
this.setToolTipContent(null);
n=true
}
this._updateClassName();
if(this._validationCallback){
this._validationCallback.run(this,n,a)
}
return o
};
DwtInputField.prototype._focusByMouseUpEvent=function(){
if(this.getEnabled()){
this._hasFocus=true
}};
DwtInputField.prototype._replaceElementHook=function(t,a,e,o){
a=this.getInputElement();
DwtControl.prototype._replaceElementHook.call(this,t,a,e,o);
if(t.id){
a.id=t.id
}
if(t.size){
a.size=t.size
}
if(t.title){
this.setHint(t.title)
}};
DwtInputField.prototype.__createInputEl=function(r){
var t=this._inputField;
if(t){
for(var n in this._inputEventHandlers){
t.removeAttribute(n)
}}
var s=this._type!=DwtInputField.PASSWORD?"text":"password";
var o=document.createElement(AjxEnv.isIE?["<INPUT type='",s,"'>"].join(""):"INPUT");
if(!AjxEnv.isIE){
o.type=s
}
this._inputField=o;
var a=r?r.size:t.size;
var e=r?r.maxLen:t.maxLength;
o.autocomplete="off";
if(a){
o.size=a
}
if(e){
o.maxLength=e
}
o.value=(r?r.initialValue:t.value)||"";
o.readonly=t?t.readonly:false;
o.onkeyup=DwtInputField._keyUpHdlr;
o.onblur=DwtInputField._blurHdlr;
o.onfocus=DwtInputField._focusHdlr;
for(var n in this._inputEventHandlers){
o[n]=this._inputEventHandlers[n]
}
this._tabGroup.removeAllMembers();
this._tabGroup.addMember(o);
return o
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtBaseDialog")){
DwtBaseDialog=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtBaseDialog.PARAMS);
var e=t.parent;
if(!(e instanceof DwtShell)){
throw new DwtException("DwtBaseDialog parent must be a DwtShell",DwtException.INVALIDPARENT,"DwtDialog")
}
t.className=t.className||"DwtBaseDialog";
t.posStyle=DwtControl.ABSOLUTE_STYLE;
this._title=t.title||"";
DwtComposite.call(this,t);
this._shell=e;
this._zIndex=t.zIndex||Dwt.Z_DIALOG;
this._mode=t.mode||DwtBaseDialog.MODAL;
this._loc=new DwtPoint();
if(t.loc){
this._loc.x=t.loc.x;
this._loc.y=t.loc.y
}else{
this._loc.x=this._loc.y=Dwt.LOC_NOWHERE
}
this._tabGroup=new DwtTabGroup(this.toString(),true);
this._dragHandleId=t.dragHandleId||this._htmlElId+"_handle";
this._createHtml();
this._initializeDragging(this._dragHandleId);
if(t.view){
this.setView(t.view)
}
this.setZIndex(Dwt.Z_HIDDEN);
this._position(DwtBaseDialog.__nowhereLoc)
};
DwtBaseDialog.PARAMS=["parent","className","title","zIndex","mode","loc","view","dragHandleId"];
DwtBaseDialog.prototype=new DwtComposite;
DwtBaseDialog.prototype.constructor=DwtBaseDialog;
DwtBaseDialog.prototype.toString=function(){
return"DwtBaseDialog"
};
DwtBaseDialog.MODELESS=1;
DwtBaseDialog.MODAL=2;
DwtBaseDialog.__nowhereLoc=new DwtPoint(Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
DwtBaseDialog.prototype.TEMPLATE="dwt.Widgets#DwtBaseDialog";
DwtBaseDialog.prototype.CONTROLS_TEMPLATE=null;
DwtBaseDialog.prototype.addPopupListener=function(e){
this.addListener(DwtEvent.POPUP,e)
};
DwtBaseDialog.prototype.removePopupListener=function(e){
this.removeListener(DwtEvent.POPUP,e)
};
DwtBaseDialog.prototype.addPopdownListener=function(e){
this.addListener(DwtEvent.POPDOWN,e)
};
DwtBaseDialog.prototype.removePopdownListener=function(e){
this.removeListener(DwtEvent.POPDOWN,e)
};
DwtBaseDialog.prototype.popup=function(t){
if(this._poppedUp){
return
}
this.cleanup(true);
var e=this._zIndex;
if(this._mode==DwtBaseDialog.MODAL){
e=this._setModalEffect(e)
}
this._shell._veilOverlay.activeDialogs.push(this);
if(t){
this._loc.x=t.x;
this._loc.y=t.y
}
this._position(t);
this._resetTabFocus();
this.setZIndex(e);
this._poppedUp=true;
var a=this._shell.getKeyboardMgr();
a.pushTabGroup(this._tabGroup);
a.pushDefaultHandler(this);
this.notifyListeners(DwtEvent.POPUP,this)
};
DwtBaseDialog.prototype._resetTabFocus=function(){
this._tabGroup.resetFocusMember(true)
};
DwtBaseDialog.prototype.focus=function(){
if(this.isListenerRegistered(DwtEvent.ONFOCUS)){
this.notifyListeners(DwtEvent.ONFOCUS)
}else{
if(this._focusElementId){
var e=document.getElementById(this._focusElementId);
if(e){
e.focus()
}}}};
DwtBaseDialog.prototype.isPoppedUp=function(){
return this._poppedUp
};
DwtBaseDialog.prototype.popdown=function(){
if(this._poppedUp){
this._poppedUp=false;
this.cleanup(false);
var e=this._zIndex;
this.setZIndex(Dwt.Z_HIDDEN);
this._position(DwtBaseDialog.__nowhereLoc);
if(this._mode==DwtBaseDialog.MODAL){
this._undoModality(e)
}else{
this._shell._veilOverlay.activeDialogs.pop()
}
var t=this._shell.getKeyboardMgr();
t.popTabGroup(this._tabGroup);
t.popDefaultHandler();
this.notifyListeners(DwtEvent.POPDOWN,this)
}};
DwtBaseDialog.prototype.setView=function(e){
this.reset();
if(e){
this._getContentDiv().appendChild(e.getHtmlElement())
}};
DwtBaseDialog.prototype.reset=function(){
this._loc.x=this._loc.y=Dwt.LOC_NOWHERE
};
DwtBaseDialog.prototype.cleanup=function(t){
var o=this._getInputFields();
if(o){
var e=o.length;
for(var a=0;
a<e;
a++){
o[a].disabled=!t;
if(t){
o[a].value=""
}}}};
DwtBaseDialog.prototype.setTitle=function(e){
if(this._titleEl){
this._titleEl.innerHTML=e||""
}};
DwtBaseDialog.prototype.setContent=function(t){
var e=this._getContentDiv();
if(e){
e.innerHTML=t||""
}};
DwtBaseDialog.prototype._getContentDiv=function(){
return this._contentEl
};
DwtBaseDialog.prototype.addEnterListener=function(e){
this.addListener(DwtEvent.ENTER,e)
};
DwtBaseDialog.getActiveDialog=function(){
var t=null;
var a=DwtShell.getShell(window);
if(a){
var e=a._veilOverlay.activeDialogs.length;
if(e>0){
t=a._veilOverlay.activeDialogs[e-1]
}}
return t
};
DwtBaseDialog.prototype._initializeDragging=function(h){
var r=document.getElementById(h);
if(r){
var s=DwtControl.fromElementId(window._dwtShellId);
if(s){
var e=Dwt.getSize(s.getHtmlElement());
var a=document.getElementById(this._htmlElId);
var c=this.getSize();
var n=new AjxCallback(this,this._dragEnd);
var o=new AjxCallback(this,this._duringDrag);
var t=new AjxCallback(this,this._dragStart);
DwtDraggable.init(r,a,0,document.body.offsetWidth-10,0,document.body.offsetHeight-10,t,o,n)
}}};
DwtBaseDialog.prototype._getContentHtml=function(){
return""
};
DwtBaseDialog.prototype._createHtml=function(e){
var t={
id:this._htmlElId};
this._createHtmlFromTemplate(e||this.TEMPLATE,t)
};
DwtBaseDialog.prototype._createHtmlFromTemplate=function(e,t){
t.dragId=this._dragHandleId;
t.title=this._title;
t.icon="";
t.closeIcon1="";
t.closeIcon2="";
t.controlsTemplateId=this.CONTROLS_TEMPLATE;
DwtComposite.prototype._createHtmlFromTemplate.call(this,e,t);
this._titleBarEl=document.getElementById(t.id+"_titlebar");
this._titleEl=document.getElementById(t.id+"_title");
this._contentEl=document.getElementById(t.id+"_content");
this.setContent(this._getContentHtml())
};
DwtBaseDialog.prototype._setModalEffect=function(){
var a=this._shell._veilOverlay.dialogZ;
var o=null;
var t,e;
if(a.length){
o=a[a.length-1]
}
if(o){
t=o+2;
e=o+1
}else{
t=this._zIndex;
e=Dwt.Z_VEIL
}
this._shell._veilOverlay.veilZ.push(e);
this._shell._veilOverlay.dialogZ.push(t);
Dwt.setZIndex(this._shell._veilOverlay,e);
return t
};
DwtBaseDialog.prototype._undoModality=function(a){
var e=this._shell._veilOverlay.veilZ;
e.pop();
var t=e[e.length-1];
Dwt.setZIndex(this._shell._veilOverlay,t);
this._shell._veilOverlay.dialogZ.pop();
this._shell._veilOverlay.activeDialogs.pop();
if(this._shell._veilOverlay.activeDialogs.length>0){
this._shell._veilOverlay.activeDialogs[0].focus()
}};
DwtBaseDialog.prototype._getInputFields=function(){};
DwtBaseDialog.prototype._dragStart=function(e,t){
if(AjxEnv.isNav){
this._currSize=this.getSize();
DwtDraggable.setDragBoundaries(DwtDraggable.dragEl,0,document.body.offsetWidth-this._currSize.x,0,document.body.offsetHeight-this._currSize.y)
}};
DwtBaseDialog.prototype._dragEnd=function(e,t){
this._loc.x=e;
this._loc.y=t
};
DwtBaseDialog.prototype._duringDrag=function(e,t){};
DwtBaseDialog.prototype._doesContainElement=function(e){
return Dwt.contains(this.getHtmlElement(),e)
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtDialog")){
DwtDialog=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtDialog.PARAMS);
t.className=t.className||"DwtDialog";
this._title=t.title=t.title||"";
var a=t.standardButtons;
var c=t.extraButtons;
if(!a){
a=[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON]
}else{
if(a==DwtDialog.NO_BUTTONS){
a=null
}else{
if(a&&!a.length){
a=[a]
}}}
this._buttonList=[];
var u={};
u[DwtDialog.ALIGN_LEFT]=[];
u[DwtDialog.ALIGN_CENTER]=[];
u[DwtDialog.ALIGN_RIGHT]=[];
if(a||c){
this._buttonDesc={};
if(a&&a.length){
this._initialEnterButtonId=this._enterButtonId=a[0];
for(var o=0;
o<a.length;
o++){
var h=a[o];
this._buttonList.push(h);
var r=DwtDialog.ALIGN[h];
if(r){
u[r].push(h)
}
this._buttonDesc[h]=new DwtDialog_ButtonDescriptor(h,AjxMsg[DwtDialog.MSG_KEY[h]],r)
}
this._resetCallbacks()
}
if(c&&c.length){
if(!this._enterButtonId){
this._initialEnterButtonId=this._enterButtonId=c[0]
}
for(var o=0;
o<c.length;
o++){
var h=c[o].id;
this._buttonList.push(h);
var r=c[o].align;
if(r){
u[r].push(h)
}
this._buttonDesc[h]=c[o]
}}}
this._buttonElementId={};
for(var o=0;
o<this._buttonList.length;
o++){
this._buttonElementId[this._buttonList[o]]=Dwt.getNextId()
}
DwtBaseDialog.call(this,t);
this._button={};
for(var o=0;
o<this._buttonList.length;
o++){
var h=this._buttonList[o];
var d=this._button[h]=new DwtButton({
parent:this}
);
d.setText(this._buttonDesc[h].label);
d.buttonId=h;
d.addSelectionListener(new AjxListener(this,this._buttonListener));
var e=document.getElementById(this._buttonElementId[h]);
if(e){
e.appendChild(d.getHtmlElement())
}}
var s=u[DwtDialog.ALIGN_LEFT].concat(u[DwtDialog.ALIGN_CENTER],u[DwtDialog.ALIGN_RIGHT]);
for(var o=0;
o<s.length;
o++){
var n=this._button[s[o]];
this._tabGroup.addMember(n)
}};
DwtDialog.PARAMS=["parent","className","title","standardButtons","extraButtons","zIndex","mode","loc"];
DwtDialog.prototype=new DwtBaseDialog;
DwtDialog.prototype.constructor=DwtDialog;
DwtDialog.prototype.toString=function(){
return"DwtDialog"
};
DwtDialog.ALIGN_LEFT=1;
DwtDialog.ALIGN_RIGHT=2;
DwtDialog.ALIGN_CENTER=3;
DwtDialog.CANCEL_BUTTON=1;
DwtDialog.OK_BUTTON=2;
DwtDialog.DISMISS_BUTTON=3;
DwtDialog.NO_BUTTON=4;
DwtDialog.YES_BUTTON=5;
DwtDialog.LAST_BUTTON=5;
DwtDialog.NO_BUTTONS=256;
DwtDialog.ALL_BUTTONS=[DwtDialog.CANCEL_BUTTON,DwtDialog.OK_BUTTON,DwtDialog.DISMISS_BUTTON,DwtDialog.NO_BUTTON,DwtDialog.YES_BUTTON];
DwtDialog.MSG_KEY={};
DwtDialog.MSG_KEY[DwtDialog.CANCEL_BUTTON]="cancel";
DwtDialog.MSG_KEY[DwtDialog.OK_BUTTON]="ok";
DwtDialog.MSG_KEY[DwtDialog.DISMISS_BUTTON]="dismiss";
DwtDialog.MSG_KEY[DwtDialog.NO_BUTTON]="no";
DwtDialog.MSG_KEY[DwtDialog.YES_BUTTON]="yes";
DwtDialog.ALIGN={};
DwtDialog.ALIGN[DwtDialog.CANCEL_BUTTON]=DwtDialog.ALIGN_RIGHT;
DwtDialog.ALIGN[DwtDialog.OK_BUTTON]=DwtDialog.ALIGN_RIGHT;
DwtDialog.ALIGN[DwtDialog.DISMISS_BUTTON]=DwtDialog.ALIGN_RIGHT;
DwtDialog.ALIGN[DwtDialog.NO_BUTTON]=DwtDialog.ALIGN_RIGHT;
DwtDialog.ALIGN[DwtDialog.YES_BUTTON]=DwtDialog.ALIGN_RIGHT;
DwtDialog.MODELESS=DwtBaseDialog.MODELESS;
DwtDialog.MODAL=DwtBaseDialog.MODAL;
DwtDialog.prototype.CONTROLS_TEMPLATE="dwt.Widgets#DwtDialogControls";
DwtDialog.prototype.popdown=function(){
DwtBaseDialog.prototype.popdown.call(this);
this.resetButtonStates()
};
DwtDialog.prototype.popup=function(e,t){
this._focusButtonId=t;
DwtBaseDialog.prototype.popup.call(this,e)
};
DwtDialog.prototype._resetTabFocus=function(){
if(this._focusButtonId){
var e=this.getButton(this._focusButtonId);
this._tabGroup.setFocusMember(e,true)
}else{
DwtBaseDialog.prototype._resetTabFocus.call(this)
}};
DwtDialog.prototype.reset=function(){
this._resetCallbacks();
this.resetButtonStates();
DwtBaseDialog.prototype.reset.call(this)
};
DwtDialog.prototype.resetButtonStates=function(){
for(b in this._button){
this._button[b].setEnabled(true);
this._button[b].setHovered(false)
}
this.associateEnterWithButton(this._initialEnterButtonId)
};
DwtDialog.prototype.getButton=function(e){
return this._button[e]
};
DwtDialog.prototype.setButtonEnabled=function(t,e){
this._button[t].setEnabled(e)
};
DwtDialog.prototype.setButtonVisible=function(e,t){
this._button[e].setVisible(t)
};
DwtDialog.prototype.getButtonEnabled=function(e){
return this._button[e].getEnabled()
};
DwtDialog.prototype.registerCallback=function(t,a,o,e){
this._buttonDesc[t].callback=(a instanceof AjxCallback)?a:(new AjxCallback(o,a,e))
};
DwtDialog.prototype.unregisterCallback=function(e){
this._buttonDesc[e].callback=null
};
DwtDialog.prototype.setButtonListener=function(e,t){
this._button[e].removeSelectionListeners();
this._button[e].addSelectionListener(t)
};
DwtDialog.prototype.setEnterListener=function(e){
this.removeAllListeners(DwtEvent.ENTER);
this.addEnterListener(e)
};
DwtDialog.prototype.associateEnterWithButton=function(e){
this._enterButtonId=e
};
DwtDialog.prototype.getKeyMapName=function(){
return"DwtDialog"
};
DwtDialog.prototype.handleKeyAction=function(e,t){
switch(e){
case DwtKeyMap.ENTER:this.notifyListeners(DwtEvent.ENTER,t);
break;
case DwtKeyMap.CANCEL:var a=false;
a=a||this._runCallbackForButtonId(DwtDialog.CANCEL_BUTTON);
a=a||this._runCallbackForButtonId(DwtDialog.NO_BUTTON);
a=a||this._runCallbackForButtonId(DwtDialog.DISMISS_BUTTON);
this.popdown();
return true;
case DwtKeyMap.YES:if(this._buttonDesc[DwtDialog.YES_BUTTON]){
this._runCallbackForButtonId(DwtDialog.YES_BUTTON)
}
break;
case DwtKeyMap.NO:if(this._buttonDesc[DwtDialog.NO_BUTTON]){
this._runCallbackForButtonId(DwtDialog.NO_BUTTON)
}
break;
default:return false
}
return true
};
DwtDialog.prototype._createHtmlFromTemplate=function(a,n){
DwtBaseDialog.prototype._createHtmlFromTemplate.call(this,a,n);
var o=n.id+"_focus";
if(document.getElementById(o)){
this._focusElementId=o
}
this._buttonsEl=document.getElementById(n.id+"_buttons");
if(this._buttonsEl){
var t=[];
var e=0;
this._addButtonsHtml(t,e);
this._buttonsEl.innerHTML=t.join("")
}};
DwtDialog.prototype._getButtonsContainerStartTemplate=function(){
return"<table cellspacing='0' cellpadding='0' border='0' width='100%'><tr>"
};
DwtDialog.prototype._getButtonsAlignStartTemplate=function(){
return"<td align=\"{0}\"><table cellspacing='5' cellpadding='0' border='0'><tr>"
};
DwtDialog.prototype._getButtonsAlignEndTemplate=function(){
return"</tr></table></td>"
};
DwtDialog.prototype._getButtonsCellTemplate=function(){
return'<td id="{0}"></td>'
};
DwtDialog.prototype._getButtonsContainerEndTemplate=function(){
return"</tr></table>"
};
DwtDialog.prototype._addButtonsHtml=function(s,t){
if(this._buttonList&&this._buttonList.length){
var a=new Array();
var e=new Array();
var n=new Array();
for(var o=0;
o<this._buttonList.length;
o++){
var r=this._buttonList[o];
switch(this._buttonDesc[r].align){
case DwtDialog.ALIGN_RIGHT:e.push(r);
break;
case DwtDialog.ALIGN_LEFT:a.push(r);
break;
case DwtDialog.ALIGN_CENTER:n.push(r);
break
}}
s[t++]=this._getButtonsContainerStartTemplate();
if(a.length){
s[t++]=AjxMessageFormat.format(this._getButtonsAlignStartTemplate(),["left"]);
for(var o=0;
o<a.length;
o++){
var r=a[o];
var h=this._buttonDesc[r].cellTemplate?this._buttonDesc[r].cellTemplate:this._getButtonsCellTemplate();
s[t++]=AjxMessageFormat.format(h,[this._buttonElementId[r]])
}
s[t++]=this._getButtonsAlignEndTemplate()
}
if(n.length){
s[t++]=AjxMessageFormat.format(this._getButtonsAlignStartTemplate(),["center"]);
for(var o=0;
o<n.length;
o++){
var r=n[o];
var h=this._buttonDesc[r].cellTemplate?this._buttonDesc[r].cellTemplate:this._getButtonsCellTemplate();
s[t++]=AjxMessageFormat.format(h,[this._buttonElementId[r]])
}
s[t++]=this._getButtonsAlignEndTemplate()
}
if(e.length){
s[t++]=AjxMessageFormat.format(this._getButtonsAlignStartTemplate(),["right"]);
for(var o=0;
o<e.length;
o++){
var r=e[o];
var h=this._buttonDesc[r].cellTemplate?this._buttonDesc[r].cellTemplate:this._getButtonsCellTemplate();
s[t++]=AjxMessageFormat.format(h,[this._buttonElementId[r]])
}
s[t++]=this._getButtonsAlignEndTemplate()
}
s[t++]=this._getButtonsContainerEndTemplate()
}
return t
};
DwtDialog.prototype._buttonListener=function(a,e){
var o=DwtControl.getTargetControl(a);
var t=(o&&o.buttonId)||this._enterButtonId;
if(t){
this._runCallbackForButtonId(t,e)
}};
DwtDialog.prototype._runCallbackForButtonId=function(o,e){
var t=this._buttonDesc[o];
var a=t&&t.callback;
if(!a){
return false
}
e=(e instanceof Array)?e:[e];
a.run.apply(a,e);
return true
};
DwtDialog.prototype._runEnterCallback=function(e){
if(this._enterButtonId&&this.getButtonEnabled(this._enterButtonId)){
this._runCallbackForButtonId(this._enterButtonId,e)
}};
DwtDialog.prototype._resetCallbacks=function(){
if(this._buttonDesc){
for(var e=0;
e<DwtDialog.ALL_BUTTONS.length;
e++){
var t=DwtDialog.ALL_BUTTONS[e];
if(this._buttonDesc[t]){
this._buttonDesc[t].callback=new AjxCallback(this,this.popdown)
}}}};
DwtDialog_ButtonDescriptor=function(n,e,o,a,t){
this.id=n;
this.label=e;
this.align=o;
this.callback=a;
this.cellTemplate=t
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtSash")){
DwtSash=function(a){
a=Dwt.getParams(arguments,DwtSash.PARAMS);
a.className=a.className||"DwtSash";
a.posStyle=a.posStyle||DwtControl.ABSOLUTE_STYLE;
DwtControl.call(this,a);
var t=this.getHtmlElement();
var e="dwt.Widgets#";
if(!a.style||a.style!=DwtSash.HORIZONTAL_STYLE){
this._style=DwtSash.VERTICAL_STYLE;
t.style.cursor=AjxEnv.isIE?"row-resize":"s-resize";
t.innerHTML=AjxTemplate.expand(e+"DwtVerticalSash")
}else{
this._style=DwtSash.HORIZONTAL_STYLE;
t.style.cursor=AjxEnv.isIE?"col-resize":"w-resize";
t.innerHTML=AjxTemplate.expand(e+"DwtHorizontalSash")
}
this._threshold=(a.threshold>0)?a.threshold:1;
this._captureObj=new DwtMouseEventCapture({
targetObj:this,id:"DwtSash",mouseOverHdlr:DwtSash._mouseOverHdlr,mouseDownHdlr:DwtSash._mouseDownHdlr,mouseMoveHdlr:DwtSash._mouseMoveHdlr,mouseUpHdlr:DwtSash._mouseUpHdlr,mouseOutHdlr:DwtSash._mouseOutHdlr}
);
this.setHandler(DwtEvent.ONMOUSEDOWN,DwtSash._mouseDownHdlr);
this.setHandler(DwtEvent.ONMOUSEOVER,DwtSash._mouseOverHdlr);
this.setHandler(DwtEvent.ONMOUSEOUT,DwtSash._mouseOutHdlr);
this.setZIndex(Dwt.Z_VIEW)
};
DwtSash.PARAMS=["parent","style","className","threshold","posStyle"];
DwtSash.prototype=new DwtControl;
DwtSash.prototype.constructor=DwtSash;
DwtSash.prototype.toString=function(){
return"DwtSash"
};
DwtSash.HORIZONTAL_STYLE=1;
DwtSash.VERTICAL_STYLE=2;
DwtSash.prototype.registerCallback=function(e,t){
this._callbackFunc=e;
this._callbackObj=t
};
DwtSash._mouseOverHdlr=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtSash._mouseDownHdlr=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t,true);
if(e.button!=DwtMouseEvent.LEFT){
DwtUiEvent.setBehaviour(t,true,false);
return false
}
DwtEventManager.notifyListeners(DwtEvent.ONMOUSEDOWN,e);
var a=e.dwtObj;
if(a._callbackFunc!=null){
a._captureObj.capture();
a._startCoord=(a._style==DwtSash.HORIZONTAL_STYLE)?e.docX:e.docY
}
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtSash._mouseMoveHdlr=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
var o=0;
var a=DwtMouseEventCapture.getTargetObj();
if(a._style==DwtSash.HORIZONTAL_STYLE){
if(e.docX>0&&e.docX!=a._startCoord){
o=e.docX-a._startCoord
}}else{
if(e.docY>0&&e.docY!=a._startCoord){
o=e.docY-a._startCoord
}}
if(Math.abs(o)>=a._threshold){
if(a._callbackObj!=null){
o=a._callbackFunc.call(a._callbackObj,o)
}else{
o=a._callbackFunc(o)
}
a._startCoord+=o;
if(o!=0&&a.getHtmlElement().style.position==Dwt.ABSOLUTE_STYLE){
if(a._style==DwtSash.HORIZONTAL_STYLE){
a.setLocation(a.getLocation().x+o,Dwt.DEFAULT)
}else{
a.setLocation(Dwt.DEFAULT,a.getLocation().y+o)
}}}
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtSash._mouseUpHdlr=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
if(e.button!=DwtMouseEvent.LEFT){
DwtUiEvent.setBehaviour(t,true,false);
return false
}
if(DwtMouseEventCapture.getTargetObj()._callbackFunc!=null){
DwtMouseEventCapture.getCaptureObj().release()
}
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtSash._mouseOutHdlr=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t);
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtToolBar")){
DwtToolBar=function(a){
if(arguments.length==0){
return
}
a=Dwt.getParams(arguments,DwtToolBar.PARAMS);
a.className=a.className||"ZToolbar";
DwtComposite.call(this,a);
if(a.parent instanceof DwtToolBar){
this._hasSetMouseEvents=a.parent._hasSetMouseEvents
}
if(a.handleMouse!==false&&!this._hasSetMouseEvents){
var e=AjxEnv.isIE?[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP]:[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP,DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT];
this._setEventHdlrs(e);
this._hasSetMouseEvents=true
}
this._style=a.style||DwtToolBar.HORIZ_STYLE;
this._items=[];
this._createHtml();
this._numFillers=0;
this._curFocusIndex=0;
var t=(this._style==DwtToolBar.HORIZ_STYLE)?"horiz":"vert";
this._keyMapName=["DwtToolBar",t].join("-")
};
DwtToolBar.PARAMS=["parent","className","posStyle","style","index"];
DwtToolBar.prototype=new DwtComposite;
DwtToolBar.prototype.constructor=DwtToolBar;
DwtToolBar.prototype.toString=function(){
return"DwtToolBar"
};
DwtToolBar.HORIZ_STYLE=1;
DwtToolBar.VERT_STYLE=2;
DwtToolBar.ELEMENT=1;
DwtToolBar.SPACER=2;
DwtToolBar.SEPARATOR=3;
DwtToolBar.FILLER=4;
DwtToolBar.FIRST_ITEM="ZFirstItem";
DwtToolBar.LAST_ITEM="ZLastItem";
DwtToolBar.SELECTED_NEXT=DwtControl.SELECTED+"Next";
DwtToolBar.SELECTED_PREV=DwtControl.SELECTED+"Prev";
DwtToolBar._NEXT_PREV_RE=new RegExp("\\b"+[DwtToolBar.SELECTED_NEXT,DwtToolBar.SELECTED_PREV].join("|")+"\\b","g");
DwtToolBar.prototype.TEMPLATE="dwt.Widgets#ZToolbar";
DwtToolBar.prototype.ITEM_TEMPLATE="dwt.Widgets#ZToolbarItem";
DwtToolBar.prototype.SEPARATOR_TEMPLATE="dwt.Widgets#ZToolbarSeparator";
DwtToolBar.prototype.SPACER_TEMPLATE="dwt.Widgets#ZToolbarSpacer";
DwtToolBar.prototype.FILLER_TEMPLATE="dwt.Widgets#ZToolbarFiller";
DwtToolBar.__itemCount=0;
DwtToolBar.prototype.dispose=function(){
this._itemsEl=null;
this._prefixEl=null;
this._suffixEl=null;
DwtComposite.prototype.dispose.call(this)
};
DwtToolBar.prototype.getItem=function(e){
return this._children.get(e)
};
DwtToolBar.prototype.getItemCount=function(){
return this._children.size()
};
DwtToolBar.prototype.getItems=function(){
return this._children.getArray()
};
DwtToolBar.prototype.addSpacer=function(t,e){
var a=this._createSpacerElement();
this._addItem(DwtToolBar.SPACER,a,e);
return a
};
DwtToolBar.prototype.addSeparator=function(a,e){
var t=this._createSeparatorElement();
this._addItem(DwtToolBar.SEPARATOR,t,e);
return t
};
DwtToolBar.prototype.removeSeparator=function(e){
this._removeItem(e)
};
DwtToolBar.prototype.addFiller=function(a,e){
var t=this._createFillerElement();
this._addItem(DwtToolBar.FILLER,t,e);
return t
};
DwtToolBar.prototype.addChild=function(a,e){
DwtComposite.prototype.addChild.apply(this,arguments);
var t=this._createItemElement();
t.appendChild(a.getHtmlElement());
this._addItem(DwtToolBar.ELEMENT,t,e)
};
DwtToolBar.prototype.getKeyMapName=function(){
return this._keyMapName
};
DwtToolBar.prototype.handleKeyAction=function(t,o){
var a=this.getItem(this._curFocusIndex);
var e=this.getItemCount();
if(e<2){
return true
}
switch(t){
case DwtKeyMap.PREV:if(this._curFocusIndex>0){
this._moveFocus(true)
}
break;
case DwtKeyMap.NEXT:if(this._curFocusIndex<(e-1)){
this._moveFocus()
}
break;
default:if(a){
return a.handleKeyAction(t,o)
}}
return true
};
DwtToolBar.prototype._createItemId=function(t){
t=t||this._htmlElId;
var e=[t,"item",++DwtToolBar.__itemCount].join("_");
return e
};
DwtToolBar.prototype._createHtml=function(){
var e={
id:this._htmlElId};
this._createHtmlFromTemplate(this.TEMPLATE,e);
this._itemsEl=document.getElementById(e.id+"_items");
this._prefixEl=document.getElementById(e.id+"_prefix");
this._suffixEl=document.getElementById(e.id+"_suffix")
};
DwtToolBar.prototype._createItemElement=function(a){
a=a||this.ITEM_TEMPLATE;
var o={
id:this._htmlElId,itemId:this._createItemId()};
var t=AjxTemplate.expand(a,o);
var e=AjxStringUtil.calcDIV();
e.innerHTML=t;
return e.firstChild.rows[0].cells[0]
};
DwtToolBar.prototype._createSpacerElement=function(e){
return this._createItemElement(e||this.SPACER_TEMPLATE)
};
DwtToolBar.prototype._createSeparatorElement=function(e){
return this._createItemElement(e||this.SEPARATOR_TEMPLATE)
};
DwtToolBar.prototype._createFillerElement=function(e){
return this._createItemElement(e||this.FILLER_TEMPLATE)
};
DwtToolBar.prototype._addItem=function(o,a,t){
var n=this._items[t]||this._suffixEl;
var e=t||(typeof t=="number")?t:this._items.length;
this._items.splice(e,0,a);
this._itemsEl.insertBefore(a,n)
};
DwtToolBar.prototype._removeItem=function(t){
for(var e=0;
e<this._items.length;
e++){
if(this._items[e]==t){
this._items.splice(e,1);
this._itemsEl.removeChild(t);
break
}}};
DwtToolBar.prototype._focus=function(e){
if(!this._submenuKeySet){
var a=this.shell.getKeyboardMgr();
if(a.isEnabled()){
var t=a.__keyMapMgr;
if(t){
if(this._style==DwtToolBar.HORIZ_STYLE){
t.removeMapping("DwtButton","ArrowRight");
t.setMapping("DwtButton","ArrowDown",DwtKeyMap.SUBMENU)
}else{
t.removeMapping("DwtButton","ArrowDown");
t.setMapping("DwtButton","ArrowRight",DwtKeyMap.SUBMENU)
}
t.reloadMap("DwtButton")
}}
this._submenuKeySet=true
}
e=e?e:this._getFocusItem(this._curFocusIndex);
if(e){
e._hasFocus=true;
e._focus()
}else{
this._moveFocus()
}};
DwtToolBar.prototype._blur=function(e){
e=e?e:this._getFocusItem(this._curFocusIndex);
if(e){
e._hasFocus=false;
e._blur()
}};
DwtToolBar.prototype._getFocusItem=function(e){
var t=this.getItem(e);
if(!t||(t instanceof DwtToolBar)){
return null
}
if(t._noFocus){
return null
}
if(t.getEnabled&&!t.getEnabled()){
return null
}
if(t.getVisible&&!t.getVisible()){
return null
}
return t
};
DwtToolBar.prototype._moveFocus=function(e){
var t=this._curFocusIndex;
var a=this.getItemCount()-1;
var o=null;
while(!o&&t>=0&&t<=a){
t=e?t-1:t+1;
o=this._getFocusItem(t)
}
if(o){
this._blur();
this._curFocusIndex=t;
this._focus(o)
}};
DwtToolBar.prototype.__markPrevNext=function(r,s){
var e=this.__getButtonIndex(r);
var o=this.__getButtonAt(e-1);
var t=this.__getButtonAt(e+1);
if(s){
if(o){
Dwt.delClass(o.getHtmlElement(),DwtToolBar._NEXT_PREV_RE,DwtToolBar.SELECTED_PREV)
}
if(t){
Dwt.delClass(t.getHtmlElement(),DwtToolBar._NEXT_PREV_RE,DwtToolBar.SELECTED_NEXT)
}}else{
if(o){
Dwt.delClass(o.getHtmlElement(),DwtToolBar._NEXT_PREV_RE)
}
if(t){
Dwt.delClass(t.getHtmlElement(),DwtToolBar._NEXT_PREV_RE)
}}
var n=this.__getButtonAt(0);
if(n){
Dwt.addClass(n.getHtmlElement(),DwtToolBar.FIRST_ITEM)
}
var a=this.__getButtonAt(this.getItemCount()-1);
if(a){
Dwt.addClass(a.getHtmlElement(),DwtToolBar.LAST_ITEM)
}};
DwtToolBar.prototype.__getButtonIndex=function(a){
var t=0;
for(var e in this._buttons){
if(e==a){
return t
}
t++
}
return -1
};
DwtToolBar.prototype.__getButtonAt=function(t){
var a=0;
for(var e in this._buttons){
if(a==t){
return this._buttons[e]
}
a++
}
return null
};
DwtToolBarButton=function(e){
if(arguments.length==0){
return
}
var e=Dwt.getParams(arguments,DwtToolBarButton.PARAMS);
e.className=e.className||"ZToolbarButton";
DwtButton.call(this,e)
};
DwtToolBarButton.PARAMS=["parent","style","className","posStyle","actionTiming","id","index"];
DwtToolBarButton.prototype=new DwtButton;
DwtToolBarButton.prototype.constructor=DwtToolBarButton;
DwtToolBarButton.prototype.TEMPLATE="dwt.Widgets#ZToolbarButton"
}
if(AjxPackage.define("ajax.dwt.widgets.DwtToolTip")){
DwtToolTip=function(a,o,t){
if(arguments.length==0){
return
}
this.shell=a;
this._dialog=t;
this._poppedUp=false;
this._div=document.createElement("div");
this._div.className=o||"DwtToolTip";
this._div.style.position=DwtControl.ABSOLUTE_STYLE;
this.shell.getHtmlElement().appendChild(this._div);
Dwt.setZIndex(this._div,Dwt.Z_HIDDEN);
Dwt.setLocation(this._div,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
var e="dwt.Widgets#"+this._borderStyle;
this._div.innerHTML=AjxTemplate.expand(e,"tooltip");
var n=AjxTemplate.getParams(e);
this._borderWidth=Number(n.width);
this._borderHeight=Number(n.height);
this._contentDiv=document.getElementById("tooltipContents")
};
DwtToolTip.prototype.toString=function(){
return"DwtToolTip"
};
DwtToolTip.TOOLTIP_DELAY=750;
DwtToolTip.prototype._borderStyle="DwtToolTip";
DwtToolTip.prototype.getContent=function(){
return this._div.innerHTML
};
DwtToolTip.prototype.setContent=function(t,e){
this._content=t;
if(e){
this._contentDiv.innerHTML=this._content
}};
DwtToolTip.prototype.popup=function(e,a,t){
if(this._popupAction){
AjxTimedAction.cancelAction(this._popupAction);
this._popupAction=null
}
if(this._content!=null){
if(!t){
this._contentDiv.innerHTML=this._content
}
this._popupAction=new AjxTimedAction(this,this._positionElement,[e,a]);
AjxTimedAction.scheduleAction(this._popupAction,5)
}};
DwtToolTip.prototype.popdown=function(){
if(this._popupAction){
AjxTimedAction.cancelAction(this._popupAction);
this._popupAction=null
}
if(this._content!=null&&this._poppedUp){
Dwt.setLocation(this._div,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
this._poppedUp=false
}};
DwtToolTip.prototype._positionElement=function(A,O){
this._popupAction=null;
var n=this._div;
var f="tooltip";
var T=this._dialog;
var z=5;
var d=8;
var h=8;
var e=document.getElementById(f+"TopPointer");
e.style.display="block";
var w=Dwt.getSize(e),x=w.x,a=w.y;
var s=document.getElementById(f+"BottomPointer");
s.style.display="block";
w=Dwt.getSize(s),bottomPointerWidth=w.x,bottomPointerHeight=w.y;
var q=e;
var r=DwtShell.getShell(window).getSize(),D=r.x,p=r.y;
var C=Dwt.getSize(n),j=C.x,u=C.y;
var m=this._borderHeight,S=this._borderHeight,y=this._borderWidth,k=this._borderWidth;
var B=A-j/2-d,W;
var t,o,v;
if(O+h+a-m+u<p-z){
s.style.display="none";
W=O+h+a-m;
t=m-a;
v=x;
q=e
}else{
e.style.display="none";
W=O-h-bottomPointerHeight+S-u;
t=u-S;
v=bottomPointerWidth;
q=s
}
var c=document.getElementById(f+"Contents");
if(j-y-k<v){
c.width=v;
c.style.width=String(v)+"px"
}else{
c.width="auto";
c.style.width="auto"
}
if(B<z){
B=z
}else{
if(B+j>D-z){
B=D-z-j
}}
o=A-B-v/2;
if(o+v>j-k){
o=j-k-v
}
if(o<y){
o=y
}
q.style.left=o;
q.style.top=t;
Dwt.setLocation(n,B,W);
var g=T?T.getZIndex()+Dwt._Z_INC:Dwt.Z_TOOLTIP;
Dwt.setZIndex(n,g);
this._poppedUp=true
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtTreeItem")){
DwtTreeItem=function(t){
if(arguments.length==0){
return
}
t=Dwt.getParams(arguments,DwtTreeItem.PARAMS);
var e=t.parent;
if(e instanceof DwtTree){
this._tree=e
}else{
if(e instanceof DwtTreeItem){
this._tree=e._tree
}else{
throw new DwtException("DwtTreeItem parent must be a DwtTree or DwtTreeItem",DwtException.INVALIDPARENT,"DwtTreeItem")
}}
this._origClassName=t.className||"DwtTreeItem";
this._textClassName=[this._origClassName,"Text"].join("-");
this._selectedClassName=[this._origClassName,DwtCssStyle.SELECTED].join("-");
this._selectedFocusedClassName=[this._origClassName,DwtCssStyle.SELECTED,DwtCssStyle.FOCUSED].join("-");
this._actionedClassName=[this._origClassName,DwtCssStyle.ACTIONED].join("-");
this._dragOverClassName=[this._origClassName,DwtCssStyle.DRAG_OVER].join("-");
t.deferred=(t.deferred!==false);
t.className=null;
DwtComposite.call(this,t);
this._imageInfoParam=t.imageInfo;
this._extraInfo=t.extraInfo;
this._textParam=t.text;
this._deferred=t.deferred;
this._expandNodeImage=t.expandNodeImage||"NodeExpanded";
this._collapseNodeImage=t.collapseNodeImage||"NodeCollapsed";
this._itemChecked=false;
this._initialized=false;
this._selectionEnabled=Boolean(t.selectable!==false);
this._forceNotifySelection=Boolean(t.forceNotifySelection);
this._actionEnabled=true;
this._forceNotifyAction=Boolean(t.forceNotifyAction);
this._dndScrollCallback=t.dndScrollCallback;
this._dndScrollId=t.dndScrollId;
if(this._tree.isCheckedStyle){
this.enableSelection(false);
this._selectedClassName=this._origClassName
}
if(t.singleClickAction){
this._singleClickAction=true;
this._selectedFocusedClassName=this._selectedClassName=this._textClassName;
this._hoverClassName=[this._origClassName,DwtCssStyle.HOVER].join("-")
}else{
this._hoverClassName=this._textClassName
}
if(e instanceof DwtTree||(e._initialized&&(!e._deferred||e._expanded))){
this._initialize(t.index)
}else{
e._addDeferredChild(this,t.index);
this._index=t.index
}};
DwtTreeItem.PARAMS=["parent","index","text","imageInfo","deferred","className","posStyle","forceNotifySelection","forceNotifyAction"];
DwtTreeItem.prototype=new DwtComposite;
DwtTreeItem.prototype.constructor=DwtTreeItem;
DwtTreeItem.prototype.TEMPLATE="dwt.Widgets#ZTreeItem";
DwtTreeItem.prototype._checkBoxVisible=true;
DwtTreeItem._NODECELL_DIM="16px";
DwtTreeItem._processedMouseDown=false;
DwtTreeItem.prototype.dispose=function(){
this._itemDiv=null;
this._nodeCell=null;
this._checkBoxCell=null;
this._checkedImg=null;
this._checkBox=null;
this._imageCell=null;
this._textCell=null;
this._childDiv=null;
DwtComposite.prototype.dispose.call(this)
};
DwtTreeItem.prototype.toString=function(){
return"DwtTreeItem"
};
DwtTreeItem.prototype.getChecked=function(){
return this._itemChecked
};
DwtTreeItem.prototype.setChecked=function(e,t){
if((this._itemChecked!=e)||t){
this._itemChecked=e;
if(this._checkBox!=null&&(this._checkBoxCell&&Dwt.getVisible(this._checkBoxCell))){
Dwt.setVisible(this._checkedImg,e)
}}};
DwtTreeItem.prototype._handleCheckboxOnclick=function(e){
this.setChecked(!Dwt.getVisible(this._checkedImg));
e=e||window.event;
e.item=this;
this._tree._itemChecked(this,e)
};
DwtTreeItem.prototype.getExpanded=function(){
return this._expanded
};
DwtTreeItem.prototype.setExpanded=function(t,s,n){
if(t){
var r=this.parent;
while(r instanceof DwtTreeItem&&!r._expanded){
r.setExpanded(true);
r=r.parent
}
this._realizeDeferredChildren()
}
if(this.getNumChildren()){
if(t&&s){
if(!this._expanded){
this._expand(t,null,n)
}
var e=this.getChildren();
for(var o=0;
o<e.length;
o++){
if(e[o] instanceof DwtTreeItem){
e[o].setExpanded(t,s,n)
}}}else{
if(this._expanded!=t){
this._expand(t,null,n)
}}}};
DwtTreeItem.prototype.getItemCount=function(){
return this._children.size()
};
DwtTreeItem.prototype.getItems=function(){
return this._children.getArray()
};
DwtTreeItem.prototype.getImage=function(){
return this._imageInfo
};
DwtTreeItem.prototype.setImage=function(e){
if(this._initialized){
if(this._imageCell){
AjxImg.setImage(this._imageCell,e)
}

this._imageInfo=e
}else{
this._imageInfoParam=e
}};
DwtTreeItem.prototype.setDndImage=function(e){
this._dndImageInfo=e
};
DwtTreeItem.prototype.getSelected=function(){
return this._selected
};
DwtTreeItem.prototype.getActioned=function(){
return this._actioned
};
DwtTreeItem.prototype.getText=function(){
return this._text
};
DwtTreeItem.prototype.setText=function(e){
if(this._initialized){
if(!e){
e=""
}
this._text=this._textCell.innerHTML=e
}else{
this._textParam=e
}};
DwtTreeItem.prototype.setDndText=function(e){
this._dndText=e
};
DwtTreeItem.prototype.showCheckBox=function(e){
this._checkBoxVisible=e;
if(this._checkBoxCell){
Dwt.setVisible(this._checkBoxCell,e)
}};
DwtTreeItem.prototype.showExpansionIcon=function(e){
if(this._nodeCell){
Dwt.setVisible(this._nodeCell,e)
}};
DwtTreeItem.prototype.enableSelection=function(e){
this._selectionEnabled=e;
this._selectedClassName=e?this._origClassName+"-"+DwtCssStyle.SELECTED:this._origClassName
};
DwtTreeItem.prototype.enableAction=function(e){
this._actionEnabled=e
};
DwtTreeItem.prototype.addSeparator=function(e){
this._children.add((new DwtTreeItemSeparator(this)),e)
};
DwtTreeItem.prototype.setVisible=function(a,t,e){
if(t&&!e){
Dwt.setVisible(this._itemDiv,a)
}else{
if(e&&!t){
Dwt.setVisible(this._childDiv,a)
}else{
DwtComposite.prototype.setVisible.call(this,a)
}}};
DwtTreeItem.prototype.removeChild=function(t){
if(t._initialized){
this._tree._deselect(t);
if(this._childDiv){
this._childDiv.removeChild(t.getHtmlElement())
}}
this._children.remove(t);
if(this._children.size()==0){
if(this._expanded){
this._expanded=false
}
if(this._initialized&&this._nodeCell){
AjxImg.setImage(this._nodeCell,"Blank_16");
var e=AjxImg.getImageElement(this._nodeCell);
if(e){
Dwt.clearHandler(e,DwtEvent.ONMOUSEDOWN)
}}}};
DwtTreeItem.prototype.getKeyMapName=function(){
return"DwtTreeItem"
};
DwtTreeItem.prototype.handleKeyAction=function(a,r){
switch(a){
case DwtKeyMap.NEXT:var n=this._tree._getNextTreeItem(true);
if(n){
n._tree.setSelection(n,false,true)
}
break;
case DwtKeyMap.PREV:var n=this._tree._getNextTreeItem(false);
if(n){
n._tree.setSelection(n,false,true)
}
break;
case DwtKeyMap.EXPAND:if(!this._expanded){
this.setExpanded(true,false,true)
}
break;
case DwtKeyMap.COLLAPSE:if(this._expanded){
this.setExpanded(false,false,true)
}
break;
case DwtKeyMap.ACTION:var c=this.getHtmlElement();
var h=Dwt.toWindow(c,0,0);
var o=this.getSize();
var t=h.x+o.x/4;
var e=h.y+o.y/2;
this._gotMouseDownRight=true;
this._emulateSingleClick({
dwtObj:this,target:c,button:DwtMouseEvent.RIGHT,docX:t,docY:e,kbNavEvent:true}
);
break;
default:return false
}
return true
};
DwtTreeItem.prototype.addNodeIconListeners=function(){
var e=AjxImg.getImageElement(this._nodeCell);
if(e){
Dwt.setHandler(e,DwtEvent.ONMOUSEDOWN,DwtTreeItem._nodeIconMouseDownHdlr);
Dwt.setHandler(e,DwtEvent.ONMOUSEUP,DwtTreeItem._nodeIconMouseUpHdlr)
}};
DwtTreeItem.prototype._initialize=function(e,o,a){
this._checkState();
if(AjxEnv.isIE){
this._setEventHdlrs([DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE])
}
if(AjxEnv.isSafari){
this._setEventHdlrs([DwtEvent.ONCONTEXTMENU])
}
var t={
id:this._htmlElId,divClassName:this._origClassName,isCheckedStyle:this._tree.isCheckedStyle,textClassName:this._textClassName};
this._createHtmlFromTemplate(this.TEMPLATE,t);
this.parent._addItem(this,e,o);
this._itemDiv=document.getElementById(t.id+"_div");
this._nodeCell=document.getElementById(t.id+"_nodeCell");
this._checkBoxCell=document.getElementById(t.id+"_checkboxCell");
this._checkBox=document.getElementById(t.id+"_checkbox");
this._checkedImg=document.getElementById(t.id+"_checkboxImg");
this._imageCell=document.getElementById(t.id+"_imageCell");
this._textCell=document.getElementById(t.id+"_textCell");
this._extraCell=document.getElementById(t.id+"_extraCell");
if(this._nodeCell){
this._nodeCell.style.width=this._nodeCell.style.height=DwtTreeItem._NODECELL_DIM;
if(this._children.size()>0||a){
AjxImg.setImage(this._nodeCell,this._collapseNodeImage);
this.addNodeIconListeners()
}}
if(this._extraCell){
AjxImg.setImage(this._extraCell,(this._extraInfo||"Blank_16"))
}
if(this._tree.isCheckedStyle&&this._checkBox){
this._checkBox.onclick=AjxCallback.simpleClosure(this._handleCheckboxOnclick,this);
this.showCheckBox(this._checkBoxVisible);
this.setChecked(this._tree.isCheckedByDefault,true)
}
if(this._imageCell&&this._imageInfoParam){
AjxImg.setImage(this._imageCell,this._imageInfoParam);
this._imageInfo=this._imageInfoParam
}
if(this._textCell&&this._textParam){
this._textCell.innerHTML=this._text=this._textParam
}
this._expanded=this._selected=this._actioned=false;
this._gotMouseDownLeft=this._gotMouseDownRight=false;
this._addMouseListeners();
this._initialized=true
};
DwtTreeItem.prototype.setTreeItemColor=function(o){
var s=this._htmlElId+"_table";
var a=document.getElementById(s);
var n=document.getElementById(this._htmlElId+"_div");
var t=this.getHtmlElement();
var e=this._origClassName+" "+o;
if(n){
n.className=e
}else{
if(t){
t.className=o
}}};
DwtTreeItem.prototype._addMouseListeners=function(){
var t=[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP,DwtEvent.ONDBLCLICK];
if(AjxEnv.isIE){
t.push(DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE)
}else{
t.push(DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT)
}
if(AjxEnv.isSafari){
t.push(DwtEvent.ONCONTEXTMENU)
}
for(var e=0;
e<t.length;
e++){
this.addListener(t[e],DwtTreeItem._listeners[t[e]])
}};
DwtTreeItem.prototype._addDeferredChild=function(a,e){
if(this._initialized&&this._children.size()==0){
if(this._nodeCell){
AjxImg.setImage(this._nodeCell,this._collapseNodeImage);
var t=AjxImg.getImageElement(this._nodeCell);
if(t){
Dwt.setHandler(t,DwtEvent.ONMOUSEDOWN,DwtTreeItem._nodeIconMouseDownHdlr);
Dwt.setHandler(t,DwtEvent.ONMOUSEUP,DwtTreeItem._nodeIconMouseUpHdlr)
}}}
this._children.add(a,e)
};
DwtTreeItem.prototype.addChild=function(e){};
DwtTreeItem.prototype._addItem=function(a,t,s){
if(!this._children.contains(a)){
this._children.add(a,t)
}
if(this._childDiv==null){
this._childDiv=document.createElement("div");
this._childDiv.className=(this.parent!=this._tree)?"DwtTreeItemChildDiv":"DwtTreeItemLevel1ChildDiv";
this.getHtmlElement().appendChild(this._childDiv);
if(!this._expanded){
this._childDiv.style.display="none"
}}
if(s&&this._nodeCell){
if(AjxImg.getImageClass(this._nodeCell)==AjxImg.getClassForImage("Blank_16")){
AjxImg.setImage(this._nodeCell,this._expanded?this._expandNodeImage:this._collapseNodeImage);
var n=AjxImg.getImageElement(this._nodeCell);
if(n){
Dwt.setHandler(n,DwtEvent.ONMOUSEDOWN,DwtTreeItem._nodeIconMouseDownHdlr)
}}}
var e=this._childDiv;
var o=e.childNodes.length;
if(t==null||t>=o||o==0){
e.appendChild(a.getHtmlElement())
}else{
e.insertBefore(a.getHtmlElement(),e.childNodes[t])
}};
DwtTreeItem.prototype.sort=function(e){
this._children.sort(e);
if(this._childDiv){
this._setChildElOrder()
}else{
this._needsSort=true
}};
DwtTreeItem.prototype._setChildElOrder=function(e){
var t=document.createDocumentFragment();
this._children.foreach(function(o,a){
t.appendChild(o.getHtmlElement());
o._index=a
}
);
this._childDiv.appendChild(t)
};
DwtTreeItem.prototype._getDragProxy=function(){
var t=document.createElement("div");
Dwt.setPosition(t,Dwt.ABSOLUTE_STYLE);
var a=document.createElement("table");
t.appendChild(a);
a.cellSpacing=a.cellPadding=0;
var o=a.insertRow(0);
var e=0;
var n=o.insertCell(e++);
n.noWrap=true;
if(this._dndImageInfo){
AjxImg.setImage(n,this._dndImageInfo)
}else{
if(this._imageInfo){
AjxImg.setImage(n,this._imageInfo)
}}
n=o.insertCell(e);
n.noWrap=true;
n.className=this._origClassName;
if(this._dndText){
n.innerHTML=this._dndText
}else{
if(this._text){
n.innerHTML=this._text
}}
this.shell.getHtmlElement().appendChild(t);
Dwt.setZIndex(t,Dwt.Z_DND);
return t
};
DwtTreeItem.prototype._dragEnter=function(){
this._preDragClassName=this._textCell.className;
this._textCell.className=this._dragOverClassName
};
DwtTreeItem.prototype._dragHover=function(){
if(this.getNumChildren()>0&&!this.getExpanded()){
this.setExpanded(true)
}};
DwtTreeItem.prototype._dragLeave=function(e){
if(this._preDragClassName){
this._textCell.className=this._preDragClassName
}};
DwtTreeItem.prototype._drop=function(){
if(this._preDragClassName){
this._textCell.className=this._preDragClassName
}};
DwtTreeItem._nodeIconMouseDownHdlr=function(t){
var a=DwtControl.getTargetControl(t);
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t,a);
if(e.button==DwtMouseEvent.LEFT){
a._expand(!a._expanded,e)
}else{
if(e.button==DwtMouseEvent.RIGHT){
e.dwtObj._tree._itemActioned(e.dwtObj,e)
}}
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtTreeItem._nodeIconMouseUpHdlr=function(t){
var a=DwtControl.getTargetControl(t);
var e=DwtShell.mouseEvent;
e._stopPropagation=true;
e._returnValue=false;
e.setToDhtmlEvent(t);
return false
};
DwtTreeItem.prototype._expand=function(t,a,e){
if(!t){
this._expanded=false;
this._childDiv.style.display="none";
if(this._nodeCell){
AjxImg.setImage(this._nodeCell,this._collapseNodeImage)
}
this._tree._itemCollapsed(this,a,e)
}else{
this._realizeDeferredChildren();
this._expanded=true;
this._childDiv.style.display="block";
if(this._nodeCell){
AjxImg.setImage(this._nodeCell,this._expandNodeImage)
}
this._tree._itemExpanded(this,a,e)
}};
DwtTreeItem.prototype._realizeDeferredChildren=function(){
var e=this._children.getArray();
for(var t=0;
t<e.length;
t++){
var o=e[t];
if(!o._initialized){
o._initialize(o._index,true)
}else{
if(o._isSeparator&&!o.div){
var n=o.div=document.createElement("div");
n.className="vSpace";
this._childDiv.appendChild(n);
o._initialized=true
}}}
if(this._needsSort){
if(e.length){
this._setChildElOrder()
}
delete this.__needsSort
}};
DwtTreeItem.prototype._isChildOf=function(e){
var t=this.parent;
while(t&&t!=this._tree){
if(t==e){
return true
}
t=t.parent
}
return false
};
DwtTreeItem.prototype._setSelected=function(e,t){
if(this._selected!=e){
this._selected=e;
if(!this._initialized){
this._initialize()
}
if(!this._itemDiv){
return
}
if(e&&(this._selectionEnabled||this._forceNotifySelection)){
this._itemDiv.className=this._selectedClassName;
if(!t){
this.focus()
}
return true
}else{
this._itemDiv.className=this._origClassName;
return false
}}};
DwtTreeItem.prototype._setActioned=function(e){
if(this._actioned!=e){
this._actioned=e;
if(!this._initialized){
this._initialize()
}
if(!this._itemDiv){
return
}
if(e&&(this._actionEnabled||this._forceNotifyAction)&&!this._selected&&!this){
this._itemDiv.className=this._actionedClassName;
return true
}
if(!e){
if(!this._selected){
this._itemDiv.className=this._origClassName
}
return false
}}};
DwtTreeItem.prototype._focus=function(){
if(!this._itemDiv){
return
}
if(this._selectionEnabled){
this._itemDiv.className=this._selectedFocusedClassName
}};
DwtTreeItem.prototype._blur=function(){
if(!this._itemDiv){
return
}
this._itemDiv.className=this._selected?this._selectedClassName:this._origClassName
};
DwtTreeItem._mouseDownListener=function(e){
var t=e.dwtObj;
if(!t){
return false
}
if(e.target==t._childDiv){
return
}
if(e.button==DwtMouseEvent.LEFT&&(t._selectionEnabled||t._forceNotifySelection)){
t._gotMouseDownLeft=true
}else{
if(e.button==DwtMouseEvent.RIGHT&&(t._actionEnabled||t._forceNotifyAction)){
t._gotMouseDownRight=true
}}};
DwtTreeItem._mouseOutListener=function(e){
var t=e.dwtObj;
if(!t){
return false
}
if(e.target==t._childDiv){
return
}
t._gotMouseDownLeft=false;
t._gotMouseDownRight=false;
if(t._singleClickAction&&t._textCell){
t._textCell.className=t._textClassName
}};
DwtTreeItem._mouseOverListener=function(e){
var t=e.dwtObj;
if(!t){
return false
}
if(e.target==t._childDiv){
return
}
if(t._singleClickAction&&t._textCell){
t._textCell.className=t._hoverClassName
}};
DwtTreeItem._mouseUpListener=function(e){
var t=e.dwtObj;
if(!t){
return false
}
if(e.target==t._childDiv){
return
}
if(e.button==DwtMouseEvent.LEFT&&t._gotMouseDownLeft){
t._tree._itemClicked(t,e)
}else{
if(e.button==DwtMouseEvent.RIGHT&&t._gotMouseDownRight){
t._tree._itemActioned(t,e)
}}};
DwtTreeItem._doubleClickListener=function(t){
var a=t.dwtObj;
if(!a){
return false
}
if(t.target==a._childDiv){
return
}
var o=DwtControl.getTargetControl(t);
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t,o);
if(e.button==DwtMouseEvent.LEFT||e.button==DwtMouseEvent.NONE){
e.dwtObj._tree._itemDblClicked(e.dwtObj,e)
}};
DwtTreeItem._contextListener=function(t){
if(AjxEnv.isSafari){
var a=DwtControl.getTargetControl(t);
var e=a?a.preventContextMenu():true;
if(e){
a.notifyListeners(DwtEvent.ONMOUSEDOWN,t);
return a.notifyListeners(DwtEvent.ONMOUSEUP,t)
}}};
DwtTreeItem.prototype._emulateSingleClick=function(e){
var t=new DwtMouseEvent();
this._setMouseEvent(t,e);
t.kbNavEvent=e.kbNavEvent;
this.notifyListeners(DwtEvent.ONMOUSEUP,t)
};
DwtTreeItem._listeners={};
DwtTreeItem._listeners[DwtEvent.ONMOUSEDOWN]=new AjxListener(null,DwtTreeItem._mouseDownListener);
DwtTreeItem._listeners[DwtEvent.ONMOUSEOUT]=new AjxListener(null,DwtTreeItem._mouseOutListener);
DwtTreeItem._listeners[DwtEvent.ONMOUSELEAVE]=new AjxListener(null,DwtTreeItem._mouseOutListener);
DwtTreeItem._listeners[DwtEvent.ONMOUSEENTER]=new AjxListener(null,DwtTreeItem._mouseOverListener);
DwtTreeItem._listeners[DwtEvent.ONMOUSEOVER]=new AjxListener(null,DwtTreeItem._mouseOverListener);
DwtTreeItem._listeners[DwtEvent.ONMOUSEUP]=new AjxListener(null,DwtTreeItem._mouseUpListener);
DwtTreeItem._listeners[DwtEvent.ONDBLCLICK]=new AjxListener(null,DwtTreeItem._doubleClickListener);
DwtTreeItem._listeners[DwtEvent.ONCONTEXTMENU]=new AjxListener(null,DwtTreeItem._contextListener);
DwtTreeItemSeparator=function(e){
this.parent=e;
this._isSeparator=true;
this._initialized=true
};
DwtTreeItemSeparator.prototype.dispose=function(){
DwtComposite.prototype.removeChild.call(this.parent,this)
};
DwtTreeItemSeparator.prototype.isInitialized=function(){
return this._initialized
};
DwtTreeItemSeparator.prototype.getHtmlElement=function(){
return this.div
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtHeaderTreeItem")){
DwtHeaderTreeItem=function(e){
this.overview=e.overview;
this._button=e.button;
this._noNodeCell=e.noNodeCell;
DwtTreeItem.call(this,e)
};
DwtHeaderTreeItem.prototype=new DwtTreeItem;
DwtHeaderTreeItem.prototype.constructor=DwtHeaderTreeItem;
DwtHeaderTreeItem.prototype.TEMPLATE="dwt.Widgets#ZHeaderTreeItem";
DwtHeaderTreeItem.prototype.toString=function(){
return"DwtHeaderTreeItem"
};
DwtHeaderTreeItem.prototype._createHtmlFromTemplate=function(e,t){
t.noNodeCell=this._noNodeCell;
DwtTreeItem.prototype._createHtmlFromTemplate.apply(this,arguments)
};
DwtHeaderTreeItem.prototype._initialize=function(){
DwtTreeItem.prototype._initialize.apply(this,arguments);
if(this._button){
this._headerButtonId=this._htmlElId+"_headerButton";
var t=document.getElementById(this._headerButtonId);
if(t){
t.className="Img"+this._button.image;
t.onclick=AjxCallback.simpleClosure(this._onclickHandler,this);
var e=new AjxListener(null,DwtHeaderTreeItem._mouseOverListener);
var a=new AjxListener(null,DwtHeaderTreeItem._mouseOutListener);
this.addListener(DwtEvent.ONMOUSEOVER,e);
this.addListener(DwtEvent.ONMOUSEENTER,e);
this.addListener(DwtEvent.ONMOUSEOUT,a);
this.addListener(DwtEvent.ONMOUSELEAVE,a);
this.addListener(DwtEvent.ONMOUSEUP,new AjxListener(null,DwtHeaderTreeItem._mouseUpListener))
}}};
DwtHeaderTreeItem.prototype._onclickHandler=function(t){
var e=DwtShell.mouseEvent;
e.setFromDhtmlEvent(t,this);
this._button.callback.run(e)
};
DwtHeaderTreeItem._mouseOverListener=function(t){
var a=t.dwtObj;
var e=DwtUiEvent.getTarget(t);
if(e&&(e.id==a._headerButtonId)){
a.setToolTipContent(a._button.tooltip)
}};
DwtHeaderTreeItem._mouseOutListener=function(e){
var t=e.dwtObj;
t.setToolTipContent(null)
};
DwtHeaderTreeItem._mouseUpListener=function(t){

var a=t.dwtObj;
var e=t.target&&t.target.id;
if(e&&(e==a._headerButtonId)){
return
}
DwtTreeItem._mouseUpListener.apply(null,arguments)
};
DwtHeaderTreeItem.prototype._focusByMouseUpEvent=function(t){
var e=t.target&&t.target.id;
if(e&&(e==this._headerButtonId)){
return
}
DwtTreeItem.prototype._focusByMouseUpEvent.apply(this,arguments)
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtTree")){
DwtTree=function(a){
if(arguments.length==0){
return
}
a=Dwt.getParams(arguments,DwtTree.PARAMS);
a.className=a.className||"DwtTree";
DwtComposite.call(this,a);
var e=[DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEUP,DwtEvent.ONDBLCLICK];
if(!AjxEnv.isIE){
e=e.concat([DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEOUT])
}
this._setEventHdlrs(e);
var t=a.style;
if(!t){
this._style=DwtTree.SINGLE_STYLE
}else{
if(t==DwtTree.CHECKEDITEM_STYLE){
t|=DwtTree.SINGLE_STYLE
}
this._style=t
}
this.isCheckedStyle=((this._style&DwtTree.CHECKEDITEM_STYLE)!=0);
this.isCheckedByDefault=a.isCheckedByDefault;
this._selectedItems=new AjxVector();
this._selEv=new DwtSelectionEvent(true)
};
DwtTree.PARAMS=["parent","style","className","posStyle"];
DwtTree.prototype=new DwtComposite;
DwtTree.prototype.constructor=DwtTree;
DwtTree.prototype.toString=function(){
return"DwtTree"
};
DwtTree.SINGLE_STYLE=1;
DwtTree.MULTI_STYLE=2;
DwtTree.CHECKEDITEM_STYLE=4;
DwtTree.ITEM_SELECTED=0;
DwtTree.ITEM_DESELECTED=1;
DwtTree.ITEM_CHECKED=2;
DwtTree.ITEM_ACTIONED=3;
DwtTree.ITEM_DBL_CLICKED=4;
DwtTree.ITEM_EXPANDED=1;
DwtTree.ITEM_COLLAPSED=2;
DwtTree.prototype.getStyle=function(){
return this._style
};
DwtTree.prototype.addSelectionListener=function(e){
this.addListener(DwtEvent.SELECTION,e);
if(DwtControl.globalSelectionListener){
this.addListener(DwtEvent.SELECTION,DwtControl.globalSelectionListener)
}};
DwtTree.prototype.removeSelectionListener=function(e){
this.removeListener(DwtEvent.SELECTION,e)
};
DwtTree.prototype.addTreeListener=function(e){
this.addListener(DwtEvent.TREE,e)
};
DwtTree.prototype.removeTreeListener=function(e){
this.removeListener(DwtEvent.TREE,e)
};
DwtTree.prototype.getItemCount=function(){
return this._children.size()
};
DwtTree.prototype.getItems=function(){
return this._children.getArray()
};
DwtTree.prototype.deselectAll=function(){
var e=this._selectedItems.getArray();
var o=this._selectedItems.size();
for(var t=0;
t<o;
t++){
e[t]._setSelected(false)
}
if(o>0){
this._notifyListeners(DwtEvent.SELECTION,this._selectedItems.getArray(),DwtTree.ITEM_DESELECTED,null,this._selEv)
}
this._selectedItems.removeAll()
};
DwtTree.prototype.getSelection=function(){
return this._selectedItems.getArray()
};
DwtTree.prototype.setSelection=function(n,r,d,e){
var c=this._selectedItems.getArray();
var h=this._selectedItems.size();
var u;
var t=0;
var s=false;
for(var o=0;
o<h;
o++){
if(c[o]==n){
s=true
}else{
c[o]._setSelected(false);
this._selectedItems.remove(c[o]);
if(u==null){
u=new Array()
}
u[t++]=c[o]
}}
if(u&&!r){
this._notifyListeners(DwtEvent.SELECTION,u,DwtTree.ITEM_DESELECTED,null,this._selEv,d)
}
if(s){
return
}
this._selectedItems.add(n);
this._expandUp(n);
if(n._setSelected(true,e)&&!r){
this._notifyListeners(DwtEvent.SELECTION,[n],DwtTree.ITEM_SELECTED,null,this._selEv,d)
}};
DwtTree.prototype.getSelectionCount=function(){
return this._selectedItems.size()
};
DwtTree.prototype.addChild=function(e){};
DwtTree.prototype.addSeparator=function(){
var e=document.createElement("div");
e.className="vSpace";
this.getHtmlElement().appendChild(e)
};
DwtTree.prototype._expandUp=function(t){
var e=t.parent;
while(e instanceof DwtTreeItem){
e.setExpanded(true);
e.setVisible(true);
e=e.parent
}};
DwtTree.prototype._addItem=function(t,e){
this._children.add(t,e);
var o=this.getHtmlElement();
var a=o.childNodes.length;
if(e==null||e>a){
o.appendChild(t.getHtmlElement())
}else{
o.insertBefore(t.getHtmlElement(),o.childNodes[e])
}};
DwtTree.prototype.sort=function(e){
this._children.sort(e);
var t=document.createDocumentFragment();
this._children.foreach(function(o,a){
t.appendChild(o.getHtmlElement());
o._index=a
}
);
this.getHtmlElement().appendChild(t)
};
DwtTree.prototype.removeChild=function(e){
this._children.remove(e);
this._selectedItems.remove(e);
this.getHtmlElement().removeChild(e.getHtmlElement())
};
DwtTree.prototype._getNextTreeItem=function(n){
var a=this.getSelection();
var c=(a&&a.length)?a[0]:null;
var e=null,h=-1;
var r=this.getTreeItemList(true);
if(c){
for(var o=0,s=r.length;
o<s;
o++){
var t=r[o];
if(t==c){
h=n?o+1:o-1;
break
}}
e=r[h]
}else{
if(r&&r.length){
e=n?r[0]:r[r.length-1]
}}
return e
};
DwtTree.prototype.getTreeItemList=function(e){
return this._addToList([],e)
};
DwtTree.prototype._addToList=function(n,s,o){
if(o&&!o._isSeparator&&(!s||(o.getVisible()&&o._selectionEnabled))){
n.push(o)
}
if(!o||!s||o._expanded){
var a=o||this;
var t=a.getChildren?a.getChildren():[];
for(var e=0;
e<t.length;
e++){
this._addToList(n,s,t[e])
}}
return n
};
DwtTree.prototype._deselect=function(e){
if(this._selectedItems.contains(e)){
this._selectedItems.remove(e);
e._setSelected(false);
this._notifyListeners(DwtEvent.SELECTION,[e],DwtTree.ITEM_DESELECTED,null,this._selEv)
}};
DwtTree.prototype._itemActioned=function(t,e){
if(this._actionedItem){
this._actionedItem._setActioned(false);
this._notifyListeners(DwtEvent.SELECTION,[this._actionedItem],DwtTree.ITEM_DESELECTED,e,this._selEv)
}
this._actionedItem=t;
t._setActioned(true);
this._notifyListeners(DwtEvent.SELECTION,[t],DwtTree.ITEM_ACTIONED,e,this._selEv)
};
DwtTree.prototype._itemChecked=function(t,e){
this._notifyListeners(DwtEvent.SELECTION,[t],DwtTree.ITEM_CHECKED,e,this._selEv)
};
DwtTree.prototype._itemClicked=function(n,o){
var t;
var e=this._selectedItems.getArray();
var s=this._selectedItems.size();
if(this._style&DwtTree.SINGLE_STYLE||(!o.shiftKey&&!o.ctrlKey)){
if(s>0){
for(t=0;
t<s;
t++){
e[t]._setSelected(false)
}
this._notifyListeners(DwtEvent.SELECTION,this._selectedItems.getArray(),DwtTree.ITEM_DESELECTED,o,this._selEv);
this._selectedItems.removeAll()
}
this._selectedItems.add(n);
if(n._setSelected(true)){
this._notifyListeners(DwtEvent.SELECTION,[n],DwtTree.ITEM_SELECTED,o,this._selEv)
}}else{
if(o.ctrlKey){
if(this._selectedItems.contains(n)){
this._selectedItems.remove(n);
n._setSelected(false);
this._notifyListeners(DwtEvent.SELECTION,[n],DwtTree.ITEM_DESELECTED,o,this._selEv)
}else{
this._selectedItems.add(n);
if(n._setSelected(true)){
this._notifyListeners(DwtEvent.SELECTION,[n],DwtTree.ITEM_SELECTED,o,this._selEv)
}}}else{}}};
DwtTree.prototype._itemDblClicked=function(t,e){
this._notifyListeners(DwtEvent.SELECTION,[t],DwtTree.ITEM_DBL_CLICKED,e,this._selEv)
};
DwtTree.prototype._itemExpanded=function(a,t,e){
if(!e){
this._notifyListeners(DwtEvent.TREE,[a],DwtTree.ITEM_EXPANDED,t,DwtShell.treeEvent)
}};
DwtTree.prototype._itemCollapsed=function(c,s,n){
var o;
if(!n){
this._notifyListeners(DwtEvent.TREE,[c],DwtTree.ITEM_COLLAPSED,s,DwtShell.treeEvent)
}
var h=false;
var r=this._selectedItems.getArray();
var e=this._selectedItems.size();
var d;
var t=0;
for(o=0;
o<e;
o++){
if(r[o]._isChildOf(c)){
h=true;
if(d==null){
d=new Array()
}
d[t++]=r[o];
r[o]._setSelected(false);
this._selectedItems.remove(r[o])
}}
if(d){
this._notifyListeners(DwtEvent.SELECTION,d,DwtTree.ITEM_DESELECTED,s,this._selEv)
}
if(h&&!this._selectedItems.contains(c)){
this._selectedItems.add(c);
if(c._setSelected(true)){
this._notifyListeners(DwtEvent.SELECTION,[c],DwtTree.ITEM_SELECTED,s,this._selEv)
}}};
DwtTree.prototype._notifyListeners=function(s,e,o,a,t,n){
if(this.isListenerRegistered(s)){
if(a){
DwtUiEvent.copy(t,a)
}
t.items=e;
if(e.length==1){
t.item=e[0]
}
t.detail=o;
t.kbNavEvent=n;
this.notifyListeners(s,t)
}}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtText")){
DwtText=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtText.PARAMS);
e.className=e.className||"DwtText";
DwtControl.call(this,e)
};
DwtText.PARAMS=["parent","className","posStyle"];
DwtText.prototype=new DwtControl;
DwtText.prototype.constructor=DwtText;
DwtText.prototype.toString=function(){
return"DwtText"
};
DwtText.prototype.getTabGroupMember=function(){
return null
};
DwtText.prototype.setText=function(e){
if(!this._textNode){
this._textNode=document.createTextNode(e);
this.getHtmlElement().appendChild(this._textNode)
}else{
this._textNode.data=e
}};
DwtText.prototype.getText=function(){
return this._textNode?this._textNode.data:""
};
DwtText.prototype.getTextNode=function(){
return this._textNode
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtIframe")){
DwtIframe=function(o){
o.posStyle=o.posStyle||DwtControl.STATIC_STYLE;
o.className=o.className||"DwtIframe";
DwtControl.call(this,o);
this._styles=o.styles;
this._noscroll=o.noscroll;
this._iframeID=o.id?DwtId.getIframeId(o.id):Dwt.getNextId();
this._onLoadHandler=o.onload;
this._processHtmlCallback=o.processHtmlCallback;
this._hidden=o.hidden;
this._createFrame(o.html);
if(o.useKbMgmt){
var t=this.getIframe();
var e=Dwt.getIframeDoc(t);
var a=AjxEnv.isIE?e:t.contentWindow;
Dwt.setHandler(a,DwtEvent.ONKEYDOWN,DwtKeyboardMgr.__keyDownHdlr);
Dwt.setHandler(a,DwtEvent.ONKEYUP,DwtKeyboardMgr.__keyUpHdlr);
Dwt.setHandler(a,DwtEvent.ONKEYPRESS,DwtKeyboardMgr.__keyPressHdlr)
}};
DwtIframe.prototype=new DwtControl;
DwtIframe.prototype.constructor=DwtIframe;
DwtIframe.prototype.toString=function(){
return"DwtIframe"
};
DwtIframe.prototype.getIframe=function(){
return document.getElementById(this._iframeID)
};
DwtIframe.prototype.getDocument=function(){
return this.getIframe().contentWindow.document
};
DwtIframe.prototype._rawEventHandler=function(r){
var a=this.getIframe();
var o=a.contentWindow;
if(AjxEnv.isIE){
r=o.event
}
var e;
if(/mouse|context|click|select/i.test(r.type)){
e=new DwtMouseEvent(true)
}else{
e=new DwtUiEvent(true)
}
e.setFromDhtmlEvent(r);
if(r.type=="mousedown"&&DwtMenu&&DwtMenu._outsideMouseDownListener){
DwtMenu._outsideMouseDownListener(r)
}
var n=e.type.toLowerCase();
if(!/^on/.test(n)){
n="on"+n
}
var s=this.getLocation();
if(!AjxEnv.isIE){
var h=o.document;
var t=h.documentElement.scrollLeft||(h.body?h.body.scrollLeft:0);
var u=h.documentElement.scrollTop||(h.body?h.body.scrollTop:0);
s.x-=t;
s.y-=u
}
e.docX+=s.x;
e.docY+=s.y;
e.elementX+=s.x;
e.elementY+=s.y;
var d=DwtMouseEventCapture.getCaptureObj();
if(AjxEnv.isIE||AjxEnv.isSafari||!d){
DwtEventManager.notifyListeners(n,e);
this.parent.notifyListeners(n,e)
}else{
var c=document.createEvent("MouseEvents");
c.initMouseEvent(r.type,true,true,document.defaultView,0,r.screenX,r.screenY,e.docX,e.docY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,r.relatedTarget);
document.body.dispatchEvent(c)
}
e.setToDhtmlEvent(r);
return e._returnValue
};
DwtIframe._forwardEvents=[DwtEvent.ONCHANGE,DwtEvent.ONCLICK,DwtEvent.ONDBLCLICK,DwtEvent.ONFOCUS,DwtEvent.ONKEYDOWN,DwtEvent.ONKEYPRESS,DwtEvent.ONKEYUP,DwtEvent.ONMOUSEDOWN,DwtEvent.ONMOUSEENTER,DwtEvent.ONMOUSELEAVE,DwtEvent.ONMOUSEMOVE,DwtEvent.ONMOUSEOUT,DwtEvent.ONMOUSEOVER,DwtEvent.ONMOUSEUP,DwtEvent.ONSELECTSTART];
DwtIframe.prototype._createFrame=function(t){
var e=this.getHTMLElId();
function a(s){
var n=document.getElementById(e);
var o=DwtControl.findControl(n);
return o._rawEventHandler(s)
}
(function(){
var c,h=[],r=0,o;
var s=document.getElementById(e);
var n=DwtControl.findControl(s);
h[r++]="<iframe";
if(n._noscroll){
h[r++]=" scrolling='no'"
}
if(n._hidden){
h[r++]=" style='visibility:hidden'"
}
h[r++]=" frameborder='0' width='100%' id='";
h[r++]=n._iframeID;
h[r++]="' name='"+n._iframeID+"'";
if(n._onLoadHandler){
h[r++]=" onload='"+n._onLoadHandler+"'"
}
h[r++]=" src='javascript:\"\";' ></iframe>";
n.setContent(h.join(""));
t=t.replace(/(<style[^>]*>)[\s\t\u00A0]*((.|\n)*?)[\s\t\u00A0]*<\x2fstyle>/mgi,function(d,m,u){
return m+u.replace(/@import.*?(;|[\s\t\u00A0]*$)/gi,"")+"</style>"
}
);
c=n.getIframe();
o=Dwt.getIframeDoc(c);
o.open();
if(n._styles){
o.write(["<style type='text/css'>",n._styles,"</style>"].join(""))
}
o.write(t);
o.close();
if(n._processHtmlCallback){
n._processHtmlCallback.run(o)
}
h=o.documentElement.style;
h.margin=h.padding="0";
if(o.body){
o.body.style.margin="0"
}
h=DwtIframe._forwardEvents;
if(!AjxEnv.isIE){
o=c.contentWindow
}
for(r=h.length;
--r>=0;
){
o[h[r]]=a
}}
)()
};
DwtIframe.prototype._resetEventHandlers=function(){
var e=this;
function t(a){
return e._rawEventHandler(a)
}
(function(){
var s,n=[],o=0,a;
s=e.getIframe();
a=Dwt.getIframeDoc(s);
n=DwtIframe._forwardEvents;
if(!AjxEnv.isIE){
a=s.contentWindow
}
for(o=n.length;
--o>=0;
){
a[n[o]]=t
}}
)()
}
}
if(AjxPackage.define("ajax.dwt.widgets.DwtForm")){
DwtForm=function(e){
if(arguments.length==0){
return
}
e=Dwt.getParams(arguments,DwtForm.PARAMS);
e.className=e.className||"DwtForm";
DwtComposite.apply(this,arguments);
this.setScrollStyle(DwtControl.SCROLL);
this._tabGroup=new DwtTabGroup(this._htmlElId);
this._context={
set:AjxCallback.simpleClosure(this.set,this),get:AjxCallback.simpleClosure(this.get,this)};
this._dirty={};
this._ignore={};
this._invalid={};
this.setModel(e.model);
this.setForm(e.form);
this.reset()
};
DwtForm.prototype=new DwtComposite;
DwtForm.prototype.constructor=DwtForm;
DwtForm.prototype.toString=function(){
return"DwtForm"
};
DwtForm.PARAMS=DwtControl.PARAMS.concat("form","model");
DwtForm.prototype.setValue=function(s,a,t){
if(typeof s!="string"){
s=String(s)
}
if(s.match(/\./)||s.match(/\[/)){
var n=s.replace(/\[(\d+)\](\.)?/,".$1$2").split(".");
var o=this.getControl(n[0]);
if(Dwt.instanceOf(o,"DwtForm")){
o.setValue(n.slice(1).join("."),a,t)
}
return
}
var e=this._items[s];
if(!e){
return
}
if(!t&&a==e.value){
return
}
this._setModelValue(s,a);
this._setControlValue(s,a)
};
DwtForm.prototype.getValue=function(s,e){
if(typeof s!="string"){
s=String(s)
}
if(s.match(/\./)||s.match(/\[/)){
var n=s.replace(/\[(\d+)\](\.)?/,".$1$2").split(".");
var o=this.getControl(n[0]);
if(Dwt.instanceOf(o,"DwtForm")){
return o.getValue(n.slice(1).join("."))
}
return null
}
var t=this._items[s];
if(!t){
return
}
if(t.getter){
return this._call(t.getter)||e
}
var a=this._getControlValue(s)||t.value;
return a||e
};
DwtForm.prototype.getControl=function(t){
if(typeof t!="string"){
t=String(t)
}
var e=this._items[t];
return e&&e.control
};
DwtForm.prototype.isRelevant=function(e){
return this.isVisible(e)&&this.isEnabled(e)
};
DwtForm.prototype.getTabGroupMember=function(){
return this._tabGroup
};
DwtForm.prototype.setLabel=function(o,e){
var t=this._items[o];
if(!t){
return
}
if(e==this.getLabel(o)){
return
}
var a=t.control;
if(!a){
return
}
if(a.setLabel){
a.setLabel(e);
return
}
if(a.setText){
a.setText(e);
return
}};
DwtForm.prototype.getLabel=function(a){
var e=this._items[a];
var t=e&&e.control;
if(t){
if(t.getLabel){
return t.getLabel()
}
if(t.getText){
return t.getText()
}}
return""
};
DwtForm.prototype.setVisible=function(n,o){
if(arguments.length==1){
DwtComposite.prototype.setVisible.call(this,arguments[0]);
return
}
var t=this._items[n];
var a=t&&t.control;
if(!a){
return
}
if(a.setVisible){
a.setVisible(o)
}else{
Dwt.setVisible(a,o)
}
var e=document.getElementById([this._htmlElId,n,"row"].join("_"));
if(e){
Dwt.setVisible(e,o)
}};
DwtForm.prototype.isVisible=function(a){
if(arguments.length==0){
return DwtComposite.prototype.isVisible.call(this)
}
var e=this._items[a];
var t=e&&e.control;
if(!t){
return false
}
if(t.getVisible){
return t.getVisible()
}
if(t.isVisible){
return t.isVisible()
}
return Dwt.getVisible(t)
};
DwtForm.prototype.setEnabled=function(o,e){
if(arguments.length==1){
DwtComposite.prototype.setEnabled.call(this,arguments[0]);
return
}
var t=this._items[o];
var a=t&&t.control;
if(!a){
return
}
if(a.setEnabled){
a.setEnabled(e)
}else{
a.disabled=!e
}};
DwtForm.prototype.isEnabled=function(a){
if(arguments.length==0){
return DwtComposite.prototype.isEnabled.call(this)
}
var e=this._items[a];
var t=e&&e.control;
if(!t){
return false
}
if(t.isEnabled){
return t.isEnabled()
}
if(t.getEnabled){
return t.getEnabled()
}
return !t.disabled
};
DwtForm.prototype.setValid=function(t,e){
if(typeof t=="boolean"){
e=arguments[0];
for(t in this._items){
this.setValid(t,e)
}
return
}
if(e){
delete this._invalid[t]
}else{
this._invalid[t]=true
}};
DwtForm.prototype.isValid=function(e){
if(arguments.length==0){
for(var e in this._invalid){
return false
}
return true
}
return !(e in this._invalid)
};
DwtForm.prototype.getInvalidItems=function(){
return AjxUtil.keys(this._invalid)
};
DwtForm.prototype.setDirty=function(o,t,e){
if(typeof o=="boolean"){
t=arguments[0];
for(o in this._items){
this.setDirty(o,t,true)
}
if(!e&&this._ondirty){
this._call(this._ondirty,["*"])
}
return
}
if(t){
this._dirty[o]=true
}else{
delete this._dirty[o]
}
if(!e&&this._ondirty){
var a=this._items[o];
if(!a.ignore||!this._call(a.ignore)){
this._call(this._ondirty,[o])
}}};
DwtForm.prototype.isDirty=function(t){
if(arguments.length==0){
for(var t in this._dirty){
var e=this._items[t];
if(e.ignore&&this._call(e.ignore)){
continue
}
return true
}
return false
}
var e=this._items[t];
return e.ignore&&this._call(e.ignore)?false:t in this._dirty
};
DwtForm.prototype.getDirtyItems=function(){
DwtForm.__acceptDirtyItem.form=this;
return AjxUtil.keys(this._dirty,DwtForm.__acceptDirtyItem)
};
DwtForm.__acceptDirtyItem=function(a){
var t=arguments.callee.form;
var e=t._items[a];
return !e.ignore||!t._call(e.ignore)
};
DwtForm.prototype.setIgnore=function(t,e){
if(typeof t=="boolean"){
this._ignore={};
return
}
if(e){
this._ignore[t]=true;
return
}
delete this._ignore[t]
};
DwtForm.prototype.isIgnore=function(e){
return e in this._ignore
};
DwtForm.prototype.set=function(t,e){
this.setValue(t,e,true);
this.update()
};
DwtForm.prototype.get=DwtForm.prototype.getValue;
DwtForm.prototype.setModel=function(e,t){
this._context.model=this.model=e
};
DwtForm.prototype.setForm=function(e){
this._context.form=this.form=e;
this._createHtml(e.template)
};
DwtForm.prototype.validate=function(o){
if(arguments.length==0){
this.setValid(true);
for(var o in this._items){
var t=this._items[o];
try{
this.setValid(t.validator?t.validator(this.getValue(o)):true)
}
catch(a){}}
return this.isValid()
}
var t=this._items[o];
if(!t){
return true
}
try{
this.setValid(t.validator?t.validator(this.getValue(o)):true)
}
catch(a){}
return !(o in this._invalid)
};
DwtForm.prototype.reset=function(o){
this._dirty={};
this._ignore={};
this._invalid={};
for(var a in this._items){
var t=this._items[a];
if(t.control instanceof DwtForm){
t.control.reset(o)
}
var e=this._items[a].def;
if(!e){
continue
}
this._initControl(e,o)
}
this.update();
for(var a in this._items){
var t=this._items[a];
t.ovalue=t.value
}
this.setDirty(false);
this.validate();
if(this._onreset){
this._call(this._onreset)
}};
DwtForm.prototype.update=function(){
for(var t in this._items){
var e=this._items[t];
if(e.control instanceof DwtForm){
e.control.update()
}
if(e.getter){
this.setValue(t,this._call(e.getter))
}}
for(var t in this._items){
var e=this._items[t];
if(e.visible){
this.setVisible(t,Boolean(this._call(e.visible)))
}
if(e.enabled){
this.setEnabled(t,Boolean(this._call(e.enabled)))
}
if(e.ignore){
this.setIgnore(t,Boolean(this._call(e.ignore)))
}}
if(this._onupdate){
this._call(this._onupdate)
}};
DwtForm.prototype._setModelValue=function(o,a){
var t=this._items[o];
t.value=t.setter?this._call(t.setter,[a]):a;
var e=!Boolean(this._call(t.equals,[t.value,t.ovalue]));
this.setDirty(o,e);
this.validate(o);
return e
};
DwtForm.prototype._setControlValue=function(a,e){
var t=this._items[a].control;
if(t){
if(t instanceof DwtCheckbox||t instanceof DwtRadioButton){
t.setSelected(e);
return
}
if(t instanceof DwtMenuItem&&t.isStyle(DwtMenuItem.CHECK_STYLE)){
t.setChecked(e,true);
return
}
if(t.setSelectedValue){
t.setSelectedValue(e);
return
}
if(t.setValue){
t.setValue(e);
return
}
if(t.setText&&!(t instanceof DwtButton)){
t.setText(e);
return
}
if(!(t instanceof DwtControl)){
if(t.type=="checkbox"||t=="radio"){
t.checked=e
}else{
t.value=e
}
return
}}};
DwtForm.prototype._getControlValue=function(t){
var e=this._items[t].control;
if(e){
if(e instanceof DwtCheckbox||e instanceof DwtRadioButton){
return e.isSelected()
}
if(e.getSelectedValue){
return e.getSelectedValue()
}
if(e.getValue){
return e.getValue()
}
if(e.getText&&!(e instanceof DwtButton)){
return e.getText()
}
if(!(e instanceof DwtControl)){
if(e.type=="checkbox"||e=="radio"){
return e.checked
}
return e.value
}}};
DwtForm.prototype._deleteItem=function(e){
delete this._items[e];
delete this._dirty[e];
delete this._invalid[e];
delete this._ignore[e]
};
DwtForm.prototype._call=function(t,e){
if(t){
if(e){
return t.apply(this,e)
}
return t.call(this)
}};
DwtForm.prototype._createHtml=function(e){
this._createHtmlFromTemplate(e||this.TEMPLATE,{
id:this._htmlElId}
)
};
DwtForm.prototype._createHtmlFromTemplate=function(t,s){
DwtComposite.prototype._createHtmlFromTemplate.apply(this,arguments);
var a=[];
this._items={};
this._tabGroup.removeAllMembers();
this._onupdate=null;
this._onreset=null;
this._ondirty=null;
var e=this.form;
if(e&&e.items){
this._registerControls(e.items,null,a);
this._onupdate=DwtForm.__makeFunc(e.onupdate);
this._onreset=DwtForm.__makeFunc(e.onreset);
this._ondirty=DwtForm.__makeFunc(e.ondirty)
}
var c=this.getHtmlElement().getElementsByTagName("A");
for(var r=0;
r<c.length;
r++){
var h=c[r];
if(!h.href||h.getAttribute("notab")=="true"){
continue
}
if(this._items[h.id]){
continue
}
a.push({
tabindex:h.getAttribute("tabindex")||Number.MAX_VALUE,control:h}
)
}
a.sort(DwtForm.__byTabIndex);
for(var r=0;
r<a.length;
r++){
var n=a[r].control;
var o=(n.getTabGroupMember&&n.getTabGroupMember())||n;
this._tabGroup.addMember(o)
}};
DwtForm.prototype._registerControls=function(a,n,e,s,o,r){
for(var t=0;
t<a.length;
t++){
this._registerControl(a[t],n,e,s,o,r)
}};
DwtForm.prototype._registerControl=function(d,t,o,n,p,u){
var e=d.id||[this._htmlElId,Dwt.getNextId()].join("_");
var w=this._items[e]={
id:e,def:d,parentDef:t,equals:DwtForm.__makeFunc(d.equals)||DwtForm.__equals,getter:DwtForm.__makeGetter(d),setter:DwtForm.__makeSetter(d),value:d.value,visible:DwtForm.__makeFunc(d.visible),enabled:DwtForm.__makeFunc(d.enabled),validator:DwtForm.__makeFunc(d.validator),ignore:DwtForm.__makeFunc(d.ignore),control:d.control};
if(d.aka){
this._items[e].aka=d.aka;
this._items[d.aka]=w
}
var c=w.control;
if(c){
return c
}
p=p||this;
var m=d.type=d.type||u;
var h=document.getElementById([p._htmlElId,e].join("_"));
if(Dwt.instanceOf(m,"DwtRadioButtonGroup")){
c=new window[m]({}
);
w.control=c;
var g={
name:[p._htmlElId,e].join("_"),value:d.value};
if(d.items){
for(var r=0;
r<d.items.length;
r++){
var s=d.items[r];
var f=s.checked||s.value==d.value;
var a=this._registerControl(s,d,o,g,p,"DwtRadioButton");
a.setValue(s.value);
this._items[s.id].value=f;
c.addRadio(a.getInputElement().id,a,f);
var y=DwtForm.__makeFunc(s.onclick||d.onclick);
a.addSelectionListener(new AjxListener(this,this._radio2group2model,[s.id,e,y]));
DwtForm.__hack_fixRadioButtonHandler(a)
}}}else{
if(m){
if(Dwt.instanceOf(m,"DwtInputField")){
w.value=w.value||""
}
if(Dwt.instanceOf(m,"DwtFormRows")){
w.equals=DwtFormRows.__equals
}
if(h){
c=w.control=this._createControl(d,t,o,n,p,u)
}}else{
if(h){
this._attachElementHandlers(d,t,o,p,h);
c=w.control=h;
if(d.items){
this._registerControls(d.items,d,o,null,p,null)
}}}}
if(h&&c instanceof DwtControl){
c.replaceElement(h)
}
if(h&&c instanceof DwtInputField){
c.getInputElement().id+="_input"
}
if(d.notab==null){
d.notab=h&&h.getAttribute("notab")=="true"
}
if(o&&c&&!d.notab&&!(c instanceof DwtRadioButtonGroup)){
o.push({
tabindex:(h&&h.getAttribute("tabindex"))||Number.MAX_VALUE,control:c}
)
}
if(c instanceof DwtListView){
w.getter=w.getter||AjxCallback.simpleClosure(this.__list_getValue,this,e);
w.setter=w.setter||AjxCallback.simpleClosure(this.__list_setValue,this,e)
}
return c
};
DwtForm.prototype._attachElementHandlers=function(r,a,o,d,s){
var t=r.id;
var e=s.nodeName.toLowerCase();
var c=s.type;
if(c=="checkbox"||c=="radio"){
var h;
if(c=="radio"){
h=s.name;
if(!this._items[h]){
this._items[h]={
id:h}
}
if(s.checked){
this._items[h].value=s.value
}}
var m=s.onclick;
var u=DwtForm.__makeFunc(r.onclick);
s.onclick=AjxCallback.simpleClosure(this._htmlInput_checked,this,t,h,u,m)
}else{
if(e=="select"){
var n=s.onchange;
var u=DwtForm.__makeFunc(r.onchange);
s.onchange=AjxCallback.simpleClosure(this._htmlSelect_selectedIndex,this,t,u,n)
}else{
if(e=="button"||e=="a"||c=="button"||c=="reset"||c=="submit"){
var m=s.onclick;
var u=DwtForm.__makeFunc(r.onclick);
s.onclick=AjxCallback.simpleClosure(this._htmlElement,this,t,u,m)
}else{
if(e=="textarea"||e=="input"){
var n=s.onchange;
var u=DwtForm.__makeFunc(r.onchange);
s.onchange=AjxCallback.simpleClosure(this._htmlInput_value,this,t,u,n)
}}}}
return s
};
DwtForm.prototype._createControl=function(u,c,C,B,f,h){
var x=u.id||[this._htmlElId,Dwt.getNextId()].join("_");
var n=u.type=u.type||h;
B=B?AjxUtil.createProxy(B):{};
B.id=B.id||[this._htmlElId,x].join("_");
B.parent=f||this;
B.template=u.template||B.template;
B.className=u.className||B.className;
var W=Dwt.instanceOf(n,"DwtRadioButton");
var k=Dwt.instanceOf(n,"DwtCheckbox");
if(W||k){
B.name=u.name||B.name;
B.checked=u.checked!=null?u.checked:B.checked
}
var m=Dwt.instanceOf(n,"DwtInputField");
if(m){
B.type=u.password?DwtInputField.PASSWORD:null;
B.size=u.cols;
B.rows=u.rows
}
var s=Dwt.instanceOf(n,"DwtTabViewPage");
if(s){
B.contentTemplate=u.template;
delete u.template
}
B.formItemDef=u;
if(u.params){
for(var q in u.params){
B[q]=u.params[q]
}}
var g=new window[n](B);
if(g instanceof DwtSelect){
var o=u.items;
if(o){
for(var O=0;
O<o.length;
O++){
var v=o[O];
v.displayValue=v.label||v.value;
g.addOption(v)
}}
var t=DwtForm.__makeFunc(u.onchange);
g.addChangeListener(new AjxListener(this,this._control2model,[x,t]))
}else{
if(g instanceof DwtButton||g instanceof DwtMenuItem){
if(u.label){
g.setText(u.label)
}
if(u.image){
g.setImage(u.image)
}
if(u.menu){
var a=Dwt.instanceOf(u.menu.type||"DwtMenu","DwtMenu");
var e;
if(a){
e=this._registerControl(u.menu,u,null,null,g,"DwtMenu")
}else{
e=new DwtMenu({
parent:g}
);
var A=Dwt.instanceOf(u.menu.type,"DwtCalendar")?DwtMenu.CALENDAR_PICKER_STYLE:DwtMenu.GENERIC_WIDGET_STYLE;
this._registerControl(u.menu,u,null,{
style:A}
,e)
}
g.setMenu(e)
}
var T;
if(f instanceof DwtToolBar||f instanceof DwtMenu){
T=c.id
}
var t=DwtForm.__makeFunc(u.onclick||(c&&c.onclick));
g.addSelectionListener(new AjxListener(this,this._item2parent,[x,T,t]))
}else{
if(g instanceof DwtCheckbox&&!(g instanceof DwtRadioButton)){
var t=DwtForm.__makeFunc(u.onclick);
g.addSelectionListener(new AjxListener(this,this._control2model,[x,t]))
}else{
if(g instanceof DwtInputField){
var t=DwtForm.__makeFunc(u.onchange);
var z=AjxCallback.simpleClosure(this._input2model2handler,this,x,t);
g.setHandler(DwtEvent.ONKEYUP,z);
g.setHint(u.hint)
}else{
if(g instanceof DwtListView){
g.addSelectionListener(new AjxListener(this,this._handleListSelection,[x]))
}else{
if(g instanceof DwtMenu){
if(u.items){
var j=u.items;
for(var O=0;
O<j.length;
O++){
var w=j[O];
if(w.type==DwtMenuItem.SEPARATOR_STYLE){
new DwtMenuItem({
parent:g,style:DwtMenuItem.SEPARATOR_STYLE}
);
continue
}
this._registerControl(w,u,null,null,g,"DwtMenuItem")
}}}else{
if(g instanceof DwtTabView){
var d=u.items;
if(d){
this._registerControls(d,u,null,null,g,"DwtTabViewPage")
}}else{
if(g instanceof DwtTabViewPage&&f instanceof DwtTabView){
var D=f.addTab(u.label,g);
if(u.image){
f.getTabButton(D).setImage(u.image)
}
if(u.items){
this._registerControls(u.items,u,C,null,g)
}}else{
if(g instanceof DwtToolBar){
var y=u.items;
if(y){
for(var O=0;
O<y.length;
O++){
var r=y[O];
if(r.type==DwtToolBar.SPACER){
g.addSpacer(r.size);
continue
}
if(r.type==DwtToolBar.SEPARATOR){
g.addSeparator(r.className);
continue
}
if(r.type==DwtToolBar.FILLER){
g.addFiller(r.className);
continue
}
this._registerControl(r,u,null,null,g,"DwtToolBarButton")
}}}else{
if(g instanceof DwtComposite){
if(u.items){
this._registerControls(u.items,u,C,null,g)
}}}}}}}}}}}
return g
};
DwtForm.prototype._initControl=function(e,o){
var a=e.id;
if(e.label){
this.setLabel(a,e.label)
}
var t=this._items[a];
if(o){
t.ovalue=t.value
}else{
if(e.value){
if(Dwt.instanceOf(e.type,"DwtRadioButton")){
t.ovalue=t.value=t.control.isSelected()
}else{
this.setValue(a,e.value,true);
t.ovalue=t.value
}}else{
t.ovalue=null
}}
if(typeof e.enabled=="boolean"){
this.setEnabled(a,e.enabled)
}
if(typeof e.visible=="boolean"){
this.setVisible(a,e.visible)
}};
DwtForm.prototype._htmlElement=function(o,a,t,e){
if(a){
this._call(a,[o])
}
if(t){
t(e)
}};
DwtForm.prototype._htmlInput_checked=function(r,s,a,t,e){
var n=this.getControl(r);
var o=n.checked;
this._setModelValue(r,o);
if(s&&o){
this._setModelValue(s,n.value)
}
this.update();
this._htmlElement(r,a,t,e)
};
DwtForm.prototype._htmlInput_value=function(o,a,t,e){
this._setModelValue(o,this.getControl(o).value);
this.update();
this._htmlElement(o,a,t,e)
};
DwtForm.prototype._htmlSelect_selectedIndex=function(n,o,a,t){
var e=this.getControl(n);
this._setModelValue(n,e.options[e.selectedIndex].value);
this.update();
this._htmlElement(n,o,a,t)
};
DwtForm.prototype._control2model=function(t,e){
this._setModelValue(t,this._getControlValue(t));
this.update();
if(e){
this._call(e,[t])
}};
DwtForm.prototype._radio2group2model=function(e,t,a){
this._setModelValue(t,this.getControl(e).getValue());
this._setModelValue(e,this._getControlValue(e));
this.update();
if(a){
this._call(a,[e])
}};
DwtForm.prototype._input2model2handler=function(t,e){
this._setModelValue(t,this._getControlValue(t));
this.update();
if(e){
this._call(e,[t])
}};
DwtForm.prototype._item2parent=function(o,n,t){
var a=this.getControl(o);
var e=this._items[o].def;
if(a instanceof DwtButtonColorPicker||(e.menu&&!e.onclick)){
a._toggleMenu()
}else{
if(n){
this._setModelValue(n,this._getControlValue(o)||o);
this.update()
}}
if(t){
this._call(t,[o])
}};
DwtForm.prototype._handleListSelection=function(t,e){
this.update()
};
DwtForm.prototype.__list_getValue=function(e){
return this.getControl(e).getSelection()
};
DwtForm.prototype.__list_setValue=function(t,e){
this.getControl(t).setSelection(e)
};
DwtForm.__makeGetter=function(s){
var t=s.getter;
if(t){
return DwtForm.__makeFunc(t)
}
var n=s.ref;
if(!n){
return null
}
var r=n.split(".");
var e=["var context = this.model;",];
for(var o=0;
o<r.length;
o++){
var a=r[o];
var h=DwtForm.__makeFuncName(a);
if(o==r.length-1){
break
}
e.push("context = context && (context.",h," ? context.",h,"() : context.",a,");")
}
e.push("var value = context ? (context.",h," ? context.",h,"() : context.",a,") : this._items.",a,".value;","return value !== undefined ? value : defaultValue;");
return new Function("defaultValue",e.join(""))
};
DwtForm.__makeSetter=function(c){
var o=c.setter;
if(o){
return DwtForm.__makeFunc(o)
}
var a=c.ref;
if(!a){
return null
}
var n=a.split(".");
var h=["var context = this.model;",];
for(var r=0;
r<n.length;
r++){
var s=r==n.length-1;
var e=n[r];
var t=DwtForm.__makeFuncName(e,s?"set":"get");
if(s){
break
}
h.push("context = context && (context.",t," ? context.",t,"() : context.",e,");")
}
h.push("if (context) {","if (context.",t,") {","context.",t,"(value);","}","else {","context.",e," = value;","}","}");
return new Function("value",h.join("\n"))
};
DwtForm.__makeFuncName=function(e,t){
return[t||"get",e.substr(0,1).toUpperCase(),e.substr(1)].join("")
};
DwtForm.__makeFunc=function(t){
if(t==null){
return null
}
if(typeof t=="function"&&!(t instanceof RegExp)){
return t
}
var e=["with (this._context) {","return (",t,");","}"].join("");
return new Function(e)
};
DwtForm.__equals=function(t,e){
return t==e
};
DwtForm.__byTabIndex=function(t,e){
return t.tabindex-e.tabindex
};
DwtForm.__hack_fixRadioButtonHandler=function(t){
var e=[t.getInputElement().onclick,DwtCheckbox.__handleClick];
var a=function(o){
for(var n=0;
n<e.length;
n++){
var s=e[n];
if(s){
s(o)
}}};
Dwt.setHandler(t.getInputElement(),DwtEvent.ONCLICK,a)
};
DwtFormRows=function(a){
if(arguments.length==0){
return
}
this._itemDef=a.formItemDef||{};
a.className=a.className||"DwtFormRows";
DwtForm.call(this,{
id:a.id,parent:a.parent,form:{}
,template:this._itemDef.template}
);
this._rowsTabGroup=new DwtTabGroup(this._htmlElId);
this._rowDef=this._itemDef.rowitem||{};
this._equals=DwtForm.__makeFunc(this._rowDef.equals)||DwtForm.__equals;
this._rowCount=0;
this._minRows=this._itemDef.minrows||1;
this._maxRows=this._itemDef.maxrows||Number.MAX_VALUE;
if(this._itemDef.rowtemplate){
this.ROW_TEMPLATE=this._itemDef.rowtemplate
}
var t=this._itemDef.items||[];
for(var e=0;
e<t.length;
e++){
this.addRow(t[e])
}
for(;
e<this._minRows;
e++){
this.addRow()
}
this._onaddrow=DwtForm.__makeFunc(this._itemDef.onaddrow);
this._onremoverow=DwtForm.__makeFunc(this._itemDef.onremoverow)
};
DwtFormRows.prototype=new DwtForm;
DwtFormRows.prototype.constructor=DwtFormRows;
DwtFormRows.prototype.toString=function(){
return"DwtFormRows"
};
DwtFormRows.prototype.TEMPLATE="dwt.Widgets#DwtFormRows";
DwtFormRows.prototype.ROW_TEMPLATE="dwt.Widgets#DwtFormRow";
DwtFormRows.prototype.getTabGroupMember=function(){
return this._rowsTabGroup
};
DwtFormRows.prototype.setValue=function(o){
if(arguments.length>1){
DwtForm.prototype.setValue.apply(this,arguments);
return
}
var a=Math.max(o.length,this._minRows);
for(var t=this._rowCount;
t>a;
t--){
this.removeRow(t-1)
}
var e=Math.min(o.length,this._maxRows);
for(var t=this._rowCount;
t<e;
t++){
this.addRow()
}
for(var t=0;
t<e;
t++){
this.setValue(String(t),o[t],true)
}
for(var t=o.length;
t<this._rowCount;
t++){
this.setValue(String(t),null,true)
}};
DwtFormRows.prototype.getValue=function(){
if(arguments.length>0){
return DwtForm.prototype.getValue.apply(this,arguments)
}
var t=new Array(this._rowCount);
for(var e=0;
e<this._rowCount;
e++){
t[e]=this.getValue(String(e))
}
return t
};
DwtFormRows.prototype.getRowCount=function(){
return this._rowCount
};
DwtFormRows.prototype.addRow=function(n,o){
if(this._rowCount>=this._maxRows){
return
}
n=n||(this._rowDef&&AjxUtil.createProxy(this._rowDef));
if(!n){
return
}
if(o==null){
o=this._rowCount
}
for(var u=this._rowCount-1;
u>=o;
u--){
var v=u,m=u+1;
var f=this._items[v];
f.aka=String(m);
delete this._items[v];
this._items[f.aka]=f;
this._setControlIds(f.id,f.aka)
}
n.id=n.id||Dwt.getNextId();
n.aka=String(o);
this._rowCount++;
var k={
id:[this.getHTMLElId(),n.id].join("_")};
var g=AjxTemplate.expand(this.ROW_TEMPLATE,k);
var e=this._rowsEl;
e.appendChild(Dwt.toDocumentFragment(g,k.id+"_row"));
var y=e.lastChild;
if(o!=this._rowCount-1){
e.insertBefore(y,e.childNodes[o])
}
var w=[];
var s=this._registerControl(n,null,w);
var t=this._itemDef.additem?AjxUtil.createProxy(this._itemDef.additem):{
image:"Add"};
t.id=t.id||n.id+"_add";
t.visible="this.getRowCount() < this.getMaxRows()";
t.ignore=true;
var d=this._registerControl(t,null,w,null,null,"DwtButton");
if(!t.onclick){
d.addSelectionListener(new AjxListener(this,this._handleAddRow,[n.id]))
}
var h=this._itemDef.removeitem?AjxUtil.createProxy(this._itemDef.removeitem):{
image:"Remove"};
h.id=h.id||n.id+"_remove";
h.visible="this.getRowCount() > this.getMinRows()";
h.ignore=true;
var p=this._registerControl(h,null,w,null,null,"DwtButton");
if(!h.onclick){
p.addSelectionListener(new AjxListener(this,this._handleRemoveRow,[n.id]))
}
var f=this._items[n.id];
f._rowEl=y;
f._addId=t.id;
f._removeId=h.id;
this._setControlIds(f.id,o);
var a=new DwtTabGroup(n.id);
w.sort(DwtForm.__byTabIndex);
for(var u=0;
u<w.length;
u++){
var s=w[u].control;
a.addMember(s.getTabGroupMember()||s)
}
if(o==this._rowCount-1){
this._rowsTabGroup.addMember(a)
}else{
var r=this._items[String(o+1)];
var c=this._rowsTabGroup.getTabGroupMemberByName(r.id);
this._rowsTabGroup.addMemberBefore(a,c)
}
this.update();
if(this._onaddrow){
this._call(this._onaddrow,[o])
}
return s
};
DwtFormRows.prototype.removeRow=function(r){
if(this._rowCount<=this._minRows){
return
}
var d=this._items[r];
if(d.control instanceof DwtControl){
this.removeChild(d.control)
}
delete this._items[d.aka];
this._deleteItem(d.id);
var h=this._items[d._addId];
if(h){
this.removeChild(h.control);
this._deleteItem(h.id)
}
var c=this._items[d._removeId];
if(c){
this.removeChild(c.control);
this._deleteItem(c.id)
}
var s=Number(d.aka);
for(var a=s+1;
a<this._rowCount;
a++){
var n=a,t=a-1;
this._items[t]=this._items[n];
this._items[t].aka=String(t);
this._setControlIds(this._items[t].id,this._items[t].aka)
}
this._deleteItem(String(--this._rowCount));
var e=d._rowEl;
e.parentNode.removeChild(e);
delete d._rowEl;
var o=this._rowsTabGroup.getTabGroupMemberByName(d.id);
this._rowsTabGroup.removeMember(o);
this.update();
if(this._onremoverow){
this._call(this._onremoverow,[Number(d.aka)])
}};
DwtFormRows.prototype.getMinRows=function(){
return this._minRows
};
DwtFormRows.prototype.getMaxRows=function(){
return this._maxRows
};
DwtFormRows.prototype.getRowCount=function(){
return this._rowCount
};
DwtFormRows.prototype.getIndexForRowId=function(a){
var t=this._rowsEl.childNodes;
for(var e=0;
e<t.length;
e++){
if(t[e].id==[this._htmlElId,a,"row"].join("_")){
return e
}}
return -1
};
DwtFormRows.__equals=function(t,e){
if(t===e){
return true
}
if(!t||!e||t.length!=e.length){
return false
}
for(var o=0;
o<t.length;
o++){
if(!this._call(this._equals,[t[o],e[o]])){
return false
}}
return true
};
DwtFormRows.prototype._setControlIds=function(n,e){
var s=[this.getHTMLElId(),e].join("_");
var o=this._items[n];
this._setControlId(o&&o.control,s);
var t=this._items[o._addId];
this._setControlId(t&&t.control,s+"_add");
var a=this._items[o._removeId];
this._setControlId(a&&a.control,s+"_remove")
};
DwtFormRows.prototype._setControlId=function(e,t){
if(!e){
return
}
if(e instanceof DwtControl){
e.setHtmlElementId(t)
}else{
e.id=t
}};
DwtFormRows.prototype._handleAddRow=function(t){
var e=this.getIndexForRowId(t)+1;
this.addRow(null,e)
};
DwtFormRows.prototype._handleRemoveRow=function(e){
this.removeRow(e)
};
DwtFormRows.prototype._setModelValue=function(t,e){
if(DwtForm.prototype._setModelValue.apply(this,arguments)){
this.parent.setDirty(this._itemDef.id,true)
}};
DwtFormRows.prototype._createHtmlFromTemplate=function(e,t){
DwtForm.prototype._createHtmlFromTemplate.apply(this,arguments);
this._rowsEl=document.getElementById(this._htmlElId+"_rows")
}
}
if(AjxPackage.define("zimbra.csfe.ZmBatchCommand")){
ZmBatchCommand=function(e,t,a){
this._onError=(e===false)?ZmBatchCommand.STOP:ZmBatchCommand.CONTINUE;
this._accountName=t;
this._useJson=a;
this.curId=0;
this._cmds=[];
this._requests=[];
this._respCallbacks=[];
this._errorCallbacks=[]
};
ZmBatchCommand.prototype.toString=function(){
return"ZmBatchCommand"
};
ZmBatchCommand.prototype._sensitive=false;
ZmBatchCommand.STOP="stop";
ZmBatchCommand.CONTINUE="continue";
ZmBatchCommand.prototype.setSensitive=function(e){
this._sensitive=this._sensitive||e
};
ZmBatchCommand.prototype.isSensitive=function(){
return this._sensitive
};
ZmBatchCommand.prototype.add=function(e){
this._cmds.push(e)
};
ZmBatchCommand.prototype.size=function(){
return this.curId
};
ZmBatchCommand.prototype.run=function(m,r){
for(var s=0;
s<this._cmds.length;
s++){
var a=this._cmds[s];
a.run(this);
this.curId++
}
var o={
sensitive:this._sensitive,asyncMode:true,callback:new AjxCallback(this,this._handleResponseRun,[m,r]),errorCallback:r,accountName:this._accountName};
if(this._useJson){
var f={
BatchRequest:{
_jsns:"urn:zimbra",onerror:this._onError}};
var e=f.BatchRequest;
var p=this.size();
if(p&&this._requests.length){
for(var s=0;
s<p;
s++){
var n=this._requests[s];
n.requestId=s;
var u=ZmCsfeCommand.getMethodName(n);
if(!e[u]){
e[u]=[]
}
n[u].requestId=s;
e[u].push(n[u])
}
o.jsonObj=f
}}else{
var c=AjxSoapDoc.create("BatchRequest","urn:zimbra");
c.setMethodAttribute("onerror",this._onError);
var p=this.size();
if(p>0){
for(var s=0;
s<p;
s++){
var d=this._requests[s];
var h=d.getMethod();
h.setAttribute("requestId",s);
var t=c.adoptNode(h);
c.getMethod().appendChild(t)
}
o.soapDoc=c
}}
if(o.jsonObj||o.soapDoc){
appCtxt.getAppController().sendRequest(o)
}else{
if(m){
m.run()
}}};
ZmBatchCommand.prototype._handleResponseRun=function(c,n,u){
var h=u.getResponse();
if(!h.BatchResponse){
return
}
var s=[];
for(var e in h.BatchResponse){
if(e.match(/^_/)){
continue
}
var d=h.BatchResponse[e];
for(var o=0;
o<d.length;
o++){
s[d[o].requestId]={
method:e,resp:d[o]}
}}
var t=[];
for(var o=0;
o<s.length;
o++){
var a=s[o];
try{
this._processResponse(a.method,a.resp)
}
catch(r){
t.push(r);
if(this._onError==ZmBatchCommand.STOP){
break
}}}
if(t.length>0&&n){
n.run.apply(n,t)
}else{
if(c){
c.run(u)
}}};
ZmBatchCommand.prototype.addRequestParams=function(t,a,e){
this._requests[this.curId]=t;
this._respCallbacks[this.curId]=a;
this._errorCallbacks[this.curId]=e
};
ZmBatchCommand.prototype.addNewRequestParams=function(t,a,e){
this.addRequestParams(t,a,e);
this.curId++
};
ZmBatchCommand.prototype._processResponse=function(r,n){
var s=n.requestId;
if(r=="Fault"){
var t=ZmCsfeCommand.faultToEx(n,"ZmBatchCommand.prototype.run");
if(this._errorCallbacks[s]){
var o=this._errorCallbacks[s].run(t);
if(!o){
appCtxt.getAppController()._handleException(t)
}}
throw t
}
if(this._respCallbacks[s]){
var a={};
a[r]=n;
var e=new ZmCsfeResult(a);
this._respCallbacks[s].run(e,n)
}}
}
if(AjxPackage.define("zimbra.csfe.ZmCsfeCommand")){
ZmCsfeCommand=function(){};
ZmCsfeCommand.prototype.toString=function(){
return"ZmCsfeCommand"
};
ZmCsfeCommand._COOKIE_NAME="ZM_AUTH_TOKEN";
ZmCsfeCommand.serverUri=null;
ZmCsfeCommand._sessionId=null;
ZmCsfeCommand.REAUTH="reauth";
ZmCsfeCommand.RETRY="retry";
ZmCsfeCommand.getAuthToken=function(){
return AjxCookie.getCookie(document,ZmCsfeCommand._COOKIE_NAME)
};
ZmCsfeCommand.setCookieName=function(e){
ZmCsfeCommand._COOKIE_NAME=e
};
ZmCsfeCommand.setServerUri=function(e){
ZmCsfeCommand.serverUri=e
};
ZmCsfeCommand.setAuthToken=function(t,s,n,a){
ZmCsfeCommand._curAuthToken=t;
if(s!=null){
var o=null;
if(s>0){
o=new Date();
var e=parseInt(s);
o.setTime(o.getTime()+e)
}
AjxCookie.setCookie(document,ZmCsfeCommand._COOKIE_NAME,t,o,"/",null,a)
}else{
AjxCookie.deleteCookie(document,ZmCsfeCommand._COOKIE_NAME,"/")
}
if(n){
ZmCsfeCommand.setSessionId(n)
}};
ZmCsfeCommand.clearAuthToken=function(){
AjxCookie.deleteCookie(document,ZmCsfeCommand._COOKIE_NAME,"/")
};
ZmCsfeCommand.getSessionId=function(){
return ZmCsfeCommand._sessionId
};
ZmCsfeCommand.setSessionId=function(e){
var t=(e!=null)?((e instanceof Array)?e[0].id:e.id):null;
ZmCsfeCommand._sessionId=t?parseInt(t):null
};
ZmCsfeCommand.faultToEx=function(t,a){
var o={
msg:AjxStringUtil.getAsString(t.Reason.Text),code:AjxStringUtil.getAsString(t.Detail.Error.Code),method:(a?a.methodNameStr:null),detail:AjxStringUtil.getAsString(t.Code.Value),data:t.Detail.Error.a,trace:(t.Detail.Error.Trace||"")};
var e;
if(a){
if(a.soapDoc){
o.request=a.soapDoc.getXml()
}else{
if(a.jsonRequestObj){
if(a.jsonRequestObj&&a.jsonRequestObj.Header&&a.jsonRequestObj.Header.context){
a.jsonRequestObj.Header.context.authToken="(removed)"
}
o.request=AjxStringUtil.prettyPrint(a.jsonRequestObj,true)
}}}
return new ZmCsfeException(o)
};
ZmCsfeCommand.getMethodName=function(t){
var e=(t&&t._methodEl&&t._methodEl.tagName)?t._methodEl.tagName:null;
if(!e){
for(var a in t){
if(a.indexOf("Request")!=-1){
e=a;
break
}}}
return(e||"[unknown]")
};
ZmCsfeCommand.prototype.invoke=function(r){
this.cancelled=false;
if(!(r&&(r.soapDoc||r.jsonObj))){
return
}
var e=ZmCsfeCommand.getRequestStr(r);
var s;
try{
var n=(r.serverUri||ZmCsfeCommand.serverUri)+r.methodNameStr;
this._st=new Date();
var o={
"Content-Type":"application/soap+xml; charset=utf-8"};
if(AjxEnv.isIE6&&(location.protocol=="https:")){
o.Connection="Close"
}
if(r.asyncMode){
s=new AjxCallback(this,this._runCallback,[r]);
this._rpcId=AjxRpc.invoke(e,n,o,s)
}else{
var t=AjxRpc.invoke(e,n,o);
return(!r.returnXml)?(this._getResponseData(t,r)):t
}}
catch(a){
this._handleException(a,r,s)
}};
ZmCsfeCommand.prototype.invokeRest=function(o){
if(!(o&&o.restUri)){
return
}
var a;
try{
this._st=new Date();
if(o.asyncMode){
a=new AjxCallback(this,this._runCallback,[o]);
this._rpcId=AjxRpc.invoke(null,o.restUri,null,a,true)
}else{
var e=AjxRpc.invoke(null,o.restUri,null,null,true);
return e.text
}}
catch(t){
this._handleException(t,o,a)
}};
ZmCsfeCommand.prototype.cancel=function(){
if(!this._rpcId){
return
}
this.cancelled=true;
var e=AjxRpc.getRpcRequestById(this._rpcId);
if(e){
e.cancel()
}};
ZmCsfeCommand.getRequestStr=function(e){
return e.soapDoc?ZmCsfeCommand._getSoapRequestStr(e):ZmCsfeCommand._getJsonRequestStr(e)
};
ZmCsfeCommand._getJsonRequestStr=function(r){
var n={
Header:{}
,Body:r.jsonObj};
var t=n.Header.context={
_jsns:"urn:zimbra"};
var a=["ZimbraWebClient - ",AjxEnv.browser," (",AjxEnv.platform,")"].join("");
t.userAgent={
name:a};
if(ZmCsfeCommand.clientVersion){
t.userAgent.version=ZmCsfeCommand.clientVersion
}
if(r.noSession){
t.nosession={}
}else{
var s=ZmCsfeCommand.getSessionId();
if(s){
t.session={
_content:s,id:s}
}else{
t.session={}
}}
if(r.targetServer){
t.targetServer={
_content:r.targetServer}
}
if(r.highestNotifySeen){
t.notify={
seq:r.highestNotifySeen}
}
if(r.changeToken){
t.change={
token:r.changeToken,type:"new"}
}
if(!r.skipAuthCheck){
if(r.accountId){
t.account={
_content:r.accountId,by:"id"}
}else{
if(r.accountName){
t.account={
_content:r.accountName,by:"name"}
}}}
if(r.useXml){
t.format={
type:"xml"}
}
r.methodNameStr=ZmCsfeCommand.getMethodName(r.jsonObj);
if(!r.noAuthToken){
var e=ZmCsfeCommand.getAuthToken();
if(!e){
throw new ZmCsfeException("AuthToken required",ZmCsfeException.NO_AUTH_TOKEN,r.methodNameStr)
}
if(ZmCsfeCommand._curAuthToken&&!r.skipAuthCheck&&(r.resend!=ZmCsfeCommand.REAUTH)&&(e!=ZmCsfeCommand._curAuthToken)){
throw new ZmCsfeException("AuthToken has changed",ZmCsfeException.AUTH_TOKEN_CHANGED,r.methodNameStr)
}
t.authToken=ZmCsfeCommand._curAuthToken=e
}
if(window.DBG){
var o=DBG._getTimeStamp()
}
r.jsonRequestObj=n;
return AjxStringUtil.objToString(n)
};
ZmCsfeCommand._getSoapRequestStr=function(r){
var m=r.soapDoc;
if(!r.resend){
var p=m.createHeaderElement();
var n=m.set("context",null,p,"urn:zimbra");
var t=m.set("userAgent",null,n);
var a=["ZimbraWebClient - ",AjxEnv.browser," (",AjxEnv.platform,")"].join("");
t.setAttribute("name",a);
if(ZmCsfeCommand.clientVersion){
t.setAttribute("version",ZmCsfeCommand.clientVersion)
}
if(r.noSession){
m.set("nosession",null,n)
}else{
var h=ZmCsfeCommand.getSessionId();
var c=m.set("session",null,n);
if(h){
c.setAttribute("id",h)
}}
if(r.targetServer){
m.set("targetServer",r.targetServer,n)
}
if(r.highestNotifySeen){
var g=m.set("notify",null,n);
g.setAttribute("seq",r.highestNotifySeen)
}
if(r.changeToken){
var d=m.set("change",null,n);
d.setAttribute("token",r.changeToken);
d.setAttribute("type","new")
}
if(!r.skipAuthCheck){
if(r.accountId){
var s=m.set("account",r.accountId,n);
s.setAttribute("by","id")
}else{
if(r.accountName){
var s=m.set("account",r.accountName,n);
s.setAttribute("by","name")
}}}
if(!r.useXml){
var o=m.set("format",null,n);
o.setAttribute("type","js")
}}
r.methodNameStr=ZmCsfeCommand.getMethodName(m);
if(!r.noAuthToken){
var f=ZmCsfeCommand.getAuthToken();
if(!f){
throw new ZmCsfeException("AuthToken required",ZmCsfeException.NO_AUTH_TOKEN,r.methodNameStr)
}
if(ZmCsfeCommand._curAuthToken&&!r.skipAuthCheck&&(r.resend!=ZmCsfeCommand.REAUTH)&&(f!=ZmCsfeCommand._curAuthToken)){
throw new ZmCsfeException("AuthToken has changed",ZmCsfeException.AUTH_TOKEN_CHANGED,r.methodNameStr)
}
ZmCsfeCommand._curAuthToken=f;
if(r.resend==ZmCsfeCommand.REAUTH){
var e=m.getDoc().getElementsByTagName("authToken");
if(e&&e.length==1){
e[0].firstChild.data=f
}else{
e=m.getDoc().getElementsByTagName("context");
if(e&&e.length==1){
m.set("authToken",f,e[0])
}else{}}}else{
if(!r.resend){
m.set("authToken",f,n)
}}}
if(window.DBG){
var u=DBG._getTimeStamp()
}
return m.getXml()
};
ZmCsfeCommand.prototype._runCallback=function(a,e){
if(!e){
return
}
if(this.cancelled&&a.skipCallbackIfCancelled){
return
}
var t;
if(e instanceof ZmCsfeResult){
t=e
}else{
t=this._getResponseData(e,a)
}
this._en=new Date();
if(a.callback){
a.callback.run(t)
}else{}};
ZmCsfeCommand.prototype._getResponseData=function(response,params){
this._en=new Date();
var result=new ZmCsfeResult();
var xmlResponse=false;
var restResponse=Boolean(params.restUri);
var respDoc=null;
if(!response.success&&!response.xml&&(/<html/i.test(response.text))){
var ex=new ZmCsfeException(null,ZmCsfeException.CSFE_SVC_ERROR,params.methodNameStr,"HTTP response status "+response.status);
if(params.asyncMode){
result.set(ex,true);
return result
}else{
throw ex
}}
if(typeof(response.text)=="string"&&response.text.indexOf("{")==0){
respDoc=response.text
}else{
if(!restResponse){
try{
xmlResponse=true;
if(!(response.text||(response.xml&&(typeof response.xml)=="string"))){
throw new ZmCsfeException(null,ZmCsfeException.EMPTY_RESPONSE,params.methodNameStr)
}
respDoc=(AjxEnv.isIE||response.xml==null)?AjxSoapDoc.createFromXml(response.text):AjxSoapDoc.createFromDom(response.xml)
}
catch(ex){
if(params.asyncMode){
result.set(ex,true);
return result
}else{
throw ex
}}
if(!respDoc){
var ex=new ZmCsfeException(null,ZmCsfeException.SOAP_ERROR,params.methodNameStr,"Bad XML response doc");
if(params.asyncMode){
result.set(ex,true);
return result
}else{
throw ex
}}}}
var linkName="Response";
if(respDoc&&respDoc.match){
var m=respDoc.match(/\{"?Body"?:\{"?(\w+)"?:/);
if(m&&m.length){
linkName=m[1]
}}
if(window.DBG){
var ts=DBG._getTimeStamp()
}
var obj=restResponse?response.text:{};
if(xmlResponse){
obj=respDoc._xmlDoc.toJSObject(true,false,true)
}else{
if(!restResponse){
try{
eval("obj="+respDoc)
}
catch(ex){
if(ex.name=="SyntaxError"){
ex=new ZmCsfeException(null,ZmCsfeException.BAD_JSON_RESPONSE,params.methodNameStr)
}
if(params.asyncMode){
result.set(ex,true);
return result
}else{
throw ex
}}}}
var fault=obj&&obj.Body&&obj.Body.Fault;
if(fault){
var ex=ZmCsfeCommand.faultToEx(fault,params);
if(params.asyncMode){
result.set(ex,true,obj.Header);
return result
}else{
throw ex
}}else{
if(!response.success){
var ex=new ZmCsfeException(null,ZmCsfeException.CSFE_SVC_ERROR,params.methodNameStr,"HTTP response status "+response.status);
if(params.asyncMode){
result.set(ex,true);
return result
}else{
throw ex
}}else{
if(params.asyncMode){
result.set(obj)
}}}
if(obj.Header&&obj.Header.context&&obj.Header.context.session){
ZmCsfeCommand.setSessionId(obj.Header.context.session)
}
return params.asyncMode?result:obj
};
ZmCsfeCommand.prototype._handleException=function(e,a,o){
if(!(e&&(e instanceof ZmCsfeException||e instanceof AjxSoapException||e instanceof AjxException))){
var t=new ZmCsfeException();
t.method=a.methodNameStr||a.restUri;
t.detail=e?e.toString():"undefined exception";
t.code=ZmCsfeException.UNKNOWN_ERROR;
t.msg="Unknown Error";
e=t
}
if(a.asyncMode){
o.run(new ZmCsfeResult(e,true))
}else{
throw e
}}
}
if(AjxPackage.define("zimbra.csfe.ZmCsfeException")){
ZmCsfeException=function(o){
o=Dwt.getParams(arguments,ZmCsfeException.PARAMS);
AjxException.call(this,o.msg,o.code,o.method,o.detail);
if(o.data){
this.data={};
for(var t=0;
t<o.data.length;
t++){
var a=o.data[t];
var e=a.n;
if(!this.data[e]){
this.data[e]=[]
}
this.data[e].push(a._content)
}}
this.trace=o.trace;
this.request=o.request
};
ZmCsfeException.PARAMS=["msg","code","method","detail","data","trace"];
ZmCsfeException.prototype=new AjxException;
ZmCsfeException.prototype.constructor=ZmCsfeException;
ZmCsfeException.prototype.toString=function(){
return"ZmCsfeException"
};
ZmCsfeException.MAIL_SEND_ADDRESS_FAILURE_INVALID="invalid";
ZmCsfeException.MAIL_SEND_ADDRESS_FAILURE_UNSENT="unsent";
ZmCsfeException.getErrorMsg=function(t,e){
var a=ZMsg[t];
if(!a){
ZmCsfeException._unknownFormat=ZmCsfeException._unknownFormat||new AjxMessageFormat(ZMsg.unknownError);
return ZmCsfeException._unknownFormat.format(t)
}
this.msg=this.msg||a;
return e?AjxMessageFormat.format(a,e):a
};
ZmCsfeException.prototype.getErrorMsg=function(e){
return ZmCsfeException.getErrorMsg(this.code,e)
};
ZmCsfeException.prototype.getData=function(e){
return this.data&&this.data[e]
};
ZmCsfeException.AUTH_TOKEN_CHANGED="AUTH_TOKEN_CHANGED";
ZmCsfeException.BAD_JSON_RESPONSE="BAD_JSON_RESPONSE";
ZmCsfeException.CSFE_SVC_ERROR="CSFE_SVC_ERROR";
ZmCsfeException.EMPTY_RESPONSE="EMPTY_RESPONSE";
ZmCsfeException.NETWORK_ERROR="NETWORK_ERROR";
ZmCsfeException.NO_AUTH_TOKEN="NO_AUTH_TOKEN";
ZmCsfeException.SOAP_ERROR="SOAP_ERROR";
ZmCsfeException.LICENSE_ERROR="service.LICENSE_ERROR";
ZmCsfeException.SVC_ALREADY_IN_PROGRESS="service.ALREADY_IN_PROGRESS";
ZmCsfeException.SVC_AUTH_EXPIRED="service.AUTH_EXPIRED";
ZmCsfeException.SVC_AUTH_REQUIRED="service.AUTH_REQUIRED";
ZmCsfeException.SVC_FAILURE="service.FAILURE";
ZmCsfeException.SVC_INVALID_REQUEST="service.INVALID_REQUEST";
ZmCsfeException.SVC_PARSE_ERROR="service.PARSE_ERROR";
ZmCsfeException.SVC_PERM_DENIED="service.PERM_DENIED";
ZmCsfeException.SVC_RESOURCE_UNREACHABLE="service.RESOURCE_UNREACHABLE";
ZmCsfeException.SVC_UNKNOWN_DOCUMENT="service.UNKNOWN_DOCUMENT";
ZmCsfeException.SVC_TEMPORARILY_UNAVAILABLE="service.TEMPORARILY_UNAVAILABLE";
ZmCsfeException.SVC_WRONG_HOST="service.WRONG_HOST";
ZmCsfeException.ACCT_AUTH_FAILED="account.AUTH_FAILED";
ZmCsfeException.ACCT_CHANGE_PASSWORD="account.CHANGE_PASSWORD";
ZmCsfeException.ACCT_EXISTS="account.ACCOUNT_EXISTS";
ZmCsfeException.ACCT_TOO_MANY_ACCOUNTS="account.TOO_MANY_ACCOUNTS";
ZmCsfeException.ACCT_INVALID_ATTR_VALUE="account.INVALID_ATTR_VALUE";
ZmCsfeException.ACCT_INVALID_PASSWORD="account.INVALID_PASSWORD";
ZmCsfeException.ACCT_INVALID_PREF_NAME="account.INVALID_PREF_NAME";
ZmCsfeException.ACCT_INVALID_PREF_VALUE="account.INVALID_PREF_VALUE";
ZmCsfeException.ACCT_MAINTENANCE_MODE="account.MAINTENANCE_MODE";
ZmCsfeException.ACCT_NO_SUCH_ACCOUNT="account.NO_SUCH_ACCOUNT";
ZmCsfeException.ACCT_NO_SUCH_SAVED_SEARCH="account.NO_SUCH_SAVED_SEARCH";
ZmCsfeException.ACCT_NO_SUCH_TAG="account.ACCT_NO_SUCH_TAG";
ZmCsfeException.ACCT_PASS_CHANGE_TOO_SOON="account.PASSWORD_CHANGE_TOO_SOON";
ZmCsfeException.ACCT_PASS_LOCKED="account.PASSWORD_LOCKED";
ZmCsfeException.ACCT_PASS_RECENTLY_USED="account.PASSWORD_RECENTLY_USED";
ZmCsfeException.COS_EXISTS="account.COS_EXISTS";
ZmCsfeException.DISTRIBUTION_LIST_EXISTS="account.DISTRIBUTION_LIST_EXISTS";
ZmCsfeException.DOMAIN_EXISTS="account.DOMAIN_EXISTS";
ZmCsfeException.DOMAIN_NOT_EMPTY="account.DOMAIN_NOT_EMPTY";
ZmCsfeException.IDENTITY_EXISTS="account.IDENTITY_EXISTS";
ZmCsfeException.NO_SUCH_DISTRIBUTION_LIST="account.NO_SUCH_DISTRIBUTION_LIST";
ZmCsfeException.NO_SUCH_DOMAIN="account.NO_SUCH_DOMAIN";
ZmCsfeException.MAINTENANCE_MODE="account.MAINTENANCE_MODE";
ZmCsfeException.TOO_MANY_IDENTITIES="account.TOO_MANY_IDENTITIES";
ZmCsfeException.TOO_MANY_SEARCH_RESULTS="account.TOO_MANY_SEARCH_RESULTS";
ZmCsfeException.NO_SUCH_COS="account.NO_SUCH_COS";
ZmCsfeException.MAIL_ALREADY_EXISTS="mail.ALREADY_EXISTS";
ZmCsfeException.MAIL_IMMUTABLE="mail.IMMUTABLE_OBJECT";
ZmCsfeException.MAIL_INVALID_NAME="mail.INVALID_NAME";
ZmCsfeException.MAIL_MAINTENANCE_MODE="mail.MAINTENANCE";
ZmCsfeException.MAIL_MESSAGE_TOO_BIG="mail.MESSAGE_TOO_BIG";
ZmCsfeException.MAIL_NO_SUCH_CONV="mail.NO_SUCH_CONV";
ZmCsfeException.MAIL_NO_SUCH_FOLDER="mail.NO_SUCH_FOLDER";
ZmCsfeException.MAIL_NO_SUCH_ITEM="mail.NO_SUCH_ITEM";
ZmCsfeException.MAIL_NO_SUCH_MOUNTPOINT="mail.NO_SUCH_MOUNTPOINT";
ZmCsfeException.MAIL_NO_SUCH_MSG="mail.NO_SUCH_MSG";
ZmCsfeException.MAIL_NO_SUCH_PART="mail.NO_SUCH_PART";
ZmCsfeException.MAIL_NO_SUCH_TAG="mail.NO_SUCH_TAG";
ZmCsfeException.MAIL_QUERY_PARSE_ERROR="mail.QUERY_PARSE_ERROR";
ZmCsfeException.MAIL_QUOTA_EXCEEDED="mail.QUOTA_EXCEEDED";
ZmCsfeException.MAIL_SEND_ABORTED_ADDRESS_FAILURE="mail.SEND_ABORTED_ADDRESS_FAILURE";
ZmCsfeException.MAIL_SEND_FAILURE="mail.SEND_FAILURE";
ZmCsfeException.MAIL_TOO_MANY_CONTACTS="mail.TOO_MANY_CONTACTS";
ZmCsfeException.MAIL_TOO_MANY_TERMS="mail.TOO_MANY_QUERY_TERMS_EXPANDED";
ZmCsfeException.MAIL_UNABLE_TO_IMPORT_APPOINTMENTS="mail.MAIL_UNABLE_TO_IMPORT_APPOINTMENTS";
ZmCsfeException.MAIL_UNABLE_TO_IMPORT_CONTACTS="mail.UNABLE_TO_IMPORT_CONTACTS";
ZmCsfeException.MODIFY_CONFLICT="mail.MODIFY_CONFLICT";
ZmCsfeException.TOO_MANY_TAGS="mail.TOO_MANY_TAGS";
ZmCsfeException.OFFLINE_ONLINE_ONLY_OP="offline.ONLINE_ONLY_OP";
ZmCsfeException.VOLUME_NO_SUCH_PATH="volume.NO_SUCH_PATH"
}
if(AjxPackage.define("zimbra.csfe.ZmCsfeResult")){
ZmCsfeResult=function(e,t,a){
this.set(e,t,a)
};
ZmCsfeResult.prototype.toString=function(){
return"ZmCsfeResult"
};
ZmCsfeResult.prototype.set=function(e,t,a){
this._data=e;
this._isException=(t===true);
this._header=a
};
ZmCsfeResult.prototype.getResponse=function(){
if(this._isException){
throw this._data
}else{
return this._data
}};
ZmCsfeResult.prototype.getException=function(){
return this._isException?this._data:null
};
ZmCsfeResult.prototype.isException=function(){
return this._isException
};
ZmCsfeResult.prototype.getHeader=function(){
return this._header
}
}
if(AjxPackage.define("zimbraMail.core.ZmId")){
ZmId=function(){};
ZmId.WIDGET="z";
ZmId.WIDGET_VIEW="zv";
ZmId.WIDGET_TOOLBAR="ztb";
ZmId.WIDGET_BUTTON="zb";
ZmId.WIDGET_INPUT="zi";
ZmId.WIDGET_MENU="zm";
ZmId.WIDGET_MENU_ITEM="zmi";
ZmId.WIDGET_SELECT="zs";
ZmId.WIDGET_OVERVIEW_CNTR="zovc";
ZmId.WIDGET_OVERVIEW="zov";
ZmId.WIDGET_TREE="zt";
ZmId.WIDGET_TREE_ITEM_HDR="ztih";
ZmId.WIDGET_TREE_ITEM="zti";
ZmId.WIDGET_TAB="ztab";
ZmId.SKIN_APP_BOTTOM_TOOLBAR="skin_container_app_bottom_toolbar";
ZmId.SKIN_APP_CHOOSER="skin_container_app_chooser";
ZmId.SKIN_APP_MAIN_FULL="skin_container_app_main_full";
ZmId.SKIN_APP_MAIN="skin_container_app_main";
ZmId.SKIN_APP_MAIN_ROW_FULL="skin_tr_main_full";
ZmId.SKIN_APP_MAIN_ROW="skin_tr_main";
ZmId.SKIN_APP_TOP_TOOLBAR="skin_container_app_top_toolbar";
ZmId.SKIN_LINKS="skin_container_links";
ZmId.SKIN_LOGO="skin_container_logo";
ZmId.SKIN_QUOTA_INFO="skin_container_quota";
ZmId.SKIN_SASH="skin_container_tree_app_sash";
ZmId.SKIN_SEARCH_BUILDER="skin_container_search_builder";
ZmId.SKIN_SEARCH_BUILDER_TOOLBAR="skin_container_search_builder_toolbar";
ZmId.SKIN_SEARCH_BUILDER_TR="skin_tr_search_builder";
ZmId.SKIN_SEARCH="skin_container_search";
ZmId.SKIN_SHELL="skin_outer";
ZmId.SKIN_SPACING_SEARCH="skin_spacing_search";
ZmId.SKIN_SPLASH_SCREEN="skin_container_splash_screen";
ZmId.SKIN_STATUS="skin_container_status";
ZmId.SKIN_STATUS_ROW="skin_tr_status";
ZmId.SKIN_TREE_FOOTER="skin_container_tree_footer";
ZmId.SKIN_TREE="skin_container_tree";
ZmId.SKIN_USER_INFO="skin_container_username";
ZmId.SKIN_TASKBAR="skin_container_taskbar";
ZmId.SKIN_FOOTER="skin_footer";
ZmId.SKIN_AD="skin_adsrvc";
ZmId.SHELL="z_shell";
ZmId.LOADING_VIEW="z_loading";
ZmId.MAIN_SASH="z_sash";
ZmId.BANNER="z_banner";
ZmId.SEARCH_TOOLBAR="ztb_search";
ZmId.USER_NAME="z_userName";
ZmId.USER_QUOTA="z_userQuota";
ZmId.PRESENCE="z_presence";
ZmId.TASKBAR="z_taskbar";
ZmId.NEW_FOLDER_BUTTON="zb_newFolder";
ZmId.STATUS_VIEW="z_status";
ZmId.TOAST="z_toast";
ZmId.APP_CHOOSER="ztb_appChooser";
ZmId.getToolbarId=function(t,e){
return DwtId._makeId(ZmId.WIDGET_TOOLBAR,t,e)
};
ZmId.TB_INVITE="Inv";
ZmId.TB_NAV="Nav";
ZmId.TB_SHARE="Shr";
ZmId.getButtonId=function(t,a,e){
return DwtId._makeId(ZmId.WIDGET_BUTTON,t,e,a)
};
ZmId.getMenuId=function(t,e){
return DwtId._makeId(ZmId.WIDGET_MENU,t,e)
};
ZmId.MENU_PARTICIPANT="Par";
ZmId.MENU_DRAFTS="Dra";
ZmId.getMenuItemId=function(t,a,e){
return DwtId._makeId(ZmId.WIDGET_MENU_ITEM,t,e,a)
};
ZmId.getOverviewContainerId=function(e){
return DwtId._makeId(ZmId.WIDGET_OVERVIEW_CNTR,e)
};
ZmId.getOverviewId=function(e){
return DwtId._makeId(ZmId.WIDGET_OVERVIEW,e)
};
ZmId.getTreeId=function(t,e){
return DwtId._makeId(ZmId.WIDGET_TREE,t,e)
};
ZmId.getTreeItemId=function(a,t,e){
if(!t&&!e){
return
}
if(e){
return DwtId._makeId(ZmId.WIDGET_TREE_ITEM_HDR,a,e)
}else{
return DwtId._makeId(ZmId.WIDGET_TREE_ITEM,a,t)
}};
ZmId.getViewId=function(e,t,a){
var o=DwtId._makeId(ZmId.WIDGET_VIEW,a,e);
return t?[o,t].join(""):o
};
ZmId.getComposeViewId=function(e){
var t=DwtId._makeId(ZmId.WIDGET,ZmId.COMPOSE_VIEW);
return e?[t,e].join(""):t
};
ZmId.getTabId=function(e,t){
return DwtId._makeId(ZmId.WIDGET_TAB,e,t)
};
ZmId.getPrefPageId=function(e){
return"PREF_PAGE_"+e
};
ZmId.SEARCH_INPUT="zi_search";
ZmId.SEARCH="Search";
ZmId.SEARCH_CUSTOM="CUSTOM";
ZmId.SEARCH_MENU="MENU";
ZmId.SEARCH_SEARCH="SEARCH";
ZmId.SEARCH_SAVE="SAVE";
ZmId.SEARCH_ADVANCED="ADV";
ZmId.SEARCH_LOCAL="LOCAL";
ZmId.SEARCH_ALL_ACCOUNTS="ALL_ACCOUNTS";
ZmId.SEARCH_ANY="ANY";
ZmId.SEARCH_GAL="GAL";
ZmId.SEARCH_MAIL="MAIL";
ZmId.SEARCH_SHARED="SHARED";
ZmId.APP="App";
ZmId.TREEITEM_INBOX="zti|Mail|2";
ZmId.TREEITEM_JUNK="zti|Mail|4";
ZmId.TREEITEM_SENT="zti|Mail|5";
ZmId.TREEITEM_DRAFTS="zti|Mail|6";
ZmId.TREEITEM_TRASH_MAIL="zti|Mail|3";
ZmId.TREEITEM_TRASH_CONTACTS="zti|Contacts|3";
ZmId.TREEITEM_CONTACTS="zti|Contacts|7";
ZmId.TREEITEM_CALENDAR="zti|Calendar|10";
ZmId.TREEITEM_NOTEBOOK="zti|Notebook|12";
ZmId.TREEITEM_TASKS="zti|Tasks|15";
ZmId.TREEITEM_BRIEFCASE="zti|Briefcase|16";
ZmId.MV_HDR_TABLE="_hdrTable";
ZmId.MV_HDR_TABLE_TOP_ROW="_hdrTableTopRow";
ZmId.MV_CLOSE_BTN_CELL="_closeBtnCell";
ZmId.MV_REPORT_BTN_CELL="_reportBtnCell";
ZmId.MV_EXPAND_ROW="_expandRow";
ZmId.MV_EXPAND_HDR="_expandHeader";
ZmId.MV_ATT_LINKS="_attLinks";
ZmId.MV_CONTACT_AREA="_contactArea";
ZmId.MV_HIGHLIGHT_OBJ="_highlightObjects";
ZmId.MV_DISPLAY_IMAGES="_displayImages";
ZmId.MV_MSG_TRUNC="_msgTruncation";
ZmId.MV_INFO_BAR="_infoBar";
ZmId.MV_TAG_ROW="_tagRow";
ZmId.MV_TAG_CELL="_tagCell";
ZmId.MV_MSG_BODY="_body";
ZmId.CMP_HEADER="_header";
ZmId.CMP_FROM_SELECT="_from_select";
ZmId.CMP_TO_ROW="_to_row";
ZmId.CMP_TO_PICKER="_to_picker";
ZmId.CMP_TO_INPUT="_to_control";
ZmId.CMP_CC_ROW="_cc_row";
ZmId.CMP_CC_PICKER="_cc_picker";
ZmId.CMP_CC_INPUT="_cc_control";
ZmId.CMP_BCC_ROW="_bcc_row";
ZmId.CMP_BCC_PICKER="_bcc_picker";
ZmId.CMP_BCC_INPUT="_bcc_control";
ZmId.CMP_BCC_TOGGLE="_toggle_bcc";
ZmId.CMP_OBO_CHECKBOX="_obo_checkbox";
ZmId.CMP_OBO_LABEL="_obo_label";
ZmId.CMP_OBO_ROW="_obo_row";
ZmId.CMP_SUBJECT_ROW="_subject_row";
ZmId.CMP_SUBJECT_INPUT="_subject_control";
ZmId.CMP_IDENTITY_ROW="_identity_row";
ZmId.CMP_IDENTITY_SELECT="_identity_control";
ZmId.CMP_PRIORITY="_priority";
ZmId.CMP_ATT_ROW="_attachments_row";
ZmId.CMP_ATT_DIV="_attachments_div";
ZmId.CMP_TO="TO";
ZmId.CMP_CC="CC";
ZmId.CMP_BCC="BCC";
ZmId.APP_BRIEFCASE="Briefcase";
ZmId.APP_CALENDAR="Calendar";
ZmId.APP_CONTACTS="Contacts";
ZmId.APP_IM="IM";
ZmId.APP_MAIL="Mail";
ZmId.APP_MIXED="Mixed";
ZmId.APP_NOTEBOOK="Notebook";
ZmId.APP_PORTAL="Portal";
ZmId.APP_PREFERENCES="Options";
ZmId.APP_TASKS="Tasks";
ZmId.APP_VOICE="Voice";
ZmId.VIEW_ACCOUNT="ACCT";
ZmId.VIEW_APPOINTMENT="APPT";
ZmId.VIEW_APPT_SCHEDULE="APPTS";
ZmId.VIEW_BRIEFCASE="BC";
ZmId.VIEW_BRIEFCASE_DETAIL="BCD";
ZmId.VIEW_BRIEFCASE_COLUMN="BCC";
ZmId.VIEW_BRIEFCASE_ICON="BCI";
ZmId.VIEW_CAL="CAL";
ZmId.VIEW_CAL_APPT="CLA";
ZmId.VIEW_CAL_DAY="CLD";
ZmId.VIEW_CAL_LIST="CLL";
ZmId.VIEW_CAL_MONTH="CLM";

ZmId.VIEW_CAL_SCHEDULE="CLS";
ZmId.VIEW_CAL_WEEK="CLW";
ZmId.VIEW_CAL_WORK_WEEK="CLWW";
ZmId.VIEW_CALL_LIST="CLIST";
ZmId.VIEW_COMPOSE="COMPOSE";
ZmId.VIEW_CONTACT_CARDS="CNC";
ZmId.VIEW_CONTACT_SIMPLE="CNS";
ZmId.VIEW_CONTACT_SRC="CNSRC";
ZmId.VIEW_CONTACT_TGT="CNTGT";
ZmId.VIEW_CONTACT="CN";
ZmId.VIEW_CONVLIST="CLV";
ZmId.VIEW_CONV="CV";
ZmId.VIEW_FILTER_RULES="FRV";
ZmId.VIEW_GROUP="GRP";
ZmId.VIEW_IM_CHAT_MEMBER_LIST="IMCML";
ZmId.VIEW_IM_CHAT_MULTI_WINDOW="IMCMW";
ZmId.VIEW_IM_CHAT_TAB="IMCT";
ZmId.VIEW_LOADING="LOADING";
ZmId.VIEW_MAIL_CONFIRM="MAILCONFIRM";
ZmId.VIEW_MIXED="MX";
ZmId.VIEW_MOBILE_DEVICES="MD";
ZmId.VIEW_MSG="MSG";
ZmId.VIEW_MY_CARD="MYC";
ZmId.VIEW_NOTEBOOK_FILE="NBF";
ZmId.VIEW_NOTEBOOK_PAGE_EDIT="NBPE";
ZmId.VIEW_NOTEBOOK_PAGE="NBP";
ZmId.VIEW_NOTEBOOK_PAGE_VERSION="NBPV";
ZmId.VIEW_NOTEBOOK_SITE="NBS";
ZmId.VIEW_PORTAL="PORTAL";
ZmId.VIEW_PREF="PREF";
ZmId.VIEW_SHARE_PENDING="SVP";
ZmId.VIEW_SHARE_MOUNTED="SVM";
ZmId.VIEW_SHARE_GRANTS="SVG";
ZmId.VIEW_SHORTCUTS="SHORTCUTS";
ZmId.VIEW_TASK="TKV";
ZmId.VIEW_TASK_NOT_STARTED="TKVN";
ZmId.VIEW_TASK_COMPLETED="TKVC";
ZmId.VIEW_TASK_IN_PROGRESS="TKVI";
ZmId.VIEW_TASK_WAITING="TKVW";
ZmId.VIEW_TASK_DEFERRED="TKVD";
ZmId.VIEW_TASK_ALL="TKVA";
ZmId.VIEW_TASKEDIT="TKE";
ZmId.VIEW_TASKLIST="TKL";
ZmId.VIEW_TRAD="TV";
ZmId.VIEW_VOICEMAIL="VM";
ZmId.VIEW_ATTACHMENTS="AV";
ZmId.ITEM_APPOINTMENT="APPT";
ZmId.ITEM_ATT="ATT";
ZmId.ITEM_BRIEFCASE="BRIEFCASE_ITEM";
ZmId.ITEM_CALL="CALL";
ZmId.ITEM_CHAT="CHAT";
ZmId.ITEM_CONTACT="CONTACT";
ZmId.ITEM_CONV="CONV";
ZmId.ITEM_DATA_SOURCE="DATA_SOURCE";
ZmId.ITEM_DOCUMENT="DOCUMENT";
ZmId.ITEM_GROUP="GROUP";
ZmId.ITEM_MSG="MSG";
ZmId.ITEM_PAGE="PAGE";
ZmId.ITEM_RESOURCE="RESOURCE";
ZmId.ITEM_ROSTER="ROSTER_ITEM";
ZmId.ITEM_TASK="TASK";
ZmId.ITEM_VOICEMAIL="VOICEMAIL";
ZmId.ORG_ADDRBOOK="ADDRBOOK";
ZmId.ORG_BRIEFCASE="BRIEFCASE";
ZmId.ORG_CALENDAR="CALENDAR";
ZmId.ORG_FOLDER="FOLDER";
ZmId.ORG_NOTEBOOK="NOTEBOOK";
ZmId.ORG_ROSTER_TREE_ITEM="ROSTER_TREE_ITEM";
ZmId.ORG_ROSTER_TREE_GROUP="ROSTER_TREE_GROUP";
ZmId.ORG_SEARCH="SEARCH";
ZmId.ORG_TAG="TAG";
ZmId.ORG_TASKS="TASKS";
ZmId.ORG_ZIMLET="ZIMLET";
ZmId.ORG_PREF_PAGE="PREF_PAGE";
ZmId.FLD_ACCOUNT="ac";
ZmId.FLD_ATTACHMENT="at";
ZmId.FLD_CAPACITY="cp";
ZmId.FLD_COMPANY="co";
ZmId.FLD_DATE="dt";
ZmId.FLD_EMAIL="em";
ZmId.FLD_EXPAND="ex";
ZmId.FLD_FILE_TYPE="ft";
ZmId.FLD_FLAG="fg";
ZmId.FLD_FOLDER="fo";
ZmId.FLD_FRAGMENT="fm";
ZmId.FLD_FROM="fr";
ZmId.FLD_HOME_PHONE="hp";
ZmId.FLD_ID="id";
ZmId.FLD_INDEX="ix";
ZmId.FLD_ITEM_ROW="rw";
ZmId.FLD_ITEM_ROW_3PANE="r3";
ZmId.FLD_LOCATION="lo";
ZmId.FLD_NAME="na";
ZmId.FLD_NOTES="no";
ZmId.FLD_PARTICIPANT="pa";
ZmId.FLD_PCOMPLETE="pc";
ZmId.FLD_PRIORITY="pr";
ZmId.FLD_RECURRENCE="re";
ZmId.FLD_SELECTION="se";
ZmId.FLD_SELECTION_CELL="sec";
ZmId.FLD_SIZE="sz";
ZmId.FLD_SORTED_BY="sb";
ZmId.FLD_STATUS="st";
ZmId.FLD_SUBJECT="su";
ZmId.FLD_TAG="tg";
ZmId.FLD_TAG_CELL="tc";
ZmId.FLD_TYPE="ty";
ZmId.FLD_WORK_PHONE="wp";
ZmId.OP_ADD_FILTER_RULE="ADD_FILTER_RULE";
ZmId.OP_ADD_SIGNATURE="ADD_SIGNATURE";
ZmId.OP_ATTACHMENT="ATTACHMENT";
ZmId.OP_BROWSE="BROWSE";
ZmId.OP_BROWSE_FOLDER="BROWSE_FOLDER";
ZmId.OP_CALL="CALL";
ZmId.OP_CALL_MANAGER="CALL_MANAGER";
ZmId.OP_CAL_REFRESH="CAL_REFRESH";
ZmId.OP_CAL_LIST_VIEW="CAL_LIST_VIEW";
ZmId.OP_CAL_VIEW_MENU="CAL_VIEW_MENU";
ZmId.OP_CANCEL="CANCEL";
ZmId.OP_CHECK_ALL="CHECK_ALL";
ZmId.OP_CHECK_CALLS="CHECK_CALLS";
ZmId.OP_CHECK_MAIL="CHECK_MAIL";
ZmId.OP_CHECK_VOICEMAIL="CHECK_VOICEMAIL";
ZmId.OP_CLEAR_ALL="CLEAR_ALL";
ZmId.OP_CLOSE="CLOSE";
ZmId.OP_COMPOSE_FORMAT="COMPOSE_FORMAT";
ZmId.OP_COMPOSE_OPTIONS="COMPOSE_OPTIONS";
ZmId.OP_CONTACT="CONTACT";
ZmId.OP_CREATE_APPT="CREATE_APPT";
ZmId.OP_CREATE_TASK="CREATE_TASK";
ZmId.OP_CREATE_SLIDE_SHOW="CREATE_SLIDE_SHOW";
ZmId.OP_DAY_VIEW="DAY_VIEW";
ZmId.OP_DELETE="DELETE";
ZmId.OP_DELETE_APPT_INSTANCE="DELETE_INSTANCE";
ZmId.OP_DELETE_APPT_SERIES="DELETE_SERIES";
ZmId.OP_DELETE_CONV="DELETE_CONV";
ZmId.OP_DELETE_MENU="DELETE_MENU";
ZmId.OP_DELETE_MSG="DELETE_MSG";
ZmId.OP_DETACH="DETACH";
ZmId.OP_DETACH_WIN="DETACH_WIN";
ZmId.OP_DETACH_COMPOSE="DETACH_COMPOSE";
ZmId.OP_DOWNLOAD_VOICEMAIL="DOWNLOAD_VOICEMAIL";
ZmId.OP_DRAFT="DRAFT";
ZmId.OP_EDIT="EDIT";
ZmId.OP_EDIT_CONTACT="EDIT_CONTACT";
ZmId.OP_EDIT_FILTER_RULE="EDIT_FILTER_RULE";
ZmId.OP_EDIT_NOTEBOOK_CHROME="EDIT_NOTEBOOK_CHROME";
ZmId.OP_EDIT_NOTEBOOK_CHROME="EDIT_NOTEBOOK_CHROME";
ZmId.OP_EDIT_NOTEBOOK_FOOTER="EDIT_NOTEBOOK_FOOTER";
ZmId.OP_EDIT_NOTEBOOK_HEADER="EDIT_NOTEBOOK_HEADER";
ZmId.OP_EDIT_NOTEBOOK_INDEX="EDIT_NOTEBOOK_INDEX";
ZmId.OP_EDIT_NOTEBOOK_SIDE_BAR="EDIT_NOTEBOOK_SIDE_BAR";
ZmId.OP_EDIT_PROPS="EDIT_PROPS";
ZmId.OP_EDIT_REPLY_ACCEPT="EDIT_REPLY_ACCEPT";
ZmId.OP_EDIT_REPLY_CANCEL="EDIT_REPLY_CANCEL";
ZmId.OP_EDIT_REPLY_DECLINE="EDIT_REPLY_DECLINE";
ZmId.OP_EDIT_REPLY_TENTATIVE="EDIT_REPLY_TENTATIVE";
ZmId.OP_EMPTY_FOLDER="EMPTY_FOLDER";
ZmId.OP_EXPAND="EXPAND";
ZmId.OP_EXPAND_ALL="EXPAND_ALL";
ZmId.OP_FORMAT_HTML="FORMAT_HTML";
ZmId.OP_FORMAT_HTML_SOURCE="FORMAT_HTML_SOURCE";
ZmId.OP_FORMAT_MEDIA_WIKI="FORMAT_MEDIA_WIKI";
ZmId.OP_FORMAT_RICH_TEXT="FORMAT_RICH_TEXT";
ZmId.OP_FORMAT_TEXT="FORMAT_TEXT";
ZmId.OP_FORMAT_TWIKI="FORMAT_TWIKI";
ZmId.OP_FORWARD="FORWARD";
ZmId.OP_FORWARD_ATT="FORWARD_ATT";
ZmId.OP_FORWARD_BY_EMAIL="FORWARD_BY_EMAIL";
ZmId.OP_FORWARD_INLINE="FORWARD_INLINE";
ZmId.OP_FORWARD_MENU="FORWARD_MENU";
ZmId.OP_FORWARD_APPT="FORWARD_APPT";
ZmId.OP_FORWARD_APPT_INSTANCE="FORWARD_APPT_INSTANCE";
ZmId.OP_FORWARD_APPT_SERIES="FORWARD_APPT_SERIES";
ZmId.OP_FREE_BUSY_LINK="FREE_BUSY_LINK";
ZmId.OP_GO_TO_URL="GO_TO_URL";
ZmId.OP_IM="IM";
ZmId.OP_IMPORT_FILE="IMPORT_FILE";
ZmId.OP_IM_ADD_TO_CONTACT="IM_ADD_TO_CONTACT";
ZmId.OP_IM_BLOCK_BUDDY="IM_BLOCK_BUDDY";
ZmId.OP_IM_BUDDY_ARCHIVE="IM_BUDDY_ARCHIVE";
ZmId.OP_IM_BUDDY_LIST="IM_BUDDY_LIST";
ZmId.OP_IM_CLOSE_ALL_CHATS="IM_CLOSE_ALL_CHATS";
ZmId.OP_IM_CLOSE_OTHER_CHATS="IM_CLOSE_OTHER_CHATS";
ZmId.OP_IM_CLOSE_CHAT="IM_CLOSE_CHATS";
ZmId.OP_IM_CREATE_CONTACT="IM_CREATE_CONTACT";
ZmId.OP_IM_EDIT_CONTACT="IM_EDIT_CONTACT";
ZmId.OP_IM_HTML="IM_HTML";
ZmId.OP_IM_DELETE_GROUP="IM_DELETE_GROUP";
ZmId.OP_IM_INVITE="IM_INVITE";
ZmId.OP_IM_NEW_CHAT="IM_NEW_CHAT";
ZmId.OP_IM_PRESENCE_AWAY="IM_PRESENCE_AWAY";
ZmId.OP_IM_PRESENCE_CHAT="IM_PRESENCE_CHAT";
ZmId.OP_IM_PRESENCE_CUSTOM_MSG="IM_PRESENCE_CUSTOM_MSG";
ZmId.OP_IM_PRESENCE_DND="IM_PRESENCE_DND";
ZmId.OP_IM_PRESENCE_INVISIBLE="IM_PRESENCE_INVISIBLE";
ZmId.OP_IM_PRESENCE_MENU="IM_PRESENCE_MENU";
ZmId.OP_IM_PRESENCE_OFFLINE="IM_PRESENCE_OFFLINE";
ZmId.OP_IM_PRESENCE_ONLINE="IM_PRESENCE_ONLINE";
ZmId.OP_IM_PRESENCE_XA="IM_PRESENCE_XA";
ZmId.OP_IM_LOGOUT_YAHOO="IM_LOGOUT_YAHOO";
ZmId.OP_IM_PRESENCE_CUSTOM_MRU="IM_PRESENCE_CUSTOM_MRU";
ZmId.OP_IM_PRESENCE_MENU="IM_PRESENCE_MENU";
ZmId.OP_IM_SORT_BY_NAME="IM_SORT_BY_NAME";
ZmId.OP_IM_SORT_BY_PRESENCE="IM_SORT_BY_PRESENCE";
ZmId.OP_IM_TOGGLE_BLOCKED="IM_TOGGLE_BLOCKED";
ZmId.OP_IM_TOGGLE_OFFLINE="IM_TOGGLE_OFFLINE";
ZmId.OP_IM_UNBLOCK_BUDDY="IM_UNBLOCK_BUDDY";
ZmId.OP_INC_ATTACHMENT="INC_ATTACHMENT";
ZmId.OP_INC_NONE="INC_NONE";
ZmId.OP_INC_NO_PREFIX="INC_NO_PREFIX";
ZmId.OP_INC_PREFIX="INC_PREFIX";
ZmId.OP_INC_PREFIX_FULL="INC_PREFIX_FULL";
ZmId.OP_INC_SMART="INC_SMART";
ZmId.OP_INVITE_REPLY_ACCEPT="INVITE_REPLY_ACCEPT";
ZmId.OP_INVITE_REPLY_DECLINE="INVITE_REPLY_DECLINE";
ZmId.OP_INVITE_REPLY_MENU="INVITE_REPLY_MENU";
ZmId.OP_INVITE_REPLY_TENTATIVE="INVITE_REPLY_TENTATIVE";
ZmId.OP_MARK_ALL_READ="MARK_ALL_READ";
ZmId.OP_MARK_HEARD="MARK_HEARD";
ZmId.OP_MARK_READ="MARK_READ";
ZmId.OP_MARK_UNHEARD="MARK_UNHEARD";
ZmId.OP_MARK_UNREAD="MARK_UNREAD";
ZmId.OP_MOBILE_CANCEL_WIPE="MOBILE_CANCEL_WIPE";
ZmId.OP_MOBILE_RESUME_SYNC="MOBILE_RESUME_SYNC";
ZmId.OP_MOBILE_SUSPEND_SYNC="MOBILE_SUSPEND_SYNC";
ZmId.OP_MOBILE_WIPE="MOBILE_WIPE";
ZmId.OP_MONTH_VIEW="MONTH_VIEW";
ZmId.OP_MOUNT_ADDRBOOK="MOUNT_ADDRBOOK";
ZmId.OP_MOUNT_BRIEFCASE="MOUNT_BRIEFCASE";
ZmId.OP_MOUNT_CALENDAR="MOUNT_CALENDAR";
ZmId.OP_MOUNT_FOLDER="MOUNT_FOLDER";
ZmId.OP_MOUNT_NOTEBOOK="MOUNT_NOTEBOOK";
ZmId.OP_MOUNT_TASK_FOLDER="MOUNT_TASK_FOLDER";
ZmId.OP_MOVE="MOVE";
ZmId.OP_MOVE_DOWN_FILTER_RULE="MOVE_DOWN_FILTER_RULE";
ZmId.OP_MOVE_UP_FILTER_RULE="MOVE_UP_FILTER_RULE";
ZmId.OP_NEW_ADDRBOOK="NEW_ADDRBOOK";
ZmId.OP_NEW_ALLDAY_APPT="NEW_ALLDAY_APPT";
ZmId.OP_NEW_APPT="NEW_APPT";
ZmId.OP_NEW_BRIEFCASEITEM="NEW_BRIEFCASEITEM";
ZmId.OP_NEW_CALENDAR="NEW_CALENDAR";
ZmId.OP_NEW_CONTACT="NEW_CONTACT";
ZmId.OP_NEW_DOC="NEW_DOC";
ZmId.OP_NEW_FILE="NEW_FILE";
ZmId.OP_NEW_FOLDER="NEW_FOLDER";
ZmId.OP_NEW_GROUP="NEW_GROUP";
ZmId.OP_NEW_MENU="NEW_MENU";
ZmId.OP_NEW_MESSAGE="NEW_MESSAGE";
ZmId.OP_NEW_MESSAGE_WIN="NEW_MESSAGE_WIN";
ZmId.OP_NEW_NOTEBOOK="NEW_NOTEBOOK";
ZmId.OP_NEW_PAGE="NEW_PAGE";
ZmId.OP_NEW_PRESENTATION="NEW_PRESENTATION";
ZmId.OP_NEW_ROSTER_GROUP="NEW_ROSTER_GROUP";
ZmId.OP_NEW_ROSTER_ITEM="NEW_ROSTER_ITEM";
ZmId.OP_NEW_SPREADSHEET="NEW_SPREADSHEET";
ZmId.OP_NEW_TAG="NEW_TAG";
ZmId.OP_NEW_TASK="NEW_TASK";
ZmId.OP_NOTIFY="NOTIFY";
ZmId.OP_NEW_TASK_FOLDER="NEW_TASK_FOLDER";
ZmId.OP_OPEN_APPT_INSTANCE="OPEN_APPT_INSTANCE";
ZmId.OP_OPEN_APPT_SERIES="OPEN_APPT_SERIES";
ZmId.OP_OPEN_FILE="OPEN_FILE";
ZmId.OP_PAGE_BACK="PAGE_BACK";
ZmId.OP_PAGE_FORWARD="PAGE_FORWARD";
ZmId.OP_PAUSE_TOGGLE="PAUSE_TOGGLE";
ZmId.OP_PRINT="PRINT";
ZmId.OP_PRINT_ADDRBOOK="PRINT_ADDRBOOK";
ZmId.OP_PRINT_CONTACT="PRINT_CONTACT";
ZmId.OP_REFRESH="REFRESH";
ZmId.OP_REMOVE_FILTER_RULE="REMOVE_FILTER_RULE";
ZmId.OP_RENAME_FOLDER="RENAME_FOLDER";
ZmId.OP_RENAME_SEARCH="RENAME_SEARCH";
ZmId.OP_RENAME_TAG="RENAME_TAG";
ZmId.OP_REPLY="REPLY";
ZmId.OP_REPLY_ACCEPT="REPLY_ACCEPT";
ZmId.OP_REPLY_ACCEPT_IGNORE="REPLY_ACCEPT_IGNORE";
ZmId.OP_REPLY_ACCEPT_NOTIFY="REPLY_ACCEPT_NOTIFY";
ZmId.OP_REPLY_ALL="REPLY_ALL";
ZmId.OP_REPLY_BY_EMAIL="REPLY_BY_EMAIL";
ZmId.OP_REPLY_CANCEL="REPLY_CANCEL";
ZmId.OP_REPLY_CANCEL="REPLY_CANCEL";
ZmId.OP_REPLY_DECLINE="REPLY_DECLINE";
ZmId.OP_REPLY_DECLINE_IGNORE="REPLY_DECLINE_IGNORE";
ZmId.OP_REPLY_DECLINE_NOTIFY="REPLY_DECLINE_NOTIFY";
ZmId.OP_REPLY_MENU="REPLY_MENU";
ZmId.OP_REPLY_MODIFY="REPLY_MODIFY";
ZmId.OP_REPLY_MODIFY="REPLY_MODIFY";
ZmId.OP_REPLY_NEW_TIME="REPLY_NEW_TIME";
ZmId.OP_REPLY_NEW_TIME="REPLY_NEW_TIME";
ZmId.OP_REPLY_TENTATIVE="REPLY_TENTATIVE";
ZmId.OP_REPLY_TENTATIVE_IGNORE="REPLY_TENTATIVE_IGNORE";
ZmId.OP_REPLY_TENTATIVE_NOTIFY="REPLY_TENTATIVE_NOTIFY";
ZmId.OP_REPORT="REPORT";
ZmId.OP_REQUEST_READ_RECEIPT="REQUEST_READ_RECEIPT";
ZmId.OP_RESET="RESET";
ZmId.OP_REVERT_PAGE="REVERT_PAGE";
ZmId.OP_RUN_FILTER_RULE="RUN_FILTER_RULE";
ZmId.OP_SAVE="SAVE";
ZmId.OP_SAVE_DRAFT="SAVE_DRAFT";
ZmId.OP_SAVE_FILE="SAVE_FILE";
ZmId.OP_SCHEDULE_VIEW="SCHEDULE_VIEW";
ZmId.OP_SEARCH="SEARCH";
ZmId.OP_SEARCH_MAIL="SEARCH_MAIL";
ZmId.OP_SEND="SEND";
ZmId.OP_SEND_FILE="SEND_FILE";
ZmId.OP_SEND_FILE_AS_ATT="SEND_FILE_AS_ATT";
ZmId.OP_SEND_FILE_MENU="SEND_FILE_MENU";
ZmId.OP_SEND_PAGE="SEND_PAGE";
ZmId.OP_SHARE="SHARE";
ZmId.OP_SHARE_ACCEPT="SHARE_ACCEPT";
ZmId.OP_SHARE_ADDRBOOK="SHARE_ADDRBOOK";
ZmId.OP_SHARE_BRIEFCASE="SHARE_BRIEFCASE";
ZmId.OP_SHARE_CALENDAR="SHARE_CALENDAR";
ZmId.OP_SHARE_DECLINE="SHARE_DECLINE";
ZmId.OP_SHARE_FOLDER="SHARE_FOLDER";
ZmId.OP_SHARE_NOTEBOOK="SHARE_NOTEBOOK";
ZmId.OP_SHARE_TASKFOLDER="SHARE_TASKFOLDER";
ZmId.OP_SHOW_ALL_ITEM_TYPES="SHOW_ALL_ITEM_TYPES";
ZmId.OP_SHOW_BCC="SHOW_BCC";
ZmId.OP_SHOW_ONLY_CONTACTS="SHOW_ONLY_CONTACTS";
ZmId.OP_SHOW_ONLY_MAIL="SHOW_ONLY_MAIL";
ZmId.OP_SHOW_ORIG="SHOW_ORIG";
ZmId.OP_SPAM="SPAM";
ZmId.OP_SPELL_CHECK="SPELL_CHECK";
ZmId.OP_SYNC="SYNC";
ZmId.OP_SYNC_OFFLINE_FOLDER="SYNC_OFFLINE_FOLDER";
ZmId.OP_TAG="TAG";
ZmId.OP_TAG_COLOR_MENU="TAG_COLOR_MENU";
ZmId.OP_TAG_MENU="TAG_MENU";
ZmId.OP_PRINT_TASK="PRINT_TASK";
ZmId.OP_PRINT_TASKFOLDER="PRINT_TASKFOLDER";
ZmId.OP_TEXT="TEXT";
ZmId.OP_TODAY="TODAY";
ZmId.OP_UNDELETE="UNDELETE";
ZmId.OP_VIEW="VIEW";
ZmId.OP_VIEW_APPOINTMENT="VIEW_APPOINTMENT";
ZmId.OP_VIEW_APPT_INSTANCE="VIEW_APPT_INSTANCE";
ZmId.OP_VIEW_APPT_SERIES="VIEW_APPT_SERIES";
ZmId.OP_VIEW_BY_DATE="VIEW_BY_DATE";
ZmId.OP_VIEW_FILE_AS_HTML="VIEW_FILE_AS_HTML";
ZmId.OP_VIEW_MENU="VIEW_MENU";
ZmId.OP_WEEK_VIEW="WEEK_VIEW";
ZmId.OP_WORK_WEEK_VIEW="WORK_WEEK_VIEW";
ZmId.OP_ZIMLET="ZIMLET";
ZmId.OP_SYNC_ALL="SYNC_ALL"
}
if(AjxPackage.define("zimbraMail.share.model.events.ZmEvent")){
ZmEvent=function(e){
this.type=e;
this.event=null;
this.source=null;
this.item=null;
this._details={}
};
ZmEvent.L_MODIFY=1;
ZmEvent.L_PICKER=2;
ZmEvent.S_TAG="TAG";
ZmEvent.S_PICKER="PICKER";
ZmEvent.S_SEARCH="SEARCH";
ZmEvent.S_SETTING="SETTING";
ZmEvent.S_SETTINGS="SETTINGS";
ZmEvent.S_MOUNTPOINT="MOUNTPOINT";
ZmEvent.S_ZIMLET="ZIMLET";
ZmEvent.E_CREATE="CREATE";
ZmEvent.E_DELETE="DELETE";
ZmEvent.E_MODIFY="MODIFY";
ZmEvent.E_LOAD="LOAD";
ZmEvent.E_REMOVE="REMOVE";
ZmEvent.E_REMOVE_ALL="REMOVE ALL";
ZmEvent.E_MOVE="MOVE";
ZmEvent.E_FLAGS="FLAGS";
ZmEvent.E_TAGS="TAGS";
ZmEvent.E_ZIMLETS="ZIMLET";
ZmEvent.prototype.toString=function(){
return"ZmEvent"
};
ZmEvent.prototype.set=function(e,t){
this.event=e;
this.source=t;
this.handled=false
};
ZmEvent.prototype.setDetail=function(t,e){
this._details[t]=e
};
ZmEvent.prototype.getDetail=function(e){
return this._details[e]
};
ZmEvent.prototype.getItems=function(){
var e=this._details.items;
return e?e:[]
};
ZmEvent.prototype.setDetails=function(e){
this._details=e?e:{}
};
ZmEvent.prototype.getDetails=function(){
return this._details
}
}
if(AjxPackage.define("zimbraMail.share.model.events.ZmAppEvent")){
ZmAppEvent=function(e){
ZmEvent.call(this)
};
ZmAppEvent.prototype=new ZmEvent;
ZmAppEvent.prototype.constructor=ZmAppEvent;
ZmAppEvent.PRE_STARTUP="PRESTARTUP";
ZmAppEvent.POST_STARTUP="POSTSTARTUP";
ZmAppEvent.PRE_LAUNCH="PRELAUNCH";
ZmAppEvent.POST_LAUNCH="POSTLAUNCH";
ZmAppEvent.POST_RENDER="POSTRENDER";
ZmAppEvent.ACTIVATE="ACTIVATE";
ZmAppEvent.prototype.toString=function(){
return"ZmAppEvent"
}
}
if(AjxPackage.define("zimbraMail.share.model.ZmModel")){
ZmModel=function(e){
if(arguments.length==0){
return
}
this._evt=new ZmEvent(e);
this._evtMgr=new AjxEventMgr()
};
ZmModel.prototype.toString=function(){
return"ZmModel"
};
ZmModel.prototype.addChangeListener=function(e){
return this._evtMgr.addListener(ZmEvent.L_MODIFY,e)
};
ZmModel.prototype.removeChangeListener=function(e){
return this._evtMgr.removeListener(ZmEvent.L_MODIFY,e)
};
ZmModel.prototype.removeAllChangeListeners=function(){
return this._evtMgr.removeAll(ZmEvent.L_MODIFY)
};
ZmModel.prototype._notify=function(t,e){
if(this._evtMgr.isListenerRegistered(ZmEvent.L_MODIFY)){
this._evt.set(t,this);
this._evt.setDetails(e);
this._evtMgr.notifyListeners(ZmEvent.L_MODIFY,this._evt)
}};
ZmModel.notifyEach=function(o,a,t){
if(!(o&&o.length)){
return
}
for(var e=0;
e<o.length;
e++){
o[e]._notify(a,t)
}}
}
if(AjxPackage.define("zimbraMail.share.model.ZmSetting")){
ZmSetting=function(t,e){
if(arguments.length==0){
return
}
ZmModel.call(this,ZmEvent.S_SETTING);
this.id=t;
this.name=e.name;
this.type=e.type;
this.dataType=e.dataType||ZmSetting.D_STRING;
this.defaultValue=e.defaultValue;
if(this.type==ZmSetting.T_METADATA){
this.section=e.section
}
if(e.isGlobal){
ZmSetting.IS_GLOBAL[t]=true
}
if(e.isImplicit){
ZmSetting.IS_IMPLICIT[t]=true
}
if(this.dataType==ZmSetting.D_HASH){
this.value={};
this.defaultValue={}
}else{
if(this.dataType==ZmSetting.D_LIST){
this.value=[];
this.defaultValue=[]
}else{
this.value=null
}}};
ZmSetting.prototype=new ZmModel;
ZmSetting.prototype.constructor=ZmSetting;
ZmSetting.T_CONFIG="config";
ZmSetting.T_COS="cos";
ZmSetting.T_METADATA="meta";
ZmSetting.T_PREF="pref";
ZmSetting.T_PSEUDO="pseudo";
ZmSetting.M_IMPLICIT="implicit";
ZmSetting.M_OFFLINE="offline";
ZmSetting.D_STRING="string";
ZmSetting.D_INT="int";
ZmSetting.D_BOOLEAN="boolean";
ZmSetting.D_LDAP_TIME="ldap_time";
ZmSetting.D_HASH="hash";
ZmSetting.D_LIST="list";
ZmSetting.D_NONE="NONE";
ZmSetting.ACL_AUTH="all";
ZmSetting.ACL_GROUP="grp";
ZmSetting.ACL_NONE="none";
ZmSetting.ACL_PUBLIC="pub";
ZmSetting.ACL_USER="usr";
ZmSetting.CAL_DAY="day";
ZmSetting.CAL_LIST="list";
ZmSetting.CAL_MONTH="month";
ZmSetting.CAL_WEEK="week";
ZmSetting.CAL_WORK_WEEK="workWeek";
ZmSetting.CAL_SCHEDULE="schedule";
ZmSetting.CAL_VISIBILITY_PRIV="private";
ZmSetting.CAL_VISIBILITY_PUB="public";
ZmSetting.CLIENT_ADVANCED="advanced";
ZmSetting.CLIENT_STANDARD="standard";
ZmSetting.COMPOSE_FONT_COLOR="#000000";
ZmSetting.COMPOSE_FONT_FAM="Times New Roman";
ZmSetting.COMPOSE_FONT_SIZE=AjxMessageFormat.format(ZmMsg.pt,"12");
ZmSetting.COMPOSE_TEXT="text";
ZmSetting.COMPOSE_HTML="html";
ZmSetting.CV_CARDS="cards";
ZmSetting.CV_LIST="list";
ZmSetting.DEDUPE_NONE="dedupeNone";
ZmSetting.DEDUPE_SECOND="secondCopyifOnToOrCC";
ZmSetting.DEDUPE_INBOX="moveSentMessageToInbox";
ZmSetting.DEDUPE_ALL="dedupeAll";
ZmSetting.DELETE_SELECT_NEXT="next";
ZmSetting.DELETE_SELECT_PREV="previous";
ZmSetting.DELETE_SELECT_ADAPT="adaptive";
ZmSetting.GETMAIL_ACTION_DEFAULT="default";
ZmSetting.GETMAIL_ACTION_UPDATE="update";
ZmSetting.GROUP_BY_CONV="conversation";
ZmSetting.GROUP_BY_MESSAGE="message";
ZmSetting.HTTP_DEFAULT_PORT=80;
ZmSetting.HTTPS_DEFAULT_PORT=443;
ZmSetting.INCLUDE_NONE="includeNone";
ZmSetting.INCLUDE="includeBody";
ZmSetting.INCLUDE_PREFIX="includeBodyWithPrefix";
ZmSetting.INCLUDE_PREFIX_FULL="includeBodyAndHeadersWithPrefix";
ZmSetting.INCLUDE_ATTACH="includeAsAttachment";
ZmSetting.INCLUDE_SMART="includeSmart";
ZmSetting.LICENSE_BAD="bad";
ZmSetting.LICENSE_GOOD="good";
ZmSetting.LICENSE_GRACE="inGracePeriod";
ZmSetting.MARK_READ_NONE=-1;
ZmSetting.MARK_READ_NOW=0;
ZmSetting.MARK_READ_TIME=1;
ZmSetting.PROTO_HTTP="http:";
ZmSetting.PROTO_HTTPS="https:";
ZmSetting.PROTO_MIXED="mixed:";
ZmSetting.RIGHT_VIEW_FREE_BUSY="viewFreeBusy";
ZmSetting.RIGHT_INVITE="invite";
ZmSetting.RP_BOTTOM="bottom";
ZmSetting.RP_OFF="off";
ZmSetting.RP_RIGHT="right";
ZmSetting.SIG_INTERNET="internet";
ZmSetting.SIG_OUTLOOK="outlook";
ZmSetting.LOCALE_NAME="LOCALE_NAME";
ZmSetting.SKIN_NAME="SKIN_NAME";
ZmSetting.BRIEFCASE_ENABLED="BRIEFCASE_ENABLED";
ZmSetting.CALENDAR_ENABLED="CALENDAR_ENABLED";
ZmSetting.CONTACTS_ENABLED="CONTACTS_ENABLED";
ZmSetting.IM_ENABLED="IM_ENABLED";
ZmSetting.MAIL_ENABLED="MAIL_ENABLED";
ZmSetting.MIXED_VIEW_ENABLED="MIXED_VIEW_ENABLED";
ZmSetting.NOTEBOOK_ENABLED="NOTEBOOK_ENABLED";
ZmSetting.OPTIONS_ENABLED="OPTIONS_ENABLED";
ZmSetting.PORTAL_ENABLED="PORTAL_ENABLED";
ZmSetting.TASKS_ENABLED="TASKS_ENABLED";
ZmSetting.VOICE_ENABLED="VOICE_ENABLED";
ZmSetting.CALENDAR_UPSELL_ENABLED="CALENDAR_UPSELL_ENABLED";
ZmSetting.CONTACTS_UPSELL_ENABLED="CONTACTS_UPSELL_ENABLED";
ZmSetting.MAIL_UPSELL_ENABLED="MAIL_UPSELL_ENABLED";
ZmSetting.VOICE_UPSELL_ENABLED="VOICE_UPSELL_ENABLED";
ZmSetting.APPS_COOKIE="ZM_APPS";
ZmSetting.APP_LETTER={};
ZmSetting.APP_LETTER[ZmSetting.PORTAL_ENABLED]="p";
ZmSetting.APP_LETTER[ZmSetting.MAIL_ENABLED]="m";
ZmSetting.APP_LETTER[ZmSetting.CALENDAR_ENABLED]="c";
ZmSetting.APP_LETTER[ZmSetting.CONTACTS_ENABLED]="a";
ZmSetting.APP_LETTER[ZmSetting.OPTIONS_ENABLED]="o";
ZmSetting.APP_LETTER[ZmSetting.IM_ENABLED]="i";
ZmSetting.APP_LETTER[ZmSetting.NOTEBOOK_ENABLED]="n";
ZmSetting.APP_LETTER[ZmSetting.BRIEFCASE_ENABLED]="b";
ZmSetting.APP_LETTER[ZmSetting.TASKS_ENABLED]="t";
ZmSetting.APP_LETTER[ZmSetting.MIXED_VIEW_ENABLED]="x";
ZmSetting.APP_LETTER[ZmSetting.VOICE_ENABLED]="v";
ZmSetting.IS_GLOBAL={};
ZmSetting.IS_IMPLICIT={};
ZmSetting.CHANGED_IMPLICIT={};
ZmSetting.prototype.toString=function(){
return this.name+": "+this.value
};
ZmSetting.prototype.getValue=function(t,a){
var s=null;
if(this.value!=null){
s=t?this.value[t]:this.value
}else{
if(this.defaultValue!=null){
s=t?this.defaultValue[t]:this.defaultValue
}else{
return null
}}
if(a){
if(this.dataType==ZmSetting.D_BOOLEAN){
s=s?"TRUE":"FALSE"
}else{
if(this.dataType==ZmSetting.D_HASH){
var o=[];
for(var t in s){
o.push(t)
}
o.sort();
var n=[];
for(var e=0;
e<o.length;
e++){
var t=o[e];
n.push([t,s[t]].join(":"))
}
s=n.join(",")
}else{
if(this.dataType==ZmSetting.D_LIST){
s=s.join(",")
}}}}
return s
};
ZmSetting.prototype.getDefaultValue=function(e){
return e?this.defaultValue[e]:this.defaultValue
};
ZmSetting.prototype.setValue=function(s,r,n,o,c){
var e=s;
var t=Boolean(e!=this.value);
if(this.dataType==ZmSetting.D_STRING){
this.value=e
}else{
if(this.dataType==ZmSetting.D_INT){
e=parseInt(s);
if(isNaN(e)){
e=s
}
t=Boolean(e!=this.value);
this.value=e
}else{
if(this.dataType==ZmSetting.D_BOOLEAN){
if(typeof(e)=="string"){
e=(e.toLowerCase()==="true")
}
t=Boolean(e!=this.value);
this.value=e
}else{
if(this.dataType==ZmSetting.D_LDAP_TIME){
var h=(e.toLowerCase)?h=(e.toLowerCase()).charAt(e.length-1):null;
var a=parseInt(e);
if(h=="d"){
e=a*24*60*60
}else{
if(h=="h"){
e=a*60*60
}else{
if(h=="m"){
e=a*60
}else{
e=a
}}}
t=Boolean(e!=this.value);
this.value=e
}else{
if(this.dataType==ZmSetting.D_HASH){
if(r){
if(e){
this.value[r]=e
}else{
delete this.value[r]
}}else{
this.value=e
}
t=true
}else{
if(this.dataType==ZmSetting.D_LIST){
if(e instanceof Array){
this.value=e
}else{
this.value.push(e)
}
t=true
}}}}}}
if(n){
if(r){
this.defaultValue[r]=this.value[r]
}else{
this.defaultValue=this.value
}}
if(ZmSetting.IS_IMPLICIT[this.id]&&t&&!c){
ZmSetting.CHANGED_IMPLICIT[this.id]=true
}
if(!this.name&&!o){
this._notify(ZmEvent.E_MODIFY,r)
}};
ZmSetting.prototype.notifyModify=function(e){
if(this.id==ZmSetting.QUOTA_USED&&e._name=="mbx"&&e.s!=null){
this.setValue(e.s);
this._notify(ZmEvent.E_MODIFY)
}}
}
if(AjxPackage.define("zimbraMail.core.ZmAppCtxt")){
ZmAppCtxt=function(){
this._trees={};
this.accountList=new ZmAccountList();
this.accountList.add(new ZmZimbraAccount(ZmAccountList.DEFAULT_ID,null,false));
this.inStartup=false;
this.currentRequestParams=null;
this.rememberMe=null;
this.userDomain="";
this.isFamilyMbox=false;
this.multiAccounts=false;
this._evtMgr=new AjxEventMgr();
this._itemCache={};
this._itemCacheDeferred={}
};
ZmAppCtxt._ZIMLETS_EVENT="ZIMLETS";
ZmAppCtxt.prototype.toString=function(){
return"ZmAppCtxt"
};
ZmAppCtxt.prototype.setAppController=function(e){
this._appController=e
};
ZmAppCtxt.prototype.getAppController=function(){
return this._appController
};
ZmAppCtxt.prototype.getAppChooser=function(){
return this._appController.getAppChooser()
};
ZmAppCtxt.prototype.setRequestMgr=function(e){
this._requestMgr=e
};
ZmAppCtxt.prototype.getRequestMgr=function(){
return this._requestMgr
};
ZmAppCtxt.prototype.setStatusMsg=function(e){
e=Dwt.getParams(arguments,ZmStatusView.MSG_PARAMS);
this._appController.setStatusMsg(e)
};
ZmAppCtxt.prototype.getSettings=function(e){
var t=this.accountList;
var o=e?e.id:t.activeAccount?t.activeAccount.id:ZmAccountList.DEFAULT_ID;
var a=t.getAccount(o);
return a&&a.settings
};
ZmAppCtxt.prototype.setSettings=function(e,t){
var a=this.accountList;
var n=t?t.id:a.activeAccount?a.activeAccount.id:ZmAccountList.DEFAULT_ID;
var o=a.getAccount(n);
if(o){
o.settings=e
}};
ZmAppCtxt.prototype.getMetaData=function(){
if(!this._metaData){
this._metaData=new ZmMetaData()
}
return this._metaData
};
ZmAppCtxt.prototype.get=function(o,e,t){
var a=(this.isOffline&&ZmSetting.IS_GLOBAL[o])?this.accountList.mainAccount:t;
return this.getSettings(a).get(o,e)
};
ZmAppCtxt.prototype.set=function(h,s,t,o,e,n){
var r=(this.isOffline&&ZmSetting.IS_GLOBAL[h])?this.accountList.mainAccount:n;
var a=this.getSettings(r).getSetting(h);
if(a){
a.setValue(s,t,o,e)
}};
ZmAppCtxt.prototype.getApp=function(e){
return this._appController.getApp(e)
};
ZmAppCtxt.prototype.getCurrentAppName=function(){
var e=this.isChildWindow?parentAppCtxt:this;
return e._appController.getActiveApp()
};
ZmAppCtxt.prototype.getCurrentApp=function(){
return this.getApp(this.getCurrentAppName())
};
ZmAppCtxt.prototype.getAppViewMgr=function(){
return this._appController.getAppViewMgr()
};
ZmAppCtxt.prototype.getClientCmdHandler=function(e){
if(!this._clientCmdHandler){
AjxDispatcher.require("Extras");
this._clientCmdHandler=new ZmClientCmdHandler()
}
return this._clientCmdHandler
};
ZmAppCtxt.prototype.getSearchController=function(){
if(!this._searchController){
this._searchController=new ZmSearchController(this._shell)
}
return this._searchController
};
ZmAppCtxt.prototype.getOverviewController=function(){
if(!this._overviewController){
this._overviewController=new ZmOverviewController(this._shell)
}
return this._overviewController
};
ZmAppCtxt.prototype.getImportExportController=function(){
if(!this._importExportController){
AjxDispatcher.require("ImportExport");
this._importExportController=new ZmImportExportController()
}
return this._importExportController
};
ZmAppCtxt.prototype.getLoginDialog=function(){
if(!this._loginDialog){
this._loginDialog=new ZmLoginDialog(this._shell)
}
return this._loginDialog
};
ZmAppCtxt.prototype.getMsgDialog=function(){
if(!this._msgDialog){
this._msgDialog=new DwtMessageDialog({
parent:this._shell}
)
}
return this._msgDialog
};
ZmAppCtxt.prototype.getYesNoMsgDialog=function(){
if(!this._yesNoMsgDialog){
this._yesNoMsgDialog=new DwtMessageDialog({
parent:this._shell,buttons:[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON]}
)
}
return this._yesNoMsgDialog
};
ZmAppCtxt.prototype.getYesNoCancelMsgDialog=function(){
if(!this._yesNoCancelMsgDialog){
this._yesNoCancelMsgDialog=new DwtMessageDialog({
parent:this._shell,buttons:[DwtDialog.YES_BUTTON,DwtDialog.NO_BUTTON,DwtDialog.CANCEL_BUTTON]}
)
}
return this._yesNoCancelMsgDialog
};
ZmAppCtxt.prototype.getOkCancelMsgDialog=function(){
if(!this._okCancelMsgDialog){
this._okCancelMsgDialog=new DwtMessageDialog({
parent:this._shell,buttons:[DwtDialog.OK_BUTTON,DwtDialog.CANCEL_BUTTON]}
)
}
return this._okCancelMsgDialog
};
ZmAppCtxt.prototype.getCancelMsgDialog=function(){
if(!this._cancelMsgDialog){
this._cancelMsgDialog=new DwtMessageDialog({
parent:this._shell,buttons:[DwtDialog.CANCEL_BUTTON]}
)
}
return this._cancelMsgDialog
};
ZmAppCtxt.prototype.getErrorDialog=function(){
if(!this._errorDialog){
AjxDispatcher.require("Startup2");
this._errorDialog=new ZmErrorDialog(this._shell,ZmMsg)
}
return this._errorDialog
};
ZmAppCtxt.prototype.getNewTagDialog=function(){
if(!this._newTagDialog){
this._newTagDialog=new ZmNewTagDialog(this._shell)
}
return this._newTagDialog
};
ZmAppCtxt.prototype.getRenameTagDialog=function(){
if(!this._renameTagDialog){
AjxDispatcher.require("Extras");
this._renameTagDialog=new ZmRenameTagDialog(this._shell)
}
return this._renameTagDialog
};
ZmAppCtxt.prototype.getNewFolderDialog=function(){
if(!this._newFolderDialog){
this._newFolderDialog=new ZmNewFolderDialog(this._shell)
}
return this._newFolderDialog
};
ZmAppCtxt.prototype.getNewAddrBookDialog=function(){
if(!this._newAddrBookDialog){
AjxDispatcher.require("Contacts");
this._newAddrBookDialog=new ZmNewAddrBookDialog(this._shell)
}
return this._newAddrBookDialog
};
ZmAppCtxt.prototype.getNewCalendarDialog=function(){
if(!this._newCalendarDialog){
AjxDispatcher.require(["CalendarCore","Calendar","CalendarAppt"]);
this._newCalendarDialog=new ZmNewCalendarDialog(this._shell)
}
return this._newCalendarDialog
};
ZmAppCtxt.prototype.getNewNotebookDialog=function(){
if(!this._newNotebookDialog){
AjxDispatcher.require(["NotebookCore","Notebook"]);
this._newNotebookDialog=new ZmNewNotebookDialog(this._shell)
}
return this._newNotebookDialog
};
ZmAppCtxt.prototype.getNewTaskFolderDialog=function(){
if(!this._newTaskFolderDialog){
AjxDispatcher.require(["TasksCore","Tasks"]);
this._newTaskFolderDialog=new ZmNewTaskFolderDialog(this._shell)
}
return this._newTaskFolderDialog
};
ZmAppCtxt.prototype.getPageConflictDialog=function(){
if(!this._pageConflictDialog){
AjxDispatcher.require(["NotebookCore","Notebook"]);
this._pageConflictDialog=new ZmPageConflictDialog(this._shell)
}
return this._pageConflictDialog
};
ZmAppCtxt.prototype.getDialog=function(){
if(!this._dialog){
this._dialog=new DwtDialog({
parent:this._shell}
)
}
return this._dialog
};
ZmAppCtxt.prototype.getNewSearchDialog=function(){
if(!this._newSearchDialog){
this._newSearchDialog=new ZmNewSearchDialog(this._shell)
}
return this._newSearchDialog
};
ZmAppCtxt.prototype.getRenameFolderDialog=function(){
if(!this._renameFolderDialog){
AjxDispatcher.require("Extras");
this._renameFolderDialog=new ZmRenameFolderDialog(this._shell)
}
return this._renameFolderDialog
};
ZmAppCtxt.prototype.getChooseFolderDialog=function(){
if(!this._chooseFolderDialog){
AjxDispatcher.require("Extras");
this._chooseFolderDialog=new ZmChooseFolderDialog(this._shell)
}
return this._chooseFolderDialog
};
ZmAppCtxt.prototype.getPickTagDialog=function(){
if(!this._pickTagDialog){
AjxDispatcher.require("Extras");
this._pickTagDialog=new ZmPickTagDialog(this._shell)
}
return this._pickTagDialog
};
ZmAppCtxt.prototype.getFolderNotifyDialog=function(){
if(!this._folderNotifyDialog){
this._folderNotifyDialog=new ZmFolderNotifyDialog(this._shell)
}
return this._folderNotifyDialog
};
ZmAppCtxt.prototype.getFolderPropsDialog=function(){
if(!this._folderPropsDialog){
this._folderPropsDialog=new ZmFolderPropsDialog(this._shell)
}
return this._folderPropsDialog
};
ZmAppCtxt.prototype.getLinkPropsDialog=function(){
if(!this._linkPropsDialog){
AjxDispatcher.require("Share");
this._linkPropsDialog=new ZmLinkPropsDialog(this._shell)
}
return this._linkPropsDialog
};
ZmAppCtxt.prototype.getSharePropsDialog=function(){
if(!this._sharePropsDialog){
AjxDispatcher.require("Share");
this._sharePropsDialog=new ZmSharePropsDialog(this._shell)
}
return this._sharePropsDialog
};
ZmAppCtxt.prototype.getAcceptShareDialog=function(){
if(!this._acceptShareDialog){
AjxDispatcher.require("Share");
this._acceptShareDialog=new ZmAcceptShareDialog(this._shell)
}
return this._acceptShareDialog
};
ZmAppCtxt.prototype.getDeclineShareDialog=function(){
if(!this._declineShareDialog){
AjxDispatcher.require("Share");
this._declineShareDialog=new ZmDeclineShareDialog(this._shell)
}
return this._declineShareDialog
};
ZmAppCtxt.prototype.getRevokeShareDialog=function(){
if(!this._revokeShareDialog){
AjxDispatcher.require("Share");
this._revokeShareDialog=new ZmRevokeShareDialog(this._shell)
}
return this._revokeShareDialog
};
ZmAppCtxt.prototype.getMountFolderDialog=function(){
if(!this._mountFolderDialog){
AjxDispatcher.require("Share");
this._mountFolderDialog=new ZmMountFolderDialog(this._shell)
}
return this._mountFolderDialog
};
ZmAppCtxt.prototype.getTimezonePickerDialog=function(){
if(!this._timezonePickerDialog){
AjxDispatcher.require("Share");
this._timezonePickerDialog=new ZmTimezonePicker(this._shell)
}
return this._timezonePickerDialog
};
ZmAppCtxt.prototype.getFilterRuleDialog=function(){
if(!this._filterRuleDialog){
AjxDispatcher.require(["PreferencesCore","Preferences"]);
this._filterRuleDialog=new ZmFilterRuleDialog()
}
return this._filterRuleDialog
};
ZmAppCtxt.prototype.getConfirmationDialog=function(){
if(!this._confirmDialog){
this._confirmDialog=new DwtConfirmDialog(this._shell)
}
return this._confirmDialog
};
ZmAppCtxt.prototype.getUploadDialog=function(){
if(!this._uploadDialog){
AjxDispatcher.require(["NotebookCore","Notebook"]);
this._uploadDialog=new ZmUploadDialog(this._shell)
}
return this._uploadDialog
};
ZmAppCtxt.prototype.getImportDialog=function(){
if(!this._importDialog){
AjxDispatcher.require(["NotebookCore","Notebook"]);
this._importDialog=new ZmImportDialog(this._shell)
}
return this._importDialog
};
ZmAppCtxt.prototype.getAttachDialog=function(){
if(!this._attachDialog){
AjxDispatcher.require("Share");
this._attachDialog=new ZmAttachDialog(this._shell);
this.runAttachDialogCallbacks()
}
return this._attachDialog
};
ZmAppCtxt.prototype.runAttachDialogCallbacks=function(){
while(this._attachDialogCallback&&this._attachDialogCallback.length>0){
var e=this._attachDialogCallback.shift();
if(e&&(e instanceof AjxCallback)){
e.run(this._attachDialog)
}}};
ZmAppCtxt.prototype.addAttachmentDialogCallback=function(e){
if(!this._attachDialogCallback){
this._attachDialogCallback=[]
}
this._attachDialogCallback.push(e)
};
ZmAppCtxt.prototype.getUploadConflictDialog=function(){
if(!this._uploadConflictDialog){
AjxDispatcher.require(["NotebookCore","Notebook"]);
this._uploadConflictDialog=new ZmUploadConflictDialog(this._shell)
}
return this._uploadConflictDialog
};
ZmAppCtxt.prototype.getNewBriefcaseDialog=function(){
if(!this._newBriefcaseDialog){
AjxDispatcher.require(["BriefcaseCore","Briefcase"]);
this._newBriefcaseDialog=new ZmNewBriefcaseDialog(this._shell)
}
return this._newBriefcaseDialog
};
ZmAppCtxt.prototype.getReplaceDialog=function(){
if(!this._replaceDialog){
AjxDispatcher.require("Share");
this._replaceDialog=new ZmFindnReplaceDialog(this._shell)
}
return this._replaceDialog
};
ZmAppCtxt.prototype.getRootTabGroup=function(){
if(this.isChildWindow){
if(!this._childWinTabGrp){
this._childWinTabGrp=new DwtTabGroup("CHILD_WINDOW")
}}else{
if(!this._rootTabGrp){
this._rootTabGrp=new DwtTabGroup("ROOT")
}}
return this.isChildWindow?this._childWinTabGrp:this._rootTabGrp
};
ZmAppCtxt.prototype.getShell=function(){
return this._shell
};
ZmAppCtxt.prototype.setShell=function(e){
this._shell=e
};
ZmAppCtxt.prototype.getActiveAccount=function(){
return this.isChildWindow?parentAppCtxt.accountList.activeAccount:this.accountList.activeAccount
};
ZmAppCtxt.prototype.getIdentityCollection=function(t){
var e=this.isChildWindow?window.opener:window;
return e.AjxDispatcher.run("GetIdentityCollection",t)
};
ZmAppCtxt.prototype.getDataSourceCollection=function(t){
var e=this.isChildWindow?window.opener:window;
return e.AjxDispatcher.run("GetDataSourceCollection",t)
};
ZmAppCtxt.prototype.getSignatureCollection=function(t){
var e=this.isChildWindow?window.opener:window;
return e.AjxDispatcher.run("GetSignatureCollection",t)
};
ZmAppCtxt.prototype.getTree=function(e,t){
if(this.isChildWindow){
return parentAppCtxt.getTree(e,t)
}
var a=this.accountList;
var n=t?t.id:a.activeAccount?a.activeAccount.id:ZmAccountList.DEFAULT_ID;
var o=a.getAccount(n);
return o&&o.trees[ZmOrganizer.TREE_TYPE[e]]
};
ZmAppCtxt.prototype.setTree=function(t,e,a){
var o=this.accountList;
var s=a?a.id:o.activeAccount?o.activeAccount.id:ZmAccountList.DEFAULT_ID;
var n=this.accountList.getAccount(s);
if(n){
n.trees[t]=e
}};
ZmAppCtxt.prototype.getFolderTree=function(e){
return this.getTree(ZmOrganizer.FOLDER,e)
};
ZmAppCtxt.prototype.getTagTree=function(e){
return this.getTree(ZmOrganizer.TAG,e)
};
ZmAppCtxt.prototype.getZimletTree=function(e){
return this.getTree(ZmOrganizer.ZIMLET,e)
};
ZmAppCtxt.prototype.getUsername=function(e){
return this.get(ZmSetting.USERNAME,e)
};
ZmAppCtxt.prototype.getUserDomain=function(e){
if(!this.userDomain){
var a=this.getUsername(e);
if(a){
var t=a.split("@");
this.userDomain=(t&&t.length)?t[1]:""
}}
return this.userDomain
};
ZmAppCtxt.prototype.getUploadFrameId=function(){
if(!this._uploadManagerIframeId){
var a=Dwt.getNextId();
var e=["<iframe name='",a,"' id='",a,"' src='",(AjxEnv.isIE&&location.protocol=="https:")?appContextPath+"/public/blank.html":'javascript:""',"' style='position: absolute; top: 0; left: 0; visibility: hidden'></iframe>"];
var t=document.createElement("div");
t.innerHTML=e.join("");
document.body.appendChild(t.firstChild);
this._uploadManagerIframeId=a
}
return this._uploadManagerIframeId
};
ZmAppCtxt.prototype.getUploadManager=function(){
if(!this._uploadManager){
this._uploadManager=new AjxPost(this.getUploadFrameId())
}
return this._uploadManager
};
ZmAppCtxt.prototype.getCurrentSearch=function(){
return this.getCurrentApp().currentSearch
};
ZmAppCtxt.prototype.getCurrentViewId=function(){
return this.getAppViewMgr().getCurrentViewId()
};
ZmAppCtxt.prototype.getCurrentView=function(){
return this.getAppViewMgr().getCurrentView()
};
ZmAppCtxt.prototype.getCurrentController=function(){
var e=this.getCurrentView();
return(e&&e.getController)?e.getController():null
};
ZmAppCtxt.prototype.setCurrentList=function(e){
this._list=e
};
ZmAppCtxt.prototype.getCurrentList=function(){
var e=this.getCurrentController();
return(e&&e.getList)?e.getList():this._list?this._list:null
};
ZmAppCtxt.prototype.getNewWindow=function(r,s,e){
var o=[];
var n=0;
o[n++]=document.location.protocol;
o[n++]="//";
o[n++]=location.hostname;
o[n++]=(!location.port||location.port=="80")?"":(":"+location.port);
o[n++]=appContextPath;
o[n++]="/public/launchNewWindow.jsp?skin=";
o[n++]=appCurrentSkin;
o[n++]="&localeId=";
o[n++]=AjxEnv.DEFAULT_LOCALE||"";
if(r){
o[n++]="&full=1"
}
if(appDevMode){
o[n++]="&dev=1"
}
s=s||705;
e=e||465;
var a=["height=",e,",width=",s,",location=no,menubar=no,resizable=yes,scrollbars=no,status=yes,toolbar=no"].join("");
var t=window.open(o.join(""),"_blank",a);
if(!t){
this.setStatusMsg(ZmMsg.popupBlocker,ZmStatusView.LEVEL_CRITICAL)
}else{
return this.getAppController().addChildWindow(t)
}};
ZmAppCtxt.prototype.cacheSet=function(e,t){
this._itemCache[e]=t;
delete this._itemCacheDeferred[e]
};
ZmAppCtxt.prototype.cacheSetDeferred=function(t,e){
this._itemCache[t]=this._itemCacheDeferred;
this._itemCacheDeferred[t]=e
};
ZmAppCtxt.prototype.cacheGet=function(t){
var a=this._itemCache[t];
if(a===this._itemCacheDeferred){
var e=this._itemCacheDeferred[t];
this.getApp(e).createDeferred();
a=this._itemCache[t]
}
return a
};
ZmAppCtxt.prototype.cacheRemove=function(e){
delete this._itemCache[e];
delete this._itemCacheDeferred[e]
};
ZmAppCtxt.prototype.getById=function(e){
return this.cacheGet(e)||(this.isChildWindow&&window.opener.appCtxt.getById(e))
};
ZmAppCtxt.prototype.getKeyboardMgr=function(){
return this._shell.getKeyboardMgr()
};
ZmAppCtxt.prototype.getHistoryMgr=function(){
if(!this._historyMgr){
this._historyMgr=new AjxHistoryMgr()
}
return this._historyMgr
};
ZmAppCtxt.prototype.zimletsPresent=function(){
return this._zimletsPresent
};
ZmAppCtxt.prototype.setZimletsPresent=function(e){
this._zimletsPresent=e
};
ZmAppCtxt.prototype.getZimletMgr=function(){
if(!this._zimletMgr){
AjxDispatcher.require("Zimlet");
this._zimletMgr=new ZmZimletMgr()
}
return this._zimletMgr
};
ZmAppCtxt.prototype.areZimletsLoaded=function(){
return this._zimletsLoaded
};
ZmAppCtxt.prototype.addZimletsLoadedListener=function(t,e){
if(!this._zimletsLoaded){
return this._evtMgr.addListener(ZmAppCtxt._ZIMLETS_EVENT,t,e)
}};
ZmAppCtxt.prototype.allZimletsLoaded=function(){
this._zimletsLoaded=true;
if(this._zimletMgr&&!this.isChildWindow&&appCtxt.get(ZmSetting.PORTAL_ENABLED)){
var e=this.getApp(ZmApp.PORTAL).getPortletMgr();
if(e){
e.allZimletsLoaded()
}}
if(this._evtMgr.isListenerRegistered(ZmAppCtxt._ZIMLETS_EVENT)){
this._evtMgr.notifyListeners(ZmAppCtxt._ZIMLETS_EVENT,new ZmEvent());
this._evtMgr.removeAll(ZmAppCtxt._ZIMLETS_EVENT)
}};
ZmAppCtxt.prototype.notifyZimlets=function(o,t,e){
var a=this.isChildWindow?parentAppCtxt:this;
if(e&&e.noChildWindow&&this.isChildWindow){
return
}
if(!a.areZimletsLoaded()){
if(e&&e.waitUntilLoaded){
a.addZimletsLoadedListener(new AjxListener(this,this.notifyZimlets,[o,t]))
}
return
}
this.getZimletMgr().notifyZimlets(o,t)
};
ZmAppCtxt.prototype.getCalManager=function(){
if(!this._calMgr){
this._calMgr=new ZmCalMgr(this._shell)
}
return this._calMgr
};
ZmAppCtxt.prototype.getACL=function(e,n){
var t=this.accountList;
var o=e?e.id:t.activeAccount?t.activeAccount.id:ZmAccountList.DEFAULT_ID;
var a=t.getAccount(o);
return a&&a.acl
};
ZmAppCtxt.prototype.getShortcutHint=function(r,e){
var s=null;
r=r||"global";
while(!s&&r){
var o=[r,e,"display"].join(".");
var s=AjxKeys[o]||ZmKeys[o];
if(s){
var a=s.split(/;\s*/);
var n=a[0];
if(!n){
return null
}
n=n.replace(/\b[A-Z]\b/g,function(h){
return h.toLowerCase()
}
);
s=[" [",n.replace(",",""),"]"].join("")
}else{
var t=[r,"INHERIT"].join(".");
r=AjxKeys[t]||ZmKeys[t]
}}
return s
};
ZmAppCtxt.prototype.getShortcutsPanel=function(){
if(!this._shortcutsPanel){
AjxDispatcher.require(["PreferencesCore","Preferences"]);
var e=this.isChildWindow?ZmShortcutList.WINDOW_STYLE:ZmShortcutList.PANEL_STYLE;
this._shortcutsPanel=new ZmShortcutsPanel(e)
}
return this._shortcutsPanel
};
ZmAppCtxt.prototype.getSkinHint=function(){
if(arguments.length==0){
return""
}
var a=skin&&skin.hints;
if(!a){
return""
}
for(var t=0;
t<arguments.length;
t++){
var e=arguments[t];
if(!a[e]){
return""
}
a=a[e]
}
return a
};
ZmAppCtxt.prototype.getAutocompleter=function(){
if(!this._autocompleter){
this._autocompleter=new ZmAutocomplete()
}
return this._autocompleter
};
ZmAppCtxt.prototype.isMyAddress=function(o,a){
if(a&&(o.indexOf("@")==-1)){
o=[o,this.getUserDomain()].join("@")
}
if(o==this.get(ZmSetting.USERNAME)){
return true
}
var e=this.get(ZmSetting.MAIL_ALIASES);
if(e&&e.length){
for(var t=0;
t<e.length;
t++){
if(o==e[t]){
return true
}}}
return false
};
ZmAppCtxt.prototype.getOverviewId=function(t,e){
var a=(t instanceof Array)?t.join("_"):t;
if(appCtxt.multiAccounts&&(e!==null)){
e=e||appCtxt.getActiveAccount();
a=[e.name,a].join(":")
}
return a
}
}
if(AjxPackage.define("zimbraMail.core.ZmOperation")){
ZmOperation=function(){};
ZmOperation.NONE="NONE";
ZmOperation.SEP="SEP";
ZmOperation.SPACER="SPACER";
ZmOperation.FILLER="FILLER";
ZmOperation.DIS="Dis";
ZmOperation.SETUP={};
ZmOperation.SETUP[ZmOperation.NONE]={};
ZmOperation.SETUP[ZmOperation.SEP]={};
ZmOperation.SETUP[ZmOperation.SPACER]={};
ZmOperation.SETUP[ZmOperation.FILLER]={};
ZmOperation.SETTING={};
ZmOperation.CALLBACK={};
ZmOperation.registerOp=function(o,t,e,a){
ZmOperation[o]=o;
ZmOperation.SETUP[o]=t||{};
if(e){
ZmOperation.SETTING[o]=e
}
if(a){
ZmOperation.CALLBACK[o]=a
}};
ZmOperation.KEY_ID="_opId";
ZmOperation.MENUITEM_ID="_menuItemId";
ZmOperation.NEW_ITEM_OPS=[];
ZmOperation.NEW_ITEM_KEY={};
ZmOperation.NEW_ORG_OPS=[];
ZmOperation.NEW_ORG_KEY={};
ZmOperation._operationDesc={};
ZmOperation.initialize=function(){
ZmOperation.registerOp(ZmId.OP_ATTACHMENT,{
textKey:"addAttachment",tooltipKey:"attachmentTooltip",image:"Attachment",shortcut:ZmKeyMap.ATTACHMENT}
);
ZmOperation.registerOp(ZmId.OP_BROWSE,{
textKey:"advancedSearch",image:"SearchBuilder",tooltipKey:"advancedSearchTooltip"}
,ZmSetting.BROWSE_ENABLED);
ZmOperation.registerOp(ZmId.OP_CALL,{
image:"Telephone"}
);
ZmOperation.registerOp(ZmId.OP_CANCEL,{
textKey:"cancel",tooltipKey:"cancelTooltip",image:"Cancel",shortcut:ZmKeyMap.CANCEL}
);
ZmOperation.registerOp(ZmId.OP_CHECK_ALL,{
textKey:"checkAll",image:"Check"}
);
ZmOperation.registerOp(ZmId.OP_CLEAR_ALL,{
textKey:"clearAll",image:"Cancel"}
);
ZmOperation.registerOp(ZmId.OP_CLOSE,{
textKey:"close",tooltipKey:"closeTooltip",image:"Close",shortcut:ZmKeyMap.CANCEL}
);
ZmOperation.registerOp(ZmId.OP_COMPOSE_FORMAT,{
textKey:"format",tooltipKey:"formatTooltip",image:"SwitchFormat",shortcut:ZmKeyMap.HTML_FORMAT}
,ZmSetting.HTML_COMPOSE_ENABLED);
ZmOperation.registerOp(ZmId.OP_DELETE,{
textKey:"del",tooltipKey:"deleteTooltip",image:"Delete",shortcut:ZmKeyMap.DEL,textPrecedence:60}
);
ZmOperation.registerOp(ZmId.OP_DETACH,{
tooltipKey:"detachTT",image:"OpenInNewWindow"}
);
ZmOperation.registerOp(ZmId.OP_DETACH_WIN,{
textKey:"detachTT",tooltipKey:"detachTT",image:"OpenInNewWindow"}
);
ZmOperation.registerOp(ZmId.OP_EDIT,{
textKey:"edit",tooltipKey:"editTooltip",image:"Edit",shortcut:ZmKeyMap.EDIT}
);
ZmOperation.registerOp(ZmId.OP_EDIT_PROPS,{
textKey:"editProperties",tooltipKey:"editPropertiesTooltip",image:"Properties"}
);
ZmOperation.registerOp(ZmId.OP_EXPAND_ALL,{
textKey:"expandAll",image:"Plus"}
);
ZmOperation.registerOp(ZmId.OP_EMPTY_FOLDER,{
textKey:"emptyFolder",image:"EmptyFolder"}
);
ZmOperation.registerOp(ZmId.OP_FORMAT_HTML,{
textKey:"formatAsHtml",image:"HtmlDoc"}
,ZmSetting.HTML_COMPOSE_ENABLED);
ZmOperation.registerOp(ZmId.OP_FORMAT_TEXT,{
textKey:"formatAsText",image:"GenericDoc"}
,ZmSetting.HTML_COMPOSE_ENABLED);
ZmOperation.registerOp(ZmId.OP_GO_TO_URL,{
image:"URL"}
);
ZmOperation.registerOp(ZmId.OP_MARK_ALL_READ,{
textKey:"markAllRead",image:"ReadMessage"}
);
ZmOperation.registerOp(ZmId.OP_MOUNT_FOLDER,{
textKey:"mountFolder",image:"Folder"}
);
ZmOperation.registerOp(ZmId.OP_MOVE,{
textKey:"move",tooltipKey:"moveTooltip",image:"MoveToFolder",textPrecedence:40}
);
ZmOperation.registerOp(ZmId.OP_NEW_FOLDER,{
textKey:"newFolder",tooltipKey:"newFolderTooltip",image:"NewFolder",shortcut:ZmKeyMap.NEW_FOLDER}
,ZmSetting.USER_FOLDERS_ENABLED);
ZmOperation.registerOp(ZmId.OP_NEW_MENU,{
textKey:"_new",shortcut:ZmKeyMap.NEW,textPrecedence:100}
,null,AjxCallback.simpleClosure(function(e){
ZmOperation.addDeferredMenu(ZmOperation.addNewMenu,e)
}
));
ZmOperation.registerOp(ZmId.OP_NEW_TAG,{
textKey:"newTag",tooltipKey:"newTagTooltip",image:"NewTag",shortcut:ZmKeyMap.NEW_TAG}
,ZmSetting.TAGGING_ENABLED);
ZmOperation.registerOp(ZmId.OP_NOTIFY,{
textKey:"notify",image:"Feedback"}
);
ZmOperation.registerOp(ZmId.OP_PAGE_BACK,{
image:"LeftArrow",shortcut:ZmKeyMap.PREV_PAGE}
);
ZmOperation.registerOp(ZmId.OP_PAGE_FORWARD,{
image:"RightArrow",shortcut:ZmKeyMap.NEXT_PAGE}
);
ZmOperation.registerOp(ZmId.OP_PRINT,{
textKey:"print",tooltipKey:"printTooltip",image:"Print",shortcut:ZmKeyMap.PRINT,textPrecedence:30}
,ZmSetting.PRINT_ENABLED);
ZmOperation.registerOp(ZmId.OP_REFRESH,{
textKey:"refresh",tooltipKey:"refreshTooltip"}
);
ZmOperation.registerOp(ZmId.OP_RENAME_FOLDER,{
textKey:"renameFolder",image:"Rename"}
);
ZmOperation.registerOp(ZmId.OP_RENAME_SEARCH,{
textKey:"renameSearch",image:"Rename"}
);
ZmOperation.registerOp(ZmId.OP_RENAME_TAG,{
textKey:"renameTag",image:"Rename"}
,ZmSetting.TAGGING_ENABLED);
ZmOperation.registerOp(ZmId.OP_SAVE,{
textKey:"save",image:"Save",shortcut:ZmKeyMap.SAVE}
);
ZmOperation.registerOp(ZmId.OP_SEARCH,{
textKey:"search",image:"Search"}
,ZmSetting.SEARCH_ENABLED);
ZmOperation.registerOp(ZmId.OP_SEND,{
textKey:"send",tooltipKey:"sendTooltip",image:"Send",shortcut:ZmKeyMap.SEND}
);
ZmOperation.registerOp(ZmId.OP_FREE_BUSY_LINK,{
textKey:"freeBusyLink",tooltipKey:"freeBusyLinkTooltip",image:"Send"}
);
ZmOperation.registerOp(ZmId.OP_SHARE,{
textKey:"share",tooltipKey:"shareTooltip"}
,ZmSetting.SHARING_ENABLED);
ZmOperation.registerOp(ZmId.OP_SHARE_ACCEPT,{
textKey:"acceptShare",image:"Check"}
,ZmSetting.SHARING_ENABLED);
ZmOperation.registerOp(ZmId.OP_SHARE_DECLINE,{
textKey:"declineShare",image:"Cancel"}
,ZmSetting.SHARING_ENABLED);
ZmOperation.registerOp(ZmId.OP_SHARE_FOLDER,{
textKey:"shareFolder",image:"SharedMailFolder"}
);
ZmOperation.registerOp(ZmId.OP_SHOW_ALL_ITEM_TYPES,{
textKey:"showAllItemTypes",image:"Globe"}
);
ZmOperation.registerOp(ZmId.OP_SPELL_CHECK,{
textKey:"spellCheck",image:"SpellCheck",tooltipKey:"spellCheckTooltip",shortcut:ZmKeyMap.SPELLCHECK}
,ZmSetting.SPELL_CHECK_ENABLED);
ZmOperation.registerOp(ZmId.OP_SYNC,{
textKey:"reload",image:"Refresh",shortcut:ZmKeyMap.REFRESH}
);
ZmOperation.registerOp(ZmId.OP_SYNC_ALL,{
textKey:"checkAllFeed",image:"Refresh"}
);
ZmOperation.registerOp(ZmId.OP_SYNC_OFFLINE_FOLDER,{
textKey:"syncOfflineFolderOff",image:"Refresh"}
,ZmSetting.OFFLINE_ENABLED);
ZmOperation.registerOp(ZmId.OP_TAG,null,ZmSetting.TAGGING_ENABLED);
ZmOperation.registerOp(ZmId.OP_TAG_COLOR_MENU,{
textKey:"tagColor",image:"TagStack"}
,ZmSetting.TAGGING_ENABLED,AjxCallback.simpleClosure(function(e){
ZmOperation.addDeferredMenu(ZmOperation.addColorMenu,e)
}
));
ZmOperation.registerOp(ZmId.OP_TAG_MENU,{
tooltipKey:"tagTooltip",image:"Tag"}
,ZmSetting.TAGGING_ENABLED,AjxCallback.simpleClosure(function(e){
ZmOperation.addDeferredMenu(ZmOperation.addTagMenu,e)
}
));
ZmOperation.registerOp(ZmId.OP_TEXT);
ZmOperation.registerOp(ZmId.OP_UNDELETE,{
textKey:"undelete",tooltipKey:"undelete",image:"MoveToFolder"}
);
ZmOperation.registerOp(ZmId.OP_VIEW,{
textKey:"view",image:"SplitView"}
);
ZmOperation.registerOp(ZmId.OP_VIEW_MENU,{
tooltipKey:"viewTooltip",textKey:"view",image:"SplitPane",textPrecedence:80}
);
ZmOperation.registerOp(ZmId.OP_ZIMLET,{
image:"ZimbraIcon"}
);
ZmOperation.NEW_ORG_OPS.push(ZmOperation.NEW_FOLDER,ZmOperation.NEW_TAG);
ZmOperation.NEW_ORG_KEY[ZmOperation.NEW_FOLDER]="folder";
ZmOperation.NEW_ORG_KEY[ZmOperation.NEW_TAG]="tag"
};
ZmOperation.createOperations=function(t,e,o){
var a=new ZmOperation();
return a._createOperations(t,e,o)
};
ZmOperation.prototype._createOperations=function(a,e,n){
if(e==ZmOperation.NONE){
e=null
}
n=n||{};
var o={};
if(e&&e.length){
for(var t=0;
t<e.length;
t++){
var s=e[t];
ZmOperation.defineOperation(s,n[s]);
ZmOperation.addOperation(a,s,o)
}}
return o
};
ZmOperation.defineOperation=function(m,u){
var t=(u&&u.id)||(m&&m.id)||m||Dwt.getNextId();
var a=(u&&u.textKey)||ZmOperation.getProp(m,"textKey");
var f=a&&ZmMsg[a];
var c=(u&&u.tooltipKey)||ZmOperation.getProp(m,"tooltipKey");
var p=c&&ZmMsg[c];
var n=ZmOperation.getProp(m,"image");
var h=ZmOperation.getProp(m,"disImage");
var d=(u&&(u.enabled!==false));
var e=ZmOperation.getProp(m,"style");
var s=ZmOperation.getProp(m,"shortcut");
var o={
id:t,text:f,image:n,disImage:h,enabled:d,tooltip:p,style:e,shortcut:s};
if(u){
for(var r in u){
o[r]=u[r]
}}
ZmOperation._operationDesc[t]=o;
return o
};
ZmOperation.getProp=function(o,a){
var t=null;
var e=ZmOperation.SETUP[o];
if(e){
t=e[a];
if(!t&&(a=="disImage")&&e.image){
t=e.image
}}
return t
};
ZmOperation.isSep=function(e){
return(e==ZmOperation.SEP||e==ZmOperation.SPACER||e==ZmOperation.FILLER)
};
ZmOperation.addOperation=function(t,s,a,e){
var o=ZmOperation._operationDesc[s]||ZmOperation.defineOperation(s);
if(s==ZmOperation.SEP){
if(t instanceof DwtMenu){
t.createSeparator(e)
}else{
t.addSeparator(null,e)
}}else{
if(s==ZmOperation.SPACER){
t.addSpacer(null,e)
}else{
if(s==ZmOperation.FILLER){
t.addFiller(null,e)
}else{
if(e){
o.index=e
}
a[s]=t.createOp(s,o)
}}}
var n=ZmOperation.CALLBACK[s];
if(n){
if(n.run){
n.run(a[s])
}else{
n(a[s])
}}};
ZmOperation.addDeferredMenu=function(e,t){
var a=new AjxCallback(null,e,t);
t.setMenu(a)
};
ZmOperation.removeOperation=function(e,a,t){
e.getOp(a).dispose();
delete t[a]
};
ZmOperation.setOperation=function(t,s,e,n,o,a){
var r=t.getOp(s);
if(!r){
return
}
r.setText(n?n:ZmMsg[ZmOperation.getProp(e,"textKey")]);
r.setImage(o?o:ZmOperation.getProp(e,"image"))
};
ZmOperation.filterOperations=function(s){
var o=[];
if(!(s&&s.length)){
return o
}
for(var t=0;
t<s.length;
t++){
var r=s[t];
if(!r){
continue
}
var a=ZmOperation.SETTING[r];
if(!a||appCtxt.get(a)){
o.push(r)
}}
var e=[];
var n=false;
for(var t=0;
t<o.length;
t++){
var r=o[t];
if(r==ZmOperation.SEP||r==ZmOperation.SPACER){
if(!n){
e.push(r)
}
n=true
}else{
e.push(r);
n=false
}}
if(e&&e.length){
if(e[0]==ZmOperation.SEP||e[0]==ZmOperation.SPACER){
e.shift()
}
var t=e.length-1;
if(e[t]==ZmOperation.SEP||e[t]==ZmOperation.SPACER||e[t]==ZmOperation.FILLER){
e.pop()
}}
return e
};
ZmOperation.addNewMenu=function(t){
var o=ZmOperation.NEW_ITEM_OPS;
o.push(ZmOperation.SEP);
o=o.concat(ZmOperation.NEW_ORG_OPS);
var s={};
for(var e=0;
e<o.length;
e++){
var r=o[e];
var a=ZmOperation.NEW_ITEM_KEY[r]||ZmOperation.NEW_ORG_KEY[r];
if(a){
s[r]={
textKey:a}
}}
var n=new ZmActionMenu({
parent:t,menuItems:o,overrides:s}
);
t.setMenu(n);
return n
};
ZmOperation.addTagMenu=function(e){
var t=new ZmTagMenu(e);
e.setMenu(t);
return t
};
ZmOperation.addColorMenu=function(o){
var s=new ZmPopupMenu(o);
o.setMenu(s);
var n=ZmTagTree.COLOR_LIST;
for(var a=0;
a<n.length;
a++){
var t=n[a];
var e=s.createMenuItem(t,{
image:ZmTag.COLOR_ICON[t],text:ZmOrganizer.COLOR_TEXT[t]}
);
e.setData(ZmOperation.MENUITEM_ID,t)
}
return s
};
ZmOperation.getToolTip=function(n,o,e){
var t=ZmOperation._operationDesc[n]||ZmOperation.defineOperation(n);
e=e||t.tooltip;
var a=e&&t.shortcut&&appCtxt.getShortcutHint(o,t.shortcut);
return a?[e,a].join(""):e
}
}
if(AjxPackage.define("zimbraMail.core.ZmMimeTable")){
ZmMimeTable=function(){};
ZmMimeTable.APP="application";
ZmMimeTable.APP_ADOBE_PDF="application/pdf";
ZmMimeTable.APP_ADOBE_PS="application/postscript";
ZmMimeTable.APP_APPLE_DOUBLE="application/applefile";
ZmMimeTable.APP_EXE="application/exe";
ZmMimeTable.APP_MS_DOWNLOAD="application/x-msdownload";
ZmMimeTable.APP_MS_EXCEL="application/vnd.ms-excel";
ZmMimeTable.APP_MS_PPT="application/vnd.ms-powerpoint";
ZmMimeTable.APP_MS_PROJECT="application/vnd.ms-project";
ZmMimeTable.APP_MS_TNEF="application/ms-tnef";
ZmMimeTable.APP_MS_TNEF2="application/vnd.ms-tnef";
ZmMimeTable.APP_MS_VISIO="application/vnd.visio";
ZmMimeTable.APP_MS_WORD="application/msword";
ZmMimeTable.APP_OCTET_STREAM="application/octet-stream";
ZmMimeTable.APP_OPENXML_DOC="application/vnd.openxmlformats-officedocument.wordprocessingml.document";
ZmMimeTable.APP_OPENXML_EXCEL="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
ZmMimeTable.APP_OPENXML_PPT="application/vnd.openxmlformats-officedocument.presentationml.presentation";
ZmMimeTable.APP_ZIMBRA_DOC="application/x-zimbra-doc";
ZmMimeTable.APP_ZIMBRA_SLIDES="application/x-zimbra-slides";
ZmMimeTable.APP_ZIMBRA_SPREADSHEET="application/x-zimbra-xls";
ZmMimeTable.APP_ZIP="application/zip";
ZmMimeTable.APP_ZIP2="application/x-zip-compressed";
ZmMimeTable.AUDIO="audio";
ZmMimeTable.AUDIO_WAV="audio/x-wav";
ZmMimeTable.AUDIO_MP3="audio/mpeg";
ZmMimeTable.IMG="image";
ZmMimeTable.IMG_GIF="image/gif";
ZmMimeTable.IMG_JPEG="image/jpeg";
ZmMimeTable.IMG_PJPEG="image/pjpeg";
ZmMimeTable.IMG_PNG="image/png";
ZmMimeTable.IMG_TIFF="image/tiff";
ZmMimeTable.MSG_RFC822="message/rfc822";
ZmMimeTable.MULTI_ALT="multipart/alternative";
ZmMimeTable.MULTI_MIXED="multipart/mixed";
ZmMimeTable.MULTI_RELATED="multipart/related";
ZmMimeTable.MULTI_APPLE_DBL="multipart/appledouble";
ZmMimeTable.MULTI_DIGEST="multipart/digest";
ZmMimeTable.TEXT="text";
ZmMimeTable.TEXT_RTF="text/enriched";
ZmMimeTable.TEXT_HTML="text/html";
ZmMimeTable.TEXT_CAL="text/calendar";
ZmMimeTable.TEXT_JAVA="text/x-java";
ZmMimeTable.TEXT_VCARD="text/x-vcard";
ZmMimeTable.TEXT_DIRECTORY="text/directory";
ZmMimeTable.TEXT_PLAIN="text/plain";
ZmMimeTable.TEXT_XML="text/xml";
ZmMimeTable.VIDEO="video";
ZmMimeTable.VIDEO_WMV="video/x-ms-wmv";
ZmMimeTable.XML_ZIMBRA_SHARE="xml/x-zimbra-share";
ZmMimeTable._table=new Object();
ZmMimeTable._table[ZmMimeTable.APP]={
desc:ZmMsg.unknownBinaryType,image:"ExeDoc",imageLarge:"ExeDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_ADOBE_PDF]={
desc:ZmMsg.adobePdfDocument,image:"PDFDoc",imageLarge:"PDFDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_ADOBE_PS]={
desc:ZmMsg.adobePsDocument,image:"GenericDoc",imageLarge:"GenericDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_EXE]={
desc:ZmMsg.application,image:"ExeDoc",imageLarge:"ExeDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_MS_DOWNLOAD]={
desc:ZmMsg.msDownload,image:"ExeDoc",imageLarge:"ExeDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_MS_EXCEL]={
desc:ZmMsg.msExcelDocument,image:"MSExcelDoc",imageLarge:"MSExcelDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_MS_PPT]={
desc:ZmMsg.msPPTDocument,image:"MSPowerpointDoc",imageLarge:"MSPowerpointDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_MS_PROJECT]={
desc:ZmMsg.msProjectDocument,image:"MSProjectDoc",imageLarge:"MSProjectDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_MS_VISIO]={
desc:ZmMsg.msVisioDocument,image:"MSVisioDoc",imageLarge:"MSVisioDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_MS_WORD]={
desc:ZmMsg.msWordDocument,image:"MSWordDoc",imageLarge:"MSWordDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_OCTET_STREAM]={
desc:ZmMsg.unknownBinaryType,image:"UnknownDoc",imageLarge:"UnknownDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_OPENXML_DOC]={
desc:ZmMsg.msWordDocument,image:"MSWordDoc",imageLarge:"MSWordDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_OPENXML_EXCEL]={
desc:ZmMsg.msExcelDocument,image:"MSExcelDoc",imageLarge:"MSExcelDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_OPENXML_PPT]={
desc:ZmMsg.msPPTDocument,image:"MSPowerpointDoc",imageLarge:"MSPowerpointDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_ZIMBRA_DOC]={
desc:ZmMsg.msWordDocument,image:"Doc",imageLarge:"Doc_48"};
ZmMimeTable._table[ZmMimeTable.APP_ZIMBRA_SLIDES]={
desc:ZmMsg.msPPTDocument,image:"Presentation",imageLarge:"Presentation_48"};
ZmMimeTable._table[ZmMimeTable.APP_ZIMBRA_SPREADSHEET]={
desc:ZmMsg.msExcelDocument,image:"ZSpreadSheet",imageLarge:"ZSpreadSheet_48"};
ZmMimeTable._table[ZmMimeTable.APP_ZIP]={
desc:ZmMsg.zipFile,image:"ZipDoc",imageLarge:"ZipDoc_48"};
ZmMimeTable._table[ZmMimeTable.APP_ZIP2]={
desc:ZmMsg.zipFile,image:"ZipDoc",imageLarge:"ZipDoc_48"};
ZmMimeTable._table[ZmMimeTable.AUDIO]={
desc:ZmMsg.audio,image:"AudioDoc",imageLarge:"Doc_48"};
ZmMimeTable._table[ZmMimeTable.AUDIO_WAV]={
desc:ZmMsg.waveAudio,image:"AudioDoc",imageLarge:"AudioDoc_48"};
ZmMimeTable._table[ZmMimeTable.AUDIO_MP3]={
desc:ZmMsg.mp3Audio,image:"AudioDoc",imageLarge:"AudioDoc_48"};
ZmMimeTable._table[ZmMimeTable.VIDEO]={
desc:ZmMsg.video,image:"VideoDoc",imageLarge:"VideoDoc_48"};
ZmMimeTable._table[ZmMimeTable.VIDEO_WMV]={
desc:ZmMsg.msWMV,image:"VideoDoc",imageLarge:"VideoDoc_48"};
ZmMimeTable._table[ZmMimeTable.IMG]={
desc:ZmMsg.image,image:"ImageDoc",imageLarge:"ImageDoc_48"};
ZmMimeTable._table[ZmMimeTable.IMG_GIF]={
desc:ZmMsg.gifImage,image:"ImageDoc",imageLarge:"ImageDoc_48"};
ZmMimeTable._table[ZmMimeTable.IMG_JPEG]={
desc:ZmMsg.jpegImage,image:"ImageDoc",imageLarge:"ImageDoc_48"};
ZmMimeTable._table[ZmMimeTable.IMG_PNG]={
desc:ZmMsg.pngImage,image:"ImageDoc",imageLarge:"ImageDoc_48"};
ZmMimeTable._table[ZmMimeTable.IMG_TIFF]={
desc:ZmMsg.tiffImage,image:"ImageDoc",imageLarge:"ImageDoc_48"};
ZmMimeTable._table[ZmMimeTable.MSG_RFC822]={
desc:ZmMsg.mailMessage,image:"MessageDoc",imageLarge:"MessageDoc_48"};
ZmMimeTable._table[ZmMimeTable.TEXT]={
desc:ZmMsg.textDocuments,image:"GenericDoc",imageLarge:"GenericDoc_48"};
ZmMimeTable._table[ZmMimeTable.TEXT_RTF]={
desc:ZmMsg.enrichedText,image:"GenericDoc",imageLarge:"GenericDoc_48"};
ZmMimeTable._table[ZmMimeTable.TEXT_HTML]={
desc:ZmMsg.htmlDocument,image:"HtmlDoc",imageLarge:"HtmlDoc_48"};
ZmMimeTable._table[ZmMimeTable.TEXT_JAVA]={
desc:ZmMsg.javaSource,image:"GenericDoc",imageLarge:"GenericDoc_48"};
ZmMimeTable._table[ZmMimeTable.TEXT_PLAIN]={
desc:ZmMsg.textFile,image:"GenericDoc",imageLarge:"GenericDoc_48"};
ZmMimeTable._table[ZmMimeTable.TEXT_XML]={
desc:ZmMsg.xmlDocument,image:"GenericDoc",imageLarge:"GenericDoc_48"};
ZmMimeTable.getInfo=function(t,e){
var a=ZmMimeTable._table[t];
if(!a&&e){
a=ZmMimeTable._table[t]={
desc:t,image:"UnknownDoc",imageLarge:"UnknownDoc_48"}
}
if(a){
if(!a.type){
a.type=t
}}else{
var o=t.split("/")[0];
if(o){
a=ZmMimeTable._table[o]
}}
return a
};
ZmMimeTable.isIgnored=function(e){
return(e==ZmMimeTable.MULTI_ALT||e==ZmMimeTable.MULTI_MIXED||e==ZmMimeTable.MULTI_RELATED||e==ZmMimeTable.MULTI_APPLE_DBL||e==ZmMimeTable.APP_MS_TNEF||e==ZmMimeTable.APP_MS_TNEF2)
};
ZmMimeTable.isRenderable=function(e){
return(e==ZmMimeTable.TEXT_HTML||e==ZmMimeTable.TEXT_PLAIN||e==ZmMimeTable.IMG_JPEG||e==ZmMimeTable.IMG_GIF||e==ZmMimeTable.IMG_PNG)
};
ZmMimeTable.isRenderableImage=function(e){
return(e==ZmMimeTable.IMG_JPEG||e==ZmMimeTable.IMG_GIF||e==ZmMimeTable.IMG_PNG)
};
ZmMimeTable.hasHtmlVersion=function(e){
return(!(ZmMimeTable.isIgnored(e)||e.match(/^image/)||e.match(/^audio/)||e.match(/^video/)))
}
}};



/* Copyright (C) 2005-2009 Zimbra Inc. http://www.zimbra.com/ */
if(AjxPackage.define("Startup1_2")){
if(AjxPackage.define("zimbraMail.share.model.ZmObjectHandler")){
ZmObjectHandler=function(e,t){
if(arguments.length>0){
this.init(e,t)
}};
ZmObjectHandler.prototype.constructor=ZmObjectHandler;
ZmObjectHandler.prototype.init=function(e,t){
this._typeName=e;
this._className=t?t:"Object"
};
ZmObjectHandler.prototype.toString=function(){
if(!this._toString){
var e=""+this.constructor;
e=e.substring(0,e.indexOf("("));
this._toString=e.substring("function ".length)
}
return this._toString
};
ZmObjectHandler.prototype.getTypeName=function(){
return this._typeName
};
ZmObjectHandler.prototype.getClassName=function(t,e){
return this._className
};
ZmObjectHandler.prototype.getHoveredClassName=function(a,t){
var e=this.getClassName(a);
if(this._cachedClassNameForHovered!==e){
this._cachedClassNameForHovered=e;
this._classNameHovered=e+"-"+DwtCssStyle.HOVER
}
return this._classNameHovered
};
ZmObjectHandler.prototype.getActiveClassName=function(a,t){
var e=this.getClassName(a);
if(this._cachedClassNameForActive!==e){
this._cachedClassNameForActive=e;
this._classNameActive=e+"-"+DwtCssStyle.ACTIVE
}
return this._classNameActive
};
ZmObjectHandler.prototype.findObject=function(e,t){
if(t===0){
this._lastMatch=null;
this._noMatch=false
}
if(this._noMatch){
return null
}
if(this._lastMatch&&this._lastMatch.index>=t){
return this._lastMatch
}
this._lastMatch=this.match(e,t);
this._noMatch=(this._lastMatch===null);
return this._lastMatch
};
ZmObjectHandler.prototype.match=function(e,t){
return null
};
ZmObjectHandler.prototype._getHtmlContent=function(a,e,n,t,o){
a[e++]=AjxStringUtil.htmlEncode(n,true);
return e
};
ZmObjectHandler.prototype.generateSpan=function(a,e,n,o,t){
a[e++]="<span class='";
a[e++]=this.getClassName(n);
a[e++]="' id='";
a[e++]=o;
a[e++]="'>";
e=this._getHtmlContent(a,e,n,t,o);
a[e++]="</span>";
return e
};
ZmObjectHandler.prototype.hasToolTipText=function(t,e){
return true
};
ZmObjectHandler.prototype.getToolTipText=function(t,e){
return AjxStringUtil.htmlEncode(t)
};
ZmObjectHandler.prototype.populateToolTip=function(t,e){};
ZmObjectHandler.prototype.getActionMenu=function(a,t,e){
return null
};
ZmObjectHandler.prototype.selected=function(o,t,a,e){
return this.clicked(t,o,e,a)
};
ZmObjectHandler.prototype.clicked=function(t,o,e,a){};
ZmObjectHandler.prototype.hoverOver=function(t,o,e,s){
var a=DwtShell.getShell(window);
var n=a.getToolTip();
n.setContent(this.getToolTipText(t,o));
n.popup(e,s);
this.populateToolTip(t,o)
};
ZmObjectHandler.prototype.hoverOut=function(e,a){
var t=DwtShell.getShell(window);
var o=t.getToolTip();
o.popdown()
}
}
if(AjxPackage.define("zimbraMail.share.model.ZmObjectManager")){
ZmObjectManager=function(t,e,a){
this._selectCallback=e;
this._uuid=Dwt.getNextId();
this._objectIdPrefix="OBJ_PREFIX_";
this._objectHandlers={};
if(appCtxt.get(ZmSetting.MAIL_ENABLED)&&window.ZmImageAttachmentObjectHandler){
this._imageAttachmentHandler=new ZmImageAttachmentObjectHandler()
}
if(!a){
this.initialized=false;
this._addAutoHandlers()
}else{
this.initialized=true
}
this.sortHandlers();
this.reset();
this.setView(t)
};
ZmObjectManager._TOOLTIP_DELAY=275;
ZmObjectManager.EMAIL="email";
ZmObjectManager.URL="url";
ZmObjectManager.PHONE="phone";
ZmObjectManager.DATE="date";
ZmObjectManager.ADDRESS="address";
ZmObjectManager.ATTR_CURRENT_DATE="currentDate";
ZmObjectManager._autohandlers=[];
ZmObjectManager.registerHandler=function(obj,type,priority){
if(typeof obj=="string"){
obj=eval(obj)
}
var c=ZmObjectManager._autohandlers;
if(!obj.__registered){
var id=c.push(obj);
var i=id-1;
if(type){
c[i].useType=type
}
if(priority){
c[i].usePrio=priority
}
obj.__registered=true
}};
ZmObjectManager.unregisterHandler=function(obj){
if(typeof obj=="string"){
obj=eval(obj)
}
var c=ZmObjectManager._autohandlers,i;
for(i=c.length;
--i>=0;
){
if(c[i]===obj){
c.splice(i,1);
break
}}};
ZmObjectManager.prototype.toString=function(){
return"ZmObjectManager"
};
ZmObjectManager.prototype.getHandlers=function(){
if(!this.initialized&&appCtxt.zimletsPresent()){
var e=appCtxt.getZimletMgr();
if(e.isLoaded()){
this.initialized=true;
var a=e.getContentZimlets();
for(var t=0;
t<a.length;
t++){
this.addHandler(a[t],a[t].type,a[t].prio)
}}}
return this._objectHandlers
};
ZmObjectManager.prototype.addHandler=function(a,t,e){
t=t||(a.getTypeName()?a.getTypeName():"none");
e=e?e:-1;
a._prio=e;
var o=this.getHandlers();
if(!o[t]){
o[t]=[]
}
o[t].push(a)
};
ZmObjectManager.prototype.removeHandler=function(a,t){
t=t||(a.getTypeName()?a.getTypeName():"none");
var n=this.getHandlers();
if(n[t]){
for(var e=0,o=n[t].length;
e<o;
e++){
if(n[t][e]==a){
n[t].splice(e,1);
break
}}}};
ZmObjectManager.prototype.sortHandlers=function(){
this._allObjectHandlers=[];
var t=this.getHandlers();
for(i in t){
t[i].sort(ZmObjectManager.__byPriority);
for(var e=0;
e<t[i].length;
e++){
this._allObjectHandlers.push(t[i][e])
}}
this._allObjectHandlers.sort(ZmObjectManager.__byPriority)
};
ZmObjectManager.prototype._addAutoHandlers=function(){
var s=ZmObjectManager._autohandlers,e,o,n;
for(e=0;
e<s.length;
++e){
o=s[e];
var a=o;
var t=o.TYPE;
if(appCtxt.zimletsPresent()){
if(!(o instanceof ZmZimletBase)){
a=new o()
}}
if(o.useType){
t=o.useType
}
if(o.usePrio){
n=o.usePrio
}
this.addHandler(a,t,n)
}};
ZmObjectManager.prototype.reset=function(){
this._objects={}
};
ZmObjectManager.prototype.setView=function(e){
if(e!=null&&appCtxt.getZimletMgr().isLoaded()){
e.addListener(DwtEvent.ONMOUSEOVER,new AjxListener(this,this._mouseOverListener));
e.addListener(DwtEvent.ONMOUSEOUT,new AjxListener(this,this._mouseOutListener));
e.addListener(DwtEvent.ONMOUSEDOWN,new AjxListener(this,this._mouseDownListener));
e.addListener(DwtEvent.ONMOUSEUP,new AjxListener(this,this._mouseUpListener));
e.addListener(DwtEvent.ONMOUSEMOVE,new AjxListener(this,this._mouseMoveListener));
if(AjxEnv.isSafari){
e.addListener(DwtEvent.ONCONTEXTMENU,new AjxListener(this,this._rightClickListener))
}
this._hoverOverListener=new AjxListener(this,this._handleHoverOver);
this._hoverOutListener=new AjxListener(this,this._handleHoverOut)
}
this._view=e
};
ZmObjectManager.prototype.objectsCount=function(){
return(appCtxt.zimletsPresent())?appCtxt.getZimletMgr().getContentZimlets().length:0
};
ZmObjectManager.prototype.getImageAttachmentHandler=function(){
return this._imageAttachmentHandler
};
ZmObjectManager.prototype._getAjxEmailAddress=function(e){
if(appCtxt.isChildWindow&&e.isAjxEmailAddress){
e=AjxEmailAddress.copy(e)
}
return e
};
ZmObjectManager.prototype.findObjects=function(m,e,a,u){
if(!m){
return""
}
var r=[];
var l=0;
var h=m.length;
var y=0;
var o=this.getHandlers();
while(true){
var b=null;
var f=h;
var d=null;
var g;
var c;
var s;
var n=null;
if(a){
c=o[a];
if(c){
for(g=0;
g<c.length;
g++){
n=c[g].findObject(m,y);
if(!n){
continue
}
if(n.index>=f){
break
}
b=n;
f=n.index;
d=c[g]
}}
if(a=="email"||m instanceof AjxEmailAddress){
if(d){
m=this._getAjxEmailAddress(m);
this.generateSpan(d,r,l,m,null)
}else{
r[l++]=AjxStringUtil.htmlEncode(m.toString())
}
return r.join("")
}}else{
for(var p=0;
p<this._allObjectHandlers.length;
p++){
var t=this._allObjectHandlers[p];
n=t.findObject(m,y);
if(n&&n.index<f){
b=n;
f=n.index;
d=t
}}}
if(!b){
s=m.substring(y,h);
if(e){
r[l++]=AjxStringUtil.htmlEncode(s,!!u)
}else{
r[l++]=s
}
break
}
if(f>y){
s=m.substring(y,f);
if(e){
r[l++]=AjxStringUtil.htmlEncode(s,!!u)
}else{
r[l++]=s
}}
if(d){
l=this.generateSpan(d,r,l,b[0],b.context)
}else{
r[l++]=b[0]
}
y=b.index+(b.matchLength||b[0].length)
}
return r.join("")
};
ZmObjectManager.prototype.processObjectsInNode=function(s,n){
var e=this;
var a=s.createElement("div");
s||(s=n.ownerDocument);
var o=function(l,c){
var u,m,h,p;
switch(l.nodeType){
case 1:l.normalize();
u=l.tagName.toLowerCase();
if(p==null){
if(/^(img|a)$/.test(u)){
if(u=="a"&&l.target&&(ZmMailMsgView._URL_RE.test(l.href)||ZmMailMsgView._MAILTO_RE.test(l.href))){
var f=RegExp.$1;
u=s.createElement("div");
u.innerHTML=e.findObjects(AjxStringUtil.trim(RegExp.$1));
u=u.firstChild;
if(u.nodeType==3){
return u.nextSibling
}
l.parentNode.insertBefore(u,l);
u.innerHTML="";
u.appendChild(l);
return u.nextSibling
}
c=false
}}else{
l=p
}
if(parseFloat(l.style.textIndent)<0){
l.style.textIndent=""
}
for(m=l.firstChild;
m;
m=o(m,c)){}
return l.nextSibling;
case 3:case 4:if(c&&/[^\s\xA0]/.test(l.data)){
try{
var v=null,y=null;
if(!AjxEnv.isIE){
var d=/^[\s\xA0]+/.exec(l.data);
if(d){
v=l;
l=l.splitText(d[0].length)
}
d=/[\s\xA0]+$/.exec(l.data);
if(d){
y=l.splitText(l.data.length-d[0].length)
}}
u=a;
var r=e.findObjects(l.data,true,null,false);
var w=false;
if(AjxEnv.isIE){
u.innerHTML=["<pre>",r,"</pre>"].join("");
w=true
}else{
u.innerHTML=r
}
if(v){
u.insertBefore(v,u.firstChild)
}
if(y){
u.appendChild(y)
}
v=l.parentNode;
if(w){
u=u.firstChild
}
while(u.firstChild){
v.insertBefore(u.firstChild,l)
}
u=l.nextSibling;
v.removeChild(l);
return u
}
catch(g){}}}
return l.nextSibling
};
for(var t=0;
t<n.childNodes.length;
t++){
o(n.childNodes[t],true)
}};
ZmObjectManager.prototype.findObjectsInNode=function(a,t,n,s){
var o=this,h=a.ownerDocument,l=h.createElement("div");
if(!t){
t=/^(script|link|object|iframe|applet)$/i
}
var e=function(u,m){
var p,g,d,w;
switch(u.nodeType){
case 1:u.normalize();
p=u.tagName.toLowerCase();
if(s&&s.foreachElement){
w=s.foreachElement(u,p,t,n)
}
if(w==null){
if(/^(img|a)$/.test(p)){
if(p=="a"&&u.target&&(ZmMailMsgView._URL_RE.test(u.href)||ZmMailMsgView._MAILTO_RE.test(u.href))){
var y=RegExp.$1;
p=h.createElement("div");
p.innerHTML=o.findObjects(AjxStringUtil.trim(RegExp.$1));
p=p.firstChild;
if(p.nodeType==3){
return p.nextSibling
}
u.parentNode.insertBefore(p,u);
p.innerHTML="";
p.appendChild(u);
return p.nextSibling
}
m=false
}else{
if(t.test(p)||(n&&!n.test(p))){
p=u.nextSibling;
u.parentNode.removeChild(u);
return p
}}}else{
u=w
}
if(AjxEnv.isIE){
u.style.cssText=u.style.cssText
}
for(g=u.firstChild;
g;
g=e(g,m)){}
return u.nextSibling;
case 3:case 4:if(m&&/[^\s\xA0]/.test(u.data)){
try{
var q=null,k=null;
if(!AjxEnv.isIE){
var f=/^[\s\xA0]+/.exec(u.data);
if(f){
q=u;
u=u.splitText(f[0].length)
}
f=/[\s\xA0]+$/.exec(u.data);
if(f){
k=u.splitText(u.data.length-f[0].length)
}}
p=l;
var c=o.findObjects(u.data,true,null,false);
var x=false;
if(AjxEnv.isIE){
p.innerHTML=["<pre>",c,"</pre>"].join("");
x=true
}else{
p.innerHTML=c
}
if(q){
p.insertBefore(q,p.firstChild)
}
if(k){
p.appendChild(k)
}
q=u.parentNode;
if(x){
p=p.firstChild
}
while(p.firstChild){
q.insertBefore(p.firstChild,u)
}
p=u.nextSibling;
q.removeChild(u);
return p
}
catch(v){}}}
return u.nextSibling
};
var r=h.createDocumentFragment();
while(a.firstChild){
r.appendChild(a.firstChild);
e(r.lastChild,true,this)
}
a.appendChild(r)
};
ZmObjectManager.prototype.findMatch=function(r,h){
if(!r){
return""
}
var a=r.length;
var s=0;
var l=null;
var e=a;
var c=null;
var n;
var u=null;
if(h){
var t=this.getHandlers()[h];
if(t){
for(n=0;
n<t.length;
n++){
u=t[n].findObject(r,s);
if(!u){
continue
}
if(u.index>=e){
break
}
l=u;
e=u.index;
c=t[n]
}}}else{
for(var o=0;
o<this._allObjectHandlers.length;
o++){
var d=this._allObjectHandlers[o];
u=d.findObject(r,s);
if(u&&u.index<e){
l=u;
e=u.index;
c=d
}}}
return l
};
ZmObjectManager.prototype.processHtmlNode=function(l,h,y,u){
var w=l.ownerDocument;
h=h!=null?h:true;
var r=y instanceof RegExp?y:null;
if(!r){
y=y||["script","link","object","style","applet","iframe"];
y=y instanceof Array?y:[y];
r=new RegExp("^("+y.join("|")+")$","i")
}
var m=u instanceof RegExp?u:null;
if(!m&&u){
u=u instanceof Array?u:[u];
m=new RegExp("^("+u.join("|")+")$","i")
}
var f,c,v;
switch(l.nodeType){
case 1:l.normalize();
f=l.tagName.toLowerCase();
if(/^(img|a)$/.test(f)){
if(f=="a"&&(ZmMailMsgView._URL_RE.test(l.href)||ZmMailMsgView._MAILTO_RE.test(l.href))){
var n=RegExp.$1;
f=w.createElement("div");
f.innerHTML=this.findObjects(AjxStringUtil.trim(RegExp.$1));
f=f.firstChild;
if(f.nodeType==3){
return f.nextSibling
}
l.parentNode.insertBefore(f,l);
f.innerHTML="";
f.appendChild(l);
return f.nextSibling
}
h=false
}else{
if(r.test(f)){
f=l.nextSibling;
l.parentNode.removeChild(l);
return f
}else{
if(m&&m.test(f)){
f=l.nextSibling;
var e=w.createDocumentFragment();
for(var o=l.firstChild;
o;
o=o.nextSibling){
e.appendChild(o)
}
l.parentNode.replaceChild(e,l);
return f
}else{
if(f=="style"){
return l.nextSibling
}}}}
if(AjxEnv.isIE){
l.style.cssText=l.style.cssText
}
var o=l.firstChild;
while(o){
o=this.processHtmlNode(o,h,r,m)
}
return l.nextSibling;
case 3:case 4:if(h&&/[^\s\xA0]/.test(l.data)){
try{
var g=null,p=null;
if(!AjxEnv.isIE){
if(/^[\s\xA0]+/.test(l.data)){
g=l;
l=l.splitText(RegExp.lastMatch.length)
}
if(/[\s\xA0]+$/.test(l.data)){
p=l.splitText(l.data.length-RegExp.lastMatch.length)
}}
f=w.createElement("div");
var t=this.findObjects(l.data,true,null,false);
var s=false;
if(AjxEnv.isIE){
f.innerHTML=["<pre>",t,"</pre>"].join("");
s=true
}else{
f.innerHTML=t
}
if(g){
f.insertBefore(g,f.firstChild)
}
if(p){
f.appendChild(p)
}
g=l.parentNode;
if(s){
f=f.firstChild
}
while(f.firstChild){
g.insertBefore(f.firstChild,l)
}
f=l.nextSibling;
g.removeChild(l);
return f
}
catch(d){}}}
return l.nextSibling
};
ZmObjectManager.prototype.setHandlerAttr=function(o,t,n){
var e=this.getHandlers()[o];
if(e){
for(var a=0;
a<e.length;
a++){
e[a][t]=n
}}};
ZmObjectManager.prototype.generateSpan=function(o,a,e,n,t){
var s=this._objectIdPrefix+Dwt.getNextId();
this._objects[s]={
object:n,handler:o,id:s,context:t};
return o.generateSpan(a,e,n,s,t)
};
ZmObjectManager.prototype._findObjectSpan=function(t){
while(t&&(!t.id||t.id.indexOf(this._objectIdPrefix)!==0)){
t=t.parentNode
}
return t
};
ZmObjectManager.prototype._mouseOverListener=function(n){
var o=this._findObjectSpan(n.target);
if(!o){
return false
}
var e=this._objects[o.id];
if(!e){
return false
}
o.className=e.handler.getHoveredClassName(e.object,e.context);
if(e.handler.hasToolTipText()){
var a=DwtShell.getShell(window);
var t=a.getHoverMgr();
if((!t.isHovering()||t.getHoverObject()!=e)&&!DwtMenu.menuShowing()){
t.reset();
t.setHoverOverDelay(ZmObjectManager._TOOLTIP_DELAY);
t.setHoverObject(e);
t.setHoverOverData(e);
t.setHoverOverListener(this._hoverOverListener);
t.hoverOver(n.docX,n.docY)
}}
n._returnValue=true;
n._dontCallPreventDefault=true;
return false
};
ZmObjectManager.prototype._mouseOutListener=function(n){
var o=this._findObjectSpan(n.target);
var e=o?this._objects[o.id]:null;
if(e){
o.className=e.handler.getClassName(e.object,e.context);
var a=DwtShell.getShell(window);
var t=a.getHoverMgr();
t.setHoverOutDelay(0);
t.setHoverOutData(e);
t.setHoverOutListener(this._hoverOutListener);
t.hoverOut()
}
return false
};
ZmObjectManager.prototype._mouseMoveListener=function(n){
n._returnValue=true;
n._dontCallPreventDefault=true;
n._stopPropagation=true;
var o=this._findObjectSpan(n.target);
var e=o?this._objects[o.id]:null;
if(e){
var a=DwtShell.getShell(window);
var t=a.getHoverMgr();
if(!t.isHovering()){
t.hoverOver(n.docX,n.docY)
}}
return false
};
ZmObjectManager.prototype._rightClickListener=function(e){
e.button=DwtMouseEvent.RIGHT;
return this._mouseDownListener(e)
};
ZmObjectManager.prototype._mouseDownListener=function(s){
s._dontCallPreventDefault=true;
s._returnValue=true;
s._stopPropagation=false;
var n=this._findObjectSpan(s.target);
if(!n){
return true
}
var t=this._objects[n.id];
if(!t){
return true
}
s._stopPropagation=true;
var o=DwtShell.getShell(window);
var a=o.getHoverMgr();
a.setHoverOutDelay(0);
a.setHoverOutData(t);
a.setHoverOutListener(this._hoverOutListener);
a.hoverOut();
n.className=t.handler.getActiveClassName(t.object,t.context);
if(s.button==DwtMouseEvent.RIGHT){
var e=(this._view instanceof DwtDialog);
var r=t.handler.getActionMenu(t.object,n,t.context,e);
if(r){
r.popup(0,s.docX,s.docY);
s._dontCallPreventDefault=false;
s._returnValue=false;
s._stopPropagation=true;
return true
}}else{
if(s.button==DwtMouseEvent.LEFT){
if(this._selectCallback){
this._selectCallback.run()
}
t.handler.selected(t.object,n,s,t.context);
return true
}}
return false
};
ZmObjectManager.prototype._mouseUpListener=function(a){
a._returnValue=true;
a._dontCallPreventDefault=true;
a._stopPropagation=true;
var t=this._findObjectSpan(a.target);
if(!t){
return false
}
var e=this._objects[t.id];
if(!e){
return false
}
t.className=e.handler.getHoveredClassName(e.object,e.context);
return false
};
ZmObjectManager.prototype._handleHoverOver=function(s){
if(!(s&&s.object)){
return
}
var n=this._findObjectSpan(s.target);
var o=s.object.handler;
var t=s.object.object;
var a=s.object.context;
var e=s.x;
var r=s.y;
o.hoverOver(t,a,e,r,n)
};
ZmObjectManager.prototype._handleHoverOut=function(n){
if(!(n&&n.object)){
return
}
var o=this._findObjectSpan(n.target);
var a=n.object.handler;
var e=n.object.object;
var t=n.object.context;
a.hoverOut(e,t,o)
};
ZmObjectManager.__byPriority=function(t,e){
return(e._prio<t._prio)-(t._prio<e._prio)
}
}
if(AjxPackage.define("zimbraMail.share.model.ZmSettings")){
ZmSettings=function(e){
ZmModel.call(this,ZmEvent.S_SETTINGS);
this._settings={};
this._nameToId={};
this.getInfoResponse=null;
if(!e){
this.initialize()
}};
ZmSettings.prototype=new ZmModel;
ZmSettings.prototype.constructor=ZmSettings;
ZmSettings.prototype.registerSetting=function(a,t){
ZmSetting[a]=a;
var e=this._settings[a]=new ZmSetting(a,t);
if(t.name){
this._nameToId[t.name]=a
}
return e
};
ZmSettings.prototype.toString=function(){
return"ZmSettings"
};
ZmSettings.prototype.initialize=function(){
this._initialize();
this._setDefaults();
this.userSettingsLoaded=false;
var e=new AjxListener(this,this._changeListener);
this.getSetting(ZmSetting.QUOTA_USED).addChangeListener(e);
this.getSetting(ZmSetting.POLLING_INTERVAL).addChangeListener(e);
this.getSetting(ZmSetting.SKIN_NAME).addChangeListener(e);
this.getSetting(ZmSetting.LOCALE_NAME).addChangeListener(e);
this.getSetting(ZmSetting.SHORTCUTS).addChangeListener(e);
this.getSetting(ZmSetting.CHILD_ACCTS_VISIBLE).addChangeListener(e)
};
ZmSettings.prototype.get=function(t,e){
return(t&&this._settings[t])?this._settings[t].getValue(e):null
};
ZmSettings.prototype.getSetting=function(e){
return this._settings[e]
};
ZmSettings.prototype.createFromJs=function(r){
for(var a in r){
var h=r[a];
var o=this._settings[this._nameToId[a]];
if(o){
if(o.dataType==ZmSetting.D_HASH){
var s=h.split(",");
var n={};
for(var t=0;
t<s.length;
t++){
var e=s[t].split(":");
n[e[0]]=e[1]
}
h=n
}
o.setValue(h,null,false,false,true);
if(ZmSetting.IS_IMPLICIT[o.id]){
o.origValue=o.getValue(null,false)
}}else{}}};
ZmSettings.prototype.getSettingByName=function(e){
return this._nameToId[e]
};
ZmSettings.prototype.loadUserSettings=function(l,n,h,o,e,t){
var s=[l,h,e];
if(t){
var r=AjxSoapDoc.create("GetInfoRequest","urn:zimbraAccount");
var c=new AjxCallback(this,this._handleResponseLoadUserSettings,s);
t.addNewRequestParams(r,c)
}else{
var a={
soapDoc:(o?null:AjxSoapDoc.create("GetInfoRequest","urn:zimbraAccount")),accountName:h,asyncMode:true,callback:(new AjxCallback(this,this._handleResponseLoadUserSettings,s)),errorCallback:n,response:o};
appCtxt.getAppController().sendRequest(a)
}};
ZmSettings.prototype._handleResponseLoadUserSettings=function(l,h,e,d){
var o=this.getInfoResponse=d.getResponse().GetInfoResponse;
if(o.name){
this._settings[ZmSetting.USERNAME].setValue(o.name)
}
if(o.lifetime){
this._settings[ZmSetting.TOKEN_LIFETIME].setValue(o.lifetime)
}
if(o.accessed){
this._settings[ZmSetting.LAST_ACCESS].setValue(o.accessed)
}
if(o.prevSession){
this._settings[ZmSetting.PREVIOUS_SESSION].setValue(o.prevSession)
}
if(o.recent){
this._settings[ZmSetting.RECENT_MESSAGES].setValue(o.recent)
}
if(o.used){
this._settings[ZmSetting.QUOTA_USED].setValue(o.used)
}
if(o.rest){
this._settings[ZmSetting.REST_URL].setValue(o.rest)
}
if(o.license){
this._settings[ZmSetting.LICENSE_STATUS].setValue(o.license.status)
}
if(o.prefs&&o.prefs._attrs){
this.createFromJs(o.prefs._attrs)
}
if(o.attrs&&o.attrs._attrs){
this.createFromJs(o.attrs._attrs)
}
if(e){
for(var n in e){
this.createFromJs(e[n])
}}
if(!h){
appCtxt.accountList.createAccounts(this,o);
if(appCtxt.isOffline&&AjxEnv.isPrism&&window.platform&&(AjxEnv.isMac||AjxEnv.isWindows)){
var c=this._settings[ZmSetting.OFFLINE_SUPPORTS_MAILTO];
if(c){
c.setValue(true)

}
c=this._settings[ZmSetting.OFFLINE_SUPPORTS_DOCK_UPDATE];
if(c){
c.setValue(true)
}
c=this._settings[ZmSetting.OFFLINE_IS_MAILTO_HANDLER];
try{
if(c&&!window.platform.isRegisteredProtocolHandler("mailto")){
c.setValue(false)
}}
catch(s){
c=this._settings[ZmSetting.OFFLINE_SUPPORTS_MAILTO];
c.setValue(false)
}}}
if(o.changePasswordURL){
c=this._settings[ZmSetting.CHANGE_PASSWORD_URL];
c.setValue(o.changePasswordURL)
}
if(o.publicURL){
c=this._settings[ZmSetting.PUBLIC_URL];
c.setValue(o.publicURL)
}
var c=this._settings[ZmSetting.REPLY_TO_ADDRESS];
if(c){
c.defaultValue=this.get(ZmSetting.USERNAME)
}
if(!this.get(ZmSetting.SEARCH_ENABLED)){
c=this._settings[ZmSetting.BROWSE_ENABLED];
if(c){
c.setValue(false,null,true)
}}
if(this.get(ZmSetting.FORCE_CAL_OFF)){
c=this._settings[ZmSetting.CALENDAR_ENABLED];
if(c){
c.setValue(false,null,true)
}}
if(!this.get(ZmSetting.OPTIONS_ENABLED)){
c=this._settings[ZmSetting.FILTERS_ENABLED];
if(c){
c.setValue(false,null,true)
}}
if(!h){
if(o.zimlets&&o.zimlets.zimlet){
var a=o.zimlets.zimlet;
for(var n=0;
n<a.length;
n++){
var r=a[n];
if(r.zimlet[0].name=="com_zimbra_usagetracker"){
DwtControl.globalSelectionListener=new AjxListener(null,ZmZimbraMail.globalButtonListener);
break
}}
var t=new AjxListener(this,function(){
var u=new AjxCallback(this,this._loadZimlets,[o.zimlets.zimlet,o.props.prop]);
AjxDispatcher.require("Zimlet",false,u)
}
);
appCtxt.getAppController().addListener(ZmAppEvent.POST_STARTUP,t)
}else{
appCtxt.allZimletsLoaded()
}}
this.userSettingsLoaded=true;
if(l){
l.run(d)
}};
ZmSettings.prototype._loadZimlets=function(r,d){
r=r||[];
this.registerSetting("ZIMLETS",{
type:ZmSetting.T_CONFIG,defaultValue:r,isGlobal:true}
);
this.registerSetting("USER_PROPS",{
type:ZmSetting.T_CONFIG,defaultValue:d}
);
var o=[];
var l=appCtxt.get(ZmSetting.CHECKED_ZIMLETS)||[];
for(var s=0;
s<r.length;
s++){
var m=r[s];
var t=m.zimlet[0];
if(!l||l.length<=0||(","+l.join(",")+",").indexOf(","+t.name+",")>=0){
o.push(m)
}}
var a=appCtxt.getZimletMgr();
a.loadZimlets(o,d);
if(o&&o.length){
var e=appCtxt.getCurrentApp();
if(e){
var p;
if(appCtxt.multiAccounts){
var h=e.getOverviewContainer().containerId;
var f=ZmOrganizer.LABEL[ZmOrganizer.ZIMLET];
var n=[h,f].join("_");
p=appCtxt.getOverviewController().getOverview(n)
}else{
p=e.getOverview()
}}
if(p){
p.setTreeView(ZmOrganizer.ZIMLET);
if(appCtxt.multiAccounts&&a.getPanelZimlets().length==0){
e.getOverviewContainer().removeZimletSection()
}}
if(appCtxt.get(ZmSetting.PORTAL_ENABLED)){
var c=appCtxt.getApp(ZmApp.PORTAL).getPortletMgr();
var u=c.createPortlets(true)
}}};
ZmSettings.prototype.loadPreferenceData=function(h){
var r=new ZmBatchCommand(null,appCtxt.accountList.mainAccount.name);
var s=AjxSoapDoc.create("GetAvailableSkinsRequest","urn:zimbraAccount");
var n=new AjxCallback(this,this._handleResponseLoadAvailableSkins);
r.addNewRequestParams(s,n);
var e=AjxSoapDoc.create("GetAvailableLocalesRequest","urn:zimbraAccount");
var o=new AjxCallback(this,this._handleResponseGetAllLocales);
r.addNewRequestParams(e,o);
var t=AjxSoapDoc.create("GetAvailableCsvFormatsRequest","urn:zimbraAccount");
var a=new AjxCallback(this,this._handleResponseGetAvailableCsvFormats);
r.addNewRequestParams(t,a);
r.run(h)
};
ZmSettings.prototype._handleResponseLoadAvailableSkins=function(e){
var n=e.getResponse().GetAvailableSkinsResponse;
var o=n.skin;
if(o&&o.length){
var a=appCtxt.accountList.mainAccount.settings.getSetting(ZmSetting.AVAILABLE_SKINS);
for(var t=0;
t<o.length;
t++){
a.setValue(o[t].name)
}}};
ZmSettings.prototype._handleResponseGetAllLocales=function(a){
var t=a._data.GetAvailableLocalesResponse.locale;
if(t&&t.length){
for(var o=0,n=t.length;
o<n;
o++){
var e=t[o];
e.id=e.id.replace(/^in/,"id");
ZmLocale.create(e.id,e.name)
}
this.getSetting(ZmSetting.LOCALE_CHANGE_ENABLED).setValue(ZmLocale.hasChoices())
}};
ZmSettings.prototype._handleResponseGetAvailableCsvFormats=function(a){
var t=a.getResponse().GetAvailableCsvFormatsResponse.csv;
var n=appCtxt.accountList.mainAccount.settings.getSetting(ZmSetting.AVAILABLE_CSVFORMATS);
if(t&&t.length){
var e;
for(var o=0;
o<t.length;
o++){
n.setValue(t[o].name)
}}};
ZmSettings.prototype.save=function(d,f,o,a){
if(!(d&&d.length)){
return
}
var u=AjxSoapDoc.create("ModifyPrefsRequest","urn:zimbraAccount");
var n=false;
var t=[];
for(var c=0;
c<d.length;
c++){
var g=d[c];
if(g.type==ZmSetting.T_METADATA){
t.push(g);
continue
}else{
if(g.type!=ZmSetting.T_PREF){
continue
}}
if(!g.name){
continue
}
if(g.dataType==ZmSetting.D_LIST){
var m=g.getValue();
if(m&&m.length){
for(var r=0;
r<m.length;
r++){
var s=u.set("pref",m[r]);
s.setAttribute("name",g.name)
}}else{
var s=u.set("pref","");
s.setAttribute("name",g.name)
}}else{
var m=g.getValue(null,true);
var s=u.set("pref",m);
s.setAttribute("name",g.name)
}
n=true
}
if(t.length>0){
var l=new AjxCallback(this,this._handleResponseSaveMetaData,[t]);
for(var c=0;
c<t.length;
c++){
var h=t[c];
appCtxt.getMetaData().set(h.section,h.name,h.value,o,l)
}}
if(n){
var p;
var e=false;
if(f||o){
p=new AjxCallback(this,this._handleResponseSave,[d,f]);
e=true
}
if(o){
o.addNewRequestParams(u,p)
}else{
appCtxt.getAppController().sendRequest({
soapDoc:u,asyncMode:e,callback:p,accountName:a}
)
}}};
ZmSettings.prototype._handleResponseSaveMetaData=function(o,e){
for(var t=0;
t<o.length;
t++){
var a=o[t];
a.origValue=a.getValue(null,false);
a._notify(ZmEvent.E_MODIFY)
}};
ZmSettings.prototype._handleResponseSave=function(o,s,e){
var n=e.getResponse();
if(n.ModifyPrefsResponse!=null){
for(var t=0;
t<o.length;
t++){
var a=o[t];
a.origValue=a.getValue(null,false);
a._notify(ZmEvent.E_MODIFY)
}
this._notify(ZmEvent.E_MODIFY,{
settings:o}
)
}
if(s){
s.run(e)
}};
ZmSettings.prototype._setDefaults=function(){
var e=AjxUtil.formatUrl({
host:location.hostname,path:"/service/soap/",qsReset:true}
);
this._settings[ZmSetting.CSFE_SERVER_URI].setValue(e,null,false,true);
e=AjxUtil.formatUrl({
host:location.hostname,path:"/service/home/~/",qsReset:true,qsArgs:{
auth:"co"}}
);
this._settings[ZmSetting.CSFE_MSG_FETCHER_URI].setValue(e,null,false,true);
e=AjxUtil.formatUrl({
host:location.hostname,path:"/service/upload",qsReset:true,qsArgs:{
lbfums:""}}
);
this._settings[ZmSetting.CSFE_UPLOAD_URI].setValue(e,null,false,true);
e=AjxUtil.formatUrl({
host:location.hostname,path:"/service/upload",qsReset:true}
);
this._settings[ZmSetting.CSFE_ATTACHMENT_UPLOAD_URI].setValue(e,null,false,true);
e=AjxUtil.formatUrl({
host:location.hostname,path:"/service/home/~/",qsReset:true,qsArgs:{
auth:"co",id:"{0}",fmt:"csv"}}
);
this._settings[ZmSetting.CSFE_EXPORT_URI].setValue(e,null,false,true);
this._settings[ZmSetting.SORTING_PREF].setValue(ZmSearch.DATE_DESC,ZmId.VIEW_CONVLIST,true,true);
this._settings[ZmSetting.SORTING_PREF].setValue(ZmSearch.DATE_DESC,ZmId.VIEW_CONV,true,true);
this._settings[ZmSetting.SORTING_PREF].setValue(ZmSearch.DATE_DESC,ZmId.VIEW_TRAD,true,true);
this._settings[ZmSetting.SORTING_PREF].setValue(ZmSearch.NAME_ASC,ZmId.VIEW_CONTACT_SRC,true,true);
this._settings[ZmSetting.SORTING_PREF].setValue(ZmSearch.NAME_ASC,ZmId.VIEW_CONTACT_TGT,true,true);
this._settings[ZmSetting.SORTING_PREF].setValue(ZmSearch.NAME_ASC,ZmId.VIEW_CONTACT_SIMPLE,true,true);
this._settings[ZmSetting.SORTING_PREF].setValue(ZmSearch.NAME_ASC,ZmId.VIEW_CONTACT_CARDS,true,true);
this._settings[ZmSetting.SORTING_PREF].setValue(ZmSearch.DATE_ASC,ZmId.VIEW_CAL,true,true);
this._settings[ZmSetting.SORTING_PREF].setValue(ZmSearch.DUE_DATE_DESC,ZmId.VIEW_TASKLIST,true,true)
};
ZmSettings.prototype._initialize=function(){
this.registerSetting("AC_TIMER_INTERVAL",{
type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_INT,defaultValue:300}
);
this.registerSetting("ASYNC_MODE",{
type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("BRANCH",{
type:ZmSetting.T_CONFIG,defaultValue:"main"}
);
this.registerSetting("CLIENT_DATETIME",{
type:ZmSetting.T_CONFIG,defaultValue:"20091214-1754"}
);
this.registerSetting("CLIENT_RELEASE",{
type:ZmSetting.T_CONFIG,defaultValue:"20091214174341"}
);
this.registerSetting("CLIENT_VERSION",{
type:ZmSetting.T_CONFIG,defaultValue:"6.0.4_GA_2038.RHEL5_64"}
);
this.registerSetting("CONFIG_PATH",{
type:ZmSetting.T_CONFIG,defaultValue:appContextPath+"/js/zimbraMail/config"}
);
this.registerSetting("CSFE_EXPORT_URI",{
type:ZmSetting.T_CONFIG}
);
this.registerSetting("CSFE_MSG_FETCHER_URI",{
type:ZmSetting.T_CONFIG}
);
this.registerSetting("CSFE_SERVER_URI",{
type:ZmSetting.T_CONFIG}
);
this.registerSetting("CSFE_UPLOAD_URI",{
type:ZmSetting.T_CONFIG}
);
this.registerSetting("CSFE_ATTACHMENT_UPLOAD_URI",{
type:ZmSetting.T_CONFIG}
);
this.registerSetting("DEV",{
type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("FORCE_CAL_OFF",{
type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("HELP_URI",{
type:ZmSetting.T_CONFIG,defaultValue:appContextPath+ZmMsg.helpURI}
);
this.registerSetting("HTTP_PORT",{
type:ZmSetting.T_CONFIG,defaultValue:ZmSetting.HTTP_DEFAULT_PORT}
);
this.registerSetting("HTTPS_PORT",{
type:ZmSetting.T_CONFIG,defaultValue:ZmSetting.HTTPS_DEFAULT_PORT}
);
this.registerSetting("INSTANT_NOTIFY_INTERVAL",{
type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_INT,defaultValue:500}
);
this.registerSetting("INSTANT_NOTIFY_TIMEOUT",{
type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_INT,defaultValue:300}
);
this.registerSetting("LOG_REQUEST",{
type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("LOGO_URI",{
type:ZmSetting.T_CONFIG,defaultValue:null}
);
this.registerSetting("PROTOCOL_MODE",{
type:ZmSetting.T_CONFIG,defaultValue:ZmSetting.PROTO_HTTP}
);
this.registerSetting("SERVER_VERSION",{
type:ZmSetting.T_CONFIG}
);
this.registerSetting("TIMEOUT",{
type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_INT,defaultValue:30}
);
this.registerSetting("USE_XML",{
type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("CHANGE_PASSWORD_URL",{
type:ZmSetting.T_CONFIG}
);
this.registerSetting("PUBLIC_URL",{
type:ZmSetting.T_CONFIG}
);
this.registerSetting("ASSISTANT_ENABLED",{
name:"zimbraFeatureZimbraAssistantEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("BRIEFCASE_ENABLED",{
name:"zimbraFeatureBriefcasesEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("CALENDAR_ENABLED",{
name:"zimbraFeatureCalendarEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("CALENDAR_UPSELL_ENABLED",{
name:"zimbraFeatureCalendarUpsellEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("CALENDAR_UPSELL_URL",{
name:"zimbraFeatureCalendarUpsellURL",type:ZmSetting.T_COS}
);
this.registerSetting("CONTACTS_ENABLED",{
name:"zimbraFeatureContactsEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("CONTACTS_UPSELL_ENABLED",{
name:"zimbraFeatureContactsUpsellEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("CONTACTS_UPSELL_URL",{
name:"zimbraFeatureContactsUpsellURL",type:ZmSetting.T_COS}
);
this.registerSetting("IM_ENABLED",{
name:"zimbraFeatureIMEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("IMPORT_EXPORT_ENABLED",{
name:"zimbraFeatureImportExportFolderEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("MAIL_ENABLED",{
name:"zimbraFeatureMailEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("MAIL_UPSELL_ENABLED",{
name:"zimbraFeatureMailUpsellEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("MAIL_UPSELL_URL",{
name:"zimbraFeatureMailUpsellURL",type:ZmSetting.T_COS}
);
this.registerSetting("NOTEBOOK_ENABLED",{
name:"zimbraFeatureNotebookEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("OPTIONS_ENABLED",{
name:"zimbraFeatureOptionsEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("PORTAL_ENABLED",{
name:"zimbraFeaturePortalEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("TASKS_ENABLED",{
name:"zimbraFeatureTasksEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("VOICE_ENABLED",{
name:"zimbraFeatureVoiceEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("VOICE_UPSELL_ENABLED",{
name:"zimbraFeatureVoiceUpsellEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("VOICE_UPSELL_URL",{
name:"zimbraFeatureVoiceUpsellURL",type:ZmSetting.T_COS}
);
this.registerSetting("ATTACHMENTS_BLOCKED",{
name:"zimbraAttachmentsBlocked",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("AVAILABLE_SKINS",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_LIST,isGlobal:true}
);
this.registerSetting("AVAILABLE_CSVFORMATS",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_LIST,isGlobal:true}
);
this.registerSetting("BROWSE_ENABLED",{
name:"zimbraFeatureAdvancedSearchEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("CHANGE_PASSWORD_ENABLED",{
name:"zimbraFeatureChangePasswordEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("DISPLAY_NAME",{
name:"displayName",type:ZmSetting.T_COS}
);
this.registerSetting("FLAGGING_ENABLED",{
name:"zimbraFeatureFlaggingEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("FOLDER_TREE_OPEN",{
name:"zimbraPrefFolderTreeOpen",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isImplicit:true}
);
this.registerSetting("GAL_AUTOCOMPLETE_ENABLED",{
name:"zimbraFeatureGalAutoCompleteEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("GAL_ENABLED",{
name:"zimbraFeatureGalEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("GROUP_CALENDAR_ENABLED",{
name:"zimbraFeatureGroupCalendarEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("HTML_COMPOSE_ENABLED",{
name:"zimbraFeatureHtmlComposeEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("IDLE_SESSION_TIMEOUT",{
name:"zimbraMailIdleSessionTimeout",type:ZmSetting.T_COS,dataType:ZmSetting.D_LDAP_TIME,defaultValue:0}
);
this.registerSetting("IMAP_ACCOUNTS_ENABLED",{
name:"zimbraFeatureImapDataSourceEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("INSTANT_NOTIFY",{
name:"zimbraFeatureInstantNotify",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("LOCALE_CHANGE_ENABLED",{
name:"zimbraFeatureLocaleChangeEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("LOCALES",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_LIST}
);
this.registerSetting("LOGIN_URL",{
name:"zimbraWebClientLoginURL",type:ZmSetting.T_COS}
);
this.registerSetting("LOGOUT_URL",{
name:"zimbraWebClientLogoutURL",type:ZmSetting.T_COS}
);
this.registerSetting("MIN_POLLING_INTERVAL",{
name:"zimbraMailMinPollingInterval",type:ZmSetting.T_COS,dataType:ZmSetting.D_LDAP_TIME,defaultValue:120}
);
this.registerSetting("MOBILE_SYNC_ENABLED",{
name:"zimbraFeatureMobileSyncEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("MOBILE_POLICY_ENABLED",{
name:"zimbraFeatureMobilePolicyEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("POP_ACCOUNTS_ENABLED",{
name:"zimbraFeaturePop3DataSourceEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("PORTAL_NAME",{
name:"zimbraPortalName",type:ZmSetting.T_COS,defaultValue:"example"}
);
this.registerSetting("PWD_MAX_LENGTH",{
name:"zimbraPasswordMaxLength",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:64}
);
this.registerSetting("PWD_MIN_LENGTH",{
name:"zimbraPasswordMinLength",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:6}
);
this.registerSetting("QUOTA",{
name:"zimbraMailQuota",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:0}
);
this.registerSetting("SAVED_SEARCHES_ENABLED",{
name:"zimbraFeatureSavedSearchesEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("SEARCH_TREE_OPEN",{
name:"zimbraPrefSearchTreeOpen",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isImplicit:true}
);
this.registerSetting("SHARING_ENABLED",{
name:"zimbraFeatureSharingEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("SHORTCUT_ALIASES_ENABLED",{
name:"zimbraFeatureShortcutAliasesEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("SHOW_OFFLINE_LINK",{
name:"zimbraWebClientShowOfflineLink",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("SIGNATURES_ENABLED",{
name:"zimbraFeatureSignaturesEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("SKIN_CHANGE_ENABLED",{
name:"zimbraFeatureSkinChangeEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("TAG_TREE_OPEN",{
name:"zimbraPrefTagTreeOpen",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isImplicit:true}
);
this.registerSetting("TAGGING_ENABLED",{
name:"zimbraFeatureTaggingEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("VIEW_ATTACHMENT_AS_HTML",{
name:"zimbraFeatureViewInHtmlEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("LICENSE_STATUS",{
type:ZmSetting.T_COS,defaultValue:ZmSetting.LICENSE_GOOD}
);
this.registerSetting("QUOTA_USED",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_INT}
);
this.registerSetting("TOKEN_LIFETIME",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_INT}
);
this.registerSetting("USERID",{
name:"zimbraId",type:ZmSetting.T_COS}
);
this.registerSetting("USERNAME",{
type:ZmSetting.T_COS}
);
this.registerSetting("CN",{
name:"cn",type:ZmSetting.T_COS}
);
this.registerSetting("LAST_ACCESS",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_INT}
);
this.registerSetting("PREVIOUS_SESSION",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_INT}
);
this.registerSetting("RECENT_MESSAGES",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_INT}
);
this.registerSetting("REST_URL",{
name:"rest",type:ZmSetting.T_COS}
);
this.registerSetting("IS_ADMIN",{
name:"zimbraIsAdminAccount",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("IS_DELEGATED_ADMIN",{
name:"zimbraIsDelegatedAdminAccount",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("ADMIN_REFERENCE",{
name:"zimbraWebClientAdminReference",type:ZmSetting.T_COS,dataType:ZmSetting.D_STRING}
);
this.registerSetting("ATTACHMENT_ENABLED",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("ATT_VIEW_ENABLED",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("EVAL_ENABLED",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("FEED_ENABLED",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("HELP_ENABLED",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("HISTORY_SUPPORT_ENABLED",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("MIXED_VIEW_ENABLED",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("NOTES_ENABLED",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("PRINT_ENABLED",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("SEARCH_ENABLED",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("SHORTCUT_LIST_ENABLED",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("OFFLINE_ENABLED",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:appCtxt.isOffline}
);
this.registerSetting("SPELL_CHECK_ENABLED",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:!AjxEnv.isSafari||AjxEnv.isSafari3up||AjxEnv.isChrome}
);
this.registerSetting("ACCOUNTS",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_HASH}
);
this.registerSetting("ACCOUNT_TREE_OPEN",{
name:"zimbraPrefAccountTreeOpen",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isImplicit:true}
);
this.registerSetting("CHILD_ACCTS_VISIBLE",{
name:"zimbraPrefChildVisibleAccount",type:ZmSetting.T_PREF,dataType:ZmSetting.D_LIST}
);
this.registerSetting("CLIENT_TYPE",{
name:"zimbraPrefClientType",type:ZmSetting.T_PREF,defaultValue:ZmSetting.CLIENT_ADVANCED}
);
this.registerSetting("COMPOSE_AS_FORMAT",{
name:"zimbraPrefComposeFormat",type:ZmSetting.T_PREF,defaultValue:ZmSetting.COMPOSE_TEXT}
);
this.registerSetting("COMPOSE_INIT_FONT_COLOR",{
name:"zimbraPrefHtmlEditorDefaultFontColor",type:ZmSetting.T_PREF,defaultValue:ZmSetting.COMPOSE_FONT_COLOR}
);
this.registerSetting("COMPOSE_INIT_FONT_FAMILY",{
name:"zimbraPrefHtmlEditorDefaultFontFamily",type:ZmSetting.T_PREF,defaultValue:ZmSetting.COMPOSE_FONT_FAM}
);
this.registerSetting("COMPOSE_INIT_FONT_SIZE",{
name:"zimbraPrefHtmlEditorDefaultFontSize",type:ZmSetting.T_PREF,defaultValue:ZmSetting.COMPOSE_FONT_SIZE}
);
this.registerSetting("DEFAULT_TIMEZONE",{
name:"zimbraPrefTimeZoneId",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:AjxTimezone.getServerId(AjxTimezone.DEFAULT),isGlobal:true}
);
this.registerSetting("FILTERS",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_HASH}
);
this.registerSetting("IDENTITIES",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_HASH}
);
this.registerSetting("INITIALLY_SEARCH_GAL",{
name:"zimbraPrefGalSearchEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("LIST_VIEW_COLUMNS",{
name:"zimbraPrefListViewColumns",type:ZmSetting.T_PREF,dataType:ZmSetting.D_HASH,isImplicit:true}
);
this.registerSetting("LOCALE_NAME",{
name:"zimbraPrefLocale",type:ZmSetting.T_PREF,defaultValue:"en_US",isGlobal:true}
);
this.registerSetting("SHOW_SELECTION_CHECKBOX",{
name:"zimbraPrefShowSelectionCheckbox",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,isGlobal:true}
);
this.registerSetting("PAGE_SIZE",{
type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_INT,defaultValue:25}
);
this.registerSetting("PASSWORD",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_NONE}
);
this.registerSetting("POLLING_INTERVAL",{
name:"zimbraPrefMailPollingInterval",type:ZmSetting.T_PREF,dataType:ZmSetting.D_LDAP_TIME,defaultValue:300}
);
this.registerSetting("POLLING_INTERVAL_ENABLED",{
name:"zimbraFeatureMailPollingIntervalPreferenceEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("SEARCH_INCLUDES_SPAM",{
name:"zimbraPrefIncludeSpamInSearch",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true}
);
this.registerSetting("SEARCH_INCLUDES_TRASH",{
name:"zimbraPrefIncludeTrashInSearch",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true}
);
this.registerSetting("SHORTCUTS",{
name:"zimbraPrefShortcuts",type:ZmSetting.T_PREF}
);
this.registerSetting("SHOW_SEARCH_STRING",{
name:"zimbraPrefShowSearchString",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true}
);
this.registerSetting("SIGNATURES",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_HASH}
);
this.registerSetting("SIGNATURES_MAX",{
name:"zimbraSignatureMaxNumEntries",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:20}
);
this.registerSetting("SIGNATURES_MIN",{
name:"zimbraSignatureMinNumEntries",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:1}
);
this.registerSetting("SKIN_NAME",{
name:"zimbraPrefSkin",type:ZmSetting.T_PREF,defaultValue:"skin",isGlobal:true}
);
this.registerSetting("SORTING_PREF",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_HASH}
);
this.registerSetting("USE_KEYBOARD_SHORTCUTS",{
name:"zimbraPrefUseKeyboardShortcuts",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("VIEW_AS_HTML",{
name:"zimbraPrefMessageViewHtmlPreferred",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true}
);
this.registerSetting("VOICE_ACCOUNTS",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_HASH}
);
this.registerSetting("WARN_ON_EXIT",{
name:"zimbraPrefWarnOnExit",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this._registerOfflineSettings();
this._registerZimletsSettings();
this.registerSetting("ZIMLET_TREE_OPEN",{
name:"zimbraPrefZimletTreeOpen",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isImplicit:true}
)
};
ZmSettings.prototype._registerZimletsSettings=function(){
this.registerSetting("CHECKED_ZIMLETS",{
name:"zimbraPrefZimlets",type:ZmSetting.T_PREF,dataType:ZmSetting.D_LIST,isGlobal:true}
)
};
ZmSettings.prototype._registerOfflineSettings=function(){
if(!appCtxt.isOffline){
return
}
this.registerSetting("OFFLINE_ACCOUNT_FLAVOR",{
name:"offlineAccountFlavor",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING}
);
this.registerSetting("OFFLINE_COMPOSE_ENABLED",{
type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true}
);
this.registerSetting("OFFLINE_DEBUG_TRACE",{
type:ZmSetting.T_CONFIG,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
this.registerSetting("OFFLINE_IS_MAILTO_HANDLER",{
name:"zimbraPrefMailtoHandlerEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true}
);
this.registerSetting("OFFLINE_REMOTE_SERVER_URI",{
name:"offlineRemoteServerUri",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING}
);
this.registerSetting("OFFLINE_REPORT_EMAIL",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:"zdesktop-report@zimbra.com",isGlobal:true}
);
this.registerSetting("OFFLINE_SHOW_GLOBAL_INBOX",{
name:"offlineShowGlobalInbox",type:ZmSetting.T_METADATA,dataType:ZmSetting.D_BOOLEAN,defaultValue:true,section:ZmSetting.M_OFFLINE,isGlobal:true}
);
this.registerSetting("OFFLINE_SMTP_ENABLED",{
name:"zimbraDataSourceSmtpEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
this.registerSetting("OFFLINE_SUPPORTS_MAILTO",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true}
);
this.registerSetting("OFFLINE_SUPPORTS_DOCK_UPDATE",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true}
);
this.registerSetting("OFFLINE_WEBAPP_URI",{
name:"offlineWebappUri",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING}
);
this.registerSetting("HELP_URI",{
type:ZmSetting.T_CONFIG,defaultValue:"http://www.zimbra.com/desktop/"}
)
};
ZmSettings.prototype._changeListener=function(e){
if(e.type!=ZmEvent.S_SETTING){
return
}
var o=e.source.id;
if(o==ZmSetting.QUOTA_USED){
appCtxt.getAppController().setUserInfo()
}else{
if(o==ZmSetting.POLLING_INTERVAL){
appCtxt.getAppController().setPollInterval()
}else{
if(o==ZmSetting.SKIN_NAME){
var a=appCtxt.getYesNoMsgDialog();
a.reset();
var t=e.source.getValue();
a.registerCallback(DwtDialog.YES_BUTTON,this._newSkinYesCallback,this,[t,a]);
a.setMessage(ZmMsg.skinChangeRestart,DwtMessageDialog.WARNING_STYLE);
a.popup()
}else{
if(o==ZmSetting.LOCALE_NAME){
var a=appCtxt.getYesNoMsgDialog();
a.reset();
var t=e.source.getValue();
a.registerCallback(DwtDialog.YES_BUTTON,this._refreshBrowserCallback,this,[a]);
a.setMessage(ZmMsg.localeChangeRestart,DwtMessageDialog.WARNING_STYLE);
a.popup()
}else{
if(o==ZmSetting.CHILD_ACCTS_VISIBLE){
var a=appCtxt.getYesNoMsgDialog();
a.reset();
a.registerCallback(DwtDialog.YES_BUTTON,this._refreshBrowserCallback,this,[a]);
a.setMessage(ZmMsg.accountChangeRestart,DwtMessageDialog.WARNING_STYLE);
a.popup()
}}}}}};
ZmSettings.prototype._newSkinYesCallback=function(a,t){
t.popdown();
window.onbeforeunload=null;
var e=AjxUtil.formatUrl({
qsArgs:{
skin:a}}
);
ZmZimbraMail.sendRedirect(e)
};
ZmSettings.prototype._refreshBrowserCallback=function(t){
t.popdown();
window.onbeforeunload=null;
var e=AjxUtil.formatUrl({}
);
window.location.replace(e)
}
}
if(AjxPackage.define("zimbraMail.share.model.ZmMetaData")){
ZmMetaData=function(){};
ZmMetaData.prototype.constructor=ZmMetaData;
ZmMetaData.NAMESPACE="zwc";
ZmMetaData.prototype.toString=function(){
return"ZmMetaData"
};
ZmMetaData.prototype.set=function(r,l,h,e,c,o){
var s=AjxSoapDoc.create("SetMailboxMetadataRequest","urn:zimbraMail");
var d=s.set("meta");
d.setAttribute("section",[ZmMetaData.NAMESPACE,r].join(":"));
var n=s.set("a",h,d);
n.setAttribute("n",l);
if(e){
e.addNewRequestParams(s,c,o)
}else{
var t={
soapDoc:s,asyncMode:true,callback:c,errorCallback:o,accountName:(appCtxt.multiAccounts?appCtxt.accountList.mainAccount:null)};
appCtxt.getAppController().sendRequest(t)
}};
ZmMetaData.prototype.get=function(l,e,c,o){
if(!(l instanceof Array)){
l=[l]
}
var s=appCtxt.multiAccounts?appCtxt.accountList.mainAccount:null;
var t=e||(new ZmBatchCommand(null,s));
for(var a=0;
a<l.length;
a++){
var r=l[a];
var n=AjxSoapDoc.create("GetMailboxMetadataRequest","urn:zimbraMail");
var h=n.set("meta");
h.setAttribute("section",[ZmMetaData.NAMESPACE,r].join(":"));
t.addNewRequestParams(n)
}
if(!e){
t.run(c,o)
}}
}
if(AjxPackage.define("zimbraMail.share.model.ZmKeyMap")){
ZmKeyMap=function(){
ZmKeyMap._setPreconditions();
DwtKeyMap.call(this);
this._load(this._map,ZmKeys,ZmKeyMap.MAP_NAME);
if(appCtxt.get(ZmSetting.DEV)){
this._map.Global["Alt+Shift+D,0"]=ZmKeyMap.DBG_NONE;
this._map.Global["Alt+Shift+D,1"]=ZmKeyMap.DBG_1;
this._map.Global["Alt+Shift+D,2"]=ZmKeyMap.DBG_2;
this._map.Global["Alt+Shift+D,3"]=ZmKeyMap.DBG_3;
this._map.Global["Alt+Shift+D,T"]=ZmKeyMap.DBG_TIMING
}};
ZmKeyMap.prototype=new DwtKeyMap(true);
ZmKeyMap.prototype.constructor=ZmKeyMap;
ZmKeyMap.MAP_NAME={};
ZmKeyMap.MAP_NAME.briefcase="ZmBriefcaseController";
ZmKeyMap.MAP_NAME.calendar="ZmCalViewController";
ZmKeyMap.MAP_NAME.call="ZmCallListController";
ZmKeyMap.MAP_NAME.compose="ZmComposeController";
ZmKeyMap.MAP_NAME.contacts="ZmContactListController";
ZmKeyMap.MAP_NAME.conversation="ZmConvController";
ZmKeyMap.MAP_NAME.conversationList="ZmConvListController";
ZmKeyMap.MAP_NAME.editAppointment="ZmApptComposeController";
ZmKeyMap.MAP_NAME.editContact="ZmContactController";
ZmKeyMap.MAP_NAME.editPage="ZmPageEditController";
ZmKeyMap.MAP_NAME.editTask="ZmTaskController";
ZmKeyMap.MAP_NAME.global="Global";
ZmKeyMap.MAP_NAME.mail="ZmMailListController";
ZmKeyMap.MAP_NAME.message="ZmMsgController";
ZmKeyMap.MAP_NAME.mixed="ZmMixedController";
ZmKeyMap.MAP_NAME.notebook="ZmNotebookPageController";
ZmKeyMap.MAP_NAME.options="ZmPrefController";
ZmKeyMap.MAP_NAME.tasks="ZmTaskListController";
ZmKeyMap.MAP_NAME.voicemail="ZmVoicemailListController";
ZmKeyMap.MAP_NAME_R={};
(function(){
for(var e in ZmKeyMap.MAP_NAME){
ZmKeyMap.MAP_NAME_R[ZmKeyMap.MAP_NAME[e]]=e
}}
)();
ZmKeyMap.ADDRESS_PICKER="AddressPicker";
ZmKeyMap.ASSISTANT="Assistant";
ZmKeyMap.ATTACHMENT="Attachment";
ZmKeyMap.CAL_DAY_VIEW="DayView";
ZmKeyMap.CAL_LIST_VIEW="CalListView";
ZmKeyMap.CAL_MONTH_VIEW="MonthView";
ZmKeyMap.CAL_SCHEDULE_VIEW="ScheduleView";
ZmKeyMap.CAL_WEEK_VIEW="WeekView";
ZmKeyMap.CAL_WORK_WEEK_VIEW="WorkWeekView";
ZmKeyMap.CALL_MANAGER="CallManager";
ZmKeyMap.CANCEL="Cancel";
ZmKeyMap.COLLAPSE_ALL="CollapseAll";
ZmKeyMap.DBG_NONE="DebugNone";
ZmKeyMap.DBG_1="DebugLevel1";
ZmKeyMap.DBG_2="DebugLevel2";
ZmKeyMap.DBG_3="DebugLevel3";
ZmKeyMap.DBG_TIMING="ToggleDebugTiming";
ZmKeyMap.DEL="Delete";
ZmKeyMap.DOWNLOAD="Download";
ZmKeyMap.EDIT="Edit";
ZmKeyMap.EXPAND="Expand";
ZmKeyMap.EXPAND_ALL="ExpandAll";
ZmKeyMap.FIRST_UNREAD="FirstUnread";
ZmKeyMap.FIRST_UNREAD_MSG="FirstUnreadMsg";
ZmKeyMap.FLAG="Flag";
ZmKeyMap.FOCUS_CONTENT_PANE="FocusContentPane";
ZmKeyMap.FOCUS_SEARCH_BOX="FocusSearchBox";
ZmKeyMap.FOCUS_TOOLBAR="FocusToolbar";
ZmKeyMap.FORWARD="Forward";
ZmKeyMap.GET_MAIL="GetMail";
ZmKeyMap.GOTO_BRIEFCASE="GoToBriefcase";
ZmKeyMap.GOTO_CALENDAR="GoToCalendar";
ZmKeyMap.GOTO_CONTACTS="GoToContacts";
ZmKeyMap.GOTO_DRAFTS="GoToDrafts";
ZmKeyMap.GOTO_JUNK="GoToJunk";
ZmKeyMap.GOTO_INBOX="GoToInbox";
ZmKeyMap.GOTO_MAIL="GoToMail";
ZmKeyMap.GOTO_NOTEBOOK="GoToNotebook";
ZmKeyMap.GOTO_OPTIONS="GoToOptions";
ZmKeyMap.GOTO_SENT="GoToSent";
ZmKeyMap.GOTO_TASKS="GoToTasks";
ZmKeyMap.GOTO_TRASH="GoToTrash";
ZmKeyMap.GOTO_VOICE="GoToVoice";
ZmKeyMap.HTML_FORMAT="HtmlFormat";
ZmKeyMap.LAST_UNREAD="LastUnread";
ZmKeyMap.LAST_UNREAD_MSG="LastUnreadMsg";
ZmKeyMap.LOGOFF="LogOff";
ZmKeyMap.MARK_COMPLETE="MarkComplete";
ZmKeyMap.MARK_HEARD="MarkHeard";
ZmKeyMap.MARK_READ="MarkRead";
ZmKeyMap.MARK_UNCOMPLETE="MarkUncomplete";
ZmKeyMap.MARK_UNHEARD="MarkUnheard";
ZmKeyMap.MARK_UNREAD="MarkUnread";
ZmKeyMap.MOVE="Move";
ZmKeyMap.MOVE_TO_INBOX="MoveToInbox";
ZmKeyMap.MOVE_TO_JUNK="MoveToJunk";
ZmKeyMap.MOVE_TO_TRASH="MoveToTrash";
ZmKeyMap.NEW="New";
ZmKeyMap.NEW_APPT="NewAppointment";
ZmKeyMap.NEW_BRIEFCASEITEM="NewBriefcase";
ZmKeyMap.NEW_CALENDAR="NewCalendar";
ZmKeyMap.NEW_CHAT="NewChat";
ZmKeyMap.NEW_CONTACT="NewContact";
ZmKeyMap.NEW_DOC="NewDocument";
ZmKeyMap.NEW_FILE="NewFile";
ZmKeyMap.NEW_FOLDER="NewFolder";
ZmKeyMap.NEW_MESSAGE="NewMessage";
ZmKeyMap.NEW_MESSAGE_WIN="NewMessageWindow";
ZmKeyMap.NEW_NOTEBOOK="NewNotebook";
ZmKeyMap.NEW_PAGE="NewPage";
ZmKeyMap.NEW_PRESENTATION="NewPresentation";
ZmKeyMap.NEW_ROSTER_ITEM="NewRosterItem";
ZmKeyMap.NEW_SPREADSHEET="NewSpreadsheet";
ZmKeyMap.NEW_TAG="NewTag";
ZmKeyMap.NEW_TASK="NewTask";
ZmKeyMap.NEW_WINDOW="NewWindow";
ZmKeyMap.NEXT_CONV="NextConversation";
ZmKeyMap.NEXT_PAGE="NextPage";
ZmKeyMap.NEXT_UNREAD="NextUnread";
ZmKeyMap.NEXT_UNREAD_MSG="NextUnreadMsg";
ZmKeyMap.PLAY="Play";
ZmKeyMap.PRESENCE_MENU="PresenceMenu";
ZmKeyMap.PREV_CONV="PreviousConversation";
ZmKeyMap.PREV_PAGE="PreviousPage";
ZmKeyMap.PREV_UNREAD="PreviousUnread";
ZmKeyMap.PREV_UNREAD_MSG="PreviousUnreadMsg";
ZmKeyMap.PRINT="Print";
ZmKeyMap.PRINT_ALL="PrintAll";
ZmKeyMap.QUICK_ADD="QuickAdd";
ZmKeyMap.READING_PANE_BOTTOM="ReadingPaneAtBottom";
ZmKeyMap.READING_PANE_OFF="ReadingPaneOff";
ZmKeyMap.READING_PANE_RIGHT="ReadingPaneOnRight";
ZmKeyMap.REFRESH="Refresh";
ZmKeyMap.REPLY="Reply";
ZmKeyMap.REPLY_ALL="ReplyAll";
ZmKeyMap.SAVE="Save";
ZmKeyMap.SAVED_SEARCH="SavedSearch";
ZmKeyMap.SELECT_ALL="SelectAll";
ZmKeyMap.SEND="Send";
ZmKeyMap.SHORTCUTS="Shortcuts";
ZmKeyMap.SHOW_FRAGMENT="ShowFragment";
ZmKeyMap.SPAM="Spam";
ZmKeyMap.SPELLCHECK="Spellcheck";
ZmKeyMap.TAG="Tag";
ZmKeyMap.TODAY="Today";
ZmKeyMap.UNTAG="Untag";
ZmKeyMap.VIEW_BY_CONV="ViewByConversation";
ZmKeyMap.VIEW_BY_MSG="ViewByMessage";
ZmKeyMap.VISIT="Visit";
ZmKeyMap.VISIT_TAG="VisitTag";
ZmKeyMap.ENTITY={};
ZmKeyMap.ENTITY[DwtKeyMap.ARROW_LEFT]="&larr;";
ZmKeyMap.ENTITY[DwtKeyMap.ARROW_RIGHT]="&rarr;";
ZmKeyMap.ENTITY[DwtKeyMap.ARROW_UP]="&uarr;";
ZmKeyMap.ENTITY[DwtKeyMap.ARROW_DOWN]="&darr;";
ZmKeyMap.ENTITY['"']="&quot;";
ZmKeyMap.ENTITY["&"]="&amp;";
ZmKeyMap.ENTITY["<"]="&lt;";
ZmKeyMap.ENTITY[">"]="&gt;";
ZmKeyMap.ENTITY[DwtKeyMap.COMMA]=",";
ZmKeyMap.ENTITY[DwtKeyMap.SEMICOLON]=";";
ZmKeyMap.ENTITY[DwtKeyMap.BACKSLASH]="\\";
ZmKeyMap.MAP_PRECONDITION={};
ZmKeyMap.ACTION_PRECONDITION={};
ZmKeyMap._setPreconditions=function(){
ZmKeyMap.MAP_PRECONDITION.ZmComposeController=ZmSetting.MAIL_ENABLED;
ZmKeyMap.MAP_PRECONDITION.ZmMailListController=ZmSetting.MAIL_ENABLED;
ZmKeyMap.MAP_PRECONDITION.ZmConvListController=ZmSetting.MAIL_ENABLED;
ZmKeyMap.MAP_PRECONDITION.ZmConvController=ZmSetting.MAIL_ENABLED;
ZmKeyMap.MAP_PRECONDITION.ZmMsgController=ZmSetting.MAIL_ENABLED;
ZmKeyMap.MAP_PRECONDITION.ZmContactListController=ZmSetting.CONTACTS_ENABLED;
ZmKeyMap.MAP_PRECONDITION.ZmContactController=ZmSetting.CONTACTS_ENABLED;
ZmKeyMap.MAP_PRECONDITION.ZmCalViewController=ZmSetting.CALENDAR_ENABLED;
ZmKeyMap.MAP_PRECONDITION.ZmApptComposeController=ZmSetting.CALENDAR_ENABLED;
ZmKeyMap.MAP_PRECONDITION.ZmMixedController=ZmSetting.MIXED_VIEW_ENABLED;
ZmKeyMap.MAP_PRECONDITION.ZmPrefController=ZmSetting.OPTIONS_ENABLED;
ZmKeyMap.MAP_PRECONDITION.ZmNotebookPageController=ZmSetting.NOTEBOOK_ENABLED;
ZmKeyMap.MAP_PRECONDITION.ZmBriefcaseController=ZmSetting.BRIEFCASE_ENABLED;
ZmKeyMap.MAP_PRECONDITION.ZmTaskListController=ZmSetting.TASKS_ENABLED;
ZmKeyMap.MAP_PRECONDITION.ZmTaskController=ZmSetting.TASKS_ENABLED;
ZmKeyMap.MAP_PRECONDITION.ZmVoicemailListController=ZmSetting.VOICE_ENABLED;
ZmKeyMap.MAP_PRECONDITION.ZmCallListController=ZmSetting.VOICE_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global={};
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.FOCUS_SEARCH_BOX]=ZmSetting.SEARCH_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.GOTO_BRIEFCASE]=ZmSetting.BRIEFCASE_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.GOTO_CALENDAR]=ZmSetting.CALENDAR_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.GOTO_CONTACTS]=ZmSetting.CONTACTS_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.GOTO_MAIL]=ZmSetting.MAIL_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.GOTO_NOTEBOOK]=ZmSetting.NOTEBOOK_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.GOTO_OPTIONS]=ZmSetting.OPTIONS_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.GOTO_TASKS]=ZmSetting.TASKS_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.GOTO_VOICE]=ZmSetting.VOICE_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.NEW_APPT]=ZmSetting.CALENDAR_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.NEW_BRIEFCASEITEM]=ZmSetting.BRIEFCASE_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.NEW_CALENDAR]=ZmSetting.CALENDAR_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.NEW_CHAT]=ZmSetting.IM_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.NEW_CONTACT]=ZmSetting.CONTACTS_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.NEW_FILE]=ZmSetting.BRIEFCASE_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.NEW_DOC]=ZmSetting.DOCS_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.NEW_FOLDER]=ZmSetting.MAIL_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.NEW_MESSAGE]=ZmSetting.MAIL_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.NEW_MESSAGE_WIN]=ZmSetting.MAIL_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.NEW_NOTEBOOK]=ZmSetting.NOTEBOOK_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.NEW_PAGE]=ZmSetting.NOTEBOOK_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.NEW_ROSTER_ITEM]=ZmSetting.IM_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.NEW_TAG]=ZmSetting.TAGGING_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.NEW_TASK]=ZmSetting.TASKS_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.PRESENCE_MENU]=ZmSetting.IM_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.SAVED_SEARCH]=ZmSetting.SAVED_SEARCHES_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.TAG]=ZmSetting.TAGGING_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.Global[ZmKeyMap.UNTAG]=ZmSetting.TAGGING_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.ZmComposeController={};
ZmKeyMap.ACTION_PRECONDITION.ZmComposeController[ZmKeyMap.ADDRESS_PICKER]=ZmSetting.CONTACTS_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.ZmComposeController[ZmKeyMap.HTML_FORMAT]=ZmSetting.HTML_COMPOSE_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.ZmComposeController[ZmKeyMap.NEW_WINDOW]=ZmSetting.NEW_WINDOW_COMPOSE;
ZmKeyMap.ACTION_PRECONDITION.ZmComposeController[ZmKeyMap.SAVE]=ZmSetting.SAVE_DRAFT_ENABLED;
ZmKeyMap.ACTION_PRECONDITION.ZmApptComposeController={};
ZmKeyMap.ACTION_PRECONDITION.ZmApptComposeController[ZmKeyMap.HTML_FORMAT]=ZmSetting.HTML_COMPOSE_ENABLED
};
ZmKeyMap.prototype._checkMap=function(a){
var t;
var e=ZmKeyMap.MAP_PRECONDITION[a];
if(!e){
t=true
}else{
if(typeof e=="string"||typeof e=="number"){
t=appCtxt.get(e)
}else{
if(typeof e=="function"){
t=e()
}}}
this._checkedMap[a]=t;
return t
};
ZmKeyMap.prototype._checkAction=function(t,a){
if((this._checkedMap[t]===false)||(!this._checkedMap[t]&&!this._checkMap(t))){
return false
}
var e=ZmKeyMap.ACTION_PRECONDITION[t];
if(!e){
return true
}
var o=e[a];
if(!o){
return true
}
if(typeof o=="string"||typeof o=="number"){
return appCtxt.get(o)
}else{
if(typeof o=="function"){
return o()
}}
return true
}
}
if(AjxPackage.define("zimbraMail.share.model.ZmTimezone")){
ZmTimezone=function(){};
ZmTimezone.getDefault=function(){
var t=DwtShell.getShell(window);
var e=appCtxt.get(ZmSetting.DEFAULT_TIMEZONE);
return(e)?AjxTimezone.getClientId(e):AjxTimezone.DEFAULT
};
ZmTimezone.getDefaultRule=function(){
return AjxTimezone.getRule(ZmTimezone.getDefault())
};
ZmTimezone.set=function(n,t,e,o){
var a=AjxTimezone.getRule(t);
if(!a){
return
}
if(a.autoDetected||!o){
if(n instanceof AjxSoapDoc){
ZmTimezone._setSoap(n,t,e,a)
}else{
ZmTimezone._setJson(n,t,a)
}}};
ZmTimezone._setSoap=function(f,r,d,u){
var s=f.set("tz",null,d);
var t=AjxTimezone.getServerId(r);
s.setAttribute("id",t);
if(u.autoDetected){
s.setAttribute("stdoff",u.standard.offset);
if(u.daylight){
s.setAttribute("dayoff",u.daylight.offset);
var m=["standard","daylight"];
var e=["mon","mday","week","wkday","hour","min","sec"];
for(var l=0;
l<m.length;
l++){
var o=m[l];
var c=u[o];
var a=f.set(o,null,s);
for(var h=0;
h<e.length;
h++){
var n=e[h];
if(n in c){
a.setAttribute(n,c[n])
}}}}}};
ZmTimezone._setJson=function(h,s,d){
var t=AjxTimezone.getServerId(s);
var n=h.tz={
id:t};
if(d.autoDetected){
n.stdoff=d.standard.offset;
if(d.daylight){
n.dayoff=d.daylight.offset;
var u=["standard","daylight"];
var e=["mon","mday","week","wkday","hour","min","sec"];
for(var l=0;
l<u.length;
l++){
var a=u[l];
var c=d[a];
n[a]={};
for(var r=0;
r<e.length;
r++){
var o=e[r];
if(o in c){
n[a][o]=c[o]
}}}}}}
}
if(AjxPackage.define("zimbraMail.share.model.ZmItem")){
ZmItem=function(a,n,o,e){
if(arguments.length==0){
return
}
ZmModel.call(this,a);
this.type=a;
this.id=n;
this.list=o;
this.tags=[];
this.tagHash={};
this.folderId=0;
var t=(appCtxt.multiAccounts)?ZmOrganizer.parseId(n):null;
this.account=t&&t.account;
if(n&&!e){
appCtxt.cacheSet(n,this)
}};
ZmItem.prototype=new ZmModel;
ZmItem.prototype.constructor=ZmItem;
ZmItem.APP={};
ZmItem.MSG_KEY={};
ZmItem.PLURAL_MSG_KEY={};
ZmItem.ICON={};
ZmItem.RESULTS_LIST={};
ZmItem.F_ACCOUNT=ZmId.FLD_ACCOUNT;
ZmItem.F_ATTACHMENT=ZmId.FLD_ATTACHMENT;
ZmItem.F_CAPACITY=ZmId.FLD_CAPACITY;
ZmItem.F_COMPANY=ZmId.FLD_COMPANY;
ZmItem.F_DATE=ZmId.FLD_DATE;
ZmItem.F_EMAIL=ZmId.FLD_EMAIL;
ZmItem.F_EXPAND=ZmId.FLD_EXPAND;
ZmItem.F_FILE_TYPE=ZmId.FLD_FILE_TYPE;
ZmItem.F_FLAG=ZmId.FLD_FLAG;
ZmItem.F_FOLDER=ZmId.FLD_FOLDER;
ZmItem.F_FRAGMENT=ZmId.FLD_FRAGMENT;
ZmItem.F_FROM=ZmId.FLD_FROM;
ZmItem.F_HOME_PHONE=ZmId.FLD_HOME_PHONE;
ZmItem.F_ID=ZmId.FLD_ID;
ZmItem.F_INDEX=ZmId.FLD_INDEX;
ZmItem.F_ITEM_ROW=ZmId.FLD_ITEM_ROW;
ZmItem.F_ITEM_ROW_3PANE=ZmId.FLD_ITEM_ROW_3PANE;
ZmItem.F_LOCATION=ZmId.FLD_LOCATION;
ZmItem.F_NAME=ZmId.FLD_NAME;
ZmItem.F_NOTES=ZmId.FLD_NOTES;
ZmItem.F_PARTICIPANT=ZmId.FLD_PARTICIPANT;
ZmItem.F_PCOMPLETE=ZmId.FLD_PCOMPLETE;
ZmItem.F_PRIORITY=ZmId.FLD_PRIORITY;
ZmItem.F_RECURRENCE=ZmId.FLD_RECURRENCE;
ZmItem.F_SELECTION=ZmId.FLD_SELECTION;
ZmItem.F_SELECTION_CELL=ZmId.FLD_SELECTION_CELL;
ZmItem.F_SIZE=ZmId.FLD_SIZE;
ZmItem.F_SORTED_BY=ZmId.FLD_SORTED_BY;
ZmItem.F_STATUS=ZmId.FLD_STATUS;
ZmItem.F_SUBJECT=ZmId.FLD_SUBJECT;
ZmItem.F_TAG=ZmId.FLD_TAG;
ZmItem.F_TAG_CELL=ZmId.FLD_TAG_CELL;
ZmItem.F_TYPE=ZmId.FLD_TYPE;
ZmItem.F_WORK_PHONE=ZmId.FLD_WORK_PHONE;
ZmItem.SOAP_CMD={};
ZmItem.TAGS_FIELD=1;
ZmItem.FLAG_ATTACH="a";
ZmItem.FLAG_FLAGGED="f";
ZmItem.FLAG_FORWARDED="w";
ZmItem.FLAG_ISDRAFT="d";
ZmItem.FLAG_ISSENT="s";
ZmItem.FLAG_READ_RECEIPT_SENT="n";
ZmItem.FLAG_REPLIED="r";
ZmItem.FLAG_UNREAD="u";
ZmItem.FLAG_LOW_PRIORITY="?";
ZmItem.FLAG_HIGH_PRIORITY="!";
ZmItem.ALL_FLAGS=[ZmItem.FLAG_FLAGGED,ZmItem.FLAG_ATTACH,ZmItem.FLAG_UNREAD,ZmItem.FLAG_REPLIED,ZmItem.FLAG_FORWARDED,ZmItem.FLAG_ISSENT,ZmItem.FLAG_READ_RECEIPT_SENT,ZmItem.FLAG_ISDRAFT,ZmItem.FLAG_HIGH_PRIORITY,ZmItem.FLAG_LOW_PRIORITY];
ZmItem.FLAG_PROP={};
ZmItem.FLAG_PROP[ZmItem.FLAG_ATTACH]="hasAttach";
ZmItem.FLAG_PROP[ZmItem.FLAG_FLAGGED]="isFlagged";
ZmItem.FLAG_PROP[ZmItem.FLAG_FORWARDED]="isForwarded";
ZmItem.FLAG_PROP[ZmItem.FLAG_ISDRAFT]="isDraft";
ZmItem.FLAG_PROP[ZmItem.FLAG_ISSENT]="isSent";
ZmItem.FLAG_PROP[ZmItem.FLAG_READ_RECEIPT_SENT]="readReceiptSent";
ZmItem.FLAG_PROP[ZmItem.FLAG_REPLIED]="isReplied";
ZmItem.FLAG_PROP[ZmItem.FLAG_UNREAD]="isUnread";
ZmItem.FLAG_PROP[ZmItem.FLAG_LOW_PRIORITY]="isLowPriority";
ZmItem.FLAG_PROP[ZmItem.FLAG_HIGH_PRIORITY]="isHighPriority";
ZmItem.DND_ACTION_MOVE=1<<0;
ZmItem.DND_ACTION_COPY=1<<1;
ZmItem.DND_ACTION_BOTH=ZmItem.DND_ACTION_MOVE|ZmItem.DND_ACTION_COPY;
ZmItem.NOTES_SEPARATOR="*~*~*~*~*~*~*~*~*~*";
ZmItem.registerItem=function(e,t){
if(t.app){
ZmItem.APP[e]=t.app
}
if(t.nameKey){
ZmItem.MSG_KEY[e]=t.nameKey
}
if(t.pluralNameKey){
ZmItem.PLURAL_MSG_KEY[e]=t.pluralNameKey
}
if(t.icon){
ZmItem.ICON[e]=t.icon
}
if(t.soapCmd){
ZmItem.SOAP_CMD[e]=t.soapCmd
}
if(t.itemClass){
ZmList.ITEM_CLASS[e]=t.itemClass
}
if(t.node){
ZmList.NODE[e]=t.node
}
if(t.organizer){
ZmOrganizer.ITEM_ORGANIZER[e]=t.organizer
}
if(t.searchType){
ZmSearch.TYPE[e]=t.searchType
}
if(t.resultsList){
ZmItem.RESULTS_LIST[e]=t.resultsList
}
if(t.node){
ZmList.ITEM_TYPE[t.node]=e
}
if(t.dropTargets){
if(!ZmApp.DROP_TARGETS[t.app]){
ZmApp.DROP_TARGETS[t.app]={}
}
ZmApp.DROP_TARGETS[t.app][e]=t.dropTargets
}};
ZmItem.getItemId=function(t){
if(!t){
return t
}
if(!ZmItem.SHORT_ID_RE){
var e=DwtShell.getShell(window);
ZmItem.SHORT_ID_RE=new RegExp(appCtxt.get(ZmSetting.USERID)+":","gi")
}
return t.replace(ZmItem.SHORT_ID_RE,"")
};
ZmItem.prototype.create=function(e){};
ZmItem.prototype.modify=function(e){};
ZmItem.prototype.getById=function(e){
if(e==this.id){
return this
}};
ZmItem.prototype.clear=function(){
this._evtMgr.removeAll(ZmEvent.L_MODIFY);
if(this.tags.length){
for(var e=0;
e<this.tags.length;
e++){
this.tags[e]=null
}
this.tags=[]
}
for(var e in this.tagHash){
this.tagHash[e]=null
}
this.tagHash={}
};
ZmItem.prototype.cache=function(){
if(this.id){
appCtxt.cacheSet(this.id,this);
return true
}
return false
};
ZmItem.prototype.hasTag=function(e){
return(this.tagHash[e]==true)
};
ZmItem.prototype.getFolderId=function(){
return this.folderId
};
ZmItem.prototype.getUrl=function(){
return this.getRestUrl()
};
ZmItem.prototype.getRestUrl=function(){
if(this.restUrl){
return this.restUrl
}
var a=ZmOrganizer.ITEM_ORGANIZER[this.type];
var e=appCtxt.getById(this.folderId);
var t=e?([e.getRestUrl(),"/",AjxStringUtil.urlComponentEncode(this.name)].join("")):null;
return t
};
ZmItem.prototype.getTagImageInfo=function(){
var t;
if(!this.tags.length||this.isShared()){
t="Blank_16"
}else{
if(this.tags.length==1){
var a=(this.account&&!this.account.isMain)?([this.account.id,this.tags[0]].join(":")):(ZmOrganizer.getSystemId(this.tags[0]));
var e=appCtxt.getById(a);
t=e?ZmTag.COLOR_ICON[e.color]:"Blank_16"
}else{
t="TagStack"
}}
return t
};
ZmItem.prototype.getDefaultDndAction=function(e){
return(this.isReadOnly()||e)?ZmItem.DND_ACTION_COPY:ZmItem.DND_ACTION_MOVE
};
ZmItem.prototype.isReadOnly=function(){
return false
};
ZmItem.prototype.isShared=function(){
if(this._isShared==null){
if(this.id==-1){
this._isShared=false
}else{
var t=appCtxt.getActiveAccount();
var e=String(this.id);
this._isShared=((e.indexOf(":")!=-1)&&(e.indexOf(t.id)!=0))
}}
return this._isShared
};
ZmItem.prototype.notifyDelete=function(){
this.deleteLocal();
if(this.list){
this.list.deleteLocal([this])
}
this._notify(ZmEvent.E_DELETE)
};
ZmItem.prototype.notifyModify=function(r){
if(r.t!=null){
this._parseTags(r.t);
this._notify(ZmEvent.E_TAGS)
}
if(r.f!=null){
var a=this._getFlags();
var s={};
for(var n=0;
n<a.length;
n++){
s[a[n]]=this[ZmItem.FLAG_PROP[a[n]]]
}
this._parseFlags(r.f);
var t=[];
for(var n=0;
n<a.length;
n++){
var e=this[ZmItem.FLAG_PROP[a[n]]];
if(s[a[n]]!=e){
t.push(a[n])
}}
if(t.length){
this._notify(ZmEvent.E_FLAGS,{
flags:t}
)
}}
if(r.l!=null&&r.l!=this.folderId){
var o={
oldFolderId:this.folderId};
this.moveLocal(r.l);
if(this.list){
this.list.moveLocal([this],r.l)
}
this._notify(ZmEvent.E_MOVE,o)
}};
ZmItem.prototype.flagLocal=function(t,e){
this[ZmItem.FLAG_PROP[t]]=e
};
ZmItem.prototype.setFlag=function(a,t){
this.flagLocal(a,t);
var e=this.flags||"";
if(t&&e.indexOf(a)==-1){
e=e+a
}else{
if(!t&&e.indexOf(a)!=-1){
e=e.replace(a,"")
}}
this.flags=e;
return e
};
ZmItem.prototype.tagLocal=function(a,o){
var t=false;
if(o){
if(!this.tagHash[a]){
t=true;
this.tags.push(a);
this.tagHash[a]=true
}}else{
for(var e=0;
e<this.tags.length;
e++){
if(this.tags[e]==a){
this.tags.splice(e,1);
delete this.tagHash[a];
t=true;
break
}}}
return t
};
ZmItem.prototype.removeAllTagsLocal=function(){
this.tags=[];
for(var e in this.tagHash){
delete this.tagHash[e]
}};
ZmItem.prototype.deleteLocal=function(){};
ZmItem.prototype.move=function(e,a,t){
return ZmItem.move(this.id,e,a,t)
};
ZmItem.move=function(n,e,s,t){
var a={
ItemActionRequest:{
_jsns:"urn:zimbraMail",action:{
id:n instanceof Array?n.join():n,op:"move",l:e}}};
var o={
jsonObj:a,asyncMode:Boolean(s),callback:s,errorCallback:t};
return appCtxt.getAppController().sendRequest(o)
};
ZmItem.prototype.moveLocal=function(e){
this.folderId=e
};
ZmItem.prototype._parseTags=function(o){
this.tags=[];
this.tagHash={};
if(o&&o.length){
var e=o.split(",");
for(var t=0;
t<e.length;
t++){
var a=Number(e[t]);
if(a>=ZmOrganizer.FIRST_USER_ID[ZmOrganizer.TAG]){
this.tagLocal(a,true)
}}}};
ZmItem.prototype._parseFlags=function(o){
this.flags=o;
for(var a=0;
a<ZmItem.ALL_FLAGS.length;
a++){
var t=ZmItem.ALL_FLAGS[a];
var e=(o&&(o.indexOf(t)!=-1))?true:false;
this.flagLocal(t,e)
}};
ZmItem.prototype._notify=function(t,e){
ZmModel.prototype._notify.call(this,t,e);
if(this.list){
if(e){
e.items=[this]
}else{
e={
items:[this]}
}
this.list._evt.item=this;
this.list._notify(t,e)
}};
ZmItem.prototype._getFlags=function(){
return[ZmItem.FLAG_FLAGGED,ZmItem.FLAG_ATTACH]
}
}
if(AjxPackage.define("zimbraMail.share.model.ZmOrganizer")){
ZmOrganizer=function(t){
if(arguments.length==0){
return
}
this.type=t.type;
var a=this.id=t.id;
this.nId=ZmOrganizer.normalizeId(a);
this.name=ZmFolder.MSG_KEY[this.nId]?ZmMsg[ZmFolder.MSG_KEY[this.nId]]:t.name;
this._systemName=this.nId<256&&t.name;
this.parent=t.parent;
this.tree=t.tree;
this.numUnread=t.numUnread||0;
this.numTotal=t.numTotal||0;
this.sizeTotal=t.sizeTotal||0;
this.url=t.url;
this.owner=t.owner;
this.link=t.link||(Boolean(t.zid))||(this.parent&&this.parent.link);
this.isMountpoint=t.link;
this.zid=t.zid;
this.rid=t.rid;
this.restUrl=t.restUrl;
this.account=t.account;
this.perm=t.perm;
this.noSuchFolder=false;
this._isAdmin=this._isReadOnly=this._hasPrivateAccess=null;
var e=(this.parent&&!t.color)?this.parent.color:t.color;
this.color=e||ZmOrganizer.ORG_COLOR[a]||ZmOrganizer.ORG_COLOR[this.nId]||ZmOrganizer.DEFAULT_COLOR[this.type]||ZmOrganizer.C_NONE;
this.rgb=t.rgb||(this.color==ZmOrganizer.C_NONE&&this.parent&&this.parent.rgb);
if(t.rgb=="#000000"){
delete this.rgb
}
if(appCtxt.isOffline&&!this.account&&this.id==this.nId){
this.account=appCtxt.accountList.mainAccount
}
this.disallowSubFolder=appCtxt.isOffline&&this.account&&this.account.type==ZmAccount.TYPE_POP;
if(a&&t.tree){
appCtxt.cacheSet(a,this);
if(this.link){
appCtxt.cacheSet([this.zid,this.rid].join(":"),this)
}}
this.children=new AjxVector()
};
ZmOrganizer.TAG=ZmEvent.S_TAG;
ZmOrganizer.SEARCH=ZmEvent.S_SEARCH;
ZmOrganizer.MOUNTPOINT=ZmEvent.S_MOUNTPOINT;
ZmOrganizer.ZIMLET=ZmEvent.S_ZIMLET;
ZmOrganizer.ID_ROOT=1;
ZmOrganizer.ID_INBOX=2;
ZmOrganizer.ID_TRASH=3;
ZmOrganizer.ID_SPAM=4;
ZmOrganizer.ID_ADDRBOOK=7;
ZmOrganizer.ID_CALENDAR=10;
ZmOrganizer.ID_NOTEBOOK=12;
ZmOrganizer.ID_AUTO_ADDED=13;
ZmOrganizer.ID_CHATS=14;
ZmOrganizer.ID_TASKS=15;
ZmOrganizer.ID_BRIEFCASE=16;
ZmOrganizer.ID_GLOBAL_INBOX=249;
ZmOrganizer.ID_NOTIFICATION_MP=250;
ZmOrganizer.ID_SYNC_FAILURES=252;
ZmOrganizer.ID_OUTBOX=254;
ZmOrganizer.ID_ZIMLET=-1000;
ZmOrganizer.ID_ROSTER_LIST=-11;
ZmOrganizer.ID_ROSTER_TREE_ITEM=-13;
ZmOrganizer.ID_MY_CARD=-15;
ZmOrganizer.ID_ATTACHMENTS=-17;
ZmOrganizer.F_NAME="name";
ZmOrganizer.F_UNREAD="unread";
ZmOrganizer.F_TOTAL="total";
ZmOrganizer.F_SIZE="size";
ZmOrganizer.F_COLOR="color";
ZmOrganizer.F_RGB="rgb";
ZmOrganizer.F_QUERY="query";
ZmOrganizer.F_SHARES="shares";
ZmOrganizer.F_FLAGS="flags";
ZmOrganizer.F_REST_URL="rest";
ZmOrganizer.F_PERMS="perms";
ZmOrganizer.F_RNAME="rname";
ZmOrganizer.FLAG_CHECKED="#";
ZmOrganizer.FLAG_DISALLOW_SUBFOLDER="o";
ZmOrganizer.FLAG_EXCLUDE_FREE_BUSY="b";
ZmOrganizer.FLAG_IMAP_SUBSCRIBED="*";
ZmOrganizer.FLAG_OFFLINE_GLOBAL="g";
ZmOrganizer.FLAG_OFFLINE_SYNCABLE="y";
ZmOrganizer.FLAG_OFFLINE_SYNCING="~";
ZmOrganizer.ALL_FLAGS=[ZmOrganizer.FLAG_CHECKED,ZmOrganizer.FLAG_IMAP_SUBSCRIBED,ZmOrganizer.FLAG_EXCLUDE_FREE_BUSY,ZmOrganizer.FLAG_DISALLOW_SUBFOLDER,ZmOrganizer.FLAG_OFFLINE_GLOBAL,ZmOrganizer.FLAG_OFFLINE_SYNCABLE,ZmOrganizer.FLAG_OFFLINE_SYNCING];
ZmOrganizer.FLAG_PROP={};
ZmOrganizer.FLAG_PROP[ZmOrganizer.FLAG_CHECKED]="isChecked";
ZmOrganizer.FLAG_PROP[ZmOrganizer.FLAG_IMAP_SUBSCRIBED]="imapSubscribed";
ZmOrganizer.FLAG_PROP[ZmOrganizer.FLAG_EXCLUDE_FREE_BUSY]="excludeFreeBusy";
ZmOrganizer.FLAG_PROP[ZmOrganizer.FLAG_DISALLOW_SUBFOLDER]="disallowSubFolder";
ZmOrganizer.FLAG_PROP[ZmOrganizer.FLAG_OFFLINE_GLOBAL]="isOfflineGlobalSearch";
ZmOrganizer.FLAG_PROP[ZmOrganizer.FLAG_OFFLINE_SYNCABLE]="isOfflineSyncable";
ZmOrganizer.FLAG_PROP[ZmOrganizer.FLAG_OFFLINE_SYNCING]="isOfflineSyncing";
ZmOrganizer.VALID_NAME_CHARS='[^\\x00-\\x1F\\x7F:\\/\\"]';
ZmOrganizer.VALID_PATH_CHARS='[^\\x00-\\x1F\\x7F:\\"]';
ZmOrganizer.VALID_NAME_RE=new RegExp("^"+ZmOrganizer.VALID_NAME_CHARS+"+$");
ZmOrganizer.MAX_NAME_LENGTH=128;
ZmOrganizer.MAX_DISPLAY_NAME_LENGTH=30;
ZmOrganizer.C_NONE=0;
ZmOrganizer.C_BLUE=1;
ZmOrganizer.C_CYAN=2;
ZmOrganizer.C_GREEN=3;
ZmOrganizer.C_PURPLE=4;
ZmOrganizer.C_RED=5;
ZmOrganizer.C_YELLOW=6;
ZmOrganizer.C_PINK=7;
ZmOrganizer.C_GRAY=8;
ZmOrganizer.C_ORANGE=9;
ZmOrganizer.MAX_COLOR=ZmOrganizer.C_ORANGE;
ZmOrganizer.ORG_DEFAULT_COLOR=ZmOrganizer.C_ORANGE;
ZmOrganizer.COLOR_VALUES=[null,"#9EB6F5","#A4E6E6","#97C8B1","#BA86E5","#FC9696","#FFF6B3","#FE9BD3","#D3D3D3","#FDBC55"];
ZmOrganizer.COLOR_TEXT={};
ZmOrganizer.COLOR_TEXT[ZmOrganizer.C_NONE]=ZmMsg.none;
ZmOrganizer.COLOR_TEXT[ZmOrganizer.C_ORANGE]=ZmMsg.orange;
ZmOrganizer.COLOR_TEXT[ZmOrganizer.C_BLUE]=ZmMsg.blue;
ZmOrganizer.COLOR_TEXT[ZmOrganizer.C_CYAN]=ZmMsg.cyan;
ZmOrganizer.COLOR_TEXT[ZmOrganizer.C_GREEN]=ZmMsg.green;
ZmOrganizer.COLOR_TEXT[ZmOrganizer.C_PURPLE]=ZmMsg.purple;
ZmOrganizer.COLOR_TEXT[ZmOrganizer.C_RED]=ZmMsg.red;
ZmOrganizer.COLOR_TEXT[ZmOrganizer.C_YELLOW]=ZmMsg.yellow;
ZmOrganizer.COLOR_TEXT[ZmOrganizer.C_PINK]=ZmMsg.pink;
ZmOrganizer.COLOR_TEXT[ZmOrganizer.C_GRAY]=ZmMsg.gray;
ZmOrganizer.COLORS=[];
ZmOrganizer.COLOR_CHOICES=[];
(function(){
for(var t=0;
t<=ZmOrganizer.MAX_COLOR;
t++){
var e=ZmOrganizer.COLOR_TEXT[t];
ZmOrganizer.COLORS.push(e);
ZmOrganizer.COLOR_CHOICES.push({
value:t,label:e}
)
}}
)();
ZmOrganizer.MSG_KEY={};
ZmOrganizer.ROOT_MSG_KEY={};
ZmOrganizer.ITEM_ORGANIZER={};
ZmOrganizer.DEFAULT_FOLDER={};
ZmOrganizer.SOAP_CMD={};
ZmOrganizer.FIRST_USER_ID={};
ZmOrganizer.PRECONDITION={};
ZmOrganizer.HAS_COLOR={};
ZmOrganizer.DEFAULT_COLOR={};
ZmOrganizer.ORG_COLOR={};
ZmOrganizer.APP={};
ZmOrganizer.ORG_CLASS={};
ZmOrganizer.ORG_PACKAGE={};
ZmOrganizer.CREATE_FUNC={};
ZmOrganizer.LABEL={};
ZmOrganizer.ITEMS_KEY={};
ZmOrganizer.TREE_TYPE={};
ZmOrganizer.VIEWS={};
ZmOrganizer.VIEW_HASH={};
ZmOrganizer.TYPE={};
ZmOrganizer.FOLDER_KEY={};
ZmOrganizer.MOUNT_KEY={};
ZmOrganizer.DEFERRABLE={};
ZmOrganizer.PATH_IN_NAME={};
ZmOrganizer.OPEN_SETTING={};
ZmOrganizer.NEW_OP={};
ZmOrganizer.DISPLAY_ORDER={};
ZmOrganizer.HIDE_EMPTY={};
ZmOrganizer.APP2ORGANIZER={};
ZmOrganizer.PERM_READ="r";
ZmOrganizer.PERM_WRITE="w";
ZmOrganizer.PERM_INSERT="i";
ZmOrganizer.PERM_DELETE="d";
ZmOrganizer.PERM_ADMIN="a";
ZmOrganizer.PERM_WORKFLOW="x";
ZmOrganizer.PERM_PRIVATE="p";
ZmOrganizer.registerOrg=function(a,e){
if(e.nameKey){
ZmOrganizer.MSG_KEY[a]=e.nameKey
}
if(e.app){
ZmOrganizer.APP[a]=e.app;
if(!ZmOrganizer.APP2ORGANIZER[e.app]){
ZmOrganizer.APP2ORGANIZER[e.app]=[]
}
ZmOrganizer.APP2ORGANIZER[e.app].push(a)
}
if(e.defaultFolder){
ZmOrganizer.DEFAULT_FOLDER[a]=e.defaultFolder
}
if(e.precondition){
ZmOrganizer.PRECONDITION[a]=e.precondition
}
if(e.soapCmd){
ZmOrganizer.SOAP_CMD[a]=e.soapCmd
}
if(e.firstUserId){
ZmOrganizer.FIRST_USER_ID[a]=e.firstUserId
}
if(e.orgClass){
ZmOrganizer.ORG_CLASS[a]=e.orgClass
}
if(e.orgPackage){
ZmOrganizer.ORG_PACKAGE[a]=e.orgPackage
}
if(e.labelKey){
ZmOrganizer.LABEL[a]=e.labelKey
}
if(e.itemsKey){
ZmOrganizer.ITEMS_KEY[a]=e.itemsKey
}
if(e.hasColor){
ZmOrganizer.HAS_COLOR[a]=e.hasColor
}
if(e.views){
ZmOrganizer.VIEWS[a]=e.views
}
if(e.folderKey){
ZmOrganizer.FOLDER_KEY[a]=e.folderKey
}
if(e.mountKey){
ZmOrganizer.MOUNT_KEY[a]=e.mountKey
}
if(e.deferrable){
ZmOrganizer.DEFERRABLE[a]=e.deferrable
}
if(e.pathInName){
ZmOrganizer.PATH_IN_NAME[a]=e.pathInName
}
if(e.openSetting){
ZmOrganizer.OPEN_SETTING[a]=e.openSetting
}
if(e.newOp){
ZmOrganizer.NEW_OP[a]=e.newOp
}
if(e.displayOrder){
ZmOrganizer.DISPLAY_ORDER[a]=e.displayOrder
}
if(e.hideEmpty){
ZmOrganizer.HIDE_EMPTY[a]=e.hideEmpty
}
if(!appCtxt.isChildWindow||e.childWindow){
if(e.compareFunc){
ZmTreeView.COMPARE_FUNC[a]=e.compareFunc
}
if(e.treeController){
ZmOverviewController.CONTROLLER[a]=e.treeController
}}
ZmOrganizer.TREE_TYPE[a]=e.treeType||a;
ZmOrganizer.CREATE_FUNC[a]=e.createFunc||"ZmOrganizer.create";
if(e.views){
ZmOrganizer.VIEW_HASH[a]=AjxUtil.arrayAsHash(ZmOrganizer.VIEWS[a])
}
if(e.hasColor){
ZmOrganizer.DEFAULT_COLOR[a]=(e.defaultColor!=null)?e.defaultColor:ZmOrganizer.ORG_DEFAULT_COLOR
}
if(e.orgColor){
for(var t in e.orgColor){
ZmOrganizer.ORG_COLOR[t]=e.orgColor[t]
}}
if(e.dropTargets){
if(!ZmApp.DROP_TARGETS[e.app]){
ZmApp.DROP_TARGETS[e.app]={}
}
ZmApp.DROP_TARGETS[e.app][a]=e.dropTargets
}};
ZmOrganizer.sortCompare=function(t,e){};
ZmOrganizer.create=function(s){
var r={
CreateFolderRequest:{
_jsns:"urn:zimbraMail"}};
var o=r.CreateFolderRequest.folder={};
var e=s.errorCallback||new AjxCallback(null,ZmOrganizer._handleErrorCreate,s);
var a=s.type;
s.view=s.view||ZmOrganizer.VIEWS[a]?ZmOrganizer.VIEWS[a][0]:null;
for(var t in s){
if(t=="type"||t=="errorCallback"||t=="account"){
continue
}
var n=s[t];
if(t=="color"){
if(!n||(n==ZmOrganizer.DEFAULT_COLOR[a])){
n=null
}}
if(n){
o[t]=n
}}
return appCtxt.getAppController().sendRequest({
jsonObj:r,asyncMode:true,accountName:(s.account&&s.account.name),errorCallback:e}
)
};
ZmOrganizer._handleErrorCreate=function(o,e){
if(!o.url&&!o.name){
return false
}
var a;
if(o.name&&(e.code==ZmCsfeException.MAIL_ALREADY_EXISTS)){
a=AjxMessageFormat.format(ZmMsg.errorAlreadyExists,[o.name])
}else{
if(o.url){
var t=(e.code==ZmCsfeException.SVC_RESOURCE_UNREACHABLE)?ZmMsg.feedUnreachable:ZmMsg.feedInvalid;
a=AjxMessageFormat.format(t,o.url)
}}
if(a){
ZmOrganizer._showErrorMsg(a);
return true
}
return false
};
ZmOrganizer._showErrorMsg=function(t){
var e=appCtxt.getMsgDialog();
e.reset();
e.setMessage(t,DwtMessageDialog.CRITICAL_STYLE);
e.popup()
};
ZmOrganizer.getFolder=function(s,n,e){
var o={
GetFolderRequest:{
_jsns:"urn:zimbraMail"}};
var t=o.GetFolderRequest;
t.folder={
l:s};
var a=new AjxCallback(null,ZmOrganizer._handleResponseGetFolder,[n]);
if(e){
e.addRequestParams(o,a)
}else{
appCtxt.getRequestMgr().sendRequest({
jsonObj:o,asyncMode:true,callback:a}
)
}};
ZmOrganizer._handleResponseGetFolder=function(s,e){
var n=e.getResponse().GetFolderResponse;
var t=(n&&n.folder&&n.folder[0])||(n&&n.link&&n.link[0]);
var o;
if(t){
o=appCtxt.getById(t.id);
if(o){
o.clearShares();
o._setSharesFromJs(t)
}else{
var a=appCtxt.getById(t.l);
o=ZmFolderTree.createFromJs(a,t,appCtxt.getFolderTree(),"folder")
}}
if(s){
s.run(o)
}};
ZmOrganizer.prototype.getFolder=function(t,e){
ZmOrganizer.getFolder(this.id,t,e)
};
ZmOrganizer.getViewName=function(e){
return ZmOrganizer.VIEWS[e][0]
};
ZmOrganizer.checkName=function(e){
if(e.length==0){
return ZmMsg.nameEmpty
}
if(e.length>ZmOrganizer.MAX_NAME_LENGTH){
return AjxMessageFormat.format(ZmMsg.nameTooLong,ZmOrganizer.MAX_NAME_LENGTH)
}
if(!ZmOrganizer.VALID_NAME_RE.test(e)){
return AjxMessageFormat.format(ZmMsg.errorInvalidName,AjxStringUtil.htmlEncode(e))
}
return null
};
ZmOrganizer.checkUrl=function(e){
if(!e.match(/^[a-zA-Z]+:\/\/.*$/i)){
return ZmMsg.errorUrlMissing
}
return null
};
ZmOrganizer.checkSortArgs=function(e,t){
if(!e&&!t){
return 0
}
if(e&&!t){
return 1
}
if(!e&&t){
return -1
}
return null
};
ZmOrganizer.checkColor=function(e){
return((e!=null)&&(e>=0&&e<=ZmOrganizer.MAX_COLOR))?e:ZmOrganizer.ORG_DEFAULT_COLOR
};
ZmOrganizer.getSystemId=function(a,t,e){
t=t||appCtxt.getActiveAccount();
if((t&&!t.isMain)||e){
return((typeof(a)=="string")&&(a.indexOf(":")!=-1)||!a)?a:([t.id,a].join(":"))
}
return a
};
ZmOrganizer.normalizeId=function(o,a){
if(typeof(o)!="string"){
return o
}
var e=o.indexOf(":");
var t=(e==-1)?o:o.substr(e+1);
return(a&&(t>=ZmOrganizer.FIRST_USER_ID[a]))?o:t
};
ZmOrganizer.parseId=function(a,t){
t=t||{};
if(a==null){
return t
}
var e=(typeof a=="string")?a.indexOf(":"):-1;
if(e==-1){
t.account=appCtxt.accountList.mainAccount;
t.id=a
}else{
t.account=appCtxt.accountList.getAccount(a.substring(0,e));
t.id=a.substr(e+1)
}
return t
};
ZmOrganizer.prototype.toString=function(){
return"ZmOrganizer"
};
ZmOrganizer.prototype.getName=function(n,t,o,e){
if(this.nId==ZmFolder.ID_ROOT){
return(ZmOrganizer.LABEL[this.type])?ZmMsg[ZmOrganizer.LABEL[this.type]]:""
}
var a=(e&&this._systemName)?this._systemName:this.name||"";
if(ZmOrganizer.PATH_IN_NAME[this.type]&&this.path){
a=[this.path,a].join("/")
}
a=(t&&a.length>t)?a.substring(0,t-3)+"...":a;
return this._markupName(a,n,o)
};
ZmOrganizer.prototype.getPath=function(a,r,t,s,e){
var o=this.parent;
var n=this.getName(r,t,s,e);
while(o&&((o.nId!=ZmOrganizer.ID_ROOT)||a)){
n=o.getName(r,t,s,e)+ZmFolder.SEP+n;
o=o.parent
}
return n
};
ZmOrganizer.prototype.getToolTip=function(a){
if(!this._tooltip||a){
var e=this._getItemsText();
var o=this.numTotal;
if(appCtxt.isOffline&&this.account.isMain&&(this.nId==ZmFolder.ID_DRAFTS||this.nId==ZmFolder.ID_OUTBOX)){
o=appCtxt.accountList.getItemCount(this.nId)
}
var t={
itemText:e,numTotal:o,sizeTotal:this.sizeTotal};
this._tooltip=AjxTemplate.expand("share.App#FolderTooltip",t)
}
return this._tooltip
};
ZmOrganizer.prototype.getSearchPath=function(){
return(this.nId!=ZmOrganizer.ID_ROOT)?this.getPath(null,null,null,true,true):"/"
};
ZmOrganizer.prototype.getUrl=function(){
return this.getRestUrl()
};
ZmOrganizer.prototype.getSyncUrl=function(){
return url
};
ZmOrganizer.prototype.getRemoteId=function(){
if(!this._remoteId){
this._remoteId=(this.isRemote()&&this.zid&&this.rid)?(this.zid+":"+this.rid):this.id
}
return this._remoteId
};
ZmOrganizer.prototype.getRestUrl=function(){
var o=appCtxt.get(ZmSetting.REST_URL);
if(o){
return([o,"/",AjxStringUtil.urlEncode(this.getSearchPath())].join(""))
}
if(this.restUrl){
return this.restUrl
}
var s=document.location;
var t=this.owner||appCtxt.get(ZmSetting.USERNAME);
var n=s.host;
var e=t.match(/^(.*)@(.*)$/);
t=(e&&e[1])||t;
n=(e&&e[2])||n;
if(s.port&&s.port!=80){
n=n+":"+s.port
}
var a=[s.protocol,"//",n,"/service/user/",t,"/",AjxStringUtil.urlEncode(this.getSearchPath())].join("");
return a
};
ZmOrganizer.prototype.getAccount=function(){
if(appCtxt.multiAccounts){
if(!this.account){
this.account=ZmOrganizer.parseId(this.id).account
}
return this.account
}
return(this.account||appCtxt.accountList.mainAccount)
};
ZmOrganizer.prototype.getShares=function(){
return this.shares
};
ZmOrganizer.prototype.addShare=function(a){
this.shares=this.shares||[];
this.shares.push(a);
var o=appCtxt.getActiveAccount();
var e=o&&o.id;
var t=a.grantee&&a.grantee.id;
if(t&&(t==e)){
this._mainShare=a
}};
ZmOrganizer.prototype.clearShares=function(){
if(this.shares&&this.shares.length){
for(var e=0;
e<this.shares.length;
e++){
this.shares[e]=null
}}
this.shares=null;
this._mainShare=null
};
ZmOrganizer.prototype.getMainShare=function(){
return this._mainShare||(this.shares&&this.shares.length&&this.shares[0])
};
ZmOrganizer.prototype.supportsSharing=function(){
return true
};
ZmOrganizer.prototype.supportsPublicAccess=function(){
return true
};
ZmOrganizer.prototype.supportsPrivatePermission=function(){
return false
};
ZmOrganizer.prototype.getIcon=function(){};
ZmOrganizer.prototype.getIconWithColor=function(){
var t=this.getIcon()||"";
var e=this.rgb||this.color;
return e?[t,e].join(",color="):t
};
ZmOrganizer.prototype.rename=function(a,n,t,e){
if(a==this.name){
return
}
var o={
action:"rename",attrs:{
name:a}
,callback:n,errorCallback:t,batchCmd:e};
this._organizerAction(o)
};
ZmOrganizer.prototype.setColor=function(t,a,e){
var t=ZmOrganizer.checkColor(t);
if(this.color==t){
return
}
this._organizerAction({
action:"color",attrs:{
color:t}
,callback:a,errorCallback:e}
)
};
ZmOrganizer.prototype.setRGB=function(t,a,e){
if(this.rgb==t){
return
}
this._organizerAction({
action:"color",attrs:{
rgb:t}
,callback:a,errorCallback:e}
)
};
ZmOrganizer.prototype.update=function(e){
this._organizerAction({
action:"update",attrs:e}
)
};
ZmOrganizer.prototype.move=function(t){
var e=(t.nId>0)?t.id:ZmOrganizer.getSystemId(ZmOrganizer.ID_ROOT);
if((e==this.id||e==this.parent.id)||(this.type==ZmOrganizer.FOLDER&&(ZmOrganizer.normalizeId(e,this.type)==ZmFolder.ID_SPAM))||(t.isChildOf(this))){
return
}
if(e==ZmOrganizer.ID_TRASH){
this._organizerAction({
action:"trash"}
)
}else{
this._organizerAction({
action:"move",attrs:{
l:e}}
)
}};
ZmOrganizer.prototype._delete=function(){
var e=((this.type==ZmOrganizer.FOLDER||this.type==ZmOrganizer.ADDRBOOK)&&(this.nId==ZmFolder.ID_SPAM||this.nId==ZmFolder.ID_TRASH));
if(this.isSystem()&&!e){
return
}
var t=e?"empty":"delete";
this._organizerAction({
action:t}
)
};
ZmOrganizer.prototype._empty=function(t){
t=t||false;
var e=((this.type==ZmOrganizer.FOLDER||this.type==ZmOrganizer.ADDRBOOK)&&(this.nId==ZmFolder.ID_SPAM||this.nId==ZmFolder.ID_TRASH||this.nId==ZmFolder.ID_CHATS||this.nId==ZmOrganizer.ID_SYNC_FAILURES));
if(this.isSystem()&&!e){
return
}
var a={
action:"empty"};
a.attrs=(this.nId==ZmFolder.ID_TRASH)?{
recursive:true}
:{
recursive:t};
if(this.isRemote()){
a.id=this.getRemoteId()
}
this._organizerAction(a)
};
ZmOrganizer.prototype.markAllRead=function(){
var e=this.isRemote()?this.getRemoteId():null;
this._organizerAction({
action:"read",id:e,attrs:{
l:this.id}}
)
};
ZmOrganizer.prototype.sync=function(){
this._organizerAction({
action:"sync"}
)
};
ZmOrganizer.prototype.notifyDelete=function(){
var t=appCtxt.getOverviewController().getTreeController(this.type);
var o=t.getTreeView(appCtxt.getCurrentApp().getOverviewId());
var n=o&&o.getSelected();
if(n){
if(!(n instanceof Array)){
n=[n]
}
for(var r in n){
var e=n[r];
if(e&&(e==this||e.isChildOf(this))){
var a=this.parent.id;
if(this.parent.nId==ZmOrganizer.ID_ROOT){
a=ZmOrganizer.getSystemId(ZmOrganizer.DEFAULT_FOLDER[this.type])
}
var s=false;
o.setSelected(a,s)
}}}
this.deleteLocal();
this._notify(ZmEvent.E_DELETE)
};
ZmOrganizer.prototype.notifyCreate=function(){};
ZmOrganizer.prototype.notifyModify=function(obj,details){
var doNotify=false;
var details=details||{};
var fields={};
if(obj.name!=null&&(this.name!=obj.name||this.id!=obj.id)){
if(obj.id==this.id){
details.oldName=this.name;
this.name=obj.name;
fields[ZmOrganizer.F_NAME]=true;
this.parent.children.sort(eval(ZmTreeView.COMPARE_FUNC[this.type]))
}else{
details.newName=obj.name;
fields[ZmOrganizer.F_RNAME]=true
}
doNotify=true
}
if(obj.u!=null&&this.numUnread!=obj.u){
this.numUnread=obj.u;
fields[ZmOrganizer.F_UNREAD]=true;
doNotify=true
}
if(obj.n!=null&&this.numTotal!=obj.n){
this.numTotal=obj.n;
fields[ZmOrganizer.F_TOTAL]=true;
doNotify=true
}
if(obj.s!=null&&this.sizeTotal!=obj.s){
this.sizeTotal=obj.s;
fields[ZmOrganizer.F_SIZE]=true;
doNotify=true
}
if((obj.rgb!=null||obj.color!=null)&&!obj._isRemote){
var color=ZmOrganizer.checkColor(obj.color);
if(this.color!=color){
this.color=color;
fields[ZmOrganizer.F_COLOR]=true
}
if(obj.rgb!=this.rgb){
this.rgb=obj.rgb;
fields[ZmOrganizer.F_RBG]=true;
fields[ZmOrganizer.F_COLOR]=true
}
doNotify=true
}
if(obj.f!=null&&!obj._isRemote){
var oflags=this._setFlags().split("").sort().join("");
var nflags=obj.f.split("").sort().join("");
if(oflags!=nflags){
this._parseFlags(obj.f);
fields[ZmOrganizer.F_FLAGS]=true;
doNotify=true
}}
if(obj.rest!=null&&this.restUrl!=obj.rest&&!obj._isRemote){
this.restUrl=obj.rest;
fields[ZmOrganizer.F_REST_URL]=true;
doNotify=true
}
if(obj.acl){
this.clearShares();
if(obj.acl.grant&&obj.acl.grant.length){
AjxDispatcher.require("Share");
for(var i=0;
i<obj.acl.grant.length;
i++){
share=ZmShare.createFromJs(this,obj.acl.grant[i]);
this.addShare(share)
}}
fields[ZmOrganizer.F_SHARES]=true;
doNotify=true
}
if(obj.perm&&obj._isRemote){
fields[ZmOrganizer.F_PERMS]=true;
doNotify=true;
this._isAdmin=this._isReadOnly=this._hasPrivateAccess=null
}
if(doNotify){
details.fields=fields;
this._notify(ZmEvent.E_MODIFY,details)
}
if(this.parent&&obj.l!=null&&obj.l!=this.parent.id){
var newParent=this._getNewParent(obj.l);
if(newParent){
this.reparent(newParent);
this._notify(ZmEvent.E_MOVE);
this.tree=newParent.tree
}}};
ZmOrganizer.prototype.deleteLocal=function(){
this.parent.children.remove(this);
var e=this.children.getArray();
var o=this.children.size();
for(var t=0;
t<o;
t++){
var n=e[t];
if(n){
n.deleteLocal()
}}
this.children.removeAll()
};
ZmOrganizer.prototype.hasChild=function(e){
return(this.getChild(e)!=null)
};
ZmOrganizer.prototype.getChild=function(t){
t=t.toLowerCase();
var e=this.children.getArray();
var n=this.children.size();
for(var o=0;
o<n;
o++){
if(e[o].name&&(e[o].name.toLowerCase()==t)){
return e[o]
}}
return null
};
ZmOrganizer.prototype.getChildByPath=function(n){
var e=this;
if(n.match(/^\//)){
while(e.nId!=ZmOrganizer.ID_ROOT){
e=e.parent
}
n=n.substr(1)
}
if(n.length==0){
return e
}
var o=n.split("/");
var a=0;
while(a<o.length){
var t=o[a++];
var s=e.getChild(t);
if(s==null){
return null
}
e=s
}
return e
};
ZmOrganizer.prototype.reparent=function(e){
if(this.parent){
this.parent.children.remove(this)
}
if(e){
e.children.add(this)
}
this.parent=e
};
ZmOrganizer.prototype.getById=function(r){
if(this.link&&r&&typeof(r)=="string"){
var n=r.split(":");
if(this.zid==n[0]&&this.rid==n[1]){
return this
}}
if(this.id==r||this.nId==r){
return this
}
var e;
var t=this.children.getArray();
var s=this.children.size();
for(var o=0;
o<s;
o++){
if(e=t[o].getById(r)){
return e
}}
return null
};
ZmOrganizer.prototype.getByName=function(t,e){
return this._getByName(t.toLowerCase(),e)
};
ZmOrganizer.prototype.getByType=function(e){
var t=[];
this._getByType(e,t);
return t
};
ZmOrganizer.prototype._getByType=function(o,n){
if(this.type==o){
n.push(this)
}
var e=this.children.getArray();
for(var t=0;
t<e.length;
t++){
if(e[t]){
e[t]._getByType(o,n)
}}};
ZmOrganizer.prototype.getByPath=function(t,e){
return this._getByPath(t.toLowerCase(),e)
};
ZmOrganizer.prototype._getByPath=function(s,o){
if(this.nId==ZmFolder.ID_TAGS){
return null
}
if(s==this.getPath(false,false,null,true,o).toLowerCase()){
return this
}
var t=this.children.getArray();
for(var n=0;
n<t.length;
n++){
var e=t[n]._getByPath(s,o);
if(e){
return e
}}
return null
};
ZmOrganizer.prototype.size=function(){
return this.children.size()
};
ZmOrganizer.prototype.isChildOf=function(e){
var t=this.parent;
while(t){
if(t==e){
return true
}
t=t.parent
}
return false
};
ZmOrganizer.prototype._getNewParent=function(e){
return appCtxt.getById(e)
};
ZmOrganizer.prototype.isUnder=function(t){
if(this.nId==t||(this.isRemote()&&this.rid==t)){
return true
}
var e=this.parent;
while(e&&e.nId!=ZmOrganizer.ID_ROOT){
if(e.nId==t){
return true
}
e=e.parent
}
return false
};
ZmOrganizer.prototype.isInTrash=function(){
return this.isUnder(ZmOrganizer.ID_TRASH)
};
ZmOrganizer.prototype.isPermAllowed=function(t){
if(this.perm){
var e=this.perm.replace(/-./g,"");
return(e.indexOf(t)!=-1)
}
return false
};
ZmOrganizer.prototype.isReadOnly=function(){
if(this._isReadOnly==null){
var e=this.getMainShare();
this._isReadOnly=(e!=null)?(this.isRemote()&&!e.isWrite()):(this.isRemote()&&this.isPermAllowed(ZmOrganizer.PERM_READ)&&!this.isPermAllowed(ZmOrganizer.PERM_WRITE))
}
return this._isReadOnly
};
ZmOrganizer.prototype.isAdmin=function(){
if(this._isAdmin==null){
var e=this.getMainShare();
this._isAdmin=(e!=null)?(this.isRemote()&&e.isAdmin()):(this.isRemote()&&this.isPermAllowed(ZmOrganizer.PERM_ADMIN))
}
return this._isAdmin
};
ZmOrganizer.prototype.hasPrivateAccess=function(){
if(this._hasPrivateAccess==null){
var e=this.getMainShare();
this._hasPrivateAccess=(e!=null)?(this.isRemote()&&e.hasPrivateAccess()):(this.isRemote()&&this.isPermAllowed(ZmOrganizer.PERM_PRIVATE))
}
return this._hasPrivateAccess
};
ZmOrganizer.prototype.isRemote=function(){
if(this._isRemote==null){
if(this.zid!=null){
this._isRemote=true
}else{
if(appCtxt.multiAccounts){
var t=this.account;
var e=ZmOrganizer.parseId(this.id);
if(!t){
if(e.account&&e.account.isMain){
this._isRemote=false;
return this._isRemote
}else{
t=appCtxt.getActiveAccount()
}}
this._isRemote=(e.account&&(e.account!=t))
}else{
var a=String(this.id);
this._isRemote=((a.indexOf(":")!=-1)&&(a.indexOf(appCtxt.getActiveAccount().id)!=0))
}}}
return this._isRemote
};
ZmOrganizer.prototype.isSystem=function(){
return(this.nId<ZmOrganizer.FIRST_USER_ID[this.type])
};
ZmOrganizer.prototype.isFeed=function(){
return Boolean(this.url)
};
ZmOrganizer.prototype.isDataSource=function(t,a){
var e=this.getDataSources(t,a);
return(e&&e.length>0)
};
ZmOrganizer.prototype.getDataSources=function(t,a){
if(!appCtxt.get(ZmSetting.MAIL_ENABLED)){
return null
}
var e=appCtxt.getDataSourceCollection();
var o=e.getByFolderId(this.nId,t);
if(o.length==0){
return(a&&this.parent)?this.parent.getDataSources(t,a):null
}
return o
};
ZmOrganizer.prototype.getOwner=function(){
return(this.owner||appCtxt.get(ZmSetting.USERNAME))
};
ZmOrganizer.getSortIndex=function(n,e){
if(!(n&&n.parent&&e)){
return null
}
var a=n.parent.children.getArray();
for(var t=0;
t<a.length;
t++){
var o=e(n,a[t]);
if(o==-1){
return t
}}
return t
};
ZmOrganizer.prototype._organizerAction=function(s){
var n=ZmOrganizer.SOAP_CMD[this.type];
var o=AjxSoapDoc.create(n+"Request","urn:zimbraMail");
var a=o.set("action");
a.setAttribute("op",s.action);
a.setAttribute("id",s.id||this.id);
for(var e in s.attrs){
if(AjxEnv.isIE){
s.attrs[e]+=""
}
a.setAttribute(e,s.attrs[e])
}
var r=new AjxCallback(this,this._handleResponseOrganizerAction,s);
if(s.batchCmd){
s.batchCmd.addRequestParams(o,r,s.errorCallback)
}else{
var t;
if(appCtxt.multiAccounts){
t=(this.account)?this.account.name:appCtxt.accountList.mainAccount.name
}
appCtxt.getAppController().sendRequest({
soapDoc:o,asyncMode:true,accountName:t,callback:r,errorCallback:s.errorCallback}
)
}};
ZmOrganizer.prototype._handleResponseOrganizerAction=function(t,e){
if(t.callback){
t.callback.run(e)
}};
ZmOrganizer.prototype._getByName=function(n,t){
if(this.name&&n==this.name.toLowerCase()){
return this
}
var e;
var o=this.children.getArray();
var r=this.children.size();
for(var s=0;
s<r;
s++){
if(e=o[s]._getByName(n,t)){
if(t&&e.isDataSource(ZmAccount.TYPE_IMAP,true)){
continue
}
return e
}}
return null
};
ZmOrganizer.prototype._parseFlags=function(a){
for(var t=0;
t<ZmOrganizer.ALL_FLAGS.length;
t++){
var e=ZmOrganizer.ALL_FLAGS[t];
this[ZmOrganizer.FLAG_PROP[e]]=(Boolean(a&&(a.indexOf(e)!=-1)))
}};
ZmOrganizer.prototype._setFlags=function(){
var t="";
for(var a=0;
a<ZmOrganizer.ALL_FLAGS.length;
a++){
var e=ZmOrganizer.ALL_FLAGS[a];
var o=ZmOrganizer.FLAG_PROP[e];
if(this[o]){
t=t+e
}}
return t
};
ZmOrganizer.prototype.addChangeListener=function(e){
this.tree.addChangeListener(e)
};
ZmOrganizer.prototype.removeChangeListener=function(e){
this.tree.removeChangeListener(e)
};
ZmOrganizer.prototype._setSharesFromJs=function(a){
if(a.acl&&a.acl.grant&&a.acl.grant.length>0){
AjxDispatcher.require("Share");
for(var t=0;
t<a.acl.grant.length;
t++){
var e=a.acl.grant[t];
this.addShare(ZmShare.createFromJs(this,e))
}}};
ZmOrganizer.prototype._notify=function(t,e){
if(e){
e.organizers=[this]
}else{
e={
organizers:[this]}
}
this.tree._evt.type=this.type;
this.tree._notify(t,e)
};
ZmOrganizer.prototype._markupName=function(e,a,t){
if(!t){
e=AjxStringUtil.htmlEncode(e,true)
}
if(a&&this.numUnread>0){
e=AjxMessageFormat.format(ZmMsg.folderUnread,[e,this.numUnread]);
if(!t){
e=["<span style='font-weight:bold'>",e,"</span>"].join("")
}}
if(this.noSuchFolder&&!t){
e=["<del>",e,"</del>"].join("")
}
return e
};
ZmOrganizer.prototype._getItemsText=function(){
var e=ZmMsg[ZmOrganizer.ITEMS_KEY[this.type]];
if(!e||(this.nId==ZmFolder.ID_TRASH)){
e=ZmMsg.items
}
return e
}
}
if(AjxPackage.define("zimbraMail.share.model.ZmFolder")){
ZmFolder=function(e){
if(arguments.length==0){
return
}
e.type=e.type||ZmOrganizer.FOLDER;
ZmOrganizer.call(this,e)
};
ZmFolder.prototype=new ZmOrganizer;
ZmFolder.prototype.constructor=ZmFolder;
ZmOrganizer.ORG_CLASS[ZmId.ORG_FOLDER]="ZmFolder";
ZmFolder.SEP="/";
ZmFolder.ID_LOAD_FOLDERS=-3;
ZmFolder.ID_OTHER=-2;
ZmFolder.ID_SEP=-1;
ZmFolder.ID_ROOT=ZmOrganizer.ID_ROOT;
ZmFolder.ID_INBOX=ZmOrganizer.ID_INBOX;
ZmFolder.ID_TRASH=ZmOrganizer.ID_TRASH;
ZmFolder.ID_SPAM=ZmOrganizer.ID_SPAM;
ZmFolder.ID_SENT=5;
ZmFolder.ID_DRAFTS=6;
ZmFolder.ID_CONTACTS=ZmOrganizer.ID_ADDRBOOK;
ZmFolder.ID_AUTO_ADDED=ZmOrganizer.ID_AUTO_ADDED;
ZmFolder.ID_TAGS=8;
ZmFolder.ID_TASKS=ZmOrganizer.ID_TASKS;
ZmFolder.ID_SYNC_FAILURES=ZmOrganizer.ID_SYNC_FAILURES;
ZmFolder.ID_OUTBOX=ZmOrganizer.ID_OUTBOX;
ZmFolder.ID_CHATS=ZmOrganizer.ID_CHATS;
ZmFolder.ID_ATTACHMENTS=ZmOrganizer.ID_ATTACHMENTS;
ZmFolder.MSG_KEY={};
ZmFolder.MSG_KEY[ZmFolder.ID_INBOX]="inbox";
ZmFolder.MSG_KEY[ZmFolder.ID_TRASH]="trash";
ZmFolder.MSG_KEY[ZmFolder.ID_SPAM]="junk";
ZmFolder.MSG_KEY[ZmFolder.ID_SENT]="sent";
ZmFolder.MSG_KEY[ZmFolder.ID_DRAFTS]="drafts";
ZmFolder.MSG_KEY[ZmFolder.ID_CONTACTS]="contacts";
ZmFolder.MSG_KEY[ZmFolder.ID_AUTO_ADDED]="emailedContacts";
ZmFolder.MSG_KEY[ZmFolder.ID_TASKS]="tasks";
ZmFolder.MSG_KEY[ZmFolder.ID_TAGS]="tags";
ZmFolder.MSG_KEY[ZmOrganizer.ID_CALENDAR]="calendar";
ZmFolder.MSG_KEY[ZmOrganizer.ID_NOTEBOOK]="notebook";
ZmFolder.MSG_KEY[ZmOrganizer.ID_BRIEFCASE]="briefcase";
ZmFolder.MSG_KEY[ZmOrganizer.ID_CHATS]="chats";
ZmFolder.MSG_KEY[ZmOrganizer.ID_GLOBAL_INBOX]="globalInbox";

ZmFolder.MSG_KEY[ZmFolder.ID_OUTBOX]="outbox";
ZmFolder.MSG_KEY[ZmFolder.ID_SYNC_FAILURES]="errorReports";
ZmFolder.MSG_KEY[ZmFolder.ID_ATTACHMENTS]="attachments";
ZmFolder.ICON={};
ZmFolder.ICON[ZmFolder.ID_INBOX]="Inbox";
ZmFolder.ICON[ZmFolder.ID_TRASH]="Trash";
ZmFolder.ICON[ZmFolder.ID_SPAM]="SpamFolder";
ZmFolder.ICON[ZmFolder.ID_SENT]="SentFolder";
ZmFolder.ICON[ZmFolder.ID_SYNC_FAILURES]="SendReceive";
ZmFolder.ICON[ZmFolder.ID_OUTBOX]="Outbox";
ZmFolder.ICON[ZmFolder.ID_DRAFTS]="DraftFolder";
ZmFolder.ICON[ZmFolder.ID_CHATS]="ChatFolder";
ZmFolder.ICON[ZmFolder.ID_LOAD_FOLDERS]="Plus";
ZmFolder.ICON[ZmFolder.ID_ATTACHMENTS]="Attachment";
ZmFolder.QUERY_NAME={};
ZmFolder.QUERY_NAME[ZmFolder.ID_INBOX]="inbox";
ZmFolder.QUERY_NAME[ZmFolder.ID_TRASH]="trash";
ZmFolder.QUERY_NAME[ZmFolder.ID_SPAM]="junk";
ZmFolder.QUERY_NAME[ZmFolder.ID_SENT]="sent";
ZmFolder.QUERY_NAME[ZmFolder.ID_OUTBOX]="outbox";
ZmFolder.QUERY_NAME[ZmFolder.ID_DRAFTS]="drafts";
ZmFolder.QUERY_NAME[ZmFolder.ID_CONTACTS]="contacts";
ZmFolder.QUERY_NAME[ZmFolder.ID_TASKS]="tasks";
ZmFolder.QUERY_NAME[ZmFolder.ID_AUTO_ADDED]="Emailed Contacts";
ZmFolder.QUERY_NAME[ZmOrganizer.ID_NOTEBOOK]="notebook";
ZmFolder.QUERY_NAME[ZmOrganizer.ID_BRIEFCASE]="briefcase";
ZmFolder.QUERY_NAME[ZmFolder.ID_CHATS]="chats";
ZmFolder.QUERY_NAME[ZmFolder.ID_SYNC_FAILURES]="Error Reports";
ZmFolder.QUERY_ID={};
for(var id in ZmFolder.QUERY_NAME){
ZmFolder.QUERY_ID[ZmFolder.QUERY_NAME[id]]=id
}
ZmFolder.SORT_ORDER={};
ZmFolder.SORT_ORDER[ZmFolder.ID_INBOX]=1;
ZmFolder.SORT_ORDER[ZmFolder.ID_CHATS]=2;
ZmFolder.SORT_ORDER[ZmFolder.ID_SENT]=3;
ZmFolder.SORT_ORDER[ZmFolder.ID_DRAFTS]=4;
ZmFolder.SORT_ORDER[ZmFolder.ID_SPAM]=5;
ZmFolder.SORT_ORDER[ZmFolder.ID_OUTBOX]=6;
ZmFolder.SORT_ORDER[ZmFolder.ID_TRASH]=7;
ZmFolder.SORT_ORDER[ZmFolder.ID_SYNC_FAILURES]=8;
ZmFolder.SORT_ORDER[ZmFolder.ID_SEP]=9;
ZmFolder.SORT_ORDER[ZmFolder.ID_ATTACHMENTS]=99;
ZmFolder.TCON_CODE={};
ZmFolder.TCON_CODE[ZmFolder.ID_TRASH]="t";
ZmFolder.TCON_CODE[ZmFolder.ID_SYNC_FAILURES]="o";
ZmFolder.TCON_CODE[ZmFolder.ID_SPAM]="j";
ZmFolder.TCON_CODE[ZmFolder.ID_SENT]="s";
ZmFolder.TCON_CODE[ZmFolder.ID_OTHER]="o";
ZmFolder.HIDE_ID={};
ZmFolder.HIDE_ID[ZmOrganizer.ID_CHATS]=true;
ZmFolder.HIDE_ID[ZmOrganizer.ID_NOTIFICATION_MP]=true;
ZmFolder.HIDE_NAME={};
ZmFolder.SYNC_ISSUES="Sync Issues";
ZmFolder.QUERY_ID={};
(function(){
for(var e in ZmFolder.QUERY_NAME){
ZmFolder.QUERY_ID[ZmFolder.QUERY_NAME[e]]=e
}}
)();
ZmFolder.sortCompare=function(a,t){
var e=ZmOrganizer.checkSortArgs(a,t);
if(e!=null){
return e
}
if(appCtxt.isOffline){
if(a.isDataSource(ZmAccount.TYPE_POP)){
if(a.id==ZmFolder.ID_INBOX){
return -1
}
if(t.isDataSource(ZmAccount.TYPE_POP)){
if(a.name.toLowerCase()>t.name.toLowerCase()){
return 1
}
if(a.name.toLowerCase()<t.name.toLowerCase()){
return -1
}
return 0
}
return -1
}else{
if(t.isDataSource(ZmAccount.TYPE_POP)){
return 1
}}}
if(ZmFolder.SORT_ORDER[a.nId]&&ZmFolder.SORT_ORDER[t.nId]){
return(ZmFolder.SORT_ORDER[a.nId]-ZmFolder.SORT_ORDER[t.nId])
}
if(!ZmFolder.SORT_ORDER[a.nId]&&ZmFolder.SORT_ORDER[t.nId]){
return 1
}
if(ZmFolder.SORT_ORDER[a.nId]&&!ZmFolder.SORT_ORDER[t.nId]){
return -1
}
if(a.name.toLowerCase()>t.name.toLowerCase()){
return 1
}
if(a.name.toLowerCase()<t.name.toLowerCase()){
return -1
}
return 0
};
ZmFolder.sortComparePath=function(n,o){
var a=n&&n.getPath(false,false,null,true,true);
var t=o&&o.getPath(false,false,null,true,true);
var e=ZmOrganizer.checkSortArgs(a,t);
if(e!=null){
return e
}
if(ZmFolder.SORT_ORDER[n.nId]&&ZmFolder.SORT_ORDER[o.nId]){
return(ZmFolder.SORT_ORDER[n.nId]-ZmFolder.SORT_ORDER[o.nId])
}
if(!ZmFolder.SORT_ORDER[n.nId]&&ZmFolder.SORT_ORDER[o.nId]){
return 1
}
if(ZmFolder.SORT_ORDER[n.nId]&&!ZmFolder.SORT_ORDER[o.nId]){
return -1
}
if(a.toLowerCase()>t.toLowerCase()){
return 1
}
if(a.toLowerCase()<t.toLowerCase()){
return -1
}
return 0
};
ZmFolder.checkName=function(a,o){
var t=ZmOrganizer.checkName(a);
if(t){
return t
}
o=o||appCtxt.getFolderTree().root;
if(o&&(o.id==ZmFolder.ID_ROOT)){
var e=a.toLowerCase();
for(var s in ZmFolder.MSG_KEY){
var n=ZmMsg[ZmFolder.MSG_KEY[s]];
if(n&&(e==n.toLowerCase())){
return ZmMsg.folderNameReserved
}}
if(e==ZmFolder.SYNC_ISSUES.toLowerCase()){
return ZmMsg.folderNameReserved
}}
return null
};
ZmFolder.getIdForName=function(a){
var e=a.toLowerCase();
for(var t in ZmFolder.MSG_KEY){
if(ZmFolder.MSG_KEY[t]==e){
return t
}}
return null
};
ZmFolder.prototype.toString=function(){
return"ZmFolder"
};
ZmFolder.prototype.move=function(a){
var t=this.name;
var e=this.name;
while(a.hasChild(e)){
e=e+"_"
}
if(t!=e){
this.rename(e)
}
ZmOrganizer.prototype.move.call(this,a)
};
ZmFolder.prototype.toggleSyncOffline=function(s,e){
if(!this.isOfflineSyncable){
return
}
var n=this.isOfflineSyncing?"!syncon":"syncon";
var a=AjxSoapDoc.create("FolderActionRequest","urn:zimbraMail");
var t=a.set("action");
t.setAttribute("op",n);
t.setAttribute("id",this.id);
var o={
soapDoc:a,asyncMode:true,callback:s,errorCallback:e};
appCtxt.getAppController().sendRequest(o)
};
ZmFolder.prototype.hasFeeds=function(){
if(this.type!=ZmOrganizer.FOLDER){
return false
}
var e=this.children.getArray();
var o=this.children.size();
for(var t=0;
t<o;
t++){
if(e[t].isFeed()){
return true
}
if(e[t].children&&e[t].children.size()>0){
return(e[t].hasFeeds&&e[t].hasFeeds())
}}
return false
};
ZmFolder.prototype.hasSearch=function(n){
if(this.type==ZmOrganizer.SEARCH){
return true
}
var e=this.children.getArray();
var o=this.children.size();
for(var t=0;
t<o;
t++){
if(e[t].hasSearch()){
return true
}}
return false
};
ZmFolder.prototype.supportsPublicAccess=function(){
return false
};
ZmFolder.prototype.notifyCreate=function(h,t,o){
var e=ZmOrganizer.normalizeId(h.id);
if(e<ZmOrganizer.FIRST_USER_ID[this.type]){
return
}
var r=ZmOrganizer.parseId(h.id).account;
var n=t?"search":"folder";
var s=ZmFolderTree.createFromJs(this,h,this.tree,n,null,r);
var a=ZmOrganizer.getSortIndex(s,ZmFolder.sortCompare);
this.children.add(s,a);
if(!o){
s._notify(ZmEvent.E_CREATE)
}};
ZmFolder.prototype.notifyModify=function(obj){
var details={};
var fields={};
var doNotify=false;
if(obj.name!=null&&this.name!=obj.name&&obj.id==this.id){
details.oldPath=this.getPath();
this.name=obj.name;
fields[ZmOrganizer.F_NAME]=true;
this.parent.children.sort(eval(ZmTreeView.COMPARE_FUNC[this.type]));
doNotify=true;
obj.name=null
}
if(doNotify){
details.fields=fields;
this._notify(ZmEvent.E_MODIFY,details)
}
if(obj.l!=null&&(!this.parent||(obj.l!=this.parent.id))){
var newParent=this._getNewParent(obj.l);
if(newParent){
details.oldPath=this.getPath();
this.reparent(newParent);
this._notify(ZmEvent.E_MOVE,details);
obj.l=null
}}
ZmOrganizer.prototype.notifyModify.apply(this,[obj])
};
ZmFolder.prototype.createQuery=function(t){
if(!this.isRemote()&&this.isSystem()){
var o=ZmFolder.QUERY_NAME[this.nId];
return t?o:('in:"'+(o||this.name)+'"')
}
var n=this.name;
var a=this.parent;
while(a&&(a.nId!=ZmFolder.ID_ROOT)&&a.name.length){
var e=a.isSystem()?ZmFolder.QUERY_NAME[a.nId]:a.name;
n=e+"/"+n;
a=a.parent
}
n='"'+n+'"';
return t?n:("in:"+n)
};
ZmFolder.prototype.getName=function(s,t,n,e){
if(this.nId==ZmFolder.ID_DRAFTS||this.nId==ZmFolder.ID_OUTBOX){
var o=(appCtxt.isOffline&&this.account.isMain)?appCtxt.accountList.getItemCount(this.nId):this.numTotal;
var a=(e&&this._systemName)?this._systemName:this.name;
if(s&&o>0){
a=[a," (",o,")"].join("");
if(!n){
a=["<span style='font-weight:bold'>",a,"</span>"].join("")
}}
return a
}else{
return ZmOrganizer.prototype.getName.apply(this,arguments)
}};
ZmFolder.prototype.getIcon=function(){
if(this.nId==ZmOrganizer.ID_ROOT){
return null
}
if(ZmFolder.ICON[this.nId]){
return ZmFolder.ICON[this.nId]
}
if(this.isFeed()){
return"RSS"
}
if(this.isRemote()){
return"SharedMailFolder"
}
if(this.isDataSource(ZmAccount.TYPE_POP)){
return"POPAccount"
}
if(this.parent&&this.parent.isDataSource(ZmAccount.TYPE_IMAP)){
var e=ZmFolder.getIdForName(this.name);
if(e){
return ZmFolder.ICON[e]||"Folder"
}}
return"Folder"
};
ZmFolder.prototype.mayContain=function(s,h){
if(!s){
return true
}
if(this.isFeed()){
return false
}
if(this.isSyncIssuesFolder()){
return false
}
var r=h||this.type;
var o=false;
if(s instanceof ZmFolder){
o=(s.parent==this||this.isChildOf(s)||this.nId==ZmFolder.ID_DRAFTS||this.nId==ZmFolder.ID_SPAM||(!this.isInTrash()&&this.hasChild(s.name))||(s.type==ZmOrganizer.FOLDER&&r==ZmOrganizer.SEARCH)||(s.type==ZmOrganizer.SEARCH&&r==ZmOrganizer.FOLDER&&this.nId==ZmOrganizer.ID_ROOT)||(s.id==this.id)||(s.disallowSubFolder)||(s.account!=this.account)||(s.isRemote()&&!this._remoteMoveOk(s)))
}else{
var n=(s instanceof Array)?s:[s];
var l=n[0];
if(this.nId==ZmOrganizer.ID_ROOT||this.nId==ZmOrganizer.ID_OUTBOX||this.nId==ZmOrganizer.ID_SYNC_FAILURES){
o=true
}else{
if(r==ZmOrganizer.SEARCH){
o=true
}else{
if((l.type==ZmItem.CONTACT)&&l.isGal){
o=true
}else{
if((l.type==ZmItem.CONV)&&l.list&&l.list.search&&(l.list.search.folderId==this.id)){
o=true
}else{
for(var t=0;
t<n.length;
t++){
if(n[t].type==ZmItem.CONTACT){
if(this.nId!=ZmFolder.ID_TRASH){
o=true;
break
}else{
if(n[t].isMyCard){
o=true;
break
}}}else{
if(n[t].isDraft&&(this.nId!=ZmFolder.ID_TRASH&&this.nId!=ZmFolder.ID_DRAFTS)){
o=true;
break
}else{
if(this.nId==ZmFolder.ID_DRAFTS&&!n[t].isDraft){
o=true;
break
}}}}
if(appCtxt.isOffline&&!o){
if(l.account!=this.account&&this.account.type==ZmAccount.TYPE_MSE){
o=true
}else{
var a=appCtxt.getCurrentSearch();
var e=a&&appCtxt.getById(a.folderId);
if(e&&e.nId==ZmOrganizer.ID_SYNC_FAILURES){
o=true
}}}
if(!o){
if(l.folderId){
o=true;
for(var t=0;
t<n.length;
t++){
if(n[t].folderId!=this.id){
o=false;
break
}}}}}}}}
if(!o&&this.link){
o=this.isReadOnly()
}}
return !o
};
ZmFolder.prototype.isSyncIssuesFolder=function(){
return(this.name==ZmFolder.SYNC_ISSUES)
};
ZmFolder.prototype.isHardDelete=function(){
return(this.isInTrash()||this.isInSpam()||(appCtxt.isOffline&&this.isUnder(ZmOrganizer.ID_SYNC_FAILURES)))
};
ZmFolder.prototype.isInSpam=function(){
return this.isUnder(ZmFolder.ID_SPAM)
};
ZmFolder.prototype._remoteMoveOk=function(t){
if(!this.link||!t.link||this.zid!=t.zid){
return false
}
if(this.id.split(":")[0]!=t.id.split(":")[0]){
return false
}
var e=this.shares&&this.shares[0];
if(!(e&&e.isInsert())){
return false
}
e=t.shares&&t.shares[0];
return(e&&e.isDelete())
}
}
if(AjxPackage.define("zimbraMail.share.model.ZmSearchFolder")){
ZmSearchFolder=function(t){
t.type=ZmOrganizer.SEARCH;
ZmFolder.call(this,t);
if(t.query){
var e={
query:t.query,types:t.types,sortBy:t.sortBy,searchId:t.id,accountName:(t.account&&t.account.name)};
this.search=new ZmSearch(e)
}};
ZmSearchFolder.ID_ROOT=ZmOrganizer.ID_ROOT;
ZmSearchFolder.create=function(h){
var r=AjxSoapDoc.create("CreateSearchFolderRequest","urn:zimbraMail");
var s=r.set("search");
s.setAttribute("name",h.name);
s.setAttribute("query",h.search.query);
if(h.search.types){
var t=h.search.types.getArray();
if(t.length){
var e=[];
for(var n=0;
n<t.length;
n++){
e.push(ZmSearch.TYPE[t[n]])
}
s.setAttribute("types",e.join(","))
}}
if(h.search.sortBy){
s.setAttribute("sortBy",h.search.sortBy)
}
var o;
if(h.isGlobal){
s.setAttribute("f","g");
o=appCtxt.accountList.mainAccount.name
}
s.setAttribute("l",h.parent.id);
appCtxt.getAppController().sendRequest({
soapDoc:r,asyncMode:true,accountName:o,errorCallback:(new AjxCallback(null,ZmOrganizer._handleErrorCreate,h))}
)
};
ZmSearchFolder.prototype=new ZmFolder;
ZmSearchFolder.prototype.constructor=ZmSearchFolder;
ZmSearchFolder.prototype.toString=function(){
return"ZmSearchFolder"
};
ZmSearchFolder.prototype.getIcon=function(){
return(this.nId==ZmOrganizer.ID_ROOT)?null:(this.isOfflineGlobalSearch?"GlobalSearchFolder":"SearchFolder")
};
ZmSearchFolder.prototype.getToolTip=function(){};
ZmSearchFolder.prototype._getNewParent=function(t){
var e=appCtxt.getById(t);
if(e){
return e
}
return appCtxt.getById(t)
}
}
if(AjxPackage.define("zimbraMail.share.model.ZmSearch")){
ZmSearch=function(t){
if(t){
for(var e in t){
this[e]=t[e]
}
this.galType=this.galType||ZmSearch.GAL_ACCOUNT;
this.join=this.join||ZmSearch.JOIN_AND;
if(this.query){
this._parseQuery()
}}
this.isGalSearch=false;
this.isCalResSearch=false;
if(ZmSearch._mailEnabled==null){
ZmSearch._mailEnabled=appCtxt.get(ZmSetting.MAIL_ENABLED);
if(ZmSearch._mailEnabled){
AjxDispatcher.require("MailCore")
}}};
ZmSearch.TYPE={};
ZmSearch.TYPE_ANY="any";
ZmSearch.GAL_ACCOUNT="account";
ZmSearch.GAL_RESOURCE="resource";
ZmSearch.GAL_ALL="";
ZmSearch.JOIN_AND=1;
ZmSearch.JOIN_OR=2;
ZmSearch.TYPE_MAP={};
ZmSearch.DEFAULT_LIMIT=DwtListView.DEFAULT_LIMIT;
ZmSearch.DATE_DESC="dateDesc";
ZmSearch.DATE_ASC="dateAsc";
ZmSearch.SUBJ_DESC="subjDesc";
ZmSearch.SUBJ_ASC="subjAsc";
ZmSearch.NAME_DESC="nameDesc";
ZmSearch.NAME_ASC="nameAsc";
ZmSearch.SIZE_DESC="sizeDesc";
ZmSearch.SIZE_ASC="sizeAsc";
ZmSearch.SCORE_DESC="scoreDesc";
ZmSearch.DURATION_DESC="durDesc";
ZmSearch.DURATION_ASC="durAsc";
ZmSearch.STATUS_DESC="taskStatusDesc";
ZmSearch.STATUS_ASC="taskStatusAsc";
ZmSearch.PCOMPLETE_DESC="taskPercCompletedDesc";
ZmSearch.PCOMPLETE_ASC="taskPercCompletedAsc";
ZmSearch.DUE_DATE_DESC="taskDueDesc";
ZmSearch.DUE_DATE_ASC="taskDueAsc";
ZmSearch.UNREAD_QUERY_RE=new RegExp("\\bis:\\s*(un)?read\\b","i");
ZmSearch.IS_ANYWHERE_QUERY_RE=new RegExp("\\bis:\\s*anywhere\\b","i");
ZmSearch.prototype.toString=function(){
return"ZmSearch"
};
ZmSearch.prototype.execute=function(e){
if(e.batchCmd||this.soapInfo){
this._executeSoap(e)
}else{
this._executeJson(e)
}};
ZmSearch.prototype._executeSoap=function(s){
this.isGalSearch=(this.contactSource&&(this.contactSource==ZmId.SEARCH_GAL));
this.isCalResSearch=(this.conds!=null);
if(!this.query&&!this.isCalResSearch){
return
}
var p;
if(!this.response){
if(this.isGalSearch){
p=AjxSoapDoc.create("SearchGalRequest","urn:zimbraAccount");
var e=p.getMethod();
if(this.galType){
e.setAttribute("type",this.galType)
}
p.set("name",this.query)
}else{
if(this.isAutocompleteSearch){
p=AjxSoapDoc.create("AutoCompleteRequest","urn:zimbraMail");
var e=p.getMethod();
if(this.limit){
e.setAttribute("limit",this.limit)
}
p.set("name",this.query)
}else{
if(this.isGalAutocompleteSearch){
p=AjxSoapDoc.create("AutoCompleteGalRequest","urn:zimbraAccount");
var e=p.getMethod();
e.setAttribute("limit",this._getLimit());
if(this.galType){
e.setAttribute("type",this.galType)
}
p.set("name",this.query)
}else{
if(this.isCalResSearch){
p=AjxSoapDoc.create("SearchCalendarResourcesRequest","urn:zimbraAccount");
var e=p.getMethod();
if(this.attrs){
e.setAttribute("attrs",this.attrs.join(","))
}
var l=p.set("searchFilter");
if(this.conds&&this.conds.length){
var h=p.set("conds",null,l);
if(this.join==ZmSearch.JOIN_OR){
h.setAttribute("or",1)
}
for(var r=0;
r<this.conds.length;
r++){
var u=this.conds[r];
var t=p.set("cond",null,h);
t.setAttribute("attr",u.attr);
t.setAttribute("op",u.op);
t.setAttribute("value",u.value)
}}}else{
if(this.soapInfo){
p=AjxSoapDoc.create(this.soapInfo.method,this.soapInfo.namespace);
for(var f in this.soapInfo.additional){
var n=p.set(f);
var g=this.soapInfo.additional[f];
for(var c in g){
n.setAttribute(c,g[c])
}}}else{
p=AjxSoapDoc.create("SearchRequest","urn:zimbraMail")
}
var e=this._getStandardMethod(p);
if(this.types){
var m=this.types.getArray();
if(m.length){
var d=[];
for(var r=0;
r<m.length;
r++){
d.push(ZmSearch.TYPE[m[r]])
}
e.setAttribute("types",d.join(","));
var o=appCtxt.getById(this.folderId);
if(o&&(o.isUnder(ZmFolder.ID_SENT)||o.isUnder(ZmFolder.ID_DRAFTS)||o.isUnder(ZmFolder.ID_OUTBOX))){
e.setAttribute("recip","1")
}
if(this.fetch){
e.setAttribute("fetch",(this.fetch=="all")?"all":"1");
if(this.getHtml){
e.setAttribute("html","1")
}}
if(this.markRead){
e.setAttribute("read","1")
}}}}}}}}
var y=new AjxCallback(this,this._handleResponseExecute,[s.callback]);
if(s.batchCmd){
s.batchCmd.addRequestParams(p,y)
}else{
return appCtxt.getAppController().sendRequest({
soapDoc:p,asyncMode:true,callback:y,errorCallback:s.errorCallback,timeout:s.timeout,noBusyOverlay:s.noBusyOverlay,response:this.response}
)
}};
ZmSearch.prototype._executeJson=function(y){
this.isGalSearch=(this.contactSource&&(this.contactSource==ZmId.SEARCH_GAL));
this.isCalResSearch=(this.conds!=null);
if(!this.query&&!this.queryHint&&!this.isCalResSearch){
return
}
var w,s,v;
if(!this.response){
if(this.isGalSearch){
w={
SearchGalRequest:{
_jsns:"urn:zimbraAccount"}};
s=w.SearchGalRequest;
if(this.galType){
s.type=this.galType
}
s.name=this.query;
s.offset=this.offset=(this.offset||0);
s.limit=this._getLimit();
if(this.lastId){
s.cursor={
id:this.lastId,sortVal:(this.lastSortVal||"")}
}
if(this.sortBy){
s.sortBy=this.sortBy
}}else{
if(this.isAutocompleteSearch){
w={
AutoCompleteRequest:{
_jsns:"urn:zimbraMail"}};
s=w.AutoCompleteRequest;
if(this.limit){
s.limit=this.limit
}
s.name={
_content:this.query}
}else{
if(this.isGalAutocompleteSearch){
w={
AutoCompleteGalRequest:{
_jsns:"urn:zimbraAccount"}};
s=w.AutoCompleteGalRequest;
s.limit=this._getLimit();
s.name=this.query;
if(this.galType){
s.type=this.galType
}}else{
if(this.isCalResSearch){
w={
SearchCalendarResourcesRequest:{
_jsns:"urn:zimbraAccount"}};
s=w.SearchCalendarResourcesRequest;
if(this.attrs){
s.attrs=this.attrs.join(",")
}
if(this.conds&&this.conds.length){
s.searchFilter={
conds:{}};
var t=s.searchFilter.conds;
var l=t.cond=[];
if(this.join==ZmSearch.JOIN_OR){
t.or=1
}
for(var p=0;
p<this.conds.length;
p++){
var g=this.conds[p];
l.push({
attr:g.attr,op:g.op,value:g.value}
)
}}}else{
if(this.soapInfo){
v=AjxSoapDoc.create(this.soapInfo.method,this.soapInfo.namespace);
for(var e in this.soapInfo.additional){
var f=v.set(e);
var u=this.soapInfo.additional[e];
for(var m in u){
f.setAttribute(m,u[m])
}}}else{
w={
SearchRequest:{
_jsns:"urn:zimbraMail"}};
s=w.SearchRequest
}
this._getStandardMethodJson(s);
if(this.types){
var b=this.types.getArray();
if(b.length){
var d=[];
for(var p=0;
p<b.length;
p++){
d.push(ZmSearch.TYPE[b[p]])
}
s.types=d.join(",");
var h=appCtxt.getById(this.folderId);
if(h&&(h.isUnder(ZmFolder.ID_SENT)||h.isUnder(ZmFolder.ID_DRAFTS)||h.isUnder(ZmFolder.ID_OUTBOX))){
s.recip=1
}
if(this.fetch){
s.fetch=(this.fetch=="all")?"all":1;
if(this.getHtml){
s.html=1
}}
if(this.markRead){
s.read=1
}
if(this.headers){
for(var o in this.headers){
if(!s.header){
s.header=[]
}
s.header.push({
n:o}
)
}}
if(b.length==1&&b[0]==ZmItem.TASK&&this.allowableTaskStatus){
s.allowableTaskStatus=this.allowableTaskStatus
}}}}}}}}
var n=new AjxCallback(this,this._handleResponseExecute,[y.callback]);
if(y.batchCmd){
y.batchCmd.addRequestParams(v,n)
}else{
var r={
jsonObj:w,soapDoc:v,asyncMode:true,callback:n,errorCallback:y.errorCallback,timeout:y.timeout,noBusyOverlay:y.noBusyOverlay,response:this.response,accountName:this.accountName};
return appCtxt.getAppController().sendRequest(r)
}};
ZmSearch.prototype._handleResponseExecute=function(o,t){
var a=t.getResponse();
if(this.isGalSearch){
a=a.SearchGalResponse
}else{
if(this.isCalResSearch){
a=a.SearchCalendarResourcesResponse
}else{
if(this.isAutocompleteSearch){
a=a.AutoCompleteResponse
}else{
if(this.isGalAutocompleteSearch){
a=a.AutoCompleteGalResponse
}else{
if(this.soapInfo){
a=a[this.soapInfo.response]
}else{
a=a.SearchResponse
}}}}}
var e=new ZmSearchResult(this);
e.set(a);
t.set(e);
if(o){
o.run(t)
}};
ZmSearch.prototype.getConv=function(a){
if((!this.query&&!this.queryHint)||!a.cid){
return
}
var n={
SearchConvRequest:{
_jsns:"urn:zimbraMail"}};
var e=n.SearchConvRequest;
this._getStandardMethodJson(e);
e.cid=a.cid;
if(a.fetchId){
e.fetch=a.fetchId;
if(a.markRead){
e.read=1
}
if(this.getHtml){
e.html=1
}
if(ZmMailMsg.requestHeaders){
for(var o in ZmMailMsg.requestHeaders){
if(!e.header){
e.header=[]
}
e.header.push({
n:o}
)
}}}
if(!a.noTruncate){
e.max=appCtxt.get(ZmSetting.MAX_MESSAGE_SIZE)
}
var t={
jsonObj:n,asyncMode:true,callback:(new AjxCallback(this,this._handleResponseGetConv,a.callback)),accountName:this.accountName};
appCtxt.getAppController().sendRequest(t)
};
ZmSearch.prototype._handleResponseGetConv=function(o,t){
var a=t.getResponse().SearchConvResponse;
var e=new ZmSearchResult(this);
e.set(a,null,true);
t.set(e);
if(o){
o.run(t)
}};
ZmSearch.prototype.getTitle=function(){
var e;
if(this.folderId){
var a=ZmOrganizer.getSystemId(this.folderId);
var t=appCtxt.getById(a);
if(t){
e=t.getName(true,ZmOrganizer.MAX_DISPLAY_NAME_LENGTH,true)
}}else{
if(this.tagId){
e=appCtxt.getById(this.tagId).getName(true,ZmOrganizer.MAX_DISPLAY_NAME_LENGTH,true)
}}
return e?([ZmMsg.zimbraTitle,e].join(": ")):([ZmMsg.zimbraTitle,ZmMsg.searchResults].join(": "))
};
ZmSearch.prototype._getStandardMethod=function(t){
var s=t.getMethod();
if(this.sortBy){
s.setAttribute("sortBy",this.sortBy)
}
if(ZmSearch._mailEnabled){
var e;
for(var n in ZmMailMsg.requestHeaders){
e=t.set("header",null,null);
e.setAttribute("n",n)
}}
ZmTimezone.set(t,AjxTimezone.DEFAULT,null);
t.set("locale",appCtxt.get(ZmSetting.LOCALE_NAME),null);
if(this.lastId!=null&&this.lastSortVal){
var o=t.set("cursor");
o.setAttribute("id",this.lastId);
o.setAttribute("sortVal",this.lastSortVal);
if(this.endSortVal){
o.setAttribute("endSortVal",this.endSortVal)
}}
this.offset=this.offset||0;
s.setAttribute("offset",this.offset);
s.setAttribute("limit",this._getLimit());
var a=(this.queryHint)?([this.query," (",this.queryHint,")"].join("")):this.query;
t.set("query",a);
if(this.field){
s.setAttribute("field",this.field)
}
return s
};
ZmSearch.prototype._getStandardMethodJson=function(t){
if(this.sortBy){
t.sortBy=this.sortBy
}
if(ZmSearch._mailEnabled){
var e=ZmMailMsg.requestHeaders;
if(e&&e.length){
t.header=[];
for(var a in e){
t.header.push({
n:a}
)
}}}
ZmTimezone.set(t,AjxTimezone.DEFAULT);
t.locale={
_content:AjxEnv.DEFAULT_LOCALE};
if(this.lastId!=null&&this.lastSortVal){
t.cursor={
id:this.lastId,sortVal:this.lastSortVal};
if(this.endSortVal){
t.cursor.endSortVal=this.endSortVal
}}
t.offset=this.offset=this.offset||0;
t.limit=this._getLimit();
t.query=(this.queryHint)?([this.query," (",this.queryHint,")"].join("")):this.query;
if(this.field){
t.field=this.field
}};
ZmSearch.prototype._getLimit=function(){
if(this.limit){
return this.limit
}
var e;
if(this.isGalAutocompleteSearch){
e=appCtxt.get(ZmSetting.AUTOCOMPLETE_LIMIT)
}else{
var t=this.types&&this.types.get(0);
var a=appCtxt.getApp(ZmItem.APP[t]);
if(a&&a.getLimit){
e=a.getLimit(this.offset)
}else{
e=appCtxt.get(ZmSetting.PAGE_SIZE)||ZmSearch.DEFAULT_LIMIT
}}
this.limit=e;
return e
};
ZmSearch.IS_OP={
"in":true,inid:true,is:true,tag:true};
ZmSearch.COND={
and:" && ",or:" || ",not:" !"};
ZmSearch.EOW={
" ":true,":":true,"(":true,")":true};
ZmSearch.FLAG={};
ZmSearch.FLAG.unread="item.isUnread";
ZmSearch.FLAG.read="!item.isUnread";
ZmSearch.FLAG.flagged="item.isFlagged";
ZmSearch.FLAG.unflagged="!item.isFlagged";
ZmSearch.FLAG.forwarded="item.isForwarded";
ZmSearch.FLAG.unforwarded="!item.isForwarded";
ZmSearch.FLAG.sent="item.isSent";
ZmSearch.FLAG.replied="item.isReplied";
ZmSearch.FLAG.unreplied="!item.isReplied";
ZmSearch.prototype._parseQuery=function(){
this.hasUnreadTerm=ZmSearch.UNREAD_QUERY_RE.test(this.query);
this.isAnywhere=ZmSearch.IS_ANYWHERE_QUERY_RE.test(this.query);
function l(t,x){
while(x<t.length&&t.charAt(x)==" "){
x++
}
return x
}
function n(T,O){
var z=T.charAt(O);
O++;
var t=false,j,x="";
while(O<T.length&&!t){
j=T.charAt(O);
if(j==z){
t=true
}else{
x+=j;
O++
}}
return t?{
str:x,pos:O+1}
:null
}
var a=this.query;
var b=this.query.length;
var m=[],d,c,w="",r=false,e=false;
var s=l(a,0);
while(s<b&&!r){
d=a.charAt(s);
e=ZmSearch.EOW[d];
if(d==":"){
if(ZmSearch.IS_OP[w]){
c=w;
w="";
s=l(a,s+1);
continue
}else{
r=true
}}
if(e){
if(c&&w){
m.push({
isTerm:true,op:c,arg:w}
);
c=w=""
}else{
if(!c){
if(ZmSearch.COND[w.toLowerCase()]){
m.push(ZmSearch.COND[w.toLowerCase()]);
w=""
}else{
if(w){
r=true
}}}}}
if(d=="'"||d=='"'){
var g=n(a,s);
if(g){
w=g.str;
s=g.pos
}else{
r=true
}}else{
if(d=="("||d==")"){
m.push(d);
s=l(a,s+1)
}else{
if(d=="-"&&!w){
m.push("not");
s=l(a,s+1)
}else{
if(d!=" "){
w+=d
}
s++
}}}}
if(r){
return
}
if((s==a.length)&&c&&w){
m.push({
isTerm:true,op:c,arg:w}
)
}else{
return
}
var h=0,f;
var o=["return Boolean("];
for(var y=0,b=m.length;
y<b;
y++){
var u=m[y];
if(u.isTerm){
if(u.op=="in"||u.op=="inid"){
f=(u.op=="in")?this._getFolderId(u.arg):u.arg;
if(!f){
return
}
o.push("((item.type == ZmItem.CONV) ? item.folders && item.folders['"+f+"'] : item.folderId == '"+f+"')")
}else{
if(u.op=="tag"){
f=this._getTagId(u.arg);
if(!f){
return
}
o.push("item.hasTag('"+f+"')")
}else{
if(u.op=="is"){
var k=ZmSearch.FLAG[u.arg];
if(!k){
return
}
o.push(k)
}}}
h++;
var p=m[y+1];
if(p&&(p.isTerm||p==ZmSearch.COND.not||p=="(")){
o.push(ZmSearch.COND.and)
}}else{
o.push(u)
}}
o.push(")");
try{
this.matches=new Function("item",o.join(""))
}
catch(v){}
if(h==1){
var u=m[0];
if(u.op=="in"||u.op=="inid"){
this.folderId=f
}else{
if(u.op=="tag"){
this.tagId=f
}}}};
ZmSearch.prototype._getFolderId=function(r){
var e=ZmFolder.QUERY_ID[r];
var t=this.accountName;
if(!t){
var s=appCtxt.getActiveAccount();
t=s?s.name:appCtxt.accountList.mainAccount
}
if(!e){
var n=t&&appCtxt.accountList.getAccountByName(t);
var a=appCtxt.getFolderTree(n);
var o=a?a.getByPath(r,true):null;
if(o){
e=o.id
}}
if(t){
e=ZmOrganizer.getSystemId(e,appCtxt.accountList.getAccountByName(t))
}
return e
};
ZmSearch.prototype._getTagId=function(a){
var t=appCtxt.getTagTree();
if(t){
var e=t.getByName(a.toLowerCase());
if(e){
return e.id
}}};
ZmSearch.prototype.hasFolderTerm=function(t){
if(!t){
return false
}
var e=new RegExp('\\s*in:\\s*"?('+AjxStringUtil.regExEscape(t)+')"?\\s*',"i");
var a=new RegExp('(-|not)\\s*in:\\s*"?('+AjxStringUtil.regExEscape(t)+')"?\\s*',"i");
return(e.test(this.query)&&!a.test(this.query))
};
ZmSearch.prototype.replaceFolderTerm=function(a,e){
if(!(a&&e)){
return
}
var t=new RegExp('(\\s*in:\\s*"?)('+AjxStringUtil.regExEscape(a)+')("?\\s*)',"gi");
this.query=this.query.replace(t,"$1"+e+"$3")
};
ZmSearch.prototype.hasTagTerm=function(e){
if(!e){
return false
}
var t=new RegExp('\\s*tag:\\s*"?('+AjxStringUtil.regExEscape(e)+')"?\\s*',"i");
var a=new RegExp('(-|not)\\s*tag:\\s*"?('+AjxStringUtil.regExEscape(e)+')"?\\s*',"i");
return(t.test(this.query)&&!a.test(this.query))
};
ZmSearch.prototype.replaceTagTerm=function(t,e){
if(!(t&&e)){
return
}
var a=new RegExp('(\\s*tag:\\s*"?)('+AjxStringUtil.regExEscape(t)+')("?\\s*)',"gi");
this.query=this.query.replace(a,"$1"+e+"$3")
}
}
if(AjxPackage.define("zimbraMail.share.model.ZmSearchResult")){
ZmSearchResult=function(e){
if(!e){
return
}
this._results={};
this.search=e
};
ZmSearchResult.prototype.toString=function(){
return"ZmSearchResult"
};
ZmSearchResult.prototype.dtor=function(){
for(var e in this._results){
if(this._results[e].clear){
this._results[e].clear();
this._results[e]=null
}}
this._results=null
};
ZmSearchResult.prototype.getResults=function(n){
n=n||this.type;
if(!this._results){
return ZmItem.RESULTS_LIST[n](this.search)
}
if(n==ZmItem.MIXED){
var s=new ZmMailList(ZmItem.MIXED,this.search);
for(var n in this._results){
var o=this._results[n];
if(o&&o.size()){
var e=o.getArray();
for(var t=0;
t<e.length;
t++){
s.add(e[t])
}}}
return s
}else{
return this._results[n]?this._results[n]:ZmItem.RESULTS_LIST[n](this.search)
}};
ZmSearchResult.prototype.getAttribute=function(e){
return this._respEl?this._respEl[e]:null
};
ZmSearchResult.prototype.set=function(u){
if(!this.search){
return
}
this._respEl=u;
if(this.search.isAutocompleteSearch){
return
}
var m={};
var l=0;
var r,o;
var f=this.search.isGalSearch;
var h=new Date();
var s=0;
if(f||this.search.isCalResSearch){
r=o=f?ZmItem.CONTACT:ZmItem.RESOURCE;
var a=f?u.cn:u.calresource;
if(a){
if(!this._results[r]){
this._results[r]=ZmItem.RESULTS_LIST[r](this.search)
}
for(var e=0;
e<a.length;
e++){
this._results[r].addFromDom(a[e])
}
if(f){
this._results[r].getArray().sort(ZmSearchResult._sortGalResults)
}
s=a.length
}}else{
var n=this.search.types.getArray();
o=n[0];
for(var t=0;
t<n.length;
t++){
var c=n[t];
var a=u[ZmList.NODE[c]];
if(!a&&(c=="MSG")){
a=u.chat
}
if(a&&a.length){
s+=a.length;
if(!this._results[c]){
this._results[c]=ZmItem.RESULTS_LIST[c](this.search)
}
for(var e=0;
e<a.length;
e++){
var p=a[e];
p._type=c;
this._results[c].addFromDom(p)
}
if(!m[c]){
m[c]=true;
l++;
r=c
}}}}
if(!s){
this._results[o]=ZmItem.RESULTS_LIST[o](this.search)
}
if((f||this.search.isGalAutocompleteSearch)&&this._results[ZmItem.CONTACT]){
this._results[ZmItem.CONTACT].setIsGal(true)
}
if(this.search.isGalAutocompleteSearch){
this.isTokenized=(this._respEl.tokenizeKey!=null)
}
var d=new Date();
if(l<=1){
this.type=r
}else{
if(l==2&&(m[ZmItem.PAGE]||m[ZmItem.DOCUMENT])){
this.type=ZmItem.PAGE
}else{
this.type=appCtxt.get(ZmSetting.MIXED_VIEW_ENABLED)?ZmItem.MIXED:r
}}
return this.type
};
ZmSearchResult._sortGalResults=function(t,e){
var o=t.getFileAs().toLowerCase();
var n=e.getFileAs().toLowerCase();
return o<n?-1:(o>n?1:0)
}
}
if(AjxPackage.define("zimbraMail.share.model.ZmTag")){
ZmTag=function(t){
t.type=ZmOrganizer.TAG;
var e=String(t.rgb).toUpperCase();
if(t.color==9&&e!="#FF8000"){
t.color=ZmTag.__OLD_COLORS[e]||ZmOrganizer.DEFAULT_COLOR[t.type]
}
ZmOrganizer.call(this,t)
};
ZmTag.prototype=new ZmOrganizer;
ZmTag.prototype.constructor=ZmTag;
ZmTag.prototype.toString=function(){
return"ZmTag"
};
ZmTag.COLOR_ICON=new Object();
ZmTag.COLOR_ICON[ZmOrganizer.C_ORANGE]="TagOrange";
ZmTag.COLOR_ICON[ZmOrganizer.C_BLUE]="TagBlue";
ZmTag.COLOR_ICON[ZmOrganizer.C_CYAN]="TagCyan";
ZmTag.COLOR_ICON[ZmOrganizer.C_GREEN]="TagGreen";
ZmTag.COLOR_ICON[ZmOrganizer.C_PURPLE]="TagPurple";
ZmTag.COLOR_ICON[ZmOrganizer.C_RED]="TagRed";
ZmTag.COLOR_ICON[ZmOrganizer.C_YELLOW]="TagYellow";
ZmTag.ID_ROOT=ZmOrganizer.ID_ROOT;
ZmTag.ID_UNREAD=32;
ZmTag.ID_FLAGGED=33;
ZmTag.ID_FROM_ME=34;
ZmTag.ID_REPLIED=35;
ZmTag.ID_FORWARDED=36;
ZmTag.ID_ATTACHED=37;
ZmTag.__OLD_COLORS={
"#000000":0,"#0000FF":1,"#008284":2,"#008200":3,"#840084":4,"#FF0000":5,"#848200":6,"#FF0084":7,"#848284":8,"#FF8000":9};
ZmTag.createFromJs=function(r,a,h,s,n){
var e=ZmOrganizer.normalizeId(a.id);
if(e<ZmOrganizer.FIRST_USER_ID[ZmOrganizer.TAG]){
return
}
var t={
id:a.id,name:a.name,color:ZmTag.checkColor(a.color),rgb:a.rgb,parent:r,tree:h,numUnread:a.u,account:n};
var l=new ZmTag(t);
var o=s?ZmOrganizer.getSortIndex(l,ZmTag.sortCompare):null;
r.children.add(l,o);
return l
};
ZmTag.sortCompare=function(a,t){
var e=ZmOrganizer.checkSortArgs(a,t);
if(e!=null){
return e
}
if(a.name.toLowerCase()>t.name.toLowerCase()){
return 1
}
if(a.name.toLowerCase()<t.name.toLowerCase()){
return -1
}
return 0
};
ZmTag.checkName=function(e){
var t=ZmOrganizer.checkName(e);
if(t){
return t
}
if(e.indexOf("\\")==0){
return AjxMessageFormat.format(ZmMsg.errorInvalidName,AjxStringUtil.htmlEncode(e))
}
return null
};
ZmTag.checkColor=function(e){
e=Number(e);
return((e!=null)&&(e>=0&&e<=ZmOrganizer.MAX_COLOR))?e:ZmOrganizer.DEFAULT_COLOR[ZmOrganizer.TAG]
};
ZmTag.create=function(n){
var a=AjxSoapDoc.create("CreateTagRequest","urn:zimbraMail");
var o=a.set("tag");
o.setAttribute("name",n.name);
var t=ZmOrganizer.checkColor(n.color);
if(t&&(t!=ZmOrganizer.DEFAULT_COLOR[ZmOrganizer.TAG])){
o.setAttribute("color",t)
}
var e=new AjxCallback(null,ZmTag._handleErrorCreate,n);
appCtxt.getAppController().sendRequest({
soapDoc:a,asyncMode:true,errorCallback:e,accountName:n.accountName}
)
};
ZmTag._handleErrorCreate=function(o,t){
if(t.code==ZmCsfeException.MAIL_INVALID_NAME){
var a=AjxMessageFormat.format(ZmMsg.errorInvalidName,AjxStringUtil.htmlEncode(o.name));
var e=appCtxt.getMsgDialog();
e.setMessage(a,DwtMessageDialog.CRITICAL_STYLE);
e.popup();
return true
}
return false
};
ZmTag.prototype.getIcon=function(){
return(this.id==ZmOrganizer.ID_ROOT)?null:ZmTag.COLOR_ICON[this.color]
};
ZmTag.prototype.createQuery=function(){
return['tag:"',this.name,'"'].join("")
};
ZmTag.prototype.getToolTip=function(){};
ZmTag.prototype.notifyCreate=function(e){
var t=ZmTag.createFromJs(this,e,this.tree,true);
t._notify(ZmEvent.E_CREATE)
};
ZmTag.prototype.supportsSharing=function(){
return false
}
}
if(AjxPackage.define("zimbraMail.share.model.ZmTree")){
ZmTree=function(e){
if(arguments.length==0){
return
}
ZmModel.call(this,e);
this.type=e;
this.root=null
};
ZmTree.prototype=new ZmModel;
ZmTree.prototype.constructor=ZmTree;
ZmTree.prototype.toString=function(){
return"ZmTree"
};
ZmTree.prototype.asString=function(){
return this.root?this._asString(this.root,""):""
};
ZmTree.prototype.getById=function(e){
return this.root?this.root.getById(e):null
};
ZmTree.prototype.getByName=function(e){
return this.root?this.root.getByName(e):null
};
ZmTree.prototype.getByType=function(e){
return this.root?this.root.getByType(e):null
};
ZmTree.prototype.size=function(){
return this.root?this.root.size():0
};
ZmTree.prototype.reset=function(){
this.root=null
};
ZmTree.prototype.asList=function(e){
var t=[];
return this.root?this._addToList(this.root,t,e):t
};
ZmTree.prototype.getUnreadHash=function(e){
if(!e){
e={}
}
return this.root?this._getUnreadHash(this.root,e):e
};
ZmTree.prototype._addToList=function(e,r,t){
var s=t&&t.includeRemote;
var h=t&&t.remoteOnly;
var n=e.isRemote();
if((!n&&!h)||(n&&(h||s))){
r.push(e)
}
var o=e.children.getArray();
for(var a=0;
a<o.length;
a++){
this._addToList(o[a],r,t)
}
return r
};
ZmTree.prototype._asString=function(e,o){
if(e.id){
o=o+e.id
}
var a=e.children.clone().getArray();
if(a.length){
a.sort(function(s,n){
return s.id-n.id
}
);
o=o+"[";
for(var t=0;
t<a.length;
t++){
if(a[t].id==ZmFolder.ID_TAGS){
continue
}
if(t>0){
o=o+","
}
o=this._asString(a[t],o)
}
o=o+"]"
}
return o
};
ZmTree.prototype._getUnreadHash=function(e,t){
t[e.id]=e.numUnread;
var o=e.children.getArray();
for(var a=0;
a<o.length;
a++){
this._getUnreadHash(o[a],t)
}
return t
}
}
if(AjxPackage.define("zimbraMail.share.model.ZmTagTree")){
ZmTagTree=function(e){
ZmTree.call(this,ZmOrganizer.TAG);
var t=(e)?([e.id,ZmTag.ID_ROOT].join(":")):ZmTag.ID_ROOT;
this.root=new ZmTag({
id:t,tree:this}
)
};
ZmTagTree.prototype=new ZmTree;
ZmTagTree.prototype.constructor=ZmTagTree;
ZmTagTree.COLOR_LIST=[ZmOrganizer.C_CYAN,ZmOrganizer.C_BLUE,ZmOrganizer.C_PURPLE,ZmOrganizer.C_RED,ZmOrganizer.C_ORANGE,ZmOrganizer.C_YELLOW,ZmOrganizer.C_GREEN];
ZmTagTree.prototype.toString=function(){
return"ZmTagTree"
};
ZmTagTree.prototype.loadFromJs=function(a,o,n){
if(!a||!a.tag||!a.tag.length){
return
}
for(var t=0;
t<a.tag.length;
t++){
ZmTag.createFromJs(this.root,a.tag[t],this,null,n)
}
var e=this.root.children.getArray();
if(e.length){
e.sort(ZmTag.sortCompare)
}};
ZmTagTree.prototype.getByIndex=function(e){
var t=this.asList();
if(t&&t.length&&(e<t.length)){
return t[e]
}};
ZmTagTree.prototype.reset=function(){
this.root=new ZmTag({
id:ZmTag.ID_ROOT,tree:this}
)
}
}
if(AjxPackage.define("zimbraMail.share.model.ZmFolderTree")){
ZmFolderTree=function(e){
ZmTree.call(this,e)
};
ZmFolderTree.prototype=new ZmTree;
ZmFolderTree.prototype.constructor=ZmFolderTree;
ZmFolderTree.IS_PARSED={};
ZmFolderTree.prototype.toString=function(){
return"ZmFolderTree"
};
ZmFolderTree.prototype.loadFromJs=function(a,e,t){
this.root=(e=="zimlet")?ZmZimlet.createFromJs(null,a,this):ZmFolderTree.createFromJs(null,a,this,e,null,t)
};
ZmFolderTree.createFromJs=function(m,r,y,c,g,h){
if(!(r&&r.id)){
return
}
var a;
if(c=="search"){
var l;
if(r.types){
var f=r.types.split(",");
l=[];
for(var s=0;
s<f.length;
s++){
l.push(ZmSearch.TYPE_MAP[f[s]])
}}
var n={
id:r.id,name:r.name,parent:m,tree:y,numUnread:r.u,query:r.query,types:l,sortBy:r.sortBy,account:h};
a=new ZmSearchFolder(n);
ZmFolderTree._fillInFolder(a,r,g);
ZmFolderTree._traverse(a,r,y,(g||[]),c,h)
}else{
var u=r.view?(ZmOrganizer.TYPE[r.view]):(m?m.type:ZmOrganizer.FOLDER);
if(!u){
return
}
var p=(r.acl&&r.acl.grant&&r.acl.grant.length>0);
if(appCtxt.inStartup&&ZmOrganizer.DEFERRABLE[u]&&!appCtxt.isOffline&&!p){
var o=appCtxt.getApp(ZmOrganizer.APP[u]);
var e={
type:u,parent:m,obj:r,tree:y,path:g,elementType:c,account:h};
o.addDeferredFolder(e)
}else{
var d=ZmOrganizer.ORG_PACKAGE[u];
if(d){
AjxDispatcher.require(d)
}
a=ZmFolderTree.createFolder(u,m,r,y,g,c,h);
ZmFolderTree._traverse(a,r,y,(g||[]),c,h)
}}
return a
};
ZmFolderTree._traverse=function(e,n,m,u,l,h){
var a=(e.nId==ZmOrganizer.ID_ROOT);
if(n.folder&&n.folder.length){
if(!a){
u.push(n.name)
}
for(var s=0;
s<n.folder.length;
s++){
var r=n.folder[s];
var o=ZmFolderTree.createFromJs(e,r,m,(l||"folder"),u,h);
if(e&&o){
e.children.add(o)
}}
if(!a){
u.pop()
}}
if(n.search&&n.search.length){
if(!a){
u.push(n.name)
}
for(var s=0;
s<n.search.length;
s++){
var d=n.search[s];
var t=ZmFolderTree.createFromJs(e,d,m,"search",u,h);
if(t){
e.children.add(t)
}}
if(!a){
u.pop()
}}
if(n.link&&n.link.length){
for(var s=0;
s<n.link.length;
s++){
var c=n.link[s];
var o=ZmFolderTree.createFromJs(e,c,m,"link",u,h);
if(o){
e.children.add(o)
}}}};
ZmFolderTree.createFolder=function(type,parent,obj,tree,path,elementType,account){
var orgClass=eval(ZmOrganizer.ORG_CLASS[type]);
if(!orgClass){
return null
}
var params={
id:obj.id,name:obj.name,parent:parent,tree:tree,color:obj.color,rgb:obj.rgb,owner:obj.owner,zid:obj.zid,rid:obj.rid,restUrl:obj.rest,url:obj.url,numUnread:obj.u,numTotal:obj.n,sizeTotal:obj.s,perm:obj.perm,link:elementType=="link",account:account};
var folder=new orgClass(params);
ZmFolderTree._fillInFolder(folder,obj,path);
ZmFolderTree.IS_PARSED[type]=true;
return folder
};
ZmFolderTree._fillInFolder=function(e,a,t){
if(t&&t.length){
e.path=t.join("/")
}
if(a.f&&e._parseFlags){
e._parseFlags(a.f)
}
e._setSharesFromJs(a)
};
ZmFolderTree.prototype.getByType=function(e){
return this.root?this.root.getByType(e):null
};
ZmFolderTree.prototype.getByPath=function(t,e){
return this.root?this.root.getByPath(t,e):null
};
ZmFolderTree.prototype.handleNoSuchFolderError=function(e,r,l){
var h=this.getByType(e);
var a;
var s=false;
if(h){
for(var n=0;
n<h.length;
n++){
if((h[n].zid==r)&&(h[n].rid==l)){
h[n].noSuchFolder=true;
if(!a){
var o=appCtxt.getAppController().getOverviewId();
a=appCtxt.getOverviewController().getTreeView(o,e)
}
var t=a.getTreeItemById(h[n].id);
t.setText(h[n].getName(true));
this.handleDeleteNoSuchFolder(h[n]);
s=true
}}}
return s
};
ZmFolderTree.prototype.handleDeleteNoSuchFolder=function(e){
var t=appCtxt.getYesNoMsgDialog();
t.reset();
t.registerCallback(DwtDialog.YES_BUTTON,this._deleteOrganizerYesCallback,this,[e,t]);
t.registerCallback(DwtDialog.NO_BUTTON,appCtxt.getAppController()._clearDialog,this,t);
var a=AjxMessageFormat.format(ZmMsg.confirmDeleteMissingFolder,e.getName(false,0,true));
t.setMessage(a,DwtMessageDialog.WARNING_STYLE);
t.popup()
};
ZmFolderTree.prototype._deleteOrganizerYesCallback=function(e,t){
e._delete();
appCtxt.getAppController()._clearDialog(t)
};
ZmFolderTree.prototype.getPermissions=function(r){
var n=r.folderIds||this._getItemsWithoutPerms(r.type);
if(n.length>0){
var o=AjxSoapDoc.create("BatchRequest","urn:zimbra");
o.setMethodAttribute("onerror","continue");
var s=o.getDoc();
for(var a=0;
a<n.length;
a++){
var t=o.set("GetFolderRequest",null,null,"urn:zimbraMail");
var e=s.createElement("folder");
e.setAttribute("l",n[a]);
t.appendChild(e)
}
var h=new AjxCallback(this,this._handleResponseGetShares,[r.callback,r.skipNotify]);
appCtxt.getRequestMgr().sendRequest({
soapDoc:o,asyncMode:true,callback:h,noBusyOverlay:r.noBusyOverlay}

)
}else{
if(r.callback){
r.callback.run()
}}};
ZmFolderTree.prototype._getItemsWithoutPerms=function(n){
var s=[];
var o=n?[n]:[ZmOrganizer.FOLDER,ZmOrganizer.CALENDAR,ZmOrganizer.TASKS,ZmOrganizer.NOTEBOOK,ZmOrganizer.ADDRBOOK];
for(var t=0;
t<o.length;
t++){
var r=o[t];
if(!ZmFolderTree.IS_PARSED[r]){
continue
}
var e=this.getByType(r);
for(var a=0;
a<e.length;
a++){
if(e[a].link&&e[a].shares==null){
s.push(e[a].id)
}}}
return s
};
ZmFolderTree.prototype._handleResponseGetShares=function(h,o,c){
var l=c.getResponse().BatchResponse;
this._handleErrorGetShares(l);
var e=l.GetFolderResponse;
if(e){
for(var a=0;
a<e.length;
a++){
var n=e[a].link?e[a].link[0]:null;
if(n){
var s=appCtxt.getById(n.id);
if(s){
s._setSharesFromJs(n)
}
if(n.folder&&n.folder.length>0){
var r=appCtxt.getById(n.id);
if(r){
for(var t=0;
t<n.folder.length;
t++){
if(appCtxt.getById(n.folder[t].id)){
continue
}
r.notifyCreate(n.folder[t],false,o)
}}}}}}
if(h){
h.run()
}};
ZmFolderTree.prototype._handleErrorGetShares=function(l){
var n=l.Fault;
if(n){
var a=[];
var t=[];
for(var o=0,e=n.length;
o<e;
o++){
var r=ZmCsfeCommand.faultToEx(n[o]);
if(r.code==ZmCsfeException.MAIL_NO_SUCH_FOLDER){
var h=r.data.itemId[0];
var s=h.lastIndexOf(":");
t.push(h.substring(0,s));
a.push(h.substring(s+1,h.length))
}}
if(t.length){
this._markNoSuchFolder(t,a)
}}};
ZmFolderTree.prototype._markNoSuchFolder=function(t,n){
var s=appCtxt.getFolderTree();
var e=s&&s.root?s.root.children.getArray():null;
for(var o=0;
o<e.length;
o++){
for(var a=0;
a<n.length;
a++){
if((e[o].zid==t[a])&&(e[o].rid==n[a])){
e[o].noSuchFolder=true
}}}};
ZmFolderTree.prototype._sortFolder=function(a){
var t=a.children;
if(t&&t.length){
t.sort(ZmFolder.sortCompare);
for(var e=0;
e<t.length;
e++){
this._sortFolder(t[e])
}}}
}
if(AjxPackage.define("zimbraMail.share.model.ZmList")){
ZmList=function(t,e){
if(arguments.length==0){
return
}
ZmModel.call(this,t);
this.type=t;
this.search=e;
this._vector=new AjxVector();
this._hasMore=false;
this._idHash=new Object();
var a=appCtxt.getTagTree();
if(a){
this._tagChangeListener=new AjxListener(this,this._tagTreeChangeListener);
a.addChangeListener(this._tagChangeListener)
}};
ZmList.prototype=new ZmModel;
ZmList.prototype.constructor=ZmList;
ZmList.ITEM_CLASS={};
ZmList.NODE={};
ZmList.ITEM_TYPE={};
ZmList.CHUNK_SIZE=100;
ZmList.prototype.toString=function(){
return"ZmList"
};
ZmList.prototype.get=function(e){
return this._vector.get(e)
};
ZmList.prototype.add=function(t,e){
this._vector.add(t,e);
if(t.id){
this._idHash[t.id]=t
}};
ZmList.prototype.remove=function(e){
this._vector.remove(e);
if(e.id){
delete this._idHash[e.id]
}};
ZmList.prototype.create=function(args){
var item;
var obj=eval(ZmList.ITEM_CLASS[this.type]);
if(obj){
item=new obj(this);
item.create(args)
}
return item
};
ZmList.prototype.size=function(){
return this._vector.size()
};
ZmList.prototype.indexOf=function(e){
return this._vector.indexOf(e)
};
ZmList.prototype.hasMore=function(){
return this._hasMore
};
ZmList.prototype.setHasMore=function(e){
this._hasMore=e
};
ZmList.prototype.getArray=function(){
return this._vector.getArray()
};
ZmList.prototype.getVector=function(){
return this._vector
};
ZmList.prototype.getById=function(e){
return this._idHash[e]
};
ZmList.prototype.clear=function(){
var e=this.getArray();
for(var t=0;
t<e.length;
t++){
e[t].clear()
}
this._evtMgr.removeAll(ZmEvent.L_MODIFY);
this._vector.removeAll();
for(var o in this._idHash){
this._idHash[o]=null
}
this._idHash=new Object()
};
ZmList.prototype.set=function(respNode){
this.clear();
var nodes=respNode.childNodes;
var args={
list:this};
for(var i=0;
i<nodes.length;
i++){
var node=nodes[i];
if(node.nodeName==ZmList.NODE[this.type]){
if(parseInt(node.getAttribute("l"))==ZmFolder.ID_TRASH&&(this.type!=ZmItem.CONTACT)){
continue
}
var obj=eval(ZmList.ITEM_CLASS[this.type]);
if(obj){
this.add(obj.createFromDom(node,args))
}}}};
ZmList.prototype.addFromDom=function(node,args){
if(!args){
args={}
}
args.list=this;
var obj=eval(ZmList.ITEM_CLASS[this.type]);
if(obj){
this.add(obj.createFromDom(node,args))
}};
ZmList.prototype.getSubList=function(o,a){
var n=null;
var t=(o+a>this.size())?this.size():o+a;
var e=this.getArray();
if(o<t){
n=AjxVector.fromArray(e.slice(o,t))
}
return n
};
ZmList.prototype.cache=function(n,t){
this.getVector().merge(n,t);
var o=t.getArray();
for(var e=0;
e<o.length;
e++){
var a=o[e];
a.list=this;
if(a.id){
this._idHash[a.id]=a
}}};
ZmList.prototype.flagItems=function(e){
e=Dwt.getParams(arguments,["items","op","value","callback"]);
if(this.type==ZmItem.MIXED&&!this._mixedType){
return this._mixedAction("flagItems",e)
}
e.items=AjxUtil.toArray(e.items);
if(e.action=="update"){
e.attrs={
f:e.value}
}else{
e.action=e.value?e.op:"!"+e.op
}
this._itemAction(e)
};
ZmList.prototype.tagItems=function(s){
s=Dwt.getParams(arguments,["items","tagId","doTag"]);
if(appCtxt.multiAccounts&&!appCtxt.getActiveAccount().isMain){
s.tagId=ZmOrganizer.normalizeId(s.tagId)
}
if(this.type==ZmItem.MIXED&&!this._mixedType){
return this._mixedAction("tagItems",s)
}
var t=AjxUtil.toArray(s.items);
var e=[],r=s.doTag,o=s.tagId;
for(var a=0;
a<t.length;
a++){
var n=t[a];
if((r&&(!n.hasTag(o)||n.type==ZmItem.CONV))||(!r&&n.hasTag(o))){
e.push(n)
}}
s.items=e;
s.attrs={
tag:o};
s.action=r?"tag":"!tag";
this._itemAction(s)
};
ZmList.prototype.removeAllTags=function(n){
n=(n&&n.items)?n:{
items:n};
if(this.type==ZmItem.MIXED&&!this._mixedType){
this._mixedAction("removeAllTags",n);
return
}
var t=AjxUtil.toArray(n.items);
var e=[];
for(var a=0;
a<t.length;
a++){
var o=t[a];
if(o.tags&&o.tags.length){
e.push(o)
}}
n.items=e;
n.action="update";
n.attrs={
t:""};
this._itemAction(n)
};
ZmList.prototype.moveItems=function(a){
a=Dwt.getParams(arguments,["items","folder","attrs","callback"]);
if(this.type==ZmItem.MIXED&&!this._mixedType){
return this._mixedAction("moveItems",a)
}
a.items=AjxUtil.toArray(a.items);
a.attrs=a.attrs||{};
a.attrs.l=a.folder.id;
a.accountName=appCtxt.multiAccounts&&appCtxt.accountList.mainAccount.name;
a.action="move";
var e={};
for(var t in a){
e[t]=a[t]
}
a.callback=(this.type==ZmItem.MIXED)?(new AjxCallback(this,this._handleResponseMoveItems,e)):a.callback;
this._itemAction(a)
};
ZmList.prototype._handleResponseMoveItems=function(a,e){
var o=e.getResponse();
if(o&&o.length){
this.moveLocal(o,a.folder.id);
for(var t=0;
t<o.length;
t++){
o[t].moveLocal(a.folder.id)
}
ZmModel.notifyEach(o,ZmEvent.E_MOVE)
}
if(a.callback){
a.callback.run(e)
}};
ZmList.prototype.copyItems=function(e){
e=Dwt.getParams(arguments,["items","folder","attrs"]);
e.items=AjxUtil.toArray(e.items);
e.attrs=e.attrs||{};
e.attrs.l=e.folder.id;
e.accountName=appCtxt.multiAccounts&&appCtxt.accountList.mainAccount.name;
e.action="copy";
e.callback=new AjxCallback(this,this._handleResponseCopyItems,e);
this._itemAction(e)
};
ZmList.prototype._handleResponseCopyItems=function(o,e){
var a=e.getResponse();
if(a.length>0){
var t=AjxMessageFormat.format(ZmMsg.itemCopied,a.length);
appCtxt.getAppController().setStatusMsg(t)
}};
ZmList.prototype.deleteItems=function(h){
h=Dwt.getParams(arguments,["items","hardDelete","attrs","childWin"]);
if(this.type==ZmItem.MIXED&&!this._mixedType){
return this._mixedAction("deleteItems",h)
}
var o=h.items=AjxUtil.toArray(h.items);
var e=[];
var a=[];
for(var n=0;
n<o.length;
n++){
var r=o[n];
var t=r.getFolderId();
var s=appCtxt.getById(t);
if(h.hardDelete||(s&&s.isHardDelete())){
a.push(r)
}else{
e.push(r)
}}
h.callback=h.childWin&&new AjxCallback(this._handleDeleteNewWindowResponse,h.childWin);
if(e.length){
h.items=e;
var t=appCtxt.multiAccounts?ZmOrganizer.getSystemId(ZmFolder.ID_TRASH):ZmFolder.ID_TRASH;
h.folder=appCtxt.getById(t);
this.moveItems(h)
}
if(a.length){
h.items=a;
h.action="delete";
this._itemAction(h)
}};
ZmList.prototype._handleDeleteNewWindowResponse=function(t,e){
if(t){
t.close()
}};
ZmList.prototype.modifyItem=function(t,e,a){
t.modify(e,a)
};
ZmList.prototype.notifyCreate=function(node){
var obj=eval(ZmList.ITEM_CLASS[this.type]);
if(obj){
var item=obj.createFromDom(node,{
list:this}
);
this.add(item,this._sortIndex(item));
this.createLocal(item);
this._notify(ZmEvent.E_CREATE,{
items:[item]}
)
}};
ZmList.prototype.modifyLocal=function(e,t){};
ZmList.prototype.createLocal=function(e){};
ZmList.prototype.flagLocal=function(t,e,a){};
ZmList.prototype.tagLocal=function(t,e,a){};
ZmList.prototype.removeAllTagsLocal=function(e){};
ZmList.prototype.deleteLocal=function(e){
for(var t=0;
t<e.length;
t++){
this.remove(e[t])
}};
ZmList.prototype.moveLocal=function(t,e){
for(var a=0;
a<t.length;
a++){
this.remove(t[a])
}};
ZmList.prototype._itemAction=function(s,a){
var p=this._getIds(s.items);
var o=p.hash;
var h=p.list;
if(!(h&&h.length)){
if(s.callback){
s.callback.run(new ZmCsfeResult([]))
}
if(s.finalCallback){
s.finalCallback.run(s)
}
return
}
var d;
if(this.type==ZmItem.MIXED){
d=this._mixedType
}else{
if(s.items.length==1){
d=s.items[0].type
}else{
d=this.type
}}
if(!d){
return
}
var t=ZmItem.SOAP_CMD[d]+"Request";
var e=a?a._useJson:true;
var r,n;
if(e){
r={};
var f=this._getActionNamespace();
r[t]={
_jsns:f};
var n=r[t].action={};
n.op=s.action;
for(var l in s.attrs){
n[l]=s.attrs[l]
}}else{
r=AjxSoapDoc.create(t,this._getActionNamespace());
n=r.set("action");
n.setAttribute("op",s.action);
for(var l in s.attrs){
n.setAttribute(l,s.attrs[l])
}}
var m=s.callback&&(new AjxCallback(this,this._handleResponseItemAction,[s.callback]));
var u={
ids:h,idHash:o,accountName:s.accountName,request:r,action:n,type:d,callback:m,finalCallback:s.finalCallback,errorCallback:s.errorCallback,batchCmd:a,numItems:s.count||0};
var c=ZmList.progressDialog;
if(h.length>ZmList.CHUNK_SIZE){
if(!c){
c=ZmList.progressDialog=appCtxt.getCancelMsgDialog();
c.registerCallback(DwtDialog.CANCEL_BUTTON,new AjxCallback(this,this._cancelAction,[u]))
}}else{
if(c){
c.unregisterCallback(DwtDialog.CANCEL_BUTTON);
ZmList.progressDialog=null
}}
this._doAction(u)
};
ZmList.prototype._handleResponseItemAction=function(a,t,e){
if(a){
e.set(t);
a.run(e)
}};
ZmList.prototype._doAction=function(o){
var a=o.ids.splice(0,ZmList.CHUNK_SIZE);
var t=a.join(",");
var s=true;
if(o.action.setAttribute){
o.action.setAttribute("id",t);
s=false
}else{
o.action.id=t
}
var n=new AjxCallback(this,this._handleResponseDoAction,[o]);
if(o.batchCmd){
o.batchCmd.addRequestParams(o.request,n,o.errorCallback)
}else{
var e={
asyncMode:true,callback:n,accountName:o.accountName};
if(s){
e.jsonObj=o.request
}else{
e.soapDoc=o.request
}
o.reqId=appCtxt.getAppController().sendRequest(e)
}};
ZmList.prototype._handleResponseDoAction=function(t,d){
var r=ZmList.progressDialog;
var o=d.getResponse();
var a=o[ZmItem.SOAP_CMD[t.type]+"Response"];
if(a&&a.action){
var e=a.action.id.split(",");
if(e){
var h=[];
for(var n=0;
n<e.length;
n++){
var c=t.idHash[e[n]];
if(c){
h.push(c)
}}
t.numItems+=h.length;
if(t.callback){
t.callback.run(h,d)
}
if(r){
var s=ZmItem.PLURAL_MSG_KEY[t.type]||"items";
var l=AjxMessageFormat.format(ZmMsg.itemsProcessed,[t.numItems,ZmMsg[s]]);
r.setContent(l.toLowerCase());
if(!r.isPoppedUp()){
r.popup()
}}}}
if(t.ids.length&&!t.cancelled){
AjxTimedAction.scheduleAction(new AjxTimedAction(this,this._doAction,[t]),100)
}else{
t.reqId=null;
if(t.finalCallback){
t.finalCallback.run(t)
}else{
if(r){
r.popdown();
ZmList.progressDialog=null
}}}};
ZmList.prototype._cancelAction=function(e){
e.cancelled=true;
if(e.reqId){
appCtxt.getRequestMgr().cancelRequest(e.reqId)
}
if(e.finalCallback){
e.finalCallback.run(e)
}};
ZmList.prototype._mixedAction=function(r,s){
var e=this._getTypedItems(s.items);
var n=AjxUtil.hashCopy(s);
for(var o in e){
this._mixedType=o;
if(o==ZmItem.CONTACT){
var t=e[o];
for(var a=0;
a<t.length;
a++){
n.items=[t[a]];
t[a].list[r](s)
}}else{
n.items=e[o];
ZmMailList.prototype[r].call(this,s)
}
this._mixedType=null
}};
ZmList.prototype._getTypedItems=function(t){
var e={};
for(var a=0;
a<t.length;
a++){
var o=t[a].type;
if(!e[o]){
e[o]=[]
}
e[o].push(t[a])
}
return e
};
ZmList.prototype._getIds=function(n){
var o={};
if(n instanceof ZmItem){
n=[n]
}
var t=[];
if((n&&n.length)){
for(var e=0;
e<n.length;
e++){
var a=n[e];
var s=a.id;
if(s){
t.push(s);
o[s]=a
}}}
return{
hash:o,list:t}
};
ZmList.prototype._sortIndex=function(e){
return 0
};
ZmList.prototype._redoSearch=function(e){
var t=appCtxt.getSearchController();
t.redoSearch(e._currentSearch)
};
ZmList.prototype._getActionNamespace=function(){
return"urn:zimbraMail"
};
ZmList.prototype._folderTreeChangeListener=function(s){
if(s.type!=ZmEvent.S_FOLDER){
return
}
var n=s.getDetail("organizers")[0];
var o=s.getDetail("fields");
var a=appCtxt.getCurrentController();
var t=(appCtxt.getCurrentList()==this);
if(s.event==ZmEvent.E_DELETE&&(s.source instanceof ZmFolder)&&s.source.id==ZmFolder.ID_TRASH){
var e=a.getCurrentView();
if(e){
e.offset=0
}
a._resetNavToolBarButtons(view)
}else{
if(t&&a&&a._currentSearch&&(s.event==ZmEvent.E_MOVE||(s.event==ZmEvent.E_MODIFY)&&o&&o[ZmOrganizer.F_NAME])){
var r=s.getDetail("oldPath");
if(a._currentSearch.hasFolderTerm(r)){
a._currentSearch.replaceFolderTerm(r,n.getPath());
appCtxt.getSearchController().setSearchField(a._currentSearch.query)
}}}};
ZmList.prototype._tagTreeChangeListener=function(r){
if(r.type!=ZmEvent.S_TAG){
return
}
var u=r.getDetail("organizers")[0];
var n=r.getDetail("fields");
var c=appCtxt.getCurrentController();
if(!c||(appCtxt.getCurrentList()!=this)){
return
}
if((r.event==ZmEvent.E_MODIFY)&&n&&n[ZmOrganizer.F_NAME]){
var t=r.getDetail("oldName");
if(c._currentSearch&&c._currentSearch.hasTagTerm(t)){
c._currentSearch.replaceTagTerm(t,u.getName());
appCtxt.getSearchController().setSearchField(c._currentSearch.query)
}}else{
if(r.event==ZmEvent.E_DELETE){
var h=this.getArray();
var e=this._evtMgr.isListenerRegistered(ZmEvent.L_MODIFY);
for(var o=0;
o<h.length;
o++){
var d=this.getById(h[o].id);
if(d&&d.hasTag(u.id)){
d.tagLocal(u.id,false);
if(e){
this._notify(ZmEvent.E_TAGS,{
items:[d]}
)
}}}
if(c._currentSearch&&c._currentSearch.hasTagTerm(u.getName())){
var l=appCtxt.getCurrentViewId();
c.enablePagination(false,l);
var s=c.getCurrentView();
if(s&&s.sortingEnabled){
s.sortingEnabled=false
}
if(l==ZmId.VIEW_CONVLIST){
c._currentSearch.query="is:read is:unread"
}
c._currentSearch.tagId=null;
appCtxt.getSearchController().setSearchField("")
}}}}
}
if(AjxPackage.define("zimbraMail.share.model.ZmAccountList")){
ZmAccountList=function(){
this._accounts={};
this._count=0;
this.visibleAccounts=[];
this.mainAccount=null;
this.activeAccount=null;
this.defaultAccount=null;
this._evtMgr=new AjxEventMgr()
};
ZmAccountList.prototype.constructor=ZmAccountList;
ZmAccountList.DEFAULT_ID="main";
ZmAccountList.prototype.toString=function(){
return"ZmAccountList"
};
ZmAccountList.prototype.size=function(e){
return(e)?this.visibleAccounts.length:this._count
};
ZmAccountList.prototype.add=function(e){
this._accounts[e.id]=e;
this._count++;
if(e.visible||e.id==ZmAccountList.DEFAULT_ID){
this.visibleAccounts.push(e)
}
if(e.id==ZmAccountList.DEFAULT_ID){
this.mainAccount=e
}};
ZmAccountList.prototype.getAccounts=function(){
return this._accounts
};
ZmAccountList.prototype.getAccount=function(e){
return e?this._accounts[e]:this.mainAccount
};
ZmAccountList.prototype.getAccountByName=function(e){
for(var t in this._accounts){
if(this._accounts[t].name==e){
return this._accounts[t]
}}
return null
};
ZmAccountList.prototype.getAccountByEmail=function(e){
for(var t in this._accounts){
if(this._accounts[t].getEmail()==e){
return this._accounts[t]
}}
return null
};
ZmAccountList.prototype.getItemCount=function(e){
var t=0;
for(var a=0;
a<this.visibleAccounts.length;
a++){
var s=this.visibleAccounts[a];
if(s.isMain){
continue
}
var n=ZmOrganizer.getSystemId(e,s);
var o=appCtxt.getById(n);
if(o){
t+=o.numTotal
}}
return t
};
ZmAccountList.prototype.generateQuery=function(e,s){
var l=s&&s.get(0);
var h=[];
var r=this.visibleAccounts;
var a=e||ZmOrganizer.ID_ROOT;
var o=e?"inid":"underid";
for(var n=0;
n<r.length;
n++){
var c=r[n];
if((l&&!c.isAppEnabled(ZmItem.APP[l]))||c.isMain){
continue
}
var t=[o,':"',ZmOrganizer.getSystemId(a,c,true),'"'];
h.push(t.join(""))
}
return(h.join(" OR "))
};
ZmAccountList.prototype.loadAccounts=function(t){
var e=(new Array()).concat(this.visibleAccounts);
this._loadAccount(e,t)
};
ZmAccountList.prototype._loadAccount=function(t,n){
var o=t.shift();
if(o){
var a=new AjxCallback(this,this._loadAccount,[t,n]);
o.load(a)
}else{
ZmOrganizer.HIDE_EMPTY[ZmOrganizer.TAG]=true;
ZmOrganizer.HIDE_EMPTY[ZmOrganizer.SEARCH]=true;
for(var e=0;
e<this.visibleAccounts.length;
e++){
if(appCtxt.get(ZmSetting.OFFLINE_SMTP_ENABLED,null,this.visibleAccounts[e])){
appCtxt.set(ZmSetting.OFFLINE_COMPOSE_ENABLED,true,null,null,true);
break
}}
if(n){
n.run()
}}};
ZmAccountList.prototype.setActiveAccount=function(t,e){
this.activeAccount=t;
this._evt=this._evt||new ZmEvent();
this._evt.account=t;
if(!e){
this._evtMgr.notifyListeners("ACCOUNT",this._evt)
}};
ZmAccountList.prototype.addActiveAcountListener=function(t,e){
return this._evtMgr.addListener("ACCOUNT",t,e)
};
ZmAccountList.prototype.syncAll=function(t){
var e=(new Array()).concat(this.visibleAccounts);
this._sendSync(e,t)
};
ZmAccountList.prototype._sendSync=function(e,a){
var t=e.shift();
if(t){
if(!t.isMain){
t.sync()
}
AjxTimedAction.scheduleAction(new AjxTimedAction(this,this._sendSync,[e,a]),500)
}else{
if(a){
a.run()
}}};
ZmAccountList.prototype.createAccounts=function(t,n){
var o=appCtxt.accountList.mainAccount;
o.id=n.id;
o.name=n.name;
o.isMain=true;
o.isZimbraAccount=true;
o.loaded=true;
o.visible=true;
o.settings=t;
o.type=ZmAccount.TYPE_ZIMBRA;
this._accounts[o.id]=o;
delete this._accounts[ZmAccountList.DEFAULT_ID];
this.setActiveAccount(o);
if(appCtxt.isOffline){
o.displayName=ZmMsg.localFolders
}
var a=n.childAccounts&&n.childAccounts.childAccount;
if(a){
for(var e=0;
e<a.length;
e++){
this.add(ZmZimbraAccount.createFromDom(a[e]))
}
appCtxt.multiAccounts=this.size()>1;
appCtxt.isFamilyMbox=appCtxt.multiAccounts&&!appCtxt.isOffline;
this.defaultAccount=appCtxt.isFamilyMbox?this.mainAccount:this.visibleAccounts[1]
}};
ZmAccountList.prototype.resetTrees=function(){
for(var t=0;
t<this.visibleAccounts.length;
t++){
for(var a in trees){
var e=trees[a];
if(e&&e.reset){
e.reset()
}}}};
ZmAccountList.prototype.saveImplicitPrefs=function(){
for(var t=0;
t<this.visibleAccounts.length;
t++){
var e=this.visibleAccounts[t].trees;
this.visibleAccounts[t].saveImplicitPrefs()
}}
}
if(AjxPackage.define("zimbraMail.share.model.ZmAccount")){
ZmAccount=function(t,a,e){
if(arguments.length==0){
return
}
this.id=a;
this.name=e;
this.type=t||ZmAccount.TYPE_ZIMBRA
};
ZmAccount.TYPE_AOL="AOL";
ZmAccount.TYPE_GMAIL="Gmail";
ZmAccount.TYPE_IMAP="Imap";
ZmAccount.TYPE_LIVE="Live";
ZmAccount.TYPE_MSE="MSE";
ZmAccount.TYPE_PERSONA="PERSONA";
ZmAccount.TYPE_POP="Pop";
ZmAccount.TYPE_YMP="YMP";
ZmAccount.TYPE_ZIMBRA="Zimbra";
ZmAccount.getTypeName=function(e){
switch(e){
case ZmAccount.TYPE_AOL:return ZmMsg.aol;
case ZmAccount.TYPE_GMAIL:return ZmMsg.gmail;
case ZmAccount.TYPE_IMAP:return ZmMsg.accountTypeImap;
case ZmAccount.TYPE_LIVE:return ZmMsg.msLive;
case ZmAccount.TYPE_MSE:return ZmMsg.msExchange;
case ZmAccount.TYPE_PERSONA:return ZmMsg.accountTypePersona;
case ZmAccount.TYPE_POP:return ZmMsg.accountTypePop;
case ZmAccount.TYPE_YMP:return ZmMsg.yahooMail;
case ZmAccount.TYPE_ZIMBRA:return ZmMsg.zimbraTitle
}
return ZmMsg.unknown
};
ZmAccount.prototype.toString=function(){
return"ZmAccount"
};
ZmAccount.prototype.setName=function(e){
this.name=e
};
ZmAccount.prototype.getName=function(){
return this.name
};
ZmAccount.prototype.setEmail=function(e){
throw this.toString()+"#setEmail"
};
ZmAccount.prototype.getEmail=function(){
throw this.toString()+"#getEmail"
};
ZmAccount.prototype.getIdentity=function(){
throw this.toString()+"#getIdentity"
}
}
if(AjxPackage.define("zimbraMail.share.model.ZmZimbraAccount")){
ZmZimbraAccount=function(a,e,t){
ZmAccount.call(this,null,a,e);
this.visible=(t!==false);
this.settings=null;
this.trees={};
this.loaded=false;
this.acl=new ZmAccessControlList()
};
ZmZimbraAccount.prototype=new ZmAccount;
ZmZimbraAccount.prototype.constructor=ZmZimbraAccount;
ZmZimbraAccount.prototype.toString=function(){
return"ZmZimbraAccount"
};
ZmZimbraAccount.STATUS_UNKNOWN="unknown";
ZmZimbraAccount.STATUS_OFFLINE="offline";
ZmZimbraAccount.STATUS_ONLINE="online";
ZmZimbraAccount.STATUS_RUNNING="running";
ZmZimbraAccount.STATUS_AUTHFAIL="authfail";
ZmZimbraAccount.STATUS_ERROR="error";
ZmZimbraAccount.prototype.setName=function(t){
var e=this.getIdentity();
if(!e){
return
}
e.name=t
};
ZmZimbraAccount.prototype.getName=function(){
var e=this.getIdentity();
var t=(!e)?this.settings.get(ZmSetting.DISPLAY_NAME):e.name;
if(!t){
t=this.getDisplayName()
}
return e.isDefault&&t==ZmIdentity.DEFAULT_NAME?ZmMsg.accountDefault:t
};
ZmZimbraAccount.prototype.setEmail=function(e){};
ZmZimbraAccount.prototype.getEmail=function(){
return this.name
};
ZmZimbraAccount.prototype.getDisplayName=function(){
if(!this.displayName){
var e=this.isMain?this.settings.get(ZmSetting.DISPLAY_NAME):this._displayName;
this.displayName=(this._accountName||e||this.name)
}
return this.displayName
};
ZmZimbraAccount.prototype.getIdentity=function(){
if(!appCtxt.isFamilyMbox||this.isMain){
return appCtxt.getIdentityCollection(this).defaultIdentity
}
if(!this.dummyIdentity){
this.dummyIdentity=new ZmIdentity(this.name)
}
return this.dummyIdentity
};
ZmZimbraAccount.prototype.getToolTip=function(){
if(this.status||this.lastSync){
var e=(this.lastSync&&this.lastSync!=0)?(new Date(parseInt(this.lastSync))):null;
var t={
lastSync:(e?(AjxDateUtil.computeWordyDateStr(new Date(),e)):null),isInitialSync:this.isOfflineInitialSync(),status:this.getStatusMessage()};
return AjxTemplate.expand("share.App#ZimbraAccountTooltip",t)
}
return""
};
ZmZimbraAccount.prototype.getDefaultColor=function(){
if(this.isMain){
return ZmOrganizer.C_GRAY
}
switch(this.type){
case ZmAccount.TYPE_GMAIL:return ZmOrganizer.C_RED;
case ZmAccount.TYPE_MSE:return ZmOrganizer.C_GREEN;
case ZmAccount.TYPE_YMP:return ZmOrganizer.C_PURPLE
}
return null
};
ZmZimbraAccount.prototype.isOfflineInitialSync=function(){
return(appCtxt.isOffline&&(!this.lastSync||(this.lastSync&&this.lastSync==0)))
};
ZmZimbraAccount.prototype.updateState=function(a){
if(this.isMain){
return
}
var s=false;
if(this.lastSync!=a.lastsync){
this.lastSync=a.lastsync;
if(this.visible){
s=true
}}
var e=false;
if(this.status!=a.status){
this.status=a.status;
if(this.visible){
e=true
}}
var t=appCtxt.getOverviewController()._overviewContainer;
for(var n in t){
var r=t[n];
if(e||s){
r.updateAccountInfo(this,e,s)
}}
this.code=a.code;
if(a.error){
var o=a.error[0];
this.errorDetail=o.exception[0]._content;
this.errorMessage=o.message
}};
ZmZimbraAccount.prototype.getStatusIcon=function(){
switch(this.status){
case ZmZimbraAccount.STATUS_OFFLINE:return"ImAway";
case ZmZimbraAccount.STATUS_AUTHFAIL:return"ImDnd";
case ZmZimbraAccount.STATUS_ERROR:return"Critical"
}
return null
};
ZmZimbraAccount.prototype.getIcon=function(){
return(this.isMain&&appCtxt.isOffline)?"LocalFolders":this.icon
};
ZmZimbraAccount.prototype.getZdMsg=function(e){
var t=((ZdMsg["client."+e])||(ZdMsg["exception."+e]));
if(!t&&e){
t=ZdMsg["exception.offline.UNEXPECTED"]
}
return t
};
ZmZimbraAccount.prototype.getStatusMessage=function(){
switch(this.status){
case ZmZimbraAccount.STATUS_OFFLINE:return ZmMsg.imStatusOffline;
case ZmZimbraAccount.STATUS_ONLINE:return ZmMsg.imStatusOnline;
case ZmZimbraAccount.STATUS_RUNNING:return ZmMsg.running;
case ZmZimbraAccount.STATUS_AUTHFAIL:return this.code?this.getZdMsg(this.code):AjxMessageFormat.format(ZmMsg.authFailure,this.getEmail());
case ZmZimbraAccount.STATUS_ERROR:return this.code?this.getZdMsg(this.code):ZmMsg.error
}
return""
};
ZmZimbraAccount.prototype.showErrorMessage=function(){
if(this.status!=ZmZimbraAccount.STATUS_ERROR){
return
}
var a=appCtxt.getErrorDialog();
var o=this.getZdMsg(this.code);
if(o==""){
o=this.getStatusMessage()
}
a.setMessage(o);
var t=[];
var e=0;
if(this.errorMessage){
t[e++]="<p><b>";
t[e++]=ZdMsg.DebugMsg;
t[e++]="</b>: ";
t[e++]=this.errorMessage;
t[e++]="</p>"
}
if(this.errorDetail){
t[e++]="<p><b>";
t[e++]=ZdMsg.DebugStack;
t[e++]="</b>:</p><p><pre>";
t[e++]=this.errorDetail;
t[e++]="</pre></p>"
}
t[e++]="<p><b>";
t[e++]=ZdMsg.DebugActionNote;
t[e++]="</b></p>";
a.setDetailString(t.join(""));
a.popup(null,true)
};
ZmZimbraAccount.createFromDom=function(e){
var t=new ZmZimbraAccount();
t._loadFromDom(e);
return t
};
ZmZimbraAccount.prototype.load=function(u){
if(!this.loaded){
this.settings=new ZmSettings();
var r=appCtxt.accountList.mainAccount;
for(var o=0;
o<ZmApp.APPS.length;
o++){
var h=ZmApp.APPS[o];
var f=ZmApp.SETTING[h];
if(f&&appCtxt.get(f,null,r)){
var t=appCtxt.getApp(h);
if(t){
t._registerSettings(this.settings)
}}}
var a=new ZmBatchCommand(null,this.name);
var n=new AjxCallback(this,this._handleLoadSettings);
this.settings.loadUserSettings(n,null,this.name,null,null,a);
var e=AjxSoapDoc.create("GetTagRequest","urn:zimbraMail");
var d=new AjxCallback(this,this._handleLoadTags);
a.addNewRequestParams(e,d);
var c=AjxSoapDoc.create("GetFolderRequest","urn:zimbraMail");
c.getMethod().setAttribute("visible","1");
var l=new AjxCallback(this,this._handleLoadFolders);
a.addNewRequestParams(c,l);
var m=new AjxCallback(this,this._handleLoadUserInfo,u);
var s=new AjxCallback(this,this._handleErrorLoad);
a.run(m,s)
}else{
if(u){
u.run()
}}};
ZmZimbraAccount.prototype.unload=function(){
if(!appCtxt.inStartup){
this.settings.loadShortcuts(true)
}};
ZmZimbraAccount.prototype.sync=function(a){
var e=AjxSoapDoc.create("SyncRequest","urn:zimbraOffline");
if(appCtxt.get(ZmSetting.OFFLINE_DEBUG_TRACE)){
var t=e.getMethod();
t.setAttribute("debug",1)
}
appCtxt.getAppController().sendRequest({
soapDoc:e,asyncMode:true,noBusyOverlay:true,callback:a,accountName:this.name}
)
};
ZmZimbraAccount.prototype.save=function(a,t,e){
return(this.getIdentity().save(a,t,e))
};
ZmZimbraAccount.prototype.saveImplicitPrefs=function(){
ZmCsfeCommand._curAuthToken=ZmCsfeCommand.getAuthToken();
var t=[];
for(var a in ZmSetting.CHANGED_IMPLICIT){
var e=this.settings?this.settings.getSetting(a):null;
if(e&&(e.getValue(null,true)!=e.origValue)){
t.push(e)
}}
if(t&&t.length){
this.settings.save(t,null,null,this.name)
}};
ZmZimbraAccount.prototype.isAppEnabled=function(e){
switch(e){
case ZmApp.BRIEFCASE:return appCtxt.get(ZmSetting.BRIEFCASE_ENABLED,null,this);
case ZmApp.CALENDAR:return appCtxt.get(ZmSetting.CALENDAR_ENABLED,null,this);
case ZmApp.CONTACTS:return appCtxt.get(ZmSetting.CONTACTS_ENABLED,null,this);
case ZmApp.IM:return appCtxt.get(ZmSetting.IM_ENABLED,null,this);
case ZmApp.MAIL:return appCtxt.get(ZmSetting.MAIL_ENABLED,null,this);
case ZmApp.NOTEBOOK:return appCtxt.get(ZmSetting.NOTEBOOK_ENABLED,null,this);
case ZmApp.PREFERENCES:return appCtxt.get(ZmSetting.OPTIONS_ENABLED,null,this);
case ZmApp.TASKS:return appCtxt.get(ZmSetting.TASKS_ENABLED,null,this)
}};
ZmZimbraAccount.prototype._handleLoadSettings=function(e){
this.type=appCtxt.get(ZmSetting.OFFLINE_ACCOUNT_FLAVOR,null,this);
this.isZimbraAccount=this.type==ZmAccount.TYPE_ZIMBRA;
switch(this.type){
case ZmAccount.TYPE_AOL:this.icon="AccountAOL";
break;
case ZmAccount.TYPE_GMAIL:this.icon="AccountGmail";
break;
case ZmAccount.TYPE_IMAP:this.icon="AccountIMAP";
break;
case ZmAccount.TYPE_LIVE:this.icon="AccountMSN";
break;
case ZmAccount.TYPE_MSE:this.icon="AccountExchange";
break;
case ZmAccount.TYPE_POP:this.icon="AccountPOP";
break;
case ZmAccount.TYPE_YMP:this.icon="AccountYahoo";
break;
case ZmAccount.TYPE_ZIMBRA:this.icon="AccountZimbra";
break
}
var t=e.getResponse().GetInfoResponse;
appCtxt.getIdentityCollection(this).initialize(t.identities);
appCtxt.getDataSourceCollection(this).initialize(t.dataSources);
appCtxt.getSignatureCollection(this).initialize(t.signatures);
if(!this.isZimbraAccount){
appCtxt.set(ZmSetting.MAIL_READ_RECEIPT_ENABLED,false)
}};
ZmZimbraAccount.prototype._handleLoadFolders=function(e){
var a=e.getResponse().GetFolderResponse;
var t=a?a.folder[0]:null;
if(t){
appCtxt.getRequestMgr()._loadTree(ZmOrganizer.FOLDER,null,a.folder[0],"folder",this)
}};
ZmZimbraAccount.prototype._handleLoadTags=function(e){
var t=e.getResponse().GetTagResponse;
appCtxt.getRequestMgr()._loadTree(ZmOrganizer.TAG,null,t,null,this)
};
ZmZimbraAccount.prototype._handleLoadUserInfo=function(t){
this.loaded=true;
var e=appCtxt.getFolderTree(this);
if(e){
e.getPermissions({
noBusyOverlay:true}
)
}
if(t){
t.run()
}};
ZmZimbraAccount.prototype._handleErrorLoad=function(e){};
ZmZimbraAccount.prototype._loadFromDom=function(e){
this.id=e.id;
this.name=e.name;
this.visible=e.visible;
var t=e.attrs&&e.attrs._attrs;
this._displayName=t?t.displayName:this.email;
this._accountName=t&&t.zimbraPrefLabel
}
}
if(AjxPackage.define("zimbraMail.share.model.ZmInvite")){
ZmInvite=function(){
ZmModel.call(this)
};
ZmInvite.prototype=new ZmModel;
ZmInvite.prototype.constructor=ZmInvite;
ZmInvite.prototype.toString=function(){
return"ZmInvite: name="+this.name+" id="+this.id
};
ZmInvite._sendFun=null;
ZmInvite.createFromDom=function(n){
var t=new ZmInvite();
t.components=n[0].comp;
t.replies=n[0].replies;
if(t.components==null){
t.components=[{}
];
t.components.empty=true
}
var e=n[0];
if(e.tz){
for(var o=0;
o<e.tz.length;
o++){
var h=e.tz[o];
var s=AjxTimezone.getRule(h.id);
if(!s){
var r={
standard:h.standard?AjxUtil.createProxy(h.standard[0]):{}
,daylight:h.daylight?AjxUtil.createProxy(h.daylight[0]):null};
r.standard.offset=h.stdoff;
delete r.standard._object_;
if(h.daylight){
r.daylight.offset=h.dayoff;
delete r.daylight._object_
}
s=AjxTimezone.getRule(h.id,r);
if(s){
var a=AjxUtil.createProxy(s);
a.aliasId=s.clientId;
a.clientId=h.id;
a.serverId=h.id;
AjxTimezone.addRule(a)
}}
if(!s){
s={
clientId:h.id,serverId:h.id,autoDetected:true};
if(h.daylight){
s.standard=AjxUtil.createProxy(h.standard[0]);
s.standard.offset=h.stdoff;
s.standard.trans=AjxTimezone.createTransitionDate(s.standard);
s.daylight=AjxUtil.createProxy(h.daylight[0]);
s.daylight.offset=h.dayoff;
s.daylight.trans=AjxTimezone.createTransitionDate(s.daylight)
}else{
s.standard={
offset:h.stdoff}
}
AjxTimezone.addRule(s)
}}}
t.type=e&&e.type?e.type:"appt";
return t
};
ZmInvite.prototype.setMessageId=function(e){
this.msgId=e
};
ZmInvite.prototype.getMessageId=function(){
return this.msgId
};
ZmInvite.prototype.getComponent=function(e){
return this.components[e]
};
ZmInvite.prototype.getComponents=function(){
return this.components
};
ZmInvite.prototype.getComponentByUid=function(t){
for(var e=0;
e<components.length;
++e){
if(components.uid==t){
break
}}};
ZmInvite.prototype.hasMultipleComponents=function(){
return(this.components.length>1)
};
ZmInvite.prototype.hasOtherAttendees=function(e){
var t=e||0;
return this.components[t].at&&this.components[t].at.length>0
};
ZmInvite.prototype.getEventName=function(e){
var t=e||0;
return this.components[t]?this.components[t].name:null
};
ZmInvite.prototype.getAlarm=function(e){
var t=e||0;
return this.components[t]?this.components[t].alarm:null
};
ZmInvite.prototype.getInviteMethod=function(e){
var t=e||0;
return this.components[t]?this.components[t].method:null
};
ZmInvite.prototype.getOrganizerEmail=function(e){
var t=e||0;
return(this.components[t]&&this.components[t].or&&this.components[t].or.url)?(this.components[t].or.url.replace("MAILTO:","")):null
};
ZmInvite.prototype.getOrganizerName=function(e){
var t=e||0;
return(this.components[t]&&this.components[t].or)?(this.components[t].or.d||this.components[t].or.url):null
};
ZmInvite.prototype.getSentBy=function(e){
var t=e||0;
return(this.components[t]&&this.components[t].or)?this.components[t].or.sentBy:null
};
ZmInvite.prototype.isOrganizer=function(e){
var t=e||0;
return this.components[t]?(!!this.components[t].isOrg):false
};
ZmInvite.prototype.shouldRsvp=function(e){
var t=e||0;
return this.components[t]?this.components[t].rsvp:null
};
ZmInvite.prototype.getRecurrenceRules=function(e){
var t=e||0;
return this.components[t].recur
};
ZmInvite.prototype.getAttendees=function(a){
var n=a||0;
var e=this.components[n].at;
var o=[];
if(!(e&&e.length)){
return o
}
for(var t=0;
t<e.length;
t++){
if(!e[t].cutype||(e[t].cutype==ZmCalendarApp.CUTYPE_INDIVIDUAL)){
o.push(e[t])
}}
return o
};
ZmInvite.prototype.getReplies=function(e){
var t=e||0;
return(this.replies&&this.replies[t])?this.replies[t].reply:null
};
ZmInvite.prototype.getResources=function(a){
var n=a||0;
var e=this.components[n].at;
var o=[];
if(!(e&&e.length)){
return o
}
for(var t=0;
t<e.length;
t++){
if(e[t].cutype==ZmCalendarApp.CUTYPE_RESOURCE){
o.push(e[t])
}}
return o
};
ZmInvite.prototype.getExceptId=function(e){
var t=e||0;
return(this.components[t]&&this.components[t].exceptId)?this.components[t].exceptId[0]:null
};
ZmInvite.prototype.getStatus=function(e){
var t=e||0;
return this.components[t].status
};
ZmInvite.prototype.isEmpty=function(){
return Boolean(this.components.empty)
};
ZmInvite.prototype.isException=function(e){
var t=e||0;
return this.components[t]?this.components[t].ex:false
};
ZmInvite.prototype.isRecurring=function(e){
var t=e||0;
return this.components[t]?this.components[t].recur:false
};
ZmInvite.prototype.isAllDayEvent=function(e){
var t=e||0;
return this.components[t]?this.components[t].allDay=="1":false
};
ZmInvite.prototype.isMultiDay=function(t){
var o=t||0;
var a=this.getServerStartDate(o);
var e=this.getServerEndDate(o);
return(a.getDate()!=e.getDate())||(a.getMonth()!=e.getMonth())||(a.getFullYear()!=e.getFullYear())
};
ZmInvite.prototype.getComponentDescriptionHtml=function(e){
var o=e||0;
if(this.components[o]==null){
return
}
var a=this.components[o].descHtml;
var t=a&&a[0]._content||null;
return t
};
ZmInvite.prototype.getComponentDescription=function(e){
var o=e||0;
if(this.components[o]==null){
return
}
var a=this.components[o].desc;
var t=a&&a[0]._content||null;
return t
};
ZmInvite.prototype.getServerEndTime=function(l){
var u=l||0;
if(this.components[u]==null){
return
}
if(this._serverEndTime==null){
if(this.components[u].e!=null){
this._serverEndTime=this.components[u].e[0].d
}else{
if(this.components[u].s){
var a=this.components[u].dur;
var f=a&&a[0].d||0;
var e=a&&a[0].w||0;
var n=a&&a[0].h||0;
var s=a&&a[0].m||0;
var g=a&&a[0].s||0;
var p=parseInt(g)+(parseInt(s)*60)+(parseInt(n)*3600)+(parseInt(f)*24*3600)+(parseInt(e)*7*24*3600);
var o=this.components[u].s[0].d;
var r=parseInt(o.substr(0,4),10);
var m=parseInt(o.substr(4,2),10);
var f=parseInt(o.substr(6,2),10);
var c=new Date(r,m-1,f);
if(o.charAt(8)=="T"){
n=parseInt(o.substr(9,2),10);
s=parseInt(o.substr(11,2),10);
g=parseInt(o.substr(13,2),10);
c.setHours(n,s,g,0)
}
var h=new Date(c.getTime()+(p*1000));
m=AjxDateUtil._pad(c.getMonth()+1);
f=AjxDateUtil._pad(c.getDate());
n=AjxDateUtil._pad(c.getHours());
s=AjxDateUtil._pad(c.getMinutes());
g=AjxDateUtil._pad(c.getSeconds());
r=c.getFullYear();
this._serverEndTime=[r,m,f,"T",n,s,g].join("")
}}}
return this._serverEndTime
};
ZmInvite.prototype.getServerEndDate=function(e){
var t=e||0;
if(this._serverEndDate==null){
this._serverEndDate=AjxDateUtil.parseServerDateTime(this.getServerEndTime(t))
}
return this._serverEndDate
};
ZmInvite.prototype.getServerStartTime=function(e){
var t=e||0;
return this.components[t]&&this.components[t].s?this.components[t].s[0].d:null
};
ZmInvite.prototype.getServerStartDate=function(e){
var t=e||0;
if(this._serverStartDate==null){
this._serverStartDate=AjxDateUtil.parseServerDateTime(this.getServerStartTime(t))
}
return this._serverStartDate
};
ZmInvite.prototype.getServerStartTimeTz=function(e){
var a=e||0;
if(this.components[a]==null){
return
}
if(this._serverStartTimeZone==null){
var t=this.getServerStartTime();
this._serverStartTimeZone=t&&t.charAt(t.length-1)=="Z"?AjxTimezone.GMT_NO_DST:(this.components[a].s?this.components[a].s[0].tz:null)
}
return this._serverStartTimeZone
};
ZmInvite.prototype.getServerEndTimeTz=function(t){
var a=t||0;
if(this.components[a]==null){
return
}
if(this._serverEndTimeZone==null){
var e=this.getServerEndTime();
this._serverEndTimeZone=e&&startTime.charAt(e.length-1)=="Z"?AjxTimezone.GMT_NO_DST:this.components[a].e[0].tz
}
return this._serverEndTimeZone
};
ZmInvite.prototype.getDurationText=function(d,p,e,r){
var m=this.components[d];
if(this.isAllDayEvent(d)){
if(p){
return""
}
var u=this.getServerStartDate(d);
if(this.isMultiDay(d)){
var h=this.getServerEndDate(d);
var s=AjxDateFormat.getDateInstance();
var c=s.format(u);
var t=s.format(h);
if(!ZmInvite._daysFormatter){
ZmInvite._daysFormatter=new AjxMessageFormat(ZmMsg.durationDays)
}
return ZmInvite._daysFormatter.format([c,t])
}else{
var s=AjxDateFormat.getDateInstance(AjxDateFormat.FULL);
return s.format(u)
}}else{
var s=AjxDateFormat.getDateInstance(AjxDateFormat.FULL);
var n=AjxDateFormat.getTimeInstance(AjxDateFormat.SHORT);
var u=this.getServerStartDate(d);
var f=[s.format(u),r?" ":"<br>"];
if(e){
f.push(n.format(u))
}else{
var h=this.getServerEndDate(d);
var o=n.format(u);
var l=n.format(h);
if(!ZmInvite._hoursFormatter){
ZmInvite._hoursFormatter=new AjxMessageFormat(ZmMsg.durationHours)
}
f.push(ZmInvite._hoursFormatter.format([o,l]))
}
return f.join("")
}};
ZmInvite.prototype.getName=function(e){
var t=e||0;
return this.components[t]?this.components[t].name:null
};
ZmInvite.prototype.getFreeBusy=function(e){
var t=e||0;
return this.components[t]?this.components[t].fb:null
};
ZmInvite.prototype.getPrivacy=function(e){
var t=e||0;
return this.components[t]?this.components[t]["class"]:null
};
ZmInvite.prototype.getXProp=function(e){
var t=e||0;
return this.components[t]?this.components[t]["xprop"]:null
};
ZmInvite.prototype.getLocation=function(e){
var t=e||0;
return this.components[t]?this.components[t].loc:null
};
ZmInvite.prototype.getToolTip=function(){
if(this._toolTip){
return this._toolTip
}
var o=0;
var a=[];
var t=0;
a[t++]="<table cellpadding=0 cellspacing=0 border=0 >";
a[t++]="<tr valign='center'><td colspan=2 align='left'>";
a[t++]="<div style='border-bottom: 1px solid black;'>";
a[t++]="<table cellpadding=0 cellspacing=0 border=0 width=100%>";
a[t++]="<tr valign='center'><td><b>";
a[t++]="<div style='white-space:nowrap'><table border=0 cellpadding=0 cellspacing=0 style='display:inline'><tr>";
if(this.hasOtherAttendees(o)){
a[t++]="<td>";
a[t++]=AjxImg.getImageHtml("ApptMeeting");
a[t++]="</td>"
}
if(this.isException(o)){
a[t++]="<td>";
a[t++]=AjxImg.getImageHtml("ApptException");
a[t++]="</td>"
}else{
if(this.isRecurring(o)){
a[t++]="<td>";
a[t++]=AjxImg.getImageHtml("ApptRecur");
a[t++]="</td>"
}}
a[t++]="</tr></table>&nbsp;";
a[t++]=AjxStringUtil.htmlEncode(this.getName(o));
a[t++]="&nbsp;</div></b></td><td align='right'>";
a[t++]=AjxImg.getImageHtml("Appointment");
a[t++]="</td></table></div></td></tr>";
var e=this.getDurationText(o,false,false);
t=this._addEntryRow(ZmMsg.when,e,a,t,false,null,true);
if(this.isRecurring(o)){
if(!this._recurBlurb){
AjxDispatcher.require("CalendarCore");
var n=new ZmRecurrence();
n.parse(this.getRecurrenceRules(o));
this._recurBlurb=n.getBlurb()
}
t=this._addEntryRow(ZmMsg.repeats,this._recurBlurb,a,t,true,null,true)
}
t=this._addEntryRow(ZmMsg.location,this.getLocation(o),a,t,false);
a[t++]="</table>";
this._toolTip=a.join("");
return this._toolTip
};
ZmInvite.prototype.getSummary=function(e){
var r=0;
var l=this.getOrganizerName(r);
var d=this.getDurationText(r,false,false,true);
var h=this.getLocation(r);
if(this.isRecurring(r)){
if(!this._recurBlurb){
AjxDispatcher.require("CalendarCore");
var s=new ZmRecurrence();
s.setRecurrenceRules(this.getRecurrenceRules(r),this.getServerStartDate(r));
this._recurBlurb=s.getBlurb()
}}
var n=this._recurBlurb;
var t=[];
var o=0;
if(!this._summaryHtmlLineFormatter){
this._summaryHtmlLineFormatter=new AjxMessageFormat("<tr><th align='left'>{0}</th><td>{1} {2}</td></tr>");
this._summaryTextLineFormatter=new AjxMessageFormat("{0} {1} {2}")
}
var c=e?this._summaryHtmlLineFormatter:this._summaryTextLineFormatter;
var a=[];
if(e){
t[o++]="<p>\n<table border='0'>\n"
}
if(l){
a=[ZmMsg.organizerLabel,l,""];
t[o++]=c.format(a);
t[o++]="\n"
}
if(d){
a=[ZmMsg.whenLabel,d,""];
t[o++]=c.format(a);
t[o++]="\n"
}
if(h){
a=[ZmMsg.locationLabel,h,""];
t[o++]=c.format(a);
t[o++]="\n"
}
if(n){
a=[ZmMsg.repeatLabel,n,""];
t[o++]=c.format(a);
t[o++]="\n"
}
if(e){
t[o++]="</table>\n"
}
t[o++]=e?"<div>":"\n\n";
t[o++]=ZmItem.NOTES_SEPARATOR;
t[o++]=e?"</div><br>":"\n\n";
return t.join("")
};
ZmInvite.prototype._addEntryRow=function(r,s,t,e,n,o,a){
if(s!=null&&s!=""){
t[e++]="<tr valign='top'><td align='right' style='padding-right: 5px;'><b><div style='white-space:nowrap'>";
t[e++]=AjxMessageFormat.format(ZmMsg.makeLabel,AjxStringUtil.htmlEncode(r));
t[e++]="</div></b></td><td align='left'><div style='white-space:";
t[e++]=n?"wrap;":"nowrap;";
if(o){
t[e++]="width:";
t[e++]=o;
t[e++]="px;"
}
t[e++]="'>";
t[e++]=a?s:AjxStringUtil.htmlEncode(s);
t[e++]="</div></td></tr>"
}
return e
};
ZmInvite.prototype.hasAcceptableComponents=function(){
for(var e in this.components){
if(this.getStatus(e)!=ZmCalendarApp.STATUS_CANC){
return true
}}
return false
};
ZmInvite.prototype.hasInviteReplyMethod=function(t){
var e=this.getInviteMethod(t);
var a=(e==ZmCalendarApp.METHOD_REQUEST||e==ZmCalendarApp.METHOD_PUBLISH);
return((e==null)||a)
}
}
if(AjxPackage.define("zimbraMail.share.model.ZmImAddress")){
ZmImAddress={
IM_SERVICES:[{
label:ZmMsg.zimbraTitle,value:"local"}
,{
label:ZmMsg.yahoo,value:"yahoo"}
,{
label:ZmMsg.msn,value:"msn"}
,{
label:ZmMsg.aol,value:"aol"}
,{
label:ZmMsg.other,value:"other"}
],REGEXP:[],parse:function(t){
var e=ZmImAddress.REGEXP.exec(t);
if(e){
return{
service:e[1],screenName:e[2]}
}}
,make:function(e,t){
var a=e+"://"+t;
if(ZmImAddress.parse(a)){
return a
}
return""
}
,display:function(r){
var n=ZmImAddress.parse(r);
if(n){
var e=ZmImAddress.IM_SERVICES,t=0,o;
while(o=e[t++]){
if(o.value==n.service){
break
}}
if(o){
return n.screenName+" ("+o.label+")"
}}
return r
}};
if(/^SmartZone/.test(ZmMsg.zimbraTitle)){
ZmImAddress.IM_SERVICES.splice(0,1)
}
for(var i=0;
i<ZmImAddress.IM_SERVICES.length;
++i){
ZmImAddress.REGEXP.push(ZmImAddress.IM_SERVICES[i].value)
}
ZmImAddress.REGEXP=new RegExp("^("+ZmImAddress.REGEXP.join("|")+")://([^\\s]+)$","i")
}
if(AjxPackage.define("zimbraMail.share.model.ZmAccessControlList")){
ZmAccessControlList=function(e){
this._aces={}
};
ZmAccessControlList.prototype.toString=function(){
return"ZmAccessControlList"
};
ZmAccessControlList.prototype.load=function(a){
var t={
GetPermissionRequest:{
_jsns:"urn:zimbraMail"}};
var e=new AjxCallback(this,this._handleResponseLoad,[a]);
appCtxt.getAppController().sendRequest({
jsonObj:t,asyncMode:true,callback:e}
)
};
ZmAccessControlList.prototype._handleResponseLoad=function(n,e){
var t=e.getResponse();
var o=t.GetPermissionResponse.ace;
if(o&&o.length){
for(var a=0;
a<o.length;
a++){
this.add(ZmAccessControlEntry.createFromDom(o[a]))
}}
if(n){
n.run()
}};
ZmAccessControlList.prototype.getACLByRight=function(e){
return this._aces[e]
};
ZmAccessControlList.prototype.getGranteeType=function(u){
var t=this._aces[u];
var a=ZmSetting.ACL_PUBLIC;
var m={};
if(t&&t.length){
for(var r=0;
r<t.length;
r++){
var n=t[r];
var c=(n.granteeType==ZmSetting.ACL_USER||n.granteeType==ZmSetting.ACL_GROUP)?ZmSetting.ACL_USER:n.granteeType;
m[c]=n.negative?-1:1
}}
var d=(m[ZmSetting.ACL_PUBLIC]==1);
var o=(m[ZmSetting.ACL_PUBLIC]==-1);
var h=(m[ZmSetting.ACL_AUTH]==1);
var s=(m[ZmSetting.ACL_AUTH]==-1);
var l=(m[ZmSetting.ACL_USER]==1);
var e=(o||s)&&(m[ZmSetting.ACL_USER]==null);
if(d){
return ZmSetting.ACL_PUBLIC
}
if(h){
return ZmSetting.ACL_AUTH
}
if(o){
if(h){
return ZmSetting.ACL_AUTH
}}
if(l){
return ZmSetting.ACL_USER
}
if(e){
return ZmSetting.ACL_NONE
}
return a
};
ZmAccessControlList.prototype.getACLByGranteeType=function(o,e){
var a=this._aces[o];
var s=[];
if(a&&a.length){
for(var t=0;
t<a.length;
t++){
var n=a[t];
if(n.granteeType==e){
s.push(n)
}}}
s.sort();
return s
};
ZmAccessControlList.prototype.getGrantees=function(a){
var t=this._aces[a];
var n=[];
if(t&&t.length){
for(var e=0;
e<t.length;
e++){
var o=t[e];
if(o.granteeType==ZmSetting.ACL_USER||o.granteeType==ZmSetting.ACL_GROUP){
n.push(o.grantee)
}}}
n.sort();
return n
};
ZmAccessControlList.prototype.getGranteesInfo=function(a){
var t=this._aces[a];
var n=[];
if(t&&t.length){
for(var e=0;
e<t.length;
e++){
var o=t[e];
if(o.granteeType==ZmSetting.ACL_USER||o.granteeType==ZmSetting.ACL_GROUP){
n.push({
grantee:o.grantee,zid:o.zid}
)
}}}
n.sort(ZmAccessControlList.sortByGrantee);
return n
};
ZmAccessControlList.prototype.grant=function(t,a,e){
this._setPerms(t,false,a,e)
};
ZmAccessControlList.prototype.revoke=function(t,a,e){
this._setPerms(t,true,a,e)
};
ZmAccessControlList.prototype._setPerms=function(e,l,h,a){
var o=l?"RevokePermissionRequest":"GrantPermissionRequest";
var s=AjxSoapDoc.create(o,"urn:zimbraMail");
for(var n=0;
n<e.length;
n++){
var t=e[n];
var r=s.set("ace");
r.setAttribute("right",t.right);
r.setAttribute("gt",t.granteeType);
if(t.grantee){
r.setAttribute("d",t.grantee)
}
if(t.zid){
r.setAttribute("zid",t.zid)
}
if(t.negative){
r.setAttribute("deny",1)
}}
var c=new AjxCallback(this,this._handleResponseSetPerms,[l,h]);
if(a){
a.addNewRequestParams(s,c)
}else{
appCtxt.getAppController().sendRequest({
soapDoc:s,asyncMode:true,callback:c}
)
}};
ZmAccessControlList.prototype._handleResponseSetPerms=function(h,r,l){
var n=l.getResponse();
var o=h?n.RevokePermissionResponse:n.GrantPermissionResponse;
var e=o&&o.ace;
var t=[];
if(e&&e.length){
for(var s=0;
s<e.length;
s++){
var a=ZmAccessControlEntry.createFromDom(e[s]);
t.push(a);
if(h){
this.remove(a)
}else{
this.update(a)
}}}
if(r){
r.run(t)
}};
ZmAccessControlList.prototype.add=function(t){
if(!t){
return
}
var e=t.right;
if(!this._aces[e]){
this._aces[e]=[]
}
this._aces[e].push(t)
};
ZmAccessControlList.prototype.remove=function(a){
if(!a){
return
}
var o=this._aces[a.right];
var t=[];
if(o&&o.length){
for(var e=0;
e<o.length;
e++){
if(o[e].grantee!=a.grantee){
t.push(o[e])
}}}
this._aces[a.right]=t
};
ZmAccessControlList.prototype.update=function(t,n){
if(!t||!t.right){
return
}
var o=false;
if(!this._aces[t.right]){
this._aces[t.right]=[]
}
var a=this._aces[t.right];
if(a.length){
for(var e=0;
e<a.length;
e++){
if((a[e].grantee==t.grantee)&&(a[e].granteeType==t.granteeType)){
this._aces[t.right][e]=t;
o=true
}}}
if(!o){
this._aces[t.right].push(t)
}};
ZmAccessControlList.prototype.cleanup=function(){
this._aces={}
};
ZmAccessControlList.sortByGrantee=function(o,e){
var n=o.grantee;
var t=e.grantee;
if(n.toLowerCase()>t.toLowerCase()){
return 1
}
if(n.toLowerCase()<t.toLowerCase()){
return -1
}
return 0
};
ZmAccessControlEntry=function(e){
this.grantee=e.grantee;
this.zid=e.zid;
this.granteeType=e.granteeType;
this.right=e.right;
this.negative=e.negative
};
ZmAccessControlEntry.prototype.toString=function(){
return"ZmAccessControlEntry"
};
ZmAccessControlEntry.createFromDom=function(e){
var t={};
t.grantee=e.d;
t.granteeType=e.gt;
t.zid=e.zid;
t.right=e.right;
t.negative=(e.deny=="1");
return new ZmAccessControlEntry(t)
}
}
if(AjxPackage.define("zimbraMail.core.ZmApp")){
ZmApp=function(a,t,e){
if(arguments.length==0){
return
}
this._name=a;
this._appViewMgr=appCtxt.getAppViewMgr();
this._container=t;
this._parentController=e;
this._active=false;
this.currentSearch=null;
this._deferredFolders=[];
this._deferredFolderHash={};
this._deferredNotifications=[];
ZmApp.DROP_TARGETS[a]={};
this._defineAPI();
if(!e){
this._registerSettings()
}
this._registerOperations();
this._registerItems();
this._registerOrganizers();
if(!e){
this._setupSearchToolbar()
}
this._registerApp();
if(!appCtxt.isChildWindow){
this._opc=appCtxt.getOverviewController()
}};
ZmApp.CLASS={};
ZmApp.SETTING={};
ZmApp.UPSELL_SETTING={};
ZmApp.LOAD_SORT={};
ZmApp.BUTTON_ID={};
ZmApp.MAIN_PKG={};
ZmApp.NAME={};
ZmApp.ICON={};
ZmApp.TEXT_PRECEDENCE={};
ZmApp.IMAGE_PRECEDENCE={};
ZmApp.QS_ARG={};
ZmApp.QS_ARG_R={};
ZmApp.CHOOSER_TOOLTIP={};
ZmApp.VIEW_TOOLTIP={};
ZmApp.DEFAULT_SEARCH={};
ZmApp.ORGANIZER={};
ZmApp.OVERVIEW_TREES={};
ZmApp.HIDE_ZIMLETS={};
ZmApp.SEARCH_TYPES={};
ZmApp.SEARCH_TYPES_R={};
ZmApp.GOTO_ACTION_CODE={};
ZmApp.GOTO_ACTION_CODE_R={};
ZmApp.NEW_ACTION_CODE={};
ZmApp.ACTION_CODES={};
ZmApp.ACTION_CODES_R={};
ZmApp.OPS={};
ZmApp.OPS_R={};
ZmApp.QS_VIEWS={};
ZmApp.TRASH_VIEW_OP={};
ZmApp.UPSELL_URL={};
ZmApp.DROP_TARGETS={};
ZmApp.ASSISTANTS={};
ZmApp.CHOOSER_SORT={};
ZmApp.DEFAULT_SORT={};
ZmApp.ENABLED_APPS={};
ZmApp.APPS=[];
ZmApp.DEFAULT_APPS=[];
ZmApp.OVERVIEW_ID="main";
ZmApp.initialize=function(){
if(appCtxt.get(ZmSetting.USE_KEYBOARD_SHORTCUTS)){
ZmApp.ACTION_CODES[ZmKeyMap.NEW_FOLDER]=ZmOperation.NEW_FOLDER;
ZmApp.ACTION_CODES[ZmKeyMap.NEW_TAG]=ZmOperation.NEW_TAG
}};
ZmApp.registerApp=function(n,o){
if(o.mainPkg){
ZmApp.MAIN_PKG[n]=o.mainPkg
}
if(o.nameKey){
ZmApp.NAME[n]=o.nameKey
}
if(o.icon){
ZmApp.ICON[n]=o.icon
}
if(o.textPrecedence){
ZmApp.TEXT_PRECEDENCE[n]=o.textPrecedence
}
if(o.imagePrecedence){
ZmApp.IMAGE_PRECEDENCE[n]=o.imagePrecedence
}
if(o.chooserTooltipKey){
ZmApp.CHOOSER_TOOLTIP[n]=o.chooserTooltipKey
}
if(o.viewTooltipKey){
ZmApp.VIEW_TOOLTIP[n]=o.viewTooltipKey
}
if(o.defaultSearch){
ZmApp.DEFAULT_SEARCH[n]=o.defaultSearch
}
if(o.organizer){
ZmApp.ORGANIZER[n]=o.organizer
}
if(o.overviewTrees){
ZmApp.OVERVIEW_TREES[n]=o.overviewTrees
}
if(o.hideZimlets){
ZmApp.HIDE_ZIMLETS[n]=o.hideZimlets
}
if(o.assistants){
ZmApp.ASSISTANTS[n]=o.assistants
}
if(o.searchTypes){
ZmApp.SEARCH_TYPES[n]=o.searchTypes
}
if(o.gotoActionCode){
ZmApp.GOTO_ACTION_CODE[n]=o.gotoActionCode
}
if(o.newActionCode){
ZmApp.NEW_ACTION_CODE[n]=o.newActionCode
}
if(o.qsViews){
ZmApp.QS_VIEWS[n]=o.qsViews
}
if(o.chooserSort){
ZmApp.CHOOSER_SORT[n]=o.chooserSort
}
if(o.defaultSort){
ZmApp.DEFAULT_SORT[n]=o.defaultSort
}
if(o.trashViewOp){
ZmApp.TRASH_VIEW_OP[n]=o.trashViewOp
}
if(o.upsellUrl){
ZmApp.UPSELL_URL[n]=o.upsellUrl
}
if(o.searchTypes){
ZmApp.SEARCH_TYPES_R[n]={};
for(var t=0;
t<o.searchTypes.length;
t++){
ZmApp.SEARCH_TYPES_R[n][o.searchTypes[t]]=true
}}
if(o.gotoActionCode){
ZmApp.GOTO_ACTION_CODE_R[o.gotoActionCode]=n
}
if(o.actionCodes){
for(var a in o.actionCodes){
if(!a){
continue
}
ZmApp.ACTION_CODES_R[a]=n;
ZmApp.ACTION_CODES[a]=o.actionCodes[a]
}}
var e=appCtxt.get(ZmApp.SETTING[n]);
if(o.newItemOps&&e){
for(var s in o.newItemOps){
if(!s){
continue
}
ZmApp.OPS_R[s]=n;
ZmOperation.NEW_ITEM_OPS.push(s);
ZmOperation.NEW_ITEM_KEY[s]=o.newItemOps[s]
}}
if(o.newOrgOps&&e){
for(var s in o.newOrgOps){
if(!s){
continue
}
ZmApp.OPS_R[s]=n;
ZmOperation.NEW_ORG_OPS.push(s);
ZmOperation.NEW_ORG_KEY[s]=o.newOrgOps[s]
}}
if(o.qsViews){
for(var t=0;
t<o.qsViews.length;
t++){
ZmApp.QS_VIEWS[o.qsViews[t]]=n
}}};
ZmApp.prototype.toString=function(){
return"ZmApp"
};
ZmApp.prototype._defineAPI=function(){};
ZmApp.prototype._registerSettings=function(){};
ZmApp.prototype._registerOperations=function(){};
ZmApp.prototype._registerItems=function(){};
ZmApp.prototype._registerOrganizers=function(){};
ZmApp.prototype._setupSearchToolbar=function(){};
ZmApp.prototype._registerApp=function(){};
ZmApp.prototype._registerPrefs=function(){};
ZmApp.prototype.startup=function(e){};
ZmApp.prototype.preNotify=function(e){};
ZmApp.prototype.deleteNotify=function(e){};
ZmApp.prototype.createNotify=function(e){};
ZmApp.prototype.modifyNotify=function(e){};
ZmApp.prototype.postNotify=function(e){};
ZmApp.prototype.refresh=function(e){};
ZmApp.prototype.handleOp=function(t,e){};
ZmApp.prototype.getName=function(){
return this._name
};
ZmApp.prototype.getDisplayName=function(){
return ZmMsg[ZmApp.NAME[this._name]]
};
ZmApp.prototype.getInitialSearchType=function(){
return null
};
ZmApp.prototype.getLimit=function(e){
return appCtxt.get(ZmSetting.PAGE_SIZE)
};
ZmApp.prototype.setAppView=function(e){
this._appViewMgr.setAppView(this._name,e)
};
ZmApp.prototype.createView=function(e){
e.appName=this._name;
return this._appViewMgr.createView(e)
};
ZmApp.prototype.pushView=function(e,t){
return this._appViewMgr.pushView(e,t)
};
ZmApp.prototype.popView=function(e){
return this._appViewMgr.popView(e)
};
ZmApp.prototype.setView=function(e,t){
return this._appViewMgr.setView(e,t)
};
ZmApp.prototype.stageView=function(e){
return this._appViewMgr.setView(e)
};
ZmApp.prototype.addDeferredFolder=function(e){
var t=e.obj&&e.obj.id;
if(t&&!this._deferredFolderHash[t]){
this._deferredFolders.push(e);
this._deferredFolderHash[t]=true;
appCtxt.cacheSetDeferred(t,this._name)
}};
ZmApp.prototype.getRemoteFolderIds=function(r){
var s=[];
if(this._opc){
var o=ZmApp.ORGANIZER[this.getName()];
if(this._deferredFolders.length){
this._createDeferredFolders(o)
}
var e=appCtxt.getFolderTree(r);
var a=e?e.getByType(o):[];
for(var t=0;
t<a.length;
t++){
var n=a[t];
if(n.isRemote()){
s.push(n.id)
}}}
return s
};
ZmApp.prototype.getOverviewPanelContent=function(){
if(!this._overviewPanelContent){
var t=this._getOverviewParams();
t.overviewId=this.getOverviewId();
var e=this._overviewPanelContent=this._opc.createOverview(t);
e.set(this._getOverviewTrees())
}
return this._overviewPanelContent
};
ZmApp.prototype.getOverviewContainer=function(){
if(!this._overviewContainer){
var e={
appName:this._name,containerId:([ZmApp.OVERVIEW_ID,this._name].join("_")),posStyle:Dwt.ABSOLUTE_STYLE};
var t=this._getOverviewParams();
t.overviewTrees=this._getOverviewTrees();
this._overviewContainer=this._opc.createOverviewContainer(e,t)
}
return this._overviewContainer
};
ZmApp.prototype.setOverviewPanelContent=function(a){
if(a){
this._overviewPanelContent=null;
this._overviewContainer=null
}
var e=appCtxt.getAppViewMgr();
if(!e.isFullScreen()){
var t=(appCtxt.multiAccounts||this.getName()==ZmApp.VOICE)?this.getOverviewContainer():this.getOverviewPanelContent();
e.setComponent(ZmAppViewMgr.C_TREE,t)
}};
ZmApp.prototype.getOverview=function(){
return this._opc&&this._opc.getOverview(this.getOverviewId())
};
ZmApp.prototype.resetOverview=function(t){
var u=t?this._opc.getOverview(t):this.getOverview();
if(u){
var s=[];
var d=u.getTreeViews(),l=d.length;
for(var n=0;
n<l;
n++){
var h=d[n];
var e=u.getTreeView(h);
var c=e.getTreeItemList();
var o=c.length;
for(var a=0;
a<o;
a++){
var r=c[a];
if(r._expanded){
s.push(r._htmlElId)
}}}
u.clear();
u.set(this._getOverviewTrees());
l=s.length;
for(var n=0;
n<l;
n++){
var r=DwtControl.fromElementId(s[n]);
if(r&&!r._expanded){
r.setExpanded(true)
}}}};
ZmApp.prototype.getOverviewId=function(e){
return appCtxt.getOverviewId([ZmApp.OVERVIEW_ID,this._name],e)
};
ZmApp.prototype._getOverviewParams=function(){
var e=[];
for(var a in ZmOverviewController.CONTROLLER){
e.push(a)
}
var t=function(n,o){
return(ZmOrganizer.DISPLAY_ORDER[n]||9999)-(ZmOrganizer.DISPLAY_ORDER[o]||9999)
};
e.sort(t);
return{
posStyle:Dwt.ABSOLUTE_STYLE,selectionSupported:true,actionSupported:true,dndSupported:true,showUnread:true,showNewButtons:true,isAppOverview:true,treeIds:e,appName:this._name,account:appCtxt.getActiveAccount(),scroll:Dwt.SCROLL_Y}
};
ZmApp.prototype._getOverviewTrees=function(){
var o=ZmApp.OVERVIEW_TREES[this._name]||[];
var t=[];
for(var e=0,a=o.length;
e<a;
e++){
if((o[e]==ZmOrganizer.FOLDER&&!appCtxt.get(ZmSetting.MAIL_ENABLED))){
continue
}
t.push(o[e])
}
if(!appCtxt.multiAccounts&&window[ZmOverviewController.CONTROLLER[ZmOrganizer.ZIMLET]]&&!ZmApp.HIDE_ZIMLETS[this._name]){
t.push(ZmOrganizer.ZIMLET)
}
return t
};
ZmApp.prototype._setMiniCalForActiveAccount=function(e){
var t=appCtxt.get(ZmSetting.CAL_ALWAYS_SHOW_MINI_CAL);
AjxDispatcher.run("ShowMiniCalendar",t);
if(t&&e){
var a=AjxDispatcher.run("GetCalController");
a._checkedCalendars=null;
a._checkedCalendarIds=null;
a.getMiniCalCache().clearCache();
a.fetchMiniCalendarAppts(ZmCalViewController.MAINT_MINICAL)
}};
ZmApp.prototype._addSettingsChangeListeners=function(){
if(!this._settingListener){
this._settingListener=new AjxListener(this,this._settingChangeListener)
}
var e=appCtxt.getSettings();
setting=e.getSetting(ZmSetting.CAL_ALWAYS_SHOW_MINI_CAL);
if(setting){
setting.addChangeListener(this._settingListener)
}
setting=e.getSetting(ZmSetting.CAL_FIRST_DAY_OF_WEEK);
if(setting){
setting.addChangeListener(this._settingListener)
}};
ZmApp.prototype._settingChangeListener=function(n){
if(n.type!=ZmEvent.S_SETTING){
return
}
var o=n.source;
if(o.id==ZmSetting.CAL_ALWAYS_SHOW_MINI_CAL){
if(o.getValue()){
AjxDispatcher.run("ShowMiniCalendar",true)
}else{
if(!this._active){
AjxDispatcher.run("ShowMiniCalendar",false)
}}}else{
if(o.id==ZmSetting.CAL_FIRST_DAY_OF_WEEK){
var e=AjxDispatcher.run("GetCalController");
var s=e.getMiniCalendar();
var t=o.getValue();
s.setFirstDayOfWeek(t);
var a=s.getDate();
e.setDate(a,0,true)
}}};
ZmApp.prototype.getSearchParams=function(e){
return(e||{}
)
};
ZmApp.prototype._postLoadCore=function(){
if(!appCtxt.isChildWindow){
this._setupDropTargets()
}};
ZmApp.prototype._postLoad=function(e){
if(e){
this._createDeferredFolders(e)
}
this._handleDeferredNotifications()
};
ZmApp.prototype._setupDropTargets=function(){
var a=ZmApp.DROP_TARGETS[this._name];
for(var s in a){
var t=a[s];
for(var o=0;
o<t.length;
o++){
var r=t[o];
var e=appCtxt.getOverviewController().getTreeController(r,true);
var n=ZmList.ITEM_CLASS[s]||ZmOrganizer.ORG_CLASS[s];
if(e){
e._dropTgt.addTransferType(n)
}else{
if(!ZmTreeController.DROP_SOURCES[r]){
ZmTreeController.DROP_SOURCES[r]=[]
}
ZmTreeController.DROP_SOURCES[r].push(n)
}}}};
ZmApp.prototype.createDeferred=function(){
var a=ZmOrganizer.APP2ORGANIZER[this._name]||[];
for(var t=0;
t<a.length;
t++){
var o=a[t];
var e=ZmOrganizer.ORG_PACKAGE[o];
AjxDispatcher.require(e);
this._createDeferredFolders(o)
}};
ZmApp.prototype._createDeferredFolders=function(t){
for(var e=0;
e<this._deferredFolders.length;
e++){
var o=this._deferredFolders[e];
var a=ZmFolderTree.createFolder(o.type,o.parent,o.obj,o.tree,o.path,o.elementType);
o.parent.children.add(a);
a.parent=o.parent;
ZmFolderTree._traverse(a,o.obj,o.tree,o.path||[])
}
this._clearDeferredFolders()
};
ZmApp.prototype._clearDeferredFolders=function(){
this._deferredFolders=[];
this._deferredFolderHash={}
};
ZmApp.prototype._deferNotifications=function(t,a){
var e=ZmApp.MAIN_PKG[this._name];
if(e&&!AjxDispatcher.loaded(e)){
this._deferredNotifications.push({
type:t,data:a}
);
return true
}else{
this._noDefer=true;
return false
}};
ZmApp.prototype._handleDeferredNotifications=function(){
var t=this._deferredNotifications;
for(var a=0;
a<t.length;
a++){
var e=t[a];
if(e.type=="delete"){
this.deleteNotify(e.data,true)
}else{
if(e.type=="create"){
this.createNotify(e.data,true)
}else{
if(e.type=="modify"){
this.modifyNotify(e.data,true)
}}}}};
ZmApp.prototype._inNewWindow=function(t){
var e=appCtxt.get(ZmSetting.NEW_WINDOW_COMPOSE);
return !t?e:((!e&&t&&t.shiftKey)||(e&&t&&!t.shiftKey))
};
ZmApp.prototype._handleCreateFolder=function(e,a){
var t=appCtxt.getById(e.l);
if(t&&(ZmOrganizer.VIEWS[a][e.view])){
t.notifyCreate(e);
e._handled=true
}};
ZmApp.prototype._handleCreateLink=function(t,o){
var a=appCtxt.getById(t.l);
var e=t.view||"message";
if(a&&a.supportsSharing()&&(ZmOrganizer.VIEW_HASH[o][e])){
a.notifyCreate(t);
t._handled=true
}};
ZmApp.prototype.launch=function(e,t){
this.createDeferred();
if(t){
t.run()
}};
ZmApp.prototype.activate=function(e){
this._active=e;
if(e){
this.setOverviewPanelContent();
this.stopAlert()
}};
ZmApp.prototype.isActive=function(){
return this._active
};
ZmApp.prototype.reset=function(e){};
ZmApp.prototype.startAlert=function(){
AjxDispatcher.require("Alert");
this._alert=this._alert||new ZmAppAlert(this);
this._alert.start()
};
ZmApp.prototype.stopAlert=function(){
if(this._alert){
this._alert.stop()
}};
ZmApp.prototype._notifyRendered=function(){
if(!this._hasRendered){
appCtxt.getAppController().appRendered(this._name);
this._hasRendered=true
}}
}
if(AjxPackage.define("zimbraMail.share.view.ZmPopupMenu")){
ZmPopupMenu=function(a,t,o,e){
if(arguments.length==0){
return
}
params=Dwt.getParams(arguments,ZmPopupMenu.PARAMS);
params.className=params.className?params.className:"ActionMenu";
params.style=params.style||DwtMenu.POPUP_STYLE;
DwtMenu.call(this,params);
e=e||appCtxt.getCurrentController();
if(e){
this._controller=e;
this._keyMap=ZmKeyMap.MAP_NAME_R[this._controller.getKeyMapName()]
}
this._menuItems={}
};
ZmPopupMenu.PARAMS=["parent","className","id","controller"];
ZmPopupMenu.prototype=new DwtMenu;
ZmPopupMenu.prototype.constructor=ZmPopupMenu;
ZmPopupMenu.prototype.toString=function(){
return"ZmPopupMenu"
};
ZmPopupMenu.prototype.addSelectionListener=function(o,a,e){
var t=this._menuItems[o];
if(t){
t.addSelectionListener(a,e)
}};
ZmPopupMenu.prototype.removeSelectionListener=function(a,t){
var e=this._menuItems[a];
if(e){
e.removeSelectionListener(t)
}};
ZmPopupMenu.prototype.popup=function(t,e,o,a){
t=t?t:0;
e=(e!=null)?e:Dwt.DEFAULT;
o=(o!=null)?o:Dwt.DEFAULT;
DwtMenu.prototype.popup.call(this,t,e,o,a)
};
ZmPopupMenu.prototype.enable=function(a,e){
a=(a instanceof Array)?a:[a];
for(var t=0;
t<a.length;
t++){
if(this._menuItems[a[t]]){
this._menuItems[a[t]].setEnabled(e)
}}};
ZmPopupMenu.prototype.enableAll=function(e){
for(var t in this._menuItems){
this._menuItems[t].setEnabled(e)
}};
ZmPopupMenu.prototype.createMenuItem=function(a,t){
var e=this._menuItems[a]=new DwtMenuItem({
parent:this,style:t.style,radioGroupId:t.radioGroupId,id:t.id,index:t.index}
);
if(t.image){
e.setImage(t.image)
}
if(t.text){
e.setText(t.text)
}
if(t.shortcut){
e.setShortcut(appCtxt.getShortcutHint(this._keyMap,t.shortcut))
}
e.setEnabled(t.enabled!==false);
return e
};
ZmPopupMenu.prototype.getMenuItem=function(e){
return this._menuItems[e]
};
ZmPopupMenu.prototype.createSeparator=function(){
new DwtMenuItem({
parent:this,style:DwtMenuItem.SEPARATOR_STYLE}
)
}
}
if(AjxPackage.define("zimbraMail.share.view.ZmActionMenu")){
ZmActionMenu=function(t){
var a=t.context?ZmId.getMenuId(t.context,t.menuType):null;
ZmPopupMenu.call(this,t.parent,null,a,t.controller);
var e=t.menuItems;
if(!e){
e=[ZmOperation.TAG_MENU,ZmOperation.PRINT,ZmOperation.DELETE]
}else{
if(e==ZmOperation.NONE){
e=null
}}
this.opList=ZmOperation.filterOperations(e);
this._context=t.context;
this._menuType=t.menuType;
this._menuItems=ZmOperation.createOperations(this,this.opList,t.overrides)
};
ZmActionMenu.prototype=new ZmPopupMenu;
ZmActionMenu.prototype.constructor=ZmActionMenu;
ZmActionMenu.prototype.toString=function(){
return"ZmActionMenu"
};
ZmActionMenu.prototype.createOp=function(a,t){
t.id=this._context?ZmId.getMenuItemId(this._context,a,this._menuType):null;
var e=this.createMenuItem(a,t);
e.setData(ZmOperation.KEY_ID,a);
return e
};
ZmActionMenu.prototype.addOp=function(e){
ZmOperation.addOperation(this,e,this._menuItems)
};
ZmActionMenu.prototype.removeOp=function(e){
ZmOperation.removeOperation(this,e,this._menuItems)
};
ZmActionMenu.prototype.getOp=function(e){
return this.getMenuItem(e)
};
ZmActionMenu.prototype.getTagMenu=function(){
var e=this.getMenuItem(ZmOperation.TAG_MENU);
if(e){
return e.getMenu()
}};
ZmActionMenu.prototype._menuItemId=function(e){
return e.getData(ZmOperation.KEY_ID)
}
}
if(AjxPackage.define("zimbraMail.share.view.ZmToolBar")){
ZmToolBar=function(t){
if(arguments.length==0){
return
}
t.posStyle=t.posStyle||DwtControl.ABSOLUTE_STYLE;
DwtToolBar.call(this,t);
var e=t.controller||appCtxt.getCurrentController();
if(e){
this._controller=e;
this._keyMap=ZmKeyMap.MAP_NAME_R[this._controller.getKeyMapName()]
}
this._refElementId=t.refElementId;
this._buttons={}
};
ZmToolBar.prototype=new DwtToolBar;
ZmToolBar.prototype.constructor=ZmToolBar;
ZmToolBar.prototype.toString=function(){
return"ZmToolBar"
};
ZmToolBar.prototype.addSelectionListener=function(t,a){
var e=this._buttons[t];
if(e){
e.addSelectionListener(a)
}};
ZmToolBar.prototype.removeSelectionListener=function(t,a){
var e=this._buttons[t];
if(e){
e.removeSelectionListener(a)
}};
ZmToolBar.prototype.getButton=function(e){
return this._buttons[e]
};
ZmToolBar.prototype.setData=function(t,e,a){
this._buttons[t].setData(e,a)
};
ZmToolBar.prototype.enable=function(a,e){
a=(a instanceof Array)?a:[a];
for(var t=0;
t<a.length;
t++){
if(this._buttons[a[t]]){
this._buttons[a[t]].setEnabled(e)
}}};
ZmToolBar.prototype.enableAll=function(e){
for(var t in this._buttons){
this._buttons[t].setEnabled(e)
}};
ZmToolBar.prototype.createButton=function(a,t){
var e=this._buttons[a]=this._createButton(t);
if(t.image){
e.setImage(t.image)
}
if(t.text){
e.setText(t.text)
}
if(t.tooltip){
e.setToolTipContent(ZmOperation.getToolTip(a,this._keyMap)||t.tooltip)
}
e.setEnabled(t.enabled!==false);
e.setData("_buttonId",a);
if(t.menu){
e.setMenu(t.menu,false,null,t.menuAbove)
}
return e
};
ZmToolBar.prototype.SEPARATOR_TEMPLATE="share.Widgets#ZmToolBarSeparator";
ZmToolBar.prototype._createButton=function(o,t){
var a=o.ctor||DwtToolBarButton;
var e=new a({
parent:this,style:o.style,className:t,index:o.index,id:o.id,template:o.template}
);
e.textPrecedence=o.textPrecedence;
e.imagePrecedence=o.imagePrecedence;
return e
};
ZmToolBar.prototype._buttonId=function(e){
return e.getData("_buttonId")
};
ZmToolBar.prototype._createPrecedenceList=function(){
this._precedenceList=[];
for(var o in this._buttons){
if(ZmOperation.isSep(o)){
continue
}
var e=this._buttons[o];
var a=e.textPrecedence;
if(a){
this._precedenceList.push({
id:o,type:"text",precedence:a}
)
}
var t=e.imagePrecedence;
if(t){
this._precedenceList.push({
id:o,type:"image",precedence:t}
)
}}
this._precedenceList.sort(function(s,n){
return(s.precedence>n.precedence)?1:(s.precedence<n.precedence)?-1:0
}
)
};
ZmToolBar.prototype.adjustSize=function(){
if(!this._refElementId||!this._inited){
return
}
var o=this.getHtmlElement();
if(!this._refElement){
this._refElement=document.getElementById(this._refElementId)
}
if(!o||!this._refElement){
return
}
var a=this._refElement.offsetWidth;
var t=o.firstChild?o.firstChild.offsetWidth:a;
for(var s=0;
s<this._precedenceList.length;
s++){
var e=this._precedenceList[s];
var l=this._buttons[e.id];
if(!l){
continue
}
if(e.type=="text"&&l._toggleText){
l.setText(l._toggleText);
l._toggleText=null
}else{
if(e.type=="image"&&l._toggleimage){
l.setImage(l._toggleimage);
l._toggleimage=null
}}}
t=o.firstChild?o.firstChild.offsetWidth:a;
if(a>0&&t>a){
for(var s=0;
s<this._precedenceList.length;
s++){
var e=this._precedenceList[s];
var l=this._buttons[e.id];
if(!l||!l.getVisible()){
continue
}
var c=l.getText();
var n=l.getImage();
var r=Boolean(c||l._toggleText);
var h=Boolean(n||l._toggleimage);
if(r&&h&&(t>a)){
if(e.type=="text"){
l._toggleText=c;
l.setText("")
}else{
if(e.type=="image"){
l._toggleimage=n;
l.setImage("")
}}}
t=o.firstChild?o.firstChild.offsetWidth:a
}}};
ZmToolBar.prototype.setSize=function(t,e){
var a=this.getSize();
if(t!=a.x||e!=a.y){
DwtToolBar.prototype.setSize.apply(this,arguments);
this.adjustSize()
}};
ZmToolBar.prototype._addItem=function(a,t,e){
DwtToolBar.prototype._addItem.apply(this,arguments);
this.adjustSize()
};
ZmToolBar.prototype._removeItem=function(a,t,e){
DwtToolBar.prototype._removeItem.apply(this,arguments);
this.adjustSize()
}
}
if(AjxPackage.define("zimbraMail.share.view.ZmButtonToolBar")){
ZmButtonToolBar=function(t){
if(arguments.length==0){
return
}
t.className=t.className||"ZToolbar";
t.id=t.context?ZmId.getToolbarId(t.context,t.toolbarType):null;
ZmToolBar.call(this,t);
this._context=t.context;
this._toolbarType=t.toolbarType;
this._buttonStyle=t.buttonClassName;
var e=t.buttons;
if(!e){
e=[ZmOperation.NEW_MENU,ZmOperation.TAG_MENU,ZmOperation.PRINT,ZmOperation.DELETE]
}else{
if(e==ZmOperation.NONE){
e=null
}}
this.opList=ZmOperation.filterOperations(e);
this._buttons=ZmOperation.createOperations(this,this.opList,t.overrides);
this._createPrecedenceList();
this._inited=true
};
ZmButtonToolBar.prototype=new ZmToolBar;
ZmButtonToolBar.prototype.constructor=ZmButtonToolBar;
ZmButtonToolBar.prototype.toString=function(){
return"ZmButtonToolBar"
};
ZmButtonToolBar.prototype.createOp=function(o,a){
a.className=this._buttonStyle;
var e;
if(o==ZmOperation.TEXT){
var o;
if(this._context){
var t=this._toolbarType?[this._context,this._toolbarType].join("_"):this._context;
o=[ZmId.WIDGET,AjxStringUtil.toMixed(t,"_",true),AjxStringUtil.toMixed(o,"_")].join("")
}
a.textClassName=a.textClassName||"ZWidgetTitle";
e=new DwtText({
parent:this,className:a.textClassName,id:o}
)
}else{
a.id=this._context?ZmId.getButtonId(this._context,o,this._toolbarType):null;
a.textPrecedence=ZmOperation.getProp(o,"textPrecedence");
a.iconPrecedence=ZmOperation.getProp(o,"iconPrecedence");
e=this.createButton(o,a)
}
e.setData(ZmOperation.KEY_ID,o);
return e
};
ZmButtonToolBar.prototype.addOp=function(t,e){
ZmOperation.addOperation(this,t,this._buttons,e);
AjxUtil.arrayAdd(this.opList,t,e)
};
ZmButtonToolBar.prototype.removeOp=function(e){
ZmOperation.removeOperation(this,e,this._buttons);
AjxUtil.arrayRemove(this.opList,e)
};
ZmButtonToolBar.prototype.getOp=function(e){
return this.getButton(e)
};
ZmButtonToolBar.prototype.getTagMenu=function(){
var e=this.getButton(ZmOperation.TAG_MENU);
if(e){
return e.getMenu()
}};
ZmButtonToolBar.prototype._buttonId=function(e){
return e.getData(ZmOperation.KEY_ID)
}
}
if(AjxPackage.define("zimbraMail.share.view.ZmNavToolBar")){
ZmNavToolBar=function(t){
t.className=t.className||"ZmNavToolBar";
var e=(t.hasText!==false);
t.buttons=this._getButtons(e);
t.toolbarType=ZmId.TB_NAV;
t.posStyle=t.posStyle||DwtControl.STATIC_STYLE;
ZmButtonToolBar.call(this,t);
if(e){
this._textButton=this.getButton(ZmOperation.TEXT)
}};
ZmNavToolBar.prototype=new ZmButtonToolBar;
ZmNavToolBar.prototype.constructor=ZmNavToolBar;
ZmNavToolBar.prototype.toString=function(){
return"ZmNavToolBar"
};
ZmNavToolBar.prototype.enable=function(o,e){
ZmButtonToolBar.prototype.enable.call(this,o,e);
if(!e){
if(!(o instanceof Array)){
o=[o]
}
for(var a=0;
a<o.length;
a++){
var t=this.getButton(o[a]);
if(t){
t.setToolTipContent(null)
}}}};
ZmNavToolBar.prototype.setToolTip=function(t,a){
var e=this.getButton(t);
if(e){
e.setToolTipContent(a)
}};
ZmNavToolBar.prototype.setText=function(e){
if(!this._textButton){
return
}
this._textButton.setText(e)
};
ZmNavToolBar.prototype._getButtons=function(e){
var t=[];
t.push(ZmOperation.PAGE_BACK);
if(e){
t.push(ZmOperation.TEXT)
}
t.push(ZmOperation.PAGE_FORWARD);
return t
};
ZmNavToolBar.prototype.createOp=function(t,e){
e.textClassName="ZWidgetTitle ZmNavToolBarTitle";
return ZmButtonToolBar.prototype.createOp.apply(this,arguments)
}
}
if(AjxPackage.define("zimbraMail.share.view.ZmSearchToolBar")){
ZmSearchToolBar=function(e,a){
DwtComposite.call(this,{
parent:e,className:"ZmSearchToolbar",id:a}
);
var t={
msgKey:"searchAll",tooltipKey:"searchForAny",icon:"Globe",setting:ZmSetting.MIXED_VIEW_ENABLED,index:0,id:ZmId.getMenuItemId(ZmId.SEARCH,ZmId.SEARCH_ANY)};
ZmSearchToolBar.addMenuItem(ZmId.SEARCH_ANY,t);
t={
msgKey:"searchShared",tooltipKey:"searchShared",icon:"Group",setting:ZmSetting.SHARING_ENABLED,id:ZmId.getMenuItemId(ZmId.SEARCH,ZmId.SEARCH_SHARED)};
ZmSearchToolBar.addMenuItem(ZmId.SEARCH_SHARED,t);
if(appCtxt.multiAccounts){
t={
msgKey:"searchAllAccounts",icon:"Globe",id:ZmId.getMenuItemId(ZmId.SEARCH,ZmId.SEARCH_ALL_ACCOUNTS)};
ZmSearchToolBar.addMenuItem(ZmId.SEARCH_ALL_ACCOUNTS,t)
}
this._createHtml()
};
ZmSearchToolBar.prototype=new DwtComposite;
ZmSearchToolBar.prototype.constructor=ZmSearchToolBar;
ZmSearchToolBar.SEARCH_MENU_BUTTON=1;
ZmSearchToolBar.SEARCH_BUTTON=2;
ZmSearchToolBar.SAVE_BUTTON=3;
ZmSearchToolBar.BROWSE_BUTTON=4;
ZmSearchToolBar.MENUITEM_ID="_menuItemId";
ZmSearchToolBar.SETTING={};
ZmSearchToolBar.MENU_ITEMS=[];
ZmSearchToolBar.MSG_KEY={};
ZmSearchToolBar.TT_MSG_KEY={};
ZmSearchToolBar.ICON={};
ZmSearchToolBar.SHARE_ICON={};
ZmSearchToolBar.ID={};
ZmSearchToolBar.addMenuItem=function(t,e){
if(e.msgKey){
ZmSearchToolBar.MSG_KEY[t]=e.msgKey
}
if(e.tooltipKey){
ZmSearchToolBar.TT_MSG_KEY[t]=e.tooltipKey
}
if(e.icon){
ZmSearchToolBar.ICON[t]=e.icon
}
if(e.shareIcon){
ZmSearchToolBar.SHARE_ICON[t]=e.shareIcon
}
if(e.setting){
ZmSearchToolBar.SETTING[t]=e.setting
}
if(e.id){
ZmSearchToolBar.ID[t]=e.id
}
if(e.index==null||e.index<0||e.index>=ZmSearchToolBar.MENU_ITEMS.length){
ZmSearchToolBar.MENU_ITEMS.push(t)
}else{
ZmSearchToolBar.MENU_ITEMS.splice(e.index,0,t)
}};
ZmSearchToolBar.prototype.toString=function(){
return"ZmSearchToolBar"
};
ZmSearchToolBar.prototype.removeMenuItem=function(a){
var e=0;
while(e<ZmSearchToolBar.MENU_ITEMS.length){
if(ZmSearchToolBar.MENU_ITEMS[e]==a){
break
}
e++
}
if(e<ZmSearchToolBar.MENU_ITEMS.length){
var t=this._searchMenuButton.getMenu();
t.removeChild(t.getItemById("_menuItemId",a));
ZmSearchToolBar.MENU_ITEMS.splice(e,1);
ZmSearchToolBar.MSG_KEY[a]="";
ZmSearchToolBar.TT_MSG_KEY[a]="";
ZmSearchToolBar.ICON[a]="";
ZmSearchToolBar.SHARE_ICON[a]="";
ZmSearchToolBar.SETTING[a]="";
ZmSearchToolBar.ID[a]=""
}
this.dedupSeparators(t)
};
ZmSearchToolBar.prototype.dedupSeparators=function(o){
if(o==null){
o=this._searchMenuButton.getMenu()
}
var e=o.getItems();
var a=false;
var t=[];
for(mi in e){
if(!e[mi].__text){
if(a==true||a==null){
t.push(e[mi])
}else{
a=true
}}else{
a=false
}}
for(mi in t){
o.removeChild(t[mi])
}
if(!e[e.length-1].__text){
o.removeChild(e[e.length-1])
}};
ZmSearchToolBar.prototype.getSearchField=function(){
return this._searchField.getInputElement()
};
ZmSearchToolBar.prototype.registerCallback=function(e,t){
this._callback=new AjxCallback(t,e)
};
ZmSearchToolBar.prototype.addSelectionListener=function(t,a){
var e;
switch(t){
case ZmSearchToolBar.SEARCH_MENU_BUTTON:e=this._searchMenuButton;
break;
case ZmSearchToolBar.SEARCH_BUTTON:e=this._searchButton;
break;
case ZmSearchToolBar.SAVE_BUTTON:e=this._saveButton;
break;
case ZmSearchToolBar.BROWSE_BUTTON:e=this._browseButton;
break
}
if(e){
e.addSelectionListener(a)
}};
ZmSearchToolBar.prototype.getButton=function(e){
switch(e){
case ZmSearchToolBar.SEARCH_MENU_BUTTON:return this._searchMenuButton;
case ZmSearchToolBar.SEARCH_BUTTON:return this._searchButton;
case ZmSearchToolBar.SAVE_BUTTON:return this._saveButton;
case ZmSearchToolBar.BROWSE_BUTTON:return this._browseButton
}
return null
};
ZmSearchToolBar.prototype.focus=function(){
if(this._searchField){
this._searchField.focus()
}};
ZmSearchToolBar.prototype.blur=function(){
if(this._searchField){
this._searchField.blur()
}};
ZmSearchToolBar.prototype.setEnabled=function(e){
if(this._searchField){
this._searchField.setEnabled(e)
}
if(this._searchMenuButton){
this._searchMenuButton.setEnabled(e)
}
if(this._searchButton){
this._searchButton.setEnabled(e)
}
if(this._saveButton){
this._saveButton.setEnabled(e)
}
if(this._browseButton){
this._browseButton.setEnabled(e)
}
if(this._customSearchBtn){
this._customSearchBtn.setEnabled(e)
}};
ZmSearchToolBar.prototype.setSearchFieldValue=function(e){
if(this._searchField&&e!=this.getSearchFieldValue()){
this._searchField.setValue(e)
}};
ZmSearchToolBar.prototype.getSearchFieldValue=function(){
return this._searchField?this._searchField.getValue():null
};
ZmSearchToolBar.prototype.createCustomSearchBtn=function(s,r,a,e){
if(!this._customSearchListener){
this._customSearchListener=new AjxListener(this,this._customSearchBtnListener)
}
var l=document.getElementById(this._htmlElId+"_customSearchButton");
if(l){
if(!this._customSearchBtn){
this._customSearchBtn=this._addButton({
tdId:"_customSearchButton",buttonId:ZmId.getButtonId(ZmId.SEARCH,ZmId.SEARCH_CUSTOM),lbl:r,icon:s}
);
this._customSearchBtn.setData("CustomSearchItem",[s,r,a]);
this._customSearchBtn.addSelectionListener(this._customSearchListener);
var c=document.getElementById(this._htmlElId+"_customSearchButtonSep");
if(c){
Dwt.setVisible(c,true)
}}else{
var t=this._customSearchBtn.getMenu();
var h;
var o={
parent:t,enabled:true,style:DwtMenuItem.RADIO_STYLE,radioGroupId:0,id:e};
if(!t){
var n=this._customSearchBtn.getData("CustomSearchItem");
t=new DwtMenu({
parent:this._customSearchBtn,className:"ActionMenu",id:ZmId.getMenuId(ZmId.SEARCH,ZmId.SEARCH_CUSTOM)}
);
this._customSearchBtn.setMenu(t,false,DwtMenuItem.RADIO_STYLE);
o.imageInfo=n[0];
o.text=n[1];
h=DwtMenuItem.create(o);
h.setData("CustomSearchItem",n);
h.setData(ZmSearchToolBar.MENUITEM_ID,ZmId.SEARCH_CUSTOM);
h.setChecked(true,true);
h.addSelectionListener(this._customSearchListener)
}
o.imageInfo=s;
o.text=r;
h=DwtMenuItem.create(o);
h.setData("CustomSearchItem",[s,r,a]);
h.addSelectionListener(this._customSearchListener)
}}else{
if(this._searchMenuCreated){
var t=this._searchMenuButton.getMenu();
this._createCustomSearchMenuItem(t,s,r,a,e)
}else{
if(!this._customSearchMenuItems){
this._customSearchMenuItems=[]
}
this._customSearchMenuItems.push({
icon:s,text:r,listener:a,id:e}
)
}}};
ZmSearchToolBar.prototype._createCustomSearchMenuItem=function(s,t,n,a,r){
var e=s.getItem(0);
var o={
parent:s,imageInfo:t,text:n,enabled:true,style:DwtMenuItem.RADIO_STYLE,radioGroupId:0,index:0,id:r};
e=DwtMenuItem.create(o);
e.setData("CustomSearchItem",[t,n,a]);
e.setData(ZmSearchToolBar.MENUITEM_ID,ZmId.SEARCH_CUSTOM);
e.addSelectionListener(this._customSearchListener);
if(!(e&&e.getData("CustomSearchItem"))){
e=new DwtMenuItem({
parent:s,style:DwtMenuItem.SEPARATOR_STYLE,index:1}
)
}};
ZmSearchToolBar.prototype._customSearchBtnListener=function(a){
var t=a.item;
if(!t){
return
}
var o=t.getData("CustomSearchItem");
if(this._customSearchBtn){
if(t instanceof DwtMenuItem){
if(a.detail!=DwtMenuItem.CHECKED){
return
}
this._customSearchBtn.setToolTipContent(o[1]);
this._customSearchBtn.setData("CustomSearchItem",o)
}
o[2].run(a)
}else{
this._searchMenuButton.setToolTipContent(o[1]);
var n=t.parent;
var e=n?n.getItemById(ZmSearchToolBar.MENUITEM_ID,ZmId.SEARCH_SHARED):null;
if(e){
e.setChecked(false,true);
e.setEnabled(false)
}
this._searchMenuButton.setImage(o[0]);
this._searchMenuButton.setText(o[1])
}};
ZmSearchToolBar.prototype._createHtml=function(){
this.getHtmlElement().innerHTML=AjxTemplate.expand("share.Widgets#ZmSearchToolBar",{
id:this._htmlElId}
);
var n=this._htmlElId+"_inputField";
var t=document.getElementById(n);
if(t){
this._searchField=new DwtInputField({
parent:this,hint:ZmMsg.searchInput,inputId:ZmId.SEARCH_INPUT}
);
var o=this._searchField.getInputElement();
o.className="search_input";
this._searchField.reparentHtmlElement(n)
}
var r=this._htmlElId+"_searchMenuButton";
var a=document.getElementById(r);
if(a){
var e=appCtxt.get(ZmSetting.MAIL_ENABLED);
this._searchMenuButton=this._addButton({
tdId:"_searchMenuButton",buttonId:ZmId.getButtonId(ZmId.SEARCH,ZmId.SEARCH_MENU),lbl:e?ZmMsg.searchMail:ZmMsg.searchAll,icon:e?"Message":"Globe"}
);
var s=new AjxCallback(this,this._createSearchMenu);
this._searchMenuButton.setMenu(s,false,DwtMenuItem.RADIO_STYLE);
this._searchMenuButton.reparentHtmlElement(r)
}
this._searchButton=this._addButton({
tdId:"_searchButton",buttonId:ZmId.getButtonId(ZmId.SEARCH,ZmId.SEARCH_SEARCH),lbl:ZmMsg.search,icon:"Search",tooltip:ZmMsg.searchTooltip}
);
this._saveButton=this._addButton({
setting:ZmSetting.SAVED_SEARCHES_ENABLED,tdId:"_saveButton",buttonId:ZmId.getButtonId(ZmId.SEARCH,ZmId.SEARCH_SAVE),lbl:ZmMsg.save,icon:"Save",type:"toolbar",tooltip:ZmMsg.saveSearchTooltip}
);
this._browseButton=this._addButton({
setting:ZmSetting.BROWSE_ENABLED,tdId:"_advancedButton",buttonId:ZmId.getButtonId(ZmId.SEARCH,ZmId.SEARCH_ADVANCED),style:(DwtLabel.IMAGE_LEFT|DwtLabel.ALIGN_CENTER|DwtButton.TOGGLE_STYLE),lbl:ZmMsg.searchBuilder,icon:"SearchBuilder",type:"toolbar",tooltip:ZmMsg.openSearchBuilder}
)
};
ZmSearchToolBar.prototype._createSearchMenu=function(){
var s=new DwtMenu({
parent:this._searchMenuButton,className:"ActionMenu",id:ZmId.getMenuId(ZmId.SEARCH)}
);
var e;
if(this._customSearchMenuItems){
for(var a=0;
a<this._customSearchMenuItems.length;
a++){
var t=this._customSearchMenuItems[a];
this._createCustomSearchMenuItem(s,t.icon,t.text,t.listener)
}}
var n={
parent:s,enabled:true,radioGroupId:0};
for(var a=0;
a<ZmSearchToolBar.MENU_ITEMS.length;
a++){
var r=ZmSearchToolBar.MENU_ITEMS[a];
if(r==ZmId.SEARCH_SHARED){
if(ZmSearchToolBar.MENU_ITEMS.length<=1){
continue
}
e=new DwtMenuItem({
parent:s,style:DwtMenuItem.SEPARATOR_STYLE}
)
}
var o=ZmSearchToolBar.SETTING[r];
if(o&&!appCtxt.get(o)){
continue
}
n.style=(r==ZmId.SEARCH_SHARED||r==ZmId.SEARCH_ALL_ACCOUNTS)?DwtMenuItem.CHECK_STYLE:DwtMenuItem.RADIO_STYLE;
n.imageInfo=ZmSearchToolBar.ICON[r];
n.text=ZmMsg[ZmSearchToolBar.MSG_KEY[r]];
n.id=ZmSearchToolBar.ID[r];
e=DwtMenuItem.create(n);
e.setData(ZmSearchToolBar.MENUITEM_ID,r);
if(r==ZmId.SEARCH_ANY){
if(ZmSearchToolBar.MENU_ITEMS.length<=1){
continue
}
e=new DwtMenuItem({
parent:s,style:DwtMenuItem.SEPARATOR_STYLE}
)
}}
appCtxt.getSearchController()._addMenuListeners(s);
this._searchMenuCreated=true;
return s
};
ZmSearchToolBar.prototype._addButton=function(n){
if(n.setting&&!appCtxt.get(n.setting)){
return
}
var a;
var t=this._htmlElId+(n.tdId||n.buttonId);
var e=document.getElementById(t);
if(e){
var s={
parent:this,style:n.style,id:n.buttonId};
a=(n.type&&n.type=="toolbar")?(new DwtToolBarButton(s)):(new DwtButton(s));
var o=Dwt.getAttr(e,"hint");
this._setButtonStyle(a,o,n.lbl,n.icon);
if(n.tooltip){
a.setToolTipContent(n.tooltip)
}
a.reparentHtmlElement(t)
}
return a
};
ZmSearchToolBar.prototype._setButtonStyle=function(e,o,a,t){
if(o=="text"){
e.setText(a)
}else{
if(o=="icon"){
e.setImage(t)
}else{
e.setText(a);
e.setImage(t)
}}};
ZmSearchToolBar.prototype._handleEnterKeyPress=function(e){
var a=this._searchMenuButton.getMenu();
var t=a.getSelectedItem().getData("CustomSearchItem");
if(t){
t[2].run(e)
}else{
var o=this.getSearchFieldValue();
appCtxt.notifyZimlets("onKeyPressSearchField",[o]);
this._callback.run(o)
}
return false
};
ZmSearchToolBar.prototype.initAutocomplete=function(t){
var e={
dataClass:new ZmSearchAutocomplete(),matchValue:"matchText",delims:[" "],separator:" ",enterCallback:new AjxCallback(this,this._handleEnterKeyPress)};
this._acList=new ZmAutocompleteListView(e);
this._acList.handle(this.getSearchField())
}
}
if(AjxPackage.define("zimbraMail.share.view.ZmTreeView")){
ZmTreeView=function(e){
if(arguments.length==0){
return
}
DwtTree.call(this,{
parent:e.parent,parentElement:e.parentElement,style:e.treeStyle,isCheckedByDefault:e.isCheckedByDefault,className:(e.className||"OverviewTree"),posStyle:e.posStyle,id:e.id}
);
this._headerClass=e.headerClass?e.headerClass:"overviewHeader";
this.overviewId=e.overviewId;
this.type=e.type;
this.allowedTypes=e.allowedTypes;
this.allowedSubTypes=e.allowedSubTypes;
this._overview=appCtxt.getOverviewController().getOverview(this.overviewId);
this._dragSrc=e.dragSrc;
this._dropTgt=e.dropTgt;
this._dataTree=null;
this._treeItemHash={}
};
ZmTreeView.KEY_TYPE="_type_";
ZmTreeView.KEY_ID="_treeId_";
ZmTreeView.COMPARE_FUNC={};
ZmTreeView.ADD_SEP={};
ZmTreeView.ADD_SEP[ZmFolder.ID_TRASH]=true;
ZmTreeView.MAX_ITEMS=50;
ZmTreeView.getSortIndex=function(s,t,e){
if(!e){
return null
}
var n=s.getItemCount();
var o=s.getItems();
for(var a=0;
a<o.length;
a++){
if(o[a]._isSeparator){
continue
}
var h=o[a].getData(Dwt.KEY_OBJECT);
if(!h){
continue
}
var r=e(t,h);
if(r==-1){
return a
}}
return a
};
ZmTreeView.prototype=new DwtTree;
ZmTreeView.prototype.constructor=ZmTreeView;
ZmTreeView.prototype.toString=function(){
return"ZmTreeView"
};
ZmTreeView.prototype.set=function(s){
this._showUnread=s.showUnread;
this._dataTree=s.dataTree;
this.clear();
var t=this._dataTree.root;
var n=(appCtxt.multiAccounts&&(this.type==ZmOrganizer.SEARCH||this.type==ZmOrganizer.TAG));
var e=this._getHeaderTreeItemImage();
var o=this._headerItem=new DwtHeaderTreeItem({
parent:this,className:n?"DwtTreeItem":this._headerClass,imageInfo:e,id:ZmId.getTreeItemId(this.overviewId,null,this.type),button:n?null:s.newButton,dndScrollCallback:this._overview._dndScrollCallback,dndScrollId:this.overviewId,selectable:appCtxt.multiAccounts}
);
o._isHeader=true;
var a=ZmMsg[ZmOrganizer.LABEL[this.type]];
if(a){
o.setText(a)
}
o.setData(Dwt.KEY_ID,t.id);
o.setData(Dwt.KEY_OBJECT,t);
o.setData(ZmTreeView.KEY_ID,this.overviewId);
o.setData(ZmTreeView.KEY_TYPE,this.type);
if(this._dropTgt){
o.setDropTarget(this._dropTgt)
}
this._treeItemHash[t.id]=o;
s.treeNode=o;
s.organizer=t;
this._render(s);
o.setExpanded(!s.collapsed,null,true);
if(!appCtxt.multiAccounts){
this.addSeparator()
}
if(appCtxt.getSkinHint("noOverviewHeaders")||this._hideHeaderTreeItem()){
o.setVisible(false,true)
}};
ZmTreeView.prototype.getTreeItemById=function(e){
return this._treeItemHash[e]
};
ZmTreeView.prototype.getHeaderItem=function(){
return this._headerItem
};
ZmTreeView.prototype.getSelected=function(){
if(this.isCheckedStyle){
var e=[];
var t=this.getHeaderItem();
this._getCheckedItems(t,e);
return e
}else{
return(this.getSelectionCount()!=1)?null:this.getSelection()[0].getData(Dwt.KEY_OBJECT)
}};
ZmTreeView.prototype.setSelected=function(e,t,o){
var a=ZmOrganizer.getSystemId((e instanceof ZmOrganizer)?e.id:e);
if(!a||!this._treeItemHash[a]){
return
}
this.setSelection(this._treeItemHash[a],t,false,o)
};
ZmTreeView.prototype._render=function(params){
var org=params.organizer;
var children=org.children.getArray();
if(org.isDataSource(ZmAccount.TYPE_IMAP)){
children.sort(ZmImapAccount.sortCompare)
}else{
if(ZmTreeView.COMPARE_FUNC[this.type]){
if(appCtxt.isOffline&&this.type==ZmOrganizer.SEARCH){
var local=[];
var global=[];
for(var j=0;
j<children.length;
j++){
var child=children[j];
if(child&&child.type==ZmOrganizer.SEARCH){
if(child.isOfflineGlobalSearch){
global.push(child)
}else{
local.push(child)
}}}
local.sort(eval(ZmTreeView.COMPARE_FUNC[this.type]));
global.sort(eval(ZmTreeView.COMPARE_FUNC[this.type]));
children=(new Array()).concat(local,global)
}else{
children.sort(eval(ZmTreeView.COMPARE_FUNC[this.type]))
}}}
var addSep=true;
var numItems=0;
var len=children.length;
for(var i=params.startPos||0;
i<len;
i++){
var child=children[i];
if(!child||(params.omit&&params.omit[child.nId])){
continue
}
if(!(params.include&&params.include[child.nId])){
var allowed=((org.nId==ZmOrganizer.ID_ROOT)&&this.allowedTypes[child.type])||((org.nId!=ZmOrganizer.ID_ROOT)&&this.allowedSubTypes[child.type]);
if(!allowed){
if(params.omitParents){
continue
}
var proxy=AjxUtil.createProxy(params);
proxy.treeNode=null;
proxy.organizer=child;
this._render(proxy);
continue
}
if(this._allowedTypes&&!this._allowedTypes[child.type]){
if(params.omitParents){
continue
}
var proxy=AjxUtil.createProxy(params);
proxy.treeNode=null;
proxy.organizer=child;
this._render(proxy);
continue
}}
if((child.numTotal==0&&(child.nId==ZmFolder.ID_SYNC_FAILURES))||(appCtxt.isOffline&&child.nId==ZmOrganizer.ID_GLOBAL_INBOX)){
continue
}
if(numItems>=ZmTreeView.MAX_ITEMS){
if(params.startPos){
params.startPos=i;
params.len=(params.startPos+ZmTreeView.MAX_ITEMS>=len)?len:0;
this._showRemainingFolders(params);
return
}else{
if(numItems>=ZmTreeView.MAX_ITEMS*2){
var orgs=ZmMsg[ZmOrganizer.LABEL[this.type]].toLowerCase();
child=new ZmFolder({
id:ZmFolder.ID_LOAD_FOLDERS,name:AjxMessageFormat.format(ZmMsg.showRemainingFolders,orgs)}
);
child._tooltip=AjxMessageFormat.format(ZmMsg.showRemainingFoldersTooltip,[(children.length-i),orgs]);
var ti=this._addNew(params.treeNode,child);
ti.enableSelection(true);
if(this.isCheckedStyle){
ti.showCheckBox(false)
}
params.startPos=i;
child._showFoldersCallback=new AjxCallback(this,this._showRemainingFolders,[params]);
return
}}}
if((org.nId==ZmOrganizer.ID_ROOT)&&child.link&&addSep){
params.treeNode.addSeparator();
addSep=false
}
this._addNew(params.treeNode,child,null,params.noTooltips,params.omit);
numItems++
}};
ZmTreeView.prototype._addNew=function(r,u,h,c,a){
var t;
var e=(u.type==ZmOrganizer.FOLDER)&&appCtxt.getDataSourceCollection();
var d=e&&e.getByFolderId(u.nId);
var o=(d&&d.length>0)?d[0]:null;
if(o&&o.type==ZmAccount.TYPE_IMAP){
t=new DwtTreeItem({
parent:this,text:u.getName(),className:this._headerClass}
);
t.enableSelection(false)
}else{
if(!r){
var l=[];
var s=u.parent;
while((r=this.getTreeItemById(s.id))==null){
l.push(s);
s=s.parent
}
while(s=l.pop()){
r=this.getTreeItemById(s.parent.id);
r=new DwtTreeItem({
parent:r,text:s.getName(),imageInfo:s.getIconWithColor(),forceNotifySelection:true,dndScrollCallback:this._overview._dndScrollCallback,dndScrollId:this.overviewId,id:ZmId.getTreeItemId(this.overviewId,s.id)}
);
r.setData(Dwt.KEY_ID,s.id);
r.setData(Dwt.KEY_OBJECT,s);
r.setData(ZmTreeView.KEY_ID,this.overviewId);
r.setData(ZmTreeView.KEY_TYPE,s.type);
this._treeItemHash[s.id]=r
}}
var n={
parent:r,index:h,text:u.getName(this._showUnread),dndScrollCallback:this._overview._dndScrollCallback,dndScrollId:this.overviewId,imageInfo:u.getIconWithColor(),id:ZmId.getTreeItemId(this.overviewId,u.id)};
t=new DwtTreeItem(n)
}
if(appCtxt.multiAccounts&&(u.type==ZmOrganizer.SEARCH||u.type==ZmOrganizer.TAG)){
t.addClassName("DwtTreeItemChildDiv")
}
t.setDndText(u.getName());
t.setData(Dwt.KEY_ID,u.id);
t.setData(Dwt.KEY_OBJECT,u);
t.setData(ZmTreeView.KEY_ID,this.overviewId);
t.setData(ZmTreeView.KEY_TYPE,u.type);
if(!c){
var m=u.getToolTip();
if(m){
t.setToolTipContent(m)
}}
if(this._dragSrc){
t.setDragSource(this._dragSrc)
}
if(this._dropTgt){
t.setDropTarget(this._dropTgt)
}
this._treeItemHash[u.id]=t;
if(ZmTreeView.ADD_SEP[u.nId]){
r.addSeparator()
}
if(u.children&&u.children.size()){
this._render({
treeNode:t,organizer:u,omit:a}
)
}
if(o&&o.type==ZmAccount.TYPE_IMAP){
t.setExpanded(!appCtxt.get(ZmSetting.COLLAPSE_IMAP_TREES))
}
return t
};
ZmTreeView.prototype.getNextData=function(t){
var r=this.getTreeItemById(t);
if(!r||!r.parent){
return null
}
while(r&&r.parent){
var o=r.parent;
if(!(o instanceof DwtTreeItem)){
return null
}
var e=o.getItems();
var l=null;
if(e&&e.length>1){
for(var n=0;
n<e.length;
n++){
var s=e[n];
if(s==r){
var h=this.findNext(r,e,n);
if(h){
return h
}
var a=this.findPrev(r,e,n);
if(a){
return a
}}}}
r=r.parent
}
return null
};
ZmTreeView.prototype.findNext=function(n,o,t){
for(var e=t+1;
e<o.length;
e++){
var a=o[e];
if(a&&a.getData){
return a.getData(Dwt.KEY_OBJECT)
}}
return null
};
ZmTreeView.prototype.findPrev=function(n,o,t){
for(var e=t-1;
e>=0;
e--){
var a=o[e];
if(a&&a.getData){
return a.getData(Dwt.KEY_OBJECT)
}}
return null
};
ZmTreeView.prototype._showRemainingFolders=function(t){
var e=this.getTreeItemById(ZmFolder.ID_LOAD_FOLDERS);
if(e){
e.dispose()
}
AjxTimedAction.scheduleAction(new AjxTimedAction(this,function(){
this._render(t);
if(t.len){
var a=ZmMsg[ZmOrganizer.LABEL[this.type]].toLowerCase();
appCtxt.setStatusMsg(AjxMessageFormat.format(ZmMsg.foldersShown,[t.len,a]));
t.len=0
}}
),100)
};
ZmTreeView.prototype._getNextTreeItem=function(t){
var e=DwtTree.prototype._getNextTreeItem.apply(this,arguments);
return e||this._overview._getNextTreeItem(t,this)
};
ZmTreeView.prototype._hideHeaderTreeItem=function(){
return(appCtxt.multiAccounts&&(this.type==ZmOrganizer.FOLDER||this.type==ZmOrganizer.ADDRBOOK||this.type==ZmOrganizer.CALENDAR||this.type==ZmOrganizer.TASKS||this.type==ZmOrganizer.NOTEBOOK||this.type==ZmOrganizer.BRIEFCASE||this.type==ZmOrganizer.PREF_PAGE||this.type==ZmOrganizer.ZIMLET))
};
ZmTreeView.prototype._getHeaderTreeItemImage=function(){
if(appCtxt.multiAccounts){
if(this.type==ZmOrganizer.SEARCH){
return"SearchFolder"
}
if(this.type==ZmOrganizer.TAG){
return"TagStack"
}}
return null
};
ZmTreeView.prototype._getCheckedItems=function(o,a){
if(o&&(o instanceof DwtTreeItem)){
if(o.getChecked()){
a.push(o.getData(Dwt.KEY_OBJECT))
}
var e=o.getItems();
for(var t=0;
t<e.length;
t++){
this._getCheckedItems(e[t],a)
}}}
}
if(AjxPackage.define("zimbraMail.share.view.ZmTagMenu")){
ZmTagMenu=function(t,e){
ZmPopupMenu.call(this,t,null,t.getHTMLElId()+"|MENU",e);
t.setMenu(this);
this._addHash={};
this._removeHash={};
this._evtMgr=new AjxEventMgr();
this._desiredState=true;
this._items=null;
this._dirty=true;
if(t instanceof DwtMenuItem){
t.setHoverDelay(ZmTagMenu._HOVER_TIME)
}};
ZmTagMenu.prototype=new ZmPopupMenu;
ZmTagMenu.prototype.constructor=ZmTagMenu;
ZmTagMenu.KEY_TAG_EVENT="_tagEvent_";
ZmTagMenu.KEY_TAG_ADDED="_tagAdded_";
ZmTagMenu.MENU_ITEM_ADD_ID="tag_add";
ZmTagMenu.MENU_ITEM_REM_ID="tag_remove";
ZmTagMenu._HOVER_TIME=200;
ZmTagMenu.prototype.toString=function(){
return"ZmTagMenu"
};
ZmTagMenu.prototype.addSelectionListener=function(e){
this._evtMgr.addListener(DwtEvent.SELECTION,e)
};
ZmTagMenu.prototype.removeSelectionListener=function(e){
this._evtMgr.removeListener(DwtEvent.SELECTION,e)
};
ZmTagMenu.prototype.setEnabled=function(e){
this._desiredState=e;
if(e&&!this._tagList){
return
}
this.parent.setEnabled(e)
};
ZmTagMenu.prototype.set=function(e,t){
this._tagList=t;
this._items=e;
this._dirty=true;
this.parent.setEnabled(true);
if(this.parent instanceof DwtMenuItem){
this.parent.setHoverDelay(ZmTagMenu._HOVER_TIME)
}};
ZmTagMenu.prototype._doPopup=function(t,n,a){
if(this._dirty){
this.removeChildren();
if(this._tagList){
var o=this._tagList.root;
var e=this._getAddRemove(this._items,o);
this._render(o,e)
}
this._dirty=false;
if(this.parent instanceof DwtMenuItem){
this.parent.setHoverDelay(0)
}}
ZmPopupMenu.prototype._doPopup.call(this,t,n,a)
};
ZmTagMenu.prototype._getAddRemove=function(s,h){
var r={};
for(var n=0;
n<s.length;
n++){
var d=s[n];
if(!d){
continue
}
if(d.tags&&d.tags.length){
for(var t=0;
t<d.tags.length;
t++){
var e=d.tags[t];
r[e]=r[e]?r[e]+1:1
}}}
var c={};
var o={};
var l=h.children.getArray();
for(var n=0;
n<l.length;
n++){
var e=l[n].nId;
if(!r[e]||(r[e]<s.length)){
c[e]=true
}}
for(var e in r){
o[e]=true
}
return{
add:c,remove:o}
};
ZmTagMenu.prototype._render=function(h,l){
var r=h.size();
var d=h.children.getArray();
var s=[];
for(var o=0;
o<r;
o++){
var m=d[o];
var t=m.nId;
if(l.add[t]){
this._addNewTag(this,m,true,null,this._addHash)
}
if(l.remove[t]){
s.push(t)
}}
if(this._tagList.size()){
new DwtMenuItem({
parent:this,style:DwtMenuItem.SEPARATOR_STYLE}
)
}
var c=this._menuItems[ZmTagMenu.MENU_ITEM_ADD_ID]=new DwtMenuItem({
parent:this,id:this._htmlElId+"|NEWTAG"}
);
c.setText(AjxStringUtil.htmlEncode(ZmMsg.newTag));
c.setImage("NewTag");
c.setShortcut(appCtxt.getShortcutHint(this._keyMap,ZmKeyMap.NEW_TAG));
c.setData(ZmTagMenu.KEY_TAG_EVENT,ZmEvent.E_CREATE);
c.addSelectionListener(new AjxListener(this,this._menuItemSelectionListener),0);
var u=this._menuItems[ZmTagMenu.MENU_ITEM_REM_ID]=new DwtMenuItem({
parent:this,id:this._htmlElId+"|REMOVETAG"}
);
u.setEnabled(false);
u.setText(AjxStringUtil.htmlEncode(ZmMsg.removeTag));
u.setImage("DeleteTag");
if(s.length>0){
u.setEnabled(true);
var e=null;
if(s.length>1){
for(o=0;
o<s.length;
o++){
if(!e){
e=new DwtMenu({
parent:u,className:this._className}
);
u.setMenu(e)
}
var m=h.getById(s[o]);
this._addNewTag(e,m,false,null,this._removeHash)
}}else{
if(s.length==1){
var m=h.getById(s[0]);
u.setData(ZmTagMenu.KEY_TAG_EVENT,ZmEvent.E_TAGS);
u.setData(ZmTagMenu.KEY_TAG_ADDED,false);
u.setData(Dwt.KEY_OBJECT,m);
u.addSelectionListener(new AjxListener(this,this._menuItemSelectionListener),0)
}}
if(s.length>1){
new DwtMenuItem({
parent:e,style:DwtMenuItem.SEPARATOR_STYLE}
);
var n=new DwtMenuItem({
parent:e}
);
n.setText(ZmMsg.allTags);
n.setImage("TagStack");
n.setShortcut(appCtxt.getShortcutHint(this._keyMap,ZmKeyMap.UNTAG));
n.setData(ZmTagMenu.KEY_TAG_EVENT,ZmEvent.E_REMOVE_ALL);
n.setData(Dwt.KEY_OBJECT,s);
n.addSelectionListener(new AjxListener(this,this._menuItemSelectionListener),0)
}}};
ZmTagMenu.tagNameLength=20;
ZmTagMenu.prototype._addNewTag=function(r,o,n,t,s){
var e=new DwtMenuItem({
parent:r,index:t}
);
var a=AjxStringUtil.clipByLength(o.getName(false),ZmTagMenu.tagNameLength);
e.setText(a);
e.setImage(ZmTag.COLOR_ICON[o.color]);
e.setData(ZmTagMenu.KEY_TAG_EVENT,ZmEvent.E_TAGS);
e.setData(ZmTagMenu.KEY_TAG_ADDED,n);
e.setData(Dwt.KEY_OBJECT,o);
e.addSelectionListener(new AjxListener(this,this._menuItemSelectionListener),0);
e.setShortcut(appCtxt.getShortcutHint(null,ZmKeyMap.TAG));
s[o.id]=e
};
ZmTagMenu.prototype._menuItemSelectionListener=function(e){
if(e.item.getData(ZmTagMenu.KEY_TAG_EVENT)){
this._evtMgr.notifyListeners(DwtEvent.SELECTION,e.item)
}}
}
if(AjxPackage.define("zimbraMail.share.view.ZmListView")){
ZmListView=function(o){
if(arguments.length==0){
return
}
o.id=o.id||ZmId.getViewId(o.view);
DwtListView.call(this,o);
this.view=o.view;
this.type=o.type;
this._controller=o.controller;
this.setDropTarget(o.dropTgt);
this._listChangeListener=new AjxListener(this,this._changeListener);
this._tagListChangeListener=new AjxListener(this,this._tagChangeListener);
var a=appCtxt.getTagTree();
if(a){
a.addChangeListener(this._tagListChangeListener)
}
var t=appCtxt.getFolderTree();
if(t){
t.addChangeListener(new AjxListener(this,this._folderChangeListener))
}
this._handleEventType={};
this._handleEventType[this.type]=true;
this._disallowSelection={};
this._disallowSelection[ZmItem.F_FLAG]=true;
this._selectAllEnabled=false;
if(o.dropTgt){
var e={
container:this._parentEl,threshold:15,amount:5,interval:10,id:o.id};
this._dndScrollCallback=new AjxCallback(null,DwtControl._dndScrollCallback,[e]);
this._dndScrollId=o.id
}
this._isPageless=o.pageless;
if(this._isPageless){
Dwt.setHandler(this._parentEl,DwtEvent.ONSCROLL,ZmListView.handleScroll)
}};
ZmListView.prototype=new DwtListView;
ZmListView.prototype.constructor=ZmListView;
ZmListView.prototype.toString=function(){
return"ZmListView"
};
ZmListView.KEY_ID="_keyId";
ZmListView.COL_WIDTH_ICON=19;
ZmListView.COL_WIDTH_NARROW_ICON=11;
ZmListView.FIELD_CLASS={};
ZmListView.FIELD_CLASS[ZmItem.F_TYPE]="Icon";
ZmListView.FIELD_CLASS[ZmItem.F_FLAG]="Flag";
ZmListView.FIELD_CLASS[ZmItem.F_TAG]="Tag";
ZmListView.FIELD_CLASS[ZmItem.F_ATTACHMENT]="Attach";
ZmListView.ITEM_FLAG_CLICKED=DwtListView._LAST_REASON+1;
ZmListView.DEFAULT_REPLENISH_THRESHOLD=0;
ZmListView.COL_JOIN="|";
ZmListView.prototype._getHeaderList=function(){};
ZmListView.prototype.getController=function(){
return this._controller
};
ZmListView.prototype.set=function(o,a){
this.setSelectionHdrCbox(false);
if(appCtxt.multiAccounts){
var n=appCtxt.getTagTree();
if(n){
n.addChangeListener(this._tagListChangeListener)
}}
if(this._isPageless){
if(this._itemsToAdd){
this.addItems(this._itemsToAdd);
this._itemsToAdd=null
}else{
var t=o;
if(o instanceof ZmList){
o.addChangeListener(this._listChangeListener);
t=o.getSubList(0,o.size())
}
DwtListView.prototype.set.call(this,t,a)
}
this._setRowHeight(o)
}else{
var e;
if(o instanceof ZmList){
o.addChangeListener(this._listChangeListener);
e=o.getSubList(this.offset,this.getLimit())
}else{
e=o
}
DwtListView.prototype.set.call(this,e,a)
}
this._rendered=true
};
ZmListView.prototype._setRowHeight=function(){
if(!this._rowHeight){
var e=this._parentEl.firstChild;
this._rowHeight=e&&Dwt.getSize(e).y
}};
ZmListView.prototype.reset=function(){
this._rendered=false
};
ZmListView.prototype.setUI=function(e){
DwtListView.prototype.setUI.call(this,e);
this._resetColWidth()
};
ZmListView.prototype.getLimit=function(t){
if(this._isPageless){
var e=appCtxt.get(ZmSetting.PAGE_SIZE);
return t?e:2*e
}else{
return appCtxt.get(ZmSetting.PAGE_SIZE)
}};
ZmListView.prototype.getPagelessThreshold=function(){
return Math.ceil(this.getLimit()/5)
};
ZmListView.prototype.getReplenishThreshold=function(){
return ZmListView.DEFAULT_REPLENISH_THRESHOLD
};
ZmListView.prototype._changeListener=function(s){
var n=this._getItemFromEvent(s);
if(!n||s.handled||!this._handleEventType[n.type]&&(this.type!=ZmItem.MIXED)){
return
}
if(s.event==ZmEvent.E_TAGS||s.event==ZmEvent.E_REMOVE_ALL){
this._setImage(n,ZmItem.F_TAG,n.getTagImageInfo())
}
if(s.event==ZmEvent.E_FLAGS){
var a=s.getDetail("flags");
for(var o=0;
o<a.length;
o++){
var t=a[o];
var e=n[ZmItem.FLAG_PROP[t]];
if(t==ZmItem.FLAG_FLAGGED){
this._setImage(n,ZmItem.F_FLAG,e?"FlagRed":null)
}else{
if(t==ZmItem.FLAG_ATTACH){
this._setImage(n,ZmItem.F_ATTACHMENT,e?"Attachment":null)
}}}}
if(s.event==ZmEvent.E_DELETE||s.event==ZmEvent.E_MOVE){
this.removeItem(n,true);
if(s.event!=ZmEvent.E_MOVE||!this._controller._list.isCanonical){
this._controller._list.remove(n)
}
if(!this.allSelected){
if(!this._isPageless){
this._controller._app._checkReplenishListView=this
}else{
this._handleResponseCheckReplenish()
}}
this._controller._resetToolbarOperations()
}};
ZmListView.prototype._getItemFromEvent=function(a){
var t=a.item;
if(!t){
var e=a.getDetail("items");
t=(e&&e.length)?e[0]:null
}
return t
};
ZmListView.prototype._checkReplenish=function(){
var e=new AjxCallback(this,this._handleResponseCheckReplenish);
this._controller._checkReplenish(e)
};
ZmListView.prototype._handleResponseCheckReplenish=function(){
if(this.size()==0){
this._controller._handleEmptyList(this)
}else{
this._controller._resetNavToolBarButtons(this._controller._getViewType())
}
this._setNextSelection()
};
ZmListView.prototype._folderChangeListener=function(o){
if(appCtxt.getCurrentController()!=this._controller){
return
}
if(this._controller._app._checkReplenishListView==this){
return
}
var a=o.getDetail("organizers");
var t=(a&&a.length)?a[0]:o.source;
var n=t.id;
var e=o.getDetail("fields");
if(o.event==ZmEvent.E_MODIFY){
if(!e){
return
}
if(e[ZmOrganizer.F_TOTAL]){
this._controller._resetNavToolBarButtons(this._controller._getViewType())
}}};
ZmListView.prototype._tagChangeListener=function(r){
if(r.type!=ZmEvent.S_TAG){
return
}
var t=r.getDetail("fields");
if(r.event==ZmEvent.E_MODIFY&&(t&&t[ZmOrganizer.F_COLOR])){
var n=this._getChildren();
var e=r.getDetail("organizers")[0];
for(var o=0;
o<n.length;
o++){
var s=this.getItemFromElement(n[o]);
if(s&&s.tags&&(s.tags.length==1)&&(s.tags[0]==e.id)){
this._setImage(s,ZmItem.F_TAG,s.getTagImageInfo())
}}}else{
if(r.event==ZmEvent.E_DELETE){
var n=this._getChildren();
var e=r.getDetail("organizers")[0];
for(var o=0;
o<n.length;
o++){
var s=this.getItemFromElement(n[o]);
var a=ZmOrganizer.normalizeId(e.id);
if(s&&s.tags&&s.hasTag(a)){
s.tagLocal(a,false);
this._setImage(s,ZmItem.F_TAG,s.getTagImageInfo())
}}}}};
ZmListView.prototype._getChildren=function(){
return this._parentEl.childNodes
};
ZmListView.prototype._getRowId=function(e){
return DwtId.getListViewItemId(DwtId.WIDGET_ITEM_FIELD,this._view,e?e.id:Dwt.getNextId(),ZmItem.F_ITEM_ROW)
};
ZmListView.prototype._getCellId=function(e,t){
if(t==ZmItem.F_DATE){
return this._getFieldId(e,t)
}else{
if(t==ZmItem.F_SELECTION){
return this._getFieldId(e,ZmItem.F_SELECTION_CELL)
}else{
return DwtListView.prototype._getCellId.apply(this,arguments)
}}};
ZmListView.prototype._getCellClass=function(e,t,a){
return ZmListView.FIELD_CLASS[t]
};
ZmListView.prototype._getCellContents=function(t,e,a,o,r,s){
if(o==ZmItem.F_SELECTION){
e=this._getImageHtml(t,e,"CheckboxUnchecked",this._getFieldId(a,o))
}else{
if(o==ZmItem.F_TYPE){
e=this._getImageHtml(t,e,ZmItem.ICON[a.type],this._getFieldId(a,o))
}else{
if(o==ZmItem.F_FLAG){
e=this._getImageHtml(t,e,this._getFlagIcon(a.isFlagged),this._getFieldId(a,o))
}else{
if(o==ZmItem.F_TAG){
e=this._getImageHtml(t,e,a.getTagImageInfo(),this._getFieldId(a,o))
}else{
if(o==ZmItem.F_ATTACHMENT){
e=this._getImageHtml(t,e,a.hasAttach?"Attachment":null,this._getFieldId(a,o))
}else{
if(o==ZmItem.F_DATE){
t[e++]=AjxDateUtil.computeDateStr(s.now||new Date(),a.date)
}else{
if(o==ZmItem.F_PRIORITY){
var n=null;
if(a.isHighPriority){
n="PriorityHigh_list"
}else{
if(a.isLowPriority){
n="PriorityLow_list"
}else{
n="PriorityNormal_list"
}}
e=this._getImageHtml(t,e,n,this._getFieldId(a,o))
}else{
e=DwtListView.prototype._getCellContents.apply(this,arguments)
}}}}}}}
return e
};
ZmListView.prototype._getImageHtml=function(a,t,e,n){
e=e||"Blank_16";
var o=n?["id='",n,"'"].join(""):null;
a[t++]=AjxImg.getImageHtml(e,null,o);
return t
};
ZmListView.prototype._setImage=function(a,o,e){
var t=this._getElement(a,o);
if(t&&t.parentNode){
e=e||"Blank_16";
AjxImg.setImage(t.parentNode,e)
}};
ZmListView.prototype._getFragmentSpan=function(e){
return["<span class='ZmConvListFragment' id='",this._getFieldId(e,ZmItem.F_FRAGMENT),"'>",this._getFragmentHtml(e),"</span>"].join("")
};
ZmListView.prototype._getFragmentHtml=function(e){
return[" - ",AjxStringUtil.htmlEncode(e.fragment,true)].join("")
};
ZmListView.prototype._getFlagIcon=function(t,e){
return(t||e)?"FlagRed":"Blank_16"
};
ZmListView.prototype._parseId=function(t){
var e=t.split(DwtId.SEP);
if(e&&e.length){
return{
view:e[1],item:e[2],field:e[3],participant:e[4]}
}else{
return null
}};
ZmListView.prototype._mouseOutAction=function(n,h){
DwtListView.prototype._mouseOutAction.call(this,n,h);
var r=n.target.id||h.id;
if(!r){
return true
}
var s=this._data[h.id];
var t=s.type;
if(t&&t==DwtListView.TYPE_LIST_ITEM){
var e=this._parseId(r);
if(e&&e.field){
if(e.field==ZmItem.F_SELECTION){
var o=this._getItemData(h,"origSelClassName");
if(o){
n.target.className=o
}}else{
if(e.field==ZmItem.F_FLAG){
var a=this.getItemFromElement(h);
if(!a.isFlagged){
AjxImg.setImage(n.target,this._getFlagIcon(a.isFlagged,false),true)
}}}}}
return true
};
ZmListView.prototype._doubleClickAction=function(t,o){
var a=t.target.id?t.target.id:o.id;
if(!a){
return true
}
var e=this._parseId(a);
return(!(e&&(e.field==ZmItem.F_FLAG)))
};
ZmListView.prototype._itemClicked=function(n,r){
if(appCtxt.get(ZmSetting.SHOW_SELECTION_CHECKBOX)&&r.button==DwtMouseEvent.LEFT){
if(!r.shiftKey&&!r.ctrlKey){
var a=(r.target.id&&r.target.id.indexOf("AjxImg")==-1)?r.target.id:n.id;
var s=a?this._parseId(a):null;
if(s&&(s.field==ZmItem.F_SELECTION)||(s.field==ZmItem.F_SELECTION_CELL)){
if(this._selectedItems.size()==1){
var o=this._selectedItems.get(0);
var c=this.getItemFromElement(o);
var h=c?this._getFieldId(c,ZmItem.F_SELECTION):null;
var l=h?document.getElementById(h):null;
if(l&&o==n){
var e=this._getItemData(o,"origSelClassName");
if(e=="ImgCheckboxChecked"){
l.className="ImgCheckboxUnchecked";
this._setItemData(o,"origSelClassName","ImgCheckboxUnchecked")
}else{
if(e=="ImgCheckboxUnchecked"){
l.className="ImgCheckboxChecked";
this._setItemData(o,"origSelClassName","ImgCheckboxChecked");
return
}}}else{
if(l&&l.className=="ImgCheckboxUnchecked"){
DwtListView.prototype.deselectAll.call(this)
}}}
var t=this._selectedItems.contains(n);
this.setMultiSelection(n,t);
return
}}else{
if(r.shiftKey){
this._checkSelectedItems(false);
DwtListView.prototype._itemClicked.call(this,n,r);
this._checkSelectedItems(true);
return
}}}
DwtListView.prototype._itemClicked.call(this,n,r)
};
ZmListView.prototype._columnClicked=function(t,e){
DwtListView.prototype._columnClicked.call(this,t,e);
this._checkSelectionColumnClicked(t,e)
};
ZmListView.prototype._checkSelectionColumnClicked=function(r,n){
if(!appCtxt.get(ZmSetting.SHOW_SELECTION_CHECKBOX)){
return
}
var s=this.getList();
var a=s?s.size():null;
if(a>0){
var e=this._data[r.id].index;
var o=this._headerList[e];
if(o&&(o._field==ZmItem.F_SELECTION)){
var t=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_ICON,this._view,o._field);
var h=document.getElementById(t);
if(h){
this.allSelected=false;
if(h.className=="ImgCheckboxChecked"){
this.deselectAll();
h.className="ImgCheckboxUnchecked"
}else{
h.className="ImgCheckboxChecked";
this.selectAll(n.shiftKey)
}}}
this._controller._resetToolbarOperations()
}};
ZmListView.prototype.handleKeyAction=function(e,t){
var a=DwtListView.prototype.handleKeyAction.call(this,e,t);
if(e==DwtKeyMap.SELECT_ALL){
this._controller._resetToolbarOperations()
}
return a
};
ZmListView.prototype.setMultiSelection=function(e,a,t){
if(t&&t.ctrlKey&&this._selectedItems.size()==1){
this._checkSelectedItems(true)
}
DwtListView.prototype.setMultiSelection.call(this,e,a);
this.setSelectionCbox(e,a);
this.setSelectionHdrCbox(this.getSelection().length==this.getList().size());
this._controller._resetToolbarOperations()
};
ZmListView.prototype.setSelectionCbox=function(n,o){
if(!n){
return
}
var t=n.tagName?this.getItemFromElement(n):n;
var e=t?this._getFieldId(t,ZmItem.F_SELECTION):null;
var a=e?document.getElementById(e):null;
if(a){
a.className=o?"ImgCheckboxUnchecked":"ImgCheckboxChecked";
this._setItemData(n,"origSelClassName",a.className)
}};
ZmListView.prototype.setSelectionHdrCbox=function(t){
var a=this._headerHash?this._headerHash[ZmItem.F_SELECTION]:null;
var e=a?DwtId.getListViewHdrId(DwtId.WIDGET_HDR_ICON,this._view,a._field):null;
var o=e?document.getElementById(e):null;
if(o){
o.className=t?"ImgCheckboxChecked":"ImgCheckboxUnchecked"
}};
ZmListView.prototype.setSelectedItems=function(e){
DwtListView.prototype.setSelectedItems.call(this,e);
if(appCtxt.get(ZmSetting.SHOW_SELECTION_CHECKBOX)){
this._checkSelectedItems(true)
}};
ZmListView.prototype.selectAll=function(e){
DwtListView.prototype.selectAll.apply(this,arguments);
if(this._selectAllEnabled){
var a=this._controller._activeSearch;
if(a&&a.getAttribute("more")){
var t=AjxMessageFormat.format(ZmMsg.allPageSelected,this.getList().size());
if(e){
this.allSelected=true;
t=ZmMsg.allSearchSelected
}
appCtxt.setStatusMsg(t)
}}};
ZmListView.prototype.deselectAll=function(){
if(appCtxt.get(ZmSetting.SHOW_SELECTION_CHECKBOX)){
this._checkSelectedItems(false);
this.allSelected=false;
var e=DwtId.getListViewHdrId(DwtId.WIDGET_HDR_ICON,this._view,ZmItem.F_SELECTION);
var t=document.getElementById(e);
if(t){
t.className="ImgCheckboxUnchecked"
}}
DwtListView.prototype.deselectAll.call(this)
};
ZmListView.prototype._checkSelectedItems=function(e){
var a=this.getSelection();
for(var t=0;
t<a.length;
t++){
this.setSelectionCbox(a[t],!e)
}
this.setSelectionHdrCbox(a.length==this.getList().size())
};
ZmListView.prototype._setNoResultsHtml=function(){
DwtListView.prototype._setNoResultsHtml.call(this);
this.setSelectionHdrCbox(false)
};
ZmListView.prototype._getActionMenuForColHeader=function(o){
if(!this._colHeaderActionMenu||o){
this._colHeaderActionMenu=new ZmPopupMenu(this);
var n=new AjxListener(this,this._colHeaderActionListener);
for(var t=0;
t<this._headerList.length;
t++){
var a=this._headerList[t];
if(a._width){
var e=this._colHeaderActionMenu.createMenuItem(a._id,{
text:a._name,style:DwtMenuItem.CHECK_STYLE}
);
e.setData(ZmListView.KEY_ID,a._id);
e.setChecked(a._visible,true);
if(a._noRemove){
e.setEnabled(false)
}
this._colHeaderActionMenu.addSelectionListener(a._id,n)
}}}
return this._colHeaderActionMenu
};
ZmListView.prototype._colHeaderActionListener=function(a){
var o=a.item.getData(ZmListView.KEY_ID);
for(var t=0;
t<this._headerList.length;
t++){
var e=this._headerList[t];
if(e._id==o){
e._visible=!e._visible;
break
}}
this._relayout()
};
ZmListView.prototype.getToolTipContent=function(h){
var e=this.getTargetItemDiv(h);
if(!e){
return
}
var a=h.target.id||e.id;
if(!a){
return""
}
var n=this._data[e.id];
var r=n.type;
var d;
if(r&&r==DwtListView.TYPE_HEADER_ITEM){
var t=n.index;
var l=this._headerList[t]._field;
d=this._getHeaderToolTip(l,t)
}else{
var s=this._parseId(a);
if(s&&s.field){
var c=this.getItemFromElement(e);
var o={
field:s.field,item:c,ev:h,div:e,match:s};
d=this._getToolTip(o)
}}
return d
};
ZmListView.prototype._getHeaderToolTip=function(o,t,e){
var a=null;
if(o==ZmItem.F_SELECTION){
a=ZmMsg.selectionColumn
}else{
if(o==ZmItem.F_FLAG){
a=ZmMsg.flag
}else{
if(o==ZmItem.F_PRIORITY){
a=ZmMsg.priority
}else{
if(o==ZmItem.F_TAG){
a=ZmMsg.tag
}else{
if(o==ZmItem.F_ATTACHMENT){
a=ZmMsg.attachment
}else{
if(o==ZmItem.F_SUBJECT){
a=(this._headerList[t]._sortable)?ZmMsg.sortBySubject:ZmMsg.subject
}else{
if(o==ZmItem.F_DATE){
a=(this._headerList[t]._sortable)?(e&&e.sent)?ZmMsg.sortBySent:(e&&e.drafts)?ZmMsg.sortByLastSaved:ZmMsg.sortByReceived:ZmMsg.date
}else{
if(o==ZmItem.F_FROM){
a=(this._headerList[t]._sortable)?(e&&(e.sent||e.drafts))?ZmMsg.sortByTo:ZmMsg.sortByFrom:(e&&(e.sent||e.drafts))?ZmMsg.to:ZmMsg.from
}else{
if(o==ZmItem.F_SIZE){
a=(this._headerList[t]._sortable)?ZmMsg.sortBySize:ZmMsg.sizeToolTip
}else{
if(o==ZmItem.F_FOLDER){
a=ZmMsg.folder
}}}}}}}}}}
return a
};
ZmListView.prototype._getToolTip=function(n){
var t,o=n.field,a=n.ev.target,e=n.item;
if(o==ZmItem.F_SELECTION){
this._setItemData(n.div,"origSelClassName",a.className);
if(a.className!="ImgCheckboxChecked"){
a.className="ImgCheckboxChecked"
}}else{
if(o==ZmItem.F_FLAG){
if(!e.isFlagged){
AjxImg.setDisabledImage(a,this._getFlagIcon(e.isFlagged,true),true)
}}else{
if(o==ZmItem.F_PRIORITY){
if(e.isHighPriority){
t=ZmMsg.highPriorityTooltip
}else{
if(e.isLowPriority){
t=ZmMsg.lowPriorityTooltip
}}}else{
if(o==ZmItem.F_TAG){
t=this._getTagToolTip(e)
}else{
if(o==ZmItem.F_ATTACHMENT){}else{
if(o==ZmItem.F_DATE){
t=this._getDateToolTip(e,n.div)
}}}}}}
return t
};
ZmListView.prototype._getTagToolTip=function(r){
if(!r){
return
}
var s=r.tags.length;
if(!s){
return
}
var h=appCtxt.getTagTree();
var a=r.tags;
var n=[];
var t=0;
for(var o=0;
o<s;
o++){
var e=h.getById(a[o]);
if(!e){
continue
}
n[t++]="<table><tr><td>";
n[t++]=AjxImg.getImageHtml(ZmTag.COLOR_ICON[e.color]);
n[t++]="</td><td valign='middle'>";
n[t++]=AjxStringUtil.htmlEncode(e.name);
n[t++]="</td></tr></table>"
}
return n.join("")
};
ZmListView.prototype._getAttachmentToolTip=function(e){
var t=null;
var o=e&&e.attachments?e.attachments:[];
if(o.length==1){
var a=ZmMimeTable.getInfo(o[0].ct);
t=a?a.desc:null
}else{
if(o.length>1){
t=AjxMessageFormat.format(ZmMsg.multipleAttachmentsTooltip,[o.length])
}}
return t
};
ZmListView.prototype._getDateToolTip=function(e,t){
t._dateStr=t._dateStr||this._getDateToolTipText(e.date);
return t._dateStr
};
ZmListView.prototype._getDateToolTipText=function(t,n){
if(!t){
return""
}
var e=[];
var a=0;
e[a++]=n;
var o=AjxDateFormat.getDateTimeInstance(AjxDateFormat.FULL,AjxDateFormat.MEDIUM);
e[a++]=o.format(new Date(t));
var s=AjxDateUtil.computeDateDelta(t);
if(s){
e[a++]="<br><center><span style='white-space:nowrap'>(";
e[a++]=s;
e[a++]=")</span></center>"
}
return e.join("")
};
ZmListView.prototype._setListEvent=function(o,n,t){
DwtListView.prototype._setListEvent.call(this,o,n,t);
var s=(o.target.id&&o.target.id.indexOf("AjxImg")==-1)?o.target.id:t.id;
if(!s){
return false
}
var e=this._parseId(s);
if(o.button==DwtMouseEvent.LEFT){
this._selEv.field=e?e.field:null
}else{
if(o.button==DwtMouseEvent.RIGHT){
this._actionEv.field=e?e.field:null;
if(e&&e.field){
if(e.field==ZmItem.F_PARTICIPANT){
var a=this.getItemFromElement(t);
this._actionEv.detail=a.participants?a.participants.get(e.participant):null
}}}}
return true
};
ZmListView.prototype._allowLeftSelection=function(o,n,t){
if(!(n instanceof DwtMouseEvent)){
return true
}
var r=(n.target.id&&n.target.id.indexOf("AjxImg")==-1)?n.target.id:o.id;
var s=this._data[o.id];
var a=s.type;
if(r&&a&&a==DwtListView.TYPE_LIST_ITEM){
var e=this._parseId(r);
if(e&&e.field){
return this._allowFieldSelection(e.item,e.field)
}}
return true
};
ZmListView.prototype._allowFieldSelection=function(t,e){
return(!this._disallowSelection[e])
};
ZmListView.prototype._sortColumn=function(e,t){
var a;
switch(e._sortable){
case ZmItem.F_FROM:a=t?ZmSearch.NAME_ASC:ZmSearch.NAME_DESC;
break;
case ZmItem.F_SUBJECT:a=t?ZmSearch.SUBJ_ASC:ZmSearch.SUBJ_DESC;
break;
case ZmItem.F_DATE:a=t?ZmSearch.DATE_ASC:ZmSearch.DATE_DESC;
break;
case ZmItem.F_SIZE:a=t?ZmSearch.SIZE_ASC:ZmSearch.SIZE_DESC;
break;
case ZmItem.F_SORTED_BY:a=t?ZmSearch.DATE_ASC:ZmSearch.DATE_DESC;
break
}
if(a){
this._sortByString=a;
appCtxt.set(ZmSetting.SORTING_PREF,a,this.view)
}};
ZmListView.prototype._setNextSelection=function(){
if(this.firstSelIndex<0){
this.firstSelIndex=0
}
var e=this._list.get(this.firstSelIndex)||this._list.getLast();
if(e){
this.setSelection(e,false)
}};
ZmListView.prototype._relayout=function(){
DwtListView.prototype._relayout.call(this);
this._checkColumns()
};
ZmListView.prototype._checkColumns=function(){
var o=this._headerList.length;
var e=[];
for(var t=0;
t<o;
t++){
var n=this._headerList[t];
if(n){
e.push(n._field+(n._visible?"":"*"))
}}
var a=e.join(ZmListView.COL_JOIN);
a=(a==this._defaultCols)?"":a;
appCtxt.set(ZmSetting.LIST_VIEW_COLUMNS,a,this.view);
this._getActionMenuForColHeader(true)
};
ZmListView.handleScroll=function(e){
var t=DwtUiEvent.getTarget(e);
var a=DwtControl.findControl(t);
if(a){
a._checkItemCount()
}};
ZmListView.prototype._checkItemCount=function(){
if(!(this._controller._list&&this._controller._list.hasMore())||!this._list){
return
}
if(!this._rendered||!this._rowHeight){
return
}
var l=this._parentEl;
var n=l.scrollHeight,o=l.scrollTop,t=this._rowHeight;
var s=l.clientHeight||Dwt.getSize(l).y;
var r=s+(this.getPagelessThreshold()*this._rowHeight);
var e=n-o;
if(e==s){
e=(this._list.size()*t)-o;
if(o==0){
AjxTimedAction.scheduleAction(new AjxTimedAction(this,this._resetColWidth),100)
}}
var a=0;
if(e<r){
a=Math.max(Math.floor((r-e)/t),this.getLimit(1))
}
if(a){
this._controller._paginate(this._view,true,null,a)
}};
ZmListView.prototype._sizeChildren=function(e){
if(DwtListView.prototype._sizeChildren.apply(this,arguments)){
this._checkItemCount()
}}
}
if(AjxPackage.define("zimbraMail.share.view.ZmAppChooser")){
ZmAppChooser=function(a){
a.className=a.className||"ZmAppChooser";
a.width=appCtxt.getSkinHint("appChooser","fullWidth")?"100%":null;
ZmToolBar.call(this,a);
Dwt.setLocation(this.getHtmlElement(),Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
this.setScrollStyle(Dwt.CLIP);
this._buttonListener=new AjxListener(this,this._handleButton);
var t=a.buttons;
for(var e=0;
e<t.length;
e++){
var o=t[e];
if(o==ZmAppChooser.SPACER){
this.addSpacer(ZmAppChooser.SPACER_HEIGHT)
}else{
this._createButton(o)
}}
this._createPrecedenceList();
this._inited=true
};
ZmAppChooser.prototype=new ZmToolBar;
ZmAppChooser.prototype.constructor=ZmAppChooser;
ZmAppChooser.prototype.toString=function(){
return"ZmAppChooser"
};
ZmAppChooser.SPACER="spacer";
ZmAppChooser.B_HELP="Help";
ZmAppChooser.B_LOGOUT="Logout";
ZmApp.CHOOSER_SORT[ZmAppChooser.SPACER]=160;
ZmApp.CHOOSER_SORT[ZmAppChooser.B_HELP]=170;
ZmApp.CHOOSER_SORT[ZmAppChooser.B_LOGOUT]=190;
ZmApp.ICON[ZmAppChooser.B_HELP]="Help";
ZmApp.ICON[ZmAppChooser.B_LOGOUT]="Logoff";
ZmApp.CHOOSER_TOOLTIP[ZmAppChooser.B_HELP]="goToHelp";
ZmApp.CHOOSER_TOOLTIP[ZmAppChooser.B_LOGOUT]="logOff";
ZmAppChooser.SPACER_HEIGHT=10;
ZmAppChooser.prototype.TEMPLATE="share.Widgets#ZmAppChooser";
ZmAppChooser.prototype.ITEM_TEMPLATE="share.Widgets#ZmAppChooserItem";
ZmAppChooser.prototype.SPACER_TEMPLATE="dwt.Widgets#ZmAppChooserSpacer";
ZmAppChooser.prototype.addSelectionListener=function(e){
this.addListener(DwtEvent.SELECTION,e)
};
ZmAppChooser.prototype.addButton=function(o,a){
var t={
parent:this,id:ZmId.getButtonId(ZmId.APP,o),text:a.text,image:a.image,index:a.index};
var e=new ZmAppButton(t);
e.setToolTipContent(a.tooltip);
e.textPrecedence=a.textPrecedence;
e.imagePrecedence=a.imagePrecedence;
e.setData(Dwt.KEY_ID,o);
e.addSelectionListener(this._buttonListener);
this._buttons[o]=e;
if(e.textPrecedence||e.imagePrecedence){
this._createPrecedenceList()
}
this.adjustSize();
return e
};
ZmAppChooser.prototype.removeButton=function(a){
var t=this._buttons[a];
if(t){
var e=this.__getButtonIndex(a);
t.dispose();
this._buttons[a]=null;
delete this._buttons[a];
if(e!=null){
this._removeItem(this._items[e])
}}};
ZmAppChooser.prototype.replaceButton=function(a,e,t){
if(!this._buttons[a]){
return
}
t.index=this.__getButtonIndex(a);
this.removeButton(a);
return this.addButton(e,t)
};
ZmAppChooser.prototype.getButton=function(e){
return this._buttons[e]
};
ZmAppChooser.prototype.setSelected=function(a){
var e=this._buttons[this._selectedId];
if(this._selectedId&&e){
this.__markPrevNext(this._selectedId,false);
e.setSelected(false);
e._noFocus=false
}
var t=this._buttons[a];
if(t){
t.setSelected(true);
if(t._toggleText!=null&&t._toggleText!=""){
if(e){
e._toggleText=(e._toggleText!=null&&e._toggleText!="")?e._toggleText:e.getText();
e.setText("")
}
t.setText(t._toggleText);
t._toggleText=null
}
t._noFocus=true
}
this._selectedId=a
};
ZmAppChooser.prototype._createButton=function(e){
this.addButton(e,{
text:ZmMsg[ZmApp.NAME[e]],image:ZmApp.ICON[e],tooltip:ZmMsg[ZmApp.CHOOSER_TOOLTIP[e]],textPrecedence:ZmApp.TEXT_PRECEDENCE[e],imagePrecedence:ZmApp.IMAGE_PRECEDENCE[e]}
)
};
ZmAppChooser.prototype._handleButton=function(e){
this.notifyListeners(DwtEvent.SELECTION,e)
}
}
if(AjxPackage.define("zimbraMail.share.view.ZmAppButton")){
ZmAppButton=function(e){
if(arguments.length==0){
return
}
e.style=DwtLabel.IMAGE_LEFT;
e.posStyle=DwtControl.RELATIVE_STYLE;
DwtButton.call(this,e);
this.setImage(e.image);
this.setText(e.text)
};
ZmAppButton.prototype=new DwtButton;
ZmAppButton.prototype.constructor=ZmAppButton;
ZmAppButton.prototype.toString=function(){
return"ZmAppButton"
};
ZmAppButton.prototype.TEMPLATE="share.Widgets#ZmAppChooserButton";
ZmAppButton.prototype.setSelected=function(e){
this.isSelected=e;
this.setDisplayState(e?DwtControl.SELECTED:DwtControl.NORMAL)
};
ZmAppButton.prototype.setDisplayState=function(e){
if(this.isSelected&&e!=DwtControl.SELECTED){
e=[DwtControl.SELECTED,e].join(" ")
}
DwtButton.prototype.setDisplayState.call(this,e)
};
ZmAppButton.prototype.getKeyMapName=function(){
return"ZmAppButton"
};
ZmAppButton.prototype.handleKeyAction=function(e,t){
switch(e){
case DwtKeyMap.SELECT:if(this.isListenerRegistered(DwtEvent.SELECTION)){
var a=DwtShell.selectionEvent;
a.item=this;
this.notifyListeners(DwtEvent.SELECTION,a)
}
break;
default:return false
}
return true
};
ZmAppButton.prototype._focus=function(){
this.setDisplayState(DwtControl.HOVER)
}
}
if(AjxPackage.define("zimbraMail.share.view.ZmStatusView")){
ZmStatusView=function(a,t,e,o){
DwtControl.call(this,{
parent:a,className:(t||"ZmStatus"),posStyle:e,id:o}
);
this._toast=this._standardToast=new ZmToast(this,ZmId.TOAST);
this._statusQueue=[]
};
ZmStatusView.prototype=new DwtControl;
ZmStatusView.prototype.constructor=ZmStatusView;
ZmStatusView.LEVEL_INFO=1;
ZmStatusView.LEVEL_WARNING=2;
ZmStatusView.LEVEL_CRITICAL=3;
ZmStatusView.MSG_PARAMS=["msg","level","detail","transitions","toast"];
ZmStatusView.prototype.toString=function(){
return"ZmStatusView"
};
ZmStatusView.prototype.setStatusMsg=function(t){
t=Dwt.getParams(arguments,ZmStatusView.MSG_PARAMS);
if(typeof t=="string"){
t={
msg:t}
}
var e={
msg:t.msg,level:t.level||ZmStatusView.LEVEL_INFO,detail:t.detail,date:new Date(),transitions:t.transitions,toast:t.toast||this._standardToast};
this._statusQueue.push(e);
if(!this._toast.isPoppedUp()){
this._updateStatusMsg()
}};
ZmStatusView.prototype.nextStatus=function(){
if(this._statusQueue.length>0){
this._updateStatusMsg();
return true
}
return false
};
ZmStatusView.getClass=function(e){
switch(e.level){
case ZmStatusView.LEVEL_CRITICAL:return"ZToastCrit";
case ZmStatusView.LEVEL_WARNING:return"ZToastWarn";
default:return"ZToastInfo"
}};
ZmStatusView.getImageHtml=function(e){
switch(e.level){
case ZmStatusView.LEVEL_CRITICAL:return"Critical";
case ZmStatusView.LEVEL_WARNING:return"Warning";
default:return"Success"
}};
ZmStatusView.prototype._updateStatusMsg=function(){
var e=this._statusQueue.shift();
if(!e){
return
}
var a=ZmStatusView.getClass(e);
var t=ZmStatusView.getImageHtml(e);
this._toast=e.toast;
this._toast.popup(a,e.msg,t,null,e.transitions)
};
ZmToast=function(e,t){
if(arguments.length==0){
return
}
DwtComposite.call(this,{
parent:e.shell,className:"ZToast",posStyle:Dwt.ABSOLUTE_STYLE,id:t}
);
this._statusView=e;
this._createHtml();
this._funcs={};
this._funcs.position=AjxCallback.simpleClosure(this.__position,this);
this._funcs.show=AjxCallback.simpleClosure(this.__show,this);
this._funcs.hide=AjxCallback.simpleClosure(this.__hide,this);
this._funcs.pause=AjxCallback.simpleClosure(this.__pause,this);
this._funcs.idle=AjxCallback.simpleClosure(this.__idle,this);
this._funcs.fade=AjxCallback.simpleClosure(this.__fade,this);
this._funcs["fade-in"]=this._funcs.fade;
this._funcs["fade-out"]=this._funcs.fade;
this._funcs.slide=AjxCallback.simpleClosure(this.__slide,this);
this._funcs["slide-in"]=this._funcs.slide;
this._funcs["slide-out"]=this._funcs.slide;
this._funcs.next=AjxCallback.simpleClosure(this.transition,this)
};
ZmToast.prototype=new DwtComposite;
ZmToast.prototype.constructor=ZmToast;
ZmToast.prototype.toString=function(){
return"ZmToast"
};
ZmToast.FADE={
type:"fade"};
ZmToast.FADE_IN={
type:"fade-in"};
ZmToast.FADE_OUT={
type:"fade-out"};
ZmToast.SLIDE={
type:"slide"};
ZmToast.SLIDE_IN={
type:"slide-in"};
ZmToast.SLIDE_OUT={
type:"slide-out"};
ZmToast.PAUSE={
type:"pause"};
ZmToast.IDLE={
type:"idle"};
ZmToast.SHOW={
type:"show"};
ZmToast.DEFAULT_TRANSITIONS=[ZmToast.SLIDE_IN,ZmToast.PAUSE,ZmToast.SLIDE_OUT];
ZmToast.DEFAULT_STATE={};
ZmToast.DEFAULT_STATE.position={
location:"C"};
ZmToast.DEFAULT_STATE.pause={
duration:1200};
ZmToast.DEFAULT_STATE.fade={
duration:100,multiplier:1};
ZmToast.DEFAULT_STATE["fade-in"]={
start:0,end:99,step:10,duration:200,multiplier:1};
ZmToast.DEFAULT_STATE["fade-out"]={
start:99,end:0,step:-10,duration:200,multiplier:1};
ZmToast.DEFAULT_STATE.slide={
duration:100,multiplier:1};
ZmToast.DEFAULT_STATE["slide-in"]={
start:-40,end:0,step:1,duration:100,multiplier:1};
ZmToast.DEFAULT_STATE["slide-out"]={
start:0,end:-40,step:-1,duration:100,multiplier:1};
ZmToast.LEVEL_RE=/\b(ZToastCrit|ZToastWarn|ZToastInfo)\b/g;
ZmToast.prototype.TEMPLATE="share.Widgets#ZToast";
ZmToast.prototype.dispose=function(){
this._textEl=null;
this._iconEl=null;
this._detailEl=null;
DwtComposite.prototype.dispose.call(this)
};
ZmToast.prototype.popup=function(h,r,a,s,n){
this.__clear();
this._poppedUp=true;
var t=this.getHtmlElement();
Dwt.delClass(t,ZmToast.LEVEL_RE,h||"ZToastInfo");
if(this._textEl){
this._textEl.innerHTML=r||""
}
if(this._iconEl){
AjxImg.setImage(this._iconEl,a,false)
}
var e=appCtxt.getSkinHint("toast","location")||s;
var o=n||appCtxt.getSkinHint("toast","transitions")||ZmToast.DEFAULT_TRANSITIONS;
o=[].concat({
type:"position",location:e}
,o,{
type:"hide"}
);
this._transitions=o;
this.transition()
};
ZmToast.prototype.popdown=function(){
this.__clear();
Dwt.setLocation(this.getHtmlElement(),Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
this._poppedUp=false
};
ZmToast.prototype.isPoppedUp=function(){
return this._poppedUp
};
ZmToast.prototype.transition=function(){
var a=this._transitions&&this._transitions.shift();
if(!a){
this._poppedUp=false;
if(!this._statusView.nextStatus()){
this.popdown()
}
return
}
var t=this._state=this._createState(a);
var e=this.getHtmlElement();
Dwt.setLocation(e,t.x,t.y);
this._funcs[a.type||"next"]()
};
ZmToast.prototype._createHtml=function(e){
var t={
id:this._htmlElId};
this._createHtmlFromTemplate(e||this.TEMPLATE,t);
Dwt.setZIndex(this.getHtmlElement(),Dwt.Z_TOAST)
};
ZmToast.prototype._createHtmlFromTemplate=function(e,t){
DwtComposite.prototype._createHtmlFromTemplate.call(this,e,t);
this._textEl=document.getElementById(t.id+"_text");
this._iconEl=document.getElementById(t.id+"_icon");
this._detailEl=document.getElementById(t.id+"_detail")
};
ZmToast.prototype._createState=function(n){
var a=AjxUtil.createProxy(n);
var o=ZmToast.DEFAULT_STATE[a.type];
for(var e in o){
if(!a[e]){
a[e]=o[e]
}}
var t=this.getHtmlElement();
switch(a.type){
case"fade-in":Dwt.setOpacity(t,0);
Dwt.setLocation(t,null,0);
a.value=a.start;
break;
case"fade-out":case"fade":Dwt.setLocation(t,null,0);
a.value=a.start;
break;
case"slide-in":case"slide-out":case"slide":Dwt.setLocation(t,null,-36);
Dwt.setOpacity(t,100);
a.value=a.start;
break
}
return a
};
ZmToast.prototype.__clear=function(){
clearTimeout(this._actionId);
clearInterval(this._actionId);
this._actionId=-1
};
ZmToast.prototype.__position=function(){
var a=this.getHtmlElement();
var n=Dwt.getSize(this.shell.getHtmlElement());
var o=Dwt.getSize(a);
var e=(n.x-o.x)/2;
var s=(n.y-o.y)/2;
var t=this._state.location||"C";
switch(t.toUpperCase()){
case"N":s=0-o.y;
break;
case"S":s=n.y-o.y;
break;
case"E":e=n.x-o.x;
break;
case"W":e=0;
break;
case"NE":e=n.x-o.x;
s=0;
break;
case"NW":e=0;
s=0;
break;
case"SE":e=n.x-o.x;
s=n.y-o.y;
break;
case"SW":e=0;
s=n.y-o.y;
break;
case"C":default:break
}
Dwt.setLocation(a,e,s);
this._funcs.next()
};
ZmToast.prototype.__show=function(){
var e=this.getHtmlElement();
Dwt.setVisible(e,true);
Dwt.setVisibility(e,true);
this._funcs.next()
};
ZmToast.prototype.__hide=function(){
var e=this.getHtmlElement();
Dwt.setLocation(e,Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
this._funcs.next()
};
ZmToast.prototype.__pause=function(){
setTimeout(this._funcs.next,this._state.duration)
};
ZmToast.prototype.__idle=function(){
if(!this._idleTimer){
this._idleTimer=new DwtIdleTimer(0,new AjxCallback(this,this.__idleCallback))
}else{
this._idleTimer.resurrect(0)
}};
ZmToast.prototype.__idleCallback=function(e){
if(!e){
this.transition();
this._idleTimer.kill()
}};
ZmToast.prototype.__move=function(){
this._funcs.next()
};
ZmToast.prototype.__fade=function(){
var t=this._state.value;
var o=this._state.step;
if(AjxEnv.isIE){
if(AjxEnv.isIE5_5up){
try{
var a=this.getHtmlElement();
a.style.visibility=o>0?"hidden":"visible";
var s=this._state.duration/1000;
a.style.filter="progid:DXImageTransform.Microsoft.Fade(duration="+s+",overlap=1.0)";
a.filters[0].Apply();
a.style.visibility=o>0?"visible":"hidden";
a.filters[0].Play()
}
catch(n){}}
setTimeout(this._funcs.next,0);
return
}
var r=o>0?t>=this._state.end:t<=this._state.end;
if(r){
t=this._state.end
}
var a=this.getHtmlElement();
Dwt.setOpacity(a,t);
if(r){
this.__clear();
setTimeout(this._funcs.next,0);
return
}
if(this._actionId==-1){
var s=this._state.duration;
var h=s/Math.abs(o);
this._actionId=setInterval(this._funcs.fade,h)
}
this._state.value+=o;
this._state.step*=this._state.multiplier
};
ZmToast.prototype.__slide=function(){
var o=this._state.value;
var t=this._state.step;
var n=t>0?o>=this._state.end:o<=this._state.end;
if(n){
o=this._state.end
}
var e=this.getHtmlElement();
Dwt.setLocation(e,null,o);
if(n){
this.__clear();
setTimeout(this._funcs.next,0);
return
}
if(this._actionId==-1){
var a=this._state.duration;
var s=a/Math.abs(t);
this._actionId=setInterval(this._funcs.slide,s)
}
this._state.value+=t;
this._state.step*=this._state.multiplier
}
}
if(AjxPackage.define("zimbraMail.share.view.ZmOverviewContainer")){
ZmOverviewContainer=function(e){
if(arguments.length==0){
return
}
e.className=e.className||"ZmOverviewContainer";
e.id=e.id||ZmId.getOverviewContainerId(e.containerId);
DwtTree.call(this,e);
this.setScrollStyle(e.scroll||Dwt.SCROLL);
this.containerId=e.containerId;
this._appName=e.appName;
this._controller=e.controller;
this._headerItems={};
this._overview={};
this.addSelectionListener(new AjxListener(this,this._treeViewListener));
this.addTreeListener(new AjxListener(this,this._treeListener))
};
ZmOverviewContainer.prototype=new DwtTree;
ZmOverviewContainer.prototype.constructor=ZmOverviewContainer;
ZmOverviewContainer.prototype.toString=function(){
return"ZmOverviewContainer"
};
ZmOverviewContainer.prototype.initialize=function(e){};
ZmOverviewContainer.prototype.getOverview=function(e){
return this._overview[e]
};
ZmOverviewContainer.prototype.getOverviews=function(){
return this._overview
};
ZmOverviewContainer.prototype.getHeaderItem=function(){};
ZmOverviewContainer.prototype.getSelected=function(){
var t;
for(var e in this._overview){
t=this._overview[e].getSelected();
if(t){
return t
}}};
ZmOverviewContainer.prototype.deselectAll=function(e){
DwtTree.prototype.deselectAll.call(this);
this._deselectAllTreeViews(e)
};
ZmOverviewContainer.prototype.setOverviewTrees=function(e){
for(var t in this._overview){
this._overview[t].set(e)
}};
ZmOverviewContainer.prototype.resetOperations=function(t,e){};
ZmOverviewContainer.prototype._treeViewListener=function(e){};
ZmOverviewContainer.prototype._treeListener=function(e){};
ZmOverviewContainer.prototype._initializeActionMenu=function(e){};
ZmOverviewContainer.prototype._getActionMenu=function(){
if(this._actionMenu instanceof AjxCallback){
var e=this._actionMenu;
this._actionMenu=e.run()
}
return this._actionMenu
};
ZmOverviewContainer.prototype._createActionMenu=function(t,e,a){};
ZmOverviewContainer.prototype._actionMenuListener=function(e){};
ZmOverviewContainer.prototype._deselectAllTreeViews=function(o){
for(var a in this._overview){
var n=this._overview[a];
if(o&&o==n){
continue
}
var t=n._treeHash;
for(var e in t){
if(t[e].getSelectionCount()>0){
t[e].deselectAll();
break
}}}}
}
if(AjxPackage.define("zimbraMail.share.view.ZmAccountOverviewContainer")){
ZmAccountOverviewContainer=function(e){
if(arguments.length==0){
return
}
ZmOverviewContainer.call(this,e)
};
ZmAccountOverviewContainer.prototype=new ZmOverviewContainer;
ZmAccountOverviewContainer.prototype.constructor=ZmAccountOverviewContainer;
ZmAccountOverviewContainer.prototype.toString=function(){
return"ZmAccountOverviewContainer"
};
ZmAccountOverviewContainer.prototype.getHeaderItem=function(e){
return e&&this._headerItems[e.id]
};
ZmAccountOverviewContainer.prototype.expandAccountOnly=function(t){
if(!t){
t=appCtxt.getActiveAccount()
}
for(var e in this._headerItems){
this._headerItems[e].setExpanded((e==t.id),false,false)
}};
ZmAccountOverviewContainer.prototype.getSelected=function(){
var t=ZmOverviewContainer.prototype.getSelected.call(this);
if(!t){
t=this.getSelection()[0];
var a=t&&appCtxt.accountList.getAccount(t.getData(Dwt.KEY_ID));
var e=a&&appCtxt.getFolderTree(a);
return e&&e.root
}
return t
};
ZmAccountOverviewContainer.prototype.initialize=function(s){
var h,d;
var a=false;
var o=appCtxt.accountList.visibleAccounts;
for(var r=0;
r<o.length;
r++){
d=o[r];
if(appCtxt.isOffline&&d.isMain&&this._appName!=ZmApp.PREFERENCES){
continue
}
this._addAccount(s,d,a);
h=this.getHeaderItem(d);
if(h){
if(this._appName==ZmApp.PREFERENCES){
h.setExpanded(true,false,true);
h.enableSelection(false)
}else{
var e=appCtxt.get(ZmSetting.ACCOUNT_TREE_OPEN,null,d);
h.setExpanded(e);
if(!e){
this._setAccountHeaderLabel(d,h)
}}}
this.updateAccountInfo(d,true,true);
a=!a
}
if(appCtxt.isOffline&&this._appName!=ZmApp.PREFERENCES){
var n=s.omit;
if(!n){
n={}
}
n[ZmFolder.ID_SPAM]=true;
d=appCtxt.accountList.mainAccount;
this._addAccount(s,d,a,"ZmOverviewLocalHeader");
h=this.getHeaderItem(d);
h.setExpanded(appCtxt.get(ZmSetting.ACCOUNT_TREE_OPEN,null,d))
}
var f=s.omit&&s.omit[ZmOrganizer.ID_ZIMLET];
if(!f&&!appCtxt.inStartup){
f=(appCtxt.getZimletMgr().getPanelZimlets().length==0)
}
if(!f&&window[ZmOverviewController.CONTROLLER[ZmOrganizer.ZIMLET]]){
var l=ZmOrganizer.LABEL[ZmOrganizer.ZIMLET];
var m=s.overviewId=appCtxt.getOverviewId([this.containerId,l],null);
var u={
label:ZmMsg[l],icon:"Resource",dataId:m,className:"ZmOverviewZimletHeader"};
s.overviewTrees=[ZmOrganizer.ZIMLET];
this._addSection(u,null,s);
var h=this._headerItems[m];
if(h){
h.__isZimlet=true;
h.setExpanded(appCtxt.get(ZmSetting.ZIMLET_TREE_OPEN,null,appCtxt.accountList.mainAccount))
}}
f=s.omit&&s.omit[ZmOrganizer.ID_GLOBAL_INBOX];
if(appCtxt.isOffline&&!f&&this._appName==ZmApp.MAIL&&appCtxt.accountList.size(true)>2){
var s={
parent:this,text:(ZmMsg[ZmFolder.MSG_KEY[ZmOrganizer.ID_GLOBAL_INBOX]]),imageInfo:"GlobalInbox"};
var t=new DwtTreeItem(s);
t.setData(Dwt.KEY_ID,appCtxt.getById(ZmOrganizer.ID_GLOBAL_INBOX));
t.setScrollStyle(Dwt.CLIP);
t.addClassName("ZmOverviewGlobalInbox");
t._initialize(0,true);
t.setVisible(appCtxt.get(ZmSetting.OFFLINE_SHOW_GLOBAL_INBOX));
this.setSelection(t,true);
var c=appCtxt.accountList.mainAccount;
var p=appCtxt.getSettings(c).getSetting(ZmSetting.OFFLINE_SHOW_GLOBAL_INBOX);
p.addChangeListener(new AjxListener(this,this._settingChangeListener,t))
}};
ZmAccountOverviewContainer.prototype.updateAccountInfo=function(n,e,o){
var t=appCtxt.getApp(this._appName)&&this.getHeaderItem(n);
if(t){
if(e){
var a="";
if(n.status!=ZmZimbraAccount.STATUS_ONLINE){
a=(n.status==ZmZimbraAccount.STATUS_RUNNING)?("<img src='/img/animated/ImgSpinner.gif' width=16 height=16 border=0>"):(AjxImg.getImageHtml(n.getStatusIcon()))
}
if(t._extraCell){
t._extraCell.innerHTML=a
}}
if(o){
t.setToolTipContent(n.getToolTip())
}}};
ZmAccountOverviewContainer.prototype.resetOperations=function(t,e){
t.enableAll(!(e instanceof ZmFolder));
var a=appCtxt.accountList.getAccount(e);
if(a){
t.enable(ZmOperation.NEW_FOLDER,a.type!=ZmAccount.TYPE_POP);
t.enable(ZmOperation.SYNC,!a.isMain)
}};
ZmAccountOverviewContainer.prototype.removeZimletSection=function(){
var e=ZmOrganizer.LABEL[ZmOrganizer.ZIMLET];
var t=appCtxt.getOverviewId([this.containerId,e],null);
var a=this._headerItems[t];
if(a){
this.removeChild(a)
}};
ZmAccountOverviewContainer.prototype._addAccount=function(n,s,e,h){
n.overviewId=appCtxt.getOverviewId(this.containerId,s);
n.account=s;
var o=appCtxt.getApp(this._appName);
var t=(!o||(o&&appCtxt.get(ZmApp.SETTING[this._appName],null,s)));
if(this._appName==ZmApp.PREFERENCES||t){
var a=n.omitPerAcct?n.omitPerAcct[s.id]:n.omit;
var r=(this._appName==ZmApp.PREFERENCES&&s.isMain)?ZmMsg.allAccounts:s.getDisplayName();
var l={
label:r,icon:s.getIcon(),dataId:s.id,className:h};
this._addSection(l,a,n,e);
this._initializeActionMenu(s)
}};
ZmAccountOverviewContainer.prototype._addSection=function(h,o,n,a){
var s={
parent:this,text:h.label,imageInfo:h.icon,selectable:n.selectable,className:h.className};
var r=this._headerItems[h.dataId]=new DwtTreeItem(s);
r.setData(Dwt.KEY_ID,h.dataId);
r.setScrollStyle(Dwt.CLIP);
r._initialize(null,true,true);
r.addClassName(a?"ZmOverviewSectionHilite":"ZmOverviewSection");
n.id=ZmId.getOverviewId(n.overviewId);
n.parent=r;
n.scroll=Dwt.CLIP;
n.posStyle=Dwt.STATIC_STYLE;
var t=this._controller._overview[n.overviewId]=this._overview[n.overviewId]=new ZmOverview(n,this._controller);
r._addItem(t,null,true);
var e=n.overviewTrees||n.treeIds;
t.set(e,o)
};
ZmAccountOverviewContainer.prototype._treeViewListener=function(l){
if(l.detail!=DwtTree.ITEM_ACTIONED&&l.detail!=DwtTree.ITEM_SELECTED&&l.detail!=DwtTree.ITEM_DBL_CLICKED){
return
}
var c=this._actionedHeaderItem=l.item;
var n=c&&c.getData(Dwt.KEY_ID);
if(l.detail==DwtTree.ITEM_ACTIONED&&appCtxt.getApp(this._appName)){
if(c.__isZimlet){
return
}
var h=this._getActionMenu(l);
if(h){
this.resetOperations(h,n);
h.popup(0,l.docX,l.docY)
}}else{
if((l.detail==DwtTree.ITEM_SELECTED)&&c){
if(this._appName==ZmApp.CALENDAR||this._appName==ZmApp.PREFERENCES){
return
}
this._deselectAllTreeViews();
if(!ZmApp.NAME[this._appName]){
return
}
if(n){
var r=appCtxt.getSearchController();
var a;
if(n instanceof ZmFolder){
var o=appCtxt.accountList.mainAccount;
r.resetSearchAllAccounts();
r.searchAllAccounts=true;
a={
queryHint:appCtxt.accountList.generateQuery(ZmOrganizer.ID_INBOX),folderId:null,getHtml:appCtxt.get(ZmSetting.VIEW_AS_HTML,null,o),searchFor:(ZmApp.DEFAULT_SEARCH[this._appName]),sortBy:ZmSearch.DATE_DESC,accountName:o.name,noUpdateOverview:true}
}else{
r.searchAllAccounts=false;
var s=appCtxt.accountList.getAccount(n);
appCtxt.accountList.setActiveAccount(s);
var t=ZmOrganizer.DEFAULT_FOLDER[ZmApp.ORGANIZER[this._appName]];
var e=appCtxt.getById(ZmOrganizer.getSystemId(t,s));
a={
query:e.createQuery(),getHtml:appCtxt.get(ZmSetting.VIEW_AS_HTML),searchFor:(ZmApp.DEFAULT_SEARCH[this._appName]),sortBy:((r.currentSearch&&e.nId==r.currentSearch.folderId)?null:ZmSearch.DATE_DESC),accountName:(s&&s.name),noUpdateOverview:true}
}
r.search(a)
}}else{}}};
ZmAccountOverviewContainer.prototype._treeListener=function(t){
var o;
var a=t.item;
if(a){
o=a.__isZimlet?appCtxt.accountList.mainAccount:appCtxt.accountList.getAccount(a.getData(Dwt.KEY_ID))
}
if(!o){
return
}
if(appCtxt.getCurrentAppName()!=ZmApp.PREFERENCES&&(t.detail==DwtTree.ITEM_COLLAPSED||t.detail==DwtTree.ITEM_EXPANDED)){
var e=t.detail==DwtTree.ITEM_EXPANDED;
if(!appCtxt.inStartup){
appCtxt.set(ZmSetting.ACCOUNT_TREE_OPEN,e,null,null,null,o)
}
if(!a.__isZimlet){
if(e){
a.setText(o.getDisplayName())
}else{
this._setAccountHeaderLabel(o,a)
}}}};
ZmAccountOverviewContainer.prototype._settingChangeListener=function(t,a){
if(a.type!=ZmEvent.S_SETTING){
return
}
var e=a.source;
if(e.id==ZmSetting.OFFLINE_SHOW_GLOBAL_INBOX){
t.setVisible(e.getValue())
}};
ZmAccountOverviewContainer.prototype.updateAccountHeaderLabel=function(t){
var e=this.getHeaderItem(t);
if(e&&!e.getExpanded()){
this._setAccountHeaderLabel(t,e)
}};
ZmAccountOverviewContainer.prototype._setAccountHeaderLabel=function(n,o){
var t=ZmOrganizer.getSystemId(ZmOrganizer.ID_INBOX,n,true);
var a=appCtxt.getById(t);
var e=(a&&a.numUnread>0)?(["<span style='font-weight:bold;'>",n.getDisplayName()," (",a.numUnread,")","</span>"].join("")):n.getDisplayName();
o.setText(e)
};
ZmAccountOverviewContainer.prototype._initializeActionMenu=function(a){
if(!this._actionMenu){
var t=[ZmOperation.NEW_FOLDER,ZmOperation.SYNC];
var e=[appCtxt.getShell(),t,a];
this._actionMenu=new AjxCallback(this,this._createActionMenu,e)
}};
ZmAccountOverviewContainer.prototype._createActionMenu=function(o,a,r){
if(!a){
return
}
var s=new AjxListener(this,this._actionMenuListener);
var n=new ZmActionMenu({
parent:o,menuItems:a}
);
a=n.opList;
for(var t=0;
t<a.length;
t++){
var e=n.getItem(t);
var h=a[t];
if(h==ZmOperation.SYNC){
e.setText(ZmMsg.sendReceive)
}
e.setData(Dwt.KEY_OBJECT,appCtxt.getFolderTree(r).root);
n.addSelectionListener(h,s)
}
return n
};
ZmAccountOverviewContainer.prototype._actionMenuListener=function(a){
var t=a.item.getData(ZmOperation.KEY_ID);
if(t==ZmOperation.NEW_FOLDER){
var n=ZmApp.ORGANIZER[this._appName];
var e=this._controller.getTreeController(n,true);
if(e){
e._actionedOrganizer=null;
var o=appCtxt.accountList.getAccount(this._actionedHeaderItem.getData(Dwt.KEY_ID));
e._actionedOrganizer=appCtxt.getFolderTree(o).root;
e._newListener(a,o)
}}else{
if(t==ZmOperation.SYNC){
var o=appCtxt.accountList.getAccount(this._actionedHeaderItem.getData(Dwt.KEY_ID));
if(o){
o.sync()
}}}}
}
if(AjxPackage.define("zimbraMail.share.view.ZmOverview")){
ZmOverview=function(t,n){
var h=t.overviewClass?t.overviewClass:"ZmOverview";
t.id=t.id||ZmId.getOverviewId(t.overviewId);
DwtComposite.call(this,{
parent:t.parent,className:h,posStyle:t.posStyle,id:t.id}
);
this._controller=n;
this.setScrollStyle(t.scroll||Dwt.SCROLL);
this.overviewId=t.overviewId;
this.account=t.account;
this.selectionSupported=t.selectionSupported;
this.actionSupported=t.actionSupported;
this.dndSupported=t.dndSupported;
this.headerClass=t.headerClass;
this.showUnread=t.showUnread;
this.showNewButtons=t.showNewButtons;
this.treeStyle=t.treeStyle;
this.isCheckedByDefault=t.isCheckedByDefault;
this.noTooltips=t.noTooltips;
this.isAppOverview=t.isAppOverview;
this._treeIds=[];
this._treeHash={};
this._treeParents={};
var l=document;
var a=this.getHtmlElement();
if(t.treeIds){
for(var o=0,r=t.treeIds.length;
o<r;
o++){
var e=l.createElement("DIV");
var s=t.treeIds[o];
this._treeParents[s]=e.id=[this.overviewId,s].join("-parent-");
a.appendChild(e)
}}
if(this.dndSupported){
var t={
container:this.getHtmlElement(),threshold:15,amount:5,interval:10,id:this.overviewId};
this._dndScrollCallback=new AjxCallback(null,DwtControl._dndScrollCallback,[t])
}};
ZmOverview.prototype=new DwtComposite;
ZmOverview.prototype.constructor=ZmOverview;
ZmOverview.prototype.toString=function(){
return"ZmOverview"
};
ZmOverview.prototype.getTreeParent=function(e){
return this._treeParents[e]
};
ZmOverview.prototype.set=function(e,a){
if(e&&e.length){
for(var t=0;
t<e.length;
t++){
this.setTreeView(e[t],a)
}}};
ZmOverview.prototype.setTreeView=function(t,e){
if(appCtxt.get(ZmOrganizer.PRECONDITION[t])===false){
return
}
AjxDispatcher.require(ZmOrganizer.ORG_PACKAGE[t]);
var a=this._controller.getTreeController(t);
if(this._treeHash[t]){
a.clearTreeView(this.overviewId)
}else{
this._treeIds.push(t)
}
var o={
overviewId:this.overviewId,omit:e,showUnread:this.showUnread,account:this.account};
this._treeHash[t]=a.show(o)
};
ZmOverview.prototype.getTreeView=function(e){
return this._treeHash[e]
};
ZmOverview.prototype.getTreeViews=function(){
return this._treeIds
};
ZmOverview.prototype.getTreeItemById=function(n,a){
if(!n){
return null
}
for(var t=0;
t<this._treeIds.length;
t++){
var e=this._treeHash[this._treeIds[t]];
if(e){
var o=e.getTreeItemById&&e.getTreeItemById(n);
if(o&&(!a||(this._treeIds[t]==a))){
return o
}}}
return null
};
ZmOverview.prototype.getSelected=function(t){
for(var a=0;
a<this._treeIds.length;
a++){
var e=this._treeHash[this._treeIds[a]];
if(e){
var o=e.getSelected();
if(o){
return t?e.type:o
}}}
return null
};
ZmOverview.prototype.setSelected=function(o,a){
var t,e;
if(a){
e=this._treeHash[a];
t=e&&e.getTreeItemById(o)
}else{
for(var a in this._treeHash){
e=this._treeHash[a];
t=e&&e.getTreeItemById(o);
if(t){
break
}}}
if(t&&(this._selectedTreeItem!=t)){
e.setSelected(o,true,true)
}
this.itemSelected(t)
};
ZmOverview.prototype.itemSelected=function(a){
if(appCtxt.multiAccounts&&a){
var t=this.overviewId.substring(0,this.overviewId.indexOf(":"));
var e=this._controller.getOverviewContainer(t);
if(e){
e.deselectAll(this)
}}
if(this._selectedTreeItem&&(this._selectedTreeItem._tree!=(a&&a._tree))){
this._selectedTreeItem._tree.deselectAll()
}
this._selectedTreeItem=a
};
ZmOverview.prototype.clear=function(){
for(var e=0;
e<this._treeIds.length;
e++){
var t=this._treeIds[e];
if(this._treeHash[t]){
var a=this._controller.getTreeController(t);
a.clearTreeView(this.overviewId);
delete this._treeHash[t]
}}};
ZmOverview.prototype._initialize=function(){};
ZmOverview.prototype._focus=function(){
var t=this._selectedTreeItem;
if(!t){
var e=this._treeHash[this._treeIds[0]];
if(e){
t=e._getNextTreeItem(true)
}}
if(t){
t.focus()
}};
ZmOverview.prototype._blur=function(){
var e=this._selectedTreeItem;
if(e){
e._blur()
}};
ZmOverview.prototype._getNextTreeItem=function(n,a){
for(var o=0;
o<this._treeIds.length;
o++){
if(this._treeHash[this._treeIds[o]]==a){
break
}}
var t=null;
var e=n?o+1:o-1;
a=this._treeHash[this._treeIds[e]];
while(a){
t=DwtTree.prototype._getNextTreeItem.call(a,n);
if(t){
break
}
e=n?e+1:e-1;
a=this._treeHash[this._treeIds[e]]
}
return t
}
}
if(AjxPackage.define("zimbraMail.share.view.ZmUpsellView")){
ZmUpsellView=function(e){
DwtControl.call(this,e)
};
ZmUpsellView.prototype=new DwtControl;
ZmUpsellView.prototype.constructor=ZmUpsellView;
ZmUpsellView.prototype.toString=function(){
return"ZmUpsellView"
};
ZmUpsellView.prototype.setBounds=function(t,h,o,e,s){
var n=0;
if(!s){
n=this._getToolbarHeight()
}
DwtControl.prototype.setBounds.call(this,t,h-n,o,e+n);
var r="iframe_"+this.getHTMLElId();
var a=document.getElementById(r);
if(a){
a.width=o;
a.height=e+n
}};
ZmUpsellView.prototype._getToolbarHeight=function(){
var t=appCtxt.getAppViewMgr().getCurrentViewComponent(ZmAppViewMgr.C_TOOLBAR_TOP);
var a=t.getSize();
var e=a.y?a.y:t.getHtmlElement().clientHeight;
return e
}
}
if(AjxPackage.define("zimbraMail.share.controller.ZmController")){
ZmController=function(e,t){
if(arguments.length==0){
return
}
this._container=e;
this._app=t;
this._shell=appCtxt.getShell();
this._appViews={};
this._currentView=null;
this._authenticating=false
};
ZmController.prototype._setView=function(){};
ZmController.prototype.toString=function(){
return"ZmController"
};
ZmController.prototype.getApp=function(){
return this._app
};
ZmController.prototype.popupErrorDialog=function(e,c,u,l){
var s=appCtxt.getErrorDialog();
var a="";
if(typeof c=="string"){
a=c
}else{
if(c instanceof Object){
c.msg=c.msg||e;
var h=["method","msg","code","detail","trace","request","fileName","lineNumber","message","name","stack"];
var r=[],n=0;
r[n++]="<table>";
for(var o=0;
o<h.length;
o++){
var t=h[o];
var m=c[t];
if(m){
if(t=="request"){
m=["<pre>",m,"</pre>"].join("");
var d=document.getElementById(s._msgCellId);
if(d){
d.className="DwtMsgDialog-wide"
}}
r[n++]=["<tr><td valign='top'>",h[o],":</td><td valign='top'>",m,"</td></tr>"].join("")
}}
r[n++]="</table>";
a=r.join("")
}}
s.registerCallback(DwtDialog.OK_BUTTON,this._errorDialogCallback,this);
s.setMessage(e,a,DwtMessageDialog.CRITICAL_STYLE,ZmMsg.zimbraTitle);
s.popup(null,l)
};
ZmController.prototype.setCurrentView=function(e){
this._currentView=e
};
ZmController.prototype.getCurrentView=function(){
return this._currentView
};
ZmController.prototype.getKeyMapName=function(){
return"Global"
};
ZmController.prototype.handleKeyAction=function(l){
var a=this.getTabView?this.getTabView():null;
if(a&&a.handleKeyAction(l)){
return true
}
var e=ZmApp.ACTION_CODES_R[l];
if(e){
var n=ZmApp.ACTION_CODES[l];
if(n){
appCtxt.getApp(e).handleOp(n);
return true
}}
switch(l){
case ZmKeyMap.NEW:e=appCtxt.getCurrentAppName();
var r=ZmApp.NEW_ACTION_CODE[e];
if(r){
var n=ZmApp.ACTION_CODES[r];
if(n){
appCtxt.getApp(e).handleOp(n);
return true
}}
break;
case ZmKeyMap.NEW_FOLDER:case ZmKeyMap.NEW_TAG:var n=ZmApp.ACTION_CODES[l];
if(n){
this._newListener(null,n)
}
break;
case ZmKeyMap.SAVED_SEARCH:var s=appCtxt.getFolderTree().getByType(ZmOrganizer.SEARCH);
if(s&&s.length>0){
var h=appCtxt.getChooseFolderDialog();
var o={
treeIds:[ZmOrganizer.SEARCH],overviewId:h.getOverviewId(ZmOrganizer.SEARCH),title:ZmMsg.selectSearch};
ZmController.showDialog(h,new AjxCallback(null,ZmController._searchSelectionCallback,[h]),o)
}
break;
case ZmKeyMap.VISIT:var h=appCtxt.getChooseFolderDialog();
var t=ZmApp.ORGANIZER[this._app._name]||ZmOrganizer.FOLDER;
var o={
treeIds:[t],overviewId:h.getOverviewId(ZmOrganizer.APP[t]),appName:this._app._name,title:AjxMessageFormat.format(ZmMsg.goToFolder,ZmMsg[ZmOrganizer.MSG_KEY[t]])};
ZmController.showDialog(h,new AjxCallback(null,ZmController._visitOrgCallback,[h,t]),o);
break;
case ZmKeyMap.VISIT_TAG:if(appCtxt.getTagTree().size()>0){
var h=appCtxt.getPickTagDialog();
ZmController.showDialog(h,new AjxCallback(null,ZmController._visitOrgCallback,[h,ZmOrganizer.TAG]))
}
break;
default:return false
}
return true
};
ZmController._searchSelectionCallback=function(t,e){
if(e){
appCtxt.getSearchController().redoSearch(e.search)
}
t.popdown()
};
ZmController._visitOrgCallback=function(t,a,o){
if(o){
var e=appCtxt.getOverviewController().getTreeController(a);
if(e&&e._itemClicked){
e._itemClicked(o)
}}
t.popdown()
};
ZmController.prototype.mapSupported=function(e){
return false
};
ZmController.prototype._newListener=function(e,t){
switch(t){
case ZmOperation.NEW_FOLDER:ZmController.showDialog(appCtxt.getNewFolderDialog(),this.getNewFolderCallback());
break;
case ZmOperation.NEW_TAG:if(!this._newTagCb){
this._newTagCb=new AjxCallback(this,this._newTagCallback)
}
ZmController.showDialog(appCtxt.getNewTagDialog(),this._newTagCb);
break
}};
ZmController.prototype._newFolderCallback=function(s,o,t,a){
var n=appCtxt.getNewFolderDialog();
n.popdown();
var e=appCtxt.getOverviewController();
e.getTreeController(ZmOrganizer.FOLDER)._doCreate(s,o,t,a)
};
ZmController.prototype._newTagCallback=function(t){
appCtxt.getNewTagDialog().popdown();
var e=appCtxt.getOverviewController();
e.getTreeController(ZmOrganizer.TAG)._doCreate(t)
};
ZmController.prototype._createTabGroup=function(e){
e=e?e:this.toString();
this._tabGroup=new DwtTabGroup(e);
return this._tabGroup
};
ZmController.prototype._setTabGroup=function(e){
this._tabGroup=e
};
ZmController.prototype.getTabGroup=function(){
return this._tabGroup
};
ZmController.prototype.getNewFolderCallback=function(){
if(!this._newFolderCb){
this._newFolderCb=new AjxCallback(this,this._newFolderCallback)
}
return this._newFolderCb
};
ZmController.prototype._saveFocus=function(){
var t=appCtxt.getRootTabGroup().getFocusMember();
var e=this.getTabGroup();
this._savedFocusMember=(t&&e&&e.contains(t))?t:null;
return this._savedFocusMember
};
ZmController.prototype._restoreFocus=function(n,r){
var a=appCtxt.getRootTabGroup();
var t=appCtxt.getCurrentApp();
var s=t&&t.getOverviewId();
var o=s&&appCtxt.getOverviewController().getOverview(s);
if(a&&o&&(o!=ZmController._currentOverview)){
a.replaceMember(ZmController._currentOverview,o,false,false,null,true);
ZmController._currentOverview=o
}
var e=this.getTabGroup();
n=n||this._savedFocusMember||this._getDefaultFocusItem()||a.getFocusMember();
r=r||ZmController.noFocus;
ZmController.noFocus=false;
if(a&&e&&(e!=ZmController._currentAppViewTabGroup)){
a.replaceMember(ZmController._currentAppViewTabGroup,e,false,false,n,r);
ZmController._currentAppViewTabGroup=e
}else{
if(n&&!r){
appCtxt.getKeyboardMgr().grabFocus(n)
}}};
ZmController.prototype._getDefaultFocusItem=function(){
var e=this.getTabGroup();
return e?e.getFirstMember(true):null
};
ZmController.prototype._preHideCallback=function(){
this._saveFocus();
return true
};
ZmController.prototype._postShowCallback=function(){
this._restoreFocus();
return true
};
ZmController.prototype._handleError=function(t,e){
this._handleException(t,e)
};
ZmController.prototype._handleException=function(r,o){
if(r.code==AjxSoapException.INVALID_PDU){
r.code=ZmCsfeException.SVC_FAILURE;
r.detail=["contact your administrator (",r.msg,")"].join("");
r.msg="Service failure"
}
if(r.code==ZmCsfeException.SVC_AUTH_EXPIRED||r.code==ZmCsfeException.SVC_AUTH_REQUIRED||r.code==ZmCsfeException.NO_AUTH_TOKEN){
ZmCsfeCommand.clearAuthToken();
var c=false;
var n=appCtxt.getLoginDialog();
if(r.code==ZmCsfeException.SVC_AUTH_EXPIRED){
n.setError(ZmMsg.sessionExpired);
c=true
}else{
if(r.code==ZmCsfeException.SVC_AUTH_REQUIRED){
ZmZimbraMail.logOff();
return
}else{
n.setError(null)
}}
n.setReloginMode(c);
this._handleLogin(c,o);
return
}
if(r.code==ZmCsfeException.AUTH_TOKEN_CHANGED){
var l=AjxSoapDoc.create("GetInfoRequest","urn:zimbraAccount");
var e=l.getMethod();
e.setAttribute("sections","mbox");
var d=new AjxCallback(this,this._handleResponseGetInfo);
var a={
soapDoc:l,asyncMode:true,callback:d,skipAuthCheck:true};
ZmCsfeCommand._oldSessionId=ZmCsfeCommand._sessionId;
appCtxt.getAppController().sendRequest(a);
return
}
if(r.code==ZmCsfeException.MAIL_NO_SUCH_MSG){
var h=appCtxt.getCurrentViewId();
if(h==ZmId.VIEW_CONVLIST||h==ZmId.VIEW_TRAD){
appCtxt.getApp(ZmApp.MAIL).mailSearch();
return
}}
if(r.method!="NoOpRequest"){
var s;
if(r.code==ZmCsfeException.MAIL_NO_SUCH_ITEM){
s=r.data.itemId
}else{
if(r.code==ZmCsfeException.MAIL_SEND_FAILURE){
s=r.code
}}
var t=r.getErrorMsg?r.getErrorMsg(s):r.msg?r.msg:r.message;
this.popupErrorDialog(t,r,true,this._hideSendReportBtn(r))
}};
ZmController.prototype._handleLogin=function(t,e){
var a=appCtxt.get(ZmSetting.LOGIN_URL);
if(a){
ZmZimbraMail.sendRedirect(a);
return
}
var s=appCtxt.getUsername();
if(!s||appCtxt.isOffline){
ZmZimbraMail.logOff();
return
}
this._authenticating=true;
var n=appCtxt.getLoginDialog();
n.registerCallback(this._loginCallback,this,[e]);
n.setVisible(true,false);
try{
n.setFocus(s,t)
}
catch(o){}};
ZmController.prototype._loginCallback=function(e,o,t,a){
this._doAuth(e,o,t,a)
};
ZmController.prototype._doAuth=function(e,s,t,n){
var a=new ZmAuthenticate();
var o=new AjxCallback(this,this._handleResponseDoAuth,[e,n]);
a.execute(s,t,o)
};
ZmController.prototype._handleResponseDoAuth=function(t,n,e){
try{
e.getResponse();
this._authenticating=false;
appCtxt.rememberMe=n;
if(t){
if(t.continueCallback){
t.continueCallback.run()
}else{
t.resend=ZmCsfeCommand.REAUTH;
appCtxt.getRequestMgr().sendRequest(t)
}}else{
ZmCsfeCommand.setSessionId(null);
appCtxt.getAppController().startup({
isRelogin:true}
)
}
this._hideLoginDialog()
}
catch(o){
var a=appCtxt.getLoginDialog();
if(o.code==ZmCsfeException.ACCT_AUTH_FAILED||o.code==ZmCsfeException.SVC_INVALID_REQUEST){
a.setError(ZmMsg.loginError)
}else{
if(o.code==ZmCsfeException.ACCT_MAINTENANCE_MODE){
a.setError(ZmMsg.errorMaintenanceMode+" "+ZmMsg.errorContact)
}else{
this.popupErrorDialog(ZmMsg.errorGeneric,o)
}}}};
ZmController.prototype._hideLoginDialog=function(){
var e=appCtxt.getLoginDialog();
e.setVisible(false);
e.setError(null);
e.clearPassword()
};
ZmController.prototype._handleResponseGetInfo=function(e){
var a=e.getResponse();
var n=a.GetInfoResponse;
if(appCtxt.isOffline){
if(location.search.indexOf("offlineHack")!=-1){
var s="old user: "+appCtxt.getUsername()+"\nold auth token: "+ZmCsfeCommand._curAuthToken+"\nold session ID: "+ZmCsfeCommand._oldSessionId+"\n\nnew user: "+n.name+"\nnew auth token: "+ZmCsfeCommand.getAuthToken()+"\nnew session ID: "+ZmCsfeCommand._sessionId+"\n";
alert(s)
}}else{
if(n.name!=appCtxt.getUsername()){
var o=appCtxt.getLoginDialog();
o.registerCallback(this._loginCallback,this);
o.setError(ZmMsg.authChanged);
var t=false;
o.setReloginMode(t);
this._handleLogin(t)
}else{}}};
ZmController.prototype._hideSendReportBtn=function(e){
return(e.code==ZmCsfeException.MAIL_TOO_MANY_TERMS||e.code==ZmCsfeException.MAIL_MAINTENANCE_MODE||e.code==ZmCsfeException.MAIL_MESSAGE_TOO_BIG||e.code==ZmCsfeException.NETWORK_ERROR||e.code==ZmCsfeException.EMPTY_RESPONSE||e.code==ZmCsfeException.BAD_JSON_RESPONSE||e.code==ZmCsfeException.TOO_MANY_TAGS||e.code==ZmCsfeException.OFFLINE_ONLINE_ONLY_OP)
};
ZmController.prototype._errorDialogCallback=function(){
appCtxt.getErrorDialog().popdown()
};
ZmController.showDialog=function(e,o,a,t){
e.reset(t);
e.registerCallback(DwtDialog.OK_BUTTON,o);
e.popup(a,t)
};
ZmController.prototype._clearDialog=function(e){
e.popdown();
this._pendingActionData=null
};
ZmController.prototype._menuPopdownActionListener=function(){};
ZmController.prototype.setSessionId=function(e,t){
this.sessionId=t;
this.viewId=[e,this.sessionId].join("")
};
ZmController.prototype.isTransient=function(e,t){
return false
}
}
if(AjxPackage.define("zimbraMail.share.controller.ZmListController")){
ZmListController=function(e,t){
if(arguments.length==0){
return
}
ZmController.call(this,e,t);
this._toolbar={};
this._navToolBar={};
this._listView={};
this._tabGroups={};
this._list=null;
this._actionMenu=null;
this._actionEv=null;
this._activeSearch=null;
this._tagList=appCtxt.getTagTree();
if(this._tagList){
this._tagChangeLstnr=new AjxListener(this,this._tagChangeListener);
this._tagList.addChangeListener(this._tagChangeLstnr)
}
this._listeners={};
this._listeners[ZmOperation.NEW_MENU]=new AjxListener(this,this._newListener);
this._listeners[ZmOperation.TAG_MENU]=new AjxListener(this,this._tagButtonListener);
this._listeners[ZmOperation.TAG]=new AjxListener(this,this._tagListener);
this._listeners[ZmOperation.PRINT]=new AjxListener(this,this._printListener);
this._listeners[ZmOperation.DELETE]=new AjxListener(this,this._deleteListener);
this._listeners[ZmOperation.CLOSE]=new AjxListener(this,this._backListener);
this._listeners[ZmOperation.MOVE]=new AjxListener(this,this._moveListener);
this._listeners[ZmOperation.SEARCH]=new AjxListener(this,this._participantSearchListener);
this._listeners[ZmOperation.BROWSE]=new AjxListener(this,this._participantBrowseListener);
this._listeners[ZmOperation.NEW_MESSAGE]=new AjxListener(this,this._participantComposeListener);
if(window.ZmImApp){
this._listeners[ZmOperation.IM]=ZmImApp.getImMenuItemListener()
}
this._listeners[ZmOperation.CONTACT]=new AjxListener(this,this._participantContactListener);
this._listeners[ZmOperation.VIEW]=new AjxListener(this,this._viewMenuItemListener);
this._menuPopdownListener=new AjxListener(this,this._menuPopdownActionListener);
this._dropTgt=new DwtDropTarget("ZmTag");
this._dropTgt.markAsMultiple();
this._dropTgt.addDropListener(new AjxListener(this,this._dropListener));
this._itemCountText={};
this._continuation={
count:0,totalItems:0}
};
ZmListController.prototype=new ZmController;
ZmListController.prototype.constructor=ZmListController;
ZmListController.CONTINUATION_SEARCH_ITEMS=500;
ZmListController.prototype.toString=function(){
return"ZmListController"
};
ZmListController.prototype.show=function(t,e){
this._currentView=e||this._defaultView();
this._activeSearch=t;
if(t){
this._currentSearch=t.search
}
this.currentPage=1;
this.maxPage=1
};
ZmListController.prototype.getSearchString=function(){
return this._currentSearch?this._currentSearch.query:""
};
ZmListController.prototype.getSearchStringHint=function(){
return this._currentSearch?this._currentSearch.queryHint:""
};
ZmListController.prototype.getCurrentView=function(){
return this._listView[this._currentView]
};
ZmListController.prototype.getCurrentToolbar=function(){
return this._toolbar[this._currentView]
};
ZmListController.prototype.getList=function(){
return this._list
};
ZmListController.prototype.setList=function(e){
if(e!=this._list&&(e instanceof ZmList)){
if(this._list){
this._list.clear()
}
this._list=e
}};
ZmListController.prototype.setHasMore=function(e){
if(e){
this._list.setHasMore(e);
this._resetNavToolBarButtons(this._currentView)
}};
ZmListController.prototype.handleKeyAction=function(s){
var a=this._listView[this._currentView];
switch(s){
case DwtKeyMap.DBLCLICK:return a.handleKeyAction(s);
case ZmKeyMap.DEL:var t=this._toolbar[this._currentView];
var n=t&&(t.getButton(ZmOperation.DELETE)||t.getButton(ZmOperation.DELETE_MENU));
if(n&&n.getEnabled()){
this._doDelete(this._listView[this._currentView].getSelection())
}
break;
case ZmKeyMap.FLAG:this._doFlag(a.getSelection());
break;
case ZmKeyMap.MOVE:this._moveListener.call(this);
break;
case ZmKeyMap.NEXT_PAGE:var e=this._navToolBar[this._currentView];
var n=e?e.getButton(ZmOperation.PAGE_FORWARD):null;
if(n&&n.getEnabled()){
this._paginate(this._currentView,true)
}
break;
case ZmKeyMap.PREV_PAGE:var e=this._navToolBar[this._currentView];
var n=e?e.getButton(ZmOperation.PAGE_BACK):null;
if(n&&n.getEnabled()){
this._paginate(this._currentView,false)
}
break;
case ZmKeyMap.PRINT:if(appCtxt.get(ZmSetting.PRINT_ENABLED)){
this._printListener()
}
break;
case ZmKeyMap.TAG:var o=a.getSelection();
if(o&&o.length&&(appCtxt.getTagTree().size()>0)){
var r=appCtxt.getPickTagDialog();
ZmController.showDialog(r,new AjxCallback(this,this._tagSelectionCallback,[o,r]))
}
break;
case ZmKeyMap.UNTAG:if(appCtxt.get(ZmSetting.TAGGING_ENABLED)){
var o=a.getSelection();
if(o&&o.length){
this._doRemoveAllTags(o)
}}
break;
default:return ZmController.prototype.handleKeyAction.call(this,s)
}
return true
};
ZmListController.prototype._createNewView=function(){};
ZmListController.prototype._getViewType=function(){};
ZmListController.prototype._defaultView=function(){
return this._getViewType()
};
ZmListController.prototype._setViewContents=function(e){};
ZmListController.prototype._getTagMenuMsg=function(e){};
ZmListController.prototype._getMoveDialogTitle=function(e){};
ZmListController.prototype._getToolBarOps=function(){};
ZmListController.prototype._getActionMenuOps=function(){};
ZmListController.prototype._setup=function(e){
this._initialize(e);
this._resetOperations(this._toolbar[e],0)
};
ZmListController.prototype._initialize=function(e){
this._initializeToolBar(e);
this._initializeListView(e);
this._initializeTabGroup(e)
};
ZmListController.prototype._standardToolBarOps=function(){
return[ZmOperation.NEW_MENU,ZmOperation.SEP,ZmOperation.DELETE,ZmOperation.MOVE,ZmOperation.PRINT]
};
ZmListController.prototype._standardActionMenuOps=function(){
return[ZmOperation.TAG_MENU,ZmOperation.DELETE,ZmOperation.MOVE,ZmOperation.PRINT]
};
ZmListController.prototype._participantOps=function(){
var e=[ZmOperation.SEARCH,ZmOperation.BROWSE];
if(ZmSetting.MAIL_ENABLED){
e.push(ZmOperation.NEW_MESSAGE)
}
if(ZmSetting.IM_ENABLED){
e.push(ZmOperation.IM)
}
if(ZmSetting.CONTACTS_ENABLED){
e.push(ZmOperation.CONTACT)
}
return e
};
ZmListController.prototype._initializeToolBar=function(t){
if(this._toolbar[t]){
return
}
var n=this._getToolBarOps();
if(!n){
return
}
var e=this._toolbar[t]=new ZmButtonToolBar({
parent:this._container,buttons:n,context:t,controller:this,refElementId:ZmId.SKIN_APP_TOP_TOOLBAR}
);
var o;
for(var a=0;
a<e.opList.length;
a++){
o=e.opList[a];
if(this._listeners[o]){
e.addSelectionListener(o,this._listeners[o])
}}
o=e.getButton(ZmOperation.PRINT);
if(o){
o.setText(null)
}
o=e.getButton(ZmOperation.MOVE);
if(o){
o.setText(null)
}
o=e.getButton(ZmOperation.NEW_MENU);
if(o){
var s=new AjxListener(e,ZmListController._newDropDownListener);
o.addDropDownSelectionListener(s);
e._ZmListController_this=this;
e._ZmListController_newDropDownListener=s
}
o=e.getButton(ZmOperation.TAG_MENU);
if(o){
o.noMenuBar=true;
this._setupTagMenu(e)
}
appCtxt.notifyZimlets("initializeToolbar",[this._app,e,this,t],{
waitUntilLoaded:true}
)
};
ZmListController.prototype._initializeListView=function(e){
if(this._listView[e]){
return
}
this._listView[e]=this._createNewView(e);
this._listView[e].addSelectionListener(new AjxListener(this,this._listSelectionListener));
this._listView[e].addActionListener(new AjxListener(this,this._listActionListener))
};
ZmListController.prototype._initializeActionMenu=function(){
if(this._actionMenu){
return
}
var e=this._getActionMenuOps();
if(!e){
return
}
this._actionMenu=new ZmActionMenu({
parent:this._shell,menuItems:e,context:this._getMenuContext(),controller:this}
);
this._addMenuListeners(this._actionMenu);
if(appCtxt.get(ZmSetting.TAGGING_ENABLED)){
this._setupTagMenu(this._actionMenu)
}};
ZmListController.prototype._addMenuListeners=function(o){
var t=o.opList;
for(var e=0;
e<t.length;
e++){
var a=t[e];
if(this._listeners[a]){
o.addSelectionListener(a,this._listeners[a],0)
}}
o.addPopdownListener(this._menuPopdownListener)
};
ZmListController.prototype._initializeTabGroup=function(e){
if(this._tabGroups[e]){
return
}
this._tabGroups[e]=this._createTabGroup();
this._tabGroups[e].newParent(appCtxt.getRootTabGroup());
this._toolbar[e].noFocus=true;
this._tabGroups[e].addMember(this._listView[e])
};
ZmListController.prototype._setView=function(a){
var e=a.view;
if(!this._appViews[e]){
var t={};
t[ZmAppViewMgr.CB_PRE_HIDE]=this._preHideCallback?new AjxCallback(this,this._preHideCallback):null;
t[ZmAppViewMgr.CB_PRE_UNLOAD]=this._preUnloadCallback?new AjxCallback(this,this._preUnloadCallback):null;
t[ZmAppViewMgr.CB_POST_HIDE]=this._postHideCallback?new AjxCallback(this,this._postHideCallback):null;
t[ZmAppViewMgr.CB_PRE_SHOW]=this._preShowCallback?new AjxCallback(this,this._preShowCallback):null;
t[ZmAppViewMgr.CB_POST_SHOW]=this._postShowCallback?new AjxCallback(this,this._postShowCallback):null;
a.callbacks=t;
a.viewId=e;
this._app.createView(a);
this._appViews[e]=1
}
if(!a.pushOnly){
this._setViewContents(e)
}
if(a.stageView){
this._app.stageView(e)
}else{
return(a.clear?this._app.setView(e):this._app.pushView(e))
}};
ZmListController.prototype._listSelectionListener=function(e){
if(e.field==ZmItem.F_FLAG){
this._doFlag([e.item])
}else{
var t=this._listView[this._currentView];
if(appCtxt.get(ZmSetting.SHOW_SELECTION_CHECKBOX)){
if(!e.ctrlKey){
t.setSelectionHdrCbox(false)
}}
this._resetOperations(this._toolbar[this._currentView],t.getSelectionCount())
}};
ZmListController.prototype._listActionListener=function(e){
this._actionEv=e;
var t=this.getActionMenu();
if(appCtxt.get(ZmSetting.TAGGING_ENABLED)){
this._setTagMenu(t)
}
this._resetOperations(t,this._listView[this._currentView].getSelectionCount())
};
ZmListController.prototype._menuPopdownActionListener=function(){
if(!this._pendingActionData){
this._listView[this._currentView].handleActionPopdown()
}};
ZmListController.prototype._newListener=function(e,o,a){
if(!e&&!o){
return
}
o=o||e.item.getData(ZmOperation.KEY_ID);
if(!o||o==ZmOperation.NEW_MENU){
o=this._defaultNewId
}
var t=ZmApp.OPS_R[o];
if(t){
a=a||{};
a.ev=e;
appCtxt.getApp(t).handleOp(o,a)
}else{
ZmController.prototype._newListener.call(this,e,o)
}};
ZmListController.prototype._tagButtonListener=function(t){
var e=this._toolbar[this._currentView];
if(t.item.parent==e){
this._setTagMenu(e)
}};
ZmListController.prototype._tagListener=function(t){
if(appCtxt.getAppViewMgr().getCurrentViewId()==this._getViewType()){
var n=t.getData(ZmTagMenu.KEY_TAG_EVENT);
var o=t.getData(ZmTagMenu.KEY_TAG_ADDED);
var e=this._listView[this._currentView].getSelection();
if(n==ZmEvent.E_TAGS&&o){
this._doTag(e,t.getData(Dwt.KEY_OBJECT),true)
}else{
if(n==ZmEvent.E_CREATE){
this._pendingActionData=e;
var a=appCtxt.getNewTagDialog();
if(!this._newTagCb){
this._newTagCb=new AjxCallback(this,this._newTagCallback)
}
ZmController.showDialog(a,this._newTagCb);
a.registerCallback(DwtDialog.CANCEL_BUTTON,this._clearDialog,this,a)
}else{
if(n==ZmEvent.E_TAGS&&!o){
this._doTag(e,t.getData(Dwt.KEY_OBJECT),false)
}else{
if(n==ZmEvent.E_REMOVE_ALL){
this._doRemoveAllTags(e)
}}}}}};
ZmListController.prototype._tagSelectionCallback=function(t,a,e){
if(e){
this._doTag(t,e,true)
}
a.popdown()
};
ZmListController.prototype._printListener=function(o){
var e=this._listView[this._currentView];
var t=e.getSelection();
var a=(t instanceof Array)?t[0]:t;
window.open(a.getRestUrl(),"_blank")
};
ZmListController.prototype._backListener=function(e){
this._app.popView()
};
ZmListController.prototype._deleteListener=function(e){
this._doDelete(this._listView[this._currentView].getSelection())
};
ZmListController.prototype._moveListener=function(e,a){
this._pendingActionData=a||(this._listView[this._currentView].getSelection());
var t=appCtxt.getChooseFolderDialog();
if(!this._moveCb){
this._moveCb=new AjxCallback(this,this._moveCallback)
}
ZmController.showDialog(t,this._moveCb,this._getMoveParams(t));
t.registerCallback(DwtDialog.CANCEL_BUTTON,this._clearDialog,this,t)
};
ZmListController.prototype._getMoveParams=function(e){
var t=ZmApp.ORGANIZER[this._app._name]||ZmOrganizer.FOLDER;
return{
overviewId:e.getOverviewId(this._app._name),data:this._pendingActionData,treeIds:[t],title:this._getMoveDialogTitle(this._pendingActionData.length),description:ZmMsg.targetFolder,treeStyle:DwtTree.SINGLE_STYLE,appName:this._app._name}
};
ZmListController.prototype._viewMenuItemListener=function(e){
if(e.detail==DwtMenuItem.CHECKED||e.detail==DwtMenuItem.UNCHECKED){
this.switchView(e.item.getData(ZmOperation.MENUITEM_ID))
}};
ZmListController.prototype._navBarListener=function(e){
if(appCtxt.getAppViewMgr().getCurrentViewId()!=this._getViewType()){
return
}
var t=e.item.getData(ZmOperation.KEY_ID);
if(t==ZmOperation.PAGE_BACK||t==ZmOperation.PAGE_FORWARD){
this._paginate(this._currentView,(t==ZmOperation.PAGE_FORWARD))
}};
ZmListController.prototype._participantSearchListener=function(t){
var e=this._actionEv.address.getAddress();
appCtxt.getSearchController().fromSearch(e)
};
ZmListController.prototype._participantBrowseListener=function(t){
var e=this._actionEv.address.getAddress();
appCtxt.getSearchController().fromBrowse(e)
};
ZmListController.prototype._participantComposeListener=function(t){
var e=this._actionEv.address.toString(AjxEmailAddress.SEPARATOR)+AjxEmailAddress.SEPARATOR;
AjxDispatcher.run("Compose",{
action:ZmOperation.NEW_MESSAGE,inNewWindow:this._app._inNewWindow(t),toOverride:e}
)
};
ZmListController.prototype._participantContactListener=function(t){
var e=new AjxCallback(this,this._handleLoadParticipantContactListener);
AjxDispatcher.require(["ContactsCore","Contacts"],false,e,null,true)
};
ZmListController.prototype._handleLoadParticipantContactListener=function(){
var a=AjxDispatcher.run("GetContactController");
if(this._actionEv.contact){
if(this._actionEv.contact.isLoaded){
a.show(this._actionEv.contact)
}else{
var t=new AjxCallback(this,this._loadContactCallback);
this._actionEv.contact.load(t)
}}else{
var e=this._createNewContact(this._actionEv);
a.show(e,true)
}};
ZmListController.prototype._createNewContact=function(t){
var e=new ZmContact(null);
e.initFromEmail(t.address);
return e
};
ZmListController.prototype._loadContactCallback=function(t,e){
AjxDispatcher.run("GetContactController").show(e)
};
ZmListController.prototype._dragListener=function(e){
if(e.action==DwtDragEvent.SET_DATA){
e.srcData={
data:e.srcControl.getDnDSelection(),controller:this}
}};
ZmListController.prototype._dropListener=function(n){
var e=this._listView[this._currentView];
var h=e.getTargetItemDiv(n.uiEvent);
var o=e.getItemFromElement(h);
var r=n.srcData.data;
if(n.action==DwtDropEvent.DRAG_ENTER){
n.doIt=(o&&(o instanceof ZmItem)&&!o.isShared()&&this._dropTgt.isValidTarget(r));
e.dragSelect(h)
}else{
if(n.action==DwtDropEvent.DRAG_DROP){
e.dragDeselect(h);
var t=[o];
var s=e.getSelection();
if(s.length){
var a=AjxVector.fromArray(s);
if(a.contains(o)){
t=s
}}
this._doTag(t,r,true)
}else{
if(n.action==DwtDropEvent.DRAG_LEAVE){
e.dragDeselect(h)
}else{
if(n.action==DwtDropEvent.DRAG_OP_CHANGED){}}}}};
ZmListController.prototype._tagChangeListener=function(t){
if(appCtxt.getAppViewMgr().getCurrentViewId()==this._getViewType()){
if(t.type==ZmEvent.S_TAG&&t.event==ZmEvent.E_CREATE&&this._pendingActionData){
var e=t.getDetail("organizers")[0];
this._doTag(this._pendingActionData,e,true);
this._pendingActionData=null;
this._menuPopdownActionListener()
}}};
ZmListController.prototype._moveCallback=function(e){
this._doMove(this._pendingActionData,e);
this._clearDialog(appCtxt.getChooseFolderDialog());
this._pendingActionData=null
};
ZmListController.prototype._doFlag=function(a,t){
a=AjxUtil.toArray(a);
if(!a.length){
return
}
if(t!==true&&t!==false){
t=!a[0].isFlagged
}
var e=[];
for(var o=0;
o<a.length;
o++){
if(a[o].isFlagged!=t){
e.push(a[o])
}}
var s={
items:e,op:"flag",value:t};
var n=this._setupContinuation(this._doFlag,[t],s);
n.flagItems(s)
};
ZmListController.prototype._doTag=function(t,e,n){
t=AjxUtil.toArray(t);
if(!t.length){
return
}
var o={
items:t,tagId:e.id,doTag:n};
var a=this._setupContinuation(this._doTag,[e,n],o);
a.tagItems(o)
};
ZmListController.prototype._doRemoveAllTags=function(e){
e=AjxUtil.toArray(e);
if(!e.length){
return
}
var a={
items:e};
var t=this._setupContinuation(this._doRemoveAllTags,null,a);
t.removeAllTags(a)
};
ZmListController.prototype._doDelete=function(t,e,a){
t=AjxUtil.toArray(t);
if(!t.length){
return
}
var s={
items:t,hardDelete:e,attrs:a,childWin:appCtxt.isChildWindow&&window};
var n=new AjxCallback(this,this._checkItemCount);
var o=this._setupContinuation(this._doDelete,[e,a],s,n);
o.deleteItems(s)
};
ZmListController.prototype._doMove=function(h,t,l,s){
h=AjxUtil.toArray(h);
if(!h.length){
return
}
var a=[];
var e=[];
for(var n=0;
n<h.length;
n++){
var c=h[n];
if(!c.folderId||c.folderId!=t.id){
if(!this._isItemMovable(c,s,t)){
e.push(c)
}else{
a.push(c)
}}}
var o={
folder:t,attrs:l};
var d=new AjxCallback(this,this._checkItemCount);
if(a.length){
o.items=a;
var r=this._setupContinuation(this._doMove,[t,l,s],o,d);
r.moveItems(o)
}
if(e.length){
o.items=e;
var r=this._setupContinuation(this._doMove,[t,l,s],o,d);
r.copyItems(o)
}};
ZmListController.prototype._isItemMovable=function(a,e,t){
return(!e&&!a.isReadOnly()&&!t.isReadOnly())
};
ZmListController.prototype._doModify=function(t,e){
var a=t.list||this._list;
a.modifyItem(t,e)
};
ZmListController.prototype._doCreate=function(t,e){
t.create(e)
};
ZmListController.prototype._propagateMenuListeners=function(n,h,s){
if(!n){
return
}
s=s||this._listeners[h];
var o=n.getOp(h);
if(o){
var r=o.getMenu();
var e=r.getItems();
var a=r.getItemCount();
for(var t=0;
t<a;
t++){
e[t].addSelectionListener(s)
}}};
ZmListController.prototype._setupTagMenu=function(t){
if(!t){
return
}
var a=t.getTagMenu();
if(a){
a.addSelectionListener(this._listeners[ZmOperation.TAG])
}
if(t instanceof ZmButtonToolBar){
var e=t.getOp(ZmOperation.TAG_MENU);
if(e){
e.addDropDownSelectionListener(this._listeners[ZmOperation.TAG_MENU])
}}};
ZmListController.prototype._setTagMenu=function(o){
if(!o){
return
}
var a=o.getOp(ZmOperation.TAG_MENU);
if(a){
var n=o.getTagMenu();
var t=this._listView[this._currentView].getSelection();
t=AjxUtil.toArray(t);
n.set(t,appCtxt.getTagTree());
if(o instanceof ZmActionMenu){
a.setText(this._getTagMenuMsg(t.length))
}else{
n.parent.popup();
if(appCtxt.isChildWindow){
var e=n.getMenuItem(ZmTagMenu.MENU_ITEM_ADD_ID);
if(e){
e.setVisible(false)
}}}}};
ZmListController.prototype._setNewButtonProps=function(e,a,s,n,t){
var o=this._toolbar[e].getButton(ZmOperation.NEW_MENU);
if(o){
o.setToolTipContent(a);
o.setImage(s);
this._defaultNewId=t
}};
ZmListController.prototype._setContactText=function(t){
var e=t?ZmOperation.EDIT_CONTACT:ZmOperation.NEW_CONTACT;
var a=t?null:ZmMsg.AB_ADD_CONTACT;
ZmOperation.setOperation(this._toolbar[this._currentView],ZmOperation.CONTACT,e,ZmMsg.AB_ADD_CONTACT);
ZmOperation.setOperation(this.getActionMenu(),ZmOperation.CONTACT,e,a)
};
ZmListController.prototype._resetOperations=function(a,t){
if(!a){
return
}
if(t==0){
a.enableAll(false);
a.enable(ZmOperation.NEW_MENU,true)
}else{
if(t==1){
a.enableAll(true)
}else{
if(t>1){
a.enableAll(false);
a.enable([ZmOperation.NEW_MENU,ZmOperation.TAG_MENU,ZmOperation.DELETE,ZmOperation.MOVE,ZmOperation.FORWARD],true)
}}}
var e=(t>0)&&this._getSearchFolderId();
var o=e&&appCtxt.getById(e);
if(o&&o.isRemote()){
a.enable(ZmOperation.TAG_MENU,false)
}};
ZmListController.prototype._resetToolbarOperations=function(){
this._resetOperations(this._toolbar[this._currentView],this._listView[this._currentView].getSelectionCount())
};
ZmListController.prototype._getSearchFolderId=function(){
return(this._activeSearch&&this._activeSearch.search)?this._activeSearch.search.folderId:null
};
ZmListController.prototype._cacheList=function(e,a){
if(this._list){
var t=e.getResults().getVector();
a=a?a:parseInt(e.getAttribute("offset"));
this._list.cache(a,t)
}else{
this._list=e.getResults(type)
}};
ZmListController.prototype._search=function(r,n,o,h,e,t,s){
var a={
query:this.getSearchString(),queryHint:this.getSearchStringHint(),types:((this._activeSearch&&this._activeSearch.search)?this._activeSearch.search.types:[]),sortBy:appCtxt.get(ZmSetting.SORTING_PREF,r),offset:n,limit:o,lastId:t,lastSortVal:s};
this._getMoreSearchParams(a);
var l=new ZmSearch(a);
if(e){
this._currentSearch=l
}
appCtxt.getSearchController().redoSearch(l,true,null,h)
};
ZmListController.prototype._paginate=function(c,r,s,o){
var a=false;
var t=this._listView[c];
var n,d;
if(t._isPageless){
n=this._list.size();
a=true
}else{
n=t.getNewOffset(r);
a=(n+o>this._list.size());
this.currentPage=this.currentPage+(r?1:-1);
this.maxPage=Math.max(this.maxPage,this.currentPage)
}
o=o||t.getLimit(n);
if(a&&this._list.hasMore()){
t.offset=n;
if(t._isPageless){
d=o
}else{
var m=(n+o)-this._list.size();
d=m<o&&m>0?m:o;
if(d<o){
n=((n+o)-d)+1
}}
if(this._searchPending){
return false
}
var l=t.getList();
var u=l&&l.getLast();
var h=(u&&u.id)?u.sf:null;
var e=h?u.id:null;
this._setItemCountText(ZmMsg.loading);
this._searchPending=true;
var f=new AjxCallback(this,this._handleResponsePaginate,[c,false,s,n]);
this._search(c,n,d,f,true,e,h);
return false
}else{
if(!t._isPageless){
t.offset=n;
this._resetOperations(this._toolbar[c],0);
this._resetNavToolBarButtons(c);
this._setViewContents(c);
this._resetSelection();
return true
}}};
ZmListController.prototype._handleResponsePaginate=function(l,o,r,s,c,e){
var h=c.getResponse();
this._list.setHasMore(h.getAttribute("more"));
this._cacheList(h,s);
this._resetOperations(this._toolbar[l],0);
var a=this._listView[this._currentView];
var t=o?a.getSelection()[0]:null;
var n=t?a.getItemIndex(t):-1;
if(a._isPageless){
a._itemsToAdd=h&&h.getResults().getArray()
}
this._setViewContents(l);
this._resetNavToolBarButtons(l);
if(!e&&!a._isPageless){
this._resetSelection(n)
}
appCtxt.getAppController().focusContentPane();
this._searchPending=false
};
ZmListController.prototype._getMoreSearchParams=function(e){};
ZmListController.prototype._checkReplenish=function(n){
var e=this._listView[this._currentView];
var o=e.getList();
var t=false;
if(o){
var a=e.getLimit()-e.size();
if(a>e.getReplenishThreshold()){
this._replenishList(this._currentView,a,n);
t=true
}}
if(n&&!t){
n.run()
}};
ZmListController.prototype._handleEmptyList=function(e){
if(this.currentPage>1){
this._paginate(this._currentView,false,0)
}else{
e.removeAll(true);
e._setNoResultsHtml();
this._resetNavToolBarButtons(this._currentView)
}};
ZmListController.prototype._replenishList=function(r,a,h){
var t=this._listView[r].offset+this._listView[r].size();
var l=this._list.size();
if(t<l){
var s=(s>l)?l:(t+a);
var n=this._list.getVector().getArray();
var o=n.slice(t,s);
var e=AjxVector.fromArray(o);
this._listView[r].replenish(e);
if(h){
h.run()
}}else{
this._getMoreToReplenish(r,a,h)
}};
ZmListController.prototype._resetSelection=function(t){
var a=this._listView[this._currentView].getList();
if(a){
var e=t>=0?t:0;
var o=a.get(e);
this._listView[this._currentView].setSelection(o,false)
}};
ZmListController.prototype._getMoreToReplenish=function(t,n,h){
if(this._list.hasMore()){
var o=this._listView[t].getList();
var a=o.getLast();
var e=(a&&a.id)?a.sf:null;
var s=e?a.id:null;
var r=new AjxCallback(this,this._handleResponseGetMoreToReplenish,[t,h]);
this._search(t,this._list.size(),n,r,false,s,e)
}else{
if(h){
h.run()
}}};
ZmListController.prototype._handleResponseGetMoreToReplenish=function(a,s,t){
var e=t.getResponse();
var o=e.getAttribute("more");
this._list.setHasMore(o);
this._cacheList(e);
var n=e.getResults().getVector();
this._listView[a].replenish(n);
this._toolbar[a].enable(ZmOperation.PAGE_FORWARD,o);
if(s){
s.run(t)
}};
ZmListController.prototype._initializeNavToolBar=function(t){
var e=new ZmNavToolBar({
parent:this._toolbar[t],context:t}
);
this._setNavToolBar(e,t)
};
ZmListController.prototype._setNavToolBar=function(t,e){
this._navToolBar[e]=t;
if(this._navToolBar[e]){
var a=new AjxListener(this,this._navBarListener);
this._navToolBar[e].addSelectionListener(ZmOperation.PAGE_BACK,a);
this._navToolBar[e].addSelectionListener(ZmOperation.PAGE_FORWARD,a)
}};
ZmListController.prototype._resetNavToolBarButtons=function(e){
var t=this._listView[e];
if(t._isPageless){
this._setItemCountText()
}
if(!this._navToolBar[e]){
return
}
this._navToolBar[e].enable(ZmOperation.PAGE_BACK,t.offset>0);
var a=false;
if(this._list){
a=this._list.hasMore();
if(!a&&((t.offset+t.getLimit())<this._list.size())){
a=true
}}
this._navToolBar[e].enable(ZmOperation.PAGE_FORWARD,a);
this._navToolBar[e].setText(this._getNavText(e))
};
ZmListController.prototype.enablePagination=function(t,e){
if(!this._navToolBar[e]){
return
}
if(t){
this._resetNavToolBarButtons(e)
}else{
this._navToolBar[e].enable([ZmOperation.PAGE_BACK,ZmOperation.PAGE_FORWARD],false)
}};
ZmListController.prototype._getNavText=function(e){
var o=this._getNavStartEnd(e);
if(!o){
return""
}
var a=this._getNumTotal();
var t=a?ZmMsg.navText2:ZmMsg.navText1;
return AjxMessageFormat.format(t,[o.start,o.end,a])
};
ZmListController.prototype._getNavStartEnd=function(a){
var n=this._listView[a];
var t=n.getLimit();
var o=this._list?this._list.size():0;
var s,e;
if(o>0){
s=n.offset+1;
e=Math.min(n.offset+t,o)
}
return(s&&e)?{
start:s,end:e}
:null
};
ZmListController.prototype._getNumTotal=function(){
var e=this._getSearchFolderId();
if(e&&(e!=ZmFolder.ID_TRASH)){
var t=appCtxt.getById(e);
if(t){
return t.numTotal
}}
return null
};
ZmListController._newDropDownListener=function(o){
var a=this;
var e=a._ZmListController_this;
e._propagateMenuListeners(a,ZmOperation.NEW_MENU);
var t=a.getButton(ZmOperation.NEW_MENU);
var n=a._ZmListController_newDropDownListener;
t.removeDropDownSelectionListener(n);
t.popup();
delete a._ZmListController_this;
delete a._ZmListController_newDropDownListener
};
ZmListController.prototype._getDefaultFocusItem=function(){
return this._listView[this._currentView]
};
ZmListController.prototype.getActionMenu=function(){
if(!this._actionMenu){
this._initializeActionMenu();
this._resetOperations(this._actionMenu,0)
}
return this._actionMenu
};
ZmListController.prototype._getMenuContext=function(){
return this._app&&this._app._name
};
ZmListController.prototype._getItemCountText=function(){
var h=this._listView[this._currentView];
var s=h&&h._list;
if(!s){
return""
}
var a=h&&h.type;
var t=s.size();
var n=this._getNumTotal();
var e=n||t;
var o=!a?"items":(e==1)?ZmItem.MSG_KEY[a]:ZmItem.PLURAL_MSG_KEY[a];
if(n){
return AjxMessageFormat.format(ZmMsg.itemCount1,[t,n,ZmMsg[o]])
}else{
var r=s.size()+(this._list.hasMore()?"+":"");
return AjxMessageFormat.format(ZmMsg.itemCount,[r,ZmMsg[o]])
}};
ZmListController.prototype._setItemCountText=function(t){
t=t||this._getItemCountText();
var e=this._itemCountText[this._currentView];
if(e){
e.setText(t)
}};
ZmListController.prototype._setupContinuation=function(o,a,r,s){
var e=new AjxCallback(this,o,a);
r.finalCallback=new AjxCallback(this,this._continueAction,{
actionCallback:e,allDoneCallback:s}
);
r.count=this._continuation.count;
var t=r.items;
var n=(t&&(t instanceof Array)&&t.length&&t[0].list)||this._list;
if(!this._continuation.lastItem){
this._continuation.lastItem=n.getVector().getLast();
this._continuation.totalItems=n.size()
}
return n
};
ZmListController.prototype._continueAction=function(o,t){
var a=this._listView[this._currentView];
var r=t&&t.cancelled;
var p=this._continuation.result;
var e=p?p.getAttribute("more"):this._list.hasMore();
if(a.allSelected&&e&&!r){
var h=this._currentSearch;
var n=ZmListController.CONTINUATION_SEARCH_ITEMS;
var u={
query:this.getSearchString(),queryHint:this.getSearchStringHint(),types:h.types,sortBy:h.sortBy,limit:n};
var l=p?p.getResults().getArray():this._list.getArray();
var d=this._continuation.lastItem;
if(!d){
d=l&&l[l.length-1]
}
if(d){
u.lastId=d.id;
u.lastSortVal=d.sf
}else{
u.offset=n+(this._continuation.search?this._continuation.search.offset:0)
}
this._continuation.count=t.numItems;
if(!this._continuation.totalItems){
this._continuation.totalItems=l.length
}
this._continuation.search=new ZmSearch(u);
var f=new AjxCallback(this,this._handleResponseContinueAction,[o.actionCallback]);
appCtxt.getSearchController().redoSearch(this._continuation.search,true,null,f)
}else{
if(p){
if(a.allSelected){
var s=ZmItem.PLURAL_MSG_KEY[p.type]||"items";
var m=AjxMessageFormat.format(ZmMsg.itemsProcessed,[this._continuation.totalItems,ZmMsg[s]]);
appCtxt.setStatusMsg(m);
a.deselectAll()
}
this._continuation={
count:0,totalItems:0}
}
var c=ZmList.progressDialog;
if(c){
c.popdown();
ZmList.progressDialog=null
}
if(o.allDoneCallback){
o.allDoneCallback.run()
}}};
ZmListController.prototype._handleResponseContinueAction=function(t,e){
this._continuation.result=e.getResponse();
var a=this._continuation.result.getResults().getArray();
if(a.length){
this._continuation.lastItem=a[a.length-1];
this._continuation.totalItems+=a.length;
t.args=t.args||[];
t.args.unshift(a);
t.run()
}};
ZmListController.prototype._checkItemCount=function(){
var e=this._listView[this._currentView];
e._checkItemCount();
e._handleResponseCheckReplenish()
}
}
if(AjxPackage.define("zimbraMail.share.controller.ZmTreeController")){
ZmTreeController=function(e){
if(arguments.length==0){
return
}
ZmController.call(this,null);
this.type=e;
this._opc=appCtxt.getOverviewController();
this._listeners={};
this._listeners[ZmOperation.DELETE]=new AjxListener(this,this._deleteListener);
this._listeners[ZmOperation.MOVE]=new AjxListener(this,this._moveListener);
this._listeners[ZmOperation.EXPAND_ALL]=new AjxListener(this,this._expandAllListener);
this._listeners[ZmOperation.MARK_ALL_READ]=new AjxListener(this,this._markAllReadListener);
this._listeners[ZmOperation.SYNC]=new AjxListener(this,this._syncListener);
this._listeners[ZmOperation.SYNC_ALL]=new AjxListener(this,this._syncAllListener);
this._listeners[ZmOperation.EDIT_PROPS]=new AjxListener(this,this._editPropsListener);
this._listeners[ZmOperation.EMPTY_FOLDER]=new AjxListener(this,this._emptyListener);
this._dragSrc=new DwtDragSource(Dwt.DND_DROP_MOVE);
this._dragSrc.addDragListener(new AjxListener(this,this._dragListener));
this._dropTgt=new DwtDropTarget(ZmTreeController.DROP_SOURCES[e]);
this._dropTgt.addDropListener(new AjxListener(this,this._dropListener));
this._treeView={};
this._hideEmpty={};
this._dataTree={}
};
ZmTreeController.prototype=new ZmController;
ZmTreeController.prototype.constructor=ZmTreeController;
ZmTreeController.COLOR_CLASS={};
ZmTreeController.COLOR_CLASS[ZmOrganizer.C_ORANGE]="OrangeBg";
ZmTreeController.COLOR_CLASS[ZmOrganizer.C_BLUE]="BlueBg";
ZmTreeController.COLOR_CLASS[ZmOrganizer.C_CYAN]="CyanBg";
ZmTreeController.COLOR_CLASS[ZmOrganizer.C_GREEN]="GreenBg";
ZmTreeController.COLOR_CLASS[ZmOrganizer.C_PURPLE]="PurpleBg";
ZmTreeController.COLOR_CLASS[ZmOrganizer.C_RED]="RedBg";
ZmTreeController.COLOR_CLASS[ZmOrganizer.C_YELLOW]="YellowBg";
ZmTreeController.COLOR_CLASS[ZmOrganizer.C_PINK]="PinkBg";
ZmTreeController.COLOR_CLASS[ZmOrganizer.C_GRAY]="Gray";
ZmTreeController.TREE_SELECTION_SHORTCUT_DELAY=750;
ZmTreeController.DROP_SOURCES={};
ZmTreeController.prototype.resetOperations=function(){};
ZmTreeController.prototype._getHeaderActionMenuOps=function(){};
ZmTreeController.prototype._getActionMenuOps=function(){};
ZmTreeController.prototype._getNewDialog=function(){};
ZmTreeController.prototype._getRenameDialog=function(){};
ZmTreeController.prototype._itemClicked=function(){};
ZmTreeController.prototype._itemDblClicked=function(){};
ZmTreeController.prototype._dropListener=function(){};
ZmTreeController.prototype._getMoveDialogTitle=function(){};
ZmTreeController.prototype._resetOperation=function(t,r,n,a,e,o){
var s=t&&t.getOp(r);
if(!s){
return
}
if(n){
s.setText(n)
}
if(a){
s.setImage(a)
}
if(e!=null){
s.setEnabled(e)
}
if(o!=null){
s.setVisible(o)
}};
ZmTreeController.prototype._resetButtonPerSetting=function(a,o,t){
var e=a.getOp(o);
if(e){
if(t){
e.setVisible(true);
if(appCtxt.isOffline&&!appCtxt.getActiveAccount().isZimbraAccount){
e.setEnabled(false)
}}else{
e.setVisible(false)
}}};
ZmTreeController.prototype.toString=function(){
return"ZmTreeController"
};
ZmTreeController.prototype.show=function(s){
var r=s.overviewId;
this._hideEmpty[r]=s.hideEmpty;
if(!this._treeView[r]||s.forceCreate){
this._treeViewCreated=false;
this._treeView[r]=null;
this._treeView[r]=this.getTreeView(r,true)
}
var e=(appCtxt.multiAccounts&&this.type==ZmOrganizer.ZIMLET);
var a=e?appCtxt.accountList.mainAccount:(this.type==ZmOrganizer.VOICE?r:s.account);
var o=this.getDataTree(a);
if(o){
s.dataTree=o;
var t=ZmOrganizer.OPEN_SETTING[this.type];
s.collapsed=(!e&&(!(!t||(appCtxt.get(t,null,a)!==false))));
var n=this._opc.getOverview(r);
if(n.showNewButtons){
this._setupNewOp(s)
}
this._treeView[r].set(s);
this._checkTreeView(r)
}
if(!this._treeViewCreated){
this._treeViewCreated=true;
this._postSetup(r,s.account)
}
return this._treeView[r]
};
ZmTreeController.prototype.getTreeView=function(t,e){
if(e&&!this._treeView[t]){
this._treeView[t]=this._setup(t)
}
return this._treeView[t]
};
ZmTreeController.prototype.clearTreeView=function(e){
if(this._treeView[e]){
this._treeView[e].dispose();
delete this._treeView[e]
}};
ZmTreeController.prototype.getDropTarget=function(){
return this._dropTgt
};
ZmTreeController.prototype.getDataTree=function(e){
e=e||appCtxt.getActiveAccount();
var t=this._dataTree[e.id];
if(!t){
t=this._dataTree[e.id]=appCtxt.getTree(this.type,e);
if(t){
t.addChangeListener(this._getTreeChangeListener())
}}
return t
};
ZmTreeController.prototype._setupNewOp=function(o){
var a=ZmOrganizer.NEW_OP[this.type];
if(a){
var t=ZmOperation.SETTING[a];
if(!t||appCtxt.get(t)){
var e=ZmOperation.getProp(a,"tooltipKey");
o.newButton={
image:ZmOperation.getProp(a,"image"),tooltip:e?ZmMsg[e]:null,callback:new AjxCallback(this,this._newListener)}
}}};
ZmTreeController.prototype._getTreeChangeListener=function(){
if(!this._dataChangeListener){
this._dataChangeListener=new AjxListener(this,this._treeChangeListener)
}
return this._dataChangeListener
};
ZmTreeController.prototype._setup=function(t){
var e=this._initializeTreeView(t);
if(this._opc.getOverview(t).actionSupported){
this._initializeActionMenus()
}
return e
};
ZmTreeController.prototype._postSetup=function(r,s){
var a=this.getTreeView(r);
if(!a.isCheckedStyle&&!ZmOrganizer.HAS_COLOR[this.type]){
return
}
var t=ZmOrganizer.getSystemId(ZmOrganizer.ID_ROOT,s);
var e=a.getTreeItemById(t);
if(!e){
return
}
if(a.isCheckedStyle){
e.showCheckBox(false)
}
var n=e.getItems();
for(var o=0;
o<n.length;
o++){
this._fixupTreeNode(n[o],null,a)
}};
ZmTreeController.prototype._fixupTreeNode=function(n,e,t){
if(n._isSeparator){
return
}
e=e||n.getData(Dwt.KEY_OBJECT);
if(e){
if(ZmOrganizer.HAS_COLOR[this.type]){
this._setTreeItemColor(n,e)
}
if(t.isCheckedStyle){
if(e.type==this.type&&t.isCheckedStyle){
n.setChecked(e.isChecked,true)
}else{
n.showCheckBox(false);
n.enableSelection(true)
}}}
var o=n.getItems();
for(var a=0;
a<o.length;
a++){
this._fixupTreeNode(o[a],null,t)
}};
ZmTreeController.prototype._setTreeItemColor=function(t,e){
t.setImage(e.getIconWithColor())
};
ZmTreeController.prototype._getTreeItemColorClassName=function(a,e){
if(!a||!e){
return null
}
if(e.isInTrash()){
return null
}
var t=e.color?e.color:ZmOrganizer.DEFAULT_COLOR[e.type];
return(t&&(t!=ZmOrganizer.C_NONE))?ZmTreeController.COLOR_CLASS[t]:""
};
ZmTreeController.prototype._initializeTreeView=function(o){
var a=this._opc.getOverview(o);
var t={
parent:a,parentElement:a.getTreeParent(this.type),overviewId:o,type:this.type,headerClass:a.headerClass,dragSrc:(a.dndSupported?this._dragSrc:null),dropTgt:(a.dndSupported?this._dropTgt:null),treeStyle:a.treeStyle,isCheckedByDefault:a.isCheckedByDefault,allowedTypes:this._getAllowedTypes(),allowedSubTypes:this._getAllowedSubTypes()};
t.id=ZmId.getTreeId(o,t.type);
var e=this._createTreeView(t);
e.addSelectionListener(new AjxListener(this,this._treeViewListener));
e.addTreeListener(new AjxListener(this,this._treeListener));
return e
};
ZmTreeController.prototype._createTreeView=function(e){
return new ZmTreeView(e)
};
ZmTreeController.prototype._initializeActionMenus=function(){
var o=this;
var a=this._createActionMenu;
var t=this._getHeaderActionMenuOps();
if(!this._headerActionMenu&&t){
var e=[this._shell,t];
this._headerActionMenu=new AjxCallback(o,a,e)
}
var t=this._getActionMenuOps();
if(!this._actionMenu&&t){
var e=[this._shell,t];
this._actionMenu=new AjxCallback(o,a,e)
}};
ZmTreeController.prototype._getHeaderActionMenu=function(e){
if(this._headerActionMenu instanceof AjxCallback){
var t=this._headerActionMenu;
this._headerActionMenu=t.run()
}
return this._headerActionMenu
};
ZmTreeController.prototype._getActionMenu=function(e){
if(this._actionMenu instanceof AjxCallback){
var t=this._actionMenu;
this._actionMenu=t.run()
}
return this._actionMenu
};
ZmTreeController.prototype._createActionMenu=function(o,t){
if(!t){
return
}
var n=new ZmActionMenu({
parent:o,menuItems:t}
);
t=n.opList;
for(var e=0;
e<t.length;
e++){
var a=t[e];
if(this._listeners[a]){
n.addSelectionListener(a,this._listeners[a])
}}
n.addPopdownListener(new AjxListener(this,this._menuPopdownActionListener));
return n
};
ZmTreeController.prototype._getAllowedTypes=function(){
var e={};
e[this.type]=true;
return e
};
ZmTreeController.prototype._getAllowedSubTypes=function(){
var e={};
e[this.type]=true;
return e
};
ZmTreeController.prototype._doCreate=function(params){
params.type=this.type;
var funcName=ZmOrganizer.CREATE_FUNC[this.type];
if(funcName){
var func=eval(funcName);
func(params)
}};
ZmTreeController.prototype._doDelete=function(e){
e._delete()
};
ZmTreeController.prototype._doEmpty=function(t){
var n=false;
t._empty(n);
var e=appCtxt.getCurrentController();
if(e&&e._getSearchFolderId){
var o=e._getSearchFolderId();
if(o&&(o==t.id)){
var a=e.getCurrentView();
a._resetList();
a._setNoResultsHtml()
}}};
ZmTreeController.prototype._doRename=function(e,t){
e.rename(t)
};
ZmTreeController.prototype._doMove=function(e,t){
e.move(t)
};
ZmTreeController.prototype._doMarkAllRead=function(e){
e.markAllRead()
};
ZmTreeController.prototype._doSync=function(e){
e.sync()
};
ZmTreeController.prototype._treeViewListener=function(r){
if(r.detail!=DwtTree.ITEM_ACTIONED&&r.detail!=DwtTree.ITEM_SELECTED&&r.detail!=DwtTree.ITEM_DBL_CLICKED){
return
}
var o=r.item;
var n=o.getData(ZmTreeView.KEY_TYPE);
if(!n){
return
}
var l=o.getData(Dwt.KEY_OBJECT);
if(l){
this._actionedOrganizer=l;
if(l.noSuchFolder){
var t=appCtxt.getFolderTree();
if(t){
t.handleDeleteNoSuchFolder(l)
}
return
}}
var e=o.getData(Dwt.KEY_ID);
var a=this._actionedOverviewId=o.getData(ZmTreeView.KEY_ID);
var h=this._opc.getOverview(a);
if(!h){
return
}
if(r.detail==DwtTree.ITEM_ACTIONED){
if(h.actionSupported){
var s=(l.nId==ZmOrganizer.ID_ROOT||l.isDataSource(ZmAccount.TYPE_IMAP))?this._getHeaderActionMenu(r):this._getActionMenu(r);
if(s){
this.resetOperations(s,n,e);
s.popup(0,r.docX,r.docY)
}}}else{
if((r.detail==DwtTree.ITEM_SELECTED)&&l){
if(appCtxt.multiAccounts&&(l instanceof ZmOrganizer)){
this._handleMultiAccountItemSelection(r,h,o,l)
}else{
this._handleItemSelection(r,h,o,l)
}}else{
if((r.detail==DwtTree.ITEM_DBL_CLICKED)&&l){
this._itemDblClicked(l)
}}}};
ZmTreeController.prototype._handleItemSelection=function(t,s,n,e){
s.itemSelected(n);
if(t.kbNavEvent){
DwtControl._scrollIntoView(n._itemDiv,s.getHtmlElement());
ZmController.noFocus=true
}
if(s._treeSelectionShortcutDelayActionId){
AjxTimedAction.cancelAction(s._treeSelectionShortcutDelayActionId)
}
if((s.selectionSupported||e._showFoldersCallback)&&!n._isHeader){
if(t.kbNavEvent&&ZmTreeController.TREE_SELECTION_SHORTCUT_DELAY){
var o=new AjxTimedAction(this,ZmTreeController.prototype._treeSelectionTimedAction,[e,s]);
s._treeSelectionShortcutDelayActionId=AjxTimedAction.scheduleAction(o,ZmTreeController.TREE_SELECTION_SHORTCUT_DELAY)
}else{
if((appCtxt.multiAccounts&&(e instanceof ZmOrganizer))||(e.type==ZmOrganizer.VOICE)){
appCtxt.getCurrentApp().getOverviewContainer().deselectAll(s);
var a=e.account||appCtxt.accountList.mainAccount;
appCtxt.accountList.setActiveAccount(a)
}
this._itemSelected(e)
}}};
ZmTreeController.prototype._itemSelected=function(e){
if(e&&e._showFoldersCallback){
e._showFoldersCallback.run()
}else{
this._itemClicked(e)
}};
ZmTreeController.prototype._handleMultiAccountItemSelection=function(t,o,a,e){
this._handleItemSelection(t,o,a,e)
};
ZmTreeController.prototype._treeSelectionTimedAction=function(e,t){
if(t._treeSelectionShortcutDelayActionId){
AjxTimedAction.cancelAction(t._treeSelectionShortcutDelayActionId)
}
this._itemSelected(e)
};
ZmTreeController.prototype._treeListener=function(a){
var o=a&&a.item;
var s=o&&o._tree&&o._tree.overviewId;
var n=appCtxt.getOverviewController().getOverview(s);
if(!(a&&a.detail&&n&&n.isAppOverview&&o._isHeader)){
return
}
var t=appCtxt.getSettings(n.account);
var e=t.getSetting(ZmOrganizer.OPEN_SETTING[this.type]);
if(e){
e.setValue(a.detail==DwtTree.ITEM_EXPANDED)
}};
ZmTreeController.prototype._treeChangeListener=function(e){
this._evHandled={};
for(var t in this._treeView){
this._changeListener(e,this._treeView[t],t)
}};
ZmTreeController.prototype._changeListener=function(ev,treeView,overviewId){
if(this._evHandled[overviewId]){
return
}
if(!treeView.allowedTypes[ev.type]&&!treeView.allowedSubTypes[ev.type]){
return
}
var organizers=ev.getDetail("organizers");
if(!organizers&&ev.source){
organizers=[ev.source]
}
for(var i=0;
i<organizers.length;
i++){
var organizer=organizers[i];
if(appCtxt.isOffline&&(organizer.nId==ZmFolder.ID_DRAFTS||organizer.nId==ZmFolder.ID_OUTBOX)){
organizer=appCtxt.getById(organizer.nId);
overviewId=appCtxt.getApp(ZmApp.MAIL).getOverviewId(appCtxt.accountList.mainAccount);
treeView=this._treeView[overviewId]
}
var node=treeView.getTreeItemById(organizer.id);
if(!node&&(ev.event!=ZmEvent.E_CREATE)){
continue
}
var fields=ev.getDetail("fields");
if(ev.event==ZmEvent.E_FLAGS){
var flag=ev.getDetail("flag");
var state=ev.getDetail("state");
if((flag==ZmItem.FLAG_UNREAD)&&!state){
node.setText(organizer.getName(false));
this._evHandled[overviewId]=true
}}else{
if(ev.event==ZmEvent.E_DELETE){
if(organizer.nId==ZmFolder.ID_TRASH||organizer.nId==ZmFolder.ID_SPAM){
node.setText(organizer.getName(false))
}else{
node.dispose()
}
this._checkTreeView(overviewId);
this._evHandled[overviewId]=true
}else{
if(ev.event==ZmEvent.E_CREATE||ev.event==ZmEvent.E_MOVE){
if(appCtxt.multiAccounts){
var overview=this._opc.getOverview(overviewId);
if(overview&&overview.account!=organizer.getAccount()){
continue
}}
var parentNode=this._getParentNode(organizer,ev,overviewId);
var idx=parentNode?ZmTreeView.getSortIndex(parentNode,organizer,eval(ZmTreeView.COMPARE_FUNC[organizer.type])):null;
if(parentNode&&(ev.event==ZmEvent.E_CREATE)){
var type=(organizer.parent.nId==ZmOrganizer.ID_ROOT)?ev.type:organizer.parent.type;
if(type!=this.type){
continue
}
node=this._addNew(treeView,parentNode,organizer,idx)
}else{
if(ev.event==ZmEvent.E_MOVE){
node.dispose();
if(parentNode){
node=this._addNew(treeView,parentNode,organizer,idx)
}}}
if(parentNode){
parentNode.setExpanded(true);
this._fixupTreeNode(node,organizer,treeView)
}
this._checkTreeView(overviewId);
this._evHandled[overviewId]=true
}else{
if(ev.event==ZmEvent.E_MODIFY){
if(!fields){
return
}
if(fields[ZmOrganizer.F_TOTAL]||fields[ZmOrganizer.F_SIZE]){
node.setToolTipContent(organizer.getToolTip(true))
}
var parentNode=this._getParentNode(organizer,ev,overviewId);
if(!parentNode){
return
}
if(fields[ZmOrganizer.F_NAME]||fields[ZmOrganizer.F_UNREAD]||fields[ZmOrganizer.F_FLAGS]||fields[ZmOrganizer.F_COLOR]||((organizer.nId==ZmFolder.ID_DRAFTS||organizer.nId==ZmOrganizer.ID_OUTBOX)&&fields[ZmOrganizer.F_TOTAL])){
this._updateOverview(parentNode,node,fields,organizer,treeView);
this._evHandled[overviewId]=true
}}}}}}};
ZmTreeController.prototype._updateOverview=function(parentNode,node,fields,organizer,treeView){
node.setText(organizer.getName(treeView._showUnread));
if(fields&&fields[ZmOrganizer.F_NAME]){
if(parentNode&&(parentNode.getNumChildren()>1)){
node.dispose();
var idx=ZmTreeView.getSortIndex(parentNode,organizer,eval(ZmTreeView.COMPARE_FUNC[organizer.type]));
node=treeView._addNew(parentNode,organizer,idx)
}else{
node.setDndText(organizer.getName())
}
appCtxt.getAppViewMgr().updateTitle()
}
this._fixupTreeNode(node,organizer,treeView)
};
ZmTreeController.prototype._getParentNode=function(e,a,o){
if(e.parent){
var t=(e.parent.nId==ZmOrganizer.ID_ROOT)?a.type:null;
return this._opc.getOverview(o).getTreeItemById(e.parent.id,t)
}};
ZmTreeController.prototype._addNew=function(o,a,t,e){
return o._addNew(a,t,e)
};
ZmTreeController.prototype._newListener=function(a,o){
this._pendingActionData=this._getActionedOrganizer(a);
var t=this._getNewDialog();
if(!this._newCb){
this._newCb=new AjxCallback(this,this._newCallback)
}
if(this._pendingActionData&&!appCtxt.getById(this._pendingActionData.id)){
this._pendingActionData=appCtxt.getFolderTree(o).root
}
if(!o&&appCtxt.multiAccounts){
var e=this._opc.getOverview(this._actionedOverviewId);
o=e&&e.account
}
ZmController.showDialog(t,this._newCb,this._pendingActionData,o);
t.registerCallback(DwtDialog.CANCEL_BUTTON,this._clearDialog,this,t)
};
ZmTreeController.prototype._renameListener=function(e){
this._pendingActionData=this._getActionedOrganizer(e);
var t=this._getRenameDialog();
if(!this._renameCb){
this._renameCb=new AjxCallback(this,this._renameCallback)
}
ZmController.showDialog(t,this._renameCb,this._pendingActionData);
t.registerCallback(DwtDialog.CANCEL_BUTTON,this._clearDialog,this,t)
};
ZmTreeController.prototype._deleteListener=function(e){
this._doDelete(this._getActionedOrganizer(e))
};
ZmTreeController.prototype._emptyListener=function(e){
this._doEmpty(this._getActionedOrganizer(e))
};
ZmTreeController.prototype._moveListener=function(e){
this._pendingActionData=this._getActionedOrganizer(e);
var t=appCtxt.getChooseFolderDialog();
if(!this._moveCb){
this._moveCb=new AjxCallback(this,this._moveCallback)
}
ZmController.showDialog(t,this._moveCb,this._getMoveParams(t));
t.registerCallback(DwtDialog.CANCEL_BUTTON,this._clearDialog,this,t)
};
ZmTreeController.prototype._getMoveParams=function(t){
var e={};
e[ZmFolder.ID_SPAM]=true;
return{
data:this._pendingActionData,treeIds:[this.type],overviewId:t.getOverviewId(ZmOrganizer.APP[this.type]),omit:e,title:this._getMoveDialogTitle(),description:ZmMsg.targetFolder,appName:ZmOrganizer.APP[this.type]}
};
ZmTreeController.prototype._expandAllListener=function(o){
var e=this._getActionedOrganizer(o);
var t=this.getTreeView(this._actionedOverviewId);
var a=t.getTreeItemById(e.id);
a.setExpanded(true,true)
};
ZmTreeController.prototype._markAllReadListener=function(e){
this._doMarkAllRead(this._getActionedOrganizer(e))
};
ZmTreeController.prototype._syncAllListener=function(o){
var s=this._getActionedOrganizer(o);
if(s.isFeed()){
for(var r in this._treeView){
var a=this.getTreeView(r);
var t=ZmOrganizer.getSystemId(ZmOrganizer.ID_ROOT,appCtxt.getActiveAccount());
var e=a.getTreeItemById(t);
if(!e){
return
}
var n=e.getItems();
if(n&&n[i]&&(n[i].isFeed&&n[i].isFeed()||(n[i].hasFeeds&&n[i].hasFeeds()))){
this._syncFeeds(n[i])
}}}else{
this._syncListener(o)
}};
ZmTreeController.prototype._syncListener=function(e){
var t=this._getActionedOrganizer(e);
this._syncFeeds(t)
};
ZmTreeController.prototype._syncFeeds=function(o){
if(o.isFeed()){
this._doSync(o)
}else{
if(o.hasFeeds()){
var e=o.children.getArray();
var n=o.children.size();
for(var t=0;
t<n;
t++){
if(e[t].isFeed()||(e[t].hasFeeds&&e[t].hasFeeds())){
this._syncFeeds(e[t])
}}}}};
ZmTreeController.prototype._editPropsListener=function(t){
var e=appCtxt.getFolderPropsDialog();
e.popup(this._getActionedOrganizer(t))
};
ZmTreeController.prototype._dragListener=function(e){
switch(e.action){
case DwtDragEvent.SET_DATA:e.srcData={
data:e.srcControl.getData(Dwt.KEY_OBJECT),controller:this};
break
}};
ZmTreeController.prototype._menuPopdownActionListener=function(){
if(this._pendingActionData){
return
}
var e=this.getTreeView(this._actionedOverviewId);
if(this._actionedOrganizer&&(e.getSelected()!=this._actionedOrganizer)){
var t=e.getTreeItemById(this._actionedOrganizer.id);
if(t){
t._setActioned(false)
}}};
ZmTreeController.prototype._newCallback=function(e){
this._doCreate(e);
this._clearDialog(this._getNewDialog())
};
ZmTreeController.prototype._renameCallback=function(e,t){
this._doRename(e,t);
this._clearDialog(this._getRenameDialog())
};
ZmTreeController.prototype._moveCallback=function(e){
this._doMove(this._pendingActionData,e);
this._clearDialog(appCtxt.getChooseFolderDialog())
};
ZmTreeController.prototype._deleteShieldYesCallback=function(e){
this._doDelete(e);
this._clearDialog(this._deleteShield)
};
ZmTreeController.prototype._emptyShieldYesCallback=function(e){
this._doEmpty(e);
this._clearDialog(this._emptyShield)
};
ZmTreeController.prototype._getActionedOrganizer=function(e){
if(this._actionedOrganizer){
return this._actionedOrganizer
}
var a=e.item;
while(a){
var t=a.getData(Dwt.KEY_OBJECT);
if(t instanceof ZmOrganizer){
this._actionedOrganizer=t;
return this._actionedOrganizer
}
a=a.parent
}
return null
};
ZmTreeController.prototype._checkTreeView=function(o){
if(!o||!this._treeView[o]){
return
}
var t=this._opc.getOverview(o).account;
var a=this.getDataTree(t);
var e=(ZmOrganizer.HIDE_EMPTY[this.type]&&a&&(a.size()==0));
this._treeView[o].setVisible(!e)
}
}
if(AjxPackage.define("zimbraMail.share.controller.ZmTagTreeController")){
ZmTagTreeController=function(){
ZmTreeController.call(this,ZmOrganizer.TAG);
this._listeners[ZmOperation.NEW_TAG]=new AjxListener(this,this._newListener);
this._listeners[ZmOperation.RENAME_TAG]=new AjxListener(this,this._renameListener);
this._listeners[ZmOperation.TAG_COLOR_MENU]=new AjxListener(this,this._colorListener);
this._listeners[ZmOperation.BROWSE]=new AjxListener(this,this._browseListener)
};
ZmTagTreeController.prototype=new ZmTreeController;
ZmTagTreeController.prototype.constructor=ZmTagTreeController;
ZmTagTreeController.prototype.toString=function(){
return"ZmTagTreeController"
};
ZmTagTreeController.prototype._getActionMenu=function(){
var o=ZmTreeController.prototype._getActionMenu.call(this);
if(o&&!o._initialized){
var t=o.getMenuItem(ZmOperation.TAG_COLOR_MENU);
if(t){
var e=t.getMenu().getItems();
for(var a=0;
a<e.length;
a++){
e[a].addSelectionListener(this._listeners[ZmOperation.TAG_COLOR_MENU])
}}
o._initialized=true
}
return o
};
ZmTagTreeController.prototype.resetOperations=function(a,t,o){
var e=appCtxt.getById(o);
a.enableAll(true);
if(e.isSystem()){
a.enable([ZmOperation.RENAME_TAG,ZmOperation.TAG_COLOR_MENU,ZmOperation.DELETE],false)
}
a.enable(ZmOperation.MARK_ALL_READ,(e&&(e.numUnread>0)))
};
ZmTagTreeController.prototype._getHeaderActionMenuOps=function(){
return[ZmOperation.NEW_TAG,ZmOperation.BROWSE]
};
ZmTagTreeController.prototype._getActionMenuOps=function(){
return[ZmOperation.NEW_TAG,ZmOperation.MARK_ALL_READ,ZmOperation.RENAME_TAG,ZmOperation.DELETE,ZmOperation.TAG_COLOR_MENU]
};
ZmTagTreeController.prototype._getNewDialog=function(){
return appCtxt.getNewTagDialog()
};
ZmTagTreeController.prototype._getRenameDialog=function(){
return appCtxt.getRenameTagDialog()
};
ZmTagTreeController.prototype._itemClicked=function(t){
var e;
switch(appCtxt.getCurrentAppName()){
case ZmApp.CONTACTS:e=ZmItem.CONTACT;
break;
case ZmApp.NOTEBOOK:e=ZmItem.PAGE;
break;
case ZmApp.CALENDAR:e=ZmItem.APPT;
break;
case ZmApp.BRIEFCASE:e=ZmItem.BRIEFCASE;
break;
case ZmApp.TASKS:e=ZmItem.TASK;
break;
default:e=ZmId.SEARCH_MAIL;
break
}
var a={
query:t.createQuery(),searchFor:e,getHtml:appCtxt.get(ZmSetting.VIEW_AS_HTML),accountName:(t.account&&t.account.name)};
appCtxt.getSearchController().search(a)
};
ZmTagTreeController.prototype._deleteListener=function(t){
var e=this._pendingActionData=this._getActionedOrganizer(t);
var a=this._deleteShield=appCtxt.getYesNoCancelMsgDialog();
a.reset();
a.registerCallback(DwtDialog.NO_BUTTON,this._clearDialog,this,this._deleteShield);
a.registerCallback(DwtDialog.YES_BUTTON,this._deleteShieldYesCallback,this,e);
var o=AjxMessageFormat.format(ZmMsg.askDeleteTag,e.getName(false,ZmOrganizer.MAX_DISPLAY_NAME_LENGTH));
a.setMessage(o,DwtMessageDialog.WARNING_STYLE);
a.popup()
};
ZmTagTreeController.prototype._colorListener=function(t){
var e=this._getActionedOrganizer(t);
if(e){
e.setColor(t.item.getData(ZmOperation.MENUITEM_ID))
}};
ZmTagTreeController.prototype._browseListener=function(t){
var e=this._getActionedOrganizer(t);
if(e){
AjxDispatcher.require("Browse");
appCtxt.getSearchController().showBrowsePickers([ZmPicker.TAG])
}};
ZmTagTreeController.prototype._dropListener=function(n){
var s=n.srcData.data;
if(n.action==DwtDropEvent.DRAG_ENTER){
var o=(s instanceof Array)?s[0]:s;
var t=n.targetControl.getData(Dwt.KEY_OBJECT);
if(t.id==ZmOrganizer.ID_ROOT){
n.doIt=false
}else{
if(o instanceof ZmContact&&(o.isGal||o.isShared())){
n.doIt=false
}else{
if(o&&(o instanceof ZmItem)&&o.isShared()){
n.doIt=false
}else{
if(appCtxt.multiAccounts&&t.getAccount()!=o.account){
n.doIt=false
}else{
n.doIt=this._dropTgt.isValidTarget(s)
}}}}}else{
if(n.action==DwtDropEvent.DRAG_DROP){
var e=n.srcData.controller;
var a=(s instanceof Array)?s:[s];
e._doTag(a,n.targetControl.getData(Dwt.KEY_OBJECT),true)
}}};
ZmTagTreeController.prototype._changeListener=function(r,a,h){
var t=r.getDetail("fields");
var o=r.getDetail("organizers");
for(var n=0;
n<o.length;
n++){
var e=o[n];
if(r.event==ZmEvent.E_MODIFY&&((t&&t[ZmOrganizer.F_COLOR]))){
var s=a.getTreeItemById(e.id);
if(s){
s.setImage(ZmTag.COLOR_ICON[e.color])
}}else{
ZmTreeController.prototype._changeListener.call(this,r,a,h)
}}};
ZmTagTreeController.prototype._setTreeItemColor=function(t,e){}
}
if(AjxPackage.define("zimbraMail.share.controller.ZmFolderTreeController")){
ZmFolderTreeController=function(t,e){
if(arguments.length==0){
return
}
ZmTreeController.call(this,(t||ZmOrganizer.FOLDER));
this._listeners[ZmOperation.NEW_FOLDER]=new AjxListener(this,this._newListener);
this._listeners[ZmOperation.RENAME_FOLDER]=new AjxListener(this,this._renameListener);
this._listeners[ZmOperation.SHARE_FOLDER]=new AjxListener(this,this._shareAddrBookListener);
this._listeners[ZmOperation.MOUNT_FOLDER]=new AjxListener(this,this._mountAddrBookListener);
this._listeners[ZmOperation.EMPTY_FOLDER]=new AjxListener(this,this._emptyListener);
this._listeners[ZmOperation.SYNC_OFFLINE_FOLDER]=new AjxListener(this,this._syncOfflineFolderListener);
this._listeners[ZmOperation.BROWSE]=new AjxListener(this,this._browseListener)
};
ZmFolderTreeController.prototype=new ZmTreeController;
ZmFolderTreeController.prototype.constructor=ZmFolderTreeController;
ZmFolderTreeController.prototype.toString=function(){
return"ZmFolderTreeController"
};
ZmFolderTreeController.prototype.show=function(n){
var a=n.omit||{};
for(var s in ZmFolder.HIDE_ID){
a[s]=true
}
var o=this.type!=ZmOrganizer.VOICE&&this.getDataTree(n.account);
if(o){
for(var e in ZmFolder.HIDE_NAME){
var t=o.getByName(e);
if(t){
a[t.id]=true
}}
if(appCtxt.isOffline&&n.account){
if(!n.account.isMain){
a[ZmFolder.ID_DRAFTS]=true;
a[ZmFolder.ID_OUTBOX]=true
}else{
if(n.account.type==ZmAccount.TYPE_POP){
a[ZmFolder.ID_SPAM]=true;
a[ZmFolder.ID_SENT]=true;
a[ZmFolder.ID_DRAFTS]=true;
a[ZmFolder.ID_OUTBOX]=true
}}}}
n.omit=a;
return ZmTreeController.prototype.show.call(this,n)
};
ZmFolderTreeController.prototype.resetOperations=function(p,m,a){
var s=ZmMsg.emptyFolder;
var o=appCtxt.getById(a);
var r=((o.numTotal>0)||(o.children&&(o.children.size()>0)));
var n=ZmOrganizer.normalizeId(a,this.type);
if(n==ZmOrganizer.ID_ROOT||((!o.isSystem())&&!o.isSyncIssuesFolder())){
var u=(!o.link||o.isAdmin());
p.enableAll(true);
p.enable(ZmOperation.SYNC,o.isFeed());
p.enable(ZmOperation.SYNC_ALL,o.isFeed()||o.hasFeeds());
p.enable([ZmOperation.SHARE_FOLDER,ZmOperation.MOUNT_FOLDER],u);
p.enable(ZmOperation.EMPTY_FOLDER,(r||o.link));
p.enable(ZmOperation.RENAME_FOLDER,!o.isDataSource());
p.enable(ZmOperation.NEW_FOLDER,!o.disallowSubFolder);
if(o.isRemote()&&o.isReadOnly()){
p.enable([ZmOperation.NEW_FOLDER,ZmOperation.MARK_ALL_READ,ZmOperation.EMPTY_FOLDER],false)
}}else{
p.enableAll(false);
if(!o.disallowSubFolder&&(n==ZmFolder.ID_INBOX||n==ZmFolder.ID_SENT||n==ZmFolder.ID_TRASH)){
p.enable(ZmOperation.NEW_FOLDER,true)
}
if(n==ZmFolder.ID_SPAM||n==ZmFolder.ID_TRASH||n==ZmFolder.ID_CHATS){
if(n==ZmFolder.ID_SPAM){
s=ZmMsg.emptyJunk
}else{
if(n==ZmFolder.ID_TRASH){
s=ZmMsg.emptyTrash
}}
p.enable(ZmOperation.EMPTY_FOLDER,r)
}
if(!o.link&&(n==ZmFolder.ID_INBOX||n==ZmFolder.ID_SENT)){
p.enable([ZmOperation.SHARE_FOLDER,ZmOperation.MOUNT_FOLDER,ZmOperation.EDIT_PROPS],true)
}
if(appCtxt.isOffline&&n==ZmOrganizer.ID_SYNC_FAILURES&&r){
p.enable(ZmOperation.EMPTY_FOLDER,true)
}}
p.enable(ZmOperation.EXPAND_ALL,(o.size()>0));
if(n!=ZmOrganizer.ID_ROOT&&!o.isReadOnly()){
p.enable(ZmOperation.MARK_ALL_READ,(o.numUnread>0||o.link))
}
var l=p.getOp(ZmOperation.EMPTY_FOLDER);
if(l){
l.setText(s)
}
var h=p.getOp(ZmOperation.SYNC);
if(h){
var d=p.getOp(ZmOperation.SYNC_ALL);
var t=o.hasFeeds();
if(o.isFeed()){
h.setEnabled(true);
h.setVisible(true);
h.setText(ZmMsg.checkFeed);
if(d){
d.setEnabled(true);
d.setVisible(true);
d.setText(ZmMsg.checkAllFeed)
}}else{
if(t){
if(d){
d.setEnabled(true);
d.setVisible(true);
d.setText(ZmMsg.checkAllFeed)
}}else{
var f=appCtxt.get(ZmSetting.POP_ACCOUNTS_ENABLED)||appCtxt.get(ZmSetting.IMAP_ACCOUNTS_ENABLED);
if(!appCtxt.isOffline&&f){
var c=AjxDispatcher.run("GetDataSourceCollection");
var e=c.getItemsFor(ZmOrganizer.normalizeId(o.id));
if(e.length>0){
h.setText(ZmMsg.checkExternalMail);
h.setEnabled(true);
h.setVisible(true)
}else{
h.setVisible(false)
}}else{
h.setVisible(false)
}
if(!t&&d){
d.setVisible(false)
}}}}
h=p.getOp(ZmOperation.SYNC_OFFLINE_FOLDER);
if(h){
if(!o.isOfflineSyncable){
h.setVisible(false)
}else{
h.setVisible(true);
h.setEnabled(true);
var g=(o.isOfflineSyncing)?ZmMsg.syncOfflineFolderOff:ZmMsg.syncOfflineFolderOn;
h.setText(g)
}}
p.enable(ZmOperation.BROWSE,true);
this._resetButtonPerSetting(p,ZmOperation.SHARE_FOLDER,appCtxt.get(ZmSetting.SHARING_ENABLED));
this._resetButtonPerSetting(p,ZmOperation.MOUNT_FOLDER,appCtxt.get(ZmSetting.SHARING_ENABLED))
};
ZmFolderTreeController.prototype._getHeaderActionMenuOps=function(){
return[ZmOperation.NEW_FOLDER,ZmOperation.MOUNT_FOLDER,ZmOperation.EXPAND_ALL,ZmOperation.SYNC,ZmOperation.BROWSE]
};
ZmFolderTreeController.prototype._getActionMenuOps=function(){
return[ZmOperation.NEW_FOLDER,ZmOperation.MARK_ALL_READ,ZmOperation.DELETE,ZmOperation.RENAME_FOLDER,ZmOperation.MOVE,ZmOperation.SHARE_FOLDER,ZmOperation.EDIT_PROPS,ZmOperation.EXPAND_ALL,ZmOperation.SYNC,ZmOperation.SYNC_ALL,ZmOperation.EMPTY_FOLDER,ZmOperation.SYNC_OFFLINE_FOLDER]
};
ZmFolderTreeController.prototype._getAllowedSubTypes=function(){
var e={};
e[ZmOrganizer.FOLDER]=true;
e[ZmOrganizer.SEARCH]=true;
return e
};
ZmFolderTreeController.prototype._getNewDialog=function(){
return appCtxt.getNewFolderDialog()
};
ZmFolderTreeController.prototype._getRenameDialog=function(){
return appCtxt.getRenameFolderDialog()
};
ZmFolderTreeController.prototype._itemClicked=function(t){
if(t.type==ZmOrganizer.SEARCH){
var s=this._opc.getTreeController(ZmOrganizer.SEARCH);
s._itemClicked(t)
}else{
if(t.id==ZmFolder.ID_ATTACHMENTS){
var r=AjxDispatcher.run("GetAttachmentsController");
r.show()
}else{
var e=ZmId.SEARCH_MAIL;
if(t.isInTrash()){
var o=appCtxt.getCurrentAppName();
if(o==ZmApp.CONTACTS){
e=ZmItem.CONTACT
}}
var h=appCtxt.getSearchController();
var n={
query:t.createQuery(),searchFor:e,getHtml:(t.nId==ZmFolder.ID_DRAFTS)||appCtxt.get(ZmSetting.VIEW_AS_HTML),types:((t.nId==ZmOrganizer.ID_SYNC_FAILURES)?[ZmItem.MSG]:null),sortBy:((h.currentSearch&&t.nId==h.currentSearch.folderId)?null:ZmSearch.DATE_DESC),accountName:(t.account&&t.account.name)};
h.resetSearchAllAccounts();
if(appCtxt.multiAccounts){
if(t.link&&t.shares==null){
var a=appCtxt.getFolderTree(t.account);
if(a){
var l=new AjxCallback(this,this._getPermissionsResponse,[n]);
a.getPermissions({
callback:l,folderIds:[t.id]}
)
}
return
}
n.callback=(t.id==ZmFolder.ID_DRAFTS||t.id==ZmFolder.ID_OUTBOX)?(new AjxCallback(this,this._handleSearch,[h,n.query,t])):null
}
h.search(n)
}}};
ZmFolderTreeController.prototype._handleSearch=function(o,a,t){
var e=this._opc.getOverview(appCtxt.getApp(ZmApp.MAIL).getOverviewId());
e.setSelected(t.id)
};
ZmFolderTreeController.prototype._getPermissionsResponse=function(e){
appCtxt.getSearchController().search(e)
};
ZmFolderTreeController.prototype._doSync=function(a){
var t=AjxDispatcher.run("GetDataSourceCollection");
var e=ZmOrganizer.normalizeId(a.id);
var o=t.getItemsFor(e);
if(o.length>0){
t.importMailFor(e)
}else{
ZmTreeController.prototype._doSync.call(this,a)
}};
ZmFolderTreeController.prototype._syncFeeds=function(t){
if(!appCtxt.isOffline&&t&&!t.isFeed()){
var a=(appCtxt.get(ZmSetting.POP_ACCOUNTS_ENABLED)||appCtxt.get(ZmSetting.IMAP_ACCOUNTS_ENABLED))?t.getDataSources(null,true):null;
if(a){
var e=AjxDispatcher.run("GetDataSourceCollection");
e.importMail(a);
return
}}
ZmTreeController.prototype._syncFeeds.call(this,t)
};
ZmFolderTreeController.prototype._addNew=function(o,a,t,e){
if(ZmFolder.HIDE_ID[t.id]){
return false
}
return o._addNew(a,t,e)
};
ZmFolderTreeController.prototype._deleteListener=function(a){
var e=this._getActionedOrganizer(a);
var n=appCtxt.isOffline?this.getDataTree().getById(ZmFolder.ID_TRASH):null;
if(n&&n.disallowSubFolder&&e.numTotal>0){
var r=appCtxt.getMsgDialog();
r.setMessage(ZmMsg.errorCannotDeleteFolder);
r.popup();
return
}
if(e.nId==ZmFolder.ID_SPAM||e.isInTrash()||(n&&n.disallowSubFolder)){
this._pendingActionData=e;
var o=this._deleteShield=appCtxt.getOkCancelMsgDialog();
o.reset();
o.registerCallback(DwtDialog.OK_BUTTON,this._deleteShieldYesCallback,this,e);
o.registerCallback(DwtDialog.CANCEL_BUTTON,this._clearDialog,this,this._deleteShield);
var t;
if(e.type==ZmOrganizer.SEARCH){
t=ZmMsg.confirmDeleteSavedSearch
}else{
if(e.disallowSubFolder||e.isMountpoint){
t=ZmMsg.confirmDeleteFolder
}else{
if(e.nId==ZmFolder.ID_TRASH){
t=ZmMsg.confirmEmptyTrashFolder
}else{
t=ZmMsg.confirmEmptyFolder
}}}
var s=AjxMessageFormat.format(t,e.getName());
o.setMessage(s,DwtMessageDialog.WARNING_STYLE);
o.popup()
}else{
this._doMove(e,appCtxt.getById(ZmFolder.ID_TRASH))
}};
ZmFolderTreeController.prototype._emptyListener=function(t){
var e=this._pendingActionData=this._getActionedOrganizer(t);
var a=this._emptyShield=appCtxt.getOkCancelMsgDialog();
a.reset();
a.registerCallback(DwtDialog.OK_BUTTON,this._emptyShieldYesCallback,this,e);
a.registerCallback(DwtDialog.CANCEL_BUTTON,this._clearDialog,this,this._emptyShield);
var n=(e.nId!=ZmFolder.ID_TRASH)?(AjxMessageFormat.format(ZmMsg.confirmEmptyFolder,e.getName())):ZmMsg.confirmEmptyTrashFolder;
a.setMessage(n,DwtMessageDialog.WARNING_STYLE);
var s=(e.nId==ZmFolder.ID_TRASH||e.nId==ZmFolder.ID_SPAM)?DwtDialog.OK_BUTTON:DwtDialog.CANCEL_BUTTON;
a.associateEnterWithButton(s);
a.popup(null,s);
if(!(e.nId==ZmFolder.ID_SPAM||e.isInTrash())){
var o=a.getButton(DwtDialog.CANCEL_BUTTON);
o.focus()
}};
ZmFolderTreeController.prototype._syncOfflineFolderListener=function(t){
var e=this._getActionedOrganizer(t);
if(e){
e.toggleSyncOffline()
}};
ZmFolderTreeController.prototype._browseListener=function(t){
var e=this._getActionedOrganizer(t);
if(e){
AjxDispatcher.require("Browse");
appCtxt.getSearchController().showBrowsePickers([ZmPicker.FOLDER])
}};
ZmFolderTreeController.prototype._dragListener=function(t){
if(t.action==DwtDragEvent.DRAG_START){
var e=t.srcControl.getData(Dwt.KEY_OBJECT);
t.srcData={
data:e,controller:this};
if(!(e instanceof ZmFolder)||e.isSystem()||e.isSyncIssuesFolder()){
t.operation=Dwt.DND_DROP_NONE
}}};
ZmFolderTreeController.prototype._dropListener=function(l){
var n=l.targetControl.getData(Dwt.KEY_OBJECT);
var t=l.srcData.data;
var o=(l.shiftKey||l.uiEvent.shiftKey);
if(l.action==DwtDropEvent.DRAG_ENTER){
var h=l.targetControl.getData(ZmTreeView.KEY_TYPE);
if(t instanceof ZmFolder){
l.doIt=n.mayContain(t,h)&&!n.disallowSubFolder
}else{
if(t instanceof ZmTag){
l.doIt=false
}else{
if(this._dropTgt.isValidTarget(t)){
l.doIt=n.mayContain(t,h);
var e;
var u=(!(t instanceof Array))?[t]:t;
for(var a=0;
a<u.length;
a++){
if(u[a] instanceof ZmItem){
e|=u[a].getDefaultDndAction(o)
}}
var c=document.getElementById(DwtId.DND_PLUS_ID);
if(e&&c){
var r=((e&ZmItem.DND_ACTION_COPY)!=0);
Dwt.setVisibility(c,r)
}}else{
l.doIt=false
}}}}else{
if(l.action==DwtDropEvent.DRAG_DROP){
if(t instanceof ZmFolder){
this._doMove(t,n)
}else{
var d=l.srcData.controller;
var s=(t instanceof Array)?t:[t];
d._doMove(s,n,null,o)
}}}};
ZmFolderTreeController.prototype._shareAddrBookListener=function(e){
this._pendingActionData=this._getActionedOrganizer(e);
appCtxt.getSharePropsDialog().popup(ZmSharePropsDialog.NEW,this._pendingActionData)
};
ZmFolderTreeController.prototype._mountAddrBookListener=function(e){
appCtxt.getMountFolderDialog().popup(ZmOrganizer.FOLDER)
};
ZmFolderTreeController.prototype._getMoveDialogTitle=function(){
return AjxMessageFormat.format(ZmMsg.moveFolder,this._pendingActionData.name)
}
}
if(AjxPackage.define("zimbraMail.share.controller.ZmSearchTreeController")){
ZmSearchTreeController=function(){
ZmFolderTreeController.call(this,ZmOrganizer.SEARCH);
this._listeners[ZmOperation.RENAME_SEARCH]=new AjxListener(this,this._renameListener);
this._listeners[ZmOperation.BROWSE]=new AjxListener(this,this._browseListener)
};
ZmSearchTreeController.prototype=new ZmFolderTreeController;
ZmSearchTreeController.prototype.constructor=ZmSearchTreeController;
ZmSearchTreeController.APP_JOIN_CHAR="-";
ZmSearchTreeController.prototype.toString=function(){
return"ZmSearchTreeController"
};
ZmSearchTreeController.prototype.show=function(a){
var o=a.overviewId;
if(!this._treeView[o]||a.forceCreate){
this._treeView[o]=this._setup(o)
}
var t=this.getDataTree(a.account);
if(t){
a.dataTree=t;
a.searchTypes={};
a.omit=a.omit||{};
a.omit[ZmFolder.ID_TRASH]=true;
a.omitParents=true;
var e=ZmOrganizer.OPEN_SETTING[this.type];
a.collapsed=!(!e||(appCtxt.get(e,null,a.account)!==false));
this._setupNewOp(a);
this._treeView[o].set(a);
this._checkTreeView(o)
}
return this._treeView[o]
};
ZmSearchTreeController.prototype.getTreeStyle=function(){
return null
};
ZmSearchTreeController.prototype.resetOperations=function(a,t,o){
a.enableAll(true);
var e=appCtxt.getById(o);
a.enable(ZmOperation.EXPAND_ALL,(e.size()>0))
};
ZmSearchTreeController.prototype._newListener=function(e){
AjxDispatcher.require("Browse");
appCtxt.getSearchController().showBrowseView()
};
ZmSearchTreeController.prototype._browseListener=function(t){
var e=this._getActionedOrganizer(t);
if(e){
AjxDispatcher.require("Browse");
appCtxt.getSearchController().showBrowsePickers([ZmPicker.SEARCH])
}};
ZmSearchTreeController.prototype._getHeaderActionMenuOps=function(){
return[ZmOperation.EXPAND_ALL,ZmOperation.BROWSE]
};
ZmSearchTreeController.prototype._getActionMenuOps=function(){
return[ZmOperation.DELETE,ZmOperation.RENAME_SEARCH,ZmOperation.MOVE,ZmOperation.EXPAND_ALL]
};
ZmSearchTreeController.prototype._getAllowedSubTypes=function(){
return ZmTreeController.prototype._getAllowedSubTypes.call(this)
};
ZmSearchTreeController.prototype._getNewDialog=function(){
return appCtxt.getNewSearchDialog()
};
ZmSearchTreeController.prototype._itemClicked=function(e){
if(e._showFoldersCallback){
e._showFoldersCallback.run();
return
}
var t=appCtxt.getSearchController();
t.searchAllAccounts=e.isOfflineGlobalSearch;
t.redoSearch(e.search,false,{
getHtml:appCtxt.get(ZmSetting.VIEW_AS_HTML)}
)
};
ZmSearchTreeController.prototype._getMoveParams=function(t){
var e=ZmTreeController.prototype._getMoveParams.apply(this,arguments);
e.overviewId=t.getOverviewId(this.type);
e.treeIds=[ZmOrganizer.FOLDER,ZmOrganizer.SEARCH];
return e
};
ZmSearchTreeController.prototype._getMoveDialogTitle=function(){
return AjxMessageFormat.format(ZmMsg.moveSearch,this._pendingActionData.name)
};
ZmSearchTreeController.prototype._checkTreeView=function(n){
var t=this._treeView[n];
if(!n||!t){
return
}
var o=this._opc.getOverview(n).account;
var e=(appCtxt.multiAccounts&&!o.isMain)?(ZmOrganizer.getSystemId(ZmOrganizer.ID_ROOT,o)):ZmOrganizer.ID_ROOT;
var a=ZmOrganizer.HIDE_EMPTY[this.type]&&!t.getTreeItemById(e).getItemCount();
this._treeView[n].setVisible(!a)
}
}
if(AjxPackage.define("zimbraMail.share.controller.ZmOverviewController")){
ZmOverviewController=function(e){
ZmController.call(this,e);
this._overviewContainer={};
this._overview={};
this._controller={};
this._appOverviewId={}
};
ZmOverviewController.CONTROLLER={};
ZmOverviewController.DEFAULT_FOLDER_ID=ZmFolder.ID_INBOX;
ZmOverviewController.prototype=new ZmController;
ZmOverviewController.prototype.constructor=ZmOverviewController;
ZmOverviewController.prototype.toString=function(){
return"ZmOverviewController"
};
ZmOverviewController.prototype.createOverviewContainer=function(t,a){
t.parent=t.parent||this._shell;
t.controller=this;
t.id=ZmId.getOverviewContainerId(t.containerId);
var e=this._overviewContainer[t.containerId]=new ZmAccountOverviewContainer(t);
e.initialize(a);
return e
};
ZmOverviewController.prototype.createOverview=function(t){
t.parent=t.parent||this._shell;
var e=this._overview[t.overviewId]=new ZmOverview(t,this);
return e
};
ZmOverviewController.prototype.getOverviewContainer=function(e){
var e=e||appCtxt.getCurrentAppName();
return this._overviewContainer[e]
};
ZmOverviewController.prototype.getOverview=function(e){
return this._overview[e]
};
ZmOverviewController.prototype.getTreeController=function(treeId,noCreate){
if(!treeId){
return null
}
if(!this._controller[treeId]&&!noCreate){
var className=ZmOverviewController.CONTROLLER[treeId];
if(className&&window[className]){
var treeControllerCtor=eval(ZmOverviewController.CONTROLLER[treeId]);
if(treeControllerCtor){
this._controller[treeId]=new treeControllerCtor(treeId)
}}}
return this._controller[treeId]
};
ZmOverviewController.prototype.getTreeData=function(e){
return e?appCtxt.getTree(e):null
};
ZmOverviewController.prototype.getTreeView=function(t,e){
if(!t||!e){
return null
}
return this.getOverview(t).getTreeView(e)
}
}
if(AjxPackage.define("zimbraMail.share.controller.ZmSearchController")){
ZmSearchController=function(e){
ZmController.call(this,e);
this._inited=false;
this._searchFor=ZmId.SEARCH_MAIL;
this._contactSource=ZmItem.CONTACT;
this._results=null;
if(appCtxt.get(ZmSetting.SEARCH_ENABLED)){
this._setView()
}};
ZmSearchController.prototype=new ZmController;
ZmSearchController.prototype.constructor=ZmSearchController;
ZmSearchController.QUERY_ISREMOTE="is:remote OR is:local";
ZmSearchController.prototype.toString=function(){
return"ZmSearchController"
};
ZmSearchController.prototype.getSearchPanel=function(){
return this._searchPanel
};
ZmSearchController.prototype.getSearchToolbar=function(){
return this._searchToolBar
};
ZmSearchController.prototype.dateSearch=function(s,e){
s=s||new Date();
var o=AjxDateFormat.getDateInstance(AjxDateFormat.SHORT);
var a=o.format(s);
var t=appCtxt.getApp(ZmApp.MAIL).getGroupMailBy();
var n="date:"+a;
this.search({
query:n,types:[t],searchFor:e}
)
};
ZmSearchController.prototype.fromSearch=function(e){
var t=appCtxt.getApp(ZmApp.MAIL).getGroupMailBy();
var o=e instanceof Array?e.concat():[e];
for(var a=0;
a<o.length;
a++){
o[a]=["from:(",o[a],")"].join("")
}
this.search({
query:o.join(" OR "),types:[t]}
)
};
ZmSearchController.prototype.fromBrowse=function(t){
var e=new AjxCallback(this,this._handleLoadFromBrowse,[t]);
this.showBrowseView(true,e)
};
ZmSearchController.prototype.showBrowsePickers=function(a,e){
e=(!e||e==null)?true:e;
this.showBrowseView(true,null);
if(a instanceof Array){
this._browseViewController.removeAllPickers();
if(e){
this._browseViewController.addPicker(ZmPicker.BASIC)
}
for(var t=0;
t<a.length;
t++){
this._browseViewController.addPicker(a[t])
}}};
ZmSearchController.prototype._handleLoadFromBrowse=function(a,e){
this.setDefaultSearchType(ZmId.SEARCH_MAIL);
e.removeAllPickers();
this._browseViewController.removeAllPickers();
var t=this._browseViewController.addPicker(ZmPicker.BASIC);
t.setFrom(a);
t.execute()
};
ZmSearchController.prototype.showBrowseView=function(t,o){
if(!this._browseViewController){
var e=new AjxCallback(this,this._handleLoadShowBrowseView,[o]);
AjxDispatcher.require("Browse",false,e,null,false)
}else{
var a=this._browseViewController;
a.setBrowseViewVisible(t||!a.getBrowseViewVisible());
if(o){
o.run(a.getBrowseView())
}}};
ZmSearchController.prototype._handleLoadShowBrowseView=function(t){
var e=this._browseViewController=new ZmBrowseController(this._searchPanel);
e.setBrowseViewVisible(true);
if(t){
t.run(e.getBrowseView())
}};
ZmSearchController.prototype.getBrowseView=function(){
return(this._browseViewController&&this._browseViewController.getBrowseView())
};
ZmSearchController.prototype.setSearchField=function(e){
if(appCtxt.get(ZmSetting.SHOW_SEARCH_STRING)&&this._searchToolBar){
this._searchToolBar.setSearchFieldValue(e)
}else{
this._currentQuery=e
}};
ZmSearchController.prototype.getSearchFieldValue=function(){
return this._searchToolBar?this._searchToolBar.getSearchFieldValue():""
};
ZmSearchController.prototype.setEnabled=function(e){
if(this._searchToolBar){
this._searchToolBar.setEnabled(e)
}};
ZmSearchController.prototype.setDefaultSearchType=function(e){
if(this._searchToolBar&&!appCtxt.inStartup){
var t=this._searchToolBar.getButton(ZmSearchToolBar.SEARCH_MENU_BUTTON).getMenu();
t.checkItem(ZmSearchToolBar.MENUITEM_ID,e);
this._searchMenuListener(null,e)
}};
ZmSearchController.prototype._setView=function(){
this._searchPanel=new DwtComposite({
parent:this._container,className:"SearchPanel",posStyle:Dwt.ABSOLUTE_STYLE}
);
this._searchToolBar=new ZmSearchToolBar(this._searchPanel,ZmId.SEARCH_TOOLBAR);
this._createTabGroup().addMember(this._searchToolBar.getSearchField());
this._searchToolBar.registerCallback(this._searchFieldCallback,this);
this._searchToolBar.addSelectionListener(ZmSearchToolBar.SEARCH_BUTTON,new AjxListener(this,this._searchButtonListener));
if(appCtxt.get(ZmSetting.BROWSE_ENABLED)){
this._searchToolBar.addSelectionListener(ZmSearchToolBar.BROWSE_BUTTON,new AjxListener(this,this._browseButtonListener))
}
if(appCtxt.get(ZmSetting.SAVED_SEARCHES_ENABLED)){
this._searchToolBar.addSelectionListener(ZmSearchToolBar.SAVE_BUTTON,new AjxListener(this,this._saveButtonListener))
}};
ZmSearchController.prototype._addMenuListeners=function(s){
var a=new AjxListener(this,this._searchMenuListener);
var t=s.getItems();
for(var o=0;
o<t.length;
o++){
var n=t[o];
n.addSelectionListener(a);
var e=n.getData(ZmSearchToolBar.MENUITEM_ID);
if(e==ZmId.SEARCH_MAIL){
n.setChecked(true,true)
}}};
ZmSearchController.prototype.search=function(e){
if(e.searchFor!=ZmItem.APPT&&(!e.query&&!e.queryHint)){
return
}
if(e.query&&(e.query.indexOf("$set:")==0||e.query.indexOf("$cmd:")==0)){
appCtxt.getClientCmdHandler().execute((e.query.substr(5)),this);
return
}
e.searchAllAccounts=this.searchAllAccounts;
var t=new AjxCallback(this,this._handleResponseSearch,[e.callback]);
this._doSearch(e,e.noRender,t,e.errorCallback)
};
ZmSearchController.prototype._handleResponseSearch=function(t,e){
if(t){
t.run(e)
}};
ZmSearchController.prototype.redoSearch=function(o,e,n,r,t){
var s={};
s.query=o.query;
s.queryHint=o.queryHint;
s.types=o.types;
s.sortBy=o.sortBy;
s.offset=o.offset;
s.limit=o.limit;
s.prevId=o.prevId;
s.prevSortBy=o.prevSortBy;
s.fetch=o.fetch;
s.searchId=o.searchId;
s.lastSortVal=o.lastSortVal;
s.endSortVal=o.endSortVal;
s.lastId=o.lastId;
s.soapInfo=o.soapInfo;
s.accountName=o.accountName;
s.searchFor=this._searchFor;
if(n){
for(var a in n){
s[a]=n[a]
}}
this._doSearch(s,e,r,t)
};
ZmSearchController.prototype.resetSearchAllAccounts=function(){
var e=this.searchAllAccounts&&this._searchToolBar.getButton(ZmSearchToolBar.SEARCH_MENU_BUTTON);
var n=e&&e.getMenu();
var o=n&&n.getItemById(ZmSearchToolBar.MENUITEM_ID,ZmId.SEARCH_ALL_ACCOUNTS);
if(o){
o.setChecked(false,true);
var a=n.getSelectedItem();
var t=this._inclSharedItems?this._getSharedImage(a):a.getImage();
e.setImage(t);
this.searchAllAccounts=false
}};
ZmSearchController.prototype.resetSearchToolbar=function(){
var e=this._searchToolBar.getButton(ZmSearchToolBar.SEARCH_MENU_BUTTON);
var t=e?e.getMenu().getItemById(ZmSearchToolBar.MENUITEM_ID,ZmId.SEARCH_GAL):null;
if(t){
t.setVisible(appCtxt.getActiveAccount().isZimbraAccount)
}};
ZmSearchController.prototype.getTypes=function(o){
var a=new AjxVector();
var e=o.searchFor||this._searchFor;
var t;
if((e==ZmId.SEARCH_MAIL||e==ZmId.SEARCH_ANY)&&appCtxt.get(ZmSetting.MAIL_ENABLED)){
t=appCtxt.getApp(ZmApp.MAIL).getGroupMailBy()
}
if(e==ZmId.SEARCH_MAIL){
a.add(t)
}else{
if(e==ZmId.SEARCH_ANY){
if(appCtxt.get(ZmSetting.MAIL_ENABLED)&&t){
a.add(t)
}
if(appCtxt.get(ZmSetting.CONTACTS_ENABLED)){
a.add(ZmItem.CONTACT)
}
if(appCtxt.get(ZmSetting.CALENDAR_ENABLED)){
a.add(ZmItem.APPT)
}
if(appCtxt.get(ZmSetting.TASKS_ENABLED)){
a.add(ZmItem.TASK)
}
if(appCtxt.get(ZmSetting.NOTEBOOK_ENABLED)){
a.add(ZmItem.PAGE)
}
if(appCtxt.get(ZmSetting.BRIEFCASE_ENABLED)){
a.add(ZmItem.BRIEFCASE)
}}else{
a.add(e);
if(e==ZmItem.PAGE){
a.add(ZmItem.DOCUMENT)
}}}
return a
};
ZmSearchController.prototype.updateOverview=function(e){
var t=e||appCtxt.getCurrentSearch();
var h,a;
if(t){
if(t.folderId){
h=this._getNormalizedId(t.folderId);
var n=appCtxt.getFolderTree();
var o=n&&n.getById(h);
a=o?o.type:ZmOrganizer.FOLDER
}else{
if(t.tagId){
h=this._getNormalizedId(t.tagId);
a=ZmOrganizer.TAG
}else{
if(t.searchId){
h=this._getNormalizedId(t.searchId);
a=ZmOrganizer.SEARCH
}}}
var r=appCtxt.getCurrentApp();
var s=r&&r.getOverview();
if(s){
s.setSelected(h,a)
}}};
ZmSearchController.prototype._getSuitableSortBy=function(t){
var o;
if(t.size()==1){
var a=t.get(0);
var e;
switch(a){
case ZmItem.CONV:e=ZmId.VIEW_CONVLIST;
break;
case ZmItem.MSG:e=ZmId.VIEW_TRAD;
break;
case ZmItem.CONTACT:e=ZmId.VIEW_CONTACT_SIMPLE;
break;
case ZmItem.APPT:e=ZmId.VIEW_CAL;
break;
case ZmItem.TASK:e=ZmId.VIEW_TASKLIST;
break;
case ZmId.SEARCH_GAL:e=ZmId.VIEW_CONTACT_SIMPLE;
break
}
if(e){
o=appCtxt.get(ZmSetting.SORTING_PREF,e)
}}
return o
};
ZmSearchController.prototype._doSearch=function(a,d,u,s){
var e=this._searchFor=a.searchFor||this._searchFor;
appCtxt.notifyZimlets("onSearch",[a.query]);
if(this._searchToolBar){
var c=(appCtxt.get(ZmSetting.SHOW_SEARCH_STRING)||a.userText)?a.query:null;
this._searchToolBar.setSearchFieldValue(c||"");
if(appCtxt.multiAccounts&&a.userText&&this.searchAllAccounts){
appCtxt.getCurrentApp().getOverviewContainer().deselectAll()
}}
var r=a.types||this.getTypes(a);
if(r instanceof Array){
r=AjxVector.fromArray(r)
}
if(e==ZmId.SEARCH_MAIL){
a=appCtxt.getApp(ZmApp.MAIL).getSearchParams(a)
}
if(e==ZmItem.TASK){
var o=AjxDispatcher.run("GetTaskListController");
a.allowableTaskStatus=(o)?o.getAllowableTaskStatus():null
}
var l=(e==ZmId.SEARCH_ANY);
if(a.searchAllAccounts&&!a.queryHint){
a.queryHint=appCtxt.accountList.generateQuery(null,r);
a.accountName=appCtxt.accountList.mainAccount.name
}else{
if(this._inclSharedItems){
a.queryHint=l?ZmSearchController.QUERY_ISREMOTE:ZmSearchController.generateQueryForShares(r.getArray())
}}
a.contactSource=(r.contains(ZmItem.CONTACT)||r.contains(ZmId.SEARCH_GAL))?this._contactSource:null;
a.sortBy=a.sortBy||this._getSuitableSortBy(r);
a.types=r;
var f=new ZmSearch(a);
var t=appCtxt.isOffline&&appCtxt.getById(f.folderId);
if(t&&(t.nId==ZmFolder.ID_DRAFTS||t.nId==ZmFolder.ID_OUTBOX)){
this.searchAllAccounts=true;
f.accountName=appCtxt.accountList.mainAccount.name;
f.query="";
f.folderId=t.nId;
f.queryHint=appCtxt.accountList.generateQuery(t.nId)
}
var h=[f,d,l,u,a.noUpdateOverview];
var m=new AjxCallback(this,this._handleResponseDoSearch,h);
if(!s){
s=new AjxCallback(this,this._handleErrorDoSearch,[f,l])
}
if(e==ZmItem.APPT){
var n=AjxDispatcher.run("GetCalController");
if(n&&r.contains(ZmItem.APPT)){
n.handleUserSearch(a,m)
}else{
f.execute({
callback:m,errorCallback:s}
)
}}else{
f.execute({
callback:m,errorCallback:s}
)
}};
ZmSearchController.prototype._handleResponseDoSearch=function(o,t,n,r,s,e){
if(this._searchFor==ZmItem.APPT){
this._results=new ZmSearchResult(o);
return
}
var a=e.getResponse();
this.currentSearch=o;
if(!a.type){
a.type=o.types.get(0)
}
if(!t){
this._showResults(a,o,n,s)
}
if(r){
r.run(e)
}};
ZmSearchController.prototype._showResults=function(o,l,h,e){
if(this._results&&(this._results.type==o.type)&&this._results.dtor){
this._results.dtor()
}
this._results=o;
var t=(this._contactSource==ZmId.SEARCH_GAL);
if(appCtxt.get(ZmSetting.SAVED_SEARCHES_ENABLED)){
var r=this._searchToolBar&&this._searchToolBar.getButton(ZmSearchToolBar.SAVE_BUTTON);
if(r){
r.setEnabled(!t)
}}
var s=h?ZmItem.MIXED:o.type;
var n=new AjxCallback(this,this._handleLoadShowResults,[o,l,e]);
var a=appCtxt.getApp(ZmItem.APP[s]);
a.currentSearch=l;
a.currentQuery=l.query;
a.showSearchResults(o,n,t,l.folderId)
};
ZmSearchController.prototype._handleLoadShowResults=function(t,e,a){
appCtxt.setCurrentList(t.getResults(t.type));
if(!a){
this.updateOverview(e)
}};
ZmSearchController.prototype._handleErrorDoSearch=function(a,o,t){
if(t.code==ZmCsfeException.MAIL_NO_SUCH_TAG||t.code==ZmCsfeException.MAIL_QUERY_PARSE_ERROR||t.code==ZmCsfeException.MAIL_TOO_MANY_TERMS||(t.code==ZmCsfeException.MAIL_NO_SUCH_FOLDER&&!(t.data.itemId&&t.data.itemId.length))){
var n=t.getErrorMsg();
appCtxt.setStatusMsg(n,ZmStatusView.LEVEL_WARNING);
var e=new ZmSearchResult(a);
e.type=a.types?a.types.get(0):null;
this._showResults(e,a,o);
return true
}
return false
};
ZmSearchController.generateQueryForShares=function(r,s){
var d=window.parentAppCtxt||window.appCtxt;
var h=[];
for(var o=0;
o<r.length;
o++){
var l=r[o];
var a=d.getApp(ZmItem.APP[l]);
if(a){
var e=a.getRemoteFolderIds(s);
for(var n=0;
n<e.length;
n++){
var t=e[n];
var c=AjxUtil.isNumeric(t)?t:['"',t,'"'].join("");
h.push("inid:"+c)
}}}
if(h.length>0){
h.push("is:local");
return h.join(" OR ")
}
return null
};
ZmSearchController.prototype._searchFieldCallback=function(t){
var e=appCtxt.get(ZmSetting.VIEW_AS_HTML);
this.search({
query:t,userText:true,getHtml:e}
)
};
ZmSearchController.prototype._searchButtonListener=function(o){
var a=this._searchToolBar.getButton(ZmSearchToolBar.SEARCH_MENU_BUTTON);
var r=a&&a.getMenu();
var t=r&&r.getSelectedItem();
var n=t&&t.getData("CustomSearchItem");
if(n){
n[2].run(o)
}else{
var h=this._searchToolBar.getSearchFieldValue();
var e=(h.length>0);
if(h){
this._currentQuery=null
}else{
h=this._currentQuery?this._currentQuery:""
}
appCtxt.notifyZimlets("onSearchButtonClick",[h]);
var s=appCtxt.get(ZmSetting.VIEW_AS_HTML);
this.search({
query:h,userText:e,getHtml:s}
)
}};
ZmSearchController.prototype._browseButtonListener=function(e){
this.showBrowseView()
};
ZmSearchController.prototype._saveButtonListener=function(t){
var e=appCtxt.getOverviewController().getTreeController(ZmOrganizer.SEARCH);
if(!e._newCb){
e._newCb=new AjxCallback(e,e._newCallback)
}
var a={
search:this._results&&this._results.search,showOverview:(this._searchFor==ZmId.SEARCH_MAIL)};
ZmController.showDialog(e._getNewDialog(),e._newCb,a)
};
ZmSearchController.prototype._searchMenuListener=function(r,e){
var o=this._searchToolBar.getButton(ZmSearchToolBar.SEARCH_MENU_BUTTON);
if(!o){
return
}
var t=o.getMenu();
var l=r?r.item:(t.getItemById(ZmSearchToolBar.MENUITEM_ID,e));
if(!l||(!!(l._style&DwtMenuItem.SEPARATOR_STYLE))){
return
}
e=l.getData(ZmSearchToolBar.MENUITEM_ID);
var a=t.getSelectedItem();
var u=t.getItemById(ZmSearchToolBar.MENUITEM_ID,ZmId.SEARCH_SHARED);
if(e==ZmId.SEARCH_GAL){
this._contactSource=ZmId.SEARCH_GAL;
if(u){
u.setChecked(false,true);
u.setEnabled(false)
}}else{
if(u){
if(e==ZmItem.APPT||e==ZmId.SEARCH_CUSTOM){
u.setChecked(false,true);
u.setEnabled(false)
}else{
u.setEnabled(true)
}}
this._contactSource=ZmItem.CONTACT
}
this._inclSharedItems=u&&u.getChecked();
var n=t.getItemById(ZmSearchToolBar.MENUITEM_ID,ZmId.SEARCH_ALL_ACCOUNTS);
if(n){
if(e==ZmItem.APPT){
this.resetSearchAllAccounts();
n.setEnabled(false)
}else{
n.setEnabled(true);
this.searchAllAccounts=n&&n.getChecked()
}}
if(e==ZmId.SEARCH_SHARED){
var s=this.searchAllAccounts?n.getImage():a.getImage();
if(this._inclSharedItems){
var d=a&&a.getData(ZmSearchToolBar.MENUITEM_ID);
s=d?((ZmSearchToolBar.SHARE_ICON[d])||l.getImage()):l.getImage()
}
o.setImage(s)
}else{
if(e==ZmId.SEARCH_ALL_ACCOUNTS){
var s=(this.searchAllAccounts&&!this._inclSharedItems)?l.getImage():(this._inclSharedItems)?this._getSharedImage(a):a.getImage();
o.setImage(s)
}else{
this._searchFor=e;
var s=l.getImage();
if(this._inclSharedItems){
s=this._getSharedImage(a)
}else{
if(this.searchAllAccounts){
s=n.getImage()
}}
o.setImage(s);
o.setText(l.getText())
}}
var c=ZmMsg[ZmSearchToolBar.TT_MSG_KEY[e]];
if(e==ZmId.SEARCH_MAIL){
var h=appCtxt.getApp(ZmApp.MAIL).getGroupMailBy();
c=ZmMsg[ZmSearchToolBar.TT_MSG_KEY[h]]
}
o.setToolTipContent(c)
};
ZmSearchController.prototype._getSharedImage=function(e){
var t=e&&e.getData(ZmSearchToolBar.MENUITEM_ID);
return(t&&ZmSearchToolBar.SHARE_ICON[t])?ZmSearchToolBar.SHARE_ICON[t]:ZmSearchToolBar.ICON[ZmId.SEARCH_SHARED]
};
ZmSearchController.prototype._getNormalizedId=function(a){
var t=a;
var e=appCtxt.getActiveAccount();
if(!e.isMain&&a.indexOf(":")==-1){
t=e.id+":"+a
}
return t
}
}
if(AjxPackage.define("zimbraMail.im.model.ZmRoster")){
ZmRoster=function(e){
ZmModel.call(this,ZmEvent.S_ROSTER);
this._gateways={
byService:{}
,byDomain:{}
,array:[]};
this._notificationBuffer=[];
this._imApp=e
};
ZmRoster.prototype=new ZmModel;
ZmRoster.prototype.constructor=ZmRoster;
ZmRoster.F_PRESENCE="ZmRoster.presence";
ZmRoster.NOTIFICATION_FOO_TIMEOUT=10000;
ZmRoster.GATEWAY_EVENT="gateway list";
ZmRoster.prototype.toString=function(){
return"ZmRoster"
};
ZmRoster.prototype.getPrivacyList=function(){
return this._privacyList=this._privacyList||new ZmImPrivacyList(this)
};
ZmRoster.prototype.getChatList=function(){
if(!this._chatList){
this._chatList=new ZmChatList(this)
}
return this._chatList
};
ZmRoster.prototype.getMyAddress=function(){
return ZmImApp.INSTANCE.getService().getMyAddress()
};
ZmRoster.prototype.getRosterItem=function(a,e){
if(!a){
return null
}
a=a.toLowerCase();
var t=this.getRosterItemList().getByAddr(a);
if(t){
return t
}
if(e){
a=ZmImAddress.parse(a);
t=a?this.getRosterItemList().getByAddr(a.screenName):null;
if(t){
return t
}
if(a){
a=this.makeServerAddress(a.screenName,a.service);
if(a){
return this.getRosterItemList().getByAddr(a)
}}}};
ZmRoster.prototype.getRosterItemList=function(){
if(!this._rosterItemList){
this._rosterItemList=new ZmRosterItemList()
}
return this._rosterItemList
};
ZmRoster.prototype.getPresence=function(){
if(!this._rosterPresence){
this._rosterPresence=new ZmRosterPresence()
}
return this._rosterPresence
};
ZmRoster.prototype.notifyPresence=function(){
var e={};
e[ZmRoster.F_PRESENCE]=this.getPresence();
this._notify(ZmEvent.E_MODIFY,{
fields:e}
)
};
ZmRoster.prototype.reload=function(t){
this.getRosterItemList().removeAllItems();
var a=new AjxCallback(this,this._handleResponseReload);
var e={
asyncMode:true,noBusyOverlay:t};
ZmImApp.INSTANCE.getService().getRoster(a,e)
};
ZmRoster.prototype._handleResponseReload=function(r){
if(!r){
return
}
var s=this.getRosterItemList();
if(r.items&&r.items.item){
var t=r.items.item;
if(t.length){
var e=new Array(t.length);
for(var a=0;
a<t.length;
a++){
var n=t[a];
if(n.subscription=="TO"||n.subscription=="BOTH"){
var o=new ZmRosterPresence();
o.setFromJS(n.presence);
e[a]=new ZmRosterItem(n.addr,s,n.name,o,n.groups)
}}
s.addItems(e)
}}
if(r.presence){
if(/XA|AWAY/.test(r.presence.show)){
r.presence.show="ONLINE";
this.setPresence("ONLINE")
}
this.getPresence().setFromJS(r.presence);
this.notifyPresence()
}
ZmImApp.INSTANCE.getService().startIgnoreNotify()
};
ZmRoster.prototype.createRosterItem=function(a,t,e){
ZmImApp.INSTANCE.getService().createRosterItem(a,t,e)
};
ZmRoster.prototype.setPresence=function(e,t,a,o){
ZmImApp.INSTANCE.getService().setPresence(e,t,a,o);
ZmImApp.INSTANCE.getService().startIgnoreNotify()
};
ZmRoster.prototype.pushNotification=function(e){
if(!this._gateways){
this._notificationBuffer.push(e)
}else{
this.handleNotification(e)
}};
ZmRoster.prototype.refresh=function(){
this._requestGateways(new AjxCallback(this,this.reload))
};
ZmRoster.prototype.handleNotification=function(e){
ZmImApp.INSTANCE.getService().handleNotification(e)
};
ZmRoster.prototype.getConferenceTree=function(){
AjxDispatcher.require(["IMConference"]);
if(!this._conferenceTree){
this._conferenceTree=new ZmTree(ZmOrganizer.CONFERENCE_ITEM);
this._conferenceTree.root=new ZmOrganizer({
tree:this._conferenceTree}
)
}
return this._conferenceTree
};
ZmRoster.prototype.getConferenceServices=function(o,a){
var e=this.getConferenceTree();
if(!e.root.children.size()||a){
var t=new AjxCallback(this,this._handleResponceGetConferenceServices,[o]);
ZmImApp.INSTANCE.getService().getConferenceServices(t)
}else{
o.run(e.root.children.getArray())
}};
ZmRoster.prototype._handleResponceGetConferenceServices=function(h,s){
var t=this.getConferenceTree();
var a=t.root;
for(var n=0,r=s.length;
n<r;
n++){
var o={
id:s[n].addr,tree:t,name:s[n].name,parent:a};
var e=new ZmConferenceService(o);
a.children.add(e)
}
h.run(a.children.getArray())
};
ZmRoster.prototype.joinChatRequest=function(e,o){
var t=AjxSoapDoc.create("IMJoinConferenceRoomRequest","urn:zimbraIM");
var a=t.getMethod();
a.setAttribute("thread",e);
a.setAttribute("addr",o);
appCtxt.getAppController().sendRequest({
soapDoc:t,asyncMode:true}
)
};
ZmRoster.prototype.sendSubscribeAuthorization=function(e,t,a){
ZmImApp.INSTANCE.getService().sendSubscribeAuthorization(e,t,a)
};
ZmRoster.prototype.addGatewayListListener=function(e){
this._evtMgr.addListener(ZmRoster.GATEWAY_EVENT,e)
};
ZmRoster.prototype.reconnectGateway=function(e){
ZmImApp.INSTANCE.getService().reconnectGateway(e);
ZmImApp.INSTANCE.getService().startIgnoreNotify()
};
ZmRoster.prototype.unregisterGateway=function(e,t){
ZmImApp.INSTANCE.getService().unregisterGateway(e,t);
ZmImApp.INSTANCE.getService().startIgnoreNotify()
};
ZmRoster.prototype.registerGateway=function(e,o,a,t){
ZmImApp.INSTANCE.getService().registerGateway(e,o,a,t);
ZmImApp.INSTANCE.getService().startIgnoreNotify();
this.getGatewayByType(e).nick=o
};
ZmRoster.prototype._requestGateways=function(e){
ZmImApp.INSTANCE.getService().getGateways(new AjxCallback(this,this._handleRequestGateways,[e]))
};
ZmRoster.prototype._handleRequestGateways=function(s,n){
var a={};
var e={};
for(var t=0;
t<n.length;
++t){
var o=n[t]=new ZmImGateway(n[t]);
a[n[t].type.toLowerCase()]=o;
e[n[t].domain.toLowerCase()]=o
}
this._gateways={
byService:a,byDomain:e,array:n};
for(var t=0;
t<this._notificationBuffer.length;
++t){
this.handleNotification(this._notificationBuffer[t])
}
this._notificationBuffer=[];
this._evtMgr.notifyListeners(ZmRoster.GATEWAY_EVENT,{
roster:this}
);
if(s){
s.run()
}};
ZmRoster.prototype.getGatewayByType=function(e){
return this._gateways.byService[e.toLowerCase()]
};
ZmRoster.prototype.getGatewayByDomain=function(e){
return this._gateways.byDomain[e.toLowerCase()]
};
ZmRoster.prototype.getGateways=function(){
return this._gateways.array
};
ZmRoster.prototype.makeServerAddress=function(t,e){
return ZmImApp.INSTANCE.getService().makeServerAddress(t,e)
};
ZmRoster.prototype.makeGenericAddress=function(e){
e=this.breakDownAddress(e);
if(e.type.toLowerCase()=="xmpp"){
e.type="local"
}
return ZmImAddress.make(e.type,e.addr)
};
ZmRoster.prototype.breakDownAddress=function(o){
var t=/@(.*)$/;
var e=t.exec(o);
if(e){
var a=this.getGatewayByDomain(e[1]);
if(a){
return{
type:a.type,addr:o.substr(0,e.index),gateway:a}
}}
return{
type:"XMPP",addr:o}
};
ZmRoster.prototype.getGroups=function(){
return AjxVector.fromArray(this.getRosterItemList().getGroupsArray())
};
ZmRoster.prototype.setIdle=function(e){
if(ZmImApp.INSTANCE.getService().isLoggedIn()){
ZmImApp.INSTANCE.getService().setIdle(e,this._idleTimer.timeout)
}};
ZmRoster.prototype.onServiceAddChatMessage=function(e){
appCtxt.getApp(ZmApp.IM).prepareVisuals();
var o=this.getRosterItem(e.from);
if(o){
o._notifyTyping(false)
}
var a=this.getChatList();
var t=a.getChatByThread(e.thread);
if(t==null){
if(!e.fromMe){
t=a.getChatByRosterAddr(e.from,true,true)
}else{
t=a.getChatByRosterAddr(e.to,false)
}
if(t){
t.setThread(e.thread)
}}
if(t){
if(!e.fromMe){
if(appCtxt.get(ZmSetting.IM_PREF_FLASH_BROWSER)){
AjxDispatcher.require("Alert");
ZmBrowserAlert.getInstance().start(ZmMsg.newInstantMessage)
}
if(appCtxt.get(ZmSetting.IM_PREF_DESKTOP_ALERT)){
AjxDispatcher.require("Alert");
ZmDesktopAlert.getInstance().start(ZmMsg.newInstantMessage,e.getTextBody())
}}
t.addMessage(e)
}};
ZmRoster.prototype.onServiceAddBuddy=function(h,o,n,t,a){
var r=this.getRosterItemList();
var s=new ZmRosterItem(h,r,o,n,t);
r.addItem(s);
if(a){
this._newRosterItemtoastFormatter=this._newRosterItemtoastFormatter||new AjxMessageFormat(ZmMsg.imNewRosterItemToast);
var e=this._newRosterItemtoastFormatter.format([s.getDisplayName()]);
ZmTaskbarController.INSTANCE.setMessage(e)
}};
ZmRoster.prototype.onServiceRemoveBuddy=function(n,t){
var o=this.getRosterItemList();
var a=o.getByAddr(n);
if(a){
var e=a.getDisplayName();
o.removeItem(a);
if(t){
this._removeRosterItemToastFormatter=this._removeRosterItemToastFormatter||new AjxMessageFormat(ZmMsg.imRemoveRosterItemToast);
ZmTaskbarController.INSTANCE.setMessage(this._removeRosterItemToastFormatter.format([e]))
}}};
ZmRoster.prototype.onServiceRequestBuddyAuth=function(t){
var e=this.getRosterItem(t);
ZmTaskbarController.INSTANCE.showSubscribeRequest(t,e)
};
ZmRoster.prototype.onServiceSetBuddyPresence=function(s,r,o){
var n=s.getPresence().getShow();
if(s.getPresence().setFromJS(r)){
s._notifyPresence();
if(n!=ZmRosterPresence.SHOW_UNKNOWN){
this._presenceToastFormatter=this._presenceToastFormatter||new AjxMessageFormat(ZmMsg.imStatusToast);
var t=this._presenceToastFormatter.format([s.getDisplayName(),AjxStringUtil.htmlEncode(s.getPresence().getShowText())]);
var e=n==s.getPresence().getShow();
if(o&&((!e&&appCtxt.get(ZmSetting.IM_PREF_NOTIFY_PRESENCE))||(e&&appCtxt.get(ZmSetting.IM_PREF_NOTIFY_STATUS)))){
ZmTaskbarController.INSTANCE.setMessage(t);
var a=this.getChatList().getChatByRosterAddr(r.from);
if(a){
a.addMessage(ZmChatMessage.system(t))
}}}}};
ZmRoster.prototype.onServiceLoggedIn=function(t){
if(!this._idleTimer){
this._idleTimer=new DwtIdleTimer(appCtxt.get(ZmSetting.IM_PREF_IDLE_TIMEOUT)*60*1000,new AjxCallback(this,this.setIdle));
if(!appCtxt.get(ZmSetting.IM_PREF_REPORT_IDLE)){
this._idleTimer.kill()
}}
this._notify(ZmEvent.E_LOAD,{
loggedIn:true}
);
var a=new AjxCallback(this,this._loggedInGatewayCallback,[t]);
var e={
asyncMode:true,noBusyOverlay:true};
ZmImApp.INSTANCE.getService().getGateways(a,e)
};
ZmRoster.prototype._loggedInGatewayCallback=function(e,t){
this._handleRequestGateways(null,t);
ZmImApp.INSTANCE.getService().initializePresence(e?e.presence:null);
this.reload();
if(e&&e.callback){
e.callback.run(this)
}};
ZmRoster.prototype.onServiceLoggedOut=function(){
if(this.getPresence().setFromJS({
show:ZmRosterPresence.SHOW_OFFLINE}
)){
this.notifyPresence()
}
this.getRosterItemList().removeAllItems();
this._notify(ZmEvent.E_LOAD,{
loggedIn:false}
)
};
ZmRosterTreeGroups=function(e){
this._groups=e.getGroups()
};
ZmRosterTreeGroups.prototype.constructor=ZmRosterTreeGroups;
ZmRosterTreeGroups.prototype.autocompleteMatch=function(r,h){
r=r.toLowerCase();
var e=[];
var t=this._groups;
var s=t.size();
for(var o=0;
o<s;
o++){
var n=t.get(o);
if(n.toLowerCase().indexOf(r)==0){
e.push({
data:n,text:n}
)
}}
h.run(e)
};
ZmRosterTreeGroups.prototype.isUniqueValue=function(e){
return false
};
ZmRosterTreeGroups.prototype.getArray=function(){
return this._groups
}
}
if(AjxPackage.define("zimbraMail.im.view.ZmImOverview")){
ZmImOverview=function(e,a){
if(!a){
a={}
}
var t={
parent:e,parentElement:a.parentElement,className:"ZmImOverview",posStyle:a.posStyle||Dwt.ABSOLUTE_STYLE};
DwtComposite.call(this,t);
this._groupItems={};
this._itemsById={};
delete a.parentElement;
this._options=a;
this._sortBy=appCtxt.get("IM_PREF_BUDDY_SORT");
this._actionMenuOps={
root:[ZmOperation.NEW_ROSTER_ITEM,ZmOperation.NEW_ROSTER_GROUP,ZmOperation.SEP,ZmOperation.IM_TOGGLE_OFFLINE,ZmOperation.IM_TOGGLE_BLOCKED,ZmOperation.SEP,ZmOperation.IM_SORT_BY_PRESENCE,ZmOperation.IM_SORT_BY_NAME],buddy:[ZmOperation.IM_NEW_CHAT,ZmOperation.IM_BUDDY_ARCHIVE,ZmOperation.SEP,ZmOperation.EDIT_PROPS,ZmOperation.DELETE,ZmOperation.SEP,ZmOperation.IM_CREATE_CONTACT,ZmOperation.IM_ADD_TO_CONTACT,ZmOperation.IM_EDIT_CONTACT],assistant:[ZmOperation.IM_NEW_CHAT],group:[ZmOperation.NEW_ROSTER_ITEM,ZmOperation.IM_DELETE_GROUP]};
this._actionMenuPopdownListener=new AjxListener(this,this._actionMenuPopdownListener);
this._im_dragSrc=new DwtDragSource(Dwt.DND_DROP_MOVE);
this._im_dragSrc.addDragListener(new AjxListener(this,this._dragListener));
this.__filters=[];
this.__filterOffline=appCtxt.get(ZmSetting.IM_PREF_HIDE_OFFLINE);
if(this.__filterOffline){
this.__filters.push(ZmImOverview.FILTER_OFFLINE_BUDDIES)
}
this.__filterBlocked=appCtxt.get(ZmSetting.IM_PREF_HIDE_BLOCKED);
if(this.__filterBlocked){
this.__filters.push(ZmImOverview.FILTER_BLOCKED_BUDDIES)
}
this._modelListeners=[];
this._init()
};
ZmImOverview.prototype=new DwtComposite;
ZmImOverview.prototype.constructor=ZmImOverview;
ZmImOverview.prototype.toString=function(){
return"ZmImOverview"
};
ZmImOverview.NO_MESSAGE=0;
ZmImOverview.NOT_LOGGED_IN=1;
ZmImOverview.LOADING=2;
ZmImOverview.NO_BUDDIES=3;
ZmImOverview.prototype.dispose=function(){
for(var e in this._actionMenuOps){
var n=this._actionMenuOps[e]._dwtControl;
if(n){
n.dispose()
}}
for(var t=0,a=this._modelListeners.length;
t<a;
t++){
var o=this._modelListeners[t];
o.modelObject.removeChangeListener(o.listener)
}
DwtComposite.prototype.dispose.call(this)
};
ZmImOverview.prototype.getTree=function(){
return this._tree
};
ZmImOverview.prototype._dragListener=function(e){
var t=e.srcControl.getData("ZmImOverview.data");
switch(e.action){
case DwtDragEvent.SET_DATA:if(t.buddy){
e.srcData=t.buddy;
e.srcData._drag_from_group=e.srcControl.parent.getData("ZmImOverview.data").group
}
break
}};
ZmImOverview.prototype._setCheck=function(e,t){
e.setImage(t?"Check":null)
};
ZmImOverview.prototype._setCheckOp=function(a,o,t){
var e=a.getMenuItem(o);
if(e){
this._setCheck(e,t)
}};
ZmImOverview.prototype._updateFilter=function(t,e){
if(e){
this.addFilter(t)
}else{
this.removeFilter(t)
}};
ZmImOverview.prototype._newGroupOkCallback=function(a){
var t;
if(!a.value){
t=ZmMsg.nameEmpty
}else{
if(this._groupItems[a.value]){
t=ZmMsg.imGroupExists
}}
if(t){
var e=appCtxt.getMsgDialog();
e.reset();
e.setMessage(t,DwtMessageDialog.CRITICAL_STYLE);
e.popup()
}else{
this._updateSpecialItems(ZmImOverview.NO_MESSAGE);
this.getGroupItem(a.value).setExpanded(true);
a.dialog.popdown()
}};
ZmImOverview.prototype._actionMenuListener=function(a,o){
var e=o.item.getData(ZmOperation.KEY_ID);
switch(e){
case ZmOperation.IM_SORT_BY_PRESENCE:this.sort(ZmImApp.BUDDY_SORT_PRESENCE,true);
break;
case ZmOperation.IM_SORT_BY_NAME:this.sort(ZmImApp.BUDDY_SORT_NAME,true);
break;
case ZmOperation.IM_TOGGLE_OFFLINE:this.__filterOffline=!this.__filterOffline;
appCtxt.getSettings().getSetting(ZmSetting.IM_PREF_HIDE_OFFLINE).setValue(this.__filterOffline);
this._updateFilter(ZmImOverview.FILTER_OFFLINE_BUDDIES,this.__filterOffline);
break;
case ZmOperation.IM_TOGGLE_BLOCKED:this.__filterBlocked=!this.__filterBlocked;
appCtxt.getSettings().getSetting(ZmSetting.IM_PREF_HIDE_BLOCKED).setValue(this.__filterBlocked);
this._updateFilter(ZmImOverview.FILTER_BLOCKED_BUDDIES,this.__filterBlocked);
break;
case ZmOperation.NEW_ROSTER_GROUP:this._newGroupOkCallbackObj=this._newGroupOkCallbackObj||new AjxCallback(this,this._newGroupOkCallback);
AjxDispatcher.require(["IM"]);
var h={
title:ZmMsg.imCreateNewGroup,label:ZmMsg.imGroupName,callback:this._newGroupOkCallbackObj};
ZmPromptDialog.getInstance().popup(h);
break;
default:var r=appCtxt.getApp("IM").getImController();
var s=r._listeners[e];
if(s){
var t={
dwtObj:o.dwtObj};
if(a&&this._actionedItem){
var n=this._actionedItem.getData("ZmImOverview.data");
t.type=n.type;
t.buddy=n.buddy;
t.group=n.group;
t.actionedItem=this._actionedItem
}
s.handleEvent(t)
}}};
ZmImOverview.PRESENCE_SORT_INDEX={
CHAT:1,ONLINE:2,AWAY:3,XA:4,DND:5,OFFLINE:6,UNKNOWN:7};
ZmImOverview.CMP_SORT_BY_NAME=function(t,e){
t=t.getData("ZmImOverview.data").buddy.getDisplayName();
e=e.getData("ZmImOverview.data").buddy.getDisplayName();
return t<e?-1:(t>e?1:0)
};
ZmImOverview.CMP_SORT_BY_PRESENCE=function(o,t){
var e=ZmImOverview.PRESENCE_SORT_INDEX[o.getData("ZmImOverview.data").buddy.getPresence().getShow()]||100;
var n=ZmImOverview.PRESENCE_SORT_INDEX[t.getData("ZmImOverview.data").buddy.getPresence().getShow()]||100;
if(e==n){
return ZmImOverview.CMP_SORT_BY_NAME(o,t)
}
return e-n
};
ZmImOverview.prototype.sort=function(t,e){
if(t&&(t!=this._sortBy)){
this._sortBy=t;
appCtxt.getSettings().getSetting("IM_PREF_BUDDY_SORT").setValue(t)
}
if(e){
if(this._sortActionId){
AjxTimedAction.cancelAction(this._sortActionId)
}
this._doSort()
}else{
if(!this._sortActionId){
this._doSortAction=this._doSortAction||new AjxTimedAction(this,this._doSort);
this._sortActionId=AjxTimedAction.scheduleAction(this._doSortAction,1000)
}}};
ZmImOverview.prototype._doSort=function(){
this._sortActionId=null;
var e=this._rootItem;
var t=e.getItems();
var n=this._sortBy==ZmImApp.BUDDY_SORT_PRESENCE?ZmImOverview.CMP_SORT_BY_PRESENCE:ZmImOverview.CMP_SORT_BY_NAME;
for(var a=0;
a<t.length;
++a){
var o=t[a];
o.sort(n)
}};
ZmImOverview.prototype.chatWithBuddy=function(e){
ZmTaskbarController.INSTANCE.chatWithRosterItem(e);
ZmImOverview._popdownDialog()
};
ZmImOverview.prototype._actionMenuPopdownListener=function(){
if(this._actionedItem){
this._actionedItem._setActioned(false)
}};
ZmImOverview.prototype._getActionMenu=function(o,c,d){
var t=this._actionMenuOps[o];
if(t){
var e=t._dwtControl;
if(!e){
var l=this;
while(l&&!(l instanceof DwtDialog)){
l=l.parent
}
e=t._dwtControl=new ZmActionMenu({
parent:this,menuItems:t}
);
var a=new AjxListener(this,this._actionMenuListener,[true]);
for(var n=0;
n<e.opList.length;
++n){
var u=e.opList[n];
e.addSelectionListener(u,a)
}
e.addPopdownListener(this._actionMenuPopdownListener)
}
if(o=="buddy"){
var h=c.getContact();
e.getOp(ZmOperation.IM_ADD_TO_CONTACT).setVisible(!h);
e.getOp(ZmOperation.IM_CREATE_CONTACT).setVisible(!h);
e.getOp(ZmOperation.IM_EDIT_CONTACT).setVisible(!!h)
}else{
if(o=="root"){
var r=ZmImApp.loggedIn();
for(var n=0,s=e.opList.length;
n<s;
n++){
var u=e.getMenuItem(e.opList[n]);
if(u){
u.setEnabled(r)
}}
if(r){
this._setCheckOp(e,ZmOperation.IM_TOGGLE_OFFLINE,this.__filterOffline);
this._setCheckOp(e,ZmOperation.IM_TOGGLE_BLOCKED,this.__filterBlocked);
this._setCheckOp(e,ZmOperation.IM_SORT_BY_PRESENCE,this._sortBy==ZmImApp.BUDDY_SORT_PRESENCE);
this._setCheckOp(e,ZmOperation.IM_SORT_BY_NAME,this._sortBy==ZmImApp.BUDDY_SORT_NAME)
}}}
return e
}};
ZmImOverview.prototype._treeMouseUpListener=function(a){
if((a.button==DwtMouseEvent.RIGHT)){
if(!this._treeViewActionMenu){
var n=[ZmOperation.NEW_ROSTER_ITEM,ZmOperation.IM_NEW_CHAT];
this._treeViewActionMenu=new ZmActionMenu({
parent:this.shell,menuItems:n}
);
var o=new AjxListener(this,this._actionMenuListener,[false]);
for(var e=0,t=n.length;
e<t;
e++){
this._treeViewActionMenu.addSelectionListener(n[e],o)
}}
this._treeViewActionMenu.popup(0,a.docX,a.docY)
}};
ZmImOverview.prototype._treeSelectionListener=function(a){
if(a.detail!=DwtTree.ITEM_ACTIONED&&a.detail!=DwtTree.ITEM_SELECTED&&a.detail!=DwtTree.ITEM_DBL_CLICKED){
return
}
var o=a.item.getData("ZmImOverview.data");
var t=o.type;
var n=o.group;
var e=o.buddy;
if(a.detail==DwtTree.ITEM_ACTIONED){
var s=this._getActionMenu(t,e,n);
if(s){
this._actionedItem=a.item;
s.popup(0,a.docX,a.docY)
}}else{
if(a.detail==DwtTree.ITEM_SELECTED&&e){
if(this._options.singleClick){
DwtMenu.closeActiveMenu();
this.chatWithBuddy(e)
}else{
ZmTaskbarController.INSTANCE.selectChatForRosterItem(e)
}}else{
if(a.detail==DwtTree.ITEM_DBL_CLICKED){
if(!this._options.singleClick){
if(e){
this.chatWithBuddy(e)
}else{
if(n){
a.item.setExpanded(!a.item.getExpanded())
}}}}}}};
ZmImOverview.prototype._init=function(){
var a=this._groupDropTgt=new DwtDropTarget(["ZmRosterItem"]);
a.addDropListener(new AjxListener(this,this._groupDropListener));
var s={
parent:this,className:this._options.overviewId?"OverviewTree":null};
var t=this._tree=new DwtTree(s);
t.getHtmlElement().style.width="100%";
if(!this._options.overviewId){
t.getHtmlElement().style.overflow="auto"
}
if(!this._options.inactiveTree){
t.addSelectionListener(new AjxListener(this,this._treeSelectionListener))
}
t.addListener(DwtEvent.ONMOUSEUP,new AjxListener(this,this._treeMouseUpListener));
this._rootItem=new DwtHeaderTreeItem({
parent:t,overview:this,className:"overviewHeader",noNodeCell:this._options.noHeaderNodeCell}
);
this._rootItem.setData("ZmImOverview.data",{
type:"root"}
);
this._rootItem.setText(ZmMsg.buddyList);
this._rootItem.enableSelection(false);
var r=this._roster=AjxDispatcher.run("GetRoster");
if(!this._options.noAssistant){
var o=r.getRosterItemList();
var n=new ZmAssistantBuddy(o);
this._createTreeItems("assistant",n)
}
this._listen(r,new AjxListener(this,this._rosterListener));
this._listen(r.getRosterItemList(),new AjxListener(this,this._rosterItemListListener));
var e=ZmImApp.loggedIn();
if(e){
o=r.getRosterItemList()
}
if(e&&o.size()){
this._updateSpecialItems(ZmImOverview.NO_MESSAGE);
o.getVector().foreach(this._createBuddy,this);
this.sort()
}else{
this._updateSpecialItems(e?ZmImOverview.NO_BUDDIES:ZmImOverview.NOT_LOGGED_IN)
}
t.addSeparator();
if(!this._options.overviewId){
this.addControlListener(new AjxListener(this,this._controlListener))
}
if(this._options.expanded){
this._rootItem.setExpanded(true)
}else{
t.addTreeListener(new AjxListener(this,this._treeListener))
}};
ZmImOverview.prototype._treeListener=function(e){
if(!this._didInitialExpand&&(e.detail==DwtTree.ITEM_EXPANDED)&&e.items.length&&(e.items[0]==this._rootItem)){
var t=this._groupItems[ZmMsg.buddies];
if(t){
t.setExpanded(true)
}
this._didInitialExpand=true
}};
ZmImOverview.prototype._controlListener=function(o){
var t={
x:o.oldWidth,y:o.oldHeight};
var e={
x:o.newWidth,y:o.newHeight};
if(t.x!=e.x||t.y!=e.y){
var a=e.y;
if(AjxEnv.isIE){
a-=2
}
this._tree.setSize(Dwt.DEFAULT,a)
}};
ZmImOverview._popdownDialog=function(){
if(ZmImNewChatDlg._INSTANCE){
ZmImNewChatDlg._INSTANCE.popdown()
}};
ZmImOverview.login=function(){
ZmImApp.INSTANCE.login()
};
ZmImOverview.newBuddy=function(){
ZmImApp.INSTANCE.prepareVisuals();
ZmImOverview._popdownDialog();
ZmImApp.INSTANCE.getImController()._newRosterItemListener()
};
ZmImOverview.prototype._updateSpecialItems=function(t){
var e=this._rootItem.getExpanded();
if(t==ZmImOverview.NO_MESSAGE){
if(this._infoItem){
this._infoItem.dispose();
this._infoItem=null
}
if(ZmImOverview.FILTER_SEARCH&&!this._filterItem){
this._filterItem=new ZmBuddyFilterItem({
parent:this._rootItem,overview:this}
);
this._filterItem.setData("ZmImOverview.data",{
type:"filter"}
)
}}else{
if(!this._infoItem){
this._rootItem.removeChildren();
this._filterItem=null;
this._groupItems={};
this._infoItem=new ZmInfoTreeItem({
parent:this._rootItem}
);
this._infoItem.setData("ZmImOverview.data",{
type:"infoItem"}
)
}
var a;
switch(t){
case ZmImOverview.NOT_LOGGED_IN:a=AjxMessageFormat.format(ZmMsg.imNotLoggedIn,"ZmImOverview.login()");
break;
case ZmImOverview.LOADING:a=ZmMsg.loading;
break;
case ZmImOverview.NO_BUDDIES:a=AjxMessageFormat.format(ZmMsg.imNoBuddies,"ZmImOverview.newBuddy()");
break
}
this._infoItem.setText(a)
}
if(e){
this._rootItem.setExpanded(true)
}};
ZmImOverview.prototype._listen=function(e,t){
e.addChangeListener(t);
this._modelListeners.push({
modelObject:e,listener:t}
)
};
ZmImOverview.prototype._rosterListener=function(e){
if(e.event==ZmEvent.E_LOAD){
this._updateSpecialItems(e.getDetails().loggedIn?ZmImOverview.LOADING:ZmImOverview.NOT_LOGGED_IN)
}};
ZmImOverview.prototype._rosterItemListListener=function(t){
var e=t.getDetail("fields");
if(t.event==ZmEvent.E_LOAD){
if(!t.source.size()){
this._updateSpecialItems(ZmImOverview.NO_BUDDIES)
}}else{
if(t.event==ZmEvent.E_CREATE){
if(this._infoItem){
this._updateSpecialItems(ZmImOverview.NO_MESSAGE)
}
var a=AjxVector.fromArray(t.getItems());
a.foreach(this._createBuddy,this);
if(a.size()){
this.sort()
}}else{
if(t.event==ZmEvent.E_MODIFY){
this._modifyBuddies(t.getItems(),e)
}else{
if(t.event==ZmEvent.E_REMOVE||t.event==ZmEvent.E_DELETE){
var a=AjxVector.fromArray(t.getItems());
a.foreach(this._removeBuddy,this)
}}}}};
ZmImOverview.prototype._groupDropListener=function(n){
if(!n.srcData){
return false
}
if(n.action==DwtDropEvent.DRAG_ENTER){
n.doIt=this._groupDropTgt.isValidTarget(n.srcData)
}else{
if(n.action==DwtDropEvent.DRAG_DROP){
var o=n.srcData;
var t=o._drag_from_group;
var s=n.targetControl.getData("ZmImOverview.data").group;
var e=AjxVector.fromArray(o.getGroups());
if(t!=s&&e.indexOf(s)==-1){
e.remove(t);
e.add(s);
var a=o.getDisplayName();
var r=o.getAddress();
AjxDispatcher.run("GetRoster").createRosterItem(r,a,e.join(","))
}}}};
ZmImOverview.prototype._getBuddyIcon=function(e){
var a=AjxDispatcher.run("GetRoster");
var t=a.getPrivacyList();
return t.isDenied(e.getAddress())?"BlockUser":e.getPresence().getIcon()
};
ZmImOverview.prototype._createBuddy=function(e){
return this._createTreeItems("buddy",e)
};
ZmImOverview.prototype._createTreeItems=function(s,o){
var e=o.getGroups();
if(e.length==0){
e=s=="buddy"?[ZmMsg.buddies]:[null]
}
var l=o.getDisplayName();
var r=this._getBuddyIcon(o);
var n=[];
var d=this._rootItem.getExpanded();
for(var t=0;
t<e.length;
++t){
var c=this.getGroupItem(e[t]);
var u=new DwtTreeItem({
parent:c,index:this.getSortIndex(o,c),text:AjxStringUtil.htmlEncode(l),imageInfo:r,singleClickAction:this._options.singleClick}
);
u.addClassName("ZmImPresence-"+o.getPresence().getShow());
u.setToolTipContent("-");
u.getToolTipContent=AjxCallback.simpleClosure(o.getToolTip,o);
u.setData("ZmImOverview.data",{
type:s,buddy:o}
);
u.setDragSource(this._im_dragSrc);
n.push(u);
if(this._options.expanded||(d&&(e[t]==ZmMsg.buddies))){
c.setExpanded(true)
}
var h=this._itemsById[o.getAddress()];
if(!h){
h=this._itemsById[o.getAddress()]=new AjxVector()
}
h.add(u)
}
this.applyFilters(n)
};
ZmImOverview.prototype._modifyBuddies=function(e,r){
var o=false;
var d=false;
for(var n=0,h=e.length;
n<h;
n++){
var l=e[n];
var c=this._itemsById[l.getAddress()];
if(c){
var u=ZmRosterItem.F_GROUPS in r;
if(u){
this._removeBuddy(l);
this._createTreeItems("buddy",l)
}else{
var t=ZmRosterItem.F_PRESENCE in r;
var m=ZmRosterItem.F_UNREAD in r;
var s=ZmRosterItem.F_NAME in r;
var a=ZmRosterItem.F_TYPING in r;
o=o||t;
d=d||s;
c.foreach(function(p){
if(t){
p.setImage(this._getBuddyIcon(l));
p.setClassName(p.getClassName());
p.addClassName("ZmImPresence-"+l.getPresence().getShow())
}
if(m||s){
var f=l.getDisplayName();
if(l.getUnread()){
f+=" ("+l.getUnread()+")";
f=f.bold()
}
p.setText(f)
}
if(a){
p.condClassName(r[ZmRosterItem.F_TYPING],"ZmRosterItem-typing")
}}
,this);
this.applyFilters(c.getArray())
}}}
if((o&&(this._sortBy==ZmImApp.BUDDY_SORT_PRESENCE))||(d)){
this.sort()
}};
ZmImOverview.prototype._removeBuddy=function(t){
var e=this._itemsById[t.getAddress()];
e.foreach("dispose");
this._itemsById[t.getAddress()]=null
};
ZmImOverview.prototype.getGroupItem=function(t){
if(!t){
return this._rootItem
}
var e=this._groupItems[t];
if(!e){
e=this._groupItems[t]=new DwtTreeItem({
parent:this._rootItem,index:this.getSortIndex(t),text:AjxStringUtil.htmlEncode(t),imageInfo:"ImGroup"}
);
e.setToolTipContent("-");
e.getToolTipContent=function(){
var a=this.getData("ZmImOverview.data");
return AjxMessageFormat.format(ZmMsg.imGroupItemTooltip,[a.group,this.getItemCount()])
};
e.setData("ZmImOverview.data",{
type:"group",group:t}
);
e.setDropTarget(this._groupDropTgt)
}
return e
};
ZmImOverview.prototype.getSortIndex=function(c,h){
var s="buddy";
if(h==null){
s="group";
h=this._rootItem;
c=c.toLowerCase()
}
var n=h.getItems();
for(var t=0;
t<n.length;
++t){
var d=n[t];
var e=d.getData("ZmImOverview.data");
if(e.type=="filter"||e.type=="infoItem"){
continue
}
if(s=="buddy"){
if(this._sortBy==ZmImApp.BUDDY_SORT_NAME){
var o=e.buddy.getDisplayName();
if(o&&o.toLowerCase()>c.getDisplayName()){
break
}}else{
if(this._sortBy==ZmImApp.BUDDY_SORT_PRESENCE){
var l=ZmImOverview.PRESENCE_SORT_INDEX[e.buddy.getPresence().getShow()]||100;
var r=ZmImOverview.PRESENCE_SORT_INDEX[c.getPresence().getShow()]||100;
if(l>r){
break
}}}}else{
var o=e.group;
if(o&&o.toLowerCase()>c){
break
}}}
return t
};
ZmImOverview.prototype.addFilter=function(t){
for(var e=this.__filters.length;
--e>=0;
){
if(this.__filters[e]===t){
this.__filters.splice(e,1)
}}
this.__filters.push(t);
this.applyFilters()
};
ZmImOverview.prototype.removeFilter=function(t){
if(!this.__filters.length){
return
}
for(var e=this.__filters.length;
--e>=0;
){
if(this.__filters[e]===t){
this.__filters.splice(e,1)
}}
this.applyFilters(null,true)
};
ZmImOverview.prototype.applyFilters=function(s,o){
var e=this.__filters;
if(!e.length&&!o){
return
}
this._firstFilterItem=null;
var n=function(d){
var p=false;
for(var u=d.length;
--u>=0;
){
var m=d[u];
var y=true;
for(var c=e.length;
--c>=0;
){
var g=e[c];
if(g.call(this,m)){
y=false;
break
}}
if(!this._firstFilterItem&&y){
this._firstFilterItem=m
}
p=p||y;
m.setVisible(y)
}
return p
};
if(s){
n.call(this,s)
}else{
if(this._rootItem){
var r=this._rootItem;
var t=r.getItems();
for(var a=t.length;
--a>=0;
){
var h=t[a];
var s=h.getItems();
var l=n.call(this,s)||s.length==0;
h.setVisible(l);
if(l){
h.setExpanded(true)
}}}}};
ZmImOverview.FILTER_OFFLINE_BUDDIES=function(a){
var e=a.getData("ZmImOverview.data").buddy;
var t=e.getPresence();
return t.getShow()==ZmRosterPresence.SHOW_OFFLINE
};
ZmImOverview.FILTER_BLOCKED_BUDDIES=function(t){
var e=t.getData("ZmImOverview.data").buddy;
return AjxDispatcher.run("GetRoster").getPrivacyList().isDenied(e.getAddress())
};
ZmImOverview.FILTER_SEARCH={
func:function(a){
var t=this.__searchInputEl.value.toLowerCase();
var e=a.getData("ZmImOverview.data").buddy;
if(/^#/.test(t)){
return e.getAddress().indexOf(t.substr(1))<0
}else{
return e.getDisplayName().toLowerCase().indexOf(t)<0
}}
,_doKeyPress:function(){
var e=this.__searchInputEl.value;
if(!/\S/.test(e)||e==ZmMsg.filter){
this.removeFilter(ZmImOverview.FILTER_SEARCH.func)
}else{
this.addFilter(ZmImOverview.FILTER_SEARCH.func)
}}
,inputFocus:function(){
Dwt.delClass(this.__searchInputEl,"DwtSimpleInput-hint","DwtSimpleInput-focused");
if(this.__searchInputEl.value==ZmMsg.filter){
this.__searchInputEl.value=""
}else{
try{
this.__searchInputEl.select()
}
catch(e){}}}
,inputBlur:function(){
Dwt.delClass(this.__searchInputEl,"DwtSimpleInput-focused","DwtSimpleInput-hint");
if(!/\S/.test(this.__searchInputEl.value)){
this.__searchInputEl.value=ZmMsg.filter
}}
,inputKeyPress:function(t){
if(!t){
t=window.event
}
if(this.__searchInputTimeout){
clearTimeout(this.__searchInputTimeout)
}
if(t.keyCode==27){
this.__searchInputEl.value="";
ZmImOverview.FILTER_SEARCH._doKeyPress.call(this);
ZmImOverview.FILTER_SEARCH.inputBlur.call(this);
this.__searchInputEl.blur()
}
if(t.keyCode==13){
ZmImOverview.FILTER_SEARCH._doKeyPress.call(this);
if(!/\S/.test(this.__searchInputEl.value)){
return
}
if(this._firstFilterItem){
var e=this._firstFilterItem.getData("ZmImOverview.data").buddy;
this.chatWithBuddy(e);
this.__searchInputEl.value="";
ZmImOverview.FILTER_SEARCH.inputBlur.call(this);
this.__searchInputEl.blur()
}}
this.__searchInputTimeout=setTimeout(AjxCallback.simpleClosure(ZmImOverview.FILTER_SEARCH._doKeyPress,this),500)
}};
ZmBuddyFilterItem=function(e){
this.overview=e.overview;
e.className="ZmBuddyFilterItem";
DwtTreeItem.call(this,e)
};
ZmBuddyFilterItem.prototype=new DwtTreeItem;
ZmBuddyFilterItem.prototype.constructor=ZmBuddyFilterItem;
ZmBuddyFilterItem.prototype.toString=function(){
return"ZmBuddyFilterItem"
};
ZmBuddyFilterItem.prototype._createHtmlFromTemplate=function(t,a){
var o=this.getHtmlElement();
o.className="ZmBuddyFilterItem";
var e=o.ownerDocument.createElement("input");
this.overview.__searchInputEl=e;
e.autocomplete="off";
e.className="DwtSimpleInput";
o.appendChild(e);
e.onkeydown=AjxCallback.simpleClosure(ZmImOverview.FILTER_SEARCH.inputKeyPress,this.overview);
e.onfocus=AjxCallback.simpleClosure(ZmImOverview.FILTER_SEARCH.inputFocus,this.overview);
e.onblur=AjxCallback.simpleClosure(ZmImOverview.FILTER_SEARCH.inputBlur,this.overview);
e.onblur()
};
ZmInfoTreeItem=function(e){
e.className="ZmInfoTreeItem";
DwtTreeItem.call(this,e)
};
ZmInfoTreeItem.prototype=new DwtTreeItem;
ZmInfoTreeItem.prototype.constructor=ZmInfoTreeItem;
ZmInfoTreeItem.prototype.TEMPLATE="im.Chat#ZmInfoTreeItem";
ZmInfoTreeItem.prototype.toString=function(){
return"ZmInfoTreeItem"
}
}
if(AjxPackage.define("zimbraMail.im.view.ZmTaskbar")){
ZmTaskbar=function(e){
ZmToolBar.call(this,e);
ZmTaskbar.INSTANCE=this;
this._setMouseEvents();
this.shell.addControlListener(new AjxListener(this,this._shellControlListener))
};
ZmTaskbar.prototype=new ZmToolBar;
ZmTaskbar.prototype.constructor=ZmTaskbar;
ZmTaskbar.prototype.toString=function(){
return"ZmTaskbar"
};
ZmTaskbar.prototype.zShow=function(e){
this.setZIndex(e?Dwt.Z_VIEW+10:Dwt.Z_HIDDEN)
};
ZmTaskbar.prototype.expandItem=function(a,t,e){
if(t&&this.expandedItem){
this.expandedItem._expand(false)
}
a._expand(t,e);
this.expandedItem=t?a:null
};
ZmTaskbar.prototype.toggleExpanded=function(e){
this.expandItem(e,!e.expanded)
};
ZmTaskbar.prototype.conditionalExpand=function(e){
if(!this.expandedItem){
this.expandItem(e,true,true);
return true
}else{
return false
}};
ZmTaskbar.prototype._shellControlListener=function(e){
if((e.oldWidth!=e.newWidth)&&this.expandedItem){
this.expandedItem.positionContent()
}};
ZmTaskbarItem=function(a){
DwtComposite.call(this,a);
this._createHtml();
this._contentClassName=a.contentClassName;
var e={
style:DwtButton.TOGGLE_STYLE,parent:this,parentElement:this._buttonEl};
var t=a.buttonConstructor||DwtToolBarButton;
this.button=new t(e);
this.button.addSelectionListener(a.selectionListener);
if(a.op){
this.button.setText(ZmMsg[ZmOperation.getProp(a.op,"textKey")]);
this.button.setImage(ZmOperation.getProp(a.op,"image"));
this.button.setToolTipContent(ZmMsg[ZmOperation.getProp(a.op,"tooltipKey")])
}
this._rightAlign=a.rightAlign;
this._data=a.data
};
ZmTaskbarItem.prototype=new DwtComposite;
ZmTaskbarItem.prototype.constructor=ZmTaskbarItem;
ZmTaskbarItem.prototype.TEMPLATE="share.App#ZmTaskbarItem";
ZmTaskbarItem.prototype.toString=function(){
return"ZmTaskbarItem"
};
ZmTaskbarItem.prototype.getPopup=function(){
if(!this._popup){
AjxDispatcher.require(["IMCore","IM"]);
var args={
parent:this,parentElement:this._contentEl,taskbarItem:this,taskbar:this.parent,data:this._data};
var ctor=window.eval(this._contentClassName);
this._popup=new ctor(args)
}
return this._popup
};
ZmTaskbarItem.prototype._expand=function(a,t){
this.expanded=a;
Dwt.setVisible(this._contentEl,a);
this.button.setSelected(a);
var e=this.getPopup();
if(a){
this.showAlert(false);
e.popup(t);
this.positionContent()
}else{
e.popdown()
}};
ZmTaskbarItem.prototype.positionContent=function(){
if(this._rightAlign){
var e=Dwt.toWindow(this.button.getHtmlElement(),0,0).x;
var a=this.button.getW();
var t=this.parent.getBounds();
var o=1;
this._contentEl.style.right=t.x+t.width-e-a-o
}};
ZmTaskbarItem.prototype._createHtml=function(){
var e={
id:this._htmlElId};
this._createHtmlFromTemplate(this.TEMPLATE,e);
this._contentEl=document.getElementById(e.id+"_content");
this._buttonEl=document.getElementById(e.id+"_button")
}
}
if(AjxPackage.define("zimbraMail.im.controller.ZmTaskbarController")){
ZmTaskbarController=function(s){
ZmController.call(this,null);
ZmTaskbarController.INSTANCE=this;
var n=Dwt.byId(ZmId.SKIN_TASKBAR);
if(!n){
return
}
this._chatData={};
this._chatMru=[];
var o={
parent:appCtxt.getShell(),id:ZmId.TASKBAR,className:"ZmTaskbar",posStyle:Dwt.ABSOLUTE_STYLE};
this._toolbar=s[ZmAppViewMgr.C_TASKBAR]=new ZmTaskbar(o);
this._toolbar.addListener(DwtEvent.ONMOUSEDOWN,new AjxListener(this,this._toolbarMouseDownListener));
var h={
contentClassName:"ZmPresencePopup",op:ZmId.OP_IM_PRESENCE_MENU};
this._presenceItem=this._createItem(h);
this._toolbar.addSeparator();
this._newBuddySelectionListenerObj=new AjxListener(this,this._newBuddySelectionListener);
var a={
contentClassName:"ZmNewBuddyPopup",selectionListener:this._newBuddySelectionListenerObj,op:ZmId.OP_NEW_ROSTER_ITEM};
this._newBuddyItem=this._createItem(a);
this._newBuddyItem.button.setText("");
var t={
contentClassName:"ZmBuddyListPopup",op:ZmId.OP_IM_BUDDY_LIST};
this._createItem(t);
this._toolbar.addFiller(null);
this._chatButtonIndex=this._toolbar.getNumChildren()+1;
this._messageButton=new DwtToolBarButton({
parent:this._toolbar}
);
this._messageButton.setText(ZmMsg.betaIM);
this._messageButton.setEnabled(false);
var e=appCtxt.getSkinHint("presence","height")||24;
Dwt.setSize(n,Dwt.DEFAULT,e);
var r=ZmImApp.INSTANCE.getRoster();
this._updatePresenceButton(ZmImApp.loggedIn()?r.getPresence():null);
r.addChangeListener(new AjxListener(this,this._rosterChangeListener));
r.addGatewayListListener(new AjxListener(this,this._gatewayListListener));
ZmImApp.INSTANCE.getRoster().getChatList().addChangeListener(new AjxListener(this,this._chatListListener));
ZmImApp.INSTANCE.getRoster().getRosterItemList().addChangeListener(new AjxListener(this,this._rosterListChangeListener))
};
ZmTaskbarController.prototype=new ZmController;
ZmTaskbarController.prototype.constructor=ZmTaskbarController;
ZmTaskbarController.prototype.toString=function(){
return"ZmTaskbarController"
};
ZmTaskbarController.prototype.setMessage=function(e){
this._messageButton.setText(e);
if(this._resetMessageActionId){
AjxTimedAction.cancelAction(this._resetMessageActionId);
this._resetMessageActionId=0
}
this._resetMessageAction=this._resetMessageAction||new AjxTimedAction(this,this._resetMessage);
this._resetMessageActionId=AjxTimedAction.scheduleAction(this._resetMessageAction,3000)
};
ZmTaskbarController.prototype._resetMessage=function(e){
this._messageButton.setText(ZmMsg.betaIM);
this._resetMessageActionId=0
};
ZmTaskbarController.prototype.createChatItem=function(e,a){
this._addChatToMru(e);
var n=this._toolbar.addSeparator(null,this._chatButtonIndex++);
var t={
index:this._chatButtonIndex++,contentClassName:"ZmChatPopup",selectionListener:new AjxListener(this,this._chatSelectionListener,[e]),data:{
chat:e,statusListener:new AjxListener(this,this._chatStatusListener,[e]),closeListener:new AjxListener(this,this._closeChatListener,[e]),minimizeListener:new AjxListener(this,this._minimizeChatListener,[e])}};
var o=this._createItem(t);
o.button.setToolTipContent(new AjxCallback(this,this._getChatToolTip,[e]));
o.button.addListener(DwtEvent.ONMOUSEDOWN,new AjxListener(this,this._chatMouseDownListener,[e]));
this._chatData[e.id]={
chat:e,item:o,separator:n};
var s="Close";
o.button.setHoverImage(s);
this._closeClass=this._closeClass||AjxImg.getClassForImage(s);
this._toolbar.expandItem(o,true,a);
this._chatData[e.id].chatWidget=o.getPopup().chatWidget;
this._chatChangeListenerListenerObj=this._chatChangeListenerListenerObj||new AjxListener(this,this._chatChangeListenerListener);
e.addChangeListener(this._chatChangeListenerListenerObj);
return o
};
ZmTaskbarController.prototype.endChat=function(e){
e.sendClose();
ZmImApp.INSTANCE.getRoster().getChatList().removeChat(e)
};
ZmTaskbarController.prototype.selectChat=function(e,a){
var t=this._chatData[e.id];
if(t){
this._expandChatItem(t.item,e,true);
if(a){
t.chatWidget.setEditorContent(AjxStringUtil.trim(a))
}}};
ZmTaskbarController.prototype.selectChatForRosterItem=function(t){
var o=ZmImApp.INSTANCE.getRoster().getChatList().getChatsByRosterAddr(t.getAddress());
var e=null;
for(var a in o){
if(o[a].getRosterSize()==1){
e=o[a];
break
}}
if(e==null&&o.length>0){
e=o[0]
}
if(e!=null){
this.selectChat(e)
}};
ZmTaskbarController.prototype.chatWithContacts=function(t,e,o){
var a=t.map("getBuddy").sub(AjxCallback.isNull);
if(a.size()>0){
this.chatWithRosterItem(a.get(0),o)
}};
ZmTaskbarController.prototype.chatWithRosterItem=function(t,a){
var e=ZmImApp.INSTANCE.getRoster().getChatList().getChatByRosterItem(t,true);
this.selectChat(e,a)
};
ZmTaskbarController.prototype.getChatWidgetForChat=function(e){
var t=this._chatData[e.id];
return t?t.chatWidget:null
};
ZmTaskbarController.prototype.showSubscribeRequest=function(s,t){
this._subscribeData=this._subscribeData||{};
if(this._subscribeData[s]){
return
}
var n=this._toolbar.addSeparator(null,this._chatButtonIndex+1);
var e={
index:this._chatButtonIndex+1,op:ZmId.OP_IM_INVITE,rightAlign:true,contentClassName:"ZmSubscribePopup",data:{
addr:s,buddy:t}};
var a=this._createItem(e);
this._subscribeData[s]={
item:a,separator:n};
this._subscribeRequestTooltip=this._subscribeRequestTooltip||new AjxMessageFormat(ZmMsg.imInvitationFrom);
var o=this._subscribeRequestTooltip.format(t?t.getDisplayName():s);
a.button.setToolTipContent(o);
if(!this._toolbar.conditionalExpand(a)){
a.showAlert(true)
}
a.addDisposeListener(new AjxListener(this,this._subscribeDisposeListener,[s]))
};
ZmTaskbarController.prototype.showNewBuddyPopup=function(){
this._toolbar.expandItem(this._newBuddyItem,true);
return this._newBuddyItem.getPopup()
};
ZmTaskbarController.prototype.showGatewayPopup=function(t){
if(this._gatewayData){
var e=this._gatewayData[t];
if(e){
this._toolbar.expandItem(e.item,true)
}}};
ZmTaskbarController.prototype._subscribeDisposeListener=function(t){
var e=this._subscribeData[t];
this._toolbar.removeSeparator(e.separator);
delete this._subscribeData[t]
};
ZmTaskbarController.prototype._addChatToMru=function(e){
if(this._chatMru.length>=4){
for(var o=this._chatMru.length,a=o-1;
a>=0;
a--){
var t=this._chatMru[a];
var n=this._chatData[t.id].item;
if(!n.expanded&&!n.isAlertShown()){
this.endChat(t);
break
}}}
this._chatMru.unshift(e)
};
ZmTaskbarController.prototype._updateChatMru=function(e){
if(this._chatMru.length&&(this._chatMru[0]!=e)){
this._removeChatFromMru(e);
this._chatMru.unshift(e)
}};
ZmTaskbarController.prototype._removeChatFromMru=function(e){
for(var t=0,a=this._chatMru.length;
t<a;
t++){
if(this._chatMru[t]==e){
this._chatMru.splice(t,1);
return
}}};
ZmTaskbarController.prototype._chatMouseDownListener=function(e,a){
if(a.button!=DwtMouseEvent.RIGHT){
return
}
this._actionedChat=e;
if(!this._chatActionMenu){
var t={
parent:appCtxt.getShell(),controller:this,context:ZmId.TASKBAR,menuType:"Chat",menuItems:[ZmId.OP_IM_CLOSE_CHAT,ZmId.OP_IM_CLOSE_ALL_CHATS,ZmId.OP_IM_CLOSE_OTHER_CHATS]};
this._chatActionMenu=new ZmActionMenu(t);
this._chatActionMenu.getOp(ZmId.OP_IM_CLOSE_CHAT).addSelectionListener(new AjxListener(this,this._closeChatMenuListener));
this._chatActionMenu.getOp(ZmId.OP_IM_CLOSE_ALL_CHATS).addSelectionListener(new AjxListener(this,this._closeAllChatsListener));
this._chatActionMenu.getOp(ZmId.OP_IM_CLOSE_OTHER_CHATS).addSelectionListener(new AjxListener(this,this._closeOtherChatsListener))
}
this._chatActionMenu.popup(0,a.docX,a.docY)
};
ZmTaskbarController.prototype._closeChatMenuListener=function(){
this.endChat(this._actionedChat);
this._actionedChat=null
};
ZmTaskbarController.prototype._closeAllChatsListener=function(){
var e=[];
for(var o in this._chatData){
e.push(this._chatData[o].chat)
}
for(var t=0,a=e.length;
t<a;
t++){
this.endChat(e[t])
}
this._actionedChat=null
};
ZmTaskbarController.prototype._closeOtherChatsListener=function(){
var o=[];
for(var n in this._chatData){
var e=this._chatData[n].chat;
if(e!=this._actionedChat){
o.push(e)
}}
for(var t=0,a=o.length;
t<a;
t++){
this.endChat(o[t])
}
this._actionedChat=null
};
ZmTaskbarController.prototype._newBuddyListener=function(){
ZmImApp.INSTANCE.prepareVisuals();
ZmImApp.INSTANCE.getImController()._newRosterItemListener()
};
ZmTaskbarController.prototype._toolbarMouseDownListener=function(e){
if(e.button==DwtMouseEvent.LEFT&&this._toolbar.expandedItem){
this._toolbar.expandItem(this._toolbar.expandedItem,false)
}};
ZmTaskbarController.prototype._rosterListChangeListener=function(s){
if(s.event==ZmEvent.E_MODIFY){
var t=s.getDetail("fields");
var o=s.getItems();
for(var e=0;
e<o.length;
e++){
var h=o[e];
if(h instanceof ZmRosterItem){
var a;
a=a||ZmImApp.INSTANCE.getRoster().getChatList();
var d=a.getChatsByRosterAddr(h.getAddress());
for(var n in d){
var l=d[n];
var r=this.getChatWidgetForChat(d[n]);
if(r){
r._rosterItemChangeListener(h,t)
}}}}}};
ZmTaskbarController.prototype._chatListListener=function(a){
if(a.event==ZmEvent.E_CREATE){
var e=a.getDetails().items[0];
var o=this._chatData[e.id];
var t;
if(o){
this._toolbar.conditionalExpand(o.item)
}else{
t=this.createChatItem(e,a.getDetails().background)
}}else{
if(a.event==ZmEvent.E_DELETE){
var e=a._details.items[0];
this._deleteChatItem(e)
}}};
ZmTaskbarController.prototype._deleteChatItem=function(e){
this._removeChatFromMru(e);
e.removeChangeListener(this._chatChangeListenerListenerObj);
var t=this._chatData[e.id];
if(t){
this._toolbar.removeSeparator(t.separator);
t.item.dispose();
this._chatButtonIndex-=1;
delete this._chatData[e.id]
}};
ZmTaskbarController.prototype._getChatToolTip=function(e,a){
var t=e.getRosterItem().getToolTip();
a.run(t)
};
ZmTaskbarController.prototype._expandChatItem=function(t,e,a){
this._updateChatMru(e);
this._toolbar.expandItem(t,a);
var o=this._chatData[e.id].chatWidget;
o._onMinimize(!a);
if(a){
o.focus()
}};
ZmTaskbarController.prototype._chatSelectionListener=function(e,a){
if(e&&a.target&&(a.target.className==this._closeClass)){
this.endChat(e)
}else{
var t=a.dwtObj.parent;
this._expandChatItem(t,e,!t.expanded)
}};
ZmTaskbarController.prototype._selectionListener=function(e){
this._toolbar.toggleExpanded(e.dwtObj.parent)
};
ZmTaskbarController.prototype._newBuddySelectionListener=function(e){
if(ZmImApp.loggedIn()){
this._toolbar.toggleExpanded(this._newBuddyItem)
}else{
ZmImApp.INSTANCE.login({
callback:this._newBuddySelectionListenerObj}
)
}};
ZmTaskbarController.prototype._chatChangeListenerListener=function(o){
var e=o.source;
var t=this._chatData[e.id];
if(t&&!t.item.expanded){
var a=o.getDetail("fields")[ZmChat.F_MESSAGE];
if(a&&!a.fromMe&&!a.isSystem){
t.item.showAlert(true);
this._updateChatMru(e)
}}};
ZmTaskbarController.prototype._closeChatListener=function(e){
this.endChat(e)
};
ZmTaskbarController.prototype._minimizeChatListener=function(e){
var t=this._chatData[e.id].item;
this._expandChatItem(t,e,false);
t.button.setDisplayState(DwtControl.SELECTED);
AjxTimedAction.scheduleAction(new AjxTimedAction(this,this._minimzeTimedAction,t),250)
};
ZmTaskbarController.prototype._minimzeTimedAction=function(e){
e.button.setDisplayState(DwtControl.NORMAL)
};
ZmTaskbarController.prototype._chatStatusListener=function(t,e){
var a=this._chatData[t.id].item;
a.button.setImage(e.statusImage);
var o=e.title?AjxStringUtil.clipByLength(e.title,15):"";
a.button.setText(o)
};
ZmTaskbarController.prototype._createItem=function(e){
e.parent=this._toolbar;
e.selectionListener=e.selectionListener||new AjxListener(this,this._selectionListener);
return new ZmTaskbarItem(e)
};
ZmTaskbarController.prototype._rosterChangeListener=function(a){
if(a.event==ZmEvent.E_MODIFY){
var e=a.getDetail("fields");
if(ZmRoster.F_PRESENCE in e){
var t=ZmImApp.INSTANCE.getRoster().getPresence();
this._updatePresenceButton(t)
}}};
ZmTaskbarController.prototype._updatePresenceButton=function(a){
var t=this._presenceItem.button;
t.setImage(a?a.getIcon():"Offline");
var e=a?AjxStringUtil.htmlEncode(a.getShowText()):ZmMsg.imStatusOffline;
var o=ZmImApp.INSTANCE.getServiceController().getMyPresenceTooltip(e);
t.setToolTipContent(o)
};
ZmTaskbarController.prototype._gatewayListListener=function(s){
if(!ZmImApp.INSTANCE.getServiceController().capabilities[ZmImServiceController.ACCOUNTS]){
return
}
this._gatewayData=this._gatewayData||{};
var h=s.roster.getGateways();
for(var a=1,n=h.length;
a<n;
a++){
var r=h[a];
if(!this._gatewayData[r.type]){
for(var e in this._gatewayData){
this._toolbar.addSeparator();
break
}
var t={
buttonConstructor:ZmStatusImageButton,contentClassName:"ZmGatewayPopup",data:r,rightAlign:true};
var o=this._createItem(t);
o.button.setImage("WebSearch");
this._gatewayData[r.type]={
item:o};
r.addListener(ZmImGateway.EVENT_SET_STATE,new AjxListener(this,this._gatewayEventListener,[r]))
}
this._updateGatewayButton(r)
}};
ZmTaskbarController.prototype._gatewayEventListener=function(e){
this._updateGatewayButton(e)
};
ZmTaskbarController.prototype._updateGatewayButton=function(o){
var a=this._presenceItem.button.getImage();
var e;
if(o.isOnline()){
e=this._gatewayOnlineFormat=this._gatewayOnlineFormat||new AjxMessageFormat(ZmMsg.imStatusGatewayOnline)
}else{
e=this._gatewayOfflineFormat=this._gatewayOfflineFormat||new AjxMessageFormat(ZmMsg.imStatusGatewayOffline);
a="Offline"
}
var n=e.format([ZmMsg["imGateway_"+o.type],o.nick]);
var t=this._gatewayData[o.type].item.button;
t.setToolTipContent(n);
t.setStatusImage(a)
};
ZmStatusImageButton=function(e){
e.className="ZmStatusImageButton";
DwtButton.call(this,e)
};
ZmStatusImageButton.prototype=new DwtButton;
ZmStatusImageButton.prototype.constructor=ZmStatusImageButton;
ZmStatusImageButton.prototype.TEMPLATE="share.App#ZmStatusImageButton";
ZmStatusImageButton.prototype.toString=function(){
return"ZmStatusImageButton"
};
ZmStatusImageButton.prototype.dispose=function(){
this._statusIconEl=null;
DwtMenuItem.prototype.dispose.call(this)
};
ZmStatusImageButton.prototype.setStatusImage=function(e){
if(this._statusIconEl){
AjxImg.setImage(this._statusIconEl,e)
}};
ZmStatusImageButton.prototype._createHtmlFromTemplate=function(e,t){
DwtButton.prototype._createHtmlFromTemplate.call(this,e,t);
this._statusIconEl=document.getElementById(t.id+"_status_icon")
}
}
if(AjxPackage.define("zimbraMail.core.ZmAppViewMgr")){
ZmAppViewMgr=function(o,t,e,a){
ZmAppViewMgr._setContainerIds();
this._shell=o;
this._controller=t;
this._isNewWindow=e;
this._hasSkin=a;
this._shellSz=this._shell.getSize();
this._controlListener=new AjxListener(this,this._shellControlListener);
this._shell.addControlListener(this._controlListener);
this._sashSupported=(window.skin&&typeof window.skin.setTreeWidth=="function");
if(appCtxt.get(ZmSetting.HISTORY_SUPPORT_ENABLED)&&!AjxEnv.isSafari&&!e&&!AjxEnv.isPrism){
this._historyMgr=appCtxt.getHistoryMgr();
this._historyMgr.addListener(new AjxListener(this,this._historyChangeListener))
}
this._hashView={};
this._nextHashIndex=0;
this._curHashIndex=0;
this._noHistory=false;
this._ignoreHistoryChange=false;
this._lastView=null;
this._currentView=null;
this._views={};
this._hidden=[];
this._appView={};
this._callbacks={};
this._viewApp={};
this._isAppView={};
this._isTransient={};
this._toRemove=[];
this._isTabView={};
this._tabParams={};
this._viewByTabId={};
this._components={};
this._containers={};
this._contBounds={};
this._pushCallback=new AjxCallback(this,this.pushView);
this._popCallback=new AjxCallback(this,this.popView);
this._createLoadingView()
};
ZmAppViewMgr.C_BANNER="banner";
ZmAppViewMgr.C_USER_INFO="userInfo";
ZmAppViewMgr.C_QUOTA_INFO="quota";
ZmAppViewMgr.C_SEARCH="search";
ZmAppViewMgr.C_SEARCH_BUILDER="searchBuilder";
ZmAppViewMgr.C_SEARCH_BUILDER_TOOLBAR="searchBuilderToolbar";
ZmAppViewMgr.C_APP_CHOOSER="appChooser";
ZmAppViewMgr.C_TREE="tree";
ZmAppViewMgr.C_TREE_FOOTER="treeFooter";
ZmAppViewMgr.C_TOOLBAR_TOP="topToolbar";
ZmAppViewMgr.C_TOOLBAR_BOTTOM="bottomToolbar";
ZmAppViewMgr.C_APP_CONTENT="main";
ZmAppViewMgr.C_APP_CONTENT_FULL="fullScreen";
ZmAppViewMgr.C_STATUS="status";
ZmAppViewMgr.C_SASH="sash";
ZmAppViewMgr.C_TASKBAR="taskbar";
ZmAppViewMgr.C_FOOTER="footer";
ZmAppViewMgr.C_AD="adsrvc";
ZmAppViewMgr.ALL_COMPONENTS=[ZmAppViewMgr.C_BANNER,ZmAppViewMgr.C_USER_INFO,ZmAppViewMgr.C_QUOTA_INFO,ZmAppViewMgr.C_SEARCH,ZmAppViewMgr.C_SEARCH_BUILDER,ZmAppViewMgr.C_SEARCH_BUILDER_TOOLBAR,ZmAppViewMgr.C_APP_CHOOSER,ZmAppViewMgr.C_TREE,ZmAppViewMgr.C_TREE_FOOTER,ZmAppViewMgr.C_TOOLBAR_TOP,ZmAppViewMgr.C_TOOLBAR_BOTTOM,ZmAppViewMgr.C_APP_CONTENT,ZmAppViewMgr.C_APP_CONTENT_FULL,ZmAppViewMgr.C_STATUS,ZmAppViewMgr.C_SASH,ZmAppViewMgr.C_TASKBAR,ZmAppViewMgr.C_FOOTER,ZmAppViewMgr.C_AD];
ZmAppViewMgr.APP_COMPONENTS=[ZmAppViewMgr.C_TREE,ZmAppViewMgr.C_TREE_FOOTER,ZmAppViewMgr.C_STATUS,ZmAppViewMgr.C_SASH];
ZmAppViewMgr.CONT_ID_KEY={};
ZmAppViewMgr.CB_PRE_HIDE=1;
ZmAppViewMgr.CB_POST_HIDE=2;
ZmAppViewMgr.CB_PRE_SHOW=3;
ZmAppViewMgr.CB_POST_SHOW=4;
ZmAppViewMgr.CB_PRE_UNLOAD=5;
ZmAppViewMgr.PENDING_VIEW="ZmAppViewMgr.PENDING_VIEW";
ZmAppViewMgr.BROWSER_BACK="BACK";
ZmAppViewMgr.BROWSER_FORWARD="FORWARD";
ZmAppViewMgr.TAB_BUTTON_MAX_TEXT=15;
ZmAppViewMgr._setContainerIds=function(){
ZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_BANNER]=ZmId.SKIN_LOGO;
ZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_USER_INFO]=ZmId.SKIN_USER_INFO;
ZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_QUOTA_INFO]=ZmId.SKIN_QUOTA_INFO;
ZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_SEARCH]=ZmId.SKIN_SEARCH;
ZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_SEARCH_BUILDER]=ZmId.SKIN_SEARCH_BUILDER;
ZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_SEARCH_BUILDER_TOOLBAR]=ZmId.SKIN_SEARCH_BUILDER_TOOLBAR;
ZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_APP_CHOOSER]=ZmId.SKIN_APP_CHOOSER;
ZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_TREE]=ZmId.SKIN_TREE;
ZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_TREE_FOOTER]=ZmId.SKIN_TREE_FOOTER;
ZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_TOOLBAR_TOP]=ZmId.SKIN_APP_TOP_TOOLBAR;
ZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_TOOLBAR_BOTTOM]=ZmId.SKIN_APP_BOTTOM_TOOLBAR;
ZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_APP_CONTENT]=ZmId.SKIN_APP_MAIN;
ZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_APP_CONTENT_FULL]=ZmId.SKIN_APP_MAIN_FULL;
ZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_STATUS]=ZmId.SKIN_STATUS;
ZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_SASH]=ZmId.SKIN_SASH;
ZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_TASKBAR]=ZmId.SKIN_TASKBAR;
ZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_FOOTER]=ZmId.SKIN_FOOTER;
ZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_AD]=ZmId.SKIN_AD
};
ZmAppViewMgr.prototype.toString=function(){
return"ZmAppViewMgr"
};
ZmAppViewMgr.prototype.isFullScreen=function(e){
e=e||this._currentView;
return Boolean(e&&this._views[e]&&this._views[e][ZmAppViewMgr.C_APP_CONTENT_FULL])
};
ZmAppViewMgr.prototype.addComponents=function(o,l,t){
var r=[];
for(var h in o){
var n=o[h];
this._components[h]=n;
if(this._hasSkin){
if(!this._containers[h]){
var a=ZmAppViewMgr.CONT_ID_KEY[h];
var s=document.getElementById(a);
if(!s&&h==ZmAppViewMgr.C_APP_CONTENT_FULL){
a=ZmAppViewMgr.CONT_ID_KEY[ZmAppViewMgr.C_APP_CONTENT];
s=document.getElementById(a)
}
if(!s){
continue
}
this._containers[h]=s;
if(l){
s.innerHTML="";
var e=this._getContainerBounds(h);
if(e){
n.setBounds(e.x,e.y,e.width,e.height)
}}}
r.push(h)
}
if(!t){
n.zShow(true)
}
if(h==ZmAppViewMgr.C_SASH){
if(this._sashSupported){
n.registerCallback(this._appTreeSashCallback,this)
}
n.setCursor("default")
}}
if(l){
this._fitToContainer(r)
}};
ZmAppViewMgr.prototype.setComponent=function(o,t){
var e=this._components[o];
if(e){
e.setLocation(Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE)
}
var a={};
a[o]=t;
this.addComponents(a,true)
};
ZmAppViewMgr.prototype.showSearchBuilder=function(t){
skin.show("searchBuilder",t);
this._components[ZmAppViewMgr.C_SEARCH_BUILDER_TOOLBAR].zShow(t);
this._components[ZmAppViewMgr.C_SEARCH_BUILDER].zShow(t);
var e=[ZmAppViewMgr.C_SEARCH_BUILDER,ZmAppViewMgr.C_SEARCH_BUILDER_TOOLBAR,ZmAppViewMgr.C_APP_CHOOSER,ZmAppViewMgr.C_TREE,ZmAppViewMgr.C_TREE_FOOTER,ZmAppViewMgr.C_TOOLBAR_TOP,ZmAppViewMgr.C_APP_CONTENT,ZmAppViewMgr.C_APP_CONTENT_FULL];
this._fitToContainer(e);
if(!t){
this._components[ZmAppViewMgr.C_SEARCH_BUILDER].setLocation(Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE)
}};
ZmAppViewMgr.prototype.showTreeFooter=function(e){
skin.show("treeFooter",e);
this._components[ZmAppViewMgr.C_TREE_FOOTER].zShow(e&&!this.isFullScreen());
this._fitToContainer([ZmAppViewMgr.C_TREE,ZmAppViewMgr.C_TREE_FOOTER])
};
ZmAppViewMgr.prototype.getCurrentViewId=function(){
return this._currentView
};
ZmAppViewMgr.prototype.getCurrentViewComponent=function(e){
return this._components[e]
};
ZmAppViewMgr.prototype.getLastViewId=function(){
return this._lastView
};
ZmAppViewMgr.prototype.getCurrentView=function(){
var e=this._views[this._currentView];
return e?e[ZmAppViewMgr.C_APP_CONTENT]||e[ZmAppViewMgr.C_APP_CONTENT_FULL]:null
};
ZmAppViewMgr.prototype.getAppView=function(e){
return this._appView[e]
};
ZmAppViewMgr.prototype.setAppView=function(t,e){
this._appView[t]=e
};
ZmAppViewMgr.prototype.createView=function(t){
var e=t.viewId;
this._views[e]=t.elements;
this._callbacks[e]=t.callbacks||{};
this._viewApp[e]=t.appName;
this._isAppView[e]=t.isAppView;
this._isTransient[e]=t.isTransient;
if(!this._isNewWindow&&t.tabParams){
this._tabParams[e]=t.tabParams;
this._isTabView[e]=Boolean(t.tabParams!=null);
this._viewByTabId[t.tabParams.id]=e
}};
ZmAppViewMgr.prototype.pushView=function(c,t){
c=this._viewByTabId[c]||c;
var a=(c==ZmAppViewMgr.PENDING_VIEW);
if(!a&&!this._views[c]){
return false
}
if(a){
c=this._pendingView
}
var e=this._getViewController(c);
if(c==this._currentView){
this._setViewVisible(c,true);
if(e){
e._restoreFocus()
}
return true
}
if(this._isTabView[c]){
var l=this._tabParams[c];
var r=l&&l.tabCallback&&l.tabCallback.run(this._currentView,c);
if(l&&!r){
var u=appCtxt.getAppChooser();
var s=u.getButton(l.id);
if(!s){
s=u.addButton(l.id,l);
s.setHoverImage("Close")
}}}
if(a){
t=true
}
if(!this._hideView(this._currentView,t||this._isTabView[this._currentView])){
this._pendingAction=this._pushCallback;
this._pendingView=c;
return false
}
this.addComponents(this._views[c]);
var h=this._getViewController(this._currentView);
var o=this._isTransient[this._currentView]||(h&&h.isTransient(this._currentView,c));
if(this._currentView&&(this._currentView!=c)&&!o){
this._hidden.push(this._currentView)
}
this._removeFromHidden(c);
var d=this._lastView;
this._lastView=this._currentView;
this._currentView=c;
if(!this._showView(c,t,(c!=this._currentView))){
this._currentView=this._lastView;
this._lastView=d;
this._pendingAction=this._pushCallback;
this._pendingView=c;
return false
}
if(this._noHistory){
this._noHistory=false
}else{
if(c!=ZmId.VIEW_LOADING){
this._nextHashIndex++;
this._curHashIndex=this._nextHashIndex;
this._hashView[this._curHashIndex]=c;
if(this._historyMgr){
this._historyMgr.add(this._curHashIndex)
}}}
this._layout(this._currentView);
if(e&&e.setCurrentView){
e.setCurrentView(c)
}
if(this._isAppView[c]){
this.setAppView(this._viewApp[c],c)
}
if(this._toRemove.length){
for(var n=0;
n<this._toRemove.length;
n++){
this._removeFromHidden(this._toRemove[n])
}
this._toRemove=[]
}
return true
};
ZmAppViewMgr.prototype.popView=function(t,e){
if(!this._currentView){
return false
}
var a=(t==ZmAppViewMgr.PENDING_VIEW);
if(a){
e=t;
t=true
}
if(e&&!a&&(this.getCurrentViewId()!=e)){
return false
}
if(!this._hidden.length&&!this._isNewWindow){
if(location&&(location.search.match(/\bview=compose\b/))){
this._controller.activateApp(ZmApp.MAIL)
}
return false
}
if(!this._hideView(this._currentView,t)){
this._pendingAction=this._popCallback;
this._pendingView=null;
return false
}
this._deactivateView(this._views[this._currentView]);
if(this._isTabView[this._currentView]){
appCtxt.getAppChooser().removeButton(this._tabParams[this._currentView].id)
}
this._lastView=this._currentView;
this._currentView=this._hidden.pop();
if(!this._currentView&&this._isNewWindow){
window.close();
return false
}
if(!this._showView(this._currentView,this._popCallback,null,t,true)){
return false
}
this._removeFromHidden(this._currentView);
if(this._historyMgr){
if(this._noHistory){
this._noHistory=false
}else{
this._ignoreHistoryChange=true;
history.back()
}}
this.addComponents(this._views[this._currentView]);
this._layout(this._currentView);
return true
};
ZmAppViewMgr.prototype.setView=function(t,n){
var e=this.pushView(t,n);
if(e){
for(var o=0;
o<this._hidden.length;
o++){
var a=this._views[this._hidden[o]];
this._deactivateView(a)
}
this._hidden=[]
}
return e
};
ZmAppViewMgr.prototype.stageView=function(e){
this._removeFromHidden(e);
this._hidden.push(e)
};
ZmAppViewMgr.prototype.replaceView=function(n,e){
n=n||this._currentView;
var t=this._views[n];
var o=this._views[e];
this._hideView(n,true);
for(var a in o){
t[a]=o[a]
}
if(this._currentView==n){
this._currentView=e;
this._showView(e);
this._layout(this._currentView)
}};
ZmAppViewMgr.prototype.isAppView=function(e){
return this._isAppView[e]
};
ZmAppViewMgr.prototype.showPendingView=function(e){
if(e&&this._pendingAction){
this._pendingAction.run(ZmAppViewMgr.PENDING_VIEW)
}
if(!e){
if(this._browserAction==ZmAppViewMgr.BROWSER_BACK){
this._ignoreHistoryChange=true;
history.forward()
}else{
if(this._browserAction==ZmAppViewMgr.BROWSER_FORWARD){
this._ignoreHistoryChange=true;
history.back()
}}
this._browserAction=null
}
this._pendingAction=this._pendingView=null
};
ZmAppViewMgr.prototype.fitAll=function(){
this._fitToContainer(ZmAppViewMgr.ALL_COMPONENTS)
};
ZmAppViewMgr.prototype.getPendingViewId=function(){
return this._pendingView
};
ZmAppViewMgr.prototype.reset=function(){
this._shell.removeControlListener(this._controlListener);
for(var t in this._views){
var a=this._views[t];
for(var e=0;
e<a.length;
e++){
for(var o in a[e]){
this._components[o].dispose();
this._components[o]=null;
this._containers[o]=null
}}}};
ZmAppViewMgr.prototype.updateTitle=function(){
this._setTitle(this._currentView)
};
ZmAppViewMgr.prototype.setTabTitle=function(e,o){
var a=this._tabParams[e];
var t=!appCtxt.isChildWindow&&a&&appCtxt.getAppChooser().getButton(a.id);
if(t){
t.setText(o)
}};
ZmAppViewMgr.prototype.isOkToUnload=function(){
var t=AjxUtil.getHashKeys(this._isTabView);
if(!this._isTabView[this._currentView]){
t.push(this._currentView)
}
for(var o=0;
o<t.length;
o++){
var e=t[o];
var n=this._callbacks[e]&&this._callbacks[e][ZmAppViewMgr.CB_PRE_UNLOAD];
if(n){
var a=n.run(e);
if(!a){
return false
}}}
return true
};
ZmAppViewMgr.prototype._createLoadingView=function(){
var t=new DwtControl({
parent:this._shell,className:"DwtListView",posStyle:Dwt.ABSOLUTE_STYLE,id:ZmId.LOADING_VIEW}
);
var e=t.getHtmlElement();
e.innerHTML=AjxTemplate.expand("share.App#Loading",this._htmlElId);
var a={};
a[ZmAppViewMgr.C_APP_CONTENT]=t;
this.createView({
viewId:ZmId.VIEW_LOADING,elements:a}
)
};
ZmAppViewMgr.prototype._fitToContainer=function(n,h){
for(var t=0;
t<n.length;
t++){
var r=n[t];
if(!h&&AjxEnv.isIE&&(r==ZmAppViewMgr.C_TASKBAR)){
if(!this._ieHackAction){
this._ieHackAction=new AjxTimedAction(this,this._fitToContainer,[[ZmAppViewMgr.C_TASKBAR],true])
}
AjxTimedAction.scheduleAction(this._ieHackAction,1)
}
var d=this._containers[r];
if(d){
var s=this._components[r];
if(s&&(s.getZIndex()!=Dwt.Z_HIDDEN)){
var a=this._getComponentPosition(r);
var l=(a==Dwt.STATIC_STYLE);
var c=s.getHtmlElement();
if(a){
c.style.position=a
}
if(l){
if(c.parentNode!=d){
d.appendChild(c)
}
if(s.adjustSize){
s.adjustSize()
}}else{
var o=Dwt.getBounds(d);
var e=Dwt.getInsets(d);
Dwt.insetBounds(o,e);
this._contBounds[r]=o;
s.setBounds(o.x,o.y,o.width,o.height)
}}}}
if(window.DBG&&DBG.getDebugLevel()>=AjxDebug.DBG2){
this._debugShowMetrics(n)
}};
ZmAppViewMgr.prototype._getComponentPosition=function(e){
return appCtxt.getSkinHint(e,"position")
};
ZmAppViewMgr.prototype._getContainerBounds=function(n){
var e=this._getComponentPosition(n);
if(e==Dwt.STATIC_STYLE){
return null
}
var a=this._containers[n];
if(a){
var o=Dwt.getBounds(a);
var t=Dwt.getInsets(a);
Dwt.insetBounds(o,t);
return o
}
return null
};
ZmAppViewMgr.prototype._layout=function(t){
if(this._hasSkin){
return
}
var a=this._components[ZmAppViewMgr.C_TOOLBAR_TOP];
var n=a.getSize();
var e=n.y?n.y:a.getHtmlElement().clientHeight;
a.setBounds(0,0,this._shellSz.x,e);
var o=this._components[ZmAppViewMgr.C_APP_CONTENT]||this._components[ZmAppViewMgr.C_APP_CONTENT_FULL];
o.setBounds(0,e,this._shellSz.x,this._shellSz.y-e)
};
ZmAppViewMgr.prototype._hideView=function(e,a){
if(!e){
return true
}
var t=true;
var o=this._callbacks[e]?this._callbacks[e][ZmAppViewMgr.CB_PRE_HIDE]:null;
if(o){
t=o.run(e,a)
}
if(t){
this._setViewVisible(e,false);
if(appCtxt.get(ZmSetting.USE_KEYBOARD_SHORTCUTS)){
appCtxt.getKeyboardMgr().clearKeySeq()
}
o=this._callbacks[e]?this._callbacks[e][ZmAppViewMgr.CB_POST_HIDE]:null;
if(o){
o.run(e)
}}
return t
};
ZmAppViewMgr.prototype._showView=function(e,o,a){
var t=true;
var n=this._callbacks[e]?this._callbacks[e][ZmAppViewMgr.CB_PRE_SHOW]:null;
if(n){
t=n.run(e,a,o)
}
if(t){
this._setViewVisible(e,true);
n=this._callbacks[e]?this._callbacks[e][ZmAppViewMgr.CB_POST_SHOW]:null;
if(n){
n.run(e,a)
}}
appCtxt.notifyZimlets("onShowView",[e,a],{
noChildWindow:true}
);
return t
};
ZmAppViewMgr.prototype._setViewVisible=function(d,u){
var t=this._views[d];
var n=this._lastView?this.isFullScreen(this._lastView):null;
var a=this.isFullScreen(d);
if(u){
if(n!==a){
if(this._hasSkin){
skin.show("fullScreen",a)
}
for(var s=0;
s<ZmAppViewMgr.APP_COMPONENTS.length;
s++){
var c=ZmAppViewMgr.APP_COMPONENTS[s];
var r=this._components[c];
if(!r){
continue
}
r.zShow(!a);
if(a){
try{
r.setLocation(Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE)
}
catch(l){}}}
if(!a&&this._hasSkin){
this._fitToContainer(ZmAppViewMgr.APP_COMPONENTS)
}}
var h=[];
for(var c in t){
h.push(c);
t[c].zShow(true);
this._components[c]=t[c]
}
if(this._hasSkin){
this._fitToContainer(h)
}
this._setTitle(d);
if(this._isTabView[d]){
var o=this._tabParams[d].id;
this._controller.setActiveTabId(o)
}
if(this._viewApp[d]){
this._controller.setActiveApp(this._viewApp[d],d,this._isTabView[d])
}}else{
for(var c in t){
t[c].setLocation(Dwt.LOC_NOWHERE,Dwt.LOC_NOWHERE);
t[c].zShow(false)
}}};
ZmAppViewMgr.prototype._removeFromHidden=function(e){
var a=[];
for(var t=0;
t<this._hidden.length;
t++){
if(this._hidden[t]!=e){
a.push(this._hidden[t])
}}
this._hidden=a
};
ZmAppViewMgr.prototype._deactivateView=function(e){
for(var a in e){
var t=e[a];
if(t.deactivate){
t.deactivate()
}}};
ZmAppViewMgr.prototype._setTitle=function(e){
var a=this._views[e];
if(!a){
return
}
var t=a[ZmAppViewMgr.C_APP_CONTENT]||a[ZmAppViewMgr.C_APP_CONTENT_FULL];
if(t&&t.getTitle){
var o=t.getTitle();
Dwt.setTitle(o?o:ZmMsg.zimbraTitle)
}};
ZmAppViewMgr.prototype._shellControlListener=function(o){
if(o.oldWidth!=o.newWidth||o.oldHeight!=o.newHeight){
this._shellSz.x=o.newWidth;
this._shellSz.y=o.newHeight;
var a=o.newWidth-o.oldWidth;
var r=o.newHeight-o.oldHeight;
if(this._isNewWindow){
var t=this._views[this._currentView][ZmAppViewMgr.C_TOOLBAR_TOP];
if(t){
t.setSize(o.newWidth,Dwt.DEFAULT)
}
var e=this._views[this._currentView];
var s=e[ZmAppViewMgr.C_APP_CONTENT]||e[ZmAppViewMgr.C_APP_CONTENT_FULL];
if(s){
s.setSize(o.newWidth,o.newHeight-t.getH())
}}else{
if(r&&a){
this.fitAll(true)
}else{
if(r){
var n=[ZmAppViewMgr.C_APP_CHOOSER,ZmAppViewMgr.C_TREE,ZmAppViewMgr.C_TREE_FOOTER,ZmAppViewMgr.C_SASH,ZmAppViewMgr.C_APP_CONTENT,ZmAppViewMgr.C_APP_CONTENT_FULL,ZmAppViewMgr.C_STATUS,ZmAppViewMgr.C_TASKBAR,ZmAppViewMgr.C_AD,ZmAppViewMgr.C_FOOTER];
this._fitToContainer(n,true)
}else{
if(a){
var n=[ZmAppViewMgr.C_BANNER,ZmAppViewMgr.C_SEARCH,ZmAppViewMgr.C_USER_INFO,ZmAppViewMgr.C_QUOTA_INFO,ZmAppViewMgr.C_SEARCH_BUILDER,ZmAppViewMgr.C_SEARCH_BUILDER_TOOLBAR,ZmAppViewMgr.C_TOOLBAR_TOP,ZmAppViewMgr.C_APP_CONTENT,ZmAppViewMgr.C_APP_CONTENT_FULL,ZmAppViewMgr.C_TOOLBAR_BOTTOM,ZmAppViewMgr.C_TASKBAR,ZmAppViewMgr.C_AD,ZmAppViewMgr.C_FOOTER];
this._fitToContainer(n,true)
}}}}}};
ZmAppViewMgr.prototype._debugShowMetrics=function(o){
for(var t=0;
t<o.length;
t++){
var n=o[t];
var e=this._containers[n];
if(e){
var a=Dwt.getBounds(e)
}}};
ZmAppViewMgr.prototype._historyChangeListener=function(a){
if(!(a&&a.data)){
return
}
if(this._ignoreHistoryChange){
this._ignoreHistoryChange=false;
return
}
var o=DwtBaseDialog.getActiveDialog();
if(o&&o.isPoppedUp()){
o.popdown()
}
var t=parseInt(a.data);
this._noHistory=true;
var e=this._hashView[t];
if(t==(this._curHashIndex-1)){
this._browserAction=ZmAppViewMgr.BROWSER_BACK;
this.popView()
}else{
if(t==(this._curHashIndex+1)){
this._browserAction=ZmAppViewMgr.BROWSER_FORWARD;
this.pushView(e)
}else{
this._browserAction=null;
this.pushView(e)
}}
this._curHashIndex=t
};
ZmAppViewMgr.prototype._appTreeSashCallback=function(o){
if(!window.skin){
return
}
var e=skin.getTreeWidth();
if(!e){
return 0
}
if(!this.treeMinSize){
this.treeMinSize=window.skin.hints.tree.minWidth||150;
this.treeMaxSize=window.skin.hints.tree.maxWidth||300
}
if(e+o>this.treeMaxSize){
o=Math.max(0,this.treeMaxSize-e)
}
if(e+o<this.treeMinSize){
o=Math.min(0,this.treeMinSize-e)
}
var t=e+o;
skin.setTreeWidth(t);
var a=this;
setTimeout(function(){
a.fitAll(true)
}
,0);
return o
};
ZmAppViewMgr.prototype._getViewController=function(e){
var o;
var t=this._views[e];
if(t){
var a=t[ZmAppViewMgr.C_APP_CONTENT]||t[ZmAppViewMgr.C_APP_CONTENT_FULL];
o=a&&a.getController&&a.getController()
}
return o
}
}
if(AjxPackage.define("zimbraMail.core.ZmRequestMgr")){
ZmRequestMgr=function(e){
this._controller=e;
appCtxt.setRequestMgr(this);
ZmCsfeCommand.setServerUri(appCtxt.get(ZmSetting.CSFE_SERVER_URI));
var t=appCtxt.get(ZmSetting.CLIENT_VERSION);
ZmCsfeCommand.clientVersion=(!t||t.indexOf("@")==0)?"dev build":t;
this._shell=appCtxt.getShell();
this._highestNotifySeen=0;
this._cancelActionId={};
this._pendingRequests={};
this._useXml=appCtxt.get(ZmSetting.USE_XML);
this._logRequest=appCtxt.get(ZmSetting.LOG_REQUEST);
this._stdTimeout=appCtxt.get(ZmSetting.TIMEOUT);
this._unreadListener=new AjxListener(this,this._unreadChangeListener)
};
ZmRequestMgr._SENT=1;
ZmRequestMgr._RESPONSE=2;
ZmRequestMgr._CANCEL=3;
ZmRequestMgr.RETRY_MAX=2;
ZmRequestMgr.RETRY_DELAY=5;
ZmRequestMgr.RETRY_ON_EXCEPTION={};
ZmRequestMgr.RETRY_ON_EXCEPTION[ZmCsfeException.EMPTY_RESPONSE]=true;
ZmRequestMgr._nextReqId=1;
ZmRequestMgr.prototype.toString=function(){
return"ZmRequestMgr"
};
ZmRequestMgr.prototype.sendRequest=function(x){
var t=x.response;
if(t){
if(x.reqId){
x=this._pendingRequests[x.reqId]||x;
x.response=t
}
x.asyncMode=true;
return this._handleResponseSendRequest(x,new ZmCsfeResult(t))
}
var y=x.reqId=("Req_"+ZmRequestMgr._nextReqId++);
var c=(x.timeout!=null)?x.timeout:this._stdTimeout;
if(c){
c=c*1000
}
var q=x.asyncMode?new AjxCallback(this,this._handleResponseSendRequest,[x]):null;
if(x.sensitive){
var v=document.location.protocol==ZmSetting.PROTO_HTTP;
var s=appCtxt.get(ZmSetting.PROTOCOL_MODE)==ZmSetting.PROTO_MIXED;
if(v&&s){
x.noSession=true;
var o=ZmCsfeCommand.getRequestStr(x);
var d=document.location;
var u=appCtxt.get(ZmSetting.HTTPS_PORT);
if(u&&u!=ZmSetting.DEFAULT_HTTPS_PORT){
u=":"+u
}
var h=document.createElement("IFRAME");
h.style.display="none";
h.id=Dwt.getNextId();
document.body.appendChild(h);
var p=Dwt.getIframeDoc(h);
p.write("<form ","id=",h.id,"-form ","target=",h.id,"-iframe ","method=POST ","action='https://",d.hostname,u,appContextPath,"/public/secureRequest.jsp'",">","<input type=hidden name=reqId value='",y,"'>","<textarea name=data>",AjxStringUtil.htmlEncode(o),"</textarea>","</form>","<iframe name=",h.id,"-iframe></iframe>");
p.close();
x.iframeId=h.id;
this._pendingRequests[y]=x;
var a=p.getElementById(h.id+"-form");
a.submit();
return
}}
var n=new ZmCsfeCommand();
var e=x.accountName;
if(!e){
var f=appCtxt.getActiveAccount();
e=(f&&f.id!=ZmAccountList.DEFAULT_ID)?f.name:null
}
var l,m;
if(x.restUri){
l={
restUri:x.restUri,asyncMode:x.asyncMode,callback:q}
}else{
l={
jsonObj:x.jsonObj,soapDoc:x.soapDoc,accountName:e,useXml:this._useXml,changeToken:(e?null:this._changeToken),asyncMode:x.asyncMode,callback:q,logRequest:this._logRequest,highestNotifySeen:this._highestNotifySeen,skipAuthCheck:x.skipAuthCheck,resend:x.resend,noSession:x.noSession};
m=x.methodName=ZmCsfeCommand.getMethodName(l.jsonObj||l.soapDoc)
}
appCtxt.currentRequestParams=x;
var b=c?[y,x.errorCallback,x.noBusyOverlay]:null;
if(!x.noBusyOverlay){
var r=null;
var g=false;
if(c){
r=new AjxCallback(this,this.cancelRequest,b);
this._shell.setBusyDialogText(ZmMsg.askCancel);
g=true
}
this._shell.setBusy(true,y,g,c,r)
}else{
if(c){
var w=new AjxTimedAction(this,this.cancelRequest,b);
this._cancelActionId[y]=AjxTimedAction.scheduleAction(w,c)
}}
this._pendingRequests[y]=n;
try{
var t=x.restUri?n.invokeRest(l):n.invoke(l);
n.state=ZmRequestMgr._SENT
}
catch(k){
this._handleResponseSendRequest(x,new ZmCsfeResult(k,true));
return
}
return(x.asyncMode)?y:(this._handleResponseSendRequest(x,t))
};
ZmRequestMgr.prototype._handleResponseSendRequest=function(r,e){
var s=(r.response!=null);
if(!s){
if(!this._pendingRequests[r.reqId]){
return
}
if(this._pendingRequests[r.reqId].state==ZmRequestMgr._CANCEL){
return
}
this._pendingRequests[r.reqId].state=ZmRequestMgr._RESPONSE;
if(!r.noBusyOverlay){
this._shell.setBusy(false,r.reqId)
}else{
if(r.timeout){
AjxTimedAction.cancelAction(this._cancelActionId[r.reqId]);
this._cancelActionId[r.reqId]=-1
}}}
var a;
try{
if(r.asyncMode&&!r.restUri){
a=e.getResponse()
}else{
if(e._isException){
throw e._data
}else{
a=e
}}
if(a.Header){
this._handleHeader(a.Header)
}}
catch(o){
if(r.errorCallback){
var n=r.errorCallback.run(o);
if(!n){
this._handleException(o,r)
}}else{
this._handleException(o,r)
}
var h=e.getHeader();
if(h){
this._handleHeader(h);
this._handleNotifications(h)
}
this._clearPendingRequest(r.reqId);
return
}
if(r.asyncMode&&!r.restUri){
e.set(a.Body)
}
if(!appCtxt.isOffline&&!s){
this._controller._kickPolling(true)
}
var t=(DBG&&DBG.getDebugLevel()>0)?ZmCsfeCommand.getMethodName(r.jsonObj||r.soapDoc):"";
if(r.asyncMode&&r.callback){
r.callback.run(e)
}
this._handleNotifications(a.Header);
this._clearPendingRequest(r.reqId);
if(!r.asyncMode){
return a.Body
}};
ZmRequestMgr.prototype.cancelRequest=function(o,e,t){
if(!this._pendingRequests[o]){
return
}
if(this._pendingRequests[o].state==ZmRequestMgr._RESPONSE){
return
}
this._pendingRequests[o].state=ZmRequestMgr._CANCEL;
if(!t){
this._shell.setBusy(false,o)
}
this._pendingRequests[o].cancel();
if(e){
var a=new AjxException("Request canceled",AjxException.CANCELED,"ZmRequestMgr.prototype.cancelRequest");
e.run(a)
}
this._clearPendingRequest(o)
};
ZmRequestMgr.prototype._clearPendingRequest=function(a){
var t=this._pendingRequests[a];
if(t){
if(t.iframeId){
var e=document.getElementById(t.iframeId);
if(e){
e.parentNode.removeChild(e)
}}
delete this._pendingRequests[a]
}};
ZmRequestMgr.prototype._handleHeader=function(o){
if(!o){
return
}
if(o&&o.context&&o.context.change){
this._changeToken=o.context.change.token
}
if(o&&o.context&&o.context.refresh){
this._highestNotifySeen=0;
if(!appCtxt.isOffline||!appCtxt.multiAccounts){
this._refreshHandler(o.context.refresh)
}}
if(o&&o.context.zdsync&&o.context.zdsync.account){
var e=o.context.zdsync.account;
for(var t=0;
t<e.length;
t++){
var a=appCtxt.accountList.getAccount(e[t].id);
if(a){
a.updateState(e[t])
}}}};
ZmRequestMgr.prototype._handleException=function(e,a){
var t=false;
if(ZmRequestMgr.RETRY_ON_EXCEPTION[e.code]){
a.retryCount=a.retryCount||0;
if(a.retryCount<ZmRequestMgr.RETRY_MAX){
a.resend=ZmCsfeCommand.RETRY;
a.retryCount++;
AjxTimedAction.scheduleAction(new AjxTimedAction(this,function(){
this.sendRequest(a)
}
),ZmRequestMgr.RETRY_DELAY*1000);
t=true
}}
if(!t){
this._controller._handleException(e,a)
}};
ZmRequestMgr.prototype._handleNotifications=function(a){
if(a&&a.context&&a.context.notify){
for(i=0;
i<a.context.notify.length;
i++){
var t=a.context.notify[i];
var e=t.seq;
if(t.seq>this._highestNotifySeen){
this._highestNotifySeen=e;
this._notifyHandler(t)
}else{}}}};
ZmRequestMgr.prototype._refreshHandler=function(t){
this._controller.runAppFunction("_clearDeferredFolders");
if(t.version){
if(!this._canceledReload){
var n=appCtxt.get(ZmSetting.SERVER_VERSION);
if(n!=t.version){
appCtxt.set(ZmSetting.SERVER_VERSION,t.version);
if(n){
var o=appCtxt.getYesNoMsgDialog();
o.reset();
o.registerCallback(DwtDialog.YES_BUTTON,this._reloadYesCallback,this,[o,n,t.version]);
o.registerCallback(DwtDialog.NO_BUTTON,this._reloadNoCallback,this,[o,t]);
var a=AjxMessageFormat.format(ZmMsg.versionChangeRestart,[n,t.version]);
o.setMessage(a,DwtMessageDialog.WARNING_STYLE);
o.popup();
return
}}}}
var e={};
this._loadTree(ZmOrganizer.TAG,e,t.tags);
this._loadTree(ZmOrganizer.FOLDER,e,t.folder[0],"folder");
this._controller.runAppFunction("refresh",false,t)
};
ZmRequestMgr.prototype._reloadYesCallback=function(t){
t.popdown();
window.onbeforeunload=null;
var e=AjxUtil.formatUrl();
ZmZimbraMail.sendRedirect(e)
};
ZmRequestMgr.prototype._reloadNoCallback=function(e,t){
e.popdown();
this._canceledReload=true;
this._refreshHandler(t)
};
ZmRequestMgr.prototype._loadTree=function(a,t,s,r,n){
var o=(a==ZmOrganizer.TAG);
var e=appCtxt.getTree(a,n);
if(e){
e.reset()
}else{
e=o?new ZmTagTree(n):new ZmFolderTree()
}
appCtxt.setTree(a,e,n);
e.addChangeListener(this._unreadListener);
e.getUnreadHash(t);
e.loadFromJs(s,r,n)
};
ZmRequestMgr.prototype._notifyHandler=function(e){
this._controller.runAppFunction("preNotify",false,e);
if(e.deleted&&e.deleted.id){
this._handleDeletes(e.deleted)
}
if(e.created){
this._handleCreates(e.created)
}
if(e.modified){
this._handleModifies(e.modified)
}
this._controller.runAppFunction("postNotify",false,e)
};
ZmRequestMgr.prototype._handleDeletes=function(o){
var t=o.id.split(",");
this._controller.runAppFunction("deleteNotify",false,t);
for(var e=0;
e<t.length;
e++){
var n=t[e];
if(!n){
continue
}
var a=appCtxt.cacheGet(n);
if(a){
a.notifyDelete();
appCtxt.cacheRemove(n);
a=null
}}};
ZmRequestMgr.prototype._handleCreates=function(s){
this._controller.runAppFunction("createNotify",false,s);
for(var t in s){
var r=s[t];
for(var o=0;
o<r.length;
o++){
var a=r[o];
if(a._handled){
continue
}
if(appCtxt.cacheGet(a.id)&&t!="tag"){
continue
}
if(t=="tag"){
var e=appCtxt.getTagTree();
if(e){
e.root.notifyCreate(a)
}}else{
if(t=="folder"||t=="search"||t=="link"){
var h=a.l;
var n=appCtxt.getById(h);
if(n&&n.type!=ZmOrganizer.TAG){
n.notifyCreate(a,(t=="search"))
}}}}}};
ZmRequestMgr.prototype._handleModifies=function(a){
this._controller.runAppFunction("modifyNotify",false,a);
for(var t in a){
if(t=="mbx"){
var l=a[t];
for(var n=0;
n<l.length;
n++){
var e=l[n];
var h=e.acct;
if(!h||(h&&h==appCtxt.getActiveAccount().id)){
var d=appCtxt.getSettings().getSetting(ZmSetting.QUOTA_USED);
d.notifyModify({
_name:t,s:e.s}
)
}}
continue
}
var s=a[t];
for(var n=0;
n<s.length;
n++){
var r=s[n];
if(r._handled){
continue
}
var c=appCtxt.cacheGet(r.id);
if(!c&&t=="cn"&&AjxDispatcher.loaded("ContactsCore")){
var o=appCtxt.getApp(ZmApp.CONTACTS);
if(o.isContactListLoaded()){
c=o.getContactList().getById(r.id)
}}
if(c){
r._isRemote=(t=="folder"&&c.link);
c.notifyModify(r)
}}}};
ZmRequestMgr._getObjList=function(a){
var o=[];
for(var e in a){
var n=a[e];
if(n instanceof Array){
for(var t=0;
t<n.length;
t++){
n[t]._name=e;
o.push(n[t])
}}else{
n._name=e;
o.push(n)
}}
return o
};
ZmRequestMgr.prototype._unreadChangeListener=function(n){
if(n.event==ZmEvent.E_MODIFY){
var t=n.getDetail("fields");
if(t&&t[ZmOrganizer.F_UNREAD]){
var a=n.getDetail("organizers");
var e=a?a[0]:null;
var r=e?(e.isSystem()?e.nId:e.id):null;
var o=appCtxt.getCurrentSearch();
if(o&&r&&(r==o.folderId||r==o.tagId)){
Dwt.setTitle(o.getTitle())
}
var s=appCtxt.getApp(ZmApp.MAIL);
if(s){
s.setNewMailNotice(e)
}}}}
}
if(AjxPackage.define("zimbraMail.core.ZmZimbraMail")){
ZmZimbraMail=function(n){
ZmController.call(this,null);
this._userShell=n.userShell;
this._requestMgr=new ZmRequestMgr(this);
this._evt=new ZmAppEvent();
this._evtMgr=new AjxEventMgr();
for(var a in ZmZimbraMail._listeners){
var o=ZmZimbraMail._listeners[a];
if(o&&o.length){
for(var e=0;
e<o.length;
e++){
this._evtMgr.addListener(a,o[e])
}}}
ZmZimbraMail.addListener=AjxCallback.simpleClosure(this.addListener,this);
ZmZimbraMail.addAppListener=AjxCallback.simpleClosure(this.addAppListener,this);
window._zimbraMail=this;
if(appCtxt.get(ZmSetting.HISTORY_SUPPORT_ENABLED)&&!AjxEnv.isSafari){
window.historyMgr=appCtxt.getHistoryMgr()
}
this._settings=appCtxt.getSettings();
var t=appCtxt.get(ZmSetting.BRANCH);
if(window.DBG&&!DBG.isDisabled()){}
appCtxt.setAppController(this);
this._shell=appCtxt.getShell();
this._apps={};
this._upsellView={};
this._activeApp=null;
this._sessionTimer=new AjxTimedAction(null,ZmZimbraMail.logOff);
this._sessionTimerId=-1;
this._pollActionId=null;
this._pollRequest=null;
this._pollInstantNotifications=false;
this.statusView=null;
AjxDispatcher.setPackageLoadFunction("Zimlet",new AjxCallback(this,this._postLoadZimlet));
AjxDispatcher.setPreLoadFunction(new AjxCallback(this,function(){
this._appViewMgr.pushView(ZmId.VIEW_LOADING)
}
));
AjxDispatcher.setPostLoadFunction(new AjxCallback(this,function(){
this._appViewMgr._toRemove.push(ZmId.VIEW_LOADING)
}
));
for(var e in ZmApp.QS_ARG){
ZmApp.QS_ARG_R[ZmApp.QS_ARG[e]]=e
}
this.startup(n)
};
ZmZimbraMail.prototype=new ZmController;
ZmZimbraMail.prototype.constructor=ZmZimbraMail;
ZmMsg.BETA_documents=[ZmMsg.documents,ZmMsg.beta].join(" ");
ZmApp.MAIN="ZmZimbraMail";
ZmApp.DROP_TARGETS[ZmApp.MAIN]={};
ZmZimbraMail._listeners={};
ZmZimbraMail.prototype.toString=function(){
return"ZmZimbraMail"
};
ZmZimbraMail.run=function(h){
if(!window.DBG){
ZmZimbraMail._createDummyDBG()
}
if(h.noSplashScreen){
ZmZimbraMail.killSplash()
}
window.appCtxt=new ZmAppCtxt();
appCtxt.rememberMe=false;
if(h.offlineMode){
appCtxt.isOffline=true
}
var r=new ZmSettings();
appCtxt.setSettings(r);
if(h.offlineMode){
var e=AjxCookie.getCookie(document,ZmSetting.APPS_COOKIE);
if(e){
for(var s in ZmSetting.APP_LETTER){
var n=ZmSetting.APP_LETTER[s];
if(e.indexOf(n)!=-1){
r.getSetting(s).setValue(true)
}}}}
if(h.settings){
for(var t in h.settings){
var a=r.getSettingByName(t);
if(a){
r.getSetting(a).setValue(h.settings[t])
}}}
ZmOperation.initialize();
if(appCtxt.isOffline){
appCtxt.set(ZmSetting.POLLING_INTERVAL,60,null,null,true)
}
if(h.devMode=="1"){
appCtxt.set(ZmSetting.DEV,true);
appCtxt.set(ZmSetting.POLLING_INTERVAL,0)
}
if(h.protocolMode){
var l=(h.protocolMode.indexOf(":")==-1)?h.protocolMode+":":h.protocolMode;
appCtxt.set(ZmSetting.PROTOCOL_MODE,l)
}
if(h.httpPort){
appCtxt.set(ZmSetting.HTTP_PORT,h.httpPort)
}
if(h.httpsPort){
appCtxt.set(ZmSetting.HTTPS_PORT,h.httpsPort)
}
if(/dogfood/.test(location.hostname)||(h.devMode=="1")){
AjxUtil.enableLogType("rpc",true)
}
var o=h.userShell=window.document.getElementById(ZmId.SKIN_SHELL);
if(!o){
alert("Could not get user shell - skin file did not load properly")
}
var c=new DwtShell({
userShell:o,docBodyScrollable:false,id:ZmId.SHELL}
);
appCtxt.setShell(c);
new ZmZimbraMail(h)
};
ZmZimbraMail.unload=function(){
if(!ZmZimbraMail._endSessionDone){
ZmZimbraMail._endSession()
}
if(ZmZimbraMail._isLogOff){
ZmZimbraMail._isLogOff=false;
if(window._zimbraMail){
window._zimbraMail.setSessionTimer(false)
}
ZmCsfeCommand.clearAuthToken()
}
var t=window._zimbraMail?window._zimbraMail._childWinList:null;
if(t){
for(var e=0;
e<t.size();
e++){
var a=t.get(e);
a.win.onbeforeunload=null;
a.win.parentController=null;
a.win.close()
}}
window._zimbraMail=window.onload=window.onunload=window.onresize=window.document.onkeypress=null
};
ZmZimbraMail.hashSortCompare=function(s,o,e){
var n=o?Number(s[o]):0;
var t=e?Number(s[e]):0;
if(n>t){
return 1
}
if(n<t){
return -1
}
return 0
};
ZmZimbraMail.killSplash=function(){
var e=Dwt.byId("skin_container_splash_screen");
if(e){
Dwt.hide(e)
}};
ZmZimbraMail.prototype.startup=function(a){
if(appCtxt.isOffline){
this.sendClientEventNotify(true)
}
appCtxt.inStartup=true;
if(typeof(skin)=="undefined"){}
if(!this._appViewMgr){
this._appViewMgr=new ZmAppViewMgr(this._shell,this,false,true)
}
skin.show("skin",true);
if(!this._components){
this._components={};
this._components[ZmAppViewMgr.C_SASH]=new DwtSash({
parent:this._shell,style:DwtSash.HORIZONTAL_STYLE,className:"console_inset_app_l",threshold:20,id:ZmId.MAIN_SASH}
);
this._components[ZmAppViewMgr.C_BANNER]=this._createBanner();
if(!appCtxt.multiAccounts){
this._components[ZmAppViewMgr.C_USER_INFO]=this._userNameField=this._createUserInfo("BannerTextUser",ZmAppViewMgr.C_USER_INFO,ZmId.USER_NAME);
this._components[ZmAppViewMgr.C_QUOTA_INFO]=this._usedQuotaField=this._createUserInfo("BannerTextQuota",ZmAppViewMgr.C_QUOTA_INFO,ZmId.USER_QUOTA)
}
this._components[ZmAppViewMgr.C_STATUS]=this.statusView=new ZmStatusView(this._shell,"ZmStatus",Dwt.ABSOLUTE_STYLE,ZmId.STATUS_VIEW)
}
this._createEnabledApps();
this._registerOrganizers();
for(var n in ZmSearch.TYPE){
ZmSearch.TYPE_MAP[ZmSearch.TYPE[n]]=n
}
for(var n in ZmOrganizer.VIEWS){
var s=ZmOrganizer.VIEWS[n];
for(var o=0;
o<s.length;
o++){
ZmOrganizer.TYPE[s[o]]=n
}}
if(a.batchInfoResponse){
var c=a.batchInfoResponse.Body.BatchResponse;
if(c.GetInfoResponse){
var e=a.getInfoResponse={};
e.Body={};
e.Body.GetInfoResponse=c.GetInfoResponse[0];
e.Header=a.batchInfoResponse.Header;
if(e.Header&&e.Header.context&&e.Header.context.session){
ZmCsfeCommand.setSessionId(e.Header.context.session)
}}
if(c.SearchResponse){
var t=a.searchResponse={};
t.Body={};
t.Body.SearchResponse=c.SearchResponse[0]
}}
this._getStartApp(a);
this._postRenderCallbacks=[];
this._postRenderLast=0;
if(a.startApp==ZmApp.MAIL){
this._doingPostRenderStartup=true;
var h=new AjxCallback(this,function(){
AjxDispatcher.require("Startup2");
if(appCtxt.get(ZmSetting.CALENDAR_ENABLED)){
this.handleCalendarComponents()
}
appCtxt.getSearchController().getSearchToolbar().initAutocomplete()
}
);
this.addPostRenderCallback(h,0,0,true)
}
var l=new AjxCallback(this,this._handleResponseGetMetaData,a);
var r=[ZmSetting.M_IMPLICIT];
if(appCtxt.isOffline){
r.push(ZmSetting.M_OFFLINE)
}
appCtxt.getMetaData().get(r,null,l)
};
ZmZimbraMail.prototype._handleResponseGetMetaData=function(s,e){
var n=e.getResponse().BatchResponse.GetMailboxMetadataResponse;
var t={};
for(var a=0;
a<n.length;
a++){
var o=n[a].meta[0];
t[o.section]=o._attrs
}
var r=new AjxCallback(this,this._handleResponseLoadUserSettings,s);
this._errorCallback=new AjxCallback(this,this._handleErrorStartup,s);
this._settings.loadUserSettings(r,this._errorCallback,null,s.getInfoResponse,t)
};
ZmZimbraMail.prototype.showMiniCalendar=function(){
var e=appCtxt.getCalManager();
e.getMiniCalendar();
appCtxt.getAppViewMgr().showTreeFooter(true);
e.highlightMiniCal()
};
ZmZimbraMail.prototype.showReminder=function(){
var t=appCtxt.getCalManager();
var e=t.getReminderController();
e.refresh()
};
ZmZimbraMail.prototype.handleOfflineMailTo=function(t,n){
if(!appCtxt.get(ZmSetting.OFFLINE_IS_MAILTO_HANDLER)){
return false
}
var o=this.getApp(ZmApp.MAIL);
var e=(t.indexOf("mailto"));
if(e>=0){
var a="to="+decodeURIComponent(t.substring(e+7));
a=a.replace(/\?/g,"&");
o._showComposeView(n,a);
return true
}
return false
};
ZmZimbraMail.prototype._handleErrorStartup=function(t,e){
ZmZimbraMail.killSplash();
appCtxt.inStartup=false;
return false
};
ZmZimbraMail.prototype._handleResponseLoadUserSettings=function(t,e){
if(appCtxt.multiAccounts){
var a=new AjxCallback(this,this._handleResponseStartup,[t,e]);
appCtxt.accountList.loadAccounts(a)
}else{
this._handleResponseStartup(t,e)
}};
ZmZimbraMail.prototype._handleResponseStartup=function(o,e){
if(o&&o.settingOverrides){
this._needOverviewLayout=true;
for(var r in o.settingOverrides){
var a=this._settings.getSetting(r);
if(a){
a.setValue(o.settingOverrides[r])
}}}
if(!appCtxt.isOffline){
this.setPollInterval(true)
}else{
try{
if(AjxEnv.isMac&&window.platform&&window.platform.isRegisteredProtocolHandler("mailto")){
this.registerMailtoHandler()
}}
catch(t){}}
window.onbeforeunload=ZmZimbraMail._confirmExitMethod;
if(!this._components[ZmAppViewMgr.C_APP_CHOOSER]){
this._components[ZmAppViewMgr.C_APP_CHOOSER]=this._appChooser=this._createAppChooser()
}
ZmApp.initialize();
if(appCtxt.get(ZmSetting.DEFAULT_TIMEZONE)){
AjxTimezone.DEFAULT_RULE=AjxTimezone._guessMachineTimezone(appCtxt.get(ZmSetting.DEFAULT_TIMEZONE));
AjxTimezone.DEFAULT=AjxTimezone.getClientId(AjxTimezone.DEFAULT_RULE.serverId)
}
this._evtMgr.notifyListeners(ZmAppEvent.PRE_STARTUP,this._evt);
o.result=e;
var s=new AjxCallback(this,this._handleResponseStartup1,o);
if(this._doingPostRenderStartup){
this.addAppListener(o.startApp,ZmAppEvent.POST_RENDER,new AjxListener(this,this._postRenderStartup));
this._searchResponse=o.searchResponse
}else{
AjxDispatcher.require("Startup2")
}
var n=new AjxCallback(this,function(){
this.runAppFunction("startup",false,o.result)
}
);
this.addPostRenderCallback(n,2,100,true);
n=new AjxCallback(this,function(){
this._setupTabGroups();
this.focusContentPane()
}
);
this.addPostRenderCallback(n,3,100);
n=new AjxCallback(this,function(){
AjxDispatcher.enableLoadFunctions(true);
appCtxt.inStartup=false;
this._evtMgr.notifyListeners(ZmAppEvent.POST_STARTUP,this._evt);
if(appCtxt.isOffline){
appCtxt.getSearchController().resetSearchToolbar()
}
var h=appCtxt.multiAccounts?"GetContactsForAllAccounts":"GetContacts";
AjxDispatcher.run(h)
}
);
this.addPostRenderCallback(n,5,100);
this.activateApp(o.startApp,false,s,this._errorCallback,o);
if(appCtxt.get(ZmSetting.CALENDAR_ENABLED)&&!this._doingPostRenderStartup&&(o.startApp!=ZmApp.CALENDAR)){
this.handleCalendarComponents()
}};
ZmZimbraMail.prototype.handleCalendarComponents=function(){
if(appCtxt.get(ZmSetting.CAL_ALWAYS_SHOW_MINI_CAL)){
var a=new AjxTimedAction(this,this.showMiniCalendar);
var e=appCtxt.isOffline?0:ZmCalendarApp.MINICAL_DELAY;
AjxTimedAction.scheduleAction(a,e)
}
if(appCtxt.get(ZmSetting.CAL_REMINDER_WARNING_TIME)!=0){
var t=new AjxTimedAction(this,this.showReminder);
var e=appCtxt.isOffline?0:ZmCalendarApp.REMINDER_START_DELAY;
AjxTimedAction.scheduleAction(t,e)
}};
ZmZimbraMail.prototype._handleResponseStartup1=function(a){
this._setExternalLinks();
this.setUserInfo();
if(appCtxt.get(ZmSetting.SEARCH_ENABLED)){
this._components[ZmAppViewMgr.C_SEARCH]=appCtxt.getSearchController().getSearchPanel()
}
this.getKeyMapMgr();
this.setSessionTimer(true);
ZmZimbraMail.killSplash();
this.runAppFunction("addComponents",false,this._components);
var e=this._appViewMgr._components;
this._appViewMgr.addComponents(this._components,true);
if(e){
this._appViewMgr.addComponents(e,true)
}
if(appCtxt.get(ZmSetting.LICENSE_STATUS)!=ZmSetting.LICENSE_GOOD){
AjxDispatcher.require("Startup2");
var t=appCtxt.getMsgDialog();
t.reset();
t.setMessage(ZmMsg.licenseExpired,DwtMessageDialog.WARNING_STYLE);
t.popup()
}
if(!this._doingPostRenderStartup){
this._postRenderStartup()
}};
ZmZimbraMail.prototype._postRenderStartup=function(e){
this._postRenderCallbacks.sort(function(o,t){
return o.order-t.order
}
);
this._runNextPostRenderCallback()
};
ZmZimbraMail.prototype._runNextPostRenderCallback=function(){
if(this._postRenderCallbacks&&this._postRenderCallbacks.length){
var e=this._postRenderCallbacks.shift();
if(!e){
return
}
AjxTimedAction.scheduleAction(new AjxTimedAction(this,function(){
e.callback.run();
this._runNextPostRenderCallback()
}
),e.delay)
}else{
if(appCtxt.isOffline){
this.sendClientEventNotify(false)
}
if(appCtxt.multiAccounts){
this._resetUserInfo()
}}};
ZmZimbraMail.prototype.addPostRenderCallback=function(o,e,t,a){
if(!this._doingPostRenderStartup&&a){
o.run()
}else{
e=e||this._postRenderLast++;
this._postRenderCallbacks.push({
callback:o,order:e,delay:t||0}
)
}};
ZmZimbraMail.prototype._getStartApp=function(r){
var t;
if(r&&r.app){
t=ZmApp.QS_ARG_R[r.app.toLowerCase()];
var n=ZmApp.SETTING[t];
if(n&&!appCtxt.get(n)){
t=null
}}
if(!t){
for(var s in ZmApp.DEFAULT_SORT){
ZmApp.DEFAULT_APPS.push(s)
}
ZmApp.DEFAULT_APPS.sort(function(l,h){
return ZmZimbraMail.hashSortCompare(ZmApp.DEFAULT_SORT,l,h)
}
);
var e=null;
for(var o=0;
o<ZmApp.DEFAULT_APPS.length;
o++){
var s=ZmApp.DEFAULT_APPS[o];
var n=ZmApp.SETTING[s];
if(!n||appCtxt.get(n)){
e=s;
break
}}
t=(r&&r.isRelogin&&this._activeApp)?this._activeApp:e
}
var a=AjxStringUtil.parseQueryString();
if(a&&a.view&&!a.app){
t=ZmApp.QS_VIEWS[a.view]
}
r.startApp=t;
r.qsParams=a
};
ZmZimbraMail.prototype.restart=function(e){
this.reset();
this.startup({
settingOverrides:e}
)
};
ZmZimbraMail.prototype.reset=function(){
ZmCsfeCommand.setSessionId(null);
this._highestNotifySeen=0;
appCtxt.accountList.resetTrees();
if(!appCtxt.rememberMe()){
appCtxt.getLoginDialog().clearAll()
}
for(var e in this._apps){
this._apps[e]=null
}
this._activeApp=null;
this._appViewMgr.reset()
};
ZmZimbraMail.prototype.cancelRequest=function(a,e,t){
this._requestMgr.cancelRequest(a,e,t)
};
ZmZimbraMail.prototype.sendRequest=function(e){
return this._requestMgr.sendRequest(e)
};
ZmZimbraMail.prototype.runAppFunction=function(r,s){
var t=[];
for(var a=2;
a<arguments.length;
a++){
t.push(arguments[a])
}
for(var a=0;
a<ZmApp.APPS.length;
a++){
var e=ZmApp.APPS[a];
var o=ZmApp.SETTING[e];
if(!o||appCtxt.get(o)||s){
var h=appCtxt.getApp(e);
var n=h&&h[r];
if(n&&(typeof(n)=="function")){
n.apply(h,t)
}}}};
ZmZimbraMail.prototype._createEnabledApps=function(o){
for(var n in ZmApp.CLASS){
if(!o||o[n]){
ZmApp.APPS.push(n)
}}
ZmApp.APPS.sort(function(r,s){
return ZmZimbraMail.hashSortCompare(ZmApp.LOAD_SORT,r,s)
}
);
for(var t=0;
t<ZmApp.APPS.length;
t++){
var n=ZmApp.APPS[t];
var e=ZmApp.SETTING[n]&&appCtxt.get(ZmApp.SETTING[n]);
var a=ZmApp.UPSELL_SETTING[n]&&appCtxt.get(ZmApp.UPSELL_SETTING[n]);
if(e||a){
ZmApp.ENABLED_APPS[n]=true;
this._createApp(n);
this._apps[n].isUpsell=(!e&&a)
}}};
ZmZimbraMail.addListener=function(e,t){
if(!ZmZimbraMail._listeners[e]){
ZmZimbraMail._listeners[e]=[]
}
ZmZimbraMail._listeners[e].push(t)
};
ZmZimbraMail.addAppListener=function(e,t,a){
t=[e,t].join("_");
ZmZimbraMail.addListener(t,a)
};
ZmZimbraMail.prototype.addListener=function(e,t){
return this._evtMgr.addListener(e,t)
};
ZmZimbraMail.prototype.removeListener=function(e,t){
return this._evtMgr.removeListener(e,t)
};
ZmZimbraMail.prototype.addAppListener=function(a,e,t){
e=[a,e].join("_");
return this.addListener(e,t)
};
ZmZimbraMail.prototype.removeAppListener=function(a,e,t){
e=[a,e].join("_");
return this.removeListener(e,t)
};
ZmZimbraMail.prototype.sendNoOp=function(){
var t=AjxSoapDoc.create("NoOpRequest","urn:zimbraMail");
var e=appCtxt.isOffline&&appCtxt.accountList.mainAccount.name;
this.sendRequest({
soapDoc:t,asyncMode:true,noBusyOverlay:true,accountName:e}
)
};
ZmZimbraMail.prototype.sendClientEventNotify=function(e){
var t={
jsonObj:{
ClientEventNotifyRequest:{
_jsns:"urn:zimbraOffline",e:e?"ui_load_begin":"ui_load_end"}}
,callback:(new AjxCallback(this,this.setInstantNotify,true)),asyncMode:true,noBusyOverlay:true};
this.sendRequest(t)
};
ZmZimbraMail.prototype.setInstantNotify=function(e){
if(e){
this._pollInstantNotifications=true;
this._pollInterval=appCtxt.get(ZmSetting.INSTANT_NOTIFY_INTERVAL);
if(this._pollActionId){
AjxTimedAction.cancelAction(this._pollActionId);
this._pollActionId=null
}
this._kickPolling(true)
}else{
this._pollInstantNotifications=false;
this._cancelInstantNotify();
this.setPollInterval(true)
}};
ZmZimbraMail.prototype.getInstantNotify=function(){
return this._pollInstantNotifications
};
ZmZimbraMail.prototype.registerMailtoHandler=function(){
if(appCtxt.get(ZmSetting.OFFLINE_SUPPORTS_MAILTO)&&appCtxt.get(ZmSetting.OFFLINE_IS_MAILTO_HANDLER)){
try{
if(AjxEnv.isMac||!window.platform.isRegisteredProtocolHandler("mailto")){
var a=AjxCallback.simpleClosure(this.handleOfflineMailTo,this);
var e=appCtxt.get(ZmSetting.OFFLINE_WEBAPP_URI,null,appCtxt.accountList.mainAccount);
window.platform.registerProtocolHandler("mailto",e+"&mailto=%s",a)
}}
catch(t){}}};
ZmZimbraMail.prototype.setPollInterval=function(e){
if(!this._pollInstantNotifications){
this._pollInterval=appCtxt.get(ZmSetting.POLLING_INTERVAL)*1000;
if(this._pollInterval){
if(e){
this._kickPolling(true)
}}else{
if(this._pollActionId){
AjxTimedAction.cancelAction(this._pollActionId);
this._pollActionId=null
}}
return true
}else{
this._pollInterval=appCtxt.get(ZmSetting.INSTANT_NOTIFY_INTERVAL);
return false
}};
ZmZimbraMail.prototype._cancelInstantNotify=function(){
if(this._pollRequest){
this._requestMgr.cancelRequest(this._pollRequest);
this._pollRequest=null
}
if(this._pollActionId){
AjxTimedAction.cancelAction(this._pollActionId);
this._pollActionId=null
}};
ZmZimbraMail.prototype._kickPolling=function(a){
DBG.println(AjxDebug.DBG2,["ZmZimbraMail._kickPolling ",this._pollInterval,", ",this._pollActionId,", ",this._pollRequest?"request_pending":"no_request_pending"].join(""));
if(this._pollActionId){
AjxTimedAction.cancelAction(this._pollActionId);
this._pollActionId=null
}
if(a&&this._pollInstantNotifications){
var e=appCtxt.get(ZmSetting.INSTANT_NOTIFY_INTERVAL);
if(this._pollInterval>e){
this._pollInterval=e
}}
if(this._pollInterval&&!this._pollRequest){
try{
this._pollActionId=AjxTimedAction.scheduleAction(new AjxTimedAction(this,this._execPoll),this._pollInterval)
}
catch(t){
this._pollActionId=null
}}};
ZmZimbraMail.prototype._execPoll=function(){
this._cancelInstantNotify();
var t=AjxSoapDoc.create("NoOpRequest","urn:zimbraMail");
try{
if(this._pollInstantNotifications){
var o=t.getMethod();
o.setAttribute("wait",1);
o.setAttribute("limitToOneBlocked",1)
}
var a={
soapDoc:t,asyncMode:true,callback:new AjxCallback(this,this._handleResponseDoPoll),errorCallback:new AjxCallback(this,this._handleErrorDoPoll),noBusyOverlay:true,timeout:appCtxt.get(ZmSetting.INSTANT_NOTIFY_TIMEOUT),accountName:appCtxt.isOffline&&appCtxt.accountList.mainAccount.name};
this._pollRequest=this.sendRequest(a)
}
catch(e){
this._handleErrorDoPoll(e)
}};
ZmZimbraMail.prototype._handleErrorDoPoll=function(t){
if(this._pollRequest){
if(this._pollActionId){
AjxTimedAction.cancelAction(this._pollActionId);
this._pollActionId=null
}
this._requestMgr.cancelRequest(this._pollRequest);
this._pollRequest=null
}
if(this._pollInstantNotifications){
this._pollInterval*=2;
if(this._pollInterval>(1000*60*2)){
this._pollInterval=1000*60*2
}}
var e=(t.code==ZmCsfeException.SVC_AUTH_EXPIRED||t.code==ZmCsfeException.SVC_AUTH_REQUIRED||t.code==ZmCsfeException.NO_AUTH_TOKEN);
if(!e){
this._kickPolling(false)
}
return !e
};
ZmZimbraMail.prototype._handleResponseDoPoll=function(e){
this._pollRequest=null;
var t=e.getResponse().NoOpResponse;
if(t.waitDisallowed){
this.setInstantNotify(false)
}else{
this._kickPolling(true)
}};
ZmZimbraMail.prototype.getKeyMapMgr=function(){
var e=appCtxt.getKeyboardMgr();
if(!e.__keyMapMgr){
this._initKeyboardHandling()
}
return e.__keyMapMgr
};
ZmZimbraMail.prototype._initKeyboardHandling=function(){
var e=appCtxt.getKeyboardMgr();
if(e.__keyMapMgr){
return
}
if(appCtxt.get(ZmSetting.USE_KEYBOARD_SHORTCUTS)){
e.enable(true);
e.registerKeyMap(new ZmKeyMap());
e.pushDefaultHandler(this)
}else{
e.enable(false)
}};
ZmZimbraMail.prototype._setupTabGroups=function(){
var t=appCtxt.getRootTabGroup();
if(appCtxt.get(ZmSetting.SEARCH_ENABLED)){
t.addMember(appCtxt.getSearchController().getTabGroup())
}
this._components[ZmAppViewMgr.C_APP_CHOOSER].noFocus=true;
var e=appCtxt.getCurrentApp();
var o=e&&e.getOverviewId();
var a=o&&appCtxt.getOverviewController().getOverview(o);
if(a){
t.addMember(a);
ZmController._currentOverview=a
}
appCtxt.getKeyboardMgr().setTabGroup(t)
};
ZmZimbraMail.prototype._registerOrganizers=function(){
ZmOrganizer.registerOrg(ZmOrganizer.FOLDER,{
app:ZmApp.MAIL,nameKey:"folder",defaultFolder:ZmOrganizer.ID_INBOX,soapCmd:"FolderAction",firstUserId:256,orgClass:"ZmFolder",orgPackage:"MailCore",treeController:"ZmMailFolderTreeController",labelKey:"folders",itemsKey:"messages",hasColor:true,defaultColor:ZmOrganizer.C_NONE,treeType:ZmOrganizer.FOLDER,dropTargets:[ZmOrganizer.FOLDER],views:["message","conversation"],folderKey:"mailFolder",mountKey:"mountFolder",createFunc:"ZmOrganizer.create",compareFunc:"ZmFolder.sortCompare",newOp:ZmOperation.NEW_FOLDER,displayOrder:100,openSetting:ZmSetting.FOLDER_TREE_OPEN}
);
ZmOrganizer.registerOrg(ZmOrganizer.SEARCH,{
app:ZmApp.MAIN,nameKey:"savedSearch",precondition:ZmSetting.SAVED_SEARCHES_ENABLED,soapCmd:"FolderAction",firstUserId:256,orgClass:"ZmSearchFolder",treeController:"ZmSearchTreeController",labelKey:"searches",treeType:ZmOrganizer.FOLDER,dropTargets:[ZmOrganizer.FOLDER,ZmOrganizer.SEARCH],createFunc:"ZmSearchFolder.create",compareFunc:"ZmFolder.sortCompare",openSetting:ZmSetting.SEARCH_TREE_OPEN,displayOrder:300}
);
ZmOrganizer.registerOrg(ZmOrganizer.TAG,{
app:ZmApp.MAIN,nameKey:"tag",precondition:ZmSetting.TAGGING_ENABLED,soapCmd:"TagAction",firstUserId:64,orgClass:"ZmTag",treeController:"ZmTagTreeController",hasColor:true,defaultColor:ZmOrganizer.C_ORANGE,labelKey:"tags",treeType:ZmOrganizer.TAG,createFunc:"ZmTag.create",compareFunc:"ZmTag.sortCompare",newOp:ZmOperation.NEW_TAG,openSetting:ZmSetting.TAG_TREE_OPEN,displayOrder:400}
);
ZmOrganizer.registerOrg(ZmOrganizer.ZIMLET,{
orgClass:"ZmZimlet",treeController:"ZmZimletTreeController",labelKey:"zimlets",compareFunc:"ZmZimlet.sortCompare",openSetting:ZmSetting.ZIMLET_TREE_OPEN,hideEmpty:true}
);
this._name=ZmApp.MAIN;
ZmApp.prototype._setupDropTargets.call(this)
};
ZmZimbraMail.prototype.getApp=function(e){
if(!ZmApp.ENABLED_APPS[e]){
return null
}
if(!this._apps[e]){
this._createApp(e)
}
return this._apps[e]
};
ZmZimbraMail.prototype.getAppViewMgr=function(){
return this._appViewMgr
};
ZmZimbraMail.prototype.getActiveApp=function(){
return this._activeApp
};
ZmZimbraMail.prototype.getPreviousApp=function(){
return this._previousApp
};
ZmZimbraMail.prototype.activateApp=function(n,t,h,o,a){
var s=this._appViewMgr.getAppView(n);
if(s&&!t){
if(this._appViewMgr.pushView(s)){
this._appViewMgr.setAppView(n,s);
if(!appCtxt.get(ZmApp.SETTING[n])&&appCtxt.get(ZmApp.UPSELL_SETTING[n])){
var r=[ZmMsg.zimbraTitle,n].join(": ");
Dwt.setTitle(r)
}}
if(h){
h.run()
}}else{
if(!this._apps[n]){
this._createApp(n)
}
if(!appCtxt.get(ZmApp.SETTING[n])&&appCtxt.get(ZmApp.UPSELL_SETTING[n])){
this._createUpsellView(n)
}else{
var l=new AjxCallback(this,this._handleResponseActivateApp,[h,n]);
var e=[n,ZmAppEvent.PRE_LAUNCH].join("_");
this._evt.item=this._apps[n];
this._evtMgr.notifyListeners(e,this._evt);
a=a||{};
a.searchResponse=this._searchResponse;
this._apps[n].launch(a,l);
delete this.searchResponse
}}};
ZmZimbraMail.prototype._handleResponseActivateApp=function(a,e){
if(a){
a.run()
}
if(ZmApp.DEFAULT_SEARCH[e]){
appCtxt.getSearchController().setDefaultSearchType(ZmApp.DEFAULT_SEARCH[e])
}
var t=[e,ZmAppEvent.POST_LAUNCH].join("_");
this._evt.item=this._apps[e];
this._evtMgr.notifyListeners(t,this._evt)
};
ZmZimbraMail.prototype.setActiveApp=function(o,s,r){
if(!r){
this._components[ZmAppViewMgr.C_APP_CHOOSER].setSelected(o)
}
var t=!ZmApp.SETTING[o]||appCtxt.get(ZmApp.SETTING[o]);
this._activeTabId=null;
if(this._activeApp!=o){
if(this._activeApp){
var e=this._apps[this._activeApp];
if(e){
e.activate(false,s)
}
this._previousApp=this._activeApp
}
this._activeApp=o;
if(t){
var e=this._apps[this._activeApp];
if(appCtxt.get(ZmSetting.SEARCH_ENABLED)){
var n=e?e.getInitialSearchType():null;
if(!n){
n=ZmApp.DEFAULT_SEARCH[o]
}
if(n){
appCtxt.getSearchController().setDefaultSearchType(n)
}
var a=appCtxt.getSearchController().getSearchToolbar();
if(appCtxt.get(ZmSetting.SHOW_SEARCH_STRING)&&a){
var h=e.currentSearch?e.currentSearch.query:e.currentQuery;
a.setSearchFieldValue(h||"")
}}
if(e){
if(appCtxt.inStartup&&this._doingPostRenderStartup){
var l=new AjxCallback(this,function(){
e.activate(true)
}
);
this.addPostRenderCallback(l,1,100,true)
}else{
e.activate(true)
}}}
this._evt.item=this._apps[o];
this._evtMgr.notifyListeners(ZmAppEvent.ACTIVATE,this._evt)
}};
ZmZimbraMail.prototype.getAppChooserButton=function(e){
return this._components[ZmAppViewMgr.C_APP_CHOOSER].getButton(e)
};
ZmZimbraMail.prototype.appRendered=function(e){
var t=[e,ZmAppEvent.POST_RENDER].join("_");
this._evtMgr.notifyListeners(t,this._evt);
if(window._facadeCleanup){
window._facadeCleanup();
window._facadeCleanup=null
}};
ZmZimbraMail.prototype.addApp=function(t){
var e=t.getName();
this._apps[e]=t;
ZmApp.ENABLED_APPS[e]=true
};
ZmZimbraMail.prototype._createApp=function(appName){
if(!appName||this._apps[appName]){
return
}
var appClass=eval(ZmApp.CLASS[appName]);
this.addApp(new appClass(this._shell))
};
ZmZimbraMail.prototype._setExternalLinks=function(){
var e=document.getElementById("skin_container_links");
if(e){
var a;
if(!appCtxt.isOffline&&(appCtxt.get(ZmSetting.IS_ADMIN)||appCtxt.get(ZmSetting.IS_DELEGATED_ADMIN))){
a=appCtxt.get(ZmSetting.ADMIN_REFERENCE);
if(!a){
a=["https://",location.hostname,":7071"].join("")
}}
var t={
showOfflineLink:(!appCtxt.isOffline&&appCtxt.get(ZmSetting.SHOW_OFFLINE_LINK)),helpIcon:(appCtxt.getSkinHint("helpButton","hideIcon")?null:"Help"),logoutIcon:(appCtxt.getSkinHint("logoutButton","hideIcon")?null:"Logoff"),logoutText:(appCtxt.isOffline?ZmMsg.setup:ZmMsg.logOff),adminUrl:a};
e.innerHTML=AjxTemplate.expand("share.App#UserInfo",t)
}};
ZmZimbraMail.prototype.setUserInfo=function(){
if(appCtxt.multiAccounts||appCtxt.isOffline){
return
}
var e=appCtxt.get(ZmSetting.USERNAME);
var s=(appCtxt.get(ZmSetting.DISPLAY_NAME))||e;
if(s){
this._userNameField.getHtmlElement().innerHTML=AjxStringUtil.clipByLength(s,24);
if(AjxEnv.isLinux){
this._userNameField.getHtmlElement().style.lineHeight="13px"
}}
var n=(appCtxt.get(ZmSetting.QUOTA_USED))||0;
var o={
id:this._usedQuotaField._htmlElId,login:e,username:s,quota:appCtxt.get(ZmSetting.QUOTA),usedQuota:n,size:(AjxUtil.formatSize(n,false,1))};
var a;
if(o.quota){
a="UsedLimited";
o.limit=AjxUtil.formatSize(o.quota,false,1);
o.percent=Math.min(Math.round((o.usedQuota/o.quota)*100),100);
o.desc=AjxMessageFormat.format(ZmMsg.quotaDescLimited,[o.percent+"%",o.limit])
}else{
o.desc=AjxMessageFormat.format(ZmMsg.quotaDescUnlimited,[o.size]);
a="UsedUnlimited"
}
this._usedQuotaField.getHtmlElement().innerHTML=AjxTemplate.expand("share.Quota#"+a,o);
var t=(s!=e||o.quota>0)?AjxTemplate.expand("share.Quota#Tooltip",o):null;
this._components[ZmAppViewMgr.C_USER_INFO].setToolTipContent(t);
this._components[ZmAppViewMgr.C_QUOTA_INFO].setToolTipContent(t)
};
ZmZimbraMail.prototype._resetUserInfo=function(){
var a=document.getElementById("skin_container_username");
if(a){
Dwt.setDisplay(a,Dwt.DISPLAY_NONE)
}
var o=document.getElementById("skin_container_quota");
if(o){
Dwt.setDisplay(o,Dwt.DISPLAY_NONE)
}
var e=document.getElementById("skin_container_account");
if(e){
e.innerHTML=ZmMsg.accounts;
Dwt.setDisplay(e,Dwt.DISPLAY_BLOCK)
}
var t=document.getElementById("skin_container_tree_top");
if(t){
t.className="OfflineTreeTop"
}
this._appViewMgr._fitToContainer([ZmAppViewMgr.C_TREE,ZmAppViewMgr.C_TREE_FOOTER])
};
ZmZimbraMail.logOff=function(){
ZmZimbraMail._isLogOff=true;
if(appCtxt.isOffline&&AjxEnv.isWindows&&appCtxt.get(ZmSetting.OFFLINE_SUPPORTS_DOCK_UPDATE)){
window.platform.icon().imageSpec="resource://webapp/icons/default/launcher.ico";
window.platform.icon().title=null
}
var e=AjxUtil.formatUrl({
path:appContextPath,qsArgs:{
loginOp:"logout"}}
);
ZmZimbraMail.sendRedirect(e)
};
ZmZimbraMail._onClickLogOff=function(){
if(AjxEnv.isIE){
var e=DwtUiEvent.getEvent();
e.returnValue=false
}
ZmZimbraMail.logOff()
};
ZmZimbraMail.helpLinkCallback=function(){
ZmZimbraMail.unloadHackCallback();
var o=window.parentAppCtxt||window.appCtxt;
var a;
if(!o.isOffline){
try{
a=skin.hints.helpButton.url
}
catch(n){}
a=a||o.get(ZmSetting.HELP_URI);
var t=a.match(/\?/)?"&":"?";
a=[a,t,"locid=",AjxEnv.DEFAULT_LOCALE].join("")
}else{
a=o.get(ZmSetting.HELP_URI).replace(/\/$/,"");
a=[a,"help","en_US","Zimbra_Mail_Help.htm"].join("/")
}
window.open(a)
};
ZmZimbraMail.sendRedirect=function(t){
if(AjxEnv.isIE){
var e=new AjxTimedAction(null,ZmZimbraMail.redir,[t]);
AjxTimedAction.scheduleAction(e,1)
}else{
ZmZimbraMail.redir(t)
}};
ZmZimbraMail.redir=function(e){
window.location=e
};
ZmZimbraMail.prototype.setSessionTimer=function(t){
var e=appCtxt.get(ZmSetting.IDLE_SESSION_TIMEOUT)*1000;
if(e<=0){
return
}
if(t){
this._sessionTimerId=AjxTimedAction.scheduleAction(this._sessionTimer,e);
DwtEventManager.addListener(DwtEvent.ONMOUSEUP,ZmZimbraMail._userEventHdlr);
this._shell.setHandler(DwtEvent.ONMOUSEUP,ZmZimbraMail._userEventHdlr);
if(AjxEnv.isIE){
this._shell.setHandler(DwtEvent.ONMOUSEDOWN,ZmZimbraMail._userEventHdlr)
}else{
window.onkeydown=ZmZimbraMail._userEventHdlr
}}else{
AjxTimedAction.cancelAction(this._sessionTimerId);
this._sessionTimerId=-1;
DwtEventManager.removeListener(DwtEvent.ONMOUSEUP,ZmZimbraMail._userEventHdlr);
this._shell.clearHandler(DwtEvent.ONMOUSEUP);
if(AjxEnv.isIE){
this._shell.clearHandler(DwtEvent.ONMOUSEDOWN)
}else{
window.onkeydown=null
}}};
ZmZimbraMail.prototype.addChildWindow=function(t){
if(this._childWinList==null){
this._childWinList=new AjxVector()
}
var e={
win:t};
this._childWinList.add(e);
return e
};
ZmZimbraMail.prototype.getChildWindow=function(t){
if(this._childWinList){
for(var e=0;
e<this._childWinList.size();
e++){
if(t==this._childWinList.get(e).win){
return this._childWinList.get(e)
}}}
return null
};
ZmZimbraMail.prototype.removeChildWindow=function(t){
if(this._childWinList){
for(var e=0;
e<this._childWinList.size();
e++){
if(t==this._childWinList.get(e).win){
this._childWinList.removeAt(e);
break
}}}};
ZmZimbraMail.prototype._handleException=function(r,t){
var o=false;
if(r.code==ZmCsfeException.MAIL_NO_SUCH_FOLDER){
var e=[ZmOrganizer.CALENDAR,ZmOrganizer.NOTEBOOK,ZmOrganizer.ADDRBOOK];
if(r.data.itemId&&r.data.itemId.length){
var l=r.data.itemId[0];
var n=l.lastIndexOf(":");
var s=l.substring(0,n);
var c=l.substring(n+1,l.length);
var a=appCtxt.getFolderTree();
for(var h=0;
h<e.length;
h++){
o|=a.handleNoSuchFolderError(e[h],s,c,true)
}}}
if(!o){
ZmController.prototype._handleException.apply(this,arguments)
}};
ZmZimbraMail._confirmExitMethod=function(){
appCtxt.accountList.saveImplicitPrefs();
if(!ZmZimbraMail._isOkToExit()){
ZmZimbraMail._isLogOff=false;
return ZmMsg.appExitWarning
}
ZmZimbraMail._endSession();
ZmZimbraMail._endSessionDone=true
};
ZmZimbraMail._isOkToExit=function(){
var t=window._zimbraMail;
if(!t){
return true
}
var e=t._appViewMgr.isOkToUnload();
if(e&&t._pollRequest){
t._requestMgr.cancelRequest(t._pollRequest)
}
return e
};
ZmZimbraMail.unloadHackCallback=function(){
window.onbeforeunload=null;
var e=function(){
window.onbeforeunload=ZmZimbraMail._confirmExitMethod
};
AjxTimedAction.scheduleAction((new AjxTimedAction(null,e)),3000)
};
ZmZimbraMail._userEventHdlr=function(t){
var e=window._zimbraMail;
if(e){
AjxTimedAction.cancelAction(e._sessionTimerId);
var a=appCtxt.get(ZmSetting.IDLE_SESSION_TIMEOUT)*1000;
e._sessionTimerId=AjxTimedAction.scheduleAction(e._sessionTimer,a)
}};
ZmZimbraMail.prototype._createBanner=function(){
var e=new DwtComposite({
parent:this._shell,posStyle:Dwt.ABSOLUTE_STYLE,id:ZmId.BANNER}
);
var a=appCtxt.getSkinHint("banner","url")||appCtxt.get(ZmSetting.LOGO_URI);
var t={
url:a};
e.getHtmlElement().innerHTML=AjxTemplate.expand("share.App#Banner",t);
return e
};
ZmZimbraMail.prototype._createUserInfo=function(n,h,r){
var e=appCtxt.getSkinHint(h,"position");
var o=e||Dwt.ABSOLUTE_STYLE;
var s=new DwtComposite({
parent:this._shell,className:n,posStyle:o,id:r}
);
if(AjxEnv.isIE){
var a=document.getElementById("skin_td_tree");
var t=a?Dwt.getSize(document.getElementById("skin_td_tree")).x:null;
if(t){
s.setSize(t)
}}
s._setMouseEventHdlrs();
return s
};
ZmZimbraMail.prototype._createAppChooser=function(){
var a=[];
for(var s in ZmApp.CHOOSER_SORT){
if(s==ZmAppChooser.SPACER||s==ZmAppChooser.B_HELP||s==ZmAppChooser.B_LOGOUT){
continue
}
var t=ZmApp.SETTING[s];
var n=ZmApp.UPSELL_SETTING[s];
if((t&&appCtxt.get(t))||(n&&appCtxt.get(n))){
a.push(s)
}}
a.sort(function(h,r){
return ZmZimbraMail.hashSortCompare(ZmApp.CHOOSER_SORT,h,r)
}
);
var o=new ZmAppChooser({
parent:this._shell,buttons:a,id:ZmId.APP_CHOOSER,refElementId:ZmId.SKIN_APP_CHOOSER}
);
var e=new AjxListener(this,this._appButtonListener);
o.addSelectionListener(e);
return o
};
ZmZimbraMail.prototype._appButtonListener=function(t){
try{
var a=t.item.getData(Dwt.KEY_ID);
if(a==ZmAppChooser.B_HELP){
window.open(appCtxt.get(ZmSetting.HELP_URI))
}else{
if(a==ZmAppChooser.B_LOGOUT){
ZmZimbraMail.logOff()
}else{
if(a&&ZmApp.ENABLED_APPS[a]&&(a!=this._activeTabId)){
this.activateApp(a);
if(appCtxt.zimletsPresent()){
appCtxt.getZimletMgr().notifyZimlets("onSelectApp",a)
}}else{
if(a!=this._activeTabId){
this._appViewMgr.pushView(a)
}
if(t.target&&(t.target.className=="ImgClose")){
this._appViewMgr.popView()
}}}}}
catch(e){
this._handleException(e)
}};
ZmZimbraMail.prototype.getAppChooser=function(){
return this._appChooser
};
ZmZimbraMail.prototype.setActiveTabId=function(e){
this._activeTabId=e;
this._appChooser.setSelected(e)
};
ZmZimbraMail.prototype.setStatusMsg=function(e){
e=Dwt.getParams(arguments,ZmStatusView.MSG_PARAMS);
this.statusView.setStatusMsg(e)
};
ZmZimbraMail.prototype.getKeyMapName=function(){
var e=appCtxt.getCurrentController();
if(e&&e.getKeyMapName){
return e.getKeyMapName()
}
return"Global"
};
ZmZimbraMail.prototype.handleKeyAction=function(o,x){
DwtMenu.closeActiveMenu();
var h=ZmApp.GOTO_ACTION_CODE_R[o];
if(h){
if(h==this.getActiveApp()){
return false
}
this.activateApp(h);
return true
}
if(x&&(x.keyCode==13||x.keyCode==3)&&!(x.altKey||x.ctrlKey||x.metaKey||x.shiftKey)&&x.target&&(x.target.id!=DwtKeyboardMgr.FOCUS_FIELD_ID)){
return false
}
switch(o){
case ZmKeyMap.DBG_NONE:appCtxt.setStatusMsg("Setting Debug Level To: "+AjxDebug.NONE);
break;
case ZmKeyMap.DBG_1:appCtxt.setStatusMsg("Setting Debug Level To: "+AjxDebug.DBG1);
break;
case ZmKeyMap.DBG_2:appCtxt.setStatusMsg("Setting Debug Level To: "+AjxDebug.DBG2);
break;
case ZmKeyMap.DBG_3:appCtxt.setStatusMsg("Setting Debug Level To: "+AjxDebug.DBG3);
break;
case ZmKeyMap.DBG_TIMING:var c=DBG._showTiming;
var t=c?"off":"on";
appCtxt.setStatusMsg("Turning Timing Info "+t);
break;
case ZmKeyMap.ASSISTANT:if(appCtxt.get(ZmSetting.ASSISTANT_ENABLED)){
if(!this._assistantDialog){
AjxDispatcher.require("Assistant");
this._assistantDialog=new ZmAssistantDialog()
}
this._assistantDialog.popup()
}
break;
case ZmKeyMap.LOGOFF:ZmZimbraMail.logOff();
break;
case ZmKeyMap.FOCUS_SEARCH_BOX:var e=appCtxt.getSearchController().getSearchToolbar();
if(e){
var s=e.getSearchField();
appCtxt.getKeyboardMgr().grabFocus(s);
if(ZmSearchAutocomplete){
ZmSearchAutocomplete._ignoreNextKey=true
}}
break;
case ZmKeyMap.FOCUS_CONTENT_PANE:this.focusContentPane();
break;
case ZmKeyMap.FOCUS_TOOLBAR:this.focusToolbar();
break;
case ZmKeyMap.SHORTCUTS:var m=appCtxt.getShortcutsPanel();
var u=this.getKeyMapName();
var a=appCtxt.getAppController().getKeyMapMgr();
var p=a.getAncestors(u);
var d=(p&&p.length>0);
p.unshift(u);
var b=[],y=[];
if(d){
if(p.length>1&&p[p.length-1]=="Global"){
p.pop();
y.push("global")
}}
for(var w=0;
w<p.length;
w++){
b.push(ZmKeyMap.MAP_NAME_R[p[w]]||DwtKeyMap.MAP_NAME_R[p[w]])
}
var q={}
,k={};
q.type=ZmShortcutList.TYPE_APP;
q.maps=b;
var l=[q];
if(y.length){
k.type=ZmShortcutList.TYPE_APP;
k.maps=y;
l.push(k)
}
var v={};
v.type=ZmShortcutList.TYPE_SYS;
v.maps=[];
var n=appCtxt.getCurrentController();
var j=["list","editor","tabView"];
for(var w=0;
w<j.length;
w++){
if(n.mapSupported(j[w])){
v.maps.push(j[w])
}}
v.maps.push("button","menu","tree","dialog","toolbarHorizontal");
l.push(v);
m.popup(l);
break;
case ZmKeyMap.CANCEL:var r=false;
var g=(DwtMouseEventCapture.getId()=="DwtControl")?DwtMouseEventCapture.getCaptureObj():null;
var f=g&&g.targetObj;
if(f&&(f._dragging==DwtControl._DRAGGING)){
g.release();
f.__lastDestDwtObj=null;
f._setDragProxyState(false);
DwtControl.__badDrop(f,DwtShell.mouseEvent);
r=true
}
if(r){
break
}
default:var n=appCtxt.getCurrentController();
return(n&&n.handleKeyAction)?n.handleKeyAction(o,x):false
}
return true
};
ZmZimbraMail.prototype.focusContentPane=function(){
var e=appCtxt.getCurrentController();
var t=e?e.getCurrentView():null;
if(t){
appCtxt.getKeyboardMgr().grabFocus(t)
}};
ZmZimbraMail.prototype.focusToolbar=function(){
var e=appCtxt.getCurrentController();
var t=e?e.getCurrentToolbar():null;
if(t){
appCtxt.getKeyboardMgr().grabFocus(t)
}};
ZmZimbraMail.prototype._createUpsellView=function(n){
var a=this._upsellView[n]=new ZmUpsellView({
parent:this._shell,posStyle:Dwt.ABSOLUTE_STYLE,className:"ZmUpsellView"}
);
var o=appCtxt.get(ZmApp.UPSELL_URL[n]);
var t=a.getHtmlElement();
var l=[];
var h=0;
l[h++]="<iframe id='iframe_"+a.getHTMLElId()+"' width='100%' height='100%' frameborder='0' src='";
l[h++]=o;
l[h++]="'>";
t.innerHTML=l.join("");
var e={};
e[ZmAppViewMgr.C_APP_CONTENT_FULL]=a;
var r=[n,"upsell"].join("_");
this._appViewMgr.createView({
viewId:r,appName:n,elements:e,isTransient:true}
);
this._appViewMgr.pushView(r);
var s=[ZmMsg.zimbraTitle,n].join(": ");
Dwt.setTitle(s)
};
ZmZimbraMail._createDummyDBG=function(){
window.AjxDebug=function(){};
window.AjxDebug.prototype.toString=function(){
return"dummy DBG class"
};
window.AjxDebug.prototype.display=function(){};
window.AjxDebug.prototype.dumpObj=function(){};
window.AjxDebug.prototype.getDebugLevel=function(){};
window.AjxDebug.prototype.isDisabled=function(){};
window.AjxDebug.prototype.println=function(){};
window.AjxDebug.prototype.printRaw=function(){};
window.AjxDebug.prototype.printXML=function(){};
window.AjxDebug.prototype.setDebugLevel=function(){};
window.AjxDebug.prototype.setTitle=function(){};
window.AjxDebug.prototype.showTiming=function(){};
window.AjxDebug.prototype._getTimeStamp=function(){};
window.AjxDebug.prototype.timePt=function(){};
window.DBG=new window.AjxDebug()
};
ZmZimbraMail.prototype._postLoadZimlet=function(){
appCtxt.setZimletsPresent(true)
};
ZmZimbraMail.globalButtonListener=function(n){
if(!appCtxt.areZimletsLoaded()){
return
}
var o=n.item;
var h=(o&&o.getText)?(o.getText()||o._toggleText):null;
if(!h){
h=o.getData(ZmOperation.KEY_ID)||o.getData(Dwt.KEY_ID)
}
if(h){
var a;
if(o instanceof ZmAppButton){
a="app"
}else{
if(o instanceof DwtMenuItem){
a="menuitem"
}else{
if(o instanceof DwtButton){
a="button"
}else{
if(o instanceof DwtTreeItem){
if(!o.getSelected()){
return
}
a="treeitem"
}else{
a=o.toString()
}}}}
var t=appCtxt.getAppViewMgr();
var e=t.getCurrentViewId();
var r=t.getLastViewId();
var s=(AjxStringUtil.split(h," ")).join("");
appCtxt.notifyZimlets("onAction",[a,s,e,r])
}};
ZmZimbraMail._endSession=function(){
var e=new AjxCallback(null,function(){
return true
}
);
var t={
jsonObj:{
EndSessionRequest:{
_jsns:"urn:zimbraAccount"}}
,asyncMode:true,errorCallback:e};
appCtxt.getAppController().sendRequest(t)
};
ZmOrganizer.ZIMLET="ZIMLET"
}
if(AjxPackage.define("zimbraMail.calendar.model.ZmCalBaseItem")){
ZmCalBaseItem=function(t,a,o,e){
if(arguments.length==0){
return
}
ZmItem.call(this,t,o,a);
this.id=o||-1;
this.uid=-1;
this.folderId=e||this._getDefaultFolderId();
this.fragment="";
this.name="";
this.allDayEvent="0";
this.startDate=null;
this.endDate=null;
this.timezone=AjxTimezone.getServerId(AjxTimezone.DEFAULT);
this.alarm=false;
this.alarmData=null;
this.isException=false;
this.recurring=false;
this.priority=null;
this.ptst=null;
this.status=ZmCalendarApp.STATUS_CONF;
this._reminderMinutes=0;
this.otherAttendees=false
};
ZmCalBaseItem.prototype=new ZmItem;
ZmCalBaseItem.prototype.constructor=ZmCalBaseItem;
ZmCalBaseItem.prototype.toString=function(){
return"ZmCalBaseItem"
};
ZmCalBaseItem.PERSON="PERSON";
ZmCalBaseItem.LOCATION="LOCATION";
ZmCalBaseItem.EQUIPMENT="EQUIPMENT";
ZmCalBaseItem.FORWARD="FORWARD";
ZmCalBaseItem.PSTATUS_ACCEPT="AC";
ZmCalBaseItem.PSTATUS_DECLINED="DE";
ZmCalBaseItem.PSTATUS_DEFERRED="DF";
ZmCalBaseItem.PSTATUS_DELEGATED="DG";
ZmCalBaseItem.PSTATUS_NEEDS_ACTION="NE";
ZmCalBaseItem.PSTATUS_COMPLETED="CO";
ZmCalBaseItem.PSTATUS_TENTATIVE="TE";
ZmCalBaseItem.PSTATUS_WAITING="WA";
ZmCalBaseItem.FBA_TO_PTST={
B:ZmCalBaseItem.PSTATUS_ACCEPT,F:ZmCalBaseItem.PSTATUS_DECLINED,T:ZmCalBaseItem.PSTATUS_TENTATIVE};
ZmCalBaseItem._pstatusString={
NE:ZmMsg._new,TE:ZmMsg.tentative,AC:ZmMsg.accepted,DE:ZmMsg.declined,DG:ZmMsg.delegated};
ZmCalBaseItem.compareByTimeAndDuration=function(t,e){
if(t.getStartTime()>e.getStartTime()){
return 1
}
if(t.getStartTime()<e.getStartTime()){
return -1
}
if(t.getDuration()<e.getDuration()){
return 1
}
if(t.getDuration()>e.getDuration()){
return -1
}
return 0
};
ZmCalBaseItem.createFromDom=function(t,a,e){
var o=new ZmCalBaseItem(ZmItem.APPT,a.list);
o._loadFromDom(t,(e||{}
));
return o
};
ZmCalBaseItem.prototype.getName=function(){
return this.name||""
};
ZmCalBaseItem.prototype.getEndTime=function(){
return this.endDate.getTime()
};
ZmCalBaseItem.prototype.getStartTime=function(){
return this.startDate.getTime()
};
ZmCalBaseItem.prototype.getDuration=function(){
return this.getEndTime()-this.getStartTime()
};
ZmCalBaseItem.prototype.getLocation=function(){
return this.location||""
};
ZmCalBaseItem.prototype.isAllDayEvent=function(){
return this.allDayEvent=="1"
};
ZmCalBaseItem.prototype.getParticipantStatusStr=function(){
return ZmCalBaseItem._pstatusString[this.ptst]
};
ZmCalBaseItem.prototype.getUniqueId=function(e){
if(e){
if(!this._startTimeUniqId){
this._startTimeUniqId=this.id+"_"+this.getStartTime()
}
return this._startTimeUniqId
}else{
if(this._uniqId==null){
this._uniqId=Dwt.getNextId()
}
return(this.id+"_"+this._uniqId)
}};
ZmCalBaseItem.prototype.isMultiDay=function(){
var t=this.startDate;
var e=this.endDate;
if(e.getHours()==0&&e.getMinutes()==0&&e.getSeconds()==0){
e=new Date(e.getTime()-2*AjxDateUtil.MSEC_PER_HOUR)
}
return(t.getDate()!=e.getDate())||(t.getMonth()!=e.getMonth())||(t.getFullYear()!=e.getFullYear())
};
ZmCalBaseItem.prototype.getDurationText=function(a,e){
var o=this.isAllDayEvent();
var s=this.isMultiDay();
if(o){
if(a){
return""
}
var r=this.startDate;
var t=new Date(this.endDate.getTime()-(s?2*AjxDateUtil.MSEC_PER_HOUR:0));
var n=s?ZmMsg.apptTimeAllDayMulti:ZmMsg.apptTimeAllDay;
return AjxMessageFormat.format(n,[r,t])
}
if(e){
return ZmCalBaseItem._getTTHour(this.startDate)
}
var n=s?ZmMsg.apptTimeInstanceMulti:ZmMsg.apptTimeInstance;
return AjxMessageFormat.format(n,[this.startDate,this.endDate,""])
};
ZmCalBaseItem.prototype.isAlarmInRange=function(){
if(!this.alarmData){
return false
}
var t=this.alarmData[0];
if(!t){
return false
}
this._nextAlarmTime=this.adjustMS(t.nextAlarm,this.tzo);
this._alarmInstStart=this.adjustMS(t.alarmInstStart,this.tzo);
var e=(new Date()).getTime();
return(e>=this._nextAlarmTime)
};
ZmCalBaseItem.prototype.adjustMS=function(e,a){
var t=this.isAllDayEvent()?(a+new Date(e).getTimezoneOffset()*60*1000):0;
return parseInt(e,10)+t
};
ZmCalBaseItem.prototype.isAlarmInstance=function(){
if(!this.alarmData){
return false
}
var e=this.alarmData[0];
this._alarmInstStart=this.adjustMS(e.alarmInstStart,this.tzo);
return(this._alarmInstStart==this.startDate.getTime())
};
ZmCalBaseItem.prototype.hasAlarmData=function(){
return(this.alarmData!=null)
};
ZmCalBaseItem.prototype._loadFromDom=function(a,e){
this.uid=a.uid;
this.folderId=a.l||this._getDefaultFolderId();
this.invId=a.invId;
this.id=this._getAttr(a,e,"id");
this.name=this._getAttr(a,e,"name");
this.fragment=this._getAttr(a,e,"fr");
this.status=this._getAttr(a,e,"status");
this.ptst=this._getAttr(a,e,"ptst");
this.isException=this._getAttr(a,e,"ex");
this.allDayEvent=(e.allDay||a.allDay)?"1":"0";
this.organizer=a.or&&a.or.a;
this.isOrg=this._getAttr(a,e,"isOrg");
this.transparency=this._getAttr(a,e,"transp");
if(e.allDay==false){
this.allDayEvent="0"
}
this.alarm=this._getAttr(a,e,"alarm");
this.alarmData=this._getAttr(a,e,"alarmData");
this.priority=parseInt(this._getAttr(a,e,"priority"));
this.recurring=e.recur!=null?e.recur:a.recur;
this.fba=this._getAttr(a,e,"fba");
var r=this._getAttr(a,e,"s");
if(r){
var h=this.tzo=e.tzo!=null?e.tzo:a.tzo;
var s=this.isAllDayEvent()?(h+new Date(e.s).getTimezoneOffset()*60*1000):0;
var n=parseInt(r,10)+s;
this.startDate=new Date(n);
this.uniqStartTime=this.startDate.getTime()
}
var o=this._getAttr(a,e,"dur");
if(o){
var t=n+(parseInt(o));
this.endDate=new Date(t)
}
this.otherAttendees=this._getAttr(a,e,"otherAtt");
this.location=this._getAttr(a,e,"loc")
};
ZmCalBaseItem.prototype._getDefaultFolderId=function(){
return ZmOrganizer.ID_CALENDAR
};
ZmCalBaseItem.prototype._getAttr=function(e,a,t){
return a[t]!=null?a[t]:e[t]
};
ZmCalBaseItem.prototype._addLocationToSoap=function(e){
e.setAttribute("loc",this.getLocation())
};
ZmCalBaseItem._getTTHour=function(t){
var e=AjxDateFormat.getTimeInstance(AjxDateFormat.SHORT);
return e.format(t)
};
ZmCalBaseItem.prototype.getReminderLocation=function(){
return(this.alarmData[0].loc||"")
};
ZmCalBaseItem.prototype.getReminderName=function(){
return(this.alarmData[0].name||"")
};
ZmCalBaseItem.prototype.isAlarmOld=function(){
if(!this.alarmData){
return false
}
var a=this.alarmData[0];
this._nextAlarmTime=a.nextAlarm;
this._alarmInstStart=a.alarmInstStart;
var e=(new Date()).getTime();
var t=(e-this._nextAlarmTime);
if(t>2*AjxDateUtil.MSEC_PER_DAY){
return true
}
return false
}
}
if(AjxPackage.define("zimbraMail.prefs.ZmPreferencesApp")){
ZmPreferencesApp=function(t,e){
ZmApp.call(this,ZmApp.PREFERENCES,t,e);
this._filterRules={}
};
ZmEvent.S_FILTER="FILTER";
ZmEvent.S_PREF_ZIMLET="PREF_ZIMLET";
ZmApp.PREFERENCES=ZmId.APP_PREFERENCES;
ZmApp.CLASS[ZmApp.PREFERENCES]="ZmPreferencesApp";
ZmApp.SETTING[ZmApp.PREFERENCES]=ZmSetting.OPTIONS_ENABLED;
ZmApp.LOAD_SORT[ZmApp.PREFERENCES]=10;
ZmApp.QS_ARG[ZmApp.PREFERENCES]="options";
ZmOrganizer.PREF_PAGE="PREF_PAGE";
ZmPreferencesApp.prototype=new ZmApp;
ZmPreferencesApp.prototype.constructor=ZmPreferencesApp;
ZmPreferencesApp.prototype.toString=function(){
return"ZmPreferencesApp"
};
ZmPreferencesApp._registerAllPrefs=function(){
AjxDispatcher.require("PreferencesCore");
appCtxt.getAppController().runAppFunction("_registerPrefs")
};
ZmZimbraMail.addAppListener(ZmApp.PREFERENCES,ZmAppEvent.PRE_LAUNCH,new AjxListener(ZmPreferencesApp._registerAllPrefs));
ZmPreferencesApp.prototype.launch=function(t,a){
if(appCtxt.isOffline){
appCtxt.accountList.setActiveAccount(appCtxt.accountList.mainAccount)
}
var e=new AjxCallback(this,this._handleLoadLaunch,[a]);
AjxDispatcher.require(["PreferencesCore","Preferences"],true,e,null,true)
};
ZmPreferencesApp.prototype.getPrefController=function(){
if(!this._prefController){
AjxDispatcher.require(["PreferencesCore","Preferences"]);
this._prefController=new ZmPrefController(this._container,this)
}
return this._prefController
};
ZmPreferencesApp.prototype.getFilterController=function(){
if(!this._filterController){
this._filterController=new ZmFilterController(this._container,this)
}
return this._filterController
};
ZmPreferencesApp.prototype.getFilterRules=function(){
var t=window.parentAppCtxt||window.appCtxt;
var e=t.getActiveAccount().name;
if(!this._filterRules[e]){
this._filterRules[e]=new ZmFilterRules()
}
return this._filterRules[e]
};
ZmPreferencesApp.prototype.modifyNotify=function(a,e){
var t=this._getSharingView();
if(t){
t.notifyModify(a)
}};
ZmPreferencesApp.prototype.refresh=function(e){
if(!appCtxt.inStartup){
var t=this._getSharingView();
if(t){
t.refresh(e)
}}};
ZmPreferencesApp.prototype._defineAPI=function(){
AjxDispatcher.registerMethod("GetFilterRules",["PreferencesCore","Preferences"],new AjxCallback(this,this.getFilterRules));
AjxDispatcher.registerMethod("GetPrefController",["PreferencesCore","Preferences"],new AjxCallback(this,this.getPrefController));
AjxDispatcher.registerMethod("GetFilterController",["PreferencesCore","Preferences"],new AjxCallback(this,this.getFilterController))
};
ZmPreferencesApp.prototype._registerOrganizers=function(){
ZmOrganizer.registerOrg(ZmOrganizer.PREF_PAGE,{
app:ZmApp.PREFERENCES,orgClass:"ZmPrefPage",orgPackage:"PreferencesCore",treeController:"ZmPrefPageTreeController",labelKey:"preferences",treeType:ZmOrganizer.PREF_PAGE,displayOrder:100}
)
};
ZmPreferencesApp.prototype._registerOperations=function(){
ZmOperation.registerOp(ZmId.OP_MOBILE_RESUME_SYNC,{
textKey:"mobileResumeSync",image:"ImAvailable"}
);
ZmOperation.registerOp(ZmId.OP_MOBILE_SUSPEND_SYNC,{
textKey:"mobileSuspendSync",image:"Offline"}
);
ZmOperation.registerOp(ZmId.OP_MOBILE_WIPE,{
textKey:"mobileWipe",image:"MobileWipe"}
,ZmSetting.MOBILE_POLICY_ENABLED);
ZmOperation.registerOp(ZmId.OP_MOBILE_CANCEL_WIPE,{
textKey:"mobileWipeCancel",image:"MobileWipeCancel"}
,ZmSetting.MOBILE_POLICY_ENABLED)
};
ZmPreferencesApp.prototype._registerSettings=function(e){
e=e||appCtxt.getSettings();
e.registerSetting("IMPORT_FOLDER",{
type:ZmSetting.T_PSEUDO,dataType:ZmSetting.D_NONE}
);
e.registerSetting("IMPORT_BUTTON",{
type:ZmSetting.T_PSEUDO,dataType:ZmSetting.D_NONE}
);
e.registerSetting("EXPORT_FOLDER",{
type:ZmSetting.T_PSEUDO,dataType:ZmSetting.D_NONE}
);
e.registerSetting("EXPORT_BUTTON",{
type:ZmSetting.T_PSEUDO,dataType:ZmSetting.D_NONE}
);
e.registerSetting("PREF_SECTIONS",{
type:ZmSetting.T_PSEUDO,dataType:ZmSetting.D_HASH,isGlobal:true}
);
e.registerSetting("SIGNATURE_MAX_LENGTH",{
name:"zimbraMailSignatureMaxLength",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:1024}
);
e.registerSetting("DISCARD_IN_FILTER_ENABLED",{
name:"zimbraFeatureDiscardInFiltersEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
)
};
ZmPreferencesApp.prototype._registerApp=function(){
ZmApp.registerApp(ZmApp.PREFERENCES,{
mainPkg:"Preferences",nameKey:"preferences",icon:"Preferences",textPrecedence:50,chooserTooltipKey:"goToOptions",button:appCtxt.isChildWindow?null:ZmAppChooser.B_OPTIONS,overviewTrees:[ZmOrganizer.PREF_PAGE],hideZimlets:true,gotoActionCode:ZmKeyMap.GOTO_OPTIONS,chooserSort:180}
)
};
ZmPreferencesApp.prototype._registerPrefs=function(){
var l={
GENERAL:{
title:ZmMsg.general,description:"[General settings]",templateId:"prefs.Pages#General",priority:0,prefs:[ZmSetting.LOCALE_NAME,ZmSetting.PASSWORD,ZmSetting.SEARCH_INCLUDES_SPAM,ZmSetting.SEARCH_INCLUDES_TRASH,ZmSetting.OFFLINE_SHOW_GLOBAL_INBOX,ZmSetting.SHOW_SEARCH_STRING,ZmSetting.SHOW_SELECTION_CHECKBOX,ZmSetting.SKIN_NAME,ZmSetting.CLIENT_TYPE,ZmSetting.DEFAULT_TIMEZONE,ZmSetting.OFFLINE_IS_MAILTO_HANDLER]}
,COMPOSING:{
parentId:"MAIL",title:ZmMsg.composing,icon:"Compose",templateId:"prefs.Pages#Composing",priority:20,precondition:[ZmSetting.MAIL_ENABLED],prefs:[ZmSetting.COMPOSE_AS_FORMAT,ZmSetting.COMPOSE_INIT_FONT_COLOR,ZmSetting.COMPOSE_INIT_FONT_FAMILY,ZmSetting.COMPOSE_INIT_FONT_SIZE,ZmSetting.FORWARD_INCLUDE_ORIG,ZmSetting.NEW_WINDOW_COMPOSE,ZmSetting.AUTO_SAVE_DRAFT_INTERVAL,ZmSetting.REPLY_INCLUDE_ORIG,ZmSetting.REPLY_PREFIX,ZmSetting.SAVE_TO_SENT,ZmSetting.COMPOSE_SAME_FORMAT,ZmSetting.MAIL_MANDATORY_SPELLCHECK]}
,SHARING:{
title:ZmMsg.sharing,icon:"SharedContact",templateId:"prefs.Pages#SharingPrefPage",priority:85,precondition:ZmSetting.SHARING_ENABLED,manageChanges:true,createView:function(m,f,u){
AjxDispatcher.require("Share");
return new ZmSharingPage(m,f,u)
}}
,MOBILE:{
title:ZmMsg.mobileDevices,icon:"Mobile",templateId:"prefs.Pages#MobileDevices",priority:90,precondition:ZmSetting.MOBILE_SYNC_ENABLED,manageChanges:true,createView:function(m,f,u){
return new ZmMobileDevicesPage(m,f,u)
}}
,IMPORT_EXPORT:{
title:ZmMsg.importExport,icon:"SendReceive",templateId:"data.ImportExport#ImportExportPrefPage",priority:100,precondition:ZmSetting.IMPORT_EXPORT_ENABLED,prefs:[ZmSetting.IMPORT_FOLDER,ZmSetting.IMPORT_BUTTON,ZmSetting.EXPORT_FOLDER,ZmSetting.EXPORT_BUTTON],manageChanges:true,createView:function(m,f,u){
AjxDispatcher.require("ImportExport");
return new ZmImportExportPage(m,f,u)
}}
,SHORTCUTS:{
title:ZmMsg.shortcuts,icon:"Shortcut",templateId:"prefs.Pages#Shortcuts",priority:120,precondition:ZmSetting.USE_KEYBOARD_SHORTCUTS,createView:function(m,f,u){
return new ZmShortcutsPage(m,f,u)
}}
,PREF_ZIMLETS:{
title:ZmMsg.zimlets,icon:"Zimlet",templateId:"prefs.Pages#Zimlets",manageDirty:true,priority:140,prefs:[ZmSetting.CHECKED_ZIMLETS],createView:function(m,f,u){
return new ZmZimletsPage(m,f,u)
}}};
for(var a in l){
ZmPref.registerPrefSection(a,l[a])
}
ZmPref.registerPref("CLIENT_TYPE",{
displayName:ZmMsg.clientType,displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_VERTICAL,displayOptions:[ZmMsg.clientAdvanced,ZmMsg.clientStandard],options:[ZmSetting.CLIENT_ADVANCED,ZmSetting.CLIENT_STANDARD]}
);
ZmPref.registerPref("COMPOSE_AS_FORMAT",{
displayName:ZmMsg.composeUsing,displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_VERTICAL,displayOptions:[ZmMsg.composeAsHTML,ZmMsg.composeAsText],options:[ZmSetting.COMPOSE_HTML,ZmSetting.COMPOSE_TEXT],precondition:ZmSetting.HTML_COMPOSE_ENABLED}
);
ZmPref.registerPref("COMPOSE_INIT_FONT_COLOR",{
displayOptions:["rgb(0, 0, 0)"],displayContainer:ZmPref.TYPE_COLOR,precondition:[ZmSetting.HTML_COMPOSE_ENABLED,ZmSetting.NOTEBOOK_ENABLED]}
);
ZmPref.registerPref("COMPOSE_INIT_FONT_FAMILY",{
displayName:ZmMsg.defaultFontSettings,displayContainer:ZmPref.TYPE_SELECT,displayOptions:["Arial","Times New Roman","Courier","Verdana"],options:["Arial","Times New Roman","Courier","Verdana"],precondition:[ZmSetting.HTML_COMPOSE_ENABLED,ZmSetting.NOTEBOOK_ENABLED]}
);
var s=[AjxMessageFormat.format(ZmMsg.pt,"8"),AjxMessageFormat.format(ZmMsg.pt,"10"),AjxMessageFormat.format(ZmMsg.pt,"12"),AjxMessageFormat.format(ZmMsg.pt,"14"),AjxMessageFormat.format(ZmMsg.pt,"18"),AjxMessageFormat.format(ZmMsg.pt,"24"),AjxMessageFormat.format(ZmMsg.pt,"36")];
var h=["8pt","10pt","12pt","14pt","18pt","24pt","36pt"];
ZmPref.registerPref("COMPOSE_INIT_FONT_SIZE",{
displayName:null,displayContainer:ZmPref.TYPE_SELECT,displayOptions:s,options:h,precondition:[ZmSetting.HTML_COMPOSE_ENABLED,ZmSetting.NOTEBOOK_ENABLED]}
);
ZmPref.registerPref("COMPOSE_SAME_FORMAT",{
displayName:ZmMsg.replyForwardInSameFormat,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("CHECKED_ZIMLETS",{
displayName:ZmMsg.zimlets,displayContainer:ZmPref.TYPE_CUSTOM}
);
ZmPref.registerPref("FORWARD_INCLUDE_ORIG",{
displayName:ZmMsg.forwardInclude,displayContainer:ZmPref.TYPE_SELECT,displayOptions:[ZmMsg.includeInBody,ZmMsg.includePrefix,ZmMsg.includePrefixFull,ZmMsg.includeOriginalAsAttach],options:[ZmSetting.INCLUDE,ZmSetting.INCLUDE_PREFIX,ZmSetting.INCLUDE_PREFIX_FULL,ZmSetting.INCLUDE_ATTACH]}
);
ZmPref.registerPref("DEFAULT_TIMEZONE",{
displayName:ZmMsg.selectTimezone,displayContainer:ZmPref.TYPE_SELECT,displayParams:{
cascade:false}
,displayOptions:AjxTimezone.getZonePreferences(),options:AjxTimezone.getZonePreferencesOptions()}
);
ZmPref.registerPref("EXPORT_FOLDER",{
displayContainer:ZmPref.TYPE_CUSTOM}
);
ZmPref.registerPref("EXPORT_BUTTON",{
displayName:ZmMsg._export,displayContainer:ZmPref.TYPE_CUSTOM}
);
ZmPref.registerPref("IMPORT_FOLDER",{
loadFunction:ZmPref.loadCsvFormats,displayContainer:ZmPref.TYPE_CUSTOM}
);
ZmPref.registerPref("IMPORT_BUTTON",{
displayName:ZmMsg._import,displayContainer:ZmPref.TYPE_CUSTOM}
);
ZmPref.registerPref("LOCALE_NAME",{
displayName:ZmMsg.selectLanguage,displayContainer:ZmPref.TYPE_LOCALES,precondition:ZmSetting.LOCALE_CHANGE_ENABLED}
);
var c=AjxMessageFormat.format(ZmMsg.messageReadTime,DwtId._makeId(ZmId.WIDGET_INPUT,ZmId.OP_MARK_READ));
ZmPref.registerPref("MARK_MSG_READ",{
displayName:ZmMsg.messageReadLabel,displayContainer:ZmPref.TYPE_RADIO_GROUP,displayFunction:ZmPref.markMsgReadDisplay,orientation:ZmPref.ORIENT_VERTICAL,displayOptions:[ZmMsg.messageReadNow,c,ZmMsg.messageReadNone],options:[ZmSetting.MARK_READ_NOW,ZmSetting.MARK_READ_TIME,ZmSetting.MARK_READ_NONE],valueFunction:ZmPref.markMsgReadValue}
);
ZmPref.registerPref("NEW_WINDOW_COMPOSE",{
displayName:ZmMsg.composeInNewWin,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:AjxCallback.simpleClosure(ZmPref.requireAllPreConditions,null,ZmSetting.MAIL_ENABLED,ZmSetting.DETACH_COMPOSE_ENABLED)}
);
ZmPref.registerPref("MAIL_MANDATORY_SPELLCHECK",{
displayName:ZmMsg.mandatorySpellcheck,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("PASSWORD",{
displayName:ZmMsg.changePassword,displayContainer:ZmPref.TYPE_PASSWORD,precondition:ZmSetting.CHANGE_PASSWORD_ENABLED}
);
ZmPref.registerPref("SHARING",{
displayContainer:ZmPref.TYPE_CUSTOM}
);
if(appCtxt.isOffline){
ZmPref.registerPref("OFFLINE_IS_MAILTO_HANDLER",{
displayName:ZmMsg.offlineAllowMailTo,displayContainer:ZmPref.TYPE_CHECKBOX}
)
}
var d=[525600];
var o=ZmPref.pollingIntervalDisplay(appCtxt.get(ZmSetting.MIN_POLLING_INTERVAL));
o=(o<1)?1:Math.round(o);
var e=ZmPref.pollingIntervalDisplay(appCtxt.get(ZmSetting.POLLING_INTERVAL));
e=Math.round(e);
while(o<=10){
d.push(o);
o++
}
o=o-1;
var r=d.length;
while(r<10){
o=o+5;
d.push(o);
r++
}
if(e>o){
var t=e%5;
t=(t==0)?e:((e/5+1)*5);
d.push(t)
}else{
o=o+5;
d.push(o)
}
var n=[ZmMsg.pollNever];
while(n.length<=r){
n.push(ZmMsg.pollEveryNMinutes)
}
ZmPref.registerPref("POLLING_INTERVAL",{
displayName:ZmMsg.pollingInterval,displayContainer:ZmPref.TYPE_SELECT,displayOptions:n,options:d,approximateFunction:ZmPref.approximateInterval,displayFunction:ZmPref.pollingIntervalDisplay,valueFunction:ZmPref.pollingIntervalValue,validationFunction:ZmPref.validatePollingInterval}
);
ZmPref.registerPref("REPLY_INCLUDE_ORIG",{
displayName:ZmMsg.replyInclude,displayContainer:ZmPref.TYPE_SELECT,displayOptions:[ZmMsg.dontInclude,ZmMsg.includeInBody,ZmMsg.includePrefix,ZmMsg.includePrefixFull,ZmMsg.includeOriginalAsAttach,ZmMsg.smartInclude],options:[ZmSetting.INCLUDE_NONE,ZmSetting.INCLUDE,ZmSetting.INCLUDE_PREFIX,ZmSetting.INCLUDE_PREFIX_FULL,ZmSetting.INCLUDE_ATTACH,ZmSetting.INCLUDE_SMART]}
);
ZmPref.registerPref("REPLY_PREFIX",{
displayName:ZmMsg.prefix,displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_HORIZONTAL,displayOptions:[">","|"]}
);
ZmPref.registerPref("SAVE_TO_SENT",{
displayName:ZmMsg.saveToSent,displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_VERTICAL,precondition:ZmSetting.MAIL_ENABLED,displayOptions:[ZmMsg.saveToSent,ZmMsg.saveToSentNOT],options:[true,false]}
);
ZmPref.registerPref("SEARCH_INCLUDES_SPAM",{
displayName:ZmMsg.includeJunkFolder,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:AjxCallback.simpleClosure(ZmPref.requireAllPreConditions,null,ZmSetting.MAIL_ENABLED,ZmSetting.SPAM_ENABLED)}
);
ZmPref.registerPref("SEARCH_INCLUDES_TRASH",{
displayName:ZmMsg.includeTrashFolder,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:[ZmSetting.MAIL_ENABLED,ZmSetting.CONTACTS_ENABLED]}
);
ZmPref.registerPref("SHOW_FRAGMENTS",{
displayName:ZmMsg.showFragments,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("OFFLINE_SHOW_GLOBAL_INBOX",{
displayName:ZmMsg.showGlobalInbox,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("SHOW_SEARCH_STRING",{
displayName:ZmMsg.showSearchString,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("SHOW_SELECTION_CHECKBOX",{
displayName:ZmMsg.showSelectionString,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("SKIN_NAME",{
displayName:ZmMsg.selectSkin,displayContainer:ZmPref.TYPE_SELECT,displayOptions:[],options:[],loadFunction:ZmPref.loadSkins,precondition:ZmSetting.SKIN_CHANGE_ENABLED}
);
ZmPref.registerPref("VIEW_AS_HTML",{
displayName:ZmMsg.displayMail,displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_VERTICAL,displayOptions:[ZmMsg.displayAsHTML,ZmMsg.displayAsText],options:[true,false]}
)
};
ZmPreferencesApp.prototype._handleLoadLaunch=function(t){
var e=new AjxCallback(this,this._handleResponseLaunch,[t]);
appCtxt.getSettings().loadPreferenceData(e)
};
ZmPreferencesApp.prototype._handleResponseLaunch=function(e){
AjxDispatcher.run("GetPrefController").show();
if(e){
e.run()
}};
ZmPreferencesApp.prototype._getSharingView=function(){
if(!this._prefController){
return null
}
var a=this.getPrefController();
var t=a&&a.getPrefsView();
var e=t&&t.getView("SHARING");
return(e&&e.view)
};
ZmPreferencesApp.prototype._getOverviewParams=function(){
var e=ZmApp.prototype._getOverviewParams.call(this);
e.omit={};
e.omit[ZmOrganizer.ID_ZIMLET]=true;
return e
}
}
if(AjxPackage.define("zimbraMail.portal.ZmPortalApp")){
ZmPortalApp=function(t,e){
ZmApp.call(this,ZmApp.PORTAL,t,e)
};
ZmPortalApp.prototype=new ZmApp;
ZmPortalApp.prototype.constructor=ZmPortalApp;
ZmPortalApp.prototype.toString=function(){
return"ZmPortalApp"
};
ZmPortalApp.prototype._registerApp=function(){
ZmApp.registerApp(ZmApp.PORTAL,{
nameKey:"portal",icon:"Globe",chooserTooltipKey:"goToPortal",button:ZmAppChooser.B_PORTAL,chooserSort:1,defaultSort:1}
)
};
ZmApp.PORTAL=ZmId.APP_PORTAL;
ZmApp.CLASS[ZmApp.PORTAL]="ZmPortalApp";
ZmApp.SETTING[ZmApp.PORTAL]=ZmSetting.PORTAL_ENABLED;
ZmApp.LOAD_SORT[ZmApp.PORTAL]=1;
ZmApp.QS_ARG[ZmApp.PORTAL]="home";
ZmEvent.S_PORTLET="PORTLET";
ZmItem.PORTLET=ZmEvent.S_PORTLET;
ZmPortalApp.__PORTLET_ID=0;
ZmPortalApp.prototype.refreshPortlets=function(){
var t=this.getPortletMgr();
var e=t.getPortlets();
for(var a in e){
e[a].refresh()
}};
ZmPortalApp.prototype.launch=function(t,a){
var e=new AjxCallback(this,this._handleLoadLaunch,[t,a]);
AjxDispatcher.require("Portal",true,e,null,true)
};
ZmPortalApp.prototype._handleLoadLaunch=function(t,a){
var e=this.getPortalController();
e.show();
ZmApp.prototype.launch.call(this,t,a)
};
ZmPortalApp.prototype.activate=function(t){
var e=this.getPortalController();
e.setPaused(!t);
ZmApp.prototype.activate.call(this,t)
};
ZmPortalApp.prototype.getManifest=function(n){
if(!this._manifest){
var a=appCtxt.get(ZmSetting.PORTAL_NAME);
if(a){
var t=new Date().getTime();
var o={
url:[window.appContextPath,"/portals/",a,"/manifest.xml?v=",t].join(""),callback:n?new AjxCallback(this,this._handleLoadManifest,[n]):null};
var e=AjxLoader.load(o);
if(!n){
this._handleLoadManifest(n,e)
}}}else{
if(n){
n.run(this._manifest)
}}
return this._manifest
};
ZmPortalApp.prototype._handleLoadManifest=function(callback,req){
var e;
if(req.status==200&&req.responseXML){
try{
var json=new AjxJsonSerializer(true).serialize(req.responseXML);
eval("this._manifest = "+json);
var portalDef=this._manifest.portal;
var portletsDef=portalDef&&portalDef.portlets;
if(portletsDef&&!(portletsDef.portlet instanceof Array)){
portletsDef.portlet=[portletsDef.portlet]
}
portalDef.portlets=portletsDef.portlet;
if(portalDef.portlets){
for(var i=0;
i<portalDef.portlets.length;
i++){
var portletDef=portalDef.portlets[i];
var propertyDef=portletDef.property;
if(propertyDef&&!(propertyDef instanceof Array)){
propertyDef=[propertyDef]
}
portletDef.properties=propertyDef;
delete portletDef.property
}}}
catch(e){}}else{
e=""
}
if(!this._manifest){
this._manifest={
error:e}
}
if(callback){
callback.run(this._manifest)
}};
ZmPortalApp.prototype.getPortalController=function(){
AjxDispatcher.require("Portal");
if(!this._portalController){
this._portalController=new ZmPortalController(this._container,this)
}
return this._portalController
};
ZmPortalApp.prototype.getPortletMgr=function(){
AjxDispatcher.require("Portal");
if(!this._portletMgr){
this._portletMgr=new ZmPortletMgr()
}
return this._portletMgr
};
ZmPortalApp.prototype._getOverviewTrees=function(){
return this._getOverviewApp()._getOverviewTrees()
};
ZmPortalApp.prototype._getOverviewApp=function(){
if(!this._overviewApp){
var o=[];
for(var t in ZmApp.CHOOSER_SORT){
o.push({
name:t,sort:ZmApp.CHOOSER_SORT[t]}
)
}
o.sort(ZmPortalApp.__BY_SORT);
var e=null;
for(var a=0;
a<o.length;
a++){
var n=o[a];
if(n.name==this._name){
continue
}
if(appCtxt.getApp(n.name).isUpsell){
continue
}
e=n.name;
break
}
this._overviewApp=appCtxt.getApp(e)
}
return this._overviewApp
};
ZmPortalApp.__BY_SORT=function(t,e){
return t.sort-e.sort
}
}
if(AjxPackage.define("zimbraMail.mail.ZmMailApp")){
ZmMailApp=function(t,e){
ZmApp.call(this,ZmApp.MAIL,t,e);
this._sessionController={};
this._sessionId={};
this._curSessionId={};
this._dataSourceCollection={};
this._identityCollection={};
this._signatureCollection={};
this._groupBy={};
this.numEntries=0;
this._addSettingsChangeListeners()
};
ZmEvent.S_CONV=ZmId.ITEM_CONV;
ZmEvent.S_MSG=ZmId.ITEM_MSG;
ZmEvent.S_ATT=ZmId.ITEM_ATT;
ZmEvent.S_FOLDER=ZmId.ORG_FOLDER;
ZmEvent.S_DATA_SOURCE=ZmId.ITEM_DATA_SOURCE;
ZmEvent.S_IDENTITY="IDENTITY";
ZmEvent.S_SIGNATURE="SIGNATURE";
ZmItem.CONV=ZmEvent.S_CONV;
ZmItem.MSG=ZmEvent.S_MSG;
ZmItem.ATT=ZmEvent.S_ATT;
ZmItem.DATA_SOURCE=ZmEvent.S_DATA_SOURCE;
ZmOrganizer.FOLDER=ZmEvent.S_FOLDER;
ZmApp.MAIL=ZmId.APP_MAIL;
ZmApp.CLASS[ZmApp.MAIL]="ZmMailApp";
ZmApp.SETTING[ZmApp.MAIL]=ZmSetting.MAIL_ENABLED;
ZmApp.UPSELL_SETTING[ZmApp.MAIL]=ZmSetting.MAIL_UPSELL_ENABLED;
ZmApp.LOAD_SORT[ZmApp.MAIL]=20;
ZmApp.QS_ARG[ZmApp.MAIL]="mail";
ZmMailApp.DEFAULT_AUTO_SAVE_DRAFT_INTERVAL=30;
ZmMailApp.DEFAULT_MAX_MESSAGE_SIZE=100000;
ZmMailApp.POP_DOWNLOAD_SINCE_ALL=0;
ZmMailApp.POP_DOWNLOAD_SINCE_NO_CHANGE=1;
ZmMailApp.POP_DOWNLOAD_SINCE_FROM_NOW=2;
ZmMailApp.SEND_RECEIPT_NEVER="never";
ZmMailApp.SEND_RECEIPT_ALWAYS="always";
ZmMailApp.SEND_RECEIPT_PROMPT="prompt";
ZmMailApp.prototype=new ZmApp;
ZmMailApp.prototype.constructor=ZmMailApp;
ZmMailApp._setGroupByMaps=function(){
ZmMailApp.GROUP_MAIL_BY_ITEM={};
ZmMailApp.GROUP_MAIL_BY_ITEM[ZmSetting.GROUP_BY_CONV]=ZmItem.CONV;
ZmMailApp.GROUP_MAIL_BY_ITEM[ZmSetting.GROUP_BY_MESSAGE]=ZmItem.MSG
};
ZmMailApp.prototype.toString=function(){
return"ZmMailApp"
};
ZmMailApp.prototype._defineAPI=function(){
AjxDispatcher.setPackageLoadFunction("MailCore",new AjxCallback(this,this._postLoadCore));
AjxDispatcher.setPackageLoadFunction("Mail",new AjxCallback(this,this._postLoad));
AjxDispatcher.registerMethod("Compose",["MailCore","Mail"],new AjxCallback(this,this.compose));
AjxDispatcher.registerMethod("GetComposeController",["MailCore","Mail"],new AjxCallback(this,this.getComposeController));
AjxDispatcher.registerMethod("GetConvController",["MailCore","Mail"],new AjxCallback(this,this.getConvController));
AjxDispatcher.registerMethod("GetConvListController","MailCore",new AjxCallback(this,this.getConvListController));
AjxDispatcher.registerMethod("GetMsgController",["MailCore","Mail"],new AjxCallback(this,this.getMsgController));
AjxDispatcher.registerMethod("GetTradController","MailCore",new AjxCallback(this,this.getTradController));
AjxDispatcher.registerMethod("GetMailListController","MailCore",new AjxCallback(this,this.getMailListController));
AjxDispatcher.registerMethod("GetIdentityCollection","MailCore",new AjxCallback(this,this.getIdentityCollection));
AjxDispatcher.registerMethod("GetSignatureCollection","MailCore",new AjxCallback(this,this.getSignatureCollection));
AjxDispatcher.registerMethod("GetDataSourceCollection","MailCore",new AjxCallback(this,this.getDataSourceCollection));
AjxDispatcher.registerMethod("GetAttachmentsController",["MailCore","Mail"],new AjxCallback(this,this.getAttachmentsController));
AjxDispatcher.registerMethod("GetMailConfirmController",["MailCore","Mail"],new AjxCallback(this,this.getConfirmController))
};
ZmMailApp.prototype._registerSettings=function(e){
var e=e||appCtxt.getSettings();
e.registerSetting("ALLOW_ANY_FROM_ADDRESS",{
name:"zimbraAllowAnyFromAddress",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("ALLOW_FROM_ADDRESSES",{
name:"zimbraAllowFromAddress",type:ZmSetting.T_COS,dataType:ZmSetting.D_LIST}
);
e.registerSetting("AUTO_SAVE_DRAFT_INTERVAL",{
name:"zimbraPrefAutoSaveDraftInterval",type:ZmSetting.T_PREF,dataType:ZmSetting.D_LDAP_TIME,defaultValue:ZmMailApp.DEFAULT_AUTO_SAVE_DRAFT_INTERVAL}
);
e.registerSetting("COMPOSE_SAME_FORMAT",{
name:"zimbraPrefForwardReplyInOriginalFormat",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("CONVERSATIONS_ENABLED",{
name:"zimbraFeatureConversationsEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("CONVERSATION_ORDER",{
name:"zimbraPrefConversationOrder",type:ZmSetting.T_PREF,defaultValue:ZmSearch.DATE_DESC,isImplicit:true}
);
e.registerSetting("DEDUPE_MSG_TO_SELF",{
name:"zimbraPrefDedupeMessagesSentToSelf",type:ZmSetting.T_PREF,defaultValue:ZmSetting.DEDUPE_NONE}
);
e.registerSetting("DEFAULT_DISPLAY_NAME",{
type:ZmSetting.T_PSEUDO,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("DETACH_COMPOSE_ENABLED",{
name:"zimbraFeatureComposeInNewWindowEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("DETACH_MAILVIEW_ENABLED",{
name:"zimbraFeatureOpenMailInNewWindowEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("DISPLAY_EXTERNAL_IMAGES",{
name:"zimbraPrefDisplayExternalImages",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("END_DATE_ENABLED",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("FILTERS_ENABLED",{
name:"zimbraFeatureFiltersEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("FILTERS_MAIL_FORWARDING_ENABLED",{
name:"zimbraFeatureMailForwardingInFiltersEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("FORWARD_INCLUDE_ORIG",{
name:"zimbraPrefForwardIncludeOriginalText",type:ZmSetting.T_PREF,defaultValue:ZmSetting.INCLUDE}
);
e.registerSetting("FORWARD_MENU_ENABLED",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("GET_MAIL_ACTION",{
name:"zimbraPrefGetMailAction",type:ZmSetting.T_PREF,defaultValue:ZmSetting.GETMAIL_ACTION_DEFAULT,isGlobal:true}
);
e.registerSetting("GROUP_MAIL_BY",{
name:"zimbraPrefGroupMailBy",type:ZmSetting.T_PREF,defaultValue:ZmSetting.GROUP_BY_MESSAGE,isImplicit:true}
);
e.registerSetting("HTML_SIGNATURE_ENABLED",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("IDENTITIES_ENABLED",{
name:"zimbraFeatureIdentitiesEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("INITIAL_SEARCH",{
name:"zimbraPrefMailInitialSearch",type:ZmSetting.T_PREF,defaultValue:"in:inbox"}
);
e.registerSetting("INITIAL_SEARCH_ENABLED",{
name:"zimbraFeatureInitialSearchPreferenceEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("MAIL_ALIASES",{
name:"zimbraMailAlias",type:ZmSetting.T_COS,dataType:ZmSetting.D_LIST}
);
e.registerSetting("MAIL_ATTACH_VIEW_ENABLED",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("MAIL_BLACKLIST",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_LIST}
);
e.registerSetting("MAIL_BLACKLIST_MAX_NUM_ENTRIES",{
name:"zimbraMailBlacklistMaxNumEntries",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:100}
);
e.registerSetting("MAIL_FOLDER_COLORS_ENABLED",{
name:"zimbraPrefFolderColorEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("MAIL_FORWARDING_ADDRESS",{
name:"zimbraPrefMailForwardingAddress",type:ZmSetting.T_PREF}
);
e.registerSetting("MAIL_FORWARDING_ENABLED",{
name:"zimbraFeatureMailForwardingEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("MAIL_MANDATORY_SPELLCHECK",{
name:"zimbraPrefMandatorySpellCheckEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("MAIL_FROM_ADDRESS",{
name:"zimbraPrefFromAddress",type:ZmSetting.T_PREF,dataType:ZmSetting.D_LIST}
);
e.registerSetting("MAIL_LIFETIME_GLOBAL",{
name:"zimbraMailMessageLifetime",type:ZmSetting.T_COS,defaultValue:"0"}
);
e.registerSetting("MAIL_LIFETIME_INBOX_READ",{
name:"zimbraPrefInboxReadLifetime",type:ZmSetting.T_PREF,defaultValue:"0"}
);
e.registerSetting("MAIL_LIFETIME_INBOX_UNREAD",{
name:"zimbraPrefInboxUnreadLifetime",type:ZmSetting.T_PREF,defaultValue:"0"}
);
e.registerSetting("MAIL_LIFETIME_JUNK",{
name:"zimbraPrefJunkLifetime",type:ZmSetting.T_PREF,defaultValue:"0"}
);
e.registerSetting("MAIL_LIFETIME_JUNK_GLOBAL",{
name:"zimbraMailSpamLifetime",type:ZmSetting.T_COS,defaultValue:"0"}
);
e.registerSetting("MAIL_LIFETIME_SENT",{
name:"zimbraPrefSentLifetime",type:ZmSetting.T_PREF,defaultValue:"0"}
);
e.registerSetting("MAIL_LIFETIME_TRASH",{
name:"zimbraPrefTrashLifetime",type:ZmSetting.T_PREF,defaultValue:"0"}
);
e.registerSetting("MAIL_LIFETIME_TRASH_GLOBAL",{
name:"zimbraMailTrashLifetime",type:ZmSetting.T_COS,defaultValue:"0"}
);
e.registerSetting("MAIL_LOCAL_DELIVERY_DISABLED",{
name:"zimbraPrefMailLocalDeliveryDisabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("MAIL_NOTIFY_SOUNDS",{
name:"zimbraPrefMailSoundsEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true}
);
e.registerSetting("MAIL_NOTIFY_APP",{
name:"zimbraPrefMailFlashIcon",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true}
);
e.registerSetting("MAIL_NOTIFY_BROWSER",{
name:"zimbraPrefMailFlashTitle",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true}
);
e.registerSetting("MAIL_NOTIFY_TOASTER",{
name:"zimbraPrefMailToasterEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true}
);
e.registerSetting("MAIL_PRIORITY_ENABLED",{
name:"zimbraFeatureMailPriorityEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("MAIL_READ_RECEIPT_ENABLED",{
name:"zimbraFeatureReadReceiptsEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("MAIL_SEND_READ_RECEIPTS",{
name:"zimbraPrefMailSendReadReceipts",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:"never"}
);
e.registerSetting("MAIL_WHITELIST",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_LIST}
);
e.registerSetting("MAIL_WHITELIST_MAX_NUM_ENTRIES",{
name:"zimbraMailWhitelistMaxNumEntries",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:100}
);
e.registerSetting("MARK_MSG_READ",{
name:"zimbraPrefMarkMsgRead",type:ZmSetting.T_PREF,dataType:ZmSetting.D_INT,defaultValue:0}
);
e.registerSetting("MAX_MESSAGE_SIZE",{
type:ZmSetting.T_PREF,defaultValue:ZmMailApp.DEFAULT_MAX_MESSAGE_SIZE}
);
e.registerSetting("NEW_WINDOW_COMPOSE",{
name:"zimbraPrefComposeInNewWindow",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("NOTIF_ADDRESS",{
name:"zimbraPrefNewMailNotificationAddress",type:ZmSetting.T_PREF}
);
e.registerSetting("NOTIF_ENABLED",{
name:"zimbraPrefNewMailNotificationEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("NOTIF_FEATURE_ENABLED",{
name:"zimbraFeatureNewMailNotificationEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("OPEN_MAIL_IN_NEW_WIN",{
name:"zimbraPrefOpenMailInNewWindow",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true}
);
e.registerSetting("POP_ENABLED",{
name:"zimbraPop3Enabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:!appCtxt.isOffline}
);
e.registerSetting("POP_DOWNLOAD_SINCE_VALUE",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:""}
);
e.registerSetting("POP_DOWNLOAD_SINCE",{
name:"zimbraPrefPop3DownloadSince",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:""}
);
e.registerSetting("READING_PANE_LOCATION",{
name:"zimbraPrefReadingPaneLocation",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:ZmSetting.RP_BOTTOM,isImplicit:true,isGlobal:true}
);
e.registerSetting("READING_PANE_LOCATION_CV",{
name:"zimbraPrefConvReadingPaneLocation",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:ZmSetting.RP_BOTTOM,isImplicit:true}
);
e.registerSetting("REPLY_INCLUDE_ORIG",{
name:"zimbraPrefReplyIncludeOriginalText",type:ZmSetting.T_PREF,defaultValue:ZmSetting.INCLUDE}
);
e.registerSetting("REPLY_MENU_ENABLED",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("REPLY_PREFIX",{
name:"zimbraPrefForwardReplyPrefixChar",type:ZmSetting.T_PREF,defaultValue:">"}
);
e.registerSetting("REPLY_TO_ADDRESS",{
name:"zimbraPrefReplyToAddress",type:ZmSetting.T_PREF,dataType:ZmSetting.D_LIST}
);
e.registerSetting("REPLY_TO_ENABLED",{
name:"zimbraPrefReplyToEnabled",type:ZmSetting.T_PREF}
);
e.registerSetting("SAVE_DRAFT_ENABLED",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("SAVE_TO_SENT",{
name:"zimbraPrefSaveToSent",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("SELECT_AFTER_DELETE",{
name:"zimbraPrefMailSelectAfterDelete",type:ZmSetting.T_PREF,defaultValue:ZmSetting.DELETE_SELECT_NEXT}
);
e.registerSetting("SEND_ON_BEHALF_OF",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("SENT_FOLDER_NAME",{
name:"zimbraPrefSentMailFolder",type:ZmSetting.T_PREF,defaultValue:"sent"}
);
e.registerSetting("SHOW_BCC",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("SHOW_FRAGMENTS",{
name:"zimbraPrefShowFragments",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isGlobal:true}
);
e.registerSetting("SHOW_MAIL_CONFIRM",{
name:"zimbraFeatureConfirmationPageEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("SIGNATURE",{
name:"zimbraPrefMailSignature",type:ZmSetting.T_PREF}
);
e.registerSetting("SIGNATURE_ENABLED",{
name:"zimbraPrefMailSignatureEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("SIGNATURE_STYLE",{
name:"zimbraPrefMailSignatureStyle",type:ZmSetting.T_PREF,defaultValue:ZmSetting.SIG_OUTLOOK}
);
e.registerSetting("SPAM_ENABLED",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("START_DATE_ENABLED",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("USER_FOLDERS_ENABLED",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("VACATION_FROM",{
name:"zimbraPrefOutOfOfficeFromDate",type:ZmSetting.T_PREF,defaultValue:""}
);
e.registerSetting("VACATION_MSG",{
name:"zimbraPrefOutOfOfficeReply",type:ZmSetting.T_PREF,defaultValue:""}
);
e.registerSetting("VACATION_MSG_ENABLED",{
name:"zimbraPrefOutOfOfficeReplyEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("VACATION_MSG_FEATURE_ENABLED",{
name:"zimbraFeatureOutOfOfficeReplyEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("VACATION_UNTIL",{
name:"zimbraPrefOutOfOfficeUntilDate",type:ZmSetting.T_PREF,defaultValue:""}
);
e.registerSetting("COLLAPSE_IMAP_TREES",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("SAVE_TO_IMAP_SENT",{
type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
ZmMailApp._setGroupByMaps()
};
ZmMailApp.prototype._registerPrefs=function(){
var t={
MAIL:{
title:ZmMsg.mail,icon:"MailApp",templateId:"prefs.Pages#Mail",priority:10,precondition:appCtxt.get(ZmSetting.MAIL_ENABLED),prefs:[ZmSetting.DEDUPE_MSG_TO_SELF,ZmSetting.DISPLAY_EXTERNAL_IMAGES,ZmSetting.GET_MAIL_ACTION,ZmSetting.INITIAL_SEARCH,ZmSetting.MAIL_BLACKLIST,ZmSetting.MAIL_FORWARDING_ADDRESS,ZmSetting.MAIL_LIFETIME_INBOX_READ,ZmSetting.MAIL_LIFETIME_INBOX_UNREAD,ZmSetting.MAIL_LIFETIME_JUNK,ZmSetting.MAIL_LIFETIME_SENT,ZmSetting.MAIL_LIFETIME_TRASH,ZmSetting.MAIL_LOCAL_DELIVERY_DISABLED,ZmSetting.MAIL_NOTIFY_SOUNDS,ZmSetting.MAIL_NOTIFY_APP,ZmSetting.MAIL_NOTIFY_BROWSER,ZmSetting.MAIL_NOTIFY_TOASTER,ZmSetting.MAIL_WHITELIST,ZmSetting.MAIL_SEND_READ_RECEIPTS,ZmSetting.MARK_MSG_READ,ZmSetting.NOTIF_ADDRESS,ZmSetting.NOTIF_ENABLED,ZmSetting.OPEN_MAIL_IN_NEW_WIN,ZmSetting.PAGE_SIZE,ZmSetting.POP_DOWNLOAD_SINCE_VALUE,ZmSetting.POP_DOWNLOAD_SINCE,ZmSetting.POLLING_INTERVAL,ZmSetting.SHOW_FRAGMENTS,ZmSetting.VACATION_MSG_ENABLED,ZmSetting.VACATION_MSG,ZmSetting.SELECT_AFTER_DELETE,ZmSetting.START_DATE_ENABLED,ZmSetting.END_DATE_ENABLED,ZmSetting.VACATION_FROM,ZmSetting.VACATION_UNTIL,ZmSetting.VIEW_AS_HTML],manageDirty:true,createView:function(o,n,a){
AjxDispatcher.require("Alert");
return new ZmMailPrefsPage(o,n,a)
}}
,ACCOUNTS:{
parentId:"MAIL",icon:"POPAccount",title:(appCtxt.isOffline?ZmMsg.personas:ZmMsg.accounts),templateId:"prefs.Pages#Accounts",priority:60,precondition:appCtxt.get(ZmSetting.MAIL_ENABLED),prefs:[ZmSetting.ACCOUNTS],manageDirty:true,createView:function(o,n,a){
return new ZmAccountsPage(o,n,a)
}}
,SIGNATURES:{
parentId:"MAIL",icon:"AddSignature",title:ZmMsg.signatures,templateId:"prefs.Pages#Signatures",priority:30,precondition:(appCtxt.get(ZmSetting.MAIL_ENABLED)&&appCtxt.get(ZmSetting.SIGNATURES_ENABLED)),prefs:[ZmSetting.SIGNATURES,ZmSetting.SIGNATURE_STYLE,ZmSetting.SIGNATURE_ENABLED],manageDirty:true,createView:function(o,n,a){
return new ZmSignaturesPage(o,n,a)
}}
,FILTERS:{
parentId:"MAIL",icon:"MailRule",title:ZmMsg.filterRules,templateId:"prefs.Pages#MailFilters",priority:70,precondition:(appCtxt.get(ZmSetting.MAIL_ENABLED)&&appCtxt.get(ZmSetting.FILTERS_ENABLED)),prefs:[ZmSetting.FILTERS],manageChanges:true,createView:function(o,n,a){
return a.getFilterRulesController().getFilterRulesView()
}}};
for(var e in t){
ZmPref.registerPrefSection(e,t[e])
}
ZmPref.registerPref("ACCOUNTS",{
displayContainer:ZmPref.TYPE_CUSTOM}
);
ZmPref.registerPref("AUTO_SAVE_DRAFT_INTERVAL",{
displayName:ZmMsg.autoSaveDrafts,displayContainer:ZmPref.TYPE_CHECKBOX,options:[0,ZmMailApp.DEFAULT_AUTO_SAVE_DRAFT_INTERVAL]}
);
ZmPref.registerPref("DEDUPE_MSG_TO_SELF",{
displayName:ZmMsg.removeDupesToSelf,displayContainer:ZmPref.TYPE_RADIO_GROUP,displayOptions:[ZmMsg.dedupeNone,ZmMsg.dedupeSecondCopy,ZmMsg.dedupeAll],options:[ZmSetting.DEDUPE_NONE,ZmSetting.DEDUPE_SECOND,ZmSetting.DEDUPE_ALL]}
);
ZmPref.registerPref("DISPLAY_EXTERNAL_IMAGES",{
displayName:ZmMsg.showExternalImages,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("END_DATE_ENABLED",{
displayName:ZmMsg.endOn,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:ZmSetting.VACATION_MSG_FEATURE_ENABLED}
);
ZmPref.registerPref("GET_MAIL_ACTION",{
displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_VERTICAL,displayOptions:[ZmMsg.checkMailPrefDefault,ZmMsg.checkMailPrefUpdate],options:[ZmSetting.GETMAIL_ACTION_DEFAULT,ZmSetting.GETMAIL_ACTION_UPDATE]}
);
ZmPref.registerPref("INITIAL_SEARCH",{
displayName:ZmMsg.initialMailSearch,displayContainer:ZmPref.TYPE_INPUT,maxLength:ZmPref.MAX_LENGTH[ZmSetting.INITIAL_SEARCH],errorMessage:AjxMessageFormat.format(ZmMsg.invalidInitialSearch,ZmPref.MAX_LENGTH[ZmSetting.INITIAL_SEARCH]),precondition:ZmSetting.INITIAL_SEARCH_ENABLED}
);
ZmPref.registerPref("MAIL_BLACKLIST",{
displayContainer:ZmPref.TYPE_CUSTOM}
);
ZmPref.registerPref("MAIL_FORWARDING_ADDRESS",{
displayName:ZmMsg.mailForwardingAddress,displayContainer:ZmPref.TYPE_INPUT,validationFunction:ZmMailApp.validateForwardEmail,errorMessage:ZmMsg.invalidEmail,precondition:ZmSetting.MAIL_FORWARDING_ENABLED}
);
ZmPref.registerPref("MAIL_LIFETIME_INBOX_READ",{
displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_HORIZONTAL,displayOptions:[ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationNever],options:[30,45,60,90,120,0],approximateFunction:ZmPref.approximateLifetimeInboxRead,displayFunction:ZmPref.durationDay2Int,valueFunction:ZmPref.int2DurationDay,validationFunction:ZmPref.validateLifetime}
);
ZmPref.registerPref("MAIL_LIFETIME_INBOX_UNREAD",{
displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_HORIZONTAL,displayOptions:[ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationNever],options:[30,45,60,90,120,0],approximateFunction:ZmPref.approximateLifetimeInboxUnread,displayFunction:ZmPref.durationDay2Int,valueFunction:ZmPref.int2DurationDay,validationFunction:ZmPref.validateLifetime}
);
ZmPref.registerPref("MAIL_LIFETIME_JUNK",{
displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_HORIZONTAL,displayOptions:ZmMsg.lifetimeDurationDays,options:[1,3,7,30],approximateFunction:ZmPref.approximateLifetimeJunk,displayFunction:ZmPref.durationDay2Int,valueFunction:ZmPref.int2DurationDay,validationFunction:ZmPref.validateLifetimeJunk}
);
ZmPref.registerPref("MAIL_LIFETIME_SENT",{
displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_HORIZONTAL,displayOptions:[ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationDays,ZmMsg.lifetimeDurationNever],options:[30,45,60,90,120,0],approximateFunction:ZmPref.approximateLifetimeSent,displayFunction:ZmPref.durationDay2Int,valueFunction:ZmPref.int2DurationDay,validationFunction:ZmPref.validateLifetime}
);
ZmPref.registerPref("MAIL_LIFETIME_TRASH",{
displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_HORIZONTAL,displayOptions:ZmMsg.lifetimeDurationDays,options:[1,3,7,30],approximateFunction:ZmPref.approximateLifetimeTrash,displayFunction:ZmPref.durationDay2Int,valueFunction:ZmPref.int2DurationDay,validationFunction:ZmPref.validateLifetimeTrash}
);
ZmPref.registerPref("MAIL_LOCAL_DELIVERY_DISABLED",{
displayName:ZmMsg.mailDeliveryDisabled,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:ZmSetting.MAIL_FORWARDING_ENABLED,validationFunction:ZmMailApp.validateMailLocalDeliveryDisabled,errorMessage:ZmMsg.errorMissingFwdAddr}
);
ZmPref.registerPref("MAIL_NOTIFY_SOUNDS",{
displayName:ZmMsg.playSound,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("MAIL_NOTIFY_APP",{
displayName:ZmMsg.flashMailAppTab,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("MAIL_NOTIFY_BROWSER",{
displayName:ZmMsg.flashBrowser,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("MAIL_SEND_READ_RECEIPTS",{
displayContainer:ZmPref.TYPE_RADIO_GROUP,displayOptions:[ZmMsg.readReceiptNever,ZmMsg.readReceiptAlways,ZmMsg.readReceiptAsk],options:[ZmMailApp.SEND_RECEIPT_NEVER,ZmMailApp.SEND_RECEIPT_ALWAYS,ZmMailApp.SEND_RECEIPT_PROMPT],precondition:ZmSetting.MAIL_READ_RECEIPT_ENABLED}
);
ZmPref.registerPref("MAIL_WHITELIST",{
displayContainer:ZmPref.TYPE_CUSTOM}
);
ZmPref.registerPref("NOTIF_ADDRESS",{
displayName:ZmMsg.mailNotifAddress,displayContainer:ZmPref.TYPE_INPUT,validationFunction:ZmPref.validateEmail,errorMessage:ZmMsg.invalidEmail,precondition:ZmSetting.NOTIF_FEATURE_ENABLED}
);
ZmPref.registerPref("NOTIF_ENABLED",{
displayName:ZmMsg.mailNotifEnabled,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:ZmSetting.NOTIF_FEATURE_ENABLED,validationFunction:ZmMailApp.validateSendNotification,errorMessage:ZmMsg.errorMissingNotifyAddr}
);
ZmPref.registerPref("OPEN_MAIL_IN_NEW_WIN",{
displayName:ZmMsg.openMailNewWin,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:ZmSetting.DETACH_MAILVIEW_ENABLED}
);
ZmPref.registerPref("POP_DOWNLOAD_SINCE_VALUE",{
displayContainer:ZmPref.TYPE_STATIC,precondition:ZmSetting.POP_ENABLED}
);
ZmPref.registerPref("POP_DOWNLOAD_SINCE",{
displayContainer:ZmPref.TYPE_RADIO_GROUP,displayOptions:[ZmMsg.externalAccessPopDownloadAll,"*** NOT SHOWN ***",ZmMsg.externalAccessPopDownloadFromNow],options:[ZmMailApp.POP_DOWNLOAD_SINCE_ALL,ZmMailApp.POP_DOWNLOAD_SINCE_NO_CHANGE,ZmMailApp.POP_DOWNLOAD_SINCE_FROM_NOW],displayFunction:ZmPref.downloadSinceDisplay,valueFunction:ZmPref.downloadSinceValue,precondition:ZmSetting.POP_ENABLED}
);
ZmPref.registerPref("REPLY_TO_ADDRESS",{
displayName:ZmMsg.replyToAddress,displayContainer:ZmPref.TYPE_INPUT,validationFunction:ZmPref.validateEmail,errorMessage:ZmMsg.invalidEmail}
);
ZmPref.registerPref("SELECT_AFTER_DELETE",{
displayName:ZmMsg.clientType,displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_VERTICAL,displayOptions:[ZmMsg.selectNext,ZmMsg.selectPrevious,ZmMsg.selectAdapt],options:[ZmSetting.DELETE_SELECT_NEXT,ZmSetting.DELETE_SELECT_PREV,ZmSetting.DELETE_SELECT_ADAPT]}
);
ZmPref.registerPref("SIGNATURE",{
displayName:ZmMsg.signature,displayContainer:ZmPref.TYPE_TEXTAREA,maxLength:ZmPref.MAX_LENGTH[ZmSetting.SIGNATURE],errorMessage:AjxMessageFormat.format(ZmMsg.invalidSignature,ZmPref.MAX_LENGTH[ZmSetting.SIGNATURE])}
);
ZmPref.registerPref("SIGNATURE_ENABLED",{
displayName:ZmMsg.signatureEnabled,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("SIGNATURE_STYLE",{
displayName:ZmMsg.signatureStyle,displayContainer:ZmPref.TYPE_RADIO_GROUP,orientation:ZmPref.ORIENT_HORIZONTAL,displayOptions:[ZmMsg.aboveQuotedText,ZmMsg.atBottomOfMessage],options:[ZmSetting.SIG_OUTLOOK,ZmSetting.SIG_INTERNET]}
);
ZmPref.registerPref("SIGNATURES",{
displayContainer:ZmPref.TYPE_CUSTOM}
);
ZmPref.registerPref("START_DATE_ENABLED",{
displayContainer:ZmPref.TYPE_CHECKBOX,displayName:ZmMsg.startOn,precondition:ZmSetting.VACATION_MSG_FEATURE_ENABLED}
);
ZmPref.registerPref("VACATION_FROM",{
displayName:ZmMsg.startDate,displayContainer:ZmPref.TYPE_INPUT,precondition:ZmSetting.VACATION_MSG_FEATURE_ENABLED,displayFunction:ZmPref.dateGMT2Local,valueFunction:ZmPref.dateLocal2GMT}
);
ZmPref.registerPref("VACATION_UNTIL",{
displayName:ZmMsg.endDate,displayContainer:ZmPref.TYPE_INPUT,precondition:ZmSetting.VACATION_MSG_FEATURE_ENABLED,displayFunction:ZmPref.dateGMT2Local,valueFunction:ZmPref.dateLocal2GMT}
);
ZmPref.registerPref("VACATION_MSG",{
displayName:ZmMsg.awayMessage,displayContainer:ZmPref.TYPE_TEXTAREA,maxLength:ZmPref.MAX_LENGTH[ZmSetting.AWAY_MESSAGE],errorMessage:AjxMessageFormat.format(ZmMsg.invalidAwayMessage,ZmPref.MAX_LENGTH[ZmSetting.AWAY_MESSAGE]),precondition:ZmSetting.VACATION_MSG_FEATURE_ENABLED,validationFunction:ZmMailApp.validateVacationMsg}
);
ZmPref.registerPref("VACATION_MSG_ENABLED",{
displayName:ZmMsg.awayMessageEnabled,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:ZmSetting.VACATION_MSG_FEATURE_ENABLED,validationFunction:ZmMailApp.validateVacationMsgEnabled,errorMessage:ZmMsg.missingAwayMessage}
);
ZmPref.registerPref("MAIL_NOTIFY_TOASTER",{
displayFunc:function(){
AjxDispatcher.require("Alert");
return ZmDesktopAlert.getInstance().getDisplayText()
}
,displayContainer:ZmPref.TYPE_CHECKBOX}
)
};
ZmMailApp.validateForwardEmail=function(t){
if(!t||t==""){
var o=ZmPref.getPrefSectionWithPref(ZmSetting.MAIL_FORWARDING_ADDRESS);
if(!o){
return false
}
var e=appCtxt.getApp(ZmApp.PREFERENCES).getPrefController().getPrefsView();
var a=e.getView(o.id).getFormObject(ZmSetting.MAIL_LOCAL_DELIVERY_DISABLED);
if(a&&a.isSelected()){
a.setSelected(false)
}}
return ZmPref.validateEmail(t)
};
ZmMailApp.validateMailLocalDeliveryDisabled=function(a){
if(!a){
return true
}
var o=ZmPref.getPrefSectionWithPref(ZmSetting.MAIL_FORWARDING_ADDRESS);
if(!o){
return false
}
var e=appCtxt.getApp(ZmApp.PREFERENCES).getPrefController().getPrefsView();
var t=e.getView(o.id).getFormObject(ZmSetting.MAIL_FORWARDING_ADDRESS);
return(t!=null&&t.isValid())
};
ZmMailApp.validateSendNotification=function(a){
if(!a){
return true
}
var o=ZmPref.getPrefSectionWithPref(ZmSetting.NOTIF_ADDRESS);
if(!o){
return false
}
var e=appCtxt.getApp(ZmApp.PREFERENCES).getPrefController().getPrefsView();
var t=e.getView(o.id).getFormObject(ZmSetting.NOTIF_ADDRESS);
return(t!=null&&t.isValid())
};
ZmMailApp.validateVacationMsg=function(a){
if(a&&(a.length>0)){
return true
}
var o=ZmPref.getPrefSectionWithPref(ZmSetting.VACATION_MSG_ENABLED);
if(!o){
return false
}
var e=appCtxt.getApp(ZmApp.PREFERENCES).getPrefController().getPrefsView();
var t=e.getView(o.id).getFormObject(ZmSetting.VACATION_MSG_ENABLED);
return(t&&!t.isSelected())
};
ZmMailApp.validateVacationMsgEnabled=function(a){
if(!a){
return true
}
var n=ZmPref.getPrefSectionWithPref(ZmSetting.VACATION_MSG);
if(!n){
return false
}
var e=appCtxt.getApp(ZmApp.PREFERENCES).getPrefController().getPrefsView();
var t=e.getView(n.id).getFormObject(ZmSetting.VACATION_MSG);
if(!t){
return false
}
var o=t.getValue();
return(o&&(o.length>0))
};
ZmMailApp.prototype._registerOperations=function(){
ZmOperation.registerOp(ZmId.OP_ADD_FILTER_RULE,{
textKey:"newFilter",image:"Plus"}
,ZmSetting.FILTERS_ENABLED);
ZmOperation.registerOp(ZmId.OP_ADD_SIGNATURE,{
textKey:"signature",image:"AddSignature",tooltipKey:"chooseSignature"}
,ZmSetting.SIGNATURES_ENABLED);
ZmOperation.registerOp(ZmId.OP_CHECK_MAIL,{
textKey:"checkMail",tooltipKey:"checkMailPrefDefault",image:"Refresh",textPrecedence:90}
);
ZmOperation.registerOp(ZmId.OP_CHECK_MAIL_DEFAULT,{
textKey:"checkMailDefault"}
);
ZmOperation.registerOp(ZmId.OP_CHECK_MAIL_UPDATE,{
textKey:"checkMailUpdate"}
);
ZmOperation.registerOp(ZmId.OP_COMPOSE_OPTIONS,{
textKey:"options",image:"Preferences"}
);
ZmOperation.registerOp(ZmId.OP_CREATE_APPT,{
textKey:"createAppt",image:"NewAppointment"}
,ZmSetting.CALENDAR_ENABLED);
ZmOperation.registerOp(ZmId.OP_CREATE_TASK,{
textKey:"createTask",image:"NewTask"}
,ZmSetting.TASKS_ENABLED);
ZmOperation.registerOp(ZmId.OP_DELETE_CONV,{
textKey:"delConv",image:"DeleteConversation"}
,ZmSetting.CONVERSATIONS_ENABLED);
ZmOperation.registerOp(ZmId.OP_DELETE_MSG,{
textKey:"delMsg",image:"DeleteMessage"}
);
ZmOperation.registerOp(ZmId.OP_DELETE_MENU,{
tooltipKey:"deleteTooltip",image:"Delete"}
);
ZmOperation.registerOp(ZmId.OP_DETACH_COMPOSE,{
tooltipKey:"detachTooltip",image:"OpenInNewWindow"}
);
ZmOperation.registerOp(ZmId.OP_DRAFT,null,ZmSetting.SAVE_DRAFT_ENABLED);
ZmOperation.registerOp(ZmId.OP_EDIT_FILTER_RULE,{
textKey:"filterEdit",image:"Edit"}
,ZmSetting.FILTERS_ENABLED);
ZmOperation.registerOp(ZmId.OP_FORWARD,{
textKey:"forward",tooltipKey:"forwardTooltip",image:"Forward",shortcut:ZmKeyMap.FORWARD,textPrecedence:46}
);
ZmOperation.registerOp(ZmId.OP_FORWARD_ATT,{
textKey:"forwardAtt",tooltipKey:"forwardAtt",image:"Forward"}
);
ZmOperation.registerOp(ZmId.OP_FORWARD_INLINE,{
textKey:"forwardInline",tooltipKey:"forwardTooltip",image:"Forward"}
);
ZmOperation.registerOp(ZmId.OP_IM,{
textKey:"newIM",image:"ImStartChat",tooltipKey:"imNewChat"}
,ZmSetting.IM_ENABLED);
ZmOperation.registerOp(ZmId.OP_INC_ATTACHMENT,{
textKey:"includeMenuAttachment"}
);
ZmOperation.registerOp(ZmId.OP_INC_NONE,{
textKey:"includeMenuNone"}
);
ZmOperation.registerOp(ZmId.OP_INC_NO_PREFIX,{
textKey:"includeMenuNoPrefix"}
);
ZmOperation.registerOp(ZmId.OP_INC_PREFIX,{
textKey:"includeMenuPrefix"}
);
ZmOperation.registerOp(ZmId.OP_INC_PREFIX_FULL,{
textKey:"includeMenuPrefixFull"}
);
ZmOperation.registerOp(ZmId.OP_INC_SMART,{
textKey:"includeMenuSmart"}
);
ZmOperation.registerOp(ZmId.OP_MARK_READ,{
textKey:"markAsRead",image:"ReadMessage",shortcut:ZmKeyMap.MARK_READ}
);
ZmOperation.registerOp(ZmId.OP_MARK_UNREAD,{
textKey:"markAsUnread",image:"UnreadMessage",shortcut:ZmKeyMap.MARK_UNREAD}
);
ZmOperation.registerOp(ZmId.OP_MOVE_DOWN_FILTER_RULE,{
textKey:"filterMoveDown",image:"DownArrow"}
,ZmSetting.FILTERS_ENABLED);
ZmOperation.registerOp(ZmId.OP_MOVE_UP_FILTER_RULE,{
textKey:"filterMoveUp",image:"UpArrow"}
,ZmSetting.FILTERS_ENABLED);
ZmOperation.registerOp(ZmId.OP_NEW_MESSAGE,{
textKey:"newEmail",tooltipKey:"newMessageTooltip",image:"NewMessage",shortcut:ZmKeyMap.NEW_MESSAGE}
);
ZmOperation.registerOp(ZmId.OP_NEW_MESSAGE_WIN,{
textKey:"newEmail",tooltipKey:"newMessageTooltip",image:"NewMessage",shortcut:ZmKeyMap.NEW_MESSAGE_WIN}
);
ZmOperation.registerOp(ZmId.OP_REMOVE_FILTER_RULE,{
textKey:"filterRemove",image:"Delete"}
,ZmSetting.FILTERS_ENABLED);
ZmOperation.registerOp(ZmId.OP_REPLY,{
textKey:"reply",tooltipKey:"replyTooltip",image:"Reply",shortcut:ZmKeyMap.REPLY,textPrecedence:50}
);
ZmOperation.registerOp(ZmId.OP_REPLY_ACCEPT,{
textKey:"replyAccept",image:"Check"}
);
ZmOperation.registerOp(ZmId.OP_REPLY_ALL,{
textKey:"replyAll",tooltipKey:"replyAllTooltip",image:"ReplyAll",shortcut:ZmKeyMap.REPLY_ALL,textPrecedence:48}
);
ZmOperation.registerOp(ZmId.OP_REPLY_CANCEL);
ZmOperation.registerOp(ZmId.OP_REPLY_DECLINE,{
textKey:"replyDecline",image:"Cancel"}
);
ZmOperation.registerOp(ZmId.OP_REPLY_MODIFY);
ZmOperation.registerOp(ZmId.OP_REPLY_NEW_TIME,{
textKey:"replyNewTime",image:"NewTime"}
);
ZmOperation.registerOp(ZmId.OP_REPLY_TENTATIVE,{
textKey:"replyTentative",image:"QuestionMark"}
);
ZmOperation.registerOp(ZmId.OP_REQUEST_READ_RECEIPT,{
textKey:"requestReadReceipt",image:"ReadMessage"}
);
ZmOperation.registerOp(ZmId.OP_RUN_FILTER_RULE,{
textKey:"filterRun",image:"SwitchFormat"}
,ZmSetting.FILTERS_ENABLED);
ZmOperation.registerOp(ZmId.OP_SAVE_DRAFT,{
textKey:"saveDraft",tooltipKey:"saveDraftTooltip",image:"DraftFolder",shortcut:ZmKeyMap.SAVE}
,ZmSetting.SAVE_DRAFT_ENABLED);
ZmOperation.registerOp(ZmId.OP_SHOW_BCC,{
textKey:"showBcc"}
);
ZmOperation.registerOp(ZmId.OP_SHOW_ONLY_MAIL,{
textKey:"showOnlyMail",image:"Conversation"}
,ZmSetting.MIXED_VIEW_ENABLED);
ZmOperation.registerOp(ZmId.OP_SHOW_ORIG,{
textKey:"showOrig",image:"Message"}
);
ZmOperation.registerOp(ZmId.OP_SPAM,{
textKey:"junk",tooltipKey:"junkTooltip",image:"JunkMail",shortcut:ZmKeyMap.SPAM,textPrecedence:70}
,ZmSetting.SPAM_ENABLED);
ZmOperation.registerOp(ZmId.OP_RESET,{
textKey:"reset",image:"Refresh",tooltipKey:"refreshFilters"}
)
};
ZmMailApp.prototype._registerItems=function(){
ZmItem.registerItem(ZmItem.CONV,{
app:ZmApp.MAIL,nameKey:"conversation",pluralNameKey:"conversations",icon:"Conversation",soapCmd:"ConvAction",itemClass:"ZmConv",node:"c",organizer:ZmOrganizer.FOLDER,dropTargets:[ZmOrganizer.FOLDER,ZmOrganizer.TAG,ZmOrganizer.ZIMLET],searchType:"conversation",resultsList:AjxCallback.simpleClosure(function(e){
AjxDispatcher.require("MailCore");
return new ZmMailList(ZmItem.CONV,e)
}
,this)}
);
ZmItem.registerItem(ZmItem.MSG,{
app:ZmApp.MAIL,nameKey:"message",pluralNameKey:"messages",icon:"Message",soapCmd:"MsgAction",itemClass:"ZmMailMsg",node:"m",organizer:ZmOrganizer.FOLDER,dropTargets:[ZmOrganizer.FOLDER,ZmOrganizer.TAG,ZmOrganizer.ZIMLET],searchType:"message",resultsList:AjxCallback.simpleClosure(function(e){
AjxDispatcher.require("MailCore");
return new ZmMailList(ZmItem.MSG,e)
}
,this)}
);
ZmItem.registerItem(ZmItem.ATT,{
app:ZmApp.MAIL,nameKey:"attachment",icon:"Attachment",itemClass:"ZmMimePart",node:"mp",resultsList:AjxCallback.simpleClosure(function(e){
return new ZmMailList(ZmItem.ATT,e)
}
,this)}
)
};
ZmMailApp.prototype._setupSearchToolbar=function(){
if(appCtxt.get(ZmSetting.MAIL_ENABLED)){
ZmSearchToolBar.addMenuItem(ZmId.SEARCH_MAIL,{
msgKey:"searchMail",tooltipKey:"searchMail",icon:"Message",shareIcon:"SharedMailFolder",id:ZmId.getMenuItemId(ZmId.SEARCH,ZmId.SEARCH_MAIL)}
)
}};
ZmMailApp.prototype._registerApp=function(){
var t={};
t[ZmOperation.NEW_MESSAGE]="message";
var e={};
e[ZmKeyMap.NEW_MESSAGE]=ZmOperation.NEW_MESSAGE;
e[ZmKeyMap.NEW_MESSAGE_WIN]=ZmOperation.NEW_MESSAGE_WIN;
ZmApp.registerApp(ZmApp.MAIL,{
mainPkg:"MailCore",nameKey:"mail",icon:"MailApp",textPrecedence:70,chooserTooltipKey:"goToMail",viewTooltipKey:"displayMailToolTip",defaultSearch:appCtxt.isChildWindow?null:ZmId.SEARCH_MAIL,organizer:ZmOrganizer.FOLDER,overviewTrees:[ZmOrganizer.FOLDER,ZmOrganizer.SEARCH,ZmOrganizer.TAG],assistants:{
ZmMailAssistant:"Mail"}
,searchTypes:[ZmItem.MSG,ZmItem.CONV],newItemOps:t,actionCodes:e,gotoActionCode:ZmKeyMap.GOTO_MAIL,newActionCode:ZmKeyMap.NEW_MESSAGE,qsViews:["compose","msg"],trashViewOp:ZmOperation.SHOW_ONLY_MAIL,chooserSort:10,defaultSort:10,upsellUrl:ZmSetting.MAIL_UPSELL_URL}
)
};
ZmMailApp.prototype.startup=function(e){};
ZmMailApp.prototype.preNotify=function(u){
if(!(u.deleted&&u.created&&u.modified)){
return u
}
var n=false;
var s=u.deleted.id.split(",");
var p={};
var h=[];
for(var j=0;
j<s.length;
j++){
var w=s[j];
var g=ZmOrganizer.normalizeId(w);
if(g<0){
p[g]=true;
n=true
}else{
h.push(w)
}}
if(!n){
return u
}
var m=false;
var t=ZmRequestMgr._getObjList(u.created);
var f={};
var l={};
for(var j=0;
j<t.length;
j++){
var c=t[j];
var w=c.id;
var O=c._name;
if(O=="m"){
f[w]=c
}else{
if(O=="c"&&(c.n>1)){
l[w]=c;
m=true
}}}
if(!m){
return u
}
var x=false;
var q={};
var z=ZmRequestMgr._getObjList(u.modified);
var d={};
for(var j=0;
j<z.length;
j++){
var T=z[j];
var w=T.id;
var g=ZmOrganizer.normalizeId(w);
var O=T._name;
if(O=="m"){
var e=g*-1;
if(p[e]&&l[T.cid]){
x=true;
d[w]=T;
q[T.cid]=appCtxt.multiAccounts?ZmOrganizer.getSystemId(e):e;
l[T.cid]._wasVirtConv=true;
l[T.cid].m=[{
id:w}
];
var o=appCtxt.getById(w);
if(o){
o.cid=T.cid
}}}}
if(!x){
return u
}
if(h.length){
u.deleted.id=h.join(",")
}else{
delete u.deleted
}
for(var w in f){
var y=f[w];
var b=l[y.cid];
if(b&&b._wasVirtConv){
y._convCreateNode=b
}}
var v=[];
for(var r in q){
var k=l[r];
k.id=q[r];
k._newId=r;
v.push(k)
}
if(v.length){
var a={};
a.c=v;
appCtxt.getRequestMgr()._handleModifies(a)
}};
ZmMailApp.prototype.createNotify=function(o,s){
var e=o.m;
if(!e&&!o.c&&!o.link){
return
}
if(!s&&!this._noDefer&&this._deferNotifications("create",o)){
return
}
if(o.link){
var n=o.link;
for(var a=0;
a<n.length;
a++){
var t=n[a];
if(appCtxt.cacheGet(t.id)){
continue
}
this._handleCreateLink(t,ZmOrganizer.FOLDER)
}}
if(this._tradController&&(appCtxt.getCurrentController()==this._tradController)){
this._checkList(o,this._tradController.getList(),this._tradController)
}else{
if(this._convListController){
this._checkList(o,this._convListController.getList(),this._convListController)
}
if(this._convController){
this._checkList(o,this._convController.getList(),this._convController)
}}
this._handleAlerts(o)
};
ZmMailApp.prototype._handleAlerts=function(h){
var l=h.m||[];
if(l.length==0){
return
}
AjxDispatcher.require("Alert");
var o=appCtxt.getActiveAccount();
var a,f,p=false;
var n=0;
for(var s=0;
s<l.length;
s++){
var u=l[s];
var e=(u&&u.f&&(u.f.indexOf(ZmItem.FLAG_UNREAD)!=-1))?ZmOrganizer.parseId(u.l):null;
if(e&&e.id==ZmOrganizer.ID_INBOX){
var c=e.account;
if(!c||(c&&c.isOfflineInitialSync())){
continue
}
if(appCtxt.accountList.size(true)>1){
ZmAccountAlert.get(c).start(this)
}
if(!a&&c==o&&appCtxt.get(ZmSetting.MAIL_NOTIFY_APP,null,c)){
this.startAlert();
a=true
}
if(!f&&appCtxt.get(ZmSetting.MAIL_NOTIFY_SOUNDS,null,c)){
ZmSoundAlert.getInstance().start();
f=true
}
if(!p&&appCtxt.get(ZmSetting.MAIL_NOTIFY_BROWSER,null,c)){
ZmBrowserAlert.getInstance().start(ZmMsg.newMessage);
p=true
}
if(appCtxt.get(ZmSetting.MAIL_NOTIFY_TOASTER,null,c)&&n<5){
var t=appCtxt.getById(u.id)||ZmMailMsg.createFromDom(u,{}
);
var g=(t.subject)?([t.subject," - ",(t.fragment||"")].join("")):(t.fragment||"");
var m=t.getAddress(AjxEmailAddress.FROM);
var r=m.getName()||m.getAddress();
var d=(appCtxt.accountList.size(true)>1)?AjxMessageFormat.format(ZmMsg.newMailWithAccount,[r,c.getDisplayName()]):AjxMessageFormat.format(ZmMsg.newMail,r);
ZmDesktopAlert.getInstance().start(d,g);
n++
}}}};
ZmMailApp.prototype._checkList=function(r,s,n){
if(!(s&&s instanceof ZmMailList)){
return
}
var o={};
var h={};
var t={};
if(!(s.search&&s.search.matches)&&(n!=this._convController)){
return
}
var c=s.search.sortBy;
var e=this._checkType(r,ZmItem.CONV,o,s,c);
var a=this._checkType(r,ZmItem.MSG,h,s,c,o);
if(e.gotMail||a.gotMail){
s.notifyCreate(o,h)
}
if(e.hasMore||a.hasMore){
var n;
var l=appCtxt.getAppViewMgr().getCurrentViewId();
if(l==ZmId.VIEW_CONVLIST){
n=this.getConvListController()
}else{
if(l==ZmId.VIEW_TRAD){
n=this.getTradController()
}}
if(n){
n.setHasMore(true)
}}};
ZmMailApp.prototype._checkType=function(creates,type,items,currList,sortBy,convs){
var result={
gotMail:false,hasMore:false};
var nodeName=ZmList.NODE[type];
var list=creates[nodeName];
if(!(list&&list.length)){
return result
}
var throttle=appCtxt.isOffline&&appCtxt.getActiveAccount().isOfflineInitialSync();
if(throttle){
if(!this._maxEntries){
var mlv=this.getMailListController().getReferenceView().getMailListView();
this._maxEntries=mlv&&mlv.calculateMaxEntries()
}
if(this.numEntries>this._maxEntries){
result.hasMore=true;
return result
}}
for(var i=0;
i<list.length;
i++){
var create=list[i];
if(create._handled){
continue
}
create._handled=true;
if(currList.getById(create.id)||create._wasVirtConv){
continue
}
if(currList.type==ZmItem.MSG&&type==ZmItem.CONV){
continue
}
if(appCtxt.isOffline){
if((ZmList.ITEM_TYPE[nodeName]!=currList.type)&&(currList.type!=ZmItem.CONV)){
continue
}}
if(throttle&&this.numEntries>this._maxEntries){
result.hasMore=true;
break
}
var itemClass=eval(ZmList.ITEM_CLASS[type]);
var item=itemClass.createFromDom(create,{}
,true);
items[item.id]=item;
result.gotMail=true
}
return result
};
ZmMailApp.prototype.postNotify=function(e){
var t=this._checkReplenishListView;
if(t&&!t._isPageless){
t._checkReplenish();
this._checkReplenishListView=null
}};
ZmMailApp.prototype.refresh=function(a){
var h=appCtxt.getById(ZmFolder.ID_INBOX);
if(h){
this.setNewMailNotice(h)
}
if(!appCtxt.inStartup){
this.resetOverview(this.getOverviewId());
var n=appCtxt.currentRequestParams;
if(appCtxt.getCurrentAppName()==this._name&&n.resend&&n.methodName=="NoOpRequest"){
var e=appCtxt.getCurrentViewId();
if(e==ZmId.VIEW_CONVLIST||e==ZmId.VIEW_TRAD){
appCtxt.getSearchController().redoSearch(this.currentSearch)
}}}
if(appCtxt.get(ZmSetting.MAIL_ATTACH_VIEW_ENABLED)){
var o=appCtxt.getFolderTree();
if(!o.getById(ZmFolder.ID_ATTACHMENTS)){
var t=appCtxt.getById(ZmOrganizer.ID_ROOT);
var r={
id:ZmFolder.ID_ATTACHMENTS,parent:t,tree:t.tree,type:ZmOrganizer.FOLDER,numTotal:1};
var s=new ZmFolder(r);
t.children.add(s);
s._notify(ZmEvent.E_CREATE)
}}};
ZmMailApp.prototype.handleOp=function(n,o){
var t=false;
var a=true;
switch(n){
case ZmOperation.NEW_MESSAGE_WIN:t=true;
a=false;
case ZmOperation.NEW_MESSAGE:if(!t){
t=this._inNewWindow(o&&o.ev);
a=false
}
var e=new AjxCallback(this,this._handleLoadNewMessage,[t]);
AjxDispatcher.require(["ContactsCore","Contacts"],false,e,null,a);
break
}};
ZmMailApp.prototype._handleLoadNewMessage=function(e){
AjxDispatcher.run("Compose",{
action:ZmOperation.NEW_MESSAGE,inNewWindow:e}
)
};
ZmMailApp.prototype.getOverviewPanelContent=function(){
var t=!this._overviewPanelContent;
var e=ZmApp.prototype.getOverviewPanelContent.apply(this,arguments);
if(t){
appCtxt.getSearchController().updateOverview()
}
return e
};
ZmMailApp.prototype.getOverviewContainer=function(){
var t=!this._overviewContainer;
var e=ZmApp.prototype.getOverviewContainer.apply(this,arguments);
if(t){
appCtxt.getSearchController().updateOverview()
}
return e
};
ZmMailApp.prototype.launch=function(n,r){
this._groupBy[appCtxt.getActiveAccount().name]=appCtxt.get(ZmSetting.GROUP_MAIL_BY);
var a;
n=n||{};
if(n.qsParams){
var e=n.qsParams.view,s=n.qsParams.id;
if(e=="compose"){
this._showComposeView(r);
return
}else{
if(s){
e=e||"msg";
if(e=="list"){
a=["item:",s].join("");
n.searchResponse=null;
this._forceMsgView=true
}else{
if(e=="msg"){
var o=new ZmMailMsg(s,null,true);
var t={
getHtml:appCtxt.get(ZmSetting.VIEW_AS_HTML),markRead:(appCtxt.get(ZmSetting.MARK_MSG_READ)==ZmSetting.MARK_READ_NOW),callback:new AjxCallback(this,this._handleResponseMsgLoad,[o,r]),errorCallback:new AjxCallback(this,this._handleErrorMsgLoad,r)};
o.load(t);
return
}}}}}else{
if(appCtxt.get(ZmSetting.OFFLINE_SUPPORTS_MAILTO)&&!appCtxt.multiAccounts){
if(appCtxt.getAppController().handleOfflineMailTo(location.search,r)){
return
}}}
this.mailSearch(a,r,n.searchResponse)
};
ZmMailApp.prototype._handleErrorLaunch=function(t,e){
if(e.code==ZmCsfeException.MAIL_NO_SUCH_FOLDER||e.code==ZmCsfeException.MAIL_NO_SUCH_TAG||e.code==ZmCsfeException.MAIL_QUERY_PARSE_ERROR){
var a={
query:"in:inbox",callback:t.callback,errorCallback:null,types:t.types};
appCtxt.getSearchController().search(a)
}};
ZmMailApp.prototype._handleErrorMsgLoad=function(t,e){
this.mailSearch();
if(t){
t.run()
}
this._notifyRendered();
return false
};
ZmMailApp.prototype._handleResponseMsgLoad=function(t,a){
AjxDispatcher.require("Startup2");
var e=AjxDispatcher.run("GetMsgController");
if(e){
e.show(t);
if(a){
a.run()
}
this._notifyRendered()
}};
ZmMailApp.prototype.mailSearch=function(r,l,a,h){
var n=appCtxt.isOffline&&appCtxt.inStartup&&appCtxt.accountList.defaultAccount;
if(n){
appCtxt.accountList.setActiveAccount(n)
}
var s=appCtxt.getSearchController();
var c,e;
if(appCtxt.get(ZmSetting.OFFLINE_SHOW_GLOBAL_INBOX)&&appCtxt.accountList.size(true)>2){
r=null;
c=appCtxt.accountList.generateQuery(ZmOrganizer.ID_INBOX);
e=true;
s.searchAllAccounts=true
}else{
r=r||appCtxt.get(ZmSetting.INITIAL_SEARCH,null,n)
}
var o=new AjxVector();
o.add(h||this.getGroupMailBy());
var t={
searchFor:ZmId.SEARCH_MAIL,query:r,queryHint:c,types:o,limit:this.getLimit(),getHtml:appCtxt.get(ZmSetting.VIEW_AS_HTML,null,n),noUpdateOverview:e,accountName:(n&&n.name),callback:l,response:a};
t.errorCallback=new AjxCallback(this,this._handleErrorLaunch,t);
s.search(t)
};
ZmMailApp.prototype._handleOfflineMailSearch=function(){
if(appCtxt.get(ZmSetting.OFFLINE_SUPPORTS_MAILTO)){
appCtxt.getAppController().handleOfflineMailTo(location.search)
}};
ZmMailApp.prototype.getSearchParams=function(e){
e=e||{};
if(!appCtxt.inStartup&&appCtxt.get(ZmSetting.READING_PANE_ENABLED)){
e.fetch=true
}
AjxDispatcher.require("MailCore");
e.headers=ZmMailMsg.requestHeaders;
return e
};
ZmMailApp.prototype.showSearchResults=function(t,a){
var e=new AjxCallback(this,this._handleLoadShowSearchResults,[t,a]);
AjxDispatcher.require("MailCore",false,e,null,true)
};
ZmMailApp.prototype._handleLoadShowSearchResults=function(t,a){
var e=(t.type==ZmItem.MSG)?this.getTradController():this.getConvListController();
e.show(t);
if(this._forceMsgView){
e.selectFirstItem();
this._forceMsgView=false
}
if(a){
a.run()
}
this._notifyRendered()
};
ZmMailApp.prototype._parseComposeUrl=function(t){
t=t||"";
var o=t.match(/\bto=([^&]+)/);
var r=o?decodeURIComponent(o[1]):null;
o=t.match(/\bsubject=([^&]+)/);
var n=o?(decodeURIComponent(o[1]).replace(/\+/g," ")):null;
o=t.match(/\bcc=([^&]+)/);
var s=o?decodeURIComponent(o[1]):null;
o=t.match(/\bbcc=([^&]+)/);
var a=o?decodeURIComponent(o[1]):null;
o=t.match(/\bbody=([^&]+)/);
var e=o?(decodeURIComponent(o[1]).replace(/\+/g," ")):null;
return{
to:r,subject:n,cc:s,bcc:a,body:e}
};
ZmMailApp.prototype._showComposeView=function(r,a){
var o=a||location.search;
AjxDispatcher.require("Startup2");
var l=AjxDispatcher.run("GetComposeController");
var e=this._parseComposeUrl(o);
var s=e.to;
if(s&&s.indexOf("mailto")==0){
s=s.replace(/mailto:/,"");
var n=s.split("?");
e.to=n[0];
if(n.length>1){
n=n[1];
var h=this._parseComposeUrl(n);
e.to=e.to?(h.to?[e.to,","+h.to].join(""):e.to):h.to;
e.subject=h.subject||e.subject;
e.cc=h.cc||e.cc;
e.bcc=h.bcc||e.bcc;
e.body=h.body||e.body
}}
var t={
action:ZmOperation.NEW_MESSAGE,toOverride:e.to,ccOverride:e.cc,bccOverride:e.bcc,subjOverride:e.subject,extraBodyText:e.body,callback:r};
if(appCtxt.isOffline&&appCtxt.get(ZmSetting.OFFLINE_SUPPORTS_MAILTO)&&appCtxt.getCurrentViewId()==ZmId.VIEW_COMPOSE){
l.resetComposeForMailto(t)
}else{
l.doAction(t)
}
this._notifyRendered()
};
ZmMailApp.prototype.getConvListController=function(){
if(!this._convListController){
this._convListController=new ZmConvListController(this._container,this)
}
return this._convListController
};
ZmMailApp.prototype.getConvController=function(){
if(!this._convController){
this._convController=new ZmConvController(this._container,this)
}
return this._convController
};
ZmMailApp.prototype.getTradController=function(){
if(!this._tradController){
this._tradController=new ZmTradController(this._container,this)
}
return this._tradController
};
ZmMailApp.prototype.getMsgController=function(e){
return this.getSessionController(ZmId.VIEW_MSG,"ZmMsgController",e)
};
ZmMailApp.prototype.getComposeController=function(e){
return this.getSessionController(ZmId.VIEW_COMPOSE,"ZmComposeController",e)
};
ZmMailApp.prototype.getCurrentSessionId=function(e){
return this._curSessionId[e]
};
ZmMailApp.prototype.getSessionController=function(type,controllerClass,sessionId){
if(!this._sessionController[type]){
this._sessionController[type]={};
this._sessionId[type]=1
}
if(sessionId&&this._sessionController[type][sessionId]){
return this._sessionController[type][sessionId]
}
var controllers=this._sessionController[type];
var controller;
for(var id in controllers){
if(controllers[id].inactive){
controller=controllers[id];
break
}}
sessionId=controller?controller.sessionId:this._sessionId[type]++;
if(!controller){
var ctlrClass=eval(controllerClass);
controller=this._sessionController[type][sessionId]=new ctlrClass(this._container,this)
}
controller.setSessionId(type,sessionId);
this._curSessionId[type]=sessionId;
controller.inactive=false;
return controller
};
ZmMailApp.prototype.getConfirmController=function(e){
return this.getSessionController(ZmId.VIEW_MAIL_CONFIRM,"ZmMailConfirmController",e)
};
ZmMailApp.prototype.getMailListController=function(){
var e=appCtxt.get(ZmSetting.GROUP_MAIL_BY);
return(e==ZmSetting.GROUP_BY_CONV)?AjxDispatcher.run("GetConvListController"):AjxDispatcher.run("GetTradController")
};
ZmMailApp.prototype.getAttachmentsController=function(){
if(!this._attachmentsController){
this._attachmentsController=new ZmAttachmentsController(this._container,this)
}
return this._attachmentsController
};
ZmMailApp.prototype.compose=function(e){
AjxDispatcher.run("GetComposeController").doAction(e)
};
ZmMailApp.prototype.setNewMailNotice=function(e){
var s=appCtxt.getAppChooser();
if(s){
var r=s.getButton(ZmApp.MAIL);
var o=(e.numUnread>0)?"EnvelopeOpen":"MailApp";
r.setImage(o)
}
if(appCtxt.isOffline&&appCtxt.get(ZmSetting.OFFLINE_SUPPORTS_DOCK_UPDATE)){
var t=0;
var n=appCtxt.accountList.visibleAccounts;
for(var a=0;
a<n.length;
a++){
t+=(n[a].unread||0)
}
if(AjxEnv.isMac&&window.platform){
window.platform.icon().badgeText=(t>0)?t:null
}else{
if(AjxEnv.isWindows){
window.platform.icon().imageSpec=(t>0)?"resource://webapp/icons/default/newmail.png":"resource://webapp/icons/default/launcher.ico";
window.platform.icon().title=(t>0)?AjxMessageFormat.format(ZmMsg.unreadCount,t):null
}}}};
ZmMailApp.prototype.getGroupMailBy=function(){
var e=this._groupBy[appCtxt.getActiveAccount().name];
var t=e||appCtxt.get(ZmSetting.GROUP_MAIL_BY);
return t?ZmMailApp.GROUP_MAIL_BY_ITEM[t]:ZmItem.MSG
};
ZmMailApp.prototype.setGroupMailBy=function(e){
this._groupBy[appCtxt.getActiveAccount().name]=e;
appCtxt.set(ZmSetting.GROUP_MAIL_BY,e)
};
ZmMailApp.prototype.getLimit=function(t){
var e=appCtxt.get(ZmSetting.PAGE_SIZE);
return t?e:2*e
};
ZmMailApp.addReplyMenu=function(e){
var t=[ZmOperation.REPLY,ZmOperation.REPLY_ALL];
var a=new ZmActionMenu({
parent:e,menuItems:t}
);
e.setMenu(a);
return a
};
ZmMailApp.addForwardMenu=function(e){
var t=[ZmOperation.FORWARD_INLINE,ZmOperation.FORWARD_ATT];
var a=new ZmActionMenu({
parent:e,menuItems:t}
);
e.setMenu(a);
return a
};
ZmMailApp.prototype.getDataSourceCollection=function(t){
var a=window.parentAppCtxt||window.appCtxt;
var e=t?t.name:a.getActiveAccount().name;
if(!this._dataSourceCollection[e]){
this._dataSourceCollection[e]=new ZmDataSourceCollection();
if(a.getActiveAccount().isMain){
this._dataSourceCollection[e].initialize(a.getSettings().getInfoResponse.dataSources)
}}
return this._dataSourceCollection[e]
};
ZmMailApp.prototype.getIdentityCollection=function(a){
if(appCtxt.isChildWindow){
if(!this._identityCollection){
this._identityCollection=new ZmIdentityCollection()
}
return this._identityCollection
}
var t=a?a.name:appCtxt.getActiveAccount().name;
if(!this._identityCollection[t]){
var e=this._identityCollection[t]=new ZmIdentityCollection();
e.initialize(appCtxt.getSettings(a).getInfoResponse.identities)
}
return this._identityCollection[t]
};
ZmMailApp.prototype.getSignatureCollection=function(t){
var a=window.parentAppCtxt||window.appCtxt;
var e=t?t.name:a.getActiveAccount().name;
if(!this._signatureCollection[e]){
var o=this._signatureCollection[e]=new ZmSignatureCollection();
o.initialize(a.getSettings(t).getInfoResponse.signatures)
}
return this._signatureCollection[e]
};
ZmMailApp.prototype._addSettingsChangeListeners=function(){
ZmApp.prototype._addSettingsChangeListeners.call(this);
if(!this._settingsListener){
this._settingsListener=new AjxListener(this,this._settingsChangeListener)
}
var e=appCtxt.getSettings();
e.getSetting(ZmSetting.VIEW_AS_HTML).addChangeListener(this._settingListener);
e.addChangeListener(this._settingsListener)
};
ZmMailApp.prototype._settingChangeListener=function(a){
ZmApp.prototype._settingChangeListener.call(this,a);
if(a.type!=ZmEvent.S_SETTING){
return
}
var t=a.source;
var n=this.getMailListController();
if(n&&t.id==ZmSetting.VIEW_AS_HTML){
var e=n._doublePaneView;
var o=e?e.getMsg():null;
if(o){
e.reset();
e.setMsg(o)
}}};
ZmMailApp.prototype._settingsChangeListener=function(n){
if(n.type!=ZmEvent.S_SETTINGS){
return
}
var s=n.getDetail("settings");
if(!(s&&s.length)){
return
}
var h=this.getMailListController();
if(!h){
return
}
var e=h._currentView;
var r,o;
for(var t=0;
t<s.length;
t++){
var a=s[t];
if(a.id==ZmSetting.SHOW_FRAGMENTS){
if(e!=ZmId.VIEW_MSG){
r=o||e
}}}
r=o||r;
if(r){
h.switchView(r,true)
}}
}
if(AjxPackage.define("zimbraMail.calendar.ZmCalendarApp")){
ZmCalendarApp=function(e){
ZmApp.call(this,ZmApp.CALENDAR,e);
if(!appCtxt.isOffline){
this._addSettingsChangeListeners()
}
this._resByName={};
this._resByEmail={}
};
ZmEvent.S_APPT=ZmId.ITEM_APPOINTMENT;
ZmEvent.S_RESOURCE=ZmId.ITEM_RESOURCE;
ZmItem.APPT=ZmEvent.S_APPT;
ZmItem.RESOURCE=ZmEvent.S_RESOURCE;
ZmOrganizer.CALENDAR=ZmId.ORG_CALENDAR;
ZmApp.CALENDAR=ZmId.APP_CALENDAR;
ZmApp.CLASS[ZmApp.CALENDAR]="ZmCalendarApp";
ZmApp.SETTING[ZmApp.CALENDAR]=ZmSetting.CALENDAR_ENABLED;
ZmApp.UPSELL_SETTING[ZmApp.CALENDAR]=ZmSetting.CALENDAR_UPSELL_ENABLED;
ZmApp.LOAD_SORT[ZmApp.CALENDAR]=40;
ZmApp.QS_ARG[ZmApp.CALENDAR]="calendar";
ZmCalendarApp.REMINDER_START_DELAY=10000;
ZmCalendarApp.MINICAL_DELAY=5000;
ZmCalendarApp.VIEW_FOR_SETTING={};
ZmCalendarApp.VIEW_FOR_SETTING[ZmSetting.CAL_DAY]=ZmId.VIEW_CAL_DAY;
ZmCalendarApp.VIEW_FOR_SETTING[ZmSetting.CAL_WEEK]=ZmId.VIEW_CAL_WEEK;
ZmCalendarApp.VIEW_FOR_SETTING[ZmSetting.CAL_WORK_WEEK]=ZmId.VIEW_CAL_WORK_WEEK;
ZmCalendarApp.VIEW_FOR_SETTING[ZmSetting.CAL_MONTH]=ZmId.VIEW_CAL_MONTH;
ZmCalendarApp.VIEW_FOR_SETTING[ZmSetting.CAL_SCHEDULE]=ZmId.VIEW_CAL_SCHEDULE;
ZmCalendarApp.VIEW_FOR_SETTING[ZmSetting.CAL_LIST]=ZmId.VIEW_CAL_LIST;
ZmCalendarApp.COLORS=[];
ZmCalendarApp.COLORS[ZmOrganizer.C_ORANGE]="Orange";
ZmCalendarApp.COLORS[ZmOrganizer.C_BLUE]="Blue";
ZmCalendarApp.COLORS[ZmOrganizer.C_CYAN]="Cyan";
ZmCalendarApp.COLORS[ZmOrganizer.C_GREEN]="Green";
ZmCalendarApp.COLORS[ZmOrganizer.C_PURPLE]="Purple";
ZmCalendarApp.COLORS[ZmOrganizer.C_RED]="Red";
ZmCalendarApp.COLORS[ZmOrganizer.C_YELLOW]="Yellow";
ZmCalendarApp.COLORS[ZmOrganizer.C_PINK]="Pink";
ZmCalendarApp.COLORS[ZmOrganizer.C_GRAY]="Gray";
ZmCalendarApp.CUTYPE_INDIVIDUAL="IND";
ZmCalendarApp.CUTYPE_GROUP="GRO";
ZmCalendarApp.CUTYPE_RESOURCE="RES";
ZmCalendarApp.CUTYPE_ROOM="ROO";
ZmCalendarApp.CUTYPE_UNKNOWN="UNK";
ZmCalendarApp.STATUS_CANC="CANC";
ZmCalendarApp.STATUS_COMP="COMP";
ZmCalendarApp.STATUS_CONF="CONF";
ZmCalendarApp.STATUS_DEFR="DEFERRED";
ZmCalendarApp.STATUS_INPR="INPR";
ZmCalendarApp.STATUS_NEED="NEED";
ZmCalendarApp.STATUS_TENT="TENT";
ZmCalendarApp.STATUS_WAIT="WAITING";
ZmCalendarApp.METHOD_CANCEL="CANCEL";
ZmCalendarApp.METHOD_PUBLISH="PUBLISH";
ZmCalendarApp.METHOD_REPLY="REPLY";
ZmCalendarApp.METHOD_REQUEST="REQUEST";
ZmCalendarApp.prototype=new ZmApp;
ZmCalendarApp.prototype.constructor=ZmCalendarApp;
ZmCalendarApp.prototype.toString=function(){
return"ZmCalendarApp"
};
ZmCalendarApp.prototype._defineAPI=function(){
AjxDispatcher.setPackageLoadFunction("CalendarCore",new AjxCallback(this,this._postLoadCore));
AjxDispatcher.setPackageLoadFunction("Calendar",new AjxCallback(this,this._postLoad,ZmOrganizer.CALENDAR));
AjxDispatcher.registerMethod("GetCalController","CalendarCore",new AjxCallback(this,this.getCalController));
AjxDispatcher.registerMethod("GetReminderController","CalendarCore",new AjxCallback(this,this.getReminderController));
AjxDispatcher.registerMethod("ShowMiniCalendar","CalendarCore",new AjxCallback(this,this.showMiniCalendar));
AjxDispatcher.registerMethod("GetApptComposeController",["CalendarCore","Calendar","CalendarAppt"],new AjxCallback(this,this.getApptComposeController))
};
ZmCalendarApp.prototype._registerSettings=function(e){
var e=e||appCtxt.getSettings();
e.registerSetting("CAL_ALWAYS_SHOW_MINI_CAL",{
name:"zimbraPrefCalendarAlwaysShowMiniCal",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("CAL_APPT_VISIBILITY",{
name:"zimbraPrefCalendarApptVisibility",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:"public"}
);
e.registerSetting("CAL_EXPORT",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_NONE}
);
e.registerSetting("CAL_FIRST_DAY_OF_WEEK",{
name:"zimbraPrefCalendarFirstDayOfWeek",type:ZmSetting.T_PREF,dataType:ZmSetting.D_INT,defaultValue:0}
);
e.registerSetting("CAL_FREE_BUSY_ACL",{
type:ZmSetting.T_PREF,defaultValue:ZmSetting.ACL_ALL}
);
e.registerSetting("CAL_FREE_BUSY_ACL_USERS",{
type:ZmSetting.T_PREF}
);
e.registerSetting("CAL_IMPORT",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_NONE}
);
e.registerSetting("CAL_INVITE_ACL",{
type:ZmSetting.T_PREF,defaultValue:ZmSetting.ACL_ALL}
);
e.registerSetting("CAL_INVITE_ACL_USERS",{
type:ZmSetting.T_PREF}
);
e.registerSetting("CAL_REMINDER_NOTIFY_SOUNDS",{
name:"zimbraPrefCalendarReminderSoundsEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("CAL_REMINDER_NOTIFY_BROWSER",{
name:"zimbraPrefCalendarReminderFlashTitle",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("CAL_REMINDER_NOTIFY_TOASTER",{
name:"zimbraPrefCalendarToasterEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("CAL_REMINDER_WARNING_TIME",{
name:"zimbraPrefCalendarApptReminderWarningTime",type:ZmSetting.T_PREF,dataType:ZmSetting.D_INT,defaultValue:0}
);
e.registerSetting("CAL_SHOW_TIMEZONE",{
name:"zimbraPrefUseTimeZoneListInCalendar",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("CAL_USE_QUICK_ADD",{
name:"zimbraPrefCalendarUseQuickAdd",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("CALENDAR_INITIAL_VIEW",{
name:"zimbraPrefCalendarInitialView",type:ZmSetting.T_PREF,defaultValue:ZmSetting.CAL_DAY}
);
e.registerSetting("DELETE_INVITE_ON_REPLY",{
name:"zimbraPrefDeleteInviteOnReply",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("ENABLE_APPL_ICAL_DELEGATION",{
name:"zimbraPrefAppleIcalDelegationEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("CAL_AUTO_ADD_INVITES",{
name:"zimbraPrefCalendarAutoAddInvites",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("CAL_SEND_INV_DENIED_REPLY",{
name:"zimbraPrefCalendarSendInviteDeniedAutoReply",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("CAL_INV_FORWARDING_ADDRESS",{
name:"zimbraPrefCalendarForwardInvitesTo",type:ZmSetting.T_PREF}
);
e.registerSetting("CAL_SHOW_PAST_DUE_REMINDERS",{
name:"zimbraPrefCalendarShowPastDueReminders",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("CAL_SHOW_CALENDAR_WEEK",{
name:"zimbraPrefShowCalendarWeek",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
)
};
ZmCalendarApp.prototype._registerPrefs=function(){
var t={
CALENDAR:{
title:ZmMsg.calendar,icon:"CalendarApp",templateId:"prefs.Pages#Calendar",priority:80,precondition:ZmSetting.CALENDAR_ENABLED,prefs:[ZmSetting.CAL_ALWAYS_SHOW_MINI_CAL,ZmSetting.CAL_AUTO_ADD_INVITES,ZmSetting.CAL_SEND_INV_DENIED_REPLY,ZmSetting.CAL_APPT_VISIBILITY,ZmSetting.CAL_EXPORT,ZmSetting.CAL_FIRST_DAY_OF_WEEK,ZmSetting.CAL_IMPORT,ZmSetting.CAL_REMINDER_WARNING_TIME,ZmSetting.CAL_REMINDER_NOTIFY_SOUNDS,ZmSetting.CAL_REMINDER_NOTIFY_BROWSER,ZmSetting.CAL_SHOW_TIMEZONE,ZmSetting.CAL_USE_QUICK_ADD,ZmSetting.CALENDAR_INITIAL_VIEW,ZmSetting.DELETE_INVITE_ON_REPLY,ZmSetting.ENABLE_APPL_ICAL_DELEGATION,ZmSetting.CAL_FREE_BUSY_ACL,ZmSetting.CAL_FREE_BUSY_ACL_USERS,ZmSetting.CAL_INVITE_ACL,ZmSetting.CAL_INVITE_ACL_USERS,ZmSetting.CAL_REMINDER_NOTIFY_TOASTER,ZmSetting.CAL_INV_FORWARDING_ADDRESS,ZmSetting.CAL_SHOW_PAST_DUE_REMINDERS,ZmSetting.CAL_SHOW_CALENDAR_WEEK],manageDirty:true,createView:function(o,n,a){
AjxDispatcher.require("Alert");
return new ZmCalendarPrefsPage(o,n,a)
}}};
for(var e in t){
ZmPref.registerPrefSection(e,t[e])
}
ZmPref.registerPref("CAL_ALWAYS_SHOW_MINI_CAL",{
displayName:ZmMsg.alwaysShowMiniCal,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("CAL_AUTO_ADD_INVITES",{
displayName:ZmMsg.autoAddInvites,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("CAL_SEND_INV_DENIED_REPLY",{
displayName:ZmMsg.sendInvDeniedAutoReply,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("CAL_EXPORT",{
displayName:ZmMsg.exportToICS,displayContainer:ZmPref.TYPE_EXPORT}
);
ZmPref.registerPref("CAL_FIRST_DAY_OF_WEEK",{
displayName:ZmMsg.calendarFirstDayOfWeek,displayContainer:ZmPref.TYPE_SELECT,displayOptions:AjxDateUtil.WEEKDAY_LONG,options:[0,1,2,3,4,5,6]}
);
ZmPref.registerPref("CAL_FREE_BUSY_ACL",{
displayContainer:ZmPref.TYPE_RADIO_GROUP,displayOptions:[ZmMsg.freeBusyAllowAll,ZmMsg.freeBusyAllowLocal,ZmMsg.freeBusyAllowNone,ZmMsg.freeBusyAllowSome],options:[ZmSetting.ACL_PUBLIC,ZmSetting.ACL_AUTH,ZmSetting.ACL_NONE,ZmSetting.ACL_USER]}
);
ZmPref.registerPref("CAL_FREE_BUSY_ACL_USERS",{
displayContainer:ZmPref.TYPE_TEXTAREA}
);
ZmPref.registerPref("CAL_IMPORT",{
displayName:ZmMsg.importFromICS,displayContainer:ZmPref.TYPE_IMPORT}
);
ZmPref.registerPref("CAL_INVITE_ACL",{
displayContainer:ZmPref.TYPE_RADIO_GROUP,displayOptions:[ZmMsg.invitesAllowAll,ZmMsg.invitesAllowLocal,ZmMsg.invitesAllowNone,ZmMsg.invitesAllowSome],options:[ZmSetting.ACL_PUBLIC,ZmSetting.ACL_AUTH,ZmSetting.ACL_NONE,ZmSetting.ACL_USER]}
);
ZmPref.registerPref("CAL_INVITE_ACL_USERS",{
displayContainer:ZmPref.TYPE_TEXTAREA}
);
ZmPref.registerPref("CAL_REMINDER_WARNING_TIME",{
displayName:ZmMsg.numberOfMinutes,displayContainer:ZmPref.TYPE_SELECT,displayOptions:[ZmMsg.apptRemindNever,ZmMsg.apptRemindNMinutesBefore,ZmMsg.apptRemindNMinutesBefore,ZmMsg.apptRemindNMinutesBefore,ZmMsg.apptRemindNMinutesBefore,ZmMsg.apptRemindNMinutesBefore,ZmMsg.apptRemindNMinutesBefore,ZmMsg.apptRemindNMinutesBefore],options:[0,1,5,10,15,30,45,60]}
);
ZmPref.registerPref("CAL_SHOW_TIMEZONE",{
displayName:ZmMsg.shouldShowTimezone,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("CAL_USE_QUICK_ADD",{
displayName:ZmMsg.useQuickAdd,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("CALENDAR_INITIAL_VIEW",{
displayName:ZmMsg.calendarInitialView,displayContainer:ZmPref.TYPE_SELECT,displayOptions:[ZmMsg.calViewDay,ZmMsg.calViewWorkWeek,ZmMsg.calViewWeek,ZmMsg.calViewMonth,ZmMsg.calViewList,ZmMsg.calViewSchedule],options:[ZmSetting.CAL_DAY,ZmSetting.CAL_WORK_WEEK,ZmSetting.CAL_WEEK,ZmSetting.CAL_MONTH,ZmSetting.CAL_LIST,ZmSetting.CAL_SCHEDULE]}
);
ZmPref.registerPref("CAL_REMINDER_NOTIFY_SOUNDS",{
displayName:ZmMsg.playSound,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("CAL_REMINDER_NOTIFY_BROWSER",{
displayName:ZmMsg.flashBrowser,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("DELETE_INVITE_ON_REPLY",{
displayName:ZmMsg.deleteInviteOnReply,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("ENABLE_APPL_ICAL_DELEGATION",{
displayName:ZmMsg.enableAppleICalDelegation,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("CAL_REMINDER_NOTIFY_TOASTER",{
displayFunc:function(){
AjxDispatcher.require("Alert");
return ZmDesktopAlert.getInstance().getDisplayText()
}
,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("CAL_APPT_VISIBILITY",{
displayName:ZmMsg.calendarInitialApptVisibility,displayContainer:ZmPref.TYPE_SELECT,displayOptions:[ZmMsg._public,ZmMsg._private],options:[ZmSetting.CAL_VISIBILITY_PUB,ZmSetting.CAL_VISIBILITY_PRIV]}
);
ZmPref.registerPref("CAL_INV_FORWARDING_ADDRESS",{
displayName:ZmMsg.inviteForwardingAddress,displayContainer:ZmPref.TYPE_INPUT,validationFunction:ZmPref.validateEmail,errorMessage:ZmMsg.invalidEmail}
);
ZmPref.registerPref("CAL_SHOW_PAST_DUE_REMINDERS",{
displayName:ZmMsg.apptPastDueReminderLabel,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("CAL_SHOW_CALENDAR_WEEK",{
displayName:ZmMsg.showWeekNumber,displayContainer:ZmPref.TYPE_CHECKBOX}
)
};
ZmCalendarApp.prototype._registerOperations=function(){
ZmOperation.registerOp(ZmId.OP_CAL_LIST_VIEW,{
textKey:"list",tooltipKey:"viewCalListTooltip",image:"CalListView",shortcut:ZmKeyMap.CAL_LIST_VIEW}
);
ZmOperation.registerOp(ZmId.OP_CAL_REFRESH,{
textKey:"refresh",tooltipKey:"calRefreshTooltip",image:"Refresh",shortcut:ZmKeyMap.REFRESH}
);
ZmOperation.registerOp(ZmId.OP_CAL_VIEW_MENU,{
textKey:"view",image:"Appointment"}
,null,AjxCallback.simpleClosure(function(e){
ZmOperation.addDeferredMenu(ZmCalendarApp.addCalViewMenu,e)
}
));
ZmOperation.registerOp(ZmId.OP_DAY_VIEW,{
textKey:"viewDay",tooltipKey:"viewDayTooltip",image:"DayView",shortcut:ZmKeyMap.CAL_DAY_VIEW}
);
ZmOperation.registerOp(ZmId.OP_EDIT_REPLY_ACCEPT,{
textKey:"replyAccept",image:"Check"}
);
ZmOperation.registerOp(ZmId.OP_EDIT_REPLY_CANCEL);
ZmOperation.registerOp(ZmId.OP_EDIT_REPLY_TENTATIVE,{
textKey:"replyTentative",image:"QuestionMark"}
);
ZmOperation.registerOp(ZmId.OP_EDIT_REPLY_DECLINE,{
textKey:"replyDecline",image:"Cancel"}
);
ZmOperation.registerOp(ZmId.OP_INVITE_REPLY_ACCEPT,{
textKey:"editReply",image:"Check"}
);
ZmOperation.registerOp(ZmId.OP_INVITE_REPLY_DECLINE,{
textKey:"editReply",image:"Cancel"}
);
ZmOperation.registerOp(ZmId.OP_INVITE_REPLY_MENU,{
textKey:"editReply",image:"Reply"}
,ZmSetting.MAIL_ENABLED,AjxCallback.simpleClosure(function(e){
ZmOperation.addDeferredMenu(ZmCalendarApp.addInviteReplyMenu,e)
}
));
ZmOperation.registerOp(ZmId.OP_INVITE_REPLY_TENTATIVE,{
textKey:"editReply",image:"QuestionMark"}
);
ZmOperation.registerOp(ZmId.OP_MONTH_VIEW,{
textKey:"viewMonth",tooltipKey:"viewMonthTooltip",image:"MonthView",shortcut:ZmKeyMap.CAL_MONTH_VIEW}
);
ZmOperation.registerOp(ZmId.OP_MOUNT_CALENDAR,{
textKey:"mountCalendar",image:"GroupSchedule"}
);
ZmOperation.registerOp(ZmId.OP_NEW_ALLDAY_APPT,{
textKey:"newAllDayAppt",tooltipKey:"newAllDayApptTooltip",image:"NewAppointment"}
);
ZmOperation.registerOp(ZmId.OP_NEW_APPT,{
textKey:"newAppt",tooltipKey:"newApptTooltip",image:"NewAppointment",shortcut:ZmKeyMap.NEW_APPT}
);
ZmOperation.registerOp(ZmId.OP_NEW_CALENDAR,{
textKey:"newCalendar",image:"NewAppointment",tooltipKey:"newCalendarTooltip",shortcut:ZmKeyMap.NEW_CALENDAR}
);
ZmOperation.registerOp(ZmId.OP_REPLY_ACCEPT,{
textKey:"replyAccept",image:"Check"}
);
ZmOperation.registerOp(ZmId.OP_REPLY_ACCEPT_NOTIFY,{
textKey:"notifyOrganizerLabel",image:"Check"}
);
ZmOperation.registerOp(ZmId.OP_REPLY_ACCEPT_IGNORE,{
textKey:"dontNotifyOrganizerLabel",image:"Check"}
);
ZmOperation.registerOp(ZmId.OP_REPLY_CANCEL);
ZmOperation.registerOp(ZmId.OP_REPLY_DECLINE,{
textKey:"replyDecline",image:"Cancel"}
);
ZmOperation.registerOp(ZmId.OP_REPLY_DECLINE_NOTIFY,{
textKey:"notifyOrganizerLabel",image:"Cancel"}
);
ZmOperation.registerOp(ZmId.OP_REPLY_DECLINE_IGNORE,{
textKey:"dontNotifyOrganizerLabel",image:"Cancel"}
);
ZmOperation.registerOp(ZmId.OP_REPLY_MODIFY);
ZmOperation.registerOp(ZmId.OP_REPLY_NEW_TIME,{
textKey:"replyNewTime",image:"NewTime"}
);
ZmOperation.registerOp(ZmId.OP_REPLY_TENTATIVE,{
textKey:"replyTentative",image:"QuestionMark"}
);
ZmOperation.registerOp(ZmId.OP_REPLY_TENTATIVE_NOTIFY,{
textKey:"notifyOrganizerLabel",image:"QuestionMark"}
);
ZmOperation.registerOp(ZmId.OP_REPLY_TENTATIVE_IGNORE,{
textKey:"dontNotifyOrganizerLabel",image:"QuestionMark"}
);
ZmOperation.registerOp(ZmId.OP_SCHEDULE_VIEW,{
textKey:"viewSchedule",tooltipKey:"viewScheduleTooltip",image:"GroupSchedule",shortcut:ZmKeyMap.CAL_SCHEDULE_VIEW}
);
ZmOperation.registerOp(ZmId.OP_SEARCH_MAIL,{
textKey:"searchMail",image:"SearchMail"}
,ZmSetting.MAIL_ENABLED);
ZmOperation.registerOp(ZmId.OP_SHARE_CALENDAR,{
textKey:"shareCalendar",image:"CalendarFolder"}
);
ZmOperation.registerOp(ZmId.OP_TODAY,{
textKey:"today",tooltipKey:"todayTooltip",image:"Date",shortcut:ZmKeyMap.TODAY}
);
ZmOperation.registerOp(ZmId.OP_VIEW_APPOINTMENT,{
textKey:"viewAppointment",image:"Appointment"}
);
ZmOperation.registerOp(ZmId.OP_OPEN_APPT_INSTANCE,{
textKey:"openApptInstance",image:"Appointment"}
);
ZmOperation.registerOp(ZmId.OP_OPEN_APPT_SERIES,{
textKey:"openApptSeries",image:"Appointment"}
);
ZmOperation.registerOp(ZmId.OP_DELETE_APPT_INSTANCE,{
textKey:"deleteApptInstance",image:"Delete"}
);
ZmOperation.registerOp(ZmId.OP_DELETE_APPT_SERIES,{
textKey:"deleteApptSeries",image:"Delete"}
);
ZmOperation.registerOp(ZmId.OP_VIEW_APPT_INSTANCE,{
textKey:"apptInstance",image:"Appointment"}
);
ZmOperation.registerOp(ZmId.OP_VIEW_APPT_SERIES,{
textKey:"apptSeries",image:"Appointment"}
);
ZmOperation.registerOp(ZmId.OP_WEEK_VIEW,{
textKey:"viewWeek",tooltipKey:"viewWeekTooltip",image:"WeekView",shortcut:ZmKeyMap.CAL_WEEK_VIEW}
);
ZmOperation.registerOp(ZmId.OP_WORK_WEEK_VIEW,{
textKey:"viewWorkWeek",tooltipKey:"viewWorkWeekTooltip",image:"WorkWeekView",shortcut:ZmKeyMap.CAL_WORK_WEEK_VIEW}
);
ZmOperation.registerOp(ZmId.OP_FORWARD_APPT,{
textKey:"forward",tooltipKey:"forward",image:"Forward"}
);
ZmOperation.registerOp(ZmId.OP_FORWARD_APPT_INSTANCE,{
textKey:"forwardInstance",tooltipKey:"forwardInstance",image:"Forward"}
);
ZmOperation.registerOp(ZmId.OP_FORWARD_APPT_SERIES,{
textKey:"forwardSeries",tooltipKey:"forwardSeries",image:"Forward"}
)
};
ZmCalendarApp.prototype._registerItems=function(){
ZmItem.registerItem(ZmItem.APPT,{
app:ZmApp.CALENDAR,nameKey:"appointment",icon:"Appointment",soapCmd:"ItemAction",itemClass:"ZmAppt",node:"appt",organizer:ZmOrganizer.CALENDAR,dropTargets:[ZmOrganizer.TAG,ZmOrganizer.CALENDAR],searchType:"appointment",resultsList:AjxCallback.simpleClosure(function(e){
AjxDispatcher.require("CalendarCore");
return new ZmApptList(ZmItem.APPT,e)
}
,this)}
);
ZmItem.registerItem(ZmItem.RESOURCE,{
app:ZmApp.CALENDAR,itemClass:"ZmResource",node:"calResource",resultsList:AjxCallback.simpleClosure(function(e){
AjxDispatcher.require("CalendarCore");
return new ZmResourceList(null,e)
}
,this)}
)
};
ZmCalendarApp.prototype._registerOrganizers=function(){
ZmOrganizer.registerOrg(ZmOrganizer.CALENDAR,{
app:ZmApp.CALENDAR,nameKey:"calendar",defaultFolder:ZmOrganizer.ID_CALENDAR,soapCmd:"FolderAction",firstUserId:256,orgClass:"ZmCalendar",orgPackage:"CalendarCore",treeController:"ZmCalendarTreeController",labelKey:"calendars",itemsKey:"appointments",hasColor:true,treeType:ZmOrganizer.FOLDER,views:["appointment"],folderKey:"calendar",mountKey:"mountCalendar",createFunc:"ZmCalendar.create",compareFunc:"ZmCalendar.sortCompare",newOp:ZmOperation.NEW_CALENDAR,displayOrder:100,deferrable:true}
)
};
ZmCalendarApp.prototype._setupSearchToolbar=function(){
ZmSearchToolBar.addMenuItem(ZmItem.APPT,{
msgKey:"appointments",tooltipKey:"searchAppts",icon:"Appointment",shareIcon:"SharedCalendarFolder",setting:ZmSetting.CALENDAR_ENABLED,id:ZmId.getMenuItemId(ZmId.SEARCH,ZmId.ITEM_APPOINTMENT)}
)
};
ZmCalendarApp.prototype._registerApp=function(){
var a={};
a[ZmOperation.NEW_APPT]="appointment";
var t={};
t[ZmOperation.NEW_CALENDAR]="calendar";
var e={};
e[ZmKeyMap.NEW_APPT]=ZmOperation.NEW_APPT;
e[ZmKeyMap.NEW_CALENDAR]=ZmOperation.NEW_CALENDAR;
ZmApp.registerApp(ZmApp.CALENDAR,{
mainPkg:"Calendar",nameKey:"calendar",icon:"CalendarApp",textPrecedence:60,chooserTooltipKey:"goToCalendar",viewTooltipKey:"displayCalendar",defaultSearch:ZmItem.APPT,organizer:ZmOrganizer.CALENDAR,overviewTrees:[ZmOrganizer.CALENDAR,ZmOrganizer.SEARCH,ZmOrganizer.TAG],assistants:{
ZmAppointmentAssistant:["CalendarCore","Calendar","CalendarAppt"],ZmCalendarAssistant:["CalendarCore","Calendar","CalendarAppt"]}
,newItemOps:a,newOrgOps:t,actionCodes:e,searchTypes:[ZmItem.APPT],gotoActionCode:ZmKeyMap.GOTO_CALENDAR,newActionCode:ZmKeyMap.NEW_APPT,chooserSort:30,defaultSort:20,upsellUrl:ZmSetting.CALENDAR_UPSELL_URL}
)
};
ZmCalendarApp.prototype.startup=function(e){};
ZmCalendarApp.prototype.refresh=function(e){
if(!appCtxt.inStartup){
AjxDispatcher.run("GetCalController").refreshHandler(e)
}};
ZmCalendarApp.prototype.deleteNotify=function(e,t){
if(!t&&this._deferNotifications("delete",e)){
return
}
AjxDispatcher.run("GetCalController").notifyDelete(e)
};
ZmCalendarApp.prototype.createNotify=function(o,s){
if(!o.folder&&!o.appt&&!o.link){
return
}
if(!s&&!this._noDefer&&this._deferNotifications("create",o)){
return
}
for(var e in o){
var n=o[e];
for(var a=0;
a<n.length;
a++){
var t=n[a];
if(appCtxt.cacheGet(t.id)){
continue
}
if(e=="folder"){
this._handleCreateFolder(t,ZmOrganizer.CALENDAR)
}else{
if(e=="link"){
this._handleCreateLink(t,ZmOrganizer.CALENDAR)
}else{
if(e=="appt"){
AjxDispatcher.run("GetCalController").notifyCreate(t)
}}}
if((e=="folder"||e=="link")&&this._calController){
this._calController._updateCheckedCalendars()
}}}};
ZmCalendarApp.prototype.modifyNotify=function(t,e){
if(!e&&!this._noDefer&&this._deferNotifications("modify",t)){
return
}
AjxDispatcher.run("GetCalController").notifyModify(t)
};
ZmCalendarApp.prototype.postNotify=function(e){
if(this._calController!=null){
this._calController.notifyComplete()
}};
ZmCalendarApp.prototype.handleOp=function(t){
switch(t){
case ZmOperation.NEW_APPT:var e=new AjxCallback(this,this._handleLoadNewAppt);
AjxDispatcher.require(["CalendarCore","Calendar"],false,e,null,true);
break;
case ZmOperation.NEW_CALENDAR:var e=new AjxCallback(this,this._handleLoadNewCalendar);
AjxDispatcher.require(["CalendarCore","Calendar"],false,e,null,true);
break
}};
ZmCalendarApp.prototype._handleLoadNewAppt=function(){
AjxDispatcher.run("GetCalController").newAppointment(null,null,null,null)
};
ZmCalendarApp.prototype._handleLoadNewCalendar=function(){
appCtxt.getAppViewMgr().popView(true,ZmId.VIEW_LOADING);
var e=appCtxt.getNewCalendarDialog();
if(!this._newCalendarCb){
this._newCalendarCb=new AjxCallback(this,this._newCalendarCallback)
}
ZmController.showDialog(e,this._newCalendarCb)
};
ZmCalendarApp.prototype.launch=function(t,a){
var e=new AjxCallback(this,this._handleLoadLaunch,[t,a]);
AjxDispatcher.require(["CalendarCore","Calendar"],true,e,null,true)
};
ZmCalendarApp.prototype._handleLoadLaunch=function(s,h){
var r=AjxDispatcher.run("GetCalController");
var t=r._defaultView();
var n=null;
s=s||{};
if(s.qsParams){
var o=s.qsParams.view;
if(o){
var e=ZmCalendarApp.VIEW_FOR_SETTING[o];
if(e){
t=e;
var a=s.qsParams.date;
if(a){
a=AjxDateUtil.parseServerDateTime(a);
if(a&&!isNaN(a)){
n=new Date((a).setHours(0,0,0,0))
}}}}}
if(appCtxt.get(ZmSetting.CONTACTS_ENABLED)){
this.initResources()
}
r.show(t,n);
if(h){
h.run()
}};
ZmCalendarApp.prototype.showSearchResults=function(t,o,a,e){
if(o){
o.run()
}};
ZmCalendarApp.prototype.activate=function(t){
ZmApp.prototype.activate.apply(this,arguments);
if(appCtxt.get(ZmSetting.CALENDAR_ENABLED)){
var e=t||appCtxt.get(ZmSetting.CAL_ALWAYS_SHOW_MINI_CAL);
AjxDispatcher.run("ShowMiniCalendar",e)
}};
ZmCalendarApp.prototype.showMiniCalendar=function(e,t){
var a=AjxDispatcher.run("GetCalController").getMiniCalendar(t);
a.setSkipNotifyOnPage(e&&!this._active);
if(!this._active){
a.setSelectionMode(DwtCalendar.DAY)
}
appCtxt.getAppViewMgr().showTreeFooter(e)
};
ZmCalendarApp.prototype.getListController=function(){
return this.getCalController()
};
ZmCalendarApp.prototype.getCalController=function(){
if(!this._calController){
AjxDispatcher.require("CalendarCore");
this._calController=new ZmCalViewController(this._container,this)
}
return this._calController
};
ZmCalendarApp.prototype.getReminderController=function(){
if(!this._reminderController){
AjxDispatcher.require("CalendarCore");
var e=appCtxt.getCalManager();
this._reminderController=e.getReminderController();
this._reminderController._calController=this.getCalController()
}
return this._reminderController
};
ZmCalendarApp.prototype.getApptComposeController=function(){
if(!this._apptController){
AjxDispatcher.require(["CalendarCore","Calendar","CalendarAppt"]);
this._apptController=new ZmApptComposeController(this._container,this)
}
return this._apptController
};
ZmCalendarApp.prototype.initResources=function(){
if(!this._locations){
this._locations=new ZmResourceList(ZmCalBaseItem.LOCATION);
this._locations.isCanonical=true
}
if(!this._equipment){
this._equipment=new ZmResourceList(ZmCalBaseItem.EQUIPMENT);
this._equipment.isCanonical=true
}};
ZmCalendarApp.prototype.loadResources=function(){
this.initResources();
if(appCtxt.get(ZmSetting.GAL_ENABLED)){
var e=new ZmBatchCommand();
if(!this._locations.isLoaded){
e.add(new AjxCallback(this._locations,this._locations.load))
}
if(!this._equipment.isLoaded){
e.add(new AjxCallback(this._equipment,this._equipment.load))
}
if(e._cmds.length){
e.run()
}}};
ZmCalendarApp.prototype.getLocations=function(){
this.initResources();
return this._locations
};
ZmCalendarApp.prototype.getEquipment=function(){
this.initResources();
return this._equipment
};
ZmCalendarApp.prototype._setMiniCalForActiveAccount=function(){};
ZmCalendarApp.prototype.getCheckedCalendarFolderIds=function(e){
var n=[];
if(AjxDispatcher.loaded("CalendarCore")){
n=this.getCalController().getCheckedCalendarFolderIds(e)
}else{
this._folderNames={};
for(var t=0;
t<this._deferredFolders.length;
t++){
var o=this._deferredFolders[t];
var a=(o&&o.obj&&o.obj.f)?o.obj.f:"";
if(a&&(a.indexOf(ZmOrganizer.FLAG_CHECKED)!=-1)){
if(e&&(o.obj.zid!=null)){
continue
}
n.push(o.obj.id);
this._folderNames[o.obj.id]=o.obj.name
}}}
return n
};
ZmCalendarApp.prototype.getCalendarName=function(e){
return appCtxt.getById(e)?appCtxt.getById(e).name:this._folderNames[e]
};
ZmCalendarApp.createMiniCalButton=function(c,s,n,t){
var h=new DwtButton({
parent:c}
);
h.addDropDownSelectionListener(n);
h.setData(Dwt.KEY_ID,s);
if(AjxEnv.isIE){
h.setSize("20")
}
var r=new DwtMenu({
parent:h,style:DwtMenu.CALENDAR_PICKER_STYLE}
);
r.setSize("150");
r._table.width="100%";
h.setMenu(r,true);
var e=new DwtCalendar({
parent:r}
);
e.setData(Dwt.KEY_ID,s);
e.setSkipNotifyOnPage(true);
var o=appCtxt.get(ZmSetting.CAL_FIRST_DAY_OF_WEEK)||0;
e.setFirstDayOfWeek(o);
e.addSelectionListener(t);
var l=appCtxt.getSettings().getSetting(ZmSetting.CAL_FIRST_DAY_OF_WEEK);
if(l){
var a=new AjxListener(null,ZmCalendarApp._settingChangeListener,e);
l.addChangeListener(a)
}
h.reparentHtmlElement(s);
delete s;
return h
};
ZmCalendarApp.createReminderButton=function(c,r,u,n){
var h=new DwtButton({
parent:c}
);
h.addDropDownSelectionListener(u);
h.setData(Dwt.KEY_ID,r);
if(AjxEnv.isIE){
h.setSize("20")
}
var l=new DwtMenu({
parent:h,style:DwtMenu.DROPDOWN_STYLE}
);
l.setSize("150");
l._table.width="100%";
h.setMenu(l,true);
var t=[ZmMsg.apptRemindNever,ZmMsg.apptRemindNMinutesBefore,ZmMsg.apptRemindNMinutesBefore,ZmMsg.apptRemindNMinutesBefore,ZmMsg.apptRemindNMinutesBefore,ZmMsg.apptRemindNMinutesBefore,ZmMsg.apptRemindNMinutesBefore,ZmMsg.apptRemindNMinutesBefore,ZmMsg.apptRemindNHoursBefore,ZmMsg.apptRemindNHoursBefore,ZmMsg.apptRemindNHoursBefore,ZmMsg.apptRemindNHoursBefore,ZmMsg.apptRemindNHoursBefore,ZmMsg.apptRemindNDaysBefore,ZmMsg.apptRemindNDaysBefore,ZmMsg.apptRemindNDaysBefore,ZmMsg.apptRemindNDaysBefore,ZmMsg.apptRemindNWeeksBefore,ZmMsg.apptRemindNWeeksBefore];
var m=[0,1,5,10,15,30,45,60,120,180,240,300,1080,1440,2880,4320,5760,10080,20160];
var o=[0,1,5,10,15,30,45,60,2,3,4,5,18,1,2,3,4,1,2];
var s=appCtxt.get(ZmSetting.CAL_REMINDER_WARNING_TIME);
for(var e=0;
e<m.length;
e++){
var d=ZmCalendarApp.__formatLabel(t[e],o[e]);
var a=new DwtMenuItem({
parent:l,style:DwtMenuItem.NO_STYLE}
);
a.setText(d);
a.setData("value",m[e]);
if(n){
a.addSelectionListener(n)
}}
h.reparentHtmlElement(r);
delete r;
return h
};
ZmCalendarApp.getReminderSummary=function(e){
var o=((e%60)==0);
var a=((e%(60*24))==0);
var t=((e%(60*24*7))==0);
if(e==0){
return ZmMsg.apptRemindNever
}else{
if(t){
return ZmCalendarApp.__formatLabel(ZmMsg.apptRemindNWeeksBefore,e/(60*24*7))
}else{
if(a){
return ZmCalendarApp.__formatLabel(ZmMsg.apptRemindNDaysBefore,e/(60*24))
}else{
if(o){
return ZmCalendarApp.__formatLabel(ZmMsg.apptRemindNHoursBefore,e/60)
}else{
return ZmCalendarApp.__formatLabel(ZmMsg.apptRemindNMinutesBefore,e)
}}}}};
ZmCalendarApp._settingChangeListener=function(a,t){
if(t.type!=ZmEvent.S_SETTING){
return
}
var e=t.source;
if(e.id==ZmSetting.CAL_FIRST_DAY_OF_WEEK){
a.setFirstDayOfWeek(e.getValue())
}};
ZmCalendarApp.prototype._newCalendarCallback=function(s,o,t,a,r){
var n=appCtxt.getNewCalendarDialog();
n.popdown();
var e=appCtxt.getOverviewController();
e.getTreeController(ZmOrganizer.CALENDAR)._doCreate(s,o,t,a,r)
};
ZmCalendarApp.addInviteReplyMenu=function(e){
var t=[ZmOperation.EDIT_REPLY_ACCEPT,ZmOperation.EDIT_REPLY_TENTATIVE,ZmOperation.EDIT_REPLY_DECLINE];
var a=new ZmActionMenu({
parent:e,menuItems:t}
);
e.setMenu(a);
return a
};
ZmCalendarApp.addCalViewMenu=function(e){
var t=[ZmOperation.DAY_VIEW,ZmOperation.WORK_WEEK_VIEW,ZmOperation.WEEK_VIEW,ZmOperation.MONTH_VIEW,ZmOperation.CAL_LIST_VIEW,ZmOperation.SCHEDULE_VIEW];
var a=new ZmActionMenu({
parent:e,menuItems:t}
);
e.setMenu(a);
return a
};
ZmCalendarApp.__formatLabel=function(t,e){
t=t||"";
return t.match(/\{/)?AjxMessageFormat.format(t,e):t
};
ZmCalendarApp.parseReminderString=function(c){
var h={};
h[ZmMsg.apptRemindNDaysBefore]=ZmCalItem.REMINDER_UNIT_DAYS;
h[ZmMsg.apptRemindNMinutesBefore]=ZmCalItem.REMINDER_UNIT_MINUTES;
h[ZmMsg.apptRemindNHoursBefore]=ZmCalItem.REMINDER_UNIT_HOURS;
h[ZmMsg.apptRemindNWeeksBefore]=ZmCalItem.REMINDER_UNIT_WEEKS;
c=AjxStringUtil.trim(c);
var l=c;
var s=l.replace(/\D/g,"");
s=AjxStringUtil.trim(s);
if(s==""){
return{
reminderValue:"",reminderUnits:ZmCalItem.REMINDER_NONE}
}else{
if(s.indexOf(" ")>=0){
s=s.split(" ")[0]
}}
for(var r in h){
var e=ZmCalendarApp.__formatLabel(r,s);
if(e!=""&&e.toLowerCase()==c.toLowerCase()){
return{
reminderValue:s,reminderUnits:h[r]}
}}
var n=parseInt(s);
var a={};
a[ZmCalItem.REMINDER_UNIT_MINUTES]=AjxMsg.minute;
a[ZmCalItem.REMINDER_UNIT_HOURS]=AjxMsg.hour;
a[ZmCalItem.REMINDER_UNIT_DAYS]=AjxMsg.day;
a[ZmCalItem.REMINDER_UNIT_WEEKS]=AjxMsg.week;
var t=ZmCalItem.REMINDER_UNIT_HOURS;
for(var o in a){
if(l.indexOf(a[o])>=0){
t=o;
break
}}
return{
reminderValue:n?n:0,reminderUnits:t}
};
ZmCalendarApp.convertReminderUnits=function(e,t){
switch(t){
case ZmCalItem.REMINDER_UNIT_MINUTES:return e;
case ZmCalItem.REMINDER_UNIT_HOURS:return e*60;
case ZmCalItem.REMINDER_UNIT_DAYS:return e*60*24;
case ZmCalItem.REMINDER_UNIT_WEEKS:return e*60*24*7;
default:return 0
}};
ZmCalendarApp.prototype.updateResourceCache=function(a){
var t=a.getFullName();
if(t){
this._resByName[t.toLowerCase()]=a
}
var e=a.getEmail();
if(e){
this._resByEmail[e.toLowerCase()]=a
}};
ZmCalendarApp.prototype._addSettingsChangeListeners=function(){
ZmApp.prototype._addSettingsChangeListeners.call(this);
if(!this._settingsListener){
this._settingsListener=new AjxListener(this,this._settingsChangeListener)
}
var e=appCtxt.getSettings();
e.getSetting(ZmSetting.CAL_SHOW_CALENDAR_WEEK).addChangeListener(this._settingListener);
e.addChangeListener(this._settingsListener)
};
ZmCalendarApp.prototype._settingsChangeListener=function(o){
if(o.type!=ZmEvent.S_SETTINGS){
return
}
var n=o.getDetail("settings");
if(!(n&&n.length)){
return
}
for(var t=0;
t<n.length;
t++){
var a=n[t];
if(a.id==ZmSetting.CAL_SHOW_CALENDAR_WEEK){
var e=AjxDispatcher.run("GetCalController").recreateMiniCalendar();
var s=appCtxt.getCalManager();
s.highlightMiniCal()
}}};
ZmCalendarApp.prototype.showDayView=function(a){
var t=AjxDispatcher.run("GetCalController");
var e=t.getMiniCalendar();
t.setDate(a,0,e.getForceRollOver());
if(!t._viewVisible){
t.show(ZmId.VIEW_CAL_DAY)
}};
ZmCalendarApp.prototype.getDateToolTip=function(e){
var t=AjxDispatcher.run("GetCalController");
return t.getDayToolTipText(e)
}
}
if(AjxPackage.define("zimbraMail.tasks.ZmTasksApp")){
ZmTasksApp=function(e){
ZmApp.call(this,ZmApp.TASKS,e)
};
ZmEvent.S_TASK=ZmId.ITEM_TASK;
ZmItem.TASK=ZmEvent.S_TASK;
ZmOrganizer.TASKS=ZmEvent.S_TASK;
ZmApp.TASKS=ZmId.APP_TASKS;
ZmApp.CLASS[ZmApp.TASKS]="ZmTasksApp";
ZmApp.SETTING[ZmApp.TASKS]=ZmSetting.TASKS_ENABLED;
ZmApp.LOAD_SORT[ZmApp.TASKS]=45;
ZmApp.QS_ARG[ZmApp.TASKS]="tasks";
ZmTasksApp.prototype=new ZmApp;
ZmTasksApp.prototype.constructor=ZmTasksApp;
ZmTasksApp.prototype.toString=function(){
return"ZmTasksApp"
};
ZmTasksApp.prototype._defineAPI=function(){
AjxDispatcher.setPackageLoadFunction("TasksCore",new AjxCallback(this,this._postLoadCore));
AjxDispatcher.setPackageLoadFunction("Tasks",new AjxCallback(this,this._postLoad,ZmOrganizer.TASKS));
AjxDispatcher.registerMethod("GetTaskListController",["TasksCore","Tasks"],new AjxCallback(this,this.getTaskListController));
AjxDispatcher.registerMethod("GetTaskController",["TasksCore","Tasks"],new AjxCallback(this,this.getTaskController))
};
ZmTasksApp.prototype._registerOperations=function(){
ZmOperation.registerOp(ZmId.OP_MOUNT_TASK_FOLDER,{
textKey:"mountTaskFolder",image:"TaskList"}
);
ZmOperation.registerOp(ZmId.OP_NEW_TASK,{
textKey:"newTask",tooltipKey:"newTaskTooltip",image:"NewTask",shortcut:ZmKeyMap.NEW_TASK}
);
ZmOperation.registerOp(ZmId.OP_NEW_TASK_FOLDER,{
textKey:"newTaskFolder",tooltipKey:"newTaskFolderTooltip",image:"NewTaskList"}
);
ZmOperation.registerOp(ZmId.OP_SHARE_TASKFOLDER,{
textKey:"shareTaskFolder",image:"TaskList"}
);
ZmOperation.registerOp(ZmId.OP_PRINT_TASK,{
textKey:"printTask",image:"Print",shortcut:ZmKeyMap.PRINT}
,ZmSetting.PRINT_ENABLED);
ZmOperation.registerOp(ZmId.OP_PRINT_TASKFOLDER,{
textKey:"printTaskFolder",image:"Print"}
,ZmSetting.PRINT_ENABLED)
};
ZmTasksApp.prototype._registerItems=function(){
ZmItem.registerItem(ZmItem.TASK,{
app:ZmApp.TASKS,nameKey:"task",pluralNameKey:"tasks",icon:"TaskList",soapCmd:"ItemAction",itemClass:"ZmTask",node:"task",organizer:ZmOrganizer.TASKS,dropTargets:[ZmOrganizer.TAG,ZmOrganizer.TASKS],searchType:"task",resultsList:AjxCallback.simpleClosure(function(e){
AjxDispatcher.require("TasksCore");
return new ZmTaskList(e)
}
,this)}
)
};
ZmTasksApp.prototype._registerOrganizers=function(){
ZmOrganizer.registerOrg(ZmOrganizer.TASKS,{
app:ZmApp.TASKS,nameKey:"taskFolder",defaultFolder:ZmFolder.ID_TASKS,soapCmd:"FolderAction",firstUserId:256,orgClass:"ZmTaskFolder",orgPackage:"TasksCore",treeController:"ZmTaskTreeController",labelKey:"tasks",itemsKey:"tasks",folderKey:"tasksFolder",hasColor:true,defaultColor:ZmOrganizer.C_NONE,treeType:ZmOrganizer.FOLDER,views:["task"],createFunc:"ZmOrganizer.create",compareFunc:"ZmTaskFolder.sortCompare",deferrable:true,newOp:ZmOperation.NEW_TASK_FOLDER,displayOrder:100,pathInName:true}
)
};
ZmTasksApp.prototype._setupSearchToolbar=function(){
ZmSearchToolBar.addMenuItem(ZmItem.TASK,{
msgKey:"tasks",tooltipKey:"searchTasks",icon:"TaskList",shareIcon:"SharedTaskList",setting:ZmSetting.TASKS_ENABLED,id:ZmId.getMenuItemId(ZmId.SEARCH,ZmId.ITEM_TASK)}
)
};
ZmTasksApp.prototype._registerApp=function(){
var a={};
a[ZmOperation.NEW_TASK]="task";
var t={};
t[ZmOperation.NEW_TASK_FOLDER]="tasksFolder";
var e={};
e[ZmKeyMap.NEW_TASK]=ZmOperation.NEW_TASK;
ZmApp.registerApp(ZmApp.TASKS,{
mainPkg:"Tasks",nameKey:"tasks",icon:"TaskList",textPrecedence:20,chooserTooltipKey:"goToTasks",defaultSearch:ZmItem.TASK,organizer:ZmOrganizer.TASKS,overviewTrees:[ZmOrganizer.TASKS,ZmOrganizer.SEARCH,ZmOrganizer.TAG],assistants:{
ZmTaskAssistant:["TasksCore","Tasks"]}
,newItemOps:a,newOrgOps:t,actionCodes:e,searchTypes:[ZmItem.TASK],gotoActionCode:ZmKeyMap.GOTO_TASKS,newActionCode:ZmKeyMap.NEW_TASK,chooserSort:35,defaultSort:25}
)
};
ZmTasksApp.prototype.postNotify=function(e){
if(this._checkReplenishListView){
this._checkReplenishListView._checkReplenish();
this._checkReplenishListView=null
}};
ZmTasksApp.prototype.handleOp=function(a,t){
switch(a){
case ZmOperation.NEW_TASK:var e=new AjxCallback(this,this._handleLoadNewTask,[t]);
AjxDispatcher.require(["TasksCore","Tasks"],false,e,null,true);
break;
case ZmOperation.NEW_TASK_FOLDER:var e=new AjxCallback(this,this._handleLoadNewTaskFolder);
AjxDispatcher.require(["TasksCore","Tasks"],false,e,null,true);
break
}};
ZmTasksApp.prototype._handleLoadNewTask=function(t){
var e=t?t.folderId:null;
AjxDispatcher.run("GetTaskController").show((new ZmTask(null,null,e)))
};
ZmTasksApp.prototype._handleLoadNewTaskFolder=function(){
appCtxt.getAppViewMgr().popView(true,ZmId.VIEW_LOADING);
var e=appCtxt.getNewTaskFolderDialog();
if(!this._newTaskFolderCb){
this._newTaskFolderCb=new AjxCallback(this,this._newTaskFolderCallback)
}
ZmController.showDialog(e,this._newTaskFolderCb)
};
ZmTasksApp.prototype.createNotify=function(n,r){
if(!n.folder&&!n.task&&!n.link){
return
}
if(!r&&this._deferNotifications("create",n)){
return
}
for(var e in n){
var s=n[e];
if(!s){
continue
}
for(var o=0;
o<s.length;
o++){
var a=s[o];
if(appCtxt.cacheGet(a.id)){
continue
}
if(e=="folder"){
this._handleCreateFolder(a,ZmOrganizer.TASKS)
}else{
if(e=="link"){
this._handleCreateLink(a,ZmOrganizer.TASKS)
}else{
if(e=="task"){
var t=this.getTaskListController().getList();
if(t){
t.notifyCreate(a)
}}}}}}};
ZmTasksApp.prototype.launch=function(t,a){
var e=new AjxCallback(this,this._handleLoadLaunch,a);
AjxDispatcher.require(["TasksCore","Tasks"],true,e,null,true)
};
ZmTasksApp.prototype._handleLoadLaunch=function(e){
this.search();
if(e){
e.run()
}};
ZmTasksApp.prototype.showSearchResults=function(a,n,o,t){
var e=new AjxCallback(this,this._handleLoadShowSearchResults,[a,n,t]);
AjxDispatcher.require("Tasks",false,e,null,true)
};
ZmTasksApp.prototype._handleLoadShowSearchResults=function(t,a,e){
this.getTaskListController().show(t,e);
if(a){
a.run()
}};
ZmTasksApp.prototype.getListController=function(){
return this.getTaskListController()
};
ZmTasksApp.prototype.getTaskListController=function(){
if(!this._taskListController){
this._taskListController=new ZmTaskListController(this._container,this)
}
return this._taskListController
};
ZmTasksApp.prototype.getTaskController=function(){
if(!this._taskController){
this._taskController=new ZmTaskController(this._container,this)
}
return this._taskController
};
ZmTasksApp.prototype.newTaskFromMailItem=function(a,e){
var t=a.subject||"";
if(a instanceof ZmConv){
a=a.getFirstHotMsg()
}
a.load({
getHtml:false,callback:new AjxCallback(this,this._msgLoadedCallback,[a,e,t])}
)
};
ZmTasksApp.prototype._msgLoadedCallback=function(n,e,o){
var a=new ZmTask();
a.setStartDate(AjxDateUtil.roundTimeMins(e,30));
a.setFromMailMessage(n,o);
this.getTaskController().show(a,ZmCalItem.MODE_NEW)
};
ZmTasksApp.prototype.search=function(t,e,a,n){
var o={
query:(t?t.createQuery():"in:tasks"),types:[ZmItem.TASK],limit:this.getLimit(),searchFor:ZmItem.TASK,callback:n,accountName:(t&&t.account&&t.account.name)};
appCtxt.getSearchController().search(o)
};
ZmTasksApp.prototype._newTaskFolderCallback=function(n,a,t){
var o=appCtxt.getNewTaskFolderDialog();
o.popdown();
var e=appCtxt.getOverviewController();
e.getTreeController(ZmOrganizer.TASKS)._doCreate(n,a,t)
}
}
if(AjxPackage.define("zimbraMail.abook.ZmContactsApp")){
ZmContactsApp=function(t,e){
ZmApp.call(this,ZmApp.CONTACTS,t,e);
var a=appCtxt.getSettings();
a.addChangeListener(new AjxListener(this,this._settingsChangeListener));
this.contactsLoaded={};
this._contactList={};
this._initialized=false;
this._byEmail={};
this._byIM={};
this._byPhone={}
};
ZmEvent.S_CONTACT=ZmId.ITEM_CONTACT;
ZmEvent.S_GROUP=ZmId.ITEM_GROUP;
ZmItem.CONTACT=ZmEvent.S_CONTACT;
ZmItem.GROUP=ZmEvent.S_GROUP;
ZmOrganizer.ADDRBOOK=ZmId.ORG_ADDRBOOK;
ZmApp.CONTACTS=ZmId.APP_CONTACTS;
ZmApp.CLASS[ZmApp.CONTACTS]="ZmContactsApp";
ZmApp.SETTING[ZmApp.CONTACTS]=ZmSetting.CONTACTS_ENABLED;
ZmApp.UPSELL_SETTING[ZmApp.CONTACTS]=ZmSetting.CONTACTS_UPSELL_ENABLED;
ZmApp.LOAD_SORT[ZmApp.CONTACTS]=30;
ZmApp.QS_ARG[ZmApp.CONTACTS]="contacts";
ZmContactsApp.SEARCHFOR_CONTACTS=1;
ZmContactsApp.SEARCHFOR_GAL=2;
ZmContactsApp.SEARCHFOR_PAS=3;
ZmContactsApp.SEARCHFOR_MAX=50;
ZmContactsApp.prototype=new ZmApp;
ZmContactsApp.prototype.constructor=ZmContactsApp;
ZmContactsApp.prototype.toString=function(){
return"ZmContactsApp"
};
ZmContactsApp.prototype._defineAPI=function(){
AjxDispatcher.setPackageLoadFunction("ContactsCore",new AjxCallback(this,this._postLoadCore));
AjxDispatcher.setPackageLoadFunction("Contacts",new AjxCallback(this,this._postLoad,ZmOrganizer.ADDRBOOK));
AjxDispatcher.registerMethod("GetContacts","ContactsCore",new AjxCallback(this,this.getContactList));
AjxDispatcher.registerMethod("GetContactsForAllAccounts","ContactsCore",new AjxCallback(this,this.getContactListForAllAccounts));
AjxDispatcher.registerMethod("GetContactListController",["ContactsCore","Contacts"],new AjxCallback(this,this.getContactListController));
AjxDispatcher.registerMethod("GetContactController",["ContactsCore","Contacts"],new AjxCallback(this,this.getContactController))
};
ZmContactsApp.prototype._registerSettings=function(e){
var e=e||appCtxt.getSettings();
e.registerSetting("AUTO_ADD_ADDRESS",{
name:"zimbraPrefAutoAddAddressEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("AUTOCOMPLETE_LIMIT",{
name:"zimbraContactAutoCompleteMaxResults",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:20}
);
e.registerSetting("AUTOCOMPLETE_SHARE",{
name:"zimbraPrefShareContactsInAutoComplete",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("AUTOCOMPLETE_SHARED_ADDR_BOOKS",{
name:"zimbraPrefSharedAddrBookAutoCompleteEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("CONTACTS_VIEW",{
name:"zimbraPrefContactsInitialView",type:ZmSetting.T_PREF,defaultValue:ZmSetting.CV_LIST,isGlobal:true}
);
e.registerSetting("EXPORT",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_NONE}
);
e.registerSetting("GAL_AUTOCOMPLETE",{
name:"zimbraPrefGalAutoCompleteEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("IMPORT",{
type:ZmSetting.T_PREF,dataType:ZmSetting.D_NONE}
);
e.registerSetting("MAX_CONTACTS",{
name:"zimbraContactMaxNumEntries",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:0}
);
e.registerSetting("NEW_ADDR_BOOK_ENABLED",{
name:"zimbraFeatureNewAddrBookEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
)
};
ZmContactsApp.prototype._registerPrefs=function(){
var t={
CONTACTS:{
title:ZmMsg.addressBook,icon:"ContactsApp",templateId:"prefs.Pages#Contacts",priority:50,precondition:ZmSetting.CONTACTS_ENABLED,prefs:[ZmSetting.AUTO_ADD_ADDRESS,ZmSetting.AUTOCOMPLETE_SHARE,ZmSetting.AUTOCOMPLETE_SHARED_ADDR_BOOKS,ZmSetting.CONTACTS_VIEW,ZmSetting.EXPORT,ZmSetting.GAL_AUTOCOMPLETE,ZmSetting.INITIALLY_SEARCH_GAL,ZmSetting.IMPORT]}};
for(var e in t){
ZmPref.registerPrefSection(e,t[e])
}
ZmPref.registerPref("AUTO_ADD_ADDRESS",{
displayName:ZmMsg.autoAddContacts,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("AUTOCOMPLETE_SHARE",{
displayName:ZmMsg.autocompleteShare,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("AUTOCOMPLETE_SHARED_ADDR_BOOKS",{
displayName:ZmMsg.autocompleteSharedAddrBooks,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("CONTACTS_VIEW",{
displayName:ZmMsg.viewContacts,displayContainer:ZmPref.TYPE_SELECT,displayOptions:[ZmMsg.detailedCards,ZmMsg.contactList],options:[ZmSetting.CV_CARDS,ZmSetting.CV_LIST]}
);
ZmPref.registerPref("EXPORT",{
loadFunction:ZmPref.loadCsvFormats,displayContainer:ZmPref.TYPE_EXPORT}
);
ZmPref.registerPref("GAL_AUTOCOMPLETE",{
displayName:ZmMsg.galAutocomplete,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:function(){
return appCtxt.get(ZmSetting.GAL_AUTOCOMPLETE_ENABLED)&&appCtxt.get(ZmSetting.GAL_ENABLED)
}}
);
ZmPref.registerPref("IMPORT",{
displayName:ZmMsg.importFromCSV,displayContainer:ZmPref.TYPE_IMPORT}
);
ZmPref.registerPref("INITIALLY_SEARCH_GAL",{
displayName:ZmMsg.initiallySearchGal,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:function(){
return appCtxt.get(ZmSetting.GAL_ENABLED)&&appCtxt.getActiveAccount().isZimbraAccount
}}
)
};
ZmContactsApp.prototype._registerOperations=function(){
ZmOperation.registerOp(ZmId.OP_CONTACT);
ZmOperation.registerOp(ZmId.OP_EDIT_CONTACT,{
textKey:"AB_EDIT_CONTACT",image:"Edit",shortcut:ZmKeyMap.EDIT}
);
ZmOperation.registerOp(ZmId.OP_MOUNT_ADDRBOOK,{
textKey:"mountAddrBook",image:"ContactsFolder"}
);
ZmOperation.registerOp(ZmId.OP_NEW_ADDRBOOK,{
textKey:"newAddrBook",tooltipKey:"newAddrBookTooltip",image:"NewContactsFolder"}
,ZmSetting.NEW_ADDR_BOOK_ENABLED);
ZmOperation.registerOp(ZmId.OP_NEW_CONTACT,{
textKey:"newContact",tooltipKey:"newContactTooltip",image:"NewContact",shortcut:ZmKeyMap.NEW_CONTACT}
,ZmSetting.CONTACTS_ENABLED);
ZmOperation.registerOp(ZmId.OP_NEW_GROUP,{
textKey:"newGroup",tooltipKey:"newGroupTooltip",image:"NewGroup"}
,ZmSetting.CONTACTS_ENABLED);
ZmOperation.registerOp(ZmId.OP_PRINT_CONTACT,{
textKey:"printContact",image:"Print",shortcut:ZmKeyMap.PRINT}
,ZmSetting.PRINT_ENABLED);
ZmOperation.registerOp(ZmId.OP_PRINT_ADDRBOOK,{
textKey:"printAddrBook",image:"Print"}
,ZmSetting.PRINT_ENABLED);
ZmOperation.registerOp(ZmId.OP_SHARE_ADDRBOOK,{
textKey:"shareAddrBook",image:"SharedContactsFolder"}
);
ZmOperation.registerOp(ZmId.OP_SHOW_ONLY_CONTACTS,{
textKey:"showOnlyContacts",image:"Contact"}
,ZmSetting.MIXED_VIEW_ENABLED)
};
ZmContactsApp.prototype._registerItems=function(){
ZmItem.registerItem(ZmItem.CONTACT,{
app:ZmApp.CONTACTS,nameKey:"contact",pluralNameKey:"contacts",icon:"Contact",soapCmd:"ContactAction",itemClass:"ZmContact",node:"cn",organizer:ZmOrganizer.ADDRBOOK,dropTargets:[ZmOrganizer.TAG,ZmOrganizer.ZIMLET,ZmOrganizer.ADDRBOOK],searchType:"contact",resultsList:AjxCallback.simpleClosure(function(e){
AjxDispatcher.require("ContactsCore");
return new ZmContactList(e,e?e.isGalSearch||e.isGalAutocompleteSearch:null)
}
,this)}
);
ZmItem.registerItem(ZmItem.GROUP,{
nameKey:"group",icon:"Group",soapCmd:"ContactAction"}
)
};
ZmContactsApp.prototype._registerOrganizers=function(){
var e={};
ZmOrganizer.registerOrg(ZmOrganizer.ADDRBOOK,{
app:ZmApp.CONTACTS,nameKey:"addressBook",defaultFolder:ZmOrganizer.ID_ADDRBOOK,soapCmd:"FolderAction",firstUserId:256,orgClass:"ZmAddrBook",orgPackage:"ContactsCore",treeController:"ZmAddrBookTreeController",labelKey:"addressBooks",itemsKey:"contacts",hasColor:true,defaultColor:ZmOrganizer.C_NONE,orgColor:e,treeType:ZmOrganizer.FOLDER,dropTargets:[ZmOrganizer.ADDRBOOK],views:["contact"],folderKey:"addressBook",mountKey:"mountAddrBook",createFunc:"ZmOrganizer.create",compareFunc:"ZmAddrBook.sortCompare",displayOrder:100,newOp:ZmOperation.NEW_ADDRBOOK,deferrable:true}
)
};
ZmContactsApp.prototype._setupSearchToolbar=function(){
ZmSearchToolBar.addMenuItem(ZmItem.CONTACT,{
msgKey:"searchContacts",tooltipKey:"searchPersonalContacts",icon:"ContactsFolder",shareIcon:"SharedContactsFolder",id:ZmId.getMenuItemId(ZmId.SEARCH,ZmId.ITEM_CONTACT)}
);
ZmSearchToolBar.addMenuItem(ZmId.SEARCH_GAL,{
msgKey:"searchGALContacts",tooltipKey:"searchGALContacts",icon:"GAL",setting:ZmSetting.GAL_ENABLED,id:ZmId.getMenuItemId(ZmId.SEARCH,ZmId.SEARCH_GAL)}
)
};
ZmContactsApp.prototype._registerApp=function(){
var a={};
a[ZmOperation.NEW_CONTACT]="contact";
a[ZmOperation.NEW_GROUP]="group";
var t={};
t[ZmOperation.NEW_ADDRBOOK]="addressBook";
var e={};
e[ZmKeyMap.NEW_CONTACT]=ZmOperation.NEW_CONTACT;
ZmApp.registerApp(ZmApp.CONTACTS,{
mainPkg:"Contacts",nameKey:"addressBook",icon:"ContactsApp",textPrecedence:40,chooserTooltipKey:"goToContacts",viewTooltipKey:"displayContacts",defaultSearch:ZmItem.CONTACT,organizer:ZmOrganizer.ADDRBOOK,overviewTrees:[ZmOrganizer.ADDRBOOK,ZmOrganizer.SEARCH,ZmOrganizer.TAG],assistants:{
ZmContactAssistant:["ContactsCore","Contacts"]}
,searchTypes:[ZmItem.CONTACT],newItemOps:a,newOrgOps:t,actionCodes:e,gotoActionCode:ZmKeyMap.GOTO_CONTACTS,newActionCode:ZmKeyMap.NEW_CONTACT,trashViewOp:ZmOperation.SHOW_ONLY_CONTACTS,chooserSort:20,defaultSort:40,upsellUrl:ZmSetting.CONTACTS_UPSELL_URL}
)
};
ZmContactsApp.prototype.createNotify=function(s,h){
if(!s.folder&&!s.cn&&!s.link){
return
}
if(!h&&!this._noDefer&&this._deferNotifications("create",s)){
return
}
for(var t in s){
var r=s[t];
if(r&&r.length){
for(var o=0;
o<r.length;
o++){
var a=r[o];
if(appCtxt.cacheGet(a.id)){
continue
}
if(t=="folder"){
this._handleCreateFolder(a,ZmOrganizer.ADDRBOOK)
}else{
if(t=="link"){
this._handleCreateLink(a,ZmOrganizer.ADDRBOOK)
}else{
if(t=="cn"){
var n=AjxDispatcher.run("GetContactListController");
var e=(n&&n.getFolderId())?n.getList():new ZmContactList(null);
if(appCtxt.multiAccounts&&e.search&&e.search.folderId!=a.l){
continue
}
e.notifyCreate(a);
appCtxt.getAutocompleter().clearCache(ZmAutocomplete.AC_TYPE_CONTACT);
a._handled=true
}}}}}}};
ZmContactsApp.prototype.postNotify=function(e){
if(this._checkReplenishListView){
this._checkReplenishListView._checkReplenish();
this._checkReplenishListView=null
}};
ZmContactsApp.prototype.handleOp=function(a){
switch(a){
case ZmOperation.NEW_CONTACT:case ZmOperation.NEW_GROUP:var t=(a==ZmOperation.NEW_GROUP)?ZmItem.GROUP:null;
var e=new AjxCallback(this,this._handleLoadNewItem,[t]);
AjxDispatcher.require(["ContactsCore","Contacts"],false,e,null,true);
break;
case ZmOperation.NEW_ADDRBOOK:var e=new AjxCallback(this,this._handleLoadNewAddrBook);
AjxDispatcher.require(["ContactsCore","Contacts"],false,e,null,true);
break
}};
ZmContactsApp.prototype._handleLoadNewItem=function(t){
var e=new ZmContact(null,null,t);
AjxDispatcher.run("GetContactController").show(e)
};
ZmContactsApp.prototype._handleLoadNewAddrBook=function(){
appCtxt.getAppViewMgr().popView(true,ZmId.VIEW_LOADING);
var e=appCtxt.getNewAddrBookDialog();
if(!this._newAddrBookCb){
this._newAddrBookCb=new AjxCallback(this,this._newAddrBookCallback)
}
ZmController.showDialog(e,this._newAddrBookCb)
};
ZmContactsApp.prototype.activate=function(n){
ZmApp.prototype.activate.apply(this,arguments);
if(!this._myCardChecked){
var t=appCtxt.getSkinHint("myCardSupport");
if(t){
var e=appCtxt.getById(ZmOrganizer.ID_ROOT);
var s={
id:ZmOrganizer.ID_MY_CARD,name:ZmMsg.myCard,parent:e,tree:e.tree,type:ZmOrganizer.ADDRBOOK,numTotal:1};
var o=new ZmAddrBook(s);
e.children.add(o);
o._notify(ZmEvent.E_CREATE);
var a=appCtxt.getOverviewController().getOverview(this.getOverviewId()).getTreeItemById(o.id,ZmOrganizer.ADDRBOOK);
a.enableSelection(true)
}
this._myCardChecked=true
}};
ZmContactsApp.prototype.launch=function(e,t){
this._contactsSearch("in:contacts",t)
};
ZmContactsApp.prototype._contactsSearch=function(e,o){
var a={
searchFor:ZmId.ITEM_CONTACT,query:e,limit:this.getLimit(),types:[ZmId.ITEM_CONTACT],callback:o};
var t=appCtxt.getSearchController();
t.searchAllAccounts=false;
t.search(a)
};
ZmContactsApp.prototype.getLimit=function(t){
var e=appCtxt.get(ZmSetting.PAGE_SIZE);
return t?e:2*e
};
ZmContactsApp.prototype.getInitialSearchType=function(){
var e=appCtxt.getCurrentList();
return(e&&(e instanceof ZmContactList)&&e.isGal)?ZmId.SEARCH_GAL:null
};
ZmContactsApp.prototype.showSearchResults=function(o,n,a,t){
var e=new AjxCallback(this,this._handleLoadShowSearchResults,[o,n,a,t]);
AjxDispatcher.require("Contacts",false,e,null,true)
};
ZmContactsApp.prototype._handleLoadShowSearchResults=function(a,o,t,e){
this.getContactListController().show(a,t,e);
if(o){
o.run()
}};
ZmContactsApp.prototype.setActive=function(t){
if(t){
var e=AjxDispatcher.run("GetContactListController");
e.show()
}};
ZmContactsApp.prototype.isContactListLoaded=function(e){
var t=(e||appCtxt.getActiveAccount().id);
return(this._contactList[t]&&this._contactList[t].isLoaded)
};
ZmContactsApp.prototype.getContactByEmail=function(s,r){
if(!s){
return null
}
var n=s.toLowerCase();
var o=this._byEmail[n];
if(!o&&this._notFound(n)){
this._removeAddrFromLookupGroup(n);
if(r){
r.run(null)
}
return null
}
if(o){
this._removeAddrFromLookupGroup(n);
o=this._realizeContact(o);
o._lookupEmail=s;
if(r){
r.run(o)
}
return o
}
if(r){
var l=null,a=false,e=[];
if(this._addrLookupHash&&this._addrLookupHash[n]){
if(this._addrLookupList){
for(var t=0;
t<this._addrLookupList.length;
t++){
e.push(this._addrLookupList[t])
}
l=this._getSearchForAddresses(this._addrLookupList);
a=true;
this._addrLookupList=null
}
this._addrLookupHash[n].push(r)
}else{
l=this._getSearchForAddresses([s])
}
if(l){
var h=new AjxCallback(this,this._handleResponseSearch,[a?e:n,a,r]);
l.execute({
callback:h,noBusyOverlay:true}
)
}}};
ZmContactsApp.prototype._handleResponseSearch=function(c,n,u,m){
var e=m.getResponse();
var s=e&&e.getResults(ZmItem.CONTACT);
if(n){
var l=s.getArray();
for(var o=0;
o<l.length;
o++){
this._updateLookupCache(l[o])
}
for(var o=0;
o<c.length;
o++){
var d=c[o];
if(!this._byEmail[d]){
this._updateLookupCache(null,d)
}
var h=this._addrLookupHash[d];
if(h&&h.length){
for(var t=0;
t<h.length;
t++){
h[t].run(this._byEmail[d])
}}
this._removeAddrFromLookupGroup(d)
}}else{
var r=s?s.get(0):null;
this._updateLookupCache(r,c);
this._byEmail[c]=r;
u.run(r)
}};
ZmContactsApp.prototype.getContactsByEmails=function(t,h){
var l=[],e=null,s=null;
for(var a=0,n=t.length;
a<n;
a++){
var r=t[a];
var o=this.getContactByEmail(r.getAddress());
if(o||o===null){
l.push({
address:r,contact:o}
)
}else{
e=e||[];
s=s||[];
e.push(r);
s.push(r.getAddress())
}}
if(!h){
return l
}
if(!e){
h.run(l);
return l
}
var d=this._getSearchForAddresses(s);
var c=new AjxCallback(this,this._handleResponseSearchByEmails,[e,l,h]);
d.execute({
callback:c}
)
};
ZmContactsApp.prototype._handleResponseSearchByEmails=function(e,u,d,m){
var t=m.getResponse();
var h=t&&t.getResults(ZmItem.CONTACT);
if(!h){
d.run(u)
}
for(var s=0,n=h.size();
s<n;
s++){
var o=h.get(s);
for(var a=1;
true;
a++){
var l=ZmContact.getAttributeName(ZmContact.F_email,a);
var r=o.getAttr(l);
if(!r){
break
}
this._byEmail[r]=o
}}
for(var a=0,n=e.length;
a<n;
a++){
var c=e[a];
var o=this.getContactByEmail(c.getAddress());
u.push({
address:c,contact:o}
)
}
d.run(u)
};
ZmContactsApp.prototype._getSearchForAddresses=function(a){
var e;
if(a.length==1){
e=["to:",a[0]," not #type:group"]
}else{
e=["("];
for(var t=0,o=a.length;
t<o;
t++){
if(t>0){
e.push(" OR ")
}
e.push("to:");
e.push(a[t])
}
e.push(") not #type:group")
}
var n={
query:e.join(""),limit:a.length*2,types:AjxVector.fromArray([ZmItem.CONTACT])};
return new ZmSearch(n)
};
ZmContactsApp.prototype._notFound=function(e){
return(e===null||Boolean(this._contactList[appCtxt.getActiveAccount().id]))
};
ZmContactsApp.prototype.setAddrLookupGroup=function(t){
this._addrLookupList=[];
this._addrLookupHash={};
if(t&&t.length){
for(var e=0;
e<t.length;
e++){
if(t[e]){
var a=t[e].address||t[e];
a=(a&&AjxUtil.isString(a))?a.toLowerCase():null;
if(a&&!this._addrLookupHash[a]){
this._addrLookupList.push(a);
this._addrLookupHash[a]=[]
}}}}};
ZmContactsApp.prototype._removeAddrFromLookupGroup=function(e){
if(!(this._addrLookupList&&this._addrLookupList.length)){
return
}
AjxUtil.arrayRemove(this._addrLookupList,e);
delete this._addrLookupHash[e]
};
ZmContactsApp.prototype._updateLookupCache=function(t,n){
if(n){
this._byEmail[n]=t
}
if(t){
for(var o=1;
true;
o++){
var a=ZmContact.getAttributeName(ZmContact.F_email,o);
var e=t.getAttr(a);
if(!e){
break
}
this._byEmail[e.toLowerCase()]=t
}}};
ZmContactsApp.prototype.getContactByIMAddress=function(t){
if(!t){
return null
}
var e=this._byIM[t.toLowerCase()];
return this._realizeContact(e)
};
ZmContactsApp.prototype.getContactByPhone=function(e){
if(!e){
return null
}
var a=e.replace(/[^\d]/g,"");
var t=this._phoneToContact[a];
if(t){
t.contact=this._realizeContact(t.contact)
}
return t
};
ZmContactsApp.prototype._realizeContact=function(e){
var a=appCtxt.getActiveAccount().id;
var t=this._contactList[a];
return t?t._realizeContact(e):e
};
ZmContactsApp.prototype.updateCache=function(e,t){
this._updateHash(e,t,ZmContact.EMAIL_FIELDS,this._byEmail);
if(appCtxt.get(ZmSetting.VOICE_ENABLED)){
this._updateHash(e,t,ZmContact.PHONE_FIELDS,this._byPhone,true,true)
}
if(appCtxt.get(ZmSetting.IM_ENABLED)){
this._updateHash(e,t,ZmContact.IM_FIELDS,this._byIM)
}};
ZmContactsApp.prototype._updateHash=function(h,a,s,n,t,e){
for(var r=0;
r<s.length;
r++){
var d=s[r];
for(var o=1;
true;
o++){
var c=ZmContact.getAttributeName(d,o);
var l=ZmContact.getAttr(h,c);
if(!l){
break
}
l=e?l.replace(/[^\d]/g,""):l.toLowerCase();
if(a){
n[l]=t?h:{
contact:h,field:c}
}else{
delete n[l]
}}}};
ZmContactsApp.prototype.getContactListForAllAccounts=function(){
var e=[];
var a=appCtxt.accountList.visibleAccounts;
for(var t=0;
t<a.length;
t++){
if(appCtxt.get(ZmSetting.CONTACTS_ENABLED,null,a[t])){
e.push(a[t])
}}
if(e.length>0){
this._loadContactsForAccount(e)
}};
ZmContactsApp.prototype._loadContactsForAccount=function(e){
var a=e.shift();
if(a){
var t=new AjxCallback(this,this._loadContactsForAccount,[e]);
this.getContactList(t,null,a)
}};
ZmContactsApp.prototype.getContactList=function(r,e,n){
var a=(n&&n.id)||appCtxt.getActiveAccount().id;
if(!this._contactList[a]){
try{
if(this._parentController){
this._contactList[a]=this._parentController.getApp(ZmApp.CONTACTS).getContactList()
}else{
this._contactList[a]=new ZmContactList(null);
var s=new AjxCallback(this,this._handleResponseGetContactList,[r]);
var t=(n&&n.getEmail());
this._contactList[a].load(s,e,t)
}
return this._contactList[a]
}
catch(o){
this._contactList[a]=null;
throw o
}}else{
if(r&&r.run){
r.run(this._contactList[a])
}
return this._contactList[a]
}};
ZmContactsApp.prototype._handleResponseGetContactList=function(t){
var e=appCtxt.getActiveAccount().id;
this.contactsLoaded[e]=true;
if(t&&t.run){
t.run(this._contactList[e])
}};
ZmContactsApp.prototype.getGalContactList=function(){
if(!this._galContactList){
try{
this._galContactList=new ZmContactList(null,true);
this._galContactList.load()
}
catch(e){
this._galContactList=null;
throw e
}}
return this._galContactList
};
ZmContactsApp.prototype.createFromVCard=function(a,t){
var e=new ZmContact(null);
e.createFromVCard(a,t)
};
ZmContactsApp.prototype.getMyCard=function(a){
if(this._myCard){
this._myCard=this._realizeContact(this._myCard);
a.run(this._myCard)
}else{
var e=appCtxt.getSearchController();
var t=new AjxCallback(this,this._handleResponseGetMyCard,[a]);
e.search({
query:"#cardOwner:isMyCard",types:[ZmItem.CONTACT],noRender:true,callback:t}
)
}};
ZmContactsApp.prototype._handleResponseGetMyCard=function(o,e){
var a=e.getResponse();
var t=a&&a.getResults(ZmItem.CONTACT);
this._myCard=t?t.get(0):null;
o.run(this._myCard)
};
ZmContactsApp.prototype.getContactListController=function(){
if(!this._contactListController){
this._contactListController=new ZmContactListController(this._container,this)
}
return this._contactListController
};
ZmContactsApp.prototype.getContactController=function(){
AjxDispatcher.require(["ContactsCore","Contacts"]);
if(this._contactController==null){
this._contactController=new ZmContactController(this._container,this)
}
return this._contactController
};
ZmContactsApp.prototype._newAddrBookCallback=function(n,a,t){
var o=appCtxt.getNewAddrBookDialog();
o.popdown();
var e=appCtxt.getOverviewController();
e.getTreeController(ZmOrganizer.ADDRBOOK)._doCreate(n,a,t)
};
ZmContactsApp.prototype._settingsChangeListener=function(n){
if(n.type!=ZmEvent.S_SETTINGS){
return
}
if(!this._initialized){
return
}
var o=this.getContactListController();
if(!o){
return
}
var s=n.getDetail("settings");
if(!(s&&s.length)){
return
}
var e=o._getViewType();
for(var t=0;
t<s.length;
t++){
var a=s[t];
if(a.id==ZmSetting.CONTACTS_VIEW){
e=o._defaultView()
}}
o.switchView(e,force,this._initialized,true)
}
}
if(AjxPackage.define("zimbraMail.im.ZmImApp")){
ZmImApp=function(e){
ZmApp.call(this,ZmApp.IM,e);
delete ZmFolder.HIDE_ID[ZmOrganizer.ID_CHATS];
this._active=false;
ZmImApp.INSTANCE=this;
this._roster=new ZmRoster(this)
};
ZmEvent.S_CHAT=ZmId.ITEM_CHAT;
ZmEvent.S_ROSTER="ROSTER";
ZmEvent.S_ROSTER_ITEM=ZmId.ITEM_ROSTER;
ZmEvent.S_ROSTER_TREE_ITEM=ZmId.ORG_ROSTER_TREE_ITEM;
ZmEvent.S_ROSTER_TREE_GROUP=ZmId.ORG_ROSTER_TREE_GROUP;
ZmItem.CHAT=ZmEvent.S_CHAT;
ZmItem.ROSTER_ITEM=ZmEvent.S_ROSTER_ITEM;
ZmOrganizer.ROSTER_TREE_ITEM=ZmEvent.S_ROSTER_TREE_ITEM;
ZmOrganizer.ROSTER_TREE_GROUP=ZmEvent.S_ROSTER_TREE_GROUP;
ZmOrganizer.CONFERENCE_ITEM="CONFERENCE_ITEM";
ZmItem.F_PRESENCE="PRESENCE";
ZmItem.F_PRESENCE_CELL="PRESENCE_cell";
ZmApp.IM=ZmId.APP_IM;
ZmApp.CLASS[ZmApp.IM]="ZmImApp";
ZmApp.SETTING[ZmApp.IM]=ZmSetting.IM_ENABLED;
ZmApp.LOAD_SORT[ZmApp.IM]=47;
ZmApp.QS_ARG[ZmApp.IM]="chat";
ZmImApp.BUDDY_SORT_PRESENCE="presence";
ZmImApp.BUDDY_SORT_NAME="name";
ZmImApp.prototype=new ZmApp;
ZmImApp.prototype.constructor=ZmImApp;
ZmImApp.loggedIn=function(){
return ZmImApp.INSTANCE&&ZmImApp.INSTANCE._serviceController&&ZmImApp.INSTANCE._serviceController.service.isLoggedIn()&&(appCtxt.get(ZmSetting.IM_PREF_AUTO_LOGIN)||ZmImApp.INSTANCE._roster)
};
ZmImApp.prototype.toString=function(){
return"ZmImApp"
};
ZmImApp.prototype._defineAPI=function(){
AjxDispatcher.registerMethod("GetRoster","IMCore",new AjxCallback(this,this.getRoster))
};
ZmImApp.prototype._registerOrganizers=function(){
ZmOrganizer.registerOrg(ZmOrganizer.CONFERENCE_ITEM,{
app:ZmApp.IM,nameKey:"imConference",defaultFolder:ZmOrganizer.ID_INBOX,orgPackage:"IM",treeController:"ZmConferenceTreeController",labelKey:"imConferences",itemsKey:"messages",hasColor:false,treeType:ZmOrganizer.CONFERENCE_ITEM,compareFunc:"ZmConferenceService.sortCompare",displayOrder:900}
)
};
ZmImApp.prototype._registerOperations=function(){
ZmOperation.registerOp(ZmId.OP_IM_NEW_CHAT,{
textKey:"imNewChat",image:"ImFree2Chat",shortcut:ZmKeyMap.NEW_CHAT}
);
ZmOperation.registerOp(ZmId.OP_IM_PRESENCE_AWAY,{
textKey:"imStatusAway",image:"ImAway"}
);
ZmOperation.registerOp(ZmId.OP_IM_PRESENCE_CHAT,{
textKey:"imStatusChat",image:"ImFree2Chat"}
);
ZmOperation.registerOp(ZmId.OP_IM_PRESENCE_DND,{
textKey:"imStatusDND",image:"ImDnd"}
);
ZmOperation.registerOp(ZmId.OP_IM_PRESENCE_INVISIBLE,{
textKey:"imStatusInvisible",image:"ImInvisible"}
);
ZmOperation.registerOp(ZmId.OP_IM_PRESENCE_MENU,{
textKey:"imPresence"}
);
ZmOperation.registerOp(ZmId.OP_IM_PRESENCE_OFFLINE,{
textKey:"imStatusOffline",image:"Offline"}
);
ZmOperation.registerOp(ZmId.OP_IM_PRESENCE_ONLINE,{
textKey:"imStatusOnline",image:"ImAvailable"}
);
ZmOperation.registerOp(ZmId.OP_IM_PRESENCE_XA,{
textKey:"imStatusExtAway",image:"ImExtendedAway"}
);
ZmOperation.registerOp(ZmId.OP_IM_LOGOUT_YAHOO,{
textKey:"imLogoutYahoo",image:"Logoff"}
);
ZmOperation.registerOp(ZmId.OP_IM_PRESENCE_CUSTOM_MRU,{
image:"ImAvailable"}
);
ZmOperation.registerOp(ZmId.OP_IM_PRESENCE_MENU,{
image:"ImAvailable"}
);
ZmOperation.registerOp(ZmId.OP_NEW_ROSTER_GROUP,{
textKey:"imNewGroup",image:"ImGroup"}
);
ZmOperation.registerOp(ZmId.OP_NEW_ROSTER_ITEM,{
textKey:"newRosterItem",image:"AddBuddy",tooltipKey:"imNewBuddyTooltip"}
);
ZmOperation.registerOp(ZmId.OP_IM_CREATE_CONTACT,{
textKey:"addToNewContact",image:"NewContact"}
);
ZmOperation.registerOp(ZmId.OP_IM_ADD_TO_CONTACT,{
textKey:"addToExistingContact",image:"Edit"}
);
ZmOperation.registerOp(ZmId.OP_IM_EDIT_CONTACT,{
textKey:"editContact",image:"Edit"}
);
ZmOperation.registerOp(ZmId.OP_IM_TOGGLE_OFFLINE,{
textKey:"imToggleOffline"}
);
ZmOperation.registerOp(ZmId.OP_IM_TOGGLE_BLOCKED,{
textKey:"imToggleBlocked"}
);
ZmOperation.registerOp(ZmId.OP_IM_SORT_BY_PRESENCE,{
textKey:"imSortListByPresence"}
);
ZmOperation.registerOp(ZmId.OP_IM_SORT_BY_NAME,{
textKey:"imSortListByName"}
);
ZmOperation.registerOp(ZmId.OP_IM_PRESENCE_CUSTOM_MSG,{
textKey:"imCustomStatusMsg",image:"ImAvailable"}
);
ZmOperation.registerOp(ZmId.OP_IM_BLOCK_BUDDY,{
textKey:"imBlock",image:"BlockUser"}
);
ZmOperation.registerOp(ZmId.OP_IM_UNBLOCK_BUDDY,{
textKey:"imUnblock",image:"AllowUser"}
);
ZmOperation.registerOp(ZmId.OP_IM_HTML,{
image:"TextFormat",tooltipKey:"changeEditorMode"}
);
ZmOperation.registerOp(ZmId.OP_IM_DELETE_GROUP,{
image:"Delete",textKey:"del"}
);
ZmOperation.registerOp(ZmId.OP_IM_CLOSE_ALL_CHATS,{
textKey:"imCloseAllChats"}
);
ZmOperation.registerOp(ZmId.OP_IM_CLOSE_OTHER_CHATS,{
textKey:"imCloseOtherChats"}
);
ZmOperation.registerOp(ZmId.OP_IM_CLOSE_CHAT,{
textKey:"imCloseChat"}
);
ZmOperation.registerOp(ZmId.OP_IM_BUDDY_ARCHIVE,{
textKey:"imBuddyArchive",image:"ChatFolder"}
);
ZmOperation.registerOp(ZmId.OP_IM_BUDDY_LIST,{
textKey:"buddyList",image:"ImGroup"}
);
ZmOperation.registerOp(ZmId.OP_IM_INVITE,{
textKey:"imInvitation",image:"AllowUser"}
)
};
ZmImApp.prototype._registerItems=function(){
ZmItem.registerItem(ZmItem.CHAT,{
app:ZmApp.IM,nameKey:"chat",icon:"ImStartChat",soapCmd:"ItemAction",itemClass:"ZmChat",node:"chat",organizer:ZmOrganizer.ROSTER,searchType:"chat"}
)
};
ZmImApp.prototype._registerApp=function(){
var t={};
t[ZmOperation.IM_NEW_CHAT]="chat";
var e={};
e[ZmKeyMap.NEW_CHAT]=ZmOperation.IM_NEW_CHAT;
e[ZmKeyMap.NEW_ROSTER_ITEM]=ZmOperation.NEW_ROSTER_ITEM;
e[ZmKeyMap.PRESENCE_MENU]=ZmOperation.IM_PRESENCE_MENU;
ZmApp.registerApp(ZmApp.IM,{
mainPkg:"IM",defaultSort:50,newItemOps:t,actionCodes:e}
)
};
ZmImApp.prototype._registerSettings=function(e){
e=e||appCtxt.getSettings();
e.registerSetting("IM_PREF_NOTIFY_SOUNDS",{
name:"zimbraPrefIMSoundsEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("IM_PREF_FLASH_BROWSER",{
name:"zimbraPrefIMFlashTitle",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("IM_PREF_DESKTOP_ALERT",{
name:"zimbraPrefIMToasterEnabled",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("IM_PREF_INSTANT_NOTIFY",{
name:"zimbraPrefIMInstantNotify",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("IM_PREF_AUTO_LOGIN",{
name:"zimbraPrefIMAutoLogin",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false}
);
e.registerSetting("IM_PREF_NOTIFY_PRESENCE",{
name:"zimbraPrefIMNotifyPresence",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("IM_PREF_NOTIFY_STATUS",{
name:"zimbraPrefIMNotifyStatus",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("IM_PREF_LOGCHATS_ENABLED",{
name:"zimbraPrefIMLogChats",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("IM_PREF_REPORT_IDLE",{
name:"zimbraPrefIMReportIdle",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("IM_PREF_IDLE_TIMEOUT",{
name:"zimbraPrefIMIdleTimeout",type:ZmSetting.T_PREF,dataType:ZmSetting.D_INT,defaultValue:10}
);
e.registerSetting("IM_PREF_IDLE_STATUS",{
name:"zimbraPrefIMIdleStatus",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:"xa"}
);
e.registerSetting("IM_CUSTOM_STATUS_MRU",{
name:"zimbraPrefIMCustomStatusMessage",type:ZmSetting.T_PREF,dataType:ZmSetting.D_LIST}
);
e.registerSetting("IM_PREF_BUDDY_SORT",{
name:"zimbraPrefIMBuddyListSort",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:ZmImApp.BUDDY_SORT_NAME,isImplicit:true}
);
e.registerSetting("IM_PREF_HIDE_OFFLINE",{
name:"zimbraPrefIMHideOfflineBuddies",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isImplicit:true}
);
e.registerSetting("IM_PREF_HIDE_BLOCKED",{
name:"zimbraPrefIMHideBlockedBuddies",type:ZmSetting.T_PREF,dataType:ZmSetting.D_BOOLEAN,defaultValue:false,isImplicit:true}
);
e.registerSetting("IM_YAHOO_ID",{
name:"zimbraPrefIMYahooId",type:ZmSetting.T_PREF,dataType:ZmSetting.D_STRING,defaultValue:""}
);
var t=new AjxListener(this,this._onSettingChange);
e.getSetting(ZmSetting.IM_PREF_INSTANT_NOTIFY).addChangeListener(t);
e.getSetting(ZmSetting.IM_PREF_REPORT_IDLE).addChangeListener(t);
e.getSetting(ZmSetting.IM_PREF_IDLE_TIMEOUT).addChangeListener(t)
};
ZmImApp.prototype._registerPrefs=function(){
var t={
IM:{
title:ZmMsg.im,icon:"ImStartChat",templateId:"prefs.Pages#IM",priority:90,precondition:ZmSetting.IM_ENABLED,prefs:[ZmSetting.IM_PREF_INSTANT_NOTIFY,ZmSetting.IM_PREF_AUTO_LOGIN,ZmSetting.IM_PREF_FLASH_BROWSER,ZmSetting.IM_PREF_DESKTOP_ALERT,ZmSetting.IM_PREF_NOTIFY_PRESENCE,ZmSetting.IM_PREF_NOTIFY_STATUS,ZmSetting.IM_PREF_LOGCHATS_ENABLED,ZmSetting.IM_PREF_REPORT_IDLE,ZmSetting.IM_PREF_IDLE_TIMEOUT,ZmSetting.IM_PREF_IDLE_STATUS,ZmSetting.IM_PREF_NOTIFY_SOUNDS]}};
for(var e in t){
ZmPref.registerPrefSection(e,t[e])
}
ZmPref.registerPref("IM_PREF_NOTIFY_SOUNDS",{
displayName:ZmMsg.playSound,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("IM_PREF_INSTANT_NOTIFY",{
displayName:ZmMsg.imPrefInstantNotify,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:function(){
return appCtxt.get(ZmSetting.INSTANT_NOTIFY)&&ZmImApp.INSTANCE.getServiceController().capabilities[ZmImServiceController.INSTANT_NOTIFY]
}}
);
ZmPref.registerPref("IM_PREF_AUTO_LOGIN",{
displayName:ZmMsg.imPrefAutoLogin,displayContainer:ZmPref.TYPE_CHECKBOX,precondition:function(){
return ZmImApp.INSTANCE.getServiceController().capabilities[ZmImServiceController.AUTO_LOGIN_PREF]
}}
);
ZmPref.registerPref("IM_PREF_FLASH_BROWSER",{
displayName:ZmMsg.flashBrowser,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("IM_PREF_DESKTOP_ALERT",{
displayName:ZmMsg.showPopupBrowserPlus,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("IM_PREF_NOTIFY_PRESENCE",{
displayName:ZmMsg.imPrefNotifyPresence,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("IM_PREF_NOTIFY_STATUS",{
displayName:ZmMsg.imPrefNotifyStatus,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("IM_PREF_LOGCHATS_ENABLED",{
displayName:ZmMsg.imPrefLogChats,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("IM_PREF_REPORT_IDLE",{
displayName:ZmMsg.imPrefReportIdle,displayContainer:ZmPref.TYPE_CHECKBOX}
);
ZmPref.registerPref("IM_PREF_IDLE_TIMEOUT",{
displayName:ZmMsg.imPrefIdleTimeout,displayContainer:ZmPref.TYPE_SELECT,displayOptions:[ZmMsg.imPrefIdleTimeoutMinutes,ZmMsg.imPrefIdleTimeoutMinutes,ZmMsg.imPrefIdleTimeoutMinutes,ZmMsg.imPrefIdleTimeoutMinutes,ZmMsg.imPrefIdleTimeoutMinutes,ZmMsg.imPrefIdleTimeoutMinutes],options:[1,5,10,20,30,60],precondition:ZmSetting.IM_PREF_REPORT_IDLE}
);
ZmPref.registerPref("IM_PREF_IDLE_STATUS",{
displayName:ZmMsg.imPrefIdleStatus,displayContainer:ZmPref.TYPE_SELECT,displayOptions:[ZmMsg.imStatusAway,ZmMsg.imStatusExtAway,ZmMsg.imStatusOffline],options:["away","xa","offline"],precondition:ZmSetting.IM_PREF_REPORT_IDLE}
)
};
ZmImApp.prototype._onSettingChange=function(e){
if(e.type!=ZmEvent.S_SETTING){
return
}
var a=e.source.id;
var t=appCtxt.get(a);
if(a==ZmSetting.IM_PREF_INSTANT_NOTIFY&&appCtxt.get(ZmSetting.INSTANT_NOTIFY)){
appCtxt.getAppController().setInstantNotify(t)
}else{
if(this._roster&&a==ZmSetting.IM_PREF_REPORT_IDLE){
if(!t){
this._roster._idleTimer.kill()
}else{
this._roster._idleTimer.resurrect(appCtxt.get(ZmSetting.IM_PREF_IDLE_TIMEOUT))
}}else{
if(this._roster&&a==ZmSetting.IM_PREF_IDLE_TIMEOUT){
this._roster._idleTimer.timeout=parseInt(t)*60*1000
}}}};
ZmImApp.prototype.refresh=function(){
delete this._lastSeq;
if(this._serviceController&&this._serviceController.service.isLoggedIn()){
this._roster.refresh()
}};
ZmImApp.prototype.handleOp=function(e){
switch(e){
case ZmOperation.IM_NEW_CHAT:this.prepareVisuals();
this.getImController()._imNewChatListener();
break;
case ZmOperation.NEW_ROSTER_ITEM:this.prepareVisuals();
this.getImController()._newRosterItemListener();
break;
case ZmOperation.IM_PRESENCE_MENU:if(this._presenceButton){
this._presenceButton.popup()
}
break
}};
ZmImApp.prototype.postNotify=function(e){
if(e.im){
if(!this._lastSeq||(e.seq>this._lastSeq)){
this._lastSeq=e.seq;
AjxDispatcher.run("GetRoster").pushNotification(e.im)
}}};
ZmImApp.prototype.addComponents=function(e){
this._taskbarController=new ZmTaskbarController(e)
};
ZmImApp.prototype.startup=function(){
if(appCtxt.get(ZmSetting.IM_PREF_AUTO_LOGIN)){
AjxTimedAction.scheduleAction(new AjxTimedAction(this,this._autoLogin),1000)
}};
ZmImApp.prototype.login=function(e){
this.getServiceController().login(e)
};
ZmImApp.prototype._autoLogin=function(){
var e=new AjxCallback(this,this._postLoadAutoLogin);
AjxDispatcher.require(["IMCore"],true,e)
};
ZmImApp.prototype._postLoadAutoLogin=function(){
this.login({
auto:true}
)
};
ZmImApp.prototype.getImController=function(){
if(!this._imController){
AjxDispatcher.require(["IMCore","IM"]);
this._imController=new ZmImController()
}
return this._imController
};
ZmImApp.prototype.isActive=function(){
return this._active
};
ZmImApp.prototype.getRoster=function(){
return this._roster
};
ZmImApp.prototype.hasRoster=function(){
return !!this._roster
};
ZmImApp.prototype.getServiceController=function(){
if(!window.ZmImServiceController||!this._serviceController){
AjxDispatcher.require(["IMCore"]);
var e=this.getRoster();
this._serviceController=new ZmZimbraImServiceController(e)
}
return this._serviceController
};
ZmImApp.prototype.getService=function(){
return this.getServiceController().service
};
ZmImApp.prototype.getAutoCompleteGroups=function(){
return new ZmRosterTreeGroups(this.getRoster())
};
ZmImApp.prototype.prepareVisuals=function(){
AjxDispatcher.require(["IMCore","IM"])
};
ZmImApp._NEW_IM="NEW_IM";
ZmImApp._NEW_BUDDY_FROM_IM_ADDRESS="NEW_BUDDY_FROM_IM_ADDRESS";
ZmImApp._NEW_BUDDY="NEW_BUDDY";
ZmImApp.updateImMenuItemByContact=function(s,e,t){
var n=ZmImApp._updateImMenuItemByLogin(s);
if(n){
return
}
var o=e.getBuddy();
if(o){
ZmImApp._updateImMenuItemByBuddy(s,o);
return
}
var r=e.getIMAddress();
if(r){
s.setText(ZmImApp._getNewBuddyText(e.getFullName()));
s.setImage("NewContact");
s._imData={
op:ZmImApp._NEW_BUDDY_FROM_IM_ADDRESS,contact:e,imAddress:r};
return
}
var a=t&&t.getName()?t.getName():e.getFullName();
s.setText(ZmImApp._getNewBuddyText(a));
s.setImage("NewContact");
s._imData={
op:ZmImApp._NEW_BUDDY,address:t,name:a}
};
ZmImApp.updateImMenuItemByAddress=function(n,e,a,h){
var o=ZmImApp._updateImMenuItemByLogin(n);
if(o){
if(h){
h.run()
}
return
}
var t=AjxDispatcher.run("GetRoster").getRosterItem(e.getAddress());
if(t){
ZmImApp._updateImMenuItemByBuddy(n,t);
if(h){
h.run()
}
return
}
var r=appCtxt.getApp(ZmApp.CONTACTS);
if(r){
if(h){
var s=new AjxCallback(null,ZmImApp.handleResponseGetContact,[n,e,a,h]);
r.getContactByEmail(e.getAddress(),s)
}
return true
}else{
ZmImApp.handleResponseGetContact(n,e,a)
}};
ZmImApp.handleResponseGetContact=function(o,t,a,n,e){
if(e){
ZmImApp.updateImMenuItemByContact(o,e,t)
}else{
if(a){
o.setText(ZmImApp._getNewBuddyText(t.getName()||t.getAddress()));
o.setImage("NewContact");
o._imData={
op:ZmImApp._NEW_BUDDY,address:t,name:t.getName()}
}}
if(n){
n.run()
}};
ZmImApp.getImMenuItemListener=function(){
ZmImApp._imMenuItemListenerObj=ZmImApp._imMenuItemListenerObj||new AjxListener(null,ZmImApp._imMenuItemListener);
return ZmImApp._imMenuItemListenerObj
};
ZmImApp._updateImMenuItemByBuddy=function(t,e){
ZmImApp._newChatFormat=ZmImApp._newChatFormat||new AjxMessageFormat(ZmMsg.imNewChatName);
t.setText(ZmImApp._newChatFormat.format(e.getDisplayName()));
t.setImage(e.getPresence().getIcon());
t._imData={
op:ZmImApp._NEW_IM,buddy:e}
};
ZmImApp._updateImMenuItemByLogin=function(e){
if(!ZmImApp.loggedIn()){
e.setText(ZmMsg.newIM);
e.setImage("ImStartChat");
e.setEnabled(false);
e._imData=null;
return true
}
e.setEnabled(true);
return false
};
ZmImApp._getNewBuddyText=function(e){
ZmImApp._newBuddyFormat=ZmImApp._newBuddyFormat||new AjxMessageFormat(ZmMsg.imNewBuddy);
return ZmImApp._newBuddyFormat.format(e)
};
ZmImApp._imMenuItemListener=function(t){
ZmImApp.INSTANCE.prepareVisuals();
var e=t.dwtObj._imData;
if(e){
switch(e.op){
case ZmImApp._NEW_IM:ZmTaskbarController.INSTANCE.chatWithRosterItem(e.buddy);
break;
case ZmImApp._NEW_BUDDY_FROM_IM_ADDRESS:var o=ZmImAddress.parse(e.imAddress);
var a=o?{
address:o.screenName,name:e.contact.getFullName(),service:o.service}
:{};
ZmImApp.INSTANCE.getImController()._newRosterItemListener(a);
break;
case ZmImApp._NEW_BUDDY:a={
address:e.address?e.address.getAddress():null,name:e.name};
ZmImApp.INSTANCE.getImController()._newRosterItemListener(a);
break
}}}
}
if(AjxPackage.define("zimbraMail.notebook.ZmNotebookApp")){
ZmNotebookApp=function(t,e){
ZmApp.call(this,ZmApp.NOTEBOOK,t,e)
};
ZmEvent.S_PAGE=ZmId.ITEM_PAGE;
ZmEvent.S_DOCUMENT=ZmId.ITEM_DOCUMENT;
ZmEvent.S_NOTEBOOK=ZmId.ORG_NOTEBOOK;
ZmItem.PAGE=ZmEvent.S_PAGE;
ZmItem.DOCUMENT=ZmEvent.S_DOCUMENT;
ZmOrganizer.NOTEBOOK=ZmEvent.S_NOTEBOOK;
ZmApp.NOTEBOOK=ZmId.APP_NOTEBOOK;
ZmApp.CLASS[ZmApp.NOTEBOOK]="ZmNotebookApp";
ZmApp.SETTING[ZmApp.NOTEBOOK]=ZmSetting.NOTEBOOK_ENABLED;
ZmApp.LOAD_SORT[ZmApp.NOTEBOOK]=60;
ZmApp.QS_ARG[ZmApp.NOTEBOOK]="documents";
ZmNotebookApp.prototype=new ZmApp;
ZmNotebookApp.prototype.constructor=ZmNotebookApp;
ZmNotebookApp.prototype.toString=function(){
return"ZmNotebookApp"
};
ZmNotebookApp.prototype._notebookCache;
ZmNotebookApp.prototype._defineAPI=function(){
AjxDispatcher.setPackageLoadFunction("NotebookCore",new AjxCallback(this,this._postLoadCore));
AjxDispatcher.setPackageLoadFunction("Notebook",new AjxCallback(this,this._postLoad,ZmOrganizer.NOTEBOOK));
AjxDispatcher.registerMethod("GetNotebookController",["NotebookCore","Notebook"],new AjxCallback(this,this.getNotebookController));
AjxDispatcher.registerMethod("GetPageEditController",["NotebookCore","Notebook"],new AjxCallback(this,this.getPageEditController));
AjxDispatcher.registerMethod("GetNotebookCache",["NotebookCore","Notebook"],new AjxCallback(this,this.getNotebookCache));
AjxDispatcher.registerMethod("GetPageVersionController",["NotebookCore","Notebook"],new AjxCallback(this,this.getPageVersionController));
AjxDispatcher.registerMethod("GetNotebookFileController",["NotebookCore","Notebook"],new AjxCallback(this,this.getFileController))
};
ZmNotebookApp.prototype._registerOperations=function(){
ZmOperation.registerOp(ZmId.OP_EDIT_NOTEBOOK_CHROME,{
textKey:"editNotebookChrome",image:"Edit"}
);
ZmOperation.registerOp(ZmId.OP_EDIT_NOTEBOOK_INDEX,{
textKey:"editNotebookIndex",image:"Edit"}
);
ZmOperation.registerOp(ZmId.OP_EDIT_NOTEBOOK_HEADER,{
textKey:"editNotebookHeader",image:"Edit"}
);
ZmOperation.registerOp(ZmId.OP_EDIT_NOTEBOOK_FOOTER,{
textKey:"editNotebookFooter",image:"Edit"}
);
ZmOperation.registerOp(ZmId.OP_EDIT_NOTEBOOK_SIDE_BAR,{
textKey:"editNotebookSideBar",image:"Edit"}
);
ZmOperation.registerOp(ZmId.OP_EDIT_NOTEBOOK_CHROME,{
textKey:"editNotebookChrome",image:"Edit"}
);
ZmOperation.registerOp(ZmId.OP_FORMAT_HTML_SOURCE,{
textKey:"formatHtmlSource"}
,ZmSetting.HTML_COMPOSE_ENABLED);
ZmOperation.registerOp(ZmId.OP_FORMAT_MEDIA_WIKI,{
textKey:"formatMediaWiki"}
,ZmSetting.HTML_COMPOSE_ENABLED);
ZmOperation.registerOp(ZmId.OP_FORMAT_RICH_TEXT,{
textKey:"formatRichText"}
,ZmSetting.HTML_COMPOSE_ENABLED);
ZmOperation.registerOp(ZmId.OP_FORMAT_TWIKI,{
textKey:"formatTWiki"}
,ZmSetting.HTML_COMPOSE_ENABLED);
ZmOperation.registerOp(ZmId.OP_MOUNT_NOTEBOOK,{
textKey:"mountNotebook",image:"Notebook"}
,ZmSetting.SHARING_ENABLED);
ZmOperation.registerOp(ZmId.OP_NEW_NOTEBOOK,{
textKey:"newNotebook",image:"NewNotebook",tooltipKey:"newNotebookTooltip",shortcut:ZmKeyMap.NEW_NOTEBOOK}
);
ZmOperation.registerOp(ZmId.OP_NEW_PAGE,{
textKey:"newPage",tooltipKey:"createNewPage",image:"NewPage"}
);
ZmOperation.registerOp(ZmId.OP_IMPORT_FILE,{
textKey:"_import",tooltipKey:"importDocs"}
);
ZmOperation.registerOp(ZmId.OP_SEND_PAGE,{
textKey:"send",tooltipKey:"sendPageTT",image:"Send"}
,ZmSetting.MAIL_ENABLED);
ZmOperation.registerOp(ZmId.OP_REFRESH,{
textKey:"refresh",tooltipKey:"refreshTooltip",image:"Refresh"}
);
ZmOperation.registerOp(ZmId.OP_SHARE_NOTEBOOK,{
textKey:"shareNotebook",image:"Notebook"}
,ZmSetting.SHARING_ENABLED);
ZmOperation.registerOp(ZmId.OP_REVERT_PAGE,{
textKey:"revert",tooltipKey:"restorePage",image:"Edit"}
);
ZmOperation.registerOp(ZmId.OP_BROWSE_FOLDER,{
textKey:"browse",image:"Browse"}
)
};
ZmNotebookApp.prototype._registerItems=function(){
ZmItem.registerItem(ZmItem.PAGE,{
app:ZmApp.NOTEBOOK,nameKey:"page",icon:"Page",soapCmd:"ItemAction",itemClass:"ZmPage",node:"w",organizer:ZmOrganizer.NOTEBOOK,dropTargets:[ZmOrganizer.TAG],searchType:"wiki",resultsList:AjxCallback.simpleClosure(function(e){
AjxDispatcher.require("NotebookCore");
return new ZmPageList(e)
}
,this)}
);
ZmItem.registerItem(ZmItem.DOCUMENT,{
app:ZmApp.NOTEBOOK,nameKey:"document",icon:"GenericDoc",soapCmd:"ItemAction",itemClass:"ZmDocument",node:"doc",organizer:ZmOrganizer.NOTEBOOK,dropTargets:[ZmOrganizer.TAG],searchType:"document",resultsList:AjxCallback.simpleClosure(function(e){
AjxDispatcher.require("NotebookCore");
return new ZmPageList(e,ZmItem.DOCUMENT)
}
,this)}
)
};
ZmNotebookApp.prototype._registerOrganizers=function(){
ZmOrganizer.registerOrg(ZmOrganizer.NOTEBOOK,{
app:ZmApp.NOTEBOOK,nameKey:"notebook",defaultFolder:ZmOrganizer.ID_NOTEBOOK,soapCmd:"FolderAction",firstUserId:256,orgClass:"ZmNotebook",orgPackage:"NotebookCore",treeController:"ZmNotebookTreeController",labelKey:"notebooks",itemsKey:"documents",hasColor:true,defaultColor:ZmOrganizer.C_NONE,treeType:ZmOrganizer.FOLDER,views:["wiki"],folderKey:"notebook",mountKey:"mountNotebook",createFunc:"ZmOrganizer.create",compareFunc:"ZmNotebook.sortCompare",newOp:ZmOperation.NEW_NOTEBOOK,displayOrder:100,deferrable:true}
)
};
ZmNotebookApp.prototype._setupSearchToolbar=function(){
ZmSearchToolBar.addMenuItem(ZmItem.PAGE,{
msgKey:"searchNotebooks",tooltipKey:"searchForPages",icon:"Notebook",shareIcon:"SharedNotebook",setting:ZmSetting.NOTEBOOK_ENABLED,id:ZmId.getMenuItemId(ZmId.SEARCH,ZmId.ITEM_PAGE)}
)
};
ZmNotebookApp.prototype._registerApp=function(){
var a={};
a[ZmOperation.NEW_PAGE]="page";
var t={};
t[ZmOperation.NEW_NOTEBOOK]="notebook";
var e={};
e[ZmKeyMap.NEW_PAGE]=ZmOperation.NEW_PAGE;
e[ZmKeyMap.NEW_NOTEBOOK]=ZmOperation.NEW_NOTEBOOK;
ZmApp.registerApp(ZmApp.NOTEBOOK,{
mainPkg:"Notebook",nameKey:"documents",icon:"NoteApp",textPrecedence:10,chooserTooltipKey:"goToDocuments",defaultSearch:ZmItem.PAGE,organizer:ZmOrganizer.NOTEBOOK,overviewTrees:[ZmOrganizer.NOTEBOOK,ZmOrganizer.TAG],searchTypes:[ZmItem.PAGE,ZmItem.DOCUMENT],newItemOps:a,newOrgOps:t,actionCodes:e,gotoActionCode:ZmKeyMap.GOTO_NOTEBOOK,newActionCode:ZmKeyMap.NEW_PAGE,chooserSort:50,defaultSort:30}
)
};
ZmNotebookApp.prototype.deleteNotify=function(t,s){
if(!s&&this._deferNotifications("delete",t)){
return
}
var p=null;
var f=t.join(",")+",";
var y=false;
var n=AjxDispatcher.run("GetNotebookController");
var c=n.getPage();
var a=appCtxt.getOverviewController();
var h=a.getTreeController(ZmOrganizer.NOTEBOOK);
var r=h.getTreeView(this.getOverviewId());
if(!r){
return
}
var e=this.getNotebookCache();
for(var m=0;
m<t.length;
m++){
var u=r.getNextData(t[m]);
if(u&&f.indexOf(u.id+",")<0){
p=u
}
if(c&&c.id==t[m]){
y=true
}}
for(var m=0;
m<t.length;
m++){
var g=e.getPageById(t[m]);
if(g){
e.removePage(g);
g.notifyDelete()
}
var o=appCtxt.getById(t[m]);
if(o&&(o instanceof ZmNotebook)){
e.removeItem(o);
o.notifyDelete()
}
appCtxt.cacheRemove(t[m])
}
if(y){
var d={
folderId:(p?p.id:c.folderId),name:ZmNotebook.PAGE_INDEX};
n.gotoPage(d)
}
for(var m=0;
m<t.length;
m++){
var l=r.getTreeItemById(t[m]);
if(l){
l.dispose()
}
t[m]=null
}};
ZmNotebookApp.prototype.createNotify=function(c,o){
if(!c.folder&&!c.w&&!c.doc&&!c.link){
return
}
if(!o&&!this._noDefer&&this._deferNotifications("create",c)){
return
}
for(var t in c){
var h=c[t];
for(var s=0;
s<h.length;
s++){
var r=h[s];
if(appCtxt.cacheGet(r.id)){
continue
}
if(t=="folder"){
this._handleCreateFolder(r,ZmOrganizer.NOTEBOOK)
}else{
if(t=="link"){
this._handleCreateLink(r,ZmOrganizer.NOTEBOOK)
}else{
if(t=="w"){
var e=this.getNotebookCache();
var l=new ZmPage();
l.set(r);
e.putPage(l);
var a=AjxDispatcher.run("GetNotebookController");
if(!a.isIframeEnabled()){
var n=a.getPage();
if(n&&n.name==ZmNotebook.PAGE_INDEX){
a.gotoPage(n)
}}}else{
if(t=="doc"){
var e=this.getNotebookCache();
var d=new ZmDocument();
d.set(r);
e.putDocument(d)
}}}}}}};
ZmNotebookApp.prototype.modifyNotify=function(s,n){
if(!s){
return
}
if(!s.w&&!s.doc){
return
}
if(!n&&!this._noDefer&&this._deferNotifications("modify",l)){
return
}
for(var t in s){
var l=s[t];
for(var h=0;
h<l.length;
h++){
var d=l[h];
var o=d.id;
if(!o){
continue
}
if(t=="w"){
var e=this.getNotebookCache();
var c=e.getPageById(o);
if(!c){
c=new ZmPage();
c.set(d);
e.putPage(c)
}else{
c.notifyModify(d);
c.set(d)
}
var a=AjxDispatcher.run("GetNotebookController");
if(!a.isIframeEnabled()){
var r=a.getPage();
if(r&&r.folderId==c.folderId){
if(r.name==ZmNotebook.PAGE_INDEX||r.name==c.name){
a.gotoPage(r)
}}}
d._handled=true
}else{
if(t=="doc"){
var e=this.getNotebookCache();
var u=e.getDocumentById(o);
if(!u){
u=new ZmDocument();
u.set(d);
e.putDocument(u)
}else{
u.notifyModify(d);
u.set(d)
}
d._handled=true
}}}}};
ZmNotebookApp.prototype.handleOp=function(t){
switch(t){
case ZmOperation.NEW_PAGE:var e=new AjxCallback(this,this._handleLoadNewPage);
AjxDispatcher.require(["NotebookCore","Notebook"],false,e,null,true);
break;
case ZmOperation.NEW_NOTEBOOK:var e=new AjxCallback(this,this._handleLoadNewNotebook);
AjxDispatcher.require(["NotebookCore","Notebook"],false,e,null,true);
break
}};
ZmNotebookApp.prototype._handleLoadNewPage=function(){
var e=appCtxt.getOverviewController();
var n=e.getTreeController(ZmOrganizer.NOTEBOOK);
var t=n.getTreeView(this.getOverviewId());
var o=t?t.getSelected():null;
var a=new ZmPage();
a.folderId=o?o.id:ZmNotebookItem.DEFAULT_FOLDER;
a.name=this.generateUniqueName(a.folderId);
AjxDispatcher.run("GetPageEditController").show(a)
};
ZmNotebookApp.prototype._handleLoadNewNotebook=function(){
appCtxt.getAppViewMgr().popView(true,ZmId.VIEW_LOADING);
var e=appCtxt.getNewNotebookDialog();
if(!this._newNotebookCb){
this._newNotebookCb=new AjxCallback(this,this._newNotebookCallback)
}
ZmController.showDialog(e,this._newNotebookCb)
};
ZmNotebookApp.prototype.launch=function(t,a){
var e=new AjxCallback(this,this._handleLoadLaunch,[a]);
AjxDispatcher.require(["NotebookCore","Notebook"],true,e,null,true)
};
ZmNotebookApp.prototype._handleLoadLaunch=function(t){
var e=this.getNotebookController();
e.show(null,true);
if(t){
t.run()
}};
ZmNotebookApp.prototype.showSearchResults=function(t,a){
var e=new AjxCallback(this,this._handleLoadShowSearchResults,[t,a]);
AjxDispatcher.require(["NotebookCore","Notebook"],false,e,null,true)
};
ZmNotebookApp.prototype._handleLoadShowSearchResults=function(e,t){
this.getFileController().show(e,true);
if(t){
t.run()
}};
ZmNotebookApp.prototype.setActive=function(e){};
ZmNotebookApp.prototype.getNotebookController=function(){
if(!this._notebookController){
this._notebookController=new ZmNotebookPageController(this._container,this)
}
return this._notebookController
};
ZmNotebookApp.prototype.getPageEditController=function(){
if(!this._pageController){
this._pageController=new ZmPageEditController(this._container,this)
}
return this._pageController
};
ZmNotebookApp.prototype.getFileController=function(){
if(!this._fileController){
this._fileController=new ZmNotebookFileController(this._container,this)
}
return this._fileController
};
ZmNotebookApp.prototype.getNotebookCache=function(){
if(!this._notebookCache){
this._notebookCache=new ZmNotebookCache()
}
return this._notebookCache
};
ZmNotebookApp.prototype._newNotebookCallback=function(n,a,t){
var o=appCtxt.getNewNotebookDialog();
o.popdown();
var e=appCtxt.getOverviewController();
e.getTreeController(ZmOrganizer.NOTEBOOK)._doCreate(n,a,t)
};
ZmNotebookApp.prototype.generateUniqueName=function(a){
var t=this.getNotebookCache().getPagesInFolder(a);
var s=[];
for(var n in t){
s.push(t[n].name.toLowerCase())
}
s="/"+s.join("/")+"/";
var e=ZmMsg.defaultPageName.toLowerCase();
for(var o=1;
o<100;
o++){
if(s.indexOf(["/",e,o,"/"].join(""))==-1){
return(ZmMsg.defaultPageName+o)
}}
return ZmMsg.untitled
};
ZmNotebookApp.prototype.getPageVersionController=function(){
if(!this._versionController){
this._versionController=new ZmPageVersionController(this._container,this)
}
return this._versionController
}
}
if(AjxPackage.define("zimbraMail.briefcase.ZmBriefcaseApp")){
ZmBriefcaseApp=function(t,e){
ZmApp.call(this,ZmApp.BRIEFCASE,t,e);
this._notebookCache=null
};
ZmBriefcaseApp.prototype=new ZmApp;
ZmBriefcaseApp.prototype.constructor=ZmBriefcaseApp;
ZmEvent.S_PAGE=ZmId.ITEM_PAGE;
ZmEvent.S_DOCUMENT=ZmId.ITEM_DOCUMENT;
ZmEvent.S_BRIEFCASE=ZmId.ITEM_BRIEFCASE;
ZmItem.PAGE=ZmEvent.S_PAGE;
ZmItem.DOCUMENT=ZmEvent.S_DOCUMENT;
ZmItem.BRIEFCASE=ZmEvent.S_BRIEFCASE;
ZmOrganizer.BRIEFCASE=ZmId.ORG_BRIEFCASE;
ZmApp.BRIEFCASE=ZmId.APP_BRIEFCASE;
ZmApp.CLASS[ZmApp.BRIEFCASE]="ZmBriefcaseApp";
ZmApp.SETTING[ZmApp.BRIEFCASE]=ZmSetting.BRIEFCASE_ENABLED;
ZmApp.LOAD_SORT[ZmApp.BRIEFCASE]=65;
ZmApp.QS_ARG[ZmApp.BRIEFCASE]="briefcase";
ZmApp.BUTTON_ID[ZmApp.BRIEFCASE]=ZmId.BRIEFCASE_APP;
ZmBriefcaseApp.prototype.toString=function(){
return"ZmBriefcaseApp"
};
ZmBriefcaseApp.prototype._defineAPI=function(){
AjxDispatcher.setPackageLoadFunction("BriefcaseCore",new AjxCallback(this,this._postLoadCore));
AjxDispatcher.setPackageLoadFunction("Briefcase",new AjxCallback(this,this._postLoad,ZmOrganizer.BRIEFCASE));
AjxDispatcher.registerMethod("GetBriefcaseController",["BriefcaseCore","Briefcase"],new AjxCallback(this,this.getBriefcaseController))
};
ZmBriefcaseApp.prototype._registerOperations=function(){
ZmOperation.registerOp(ZmId.OP_NEW_BRIEFCASEITEM,{
textKey:"newBriefcase",image:"NewFolder",tooltipKey:"newBriefcaseTooltip",shortcut:ZmKeyMap.NEW_BRIEFCASEITEM}
);
ZmOperation.registerOp(ZmId.OP_NEW_FILE,{
textKey:"uploadNewFile",tooltipKey:"uploadNewFile",image:"NewPage"}
);
ZmOperation.registerOp(ZmId.OP_NEW_PRESENTATION,{
textKey:"newPresentationBeta",tooltipKey:"newPresentation",image:"Presentation"}
);
ZmOperation.registerOp(ZmId.OP_NEW_SPREADSHEET,{
textKey:"newSpreadSheetBeta",tooltipKey:"newSpreadSheet",image:"ZSpreadSheet"}
);
ZmOperation.registerOp(ZmId.OP_NEW_DOC,{
textKey:"newDocument",tooltipKey:"newDocument",image:"Doc",shortcut:ZmKeyMap.NEW_DOC}
);
ZmOperation.registerOp(ZmId.OP_SHARE_BRIEFCASE,{
textKey:"shareFolder",image:"SharedMailFolder"}
,ZmSetting.SHARING_ENABLED);
ZmOperation.registerOp(ZmId.OP_MOUNT_BRIEFCASE,{
textKey:"mountBriefcase",image:"Notebook"}
,ZmSetting.SHARING_ENABLED);
ZmOperation.registerOp(ZmId.OP_OPEN_FILE,{
textKey:"openFile",tooltipKey:"openFileTooltip",image:"NewPage"}
);
ZmOperation.registerOp(ZmId.OP_SAVE_FILE,{
textKey:"saveFile",tooltipKey:"saveFileTooltip",image:"Save"}
);
ZmOperation.registerOp(ZmId.OP_VIEW_FILE_AS_HTML,{
textKey:"viewAsHtml",tooltipKey:"viewAsHtml",image:"HtmlDoc"}
);
ZmOperation.registerOp(ZmId.OP_SEND_FILE,{
textKey:"sendLink",tooltipKey:"sendLink",image:"Send"}
);
ZmOperation.registerOp(ZmId.OP_SEND_FILE_AS_ATT,{
textKey:"sendAsAttachment",tooltipKey:"sendAsAttachment",image:"Attachment"}
);
ZmOperation.registerOp(ZmId.OP_SEND_FILE_MENU,{
textKey:"send",image:"Send"}
);
ZmOperation.registerOp(ZmId.OP_CREATE_SLIDE_SHOW,{
textKey:"createSlideShow",image:"Presentation"}
)
};
ZmBriefcaseApp.prototype._registerSettings=function(e){
e=e||appCtxt.getSettings();
e.registerSetting("SPREADSHEET_ENABLED",{
name:"zimbraFeatureBriefcaseSpreadsheetEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("SLIDES_ENABLED",{
name:"zimbraFeatureBriefcaseSlidesEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
);
e.registerSetting("DOCS_ENABLED",{
name:"zimbraFeatureBriefcaseDocsEnabled",type:ZmSetting.T_COS,dataType:ZmSetting.D_BOOLEAN,defaultValue:true}
)
};
ZmBriefcaseApp.prototype._registerItems=function(){
ZmItem.registerItem(ZmItem.BRIEFCASE,{
app:ZmApp.BRIEFCASE,nameKey:"document",icon:"GenericDoc",soapCmd:"ItemAction",itemClass:"ZmBriefcaseItem",node:"doc",organizer:ZmOrganizer.BRIEFCASE,dropTargets:[ZmOrganizer.TAG,ZmOrganizer.BRIEFCASE],searchType:"document",resultsList:AjxCallback.simpleClosure(function(e){
AjxDispatcher.require("BriefcaseCore");
return new ZmBriefcaseItemList(e,ZmItem.BRIEFCASE)
}
,this)}
)
};
ZmBriefcaseApp.prototype._registerOrganizers=function(){
ZmOrganizer.registerOrg(ZmOrganizer.BRIEFCASE,{
app:ZmApp.BRIEFCASE,nameKey:"folders",defaultFolder:ZmOrganizer.ID_BRIEFCASE,soapCmd:"FolderAction",firstUserId:256,orgClass:"ZmBriefcase",orgPackage:"BriefcaseCore",treeController:"ZmBriefcaseTreeController",labelKey:"folders",itemsKey:"files",treeType:ZmOrganizer.FOLDER,views:["document"],folderKey:"briefcase",mountKey:"mountFolder",createFunc:"ZmOrganizer.create",compareFunc:"ZmBriefcase.sortCompare",deferrable:false,newOp:ZmOperation.NEW_BRIEFCASEITEM,displayOrder:100,hasColor:true,childWindow:true}
)
};
ZmBriefcaseApp.prototype._setupSearchToolbar=function(){
ZmSearchToolBar.addMenuItem(ZmItem.BRIEFCASE,{
msgKey:"searchBriefcase",tooltipKey:"searchForFiles",icon:"Folder",shareIcon:"SharedBriefcase",setting:ZmSetting.BRIEFCASE_ENABLED,id:ZmId.getMenuItemId(ZmId.SEARCH,ZmId.ITEM_BRIEFCASE)}
)
};
ZmBriefcaseApp.prototype._registerApp=function(){
var a={};
a[ZmOperation.NEW_FILE]="uploadNewFile";
a[ZmOperation.NEW_DOC]="document";
var t={};
t[ZmOperation.NEW_BRIEFCASEITEM]="briefcase";
var e={};
e[ZmKeyMap.NEW_FILE]=ZmOperation.NEW_FILE;
e[ZmKeyMap.NEW_BRIEFCASEITEM]=ZmOperation.NEW_BRIEFCASEITEM;
e[ZmKeyMap.NEW_PRESENTATION]=ZmOperation.NEW_PRESENTATION;
e[ZmKeyMap.NEW_SPREADSHEET]=ZmOperation.NEW_SPREADSHEET;
e[ZmKeyMap.NEW_DOC]=ZmOperation.NEW_DOC;
ZmApp.registerApp(ZmApp.BRIEFCASE,{
mainPkg:"Briefcase",nameKey:"briefcase",icon:"Folder",textPrecedence:30,chooserTooltipKey:"gotoBriefcase",defaultSearch:ZmItem.BRIEFCASE,organizer:ZmOrganizer.BRIEFCASE,overviewTrees:[ZmOrganizer.BRIEFCASE,ZmOrganizer.TAG],searchTypes:[ZmItem.BRIEFCASE],newItemOps:a,newOrgOps:t,actionCodes:e,gotoActionCode:ZmKeyMap.GOTO_BRIEFCASE,newActionCode:ZmKeyMap.NEW_FILE,chooserSort:70,defaultSort:60}
)
};
ZmBriefcaseApp.prototype.deleteNotify=function(t,o){
if(!o&&this._deferNotifications("delete",t)){
return
}
var n=AjxDispatcher.run("GetBriefcaseController");
for(var e=0;
e<t.length;
e++){
var a=n.getItemById(t[e]);
if(a){
a.notifyDelete();
n.removeItem(a)
}}};
ZmBriefcaseApp.prototype.createNotify=function(n,r){
if(!n.folder&&!n.doc&&!n.link){
return
}
if(!r&&!this._noDefer&&this._deferNotifications("create",n)){
return
}
var h=AjxDispatcher.run("GetBriefcaseController");
var o=false;
for(var e in n){
var s=n[e];
for(var a=0;
a<s.length;
a++){
var t=s[a];
if(appCtxt.cacheGet(t.id)){
continue
}

if(e=="folder"){
this._handleCreateFolder(t,ZmOrganizer.BRIEFCASE)
}else{
if(e=="link"){
this._handleCreateLink(t,ZmOrganizer.BRIEFCASE)
}else{
if(e=="doc"){
if(t.l==h._currentFolder){
o=true
}}}}}}
if(o){
h.reloadFolder()
}};
ZmBriefcaseApp.prototype.modifyNotify=function(n,o){
if(!n.doc){
return
}
if(!o&&!this._noDefer&&this._deferNotifications("modify",n)){
return
}
var a=this.getBriefcaseController();
var s=false;
for(var e in n){
var h=n[e];
for(var r=0;
r<h.length;
r++){
var l=h[r];
var t=l.id;
if(!t){
continue
}
if(e=="doc"){
var c=a.getItemById(t);
if(c){
c.notifyModify(l);
c.set(l)
}
l._handled=true
}else{
if(e=="folder"){
var d=a.getCurrentFolderId();
if(appCtxt.getById(t)&&(appCtxt.getById(t).nId==d||t==d)){
s=true;
l._handled=true
}}}}}
if(s){
a.reloadFolder()
}};
ZmBriefcaseApp.prototype.handleOp=function(a){
switch(a){
case ZmOperation.NEW_FILE:var e=new AjxCallback(this,this._handleNewItem);
AjxDispatcher.require(["BriefcaseCore","Briefcase"],false,e,null,true);
break;
case ZmOperation.NEW_BRIEFCASEITEM:var e=new AjxCallback(this,this._handleLoadNewBriefcaseItem);
AjxDispatcher.require(["BriefcaseCore","Briefcase"],false,e,null,true);
break;
case ZmOperation.NEW_PRESENTATION:var e=new AjxCallback(this,this.newDoc,[ZmMimeTable.APP_ZIMBRA_SLIDES]);
AjxDispatcher.require(["BriefcaseCore","Briefcase"],true,e,null);
break;
case ZmOperation.NEW_SPREADSHEET:var t=new AjxCallback(this,this.newDoc,[ZmMimeTable.APP_ZIMBRA_SPREADSHEET]);
AjxDispatcher.require(["BriefcaseCore","Briefcase"],true,t,null);
break;
case ZmOperation.NEW_DOC:var t=new AjxCallback(this,this.newDoc,[ZmMimeTable.APP_ZIMBRA_DOC]);
AjxDispatcher.require(["BriefcaseCore","Briefcase"],true,t,null);
break
}};
ZmBriefcaseApp.prototype._handleNewDoc=function(s){
AjxDispatcher.require("IM");
var e=ZmPromptDialog.getInstance();
var o=new AjxCallback(this,this._newDocOkCallback,[s,e]);
var n=ZmMsg.briefcaseCreateNewDocument;
var t=ZmMsg.documentName;
if(s==ZmOperation.NEW_PRESENTATION){
n=ZmMsg.briefcaseCreateNewPresentation;
t=ZmMsg.presentationName
}
var a={
title:n,label:t,callback:o};
e.popup(a)
};
ZmBriefcaseApp.prototype._newDocOkCallback=function(r,c,s){
var p;
if(!s.value){
p=ZmMsg.nameEmpty
}
c.popdown();
if(p){
var l=appCtxt.getMsgDialog();
l.reset();
l.setMessage(p,DwtMessageDialog.CRITICAL_STYLE);
l.popup()
}else{
AjxDispatcher.require("Startup1_1");
var m=ZmMimeTable.APP_ZIMBRA_DOC;
switch(r){
case ZmOperation.NEW_PRESENTATION:m=ZmMimeTable.APP_ZIMBRA_SLIDES;
break
}
var e=appCtxt.getOverviewController();
var n=e.getTreeController(ZmOrganizer.BRIEFCASE);
var t=ZmOrganizer.ID_BRIEFCASE;
if(n){
var o=n.getTreeView(this.getOverviewId());
var u=o?o.getSelected():null;
t=u?u.id:ZmOrganizer.ID_BRIEFCASE
}
var d=this.getEditURLForContentType(m)+"?name="+s.value+"&l="+t;
var a="_newslide"+s.value;
var f=["width=",(screen.width||640),",","height=",(screen.height||480),",","resizable,toolbar=no,menubar=no,fullscreen=yes,location=no,status=no","fullscreen=yes"].join("");
var h=open(d,a,f)
}};
ZmBriefcaseApp.prototype.newDoc=function(c,t,h){
var a=appCtxt.getOverviewController();
var s=a.getTreeController(ZmOrganizer.BRIEFCASE);
var o=ZmOrganizer.ID_BRIEFCASE;
if(s){
var r=s.getTreeView(this.getOverviewId());
var l=r?r.getSelected():null;
o=l?l.id:ZmOrganizer.ID_BRIEFCASE
}
var e=this.getEditURLForContentType(c)+"?"+(t?"name="+t+"&":"")+"l="+o;
var n=h||t;
window.open(e,n)
};
ZmBriefcaseApp.prototype.getEditURLForContentType=function(t){
AjxDispatcher.require("Startup1_1");
var e="Slides.jsp";
switch(t){
case ZmMimeTable.APP_ZIMBRA_SLIDES:e="Slides.jsp";
break;
case ZmMimeTable.APP_ZIMBRA_SPREADSHEET:e="SpreadsheetDoc.jsp";
break;
case ZmMimeTable.APP_ZIMBRA_DOC:e="Docs.jsp";
break;
default:return null
}
return(appContextPath+"/public/"+e)
};
ZmBriefcaseApp.prototype.isDoclet=function(e){
var t=e.getContentType();
switch(t){
case ZmMimeTable.APP_ZIMBRA_SLIDES:return true;
default:return false
}};
ZmBriefcaseApp.prototype._handleNewItem=function(){
appCtxt.getAppViewMgr().popView(true,ZmId.VIEW_LOADING);
var e=new AjxCallback(this,this._handleUploadNewItem);
this.getBriefcaseController().__popupUploadDialog(e,ZmMsg.uploadFileToBriefcase)
};
ZmBriefcaseApp.prototype._handleUploadNewItem=function(t,e){
var a=this.getBriefcaseController();
a.refreshFolder()
};
ZmBriefcaseApp.prototype._handleLoadNewBriefcaseItem=function(){
appCtxt.getAppViewMgr().popView(true,ZmId.VIEW_LOADING);
if(!this._newNotebookCb){
this._newNotebookCb=new AjxCallback(this,this._newBriefcaseCallback)
}
ZmController.showDialog(appCtxt.getNewBriefcaseDialog(),this._newNotebookCb)
};
ZmBriefcaseApp.prototype.launch=function(t,a){
var e=new AjxCallback(this,this._handleLoadLaunch,[a]);
AjxDispatcher.require(["BriefcaseCore","Briefcase"],true,e,null,true)
};
ZmBriefcaseApp.prototype._handleLoadLaunch=function(e){
this.getBriefcaseController().show(null,true);
if(e){
e.run()
}};
ZmBriefcaseApp.prototype.showSearchResults=function(t,a){
var e=new AjxCallback(this,this._handleLoadShowSearchResults,[t,a]);
AjxDispatcher.require(["BriefcaseCore","Briefcase"],false,e,null,true)
};
ZmBriefcaseApp.prototype._handleLoadShowSearchResults=function(e,t){
this.getBriefcaseController().showFolderContents(e.getResults(ZmItem.MIXED));
if(t){
t.run()
}};
ZmBriefcaseApp.prototype.setActive=function(e){};
ZmBriefcaseApp.prototype._newBriefcaseCallback=function(o,a,t){
appCtxt.getNewBriefcaseDialog().popdown();
var e=appCtxt.getOverviewController();
e.getTreeController(ZmOrganizer.BRIEFCASE)._doCreate(o,a,t)
};
ZmBriefcaseApp.prototype.getBriefcaseController=function(){
if(!this._briefcaseController){
this._briefcaseController=new ZmBriefcaseController(this._container,this)
}
return this._briefcaseController
};
ZmBriefcaseApp.prototype.createFromAttachment=function(o,a,t){
var e=new AjxCallback(this,this._handleCreateFromAttachment,[o,a,t]);
AjxDispatcher.require(["BriefcaseCore","Briefcase"],false,e)
};
ZmBriefcaseApp.prototype._handleCreateFromAttachment=function(o,a,t){
if(this._deferredFolders.length!=0){
this._createDeferredFolders(ZmApp.BRIEFCASE)
}
var n=this._copyToDialog=appCtxt.getChooseFolderDialog();
var e=new AjxCallback(this,this._chooserCallback,[o,a,t]);
ZmController.showDialog(n,e,this._getCopyParams(n,o,a))
};
ZmBriefcaseApp.prototype._getCopyParams=function(a,t,e){
return{
data:{
msgId:t,partId:e}
,treeIds:[ZmOrganizer.BRIEFCASE],overviewId:a.getOverviewId(this._name),title:ZmMsg.addToBriefcaseTitle,description:ZmMsg.targetFolder,appName:ZmApp.BRIEFCASE}
};
ZmBriefcaseApp.prototype._chooserCallback=function(o,a,e,t){
var n=new AjxCallback(this,this.handleDuplicateCheck,[o,a,e,t.id]);
this.getBriefcaseController().getItemsInFolder(t.id,n)
};
ZmBriefcaseApp.prototype.handleDuplicateCheck=function(a,h,e,t,l){
var c=this.getBriefcaseController();
if(c.isReadOnly(t)){
ZmOrganizer._showErrorMsg(ZmMsg.errorPermission);
return
}
if(c.isShared(t)){
if(a.indexOf(":")<0){
a=appCtxt.getActiveAccount().id+":"+a
}}
var s=false;
if(l instanceof ZmList){
l=l.getArray()
}
for(var n in l){
var d=l[n];
if(d.name==e){
s=true;
break
}}
if(!s){
var r=new ZmBriefcaseItem();
r.createFromAttachment(a,h,e,t)
}else{
var o=AjxMessageFormat.format(ZmMsg.errorFileAlreadyExists,e);
ZmOrganizer._showErrorMsg(o)
}};
ZmBriefcaseApp.prototype.fixCrossDomainReference=function(t,a){
var n=AjxStringUtil.parseURL(t);
if(n.authority!=window.location.host){
if((a&&t.indexOf(a)>=0)||!a){
var o=n.protocol+"://"+n.authority;
var e=window.location.protocol+"//"+window.location.host;
t=t.replace(o,e)
}}
return t
};
ZmBriefcaseApp.prototype._createDeferredFolders=function(e){
AjxPackage.require("BriefcaseCore");
ZmApp.prototype._createDeferredFolders.call(this,e)
}
}
if(AjxPackage.define("zimbraMail.voicemail.ZmVoiceApp")){
ZmVoiceApp=function(t,e){
this.phones=[];
this._nameToPhone={};
this.accordionItem=null;
this.soapInfo={
method:"SearchVoiceRequest",namespace:"urn:zimbraVoice",response:"SearchVoiceResponse",additional:null};
this._storeprincipal=null;
ZmApp.call(this,ZmApp.VOICE,t,e)
};
ZmEvent.S_VOICEMAIL=ZmId.APP_VOICE;
ZmItem.VOICEMAIL=ZmId.ITEM_VOICEMAIL;
ZmEvent.S_CALL=ZmId.ITEM_CALL;
ZmItem.CALL=ZmEvent.S_CALL;
ZmOrganizer.VOICE=ZmEvent.S_VOICEMAIL;
ZmApp.VOICE="Voice";
ZmApp.CLASS[ZmApp.VOICE]="ZmVoiceApp";
ZmApp.SETTING[ZmApp.VOICE]=ZmSetting.VOICE_ENABLED;
ZmApp.UPSELL_SETTING[ZmApp.VOICE]=ZmSetting.VOICE_UPSELL_ENABLED;
ZmApp.LOAD_SORT[ZmApp.VOICE]=80;
ZmApp.QS_ARG[ZmApp.VOICE]="voice";
ZmVoiceApp.prototype=new ZmApp;
ZmVoiceApp.prototype.constructor=ZmVoiceApp;
ZmVoiceApp.prototype.toString=function(){
return"ZmVoiceApp"
};
ZmVoiceApp.prototype._defineAPI=function(){
AjxDispatcher.setPackageLoadFunction("Voicemail",new AjxCallback(this,this._postLoadCore));
AjxDispatcher.registerMethod("GetVoiceController","Voicemail",new AjxCallback(this,this.getVoiceController));
AjxDispatcher.registerMethod("GetCallListController","Voicemail",new AjxCallback(this,this.getCallListController))
};
ZmVoiceApp.prototype._registerItems=function(){
ZmItem.registerItem(ZmItem.VOICEMAIL,{
app:ZmApp.VOICE,nameKey:"voicemail",pluralNameKey:"voicemails",icon:"Voicemail",soapCmd:"VoiceMsgAction",itemClass:"ZmVoicemail",node:"vm",organizer:ZmOrganizer.VOICE,dropTargets:[ZmOrganizer.VOICE],searchType:"voicemail",resultsList:AjxCallback.simpleClosure(function(e){
AjxDispatcher.require("Voicemail");
return new ZmVoiceList(ZmItem.VOICEMAIL,e)
}
,this)}
);
ZmItem.registerItem(ZmItem.CALL,{
app:ZmApp.VOICE,nameKey:"call",pluralNameKey:"calls",icon:"Voicemail",soapCmd:"VoiceMsgAction",itemClass:"ZmCall",node:"cl",organizer:ZmOrganizer.VOICE,searchType:"calllog",resultsList:AjxCallback.simpleClosure(function(e){
AjxDispatcher.require("Voicemail");
return new ZmVoiceList(ZmItem.CALL,e)
}
,this)}
)
};
ZmVoiceApp.prototype._registerOperations=function(){
ZmOperation.registerOp(ZmId.OP_CHECK_VOICEMAIL,{
textKey:"checkVoicemail",tooltipKey:"checkVoicemailTooltip"}
);
ZmOperation.registerOp(ZmId.OP_CHECK_CALLS,{
textKey:"checkCalls",tooltipKey:"checkCallsTooltip"}
);
ZmOperation.registerOp(ZmId.OP_CALL_MANAGER,{
textKey:"callManager",tooltipKey:"callManagerTooltip",image:"CallManager",shortcut:ZmKeyMap.CALL_MANAGER}
);
ZmOperation.registerOp(ZmId.OP_MARK_HEARD,{
textKey:"markAsHeard",image:"MarkAsHeard",shortcut:ZmKeyMap.MARK_HEARD}
);
ZmOperation.registerOp(ZmId.OP_MARK_UNHEARD,{
textKey:"markAsUnheard",image:"MarkAsUnheard",shortcut:ZmKeyMap.MARK_UNHEARD}
);
ZmOperation.registerOp(ZmId.OP_VIEW_BY_DATE,{
textKey:"viewByDate"}
);
ZmOperation.registerOp(ZmId.OP_REPLY_BY_EMAIL,{
textKey:"replyByEmail",tooltipKey:"replyByEmailTooltip",image:"Reply"}
);
ZmOperation.registerOp(ZmId.OP_FORWARD_BY_EMAIL,{
textKey:"forwardByEmail",tooltipKey:"forwardByEmailTooltip",image:"Forward"}
);
ZmOperation.registerOp(ZmId.OP_DOWNLOAD_VOICEMAIL,{
textKey:"downloadVoicemail",tooltipKey:"downloadVoicemailTooltip",image:"Save"}
)
};
ZmVoiceApp.prototype._registerOrganizers=function(){
ZmOrganizer.registerOrg(ZmOrganizer.VOICE,{
app:ZmApp.VOICE,nameKey:"voicemailFolder",defaultFolder:0,firstUserId:256,orgClass:"ZmVoiceFolder",orgPackage:"Voicemail",treeController:"ZmVoiceTreeController",labelKey:"voicemail",itemsKey:"messages",views:["voicemail"],createFunc:"ZmOrganizer.create",compareFunc:"ZmVoiceFolder.sortCompare",displayOrder:100,deferrable:false}
)
};
ZmVoiceApp.prototype._registerApp=function(){
ZmApp.registerApp(ZmApp.VOICE,{
mainPkg:"Voicemail",nameKey:"voice",icon:"VoicemailApp",qsArg:"voicemail",chooserTooltipKey:"goToVoice",defaultSearch:ZmId.SEARCH_MAIL,overviewTrees:[ZmOrganizer.VOICE],searchTypes:[ZmItem.VOICEMAIL],gotoActionCode:ZmKeyMap.GOTO_VOICE,chooserSort:15,defaultSort:15,upsellUrl:ZmSetting.VOICE_UPSELL_URL}
)
};
ZmVoiceApp.prototype._registerPrefs=function(){};
ZmVoiceApp.prototype._registerSettings=function(e){
e=e||appCtxt.getSettings();
e.registerSetting("VOICE_PAGE_SIZE",{
name:"zimbraPrefVoiceItemsPerPage",type:ZmSetting.T_PREF,dataType:ZmSetting.D_INT,defaultValue:25}
);
e.registerSetting("VOICE_PAGE_SIZE_MAX",{
name:"zimbraMaxVoiceItemsPerPage",type:ZmSetting.T_COS,dataType:ZmSetting.D_INT,defaultValue:100}
)
};
ZmVoiceApp.prototype.deleteNotify=function(e){
this._handleDeletes(e)
};
ZmVoiceApp.prototype.createNotify=function(e){
this._handleCreates(e)
};
ZmVoiceApp.prototype.modifyNotify=function(e){
this._handleModifies(e)
};
ZmVoiceApp.prototype.getOverviewId=function(){
var e=this.accordionItem?this.accordionItem.data.phone.name:"";
return[this._name,e].join(":")
};
ZmVoiceApp.prototype.getOverviewContainer=function(){
if(!this._overviewContainer){
var e=[ZmApp.OVERVIEW_ID,this._name].join("_");
var t={
appName:this._name,containerId:e,posStyle:Dwt.ABSOLUTE_STYLE,parent:appCtxt.getShell(),controller:this._opc};
t.id=ZmId.getOverviewContainerId(e);
this._overviewContainer=this._opc._overviewContainer[e]=new ZmVoiceOverviewContainer(t)
}
return this._overviewContainer
};
ZmVoiceApp.prototype.getVoiceInfo=function(r,e,t){
if(!this.phones.length){
if(!this._gettingVoiceInfo){
var a=AjxSoapDoc.create("GetVoiceInfoRequest","urn:zimbraVoice");
var s=new AjxCallback(this,this._handleResponseVoiceInfo);
var o=new AjxCallback(this,this._handleErrorResponseVoiceInfo);
var n={
soapDoc:a,asyncMode:true,noBusyOverlay:t,callback:s,errorCallback:o};
appCtxt.getAppController().sendRequest(n);
this._gettingVoiceInfo=true
}
if(r){
this._voiceInfoCallbacks=this._voiceInfoCallbacks||[];
this._voiceInfoCallbacks.push(r)
}
if(e){
this._voiceInfoErrorCallbacks=this._voiceInfoErrorCallbacks||[];
this._voiceInfoErrorCallbacks.push(e)
}}else{
if(r){
r.run()
}}};
ZmVoiceApp.prototype._handleResponseVoiceInfo=function(e){
var t=new AjxCallback(this,this._handleResponseVoiceInfo2,[e]);
AjxPackage.require({
name:"Voicemail",callback:t}
)
};
ZmVoiceApp.prototype._handleResponseVoiceInfo2=function(t){
var s=t._data.GetVoiceInfoResponse;
this._storeprincipal=s.storeprincipal[0];
this.soapInfo.additional={
storeprincipal:this._storeprincipal};
var a=s.phone;
for(var o=0,n=a.length;
o<n;
o++){
var r=a[o];
var e=new ZmPhone();
e._loadFromDom(r);
this.phones.push(e);
this._nameToPhone[e.name]=e;
if(r.folder&&r.folder.length){
e.folderTree=new ZmVoiceFolderTree();
e.folderTree.loadFromJs(r.folder[0],e)
}}
if(this._voiceInfoCallbacks){
for(o=0,n=this._voiceInfoCallbacks.length;
o<n;
o++){
this._voiceInfoCallbacks[o].run(t)
}}
this._voiceInfoCallbacks=null;
this._voiceInfoErrorCallbacks=null;
this._gettingVoiceInfo=false
};
ZmVoiceApp.prototype._handleErrorResponseVoiceInfo=function(e){
var a=false;
if(this._voiceInfoErrorCallbacks){
for(var t=0,o=this._voiceInfoErrorCallbacks.length;
t<o;
t++){
a=this._voiceInfoErrorCallbacks[t].run(e)||a
}}
this._voiceInfoCallbacks=null;
this._voiceInfoErrorCallbacks=null;
this._gettingVoiceInfo=false;
return a
};
ZmVoiceApp.prototype.refreshFolders=function(n,e){
if(this.phones.length){
var t=AjxSoapDoc.create("GetVoiceFolderRequest","urn:zimbraVoice");
this.setStorePrincipal(t);
var o=new AjxCallback(this,this._handleResponseUpdateFolders,[n]);
var a={
soapDoc:t,asyncMode:true,callback:o,errorCallback:e};
appCtxt.getAppController().sendRequest(a)
}else{
if(n){
n.run()
}}};
ZmVoiceApp.prototype._handleResponseUpdateFolders=function(r,t){
var a=t._data.GetVoiceFolderResponse.phone;
for(var o=0,n=a.length;
o<n;
o++){
var s=a[o];
var e=this._nameToPhone[s.name];
if(e){
this._updateFolders(e,s.folder[0].folder)
}}
if(r){
r.run()
}};
ZmVoiceApp.prototype._updateFolders=function(t,r){
var s=t.folderTree;
for(var a=0,n=r.length;
a<n;
a++){
var e=r[a];
var o=s.getByName(e.name);
if(o){
o.notifyModify(e)
}}};
ZmVoiceApp.prototype.search=function(o,r,s){
var e=(o.getSearchType()==ZmItem.VOICEMAIL)?ZmId.VIEW_VOICEMAIL:ZmId.VIEW_CALL_LIST;
if((e==ZmId.VIEW_VOICEMAIL)&&!o.phone.hasVoiceMail){
AjxDispatcher.run("GetVoiceController").show(null,o);
if(r){
r.run(null)
}}else{
if(!s){
s=appCtxt.get(ZmSetting.SORTING_PREF,e)
}
var n={
soapInfo:this.soapInfo,types:AjxVector.fromArray([o.getSearchType()]),sortBy:s,query:o.getSearchQuery(),limit:this.getLimit()};
var t=new ZmSearch(n);
var a=new AjxCallback(this,this._handleResponseSearch,[o,r]);
t.execute({
callback:a}
)
}};
ZmVoiceApp.prototype._handleResponseSearch=function(e,c,t){
var o=t._data;
var s=o.getResults(e.getSearchType());
s.folder=e;
var r=(e.getSearchType()==ZmItem.VOICEMAIL)?AjxDispatcher.run("GetVoiceController"):AjxDispatcher.run("GetCallListController");
r.show(o,e);
if(!this._overviewContainer.initialized){
var h=this._getOverviewParams();
h.overviewTrees=this._getOverviewTrees();
h.phones=this.phones;
this._overviewContainer.initialize(h)
}
var a=o.getAttribute("vfi");
if(a){
e.notifyModify(a[0])
}
if(this._paramId){
var n=r.getList();
var d=n.getById(this._paramId);
if(d){
var l=r.getCurrentView();
l.setSelection(d,true);
l.setPlaying(d)
}}
if(c){
c.run(o)
}};
ZmVoiceApp.prototype.markItemsHeard=function(t,a,n,e){
var o=a?"read":"!read";
this._performAction(t,o,null,n,e)
};
ZmVoiceApp.prototype._performAction=function(l,r,o,d,s){
if(!l.length){
if(d){
d.run(l)
}
return
}
var e=[];
for(var n=0,h=l.length;
n<h;
n++){
e[n]=l[n].id
}
var c=AjxSoapDoc.create("VoiceMsgActionRequest","urn:zimbraVoice");
this.setStorePrincipal(c);
var t=c.set("action");
t.setAttribute("op",r);
t.setAttribute("id",e.join(","));
t.setAttribute("phone",l[0].getPhone().name);
for(var n in o){
t.setAttribute(n,o[n])
}
var a={
soapDoc:c,asyncMode:true,callback:d,errorCallback:s};
appCtxt.getAppController().sendRequest(a)
};
ZmVoiceApp.prototype.launch=function(t,a){
this._paramId=(t.qsParams?t.qsParams.id:null);
var e=new AjxCallback(this,this._handleLoadLaunch,[a]);
AjxDispatcher.require("Voicemail",true,e,null,true)
};
ZmVoiceApp.prototype._handleLoadLaunch=function(t){
var e=new AjxCallback(this,this._handleResponseLoadLaunchGotInfo,t);
this.getVoiceInfo(e)
};
ZmVoiceApp.prototype._handleResponseLoadLaunchGotInfo=function(a,e){
var t=this.getStartFolder();
if(t){
this.search(t,a)
}else{
if(a){
a.run()
}}};
ZmVoiceApp.prototype.getStartFolder=function(t){
var o=0;
if(t){
for(var a=0;
a<this.phones.length;
a++){
var e=this.phones[a];
if(e.name==t){
o=a
}}}
return this.phones[o].folderTree.getByName(ZmVoiceFolder.VOICEMAIL)
};
ZmVoiceApp.prototype.getVoiceController=function(){
if(!this._voiceController){
this._voiceController=new ZmVoicemailListController(this._container,this)
}
return this._voiceController
};
ZmVoiceApp.prototype.getCallListController=function(){
if(!this._callListController){
this._callListController=new ZmCallListController(this._container,this)
}
return this._callListController
};
ZmVoiceApp.prototype.setStorePrincipal=function(t){
var a=t.set("storeprincipal");
for(var e in this._storeprincipal){
a.setAttribute(e,this._storeprincipal[e])
}};
ZmVoiceApp.prototype.redoSearch=function(){
var t=appCtxt.getAppViewMgr().getAppView(ZmApp.VOICE);
if(t){
var e;
if(t==ZmId.VIEW_VOICEMAIL){
e=AjxDispatcher.run("GetVoiceController")
}else{
if(t==ZmId.VIEW_CALL_LIST){
e=AjxDispatcher.run("GetCallListController")
}}
if(e){
this.search(e.getFolder())
}}};
ZmVoiceApp.prototype._handleDeletes=function(e){};
ZmVoiceApp.prototype._handleCreates=function(e){};
ZmVoiceApp.prototype._handleModifies=function(e){};
ZmVoiceApp.prototype._getOverviewTrees=function(){
return[ZmOrganizer.VOICE]
}
}
if(AjxPackage.define("zimbraMail.mixed.ZmMixedApp")){
ZmMixedApp=function(e){
ZmApp.call(this,ZmApp.MIXED,e)
};
ZmItem.MIXED="MIXED";
ZmApp.MIXED=ZmId.APP_MIXED;
ZmApp.CLASS[ZmApp.MIXED]="ZmMixedApp";
ZmApp.SETTING[ZmApp.MIXED]=ZmSetting.MIXED_VIEW_ENABLED;
ZmApp.LOAD_SORT[ZmApp.MIXED]=50;
ZmMixedApp.prototype=new ZmApp;
ZmMixedApp.prototype.constructor=ZmMixedApp;
ZmMixedApp.prototype.toString=function(){
return"ZmMixedApp"
};
ZmMixedApp.prototype._defineAPI=function(){
AjxDispatcher.registerMethod("GetMixedController","Mixed",new AjxCallback(this,this.getMixedController))
};
ZmMixedApp.prototype._registerItems=function(){
ZmItem.registerItem(ZmItem.MIXED,{
app:ZmApp.MIXED}
)
};
ZmMixedApp.prototype._registerApp=function(){
ZmApp.registerApp(ZmApp.MIXED,{
mainPkg:"Mixed",nameKey:"zimbraTitle",icon:"Globe",overviewTrees:[ZmOrganizer.FOLDER,ZmOrganizer.ADDRBOOK,ZmOrganizer.SEARCH,ZmOrganizer.TAG],searchTypes:[ZmItem.MSG,ZmItem.CONV]}
)
};
ZmMixedApp.prototype.launch=function(){};
ZmMixedApp.prototype._getOverviewTrees=function(){
var a=ZmApp.OVERVIEW_TREES[this._name];
var e=[];
var n=appCtxt.getAppController().getPreviousApp();
for(var t=0;
t<a.length;
t++){
var o=a[t];
if((n==ZmApp.CONTACTS&&o==ZmOrganizer.FOLDER)||(n==ZmApp.MAIL&&o==ZmOrganizer.ADDRBOOK)){
continue
}
e.push(o)
}
return e
};
ZmMixedApp.prototype.showSearchResults=function(t,a){
var e=new AjxCallback(this,this._handleLoadShowSearchResults,[t,a]);
AjxDispatcher.require(["MailCore","Mail","Mixed"],false,e,null,true)
};
ZmMixedApp.prototype._handleLoadShowSearchResults=function(e,t){
this.getMixedController().show(e);
if(t){
t.run()
}};
ZmMixedApp.prototype.getMixedController=function(){
if(!this._mixedController){
this._mixedController=new ZmMixedController(this._container,this)
}
return this._mixedController
}
}}
if(AjxPackage.define("dwt.Widgets")){
AjxTemplate.register("dwt.Widgets#DwtAlert",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table width=100% border=0 cellpadding=0 cellspacing=0><tr><td width=1%><div id='";
e[a++]=n.id;
e[a++]="_icon' style='margin-right:5px;'></div></td><td width=99%><table border=0 cellpadding=0 cellspacing=0><tr><td id='";
e[a++]=n.id;
e[a++]="_title' class='DwtAlertTitle'></td></tr><tr><td id='";
e[a++]=n.id;
e[a++]="_content' class='DwtAlertContent'></td></tr></table></td><td width=1%><div id='";
e[a++]=n.id;
e[a++]="_dismiss' style='margin-left:5px;'></div></td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtAlert"}
,false);
AjxTemplate.register("dwt.Widgets",AjxTemplate.getTemplate("dwt.Widgets#DwtAlert"),AjxTemplate.getParams("dwt.Widgets#DwtAlert"));
AjxTemplate.register("dwt.Widgets#DwtCheckbox",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table cellpadding='2' cellspacing='0' border='0'><tr><td><label id='";
e[a++]=n.id;
e[a++]="_text_left' for='";
e[a++]=n.id;
e[a++]="_input' class='Text' style='text-align:right'></label></td><td><input id='";
e[a++]=n.id;
e[a++]="_input' name='";
e[a++]=n.name;
e[a++]="' value='";
e[a++]=n.value;
e[a++]="' type='checkbox' ";
e[a++]=n.checked;
e[a++]="></td><td><label id='";
e[a++]=n.id;
e[a++]="_text_right' for='";
e[a++]=n.id;
e[a++]="_input' class='Text' style='text-align:left'></label></td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtCheckbox"}
,false);
AjxTemplate.register("dwt.Widgets#DwtRadioButton",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table cellpadding='2' cellspacing='0' border='0'><tr><td><label id='";
e[a++]=n.id;
e[a++]="_text_left' for='";
e[a++]=n.id;
e[a++]="_input' class='Text' style='text-align:right'></label></td><td><input id='";
e[a++]=n.id;
e[a++]="_input' name='";
e[a++]=n.name;
e[a++]="' value='";
e[a++]=n.value;
e[a++]="' type='radio' ";
e[a++]=n.checked;
e[a++]="></td><td><label id='";
e[a++]=n.id;
e[a++]="_text_right' for='";
e[a++]=n.id;
e[a++]="_input' class='Text' style='text-align:left'></label></td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtRadioButton"}
,false);
AjxTemplate.register("dwt.Widgets#DwtBaseDialog",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='DwtDialog WindowOuterContainer'><table cellspacing=0 cellpadding=0><tr id='";
e[a++]=n.dragId;
e[a++]="'><td class='minWidth'>";
e[a++]=n.icon;
e[a++]="</td><td id='";
e[a++]=n.id;
e[a++]="_title' class='DwtDialogTitle'>";
e[a++]=n.title;
e[a++]="</td><td class='minWidth'><div class='";
e[a++]=n.closeIcon2;
e[a++]="'></div></td><td class='minWidth'><div class='";
e[a++]=n.closeIcon1;
e[a++]="'></div></td></tr><tr><td class='WindowInnerContainer' colspan='4'><div id='";
e[a++]=n.id;
e[a++]="_content' class='DwtDialogBody'></div>";
if(n.controlsTemplateId){
e[a++]=AjxTemplate.expand(n.controlsTemplateId,n)
}
e[a++]="</td></tr></table></div>";
return o?e.length:e.join("")
}
,{
width:"20",height:"32",id:"dwt.Widgets#DwtBaseDialog"}
,false);
AjxTemplate.register("dwt.Widgets#DwtDialogControls",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='horizSep'></div><div id='";
e[a++]=n.id;
e[a++]="_buttons' class='DwtDialogButtonBar'>";
if(AjxEnv.isNav){
e[a++]="<input type='button' id='";
e[a++]=n.id;
e[a++]="_focus' style='height:0px;width:0px;display:none;'>"
}
e[a++]="</div>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtDialogControls"}
,false);
AjxTemplate.register("dwt.Widgets#DwtSemiModalDialog",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='DwtDialog LightWindowOuterContainer'><table cellspacing=0 cellpadding=0 style='cursor:move;'><tr id='";
e[a++]=n.dragId;
e[a++]="'><td class='minWidth'>";
e[a++]=n.icon;
e[a++]="</td><td id='";
e[a++]=n.id;
e[a++]="_title' class='DwtDialogTitle'>";
e[a++]=n.title;
e[a++]="</td><td class='minWidth'><div class='";
e[a++]=n.closeIcon2;
e[a++]="'></div></td><td class='minWidth'><div class='";
e[a++]=n.closeIcon1;
e[a++]="'></div></td></tr><tr><td class='LightWindowInnerContainer full_size' colspan='4'><div id='";
e[a++]=n.id;
e[a++]="_content' class='DwtDialogBody'></div><div class='horizSep'></div><div id='";
e[a++]=n.id;
e[a++]="_buttons' class='DwtDialogButtonBar'>";
if(AjxEnv.isNav){
e[a++]="<input type='button' id='";
e[a++]=n.id;
e[a++]="_focus' style='height:0px;width:0px;display:none;'>"
}
e[a++]="</div></td></tr></table></div>";
return o?e.length:e.join("")
}
,{
width:"20",height:"32",id:"dwt.Widgets#DwtSemiModalDialog"}
,false);
AjxTemplate.register("dwt.Widgets#DwtToolTip",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=n.id;
e[a++]="TopPointer' class='DwtToolTipTopPointer'><center><div class='DwtToolTipPointerRow' style='width:1px;'>&nbsp;</div><div class='DwtToolTipPointerRow' style='width:3px;'>&nbsp;</div><div class='DwtToolTipPointerRow' style='width:5px;'>&nbsp;</div><div class='DwtToolTipPointerRow' style='width:7px;'>&nbsp;</div><div class='DwtToolTipPointerRow' style='width:9px;'>&nbsp;</div><div class='DwtToolTipPointerRow' style='width:11px;'>&nbsp;</div><div class='DwtToolTipPointerRow' style='width:13px;'>&nbsp;</div><div class='DwtToolTipPointerRow' style='width:15px;'>&nbsp;</div><div class='DwtToolTipPointerRow' style='width:17px;'>&nbsp;</div><div class='DwtToolTipPointerRow' style='width:19px;'>&nbsp;</div><div class='DwtToolTipPointerRow' style='width:21px;'>&nbsp;</div></center></div><div id='";
e[a++]=n.id;
e[a++]="Contents' class='DwtToolTipBody'></div><div id='";
e[a++]=n.id;
e[a++]="BottomPointer' class='DwtToolTipBottomPointer'><center><div class='DwtToolTipPointerRow' style='width:21px;'>&nbsp;</div><div class='DwtToolTipPointerRow' style='width:19px;'>&nbsp;</div><div class='DwtToolTipPointerRow' style='width:17px;'>&nbsp;</div><div class='DwtToolTipPointerRow' style='width:15px;'>&nbsp;</div><div class='DwtToolTipPointerRow' style='width:13px;'>&nbsp;</div><div class='DwtToolTipPointerRow' style='width:11px;'>&nbsp;</div><div class='DwtToolTipPointerRow' style='width:9px;'>&nbsp;</div><div class='DwtToolTipPointerRow' style='width:7px;'>&nbsp;</div><div class='DwtToolTipPointerRow' style='width:5px;'>&nbsp;</div><div class='DwtToolTipPointerRow' style='width:3px;'>&nbsp;</div><div class='DwtToolTipPointerRow' style='width:1px;'>&nbsp;</div></center></div>";
return o?e.length:e.join("")
}
,{
width:"5",height:"5",id:"dwt.Widgets#DwtToolTip"}
,false);
AjxTemplate.register("dwt.Widgets#DwtVerticalSash",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='DwtVerticalSash'><center><div class='ImgVSash_thumb'></div></center></div>";
return o?e.length:e.join("")
}
,{
width:"0",height:"0",id:"dwt.Widgets#DwtVerticalSash"}
,false);
AjxTemplate.register("dwt.Widgets#DwtHorizontalSash",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='DwtHorizontalSash'><table cellspacing=0 cellpadding=0 height='100%'><tr><td height='100%' valign='middle'><div class='ImgHSash_thumb'></div></td></tr></table></div>";
return o?e.length:e.join("")
}
,{
width:"0",height:"0",id:"dwt.Widgets#DwtHorizontalSash"}
,false);
AjxTemplate.register("dwt.Widgets#DwtMissingSoundPlayer",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table class='DwtMissingSoundPlayer'><tr><td nowrap class='ImgCritical'>&nbsp;</td><td nowrap>";
e[a++]=ZmMsg.missingPlugin;
e[a++]="</td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtMissingSoundPlayer"}
,false);
AjxTemplate.register("dwt.Widgets#DwtVerticalSlider",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=n.id;
e[a++]="_button' class='DwtThumb DwtSliderThumb'><div class='DwtSliderThumbBorder'><div class='ImgVerticalSliderThumb'></div></div></div>";
return o?e.length:e.join("")
}
,{
"class":"DwtSlider DwtVerticalSlider",id:"dwt.Widgets#DwtVerticalSlider"}
,false);
AjxTemplate.register("dwt.Widgets#DwtHorizontalSlider",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=n.id;
e[a++]="_button' class='DwtThumb DwtSliderThumb'><div class='DwtSliderThumbBorder'><div class='ImgHorizontalSliderThumb'></div></div></div>";
return o?e.length:e.join("")
}
,{
"class":"DwtSlider DwtHorizontalSlider",id:"dwt.Widgets#DwtHorizontalSlider"}
,false);
AjxTemplate.register("dwt.Widgets#ZLabel",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table class='ZWidgetTable ZLabelBorder' cellspacing=0 cellpadding=0><tr><td id='";
e[a++]=n.id;
e[a++]="_left_icon'  \tclass='ZLeftIcon ZWidgetIcon'></td><td id='";
e[a++]=n.id;
e[a++]="_title'\t\tclass='ZWidgetTitle'></td><td id='";
e[a++]=n.id;
e[a++]="_right_icon' \tclass='ZRightIcon ZWidgetIcon'></td></tr></table>";
return o?e.length:e.join("")
}
,{
"class":"ZWidget",id:"dwt.Widgets#ZLabel"}
,false);
AjxTemplate.register("dwt.Widgets#ZButton",function(a,r,s,t){
var n=Boolean(t);
s=(typeof s=="string"?{
id:s}
:s)||{};
t=t||[];
var o=t.length;
var e=s.buttonClass||"Button";
t[o++]="<table class='ZWidgetTable Z";
t[o++]=e;
t[o++]="Table Z";
t[o++]=e;
t[o++]="Border' cellspacing=0 cellpadding=0 style='table-layout:auto;'><tr><td id='";
t[o++]=s.id;
t[o++]="_left_icon'  \tclass='ZLeftIcon ZWidgetIcon'></td><td id='";
t[o++]=s.id;
t[o++]="_title'\t\tclass='ZWidgetTitle'></td><td id='";
t[o++]=s.id;
t[o++]="_right_icon' \tclass='ZRightIcon ZWidgetIcon'></td><td id='";
t[o++]=s.id;
t[o++]="_dropdown' \tclass='ZDropDown'></td></tr></table>";
return n?t.length:t.join("")
}
,{
"class":"ZWidget",id:"dwt.Widgets#ZButton"}
,false);
AjxTemplate.register("dwt.Widgets#ZToolbarButton",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
n.buttonClass=n.buttonClass||"ToolbarButton";
e[a++]=AjxTemplate.expand("#ZButton",n);
return o?e.length:e.join("")
}
,{
"class":"ZWidget",id:"dwt.Widgets#ZToolbarButton"}
,false);
AjxTemplate.register("dwt.Widgets#ZBorderlessButton",function(a,r,s,t){
var n=Boolean(t);
s=(typeof s=="string"?{
id:s}
:s)||{};

t=t||[];
var o=t.length;
var e=s.buttonClass||"Button";
t[o++]="<table class='ZWidgetTable Z";
t[o++]=e;
t[o++]="Table' cellspacing=0 cellpadding=0 style='table-layout:auto;'><tr><td id='";
t[o++]=s.id;
t[o++]="_left_icon'  \tclass='ZLeftIcon ZWidgetIcon'></td><td id='";
t[o++]=s.id;
t[o++]="_title'\t\tclass='ZWidgetTitle'></td><td id='";
t[o++]=s.id;
t[o++]="_right_icon' \tclass='ZRightIcon ZWidgetIcon'></td><td id='";
t[o++]=s.id;
t[o++]="_dropdown' \tclass='ZDropDown'></td></tr></table>";
return n?t.length:t.join("")
}
,{
"class":"ZWidget",id:"dwt.Widgets#ZBorderlessButton"}
,false);
AjxTemplate.register("dwt.Widgets#ZButtonColorDisplay",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=n.id;
e[a++]="_color' class='DwtButtonColorPicker-display' unselectable></div>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZButtonColorDisplay"}
,false);
AjxTemplate.register("dwt.Widgets#DwtComboBox",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table border=0 cellpadding=0 cellspacing=0><tr><td width=*><div id='";
e[a++]=n.id;
e[a++]="_input'></div></td><td><div id='";
e[a++]=n.id;
e[a++]="_button'></div></td></tr></table>";
return o?e.length:e.join("")
}
,{
"class":"DwtComboBox",id:"dwt.Widgets#DwtComboBox"}
,false);
AjxTemplate.register("dwt.Widgets#DwtComboBoxButton",function(a,r,s,t){
var n=Boolean(t);
s=(typeof s=="string"?{
id:s}
:s)||{};
t=t||[];
var o=t.length;
var e=s.buttonClass||"Button";
t[o++]="<table class='Z";
t[o++]=e;
t[o++]="Border' cellspacing=0 cellpadding=0><tr><td id='";
t[o++]=s.id;
t[o++]="_dropdown' class='ZDropDown'></td></tr></table>";
return n?t.length:t.join("")
}
,{
"class":"ZWidget",id:"dwt.Widgets#DwtComboBoxButton"}
,false);
AjxTemplate.register("dwt.Widgets#ZTabView",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=n.id;
e[a++]="_tabbar'></div><div id='";
e[a++]=n.id;
e[a++]="_page'></div>";
return o?e.length:e.join("")
}
,{
"class":"ZWidget",id:"dwt.Widgets#ZTabView"}
,false);
AjxTemplate.register("dwt.Widgets#ZTabBar",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table border=0 cellpadding=0 cellspacing=0><tr valign='bottom' id='";
e[a++]=n.id;
e[a++]="_items'>";
e[a++]=AjxTemplate.expand("#ZTabBarPrefix",n);
e[a++]=AjxTemplate.expand("#ZTabBarSuffix",n);
e[a++]="</tr></table>";
return o?e.length:e.join("")
}
,{
"class":"ZWidget",id:"dwt.Widgets#ZTabBar"}
,false);
AjxTemplate.register("dwt.Widgets#ZTabBarFloat",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=n.id;
e[a++]="_items'>";
e[a++]=AjxTemplate.expand("#ZTabBarPrefixFloat",n);
e[a++]=AjxTemplate.expand("#ZTabBarSuffixFloat",n);
e[a++]="</div>";
return o?e.length:e.join("")
}
,{
"class":"ZWidget",id:"dwt.Widgets#ZTabBarFloat"}
,false);
AjxTemplate.register("dwt.Widgets#ZTabBarPrefixFloat",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=n.id;
e[a++]="_prefix' class='ZTabBarPrefix'>&nbsp;</div>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZTabBarPrefixFloat"}
,false);
AjxTemplate.register("dwt.Widgets#ZTabBarSuffixFloat",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=n.id;
e[a++]="_suffix' class='ZTabBarSuffix'>&nbsp;</div>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZTabBarSuffixFloat"}
,false);
AjxTemplate.register("dwt.Widgets#ZTabBarPrefix",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<td id='";
e[a++]=n.id;
e[a++]="_prefix' class='ZTabBarPrefix'>&nbsp;</td>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZTabBarPrefix"}
,false);
AjxTemplate.register("dwt.Widgets#ZTabBarSuffix",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<td id='";
e[a++]=n.id;
e[a++]="_suffix' class='ZTabBarSuffix'>&nbsp;</td>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZTabBarSuffix"}
,false);
AjxTemplate.register("dwt.Widgets#ZTab",function(a,r,s,t){
var n=Boolean(t);
s=(typeof s=="string"?{
id:s}
:s)||{};
t=t||[];
var o=t.length;
var e=s.buttonClass||"Tab";
t[o++]="<table id='";
t[o++]=s.id;
t[o++]="_select' class='Z";
t[o++]=e;
t[o++]="Table Z";
t[o++]=e;
t[o++]="Border ZWidgetTable ZWidgetBorder' cellspacing=0 cellpadding=0><tr><td id='";
t[o++]=s.id;
t[o++]="_left_icon' class='ZLeftIcon ZWidgetIcon'></td><td id='";
t[o++]=s.id;
t[o++]="_title' class='ZWidgetTitle'></td><td id='";
t[o++]=s.id;
t[o++]="_right_icon' class='ZRightIcon ZWidgetIcon'></td></tr></table>";
return n?t.length:t.join("")
}
,{
"class":"ZWidget",id:"dwt.Widgets#ZTab"}
,false);
AjxTemplate.register("dwt.Widgets#ZTabFloat",function(a,r,s,t){
var n=Boolean(t);
s=(typeof s=="string"?{
id:s}
:s)||{};
t=t||[];
var o=t.length;
var e=s.buttonClass||"Tab";
t[o++]="<table id='";
t[o++]=s.id;
t[o++]="_select' class='Z";
t[o++]=e;
t[o++]="Table Z";
t[o++]=e;
t[o++]="Border ZWidgetBorder' cellspacing=0 cellpadding=0><tr><td id='";
t[o++]=s.id;
t[o++]="_left_icon' class='ZLeftIcon ZWidgetIcon'></td><td id='";
t[o++]=s.id;
t[o++]="_title' class='ZWidgetTitle'></td><td id='";
t[o++]=s.id;
t[o++]="_right_icon' class='ZRightIcon ZWidgetIcon'></td></tr></table>";
return n?t.length:t.join("")
}
,{
"class":"ZWidget",id:"dwt.Widgets#ZTabFloat"}
,false);
AjxTemplate.register("dwt.Widgets#ZTabPage",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="";
return o?e.length:e.join("")
}
,{
"class":"ZWidget",id:"dwt.Widgets#ZTabPage"}
,false);
AjxTemplate.register("dwt.Widgets#ZSelectAutoSizingContainer",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]='<table border=0 cellpadding=0 cellspacing=0><tr><td id="';
e[a++]=n.id;
e[a++]='_select_container">';
e[a++]=AjxTemplate.expand(n.selectTemplateId,n.selectData);
e[a++]='</td></tr><tr><td><table id="';
e[a++]=n.id;
e[a++]='_pseudoitems_container" border=0 cellpadding=0 cellspacing=0></table></td></tr></table>';
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZSelectAutoSizingContainer"}
,false);
AjxTemplate.register("dwt.Widgets#ZSelect",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]=AjxTemplate.expand("#ZButton",n);
return o?e.length:e.join("")
}
,{
"class":"ZWidget",id:"dwt.Widgets#ZSelect"}
,false);
AjxTemplate.register("dwt.Widgets#ZSelectMenu",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]=AjxTemplate.expand("#ZMenu",n);
return o?e.length:e.join("")
}
,{
"class":"ZWidget",id:"dwt.Widgets#ZSelectMenu"}
,false);
AjxTemplate.register("dwt.Widgets#ZSelectMenuItem",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]=AjxTemplate.expand("#ZMenuItem",n);
return o?e.length:e.join("")
}
,{
"class":"ZWidget",id:"dwt.Widgets#ZSelectMenuItem"}
,false);
AjxTemplate.register("dwt.Widgets#ZToolbar",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table class='ZToolbarTable' border=0 cellpadding=0 cellspacing=0><tr id='";
e[a++]=n.id;
e[a++]="_items'>";
e[a++]=AjxTemplate.expand("#ZToolbarPrefix",n);
e[a++]=AjxTemplate.expand("#ZToolbarSuffix",n);
e[a++]="</tr></table>";
return o?e.length:e.join("")
}
,{
"class":"ZWidget",id:"dwt.Widgets#ZToolbar"}
,false);
AjxTemplate.register("dwt.Widgets#ZToolbarPrefix",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};

e=e||[];
var a=e.length;
e[a++]="";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZToolbarPrefix"}
,false);
AjxTemplate.register("dwt.Widgets#ZToolbarSuffix",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZToolbarSuffix"}
,false);
AjxTemplate.register("dwt.Widgets#ZToolbarItem",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table><tr><td id='";
e[a++]=n.itemId;
e[a++]="'></td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZToolbarItem"}
,false);
AjxTemplate.register("dwt.Widgets#ZToolbarSeparator",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table><tr><td id='";
e[a++]=n.itemId;
e[a++]="' class='ZToolbarSeparator'>&nbsp;</td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZToolbarSeparator"}
,false);
AjxTemplate.register("dwt.Widgets#ZToolbarSpacer",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table><tr><td id='";
e[a++]=n.itemId;
e[a++]="' class='ZToolbarSpacer'>&nbsp;</td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZToolbarSpacer"}
,false);
AjxTemplate.register("dwt.Widgets#ZToolbarFiller",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table><tr><td id='";
e[a++]=n.itemId;
e[a++]="' class='ZToolbarFiller' width='100%'>&nbsp;</td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZToolbarFiller"}
,false);
AjxTemplate.register("dwt.Widgets#ZField",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<input id='";
e[a++]=n.id;
e[a++]="_field' class='ZFieldInput'>";
return o?e.length:e.join("")
}
,{
"class":"ZWidget",id:"dwt.Widgets#ZField"}
,false);
AjxTemplate.register("dwt.Widgets#ZTreeItem",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='";
e[a++]=n.divClassName;
e[a++]="' id='";
e[a++]=n.id;
e[a++]="_div'><table id='";
e[a++]=n.id;
e[a++]="_table' border=0 cellpadding=0 cellspacing=0 width=100%><tr><td align=center nowrap id='";
e[a++]=n.id;
e[a++]="_nodeCell'></td>";
if(n.isCheckedStyle){
e[a++]="<td nowrap id='";
e[a++]=n.id;
e[a++]='_checkboxCell\' class="ZTreeItemCheckboxCell"><div class="ZTreeItemCheckbox" id=\'';
e[a++]=n.id;
e[a++]="_checkbox'><div class=\"ZTreeItemCheckboxImg\" id='";
e[a++]=n.id;
e[a++]="_checkboxImg'>";
e[a++]=AjxImg.getImageHtml("MenuCheck");
e[a++]="</div></div></td>"
}
e[a++]="<td nowrap class='imageCell' id='";
e[a++]=n.id;
e[a++]="_imageCell'></td><td width=100% nowrap class='";
e[a++]=n.textClassName;
e[a++]="' id='";
e[a++]=n.id;
e[a++]="_textCell'></td><td width=16 class='imageCell' id='";
e[a++]=n.id;
e[a++]="_extraCell'></td></tr></table></div>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZTreeItem"}
,false);
AjxTemplate.register("dwt.Widgets#ZHeaderTreeItem",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='";
e[a++]=n.divClassName;
e[a++]="' id='";
e[a++]=n.id;
e[a++]="_div'><table id='";
e[a++]=n.id;
e[a++]="_table' border=0 cellpadding=0 cellspacing=0><tr>";
if(!n.noNodeCell){
e[a++]="<td align=center nowrap id='";
e[a++]=n.id;
e[a++]="_nodeCell'></td>"
}
e[a++]="<td nowrap class='imageCell' id='";
e[a++]=n.id;
e[a++]="_imageCell'></td><td nowrap class='";
e[a++]=n.textClassName;
e[a++]="' id='";
e[a++]=n.id;
e[a++]="_textCell' width=\"100%\"></td><td class='";
e[a++]=n.textClassName;
e[a++]=" FakeAnchor' style=\"padding-right:4px\"><div id='";
e[a++]=n.id;
e[a++]="_headerButton'/></td></tr></table></div>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZHeaderTreeItem"}
,false);
AjxTemplate.register("dwt.Widgets#ZAccordion",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=n.id;
e[a++]="_div'><table class='ZAccordionTable ZWidget' border=0 cellspacing=0 cellpadding=0 id='";
e[a++]=n.id;
e[a++]="_accordion_table'></table></div>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZAccordion"}
,false);
AjxTemplate.register("dwt.Widgets#ZAccordionItem",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=n.id;
e[a++]="_header_";
e[a++]=n.itemNum;
e[a++]="' class='ZAccordionHeader'><table class='ZAccordionHeaderBorder ZWidgetTable' cellspacing=0 cellpadding=0><tr><td><div class='";
e[a++]=n.icon;
e[a++]="' id='";
e[a++]=n.id;
e[a++]="_icon_";
e[a++]=n.itemNum;
e[a++]="'></div></td><td><div class='ZAccordionTitle' id='";
e[a++]=n.id;
e[a++]="_title_";
e[a++]=n.itemNum;
e[a++]="'>";
e[a++]=n.title;
e[a++]="</div></td><td><div class='ImgAccordionClosed' id='";
e[a++]=n.id;
e[a++]="_status_";
e[a++]=n.itemNum;
e[a++]="'></div></td></tr></table></div><div class='ZAccordionBody' id='";
e[a++]=n.id;
e[a++]="_body_";
e[a++]=n.itemNum;
e[a++]="'></div>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZAccordionItem"}
,false);
AjxTemplate.register("dwt.Widgets#DwtTabView",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table width='100%' border='0' cellspacing='0' cellpadding='0' backgroundColor='";
e[a++]=n.bgcolor;
e[a++]="'><tr align='left' valign='middle'><td id='";
e[a++]=n.id;
e[a++]="_tabs' class='DwtTabTable' nowrap align='left' valign='middle' width='100%'></td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtTabView"}
,false);
AjxTemplate.register("dwt.Widgets#DwtTabBar",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<!-- TODO -->";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtTabBar"}
,false);
AjxTemplate.register("dwt.Widgets#DwtTabSpacer",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table width='100%' cellspacing='0' cellpadding='0'><tr></tr><tr></tr><tr><td><div class='ImgTabSpacer'></div></td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtTabSpacer"}
,false);
AjxTemplate.register("dwt.Widgets#ZMenu",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=n.id;
e[a++]="_container' class='ZMenuBorder'></div>";
return o?e.length:e.join("")
}
,{
"class":"ZWidget",id:"dwt.Widgets#ZMenu"}
,false);
AjxTemplate.register("dwt.Widgets#ZMenuItem",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table class='ZWidgetTable ZMenuItemTable ZMenuItemBorder' cellspacing=0 cellpadding=0><tr><td id='";
e[a++]=n.id;
e[a++]="_check' class='ZCheckIcon'><div></div></td><td id='";
e[a++]=n.id;
e[a++]="_left_icon' class='ZLeftIcon ZWidgetIcon'><div></div></td><td id='";
e[a++]=n.id;
e[a++]="_title' class='ZWidgetTitle'></td><td id='";
e[a++]=n.id;
e[a++]="_dropdown' class='ZDropDown'><div></div></td></tr></table>";
return o?e.length:e.join("")
}
,{
"class":"ZWidget",id:"dwt.Widgets#ZMenuItem"}
,false);
AjxTemplate.register("dwt.Widgets#ZMenuItemSeparator",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table class='ZWidgetTable ZMenuItemTable ZMenuItemBorder ZMenuItemSeparatorBorder' cellspacing=0 cellpadding=0><tr><td id='";
e[a++]=n.id;
e[a++]="_title' class='ZWidgetTitle'><div class='ZMenuItem-Separator'></div></td></tr></table>";
return o?e.length:e.join("")
}
,{
"class":"ZWidget",id:"dwt.Widgets#ZMenuItemSeparator"}
,false);
AjxTemplate.register("dwt.Widgets#ZMenuItemBlankCheck",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='ZMenuItem-BlankCheck'></div>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZMenuItemBlankCheck"}
,false);
AjxTemplate.register("dwt.Widgets#ZMenuItemBlankIcon",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='ZMenuItem-BlankIcon'></div>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZMenuItemBlankIcon"}
,false);
AjxTemplate.register("dwt.Widgets#ZMenuItemBlankCascade",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='ZMenuItem-BlankCascade'></div>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#ZMenuItemBlankCascade"}
,false);
AjxTemplate.register("dwt.Widgets#DwtListView-NoResults",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table width='100%' cellspacing=0 cellpadding=1><tr><td class='NoResults' valign='top'><br><br>";
e[a++]=n.message;
e[a++]="\n";
e[a++]="\t\t\t</td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtListView-NoResults"}
,false);
AjxTemplate.register("dwt.Widgets#DwtPasswordField",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table cellpadding='0' cellspacing='0' border='0'><tr><td><div id='";
e[a++]=n.id;
e[a++]="_input'></div></td><td><div id='";
e[a++]=n.id;
e[a++]="_show_password'></div></td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtPasswordField"}
,false);
AjxTemplate.register("dwt.Widgets#DwtFormRows",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]='<table border=0 cellspacing=3 cellpadding=0><tbody id="';
e[a++]=n.id;
e[a++]='_rows" tabindex="100"></tbody></table>';
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtFormRows"}
,false);
AjxTemplate.register("dwt.Widgets#DwtFormRow",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]='<table><tr id="';
e[a++]=n.id;
e[a++]='_row" class="DwtFormRow"><td><div id="';
e[a++]=n.id;
e[a++]='" tabindex="100"></div></td><td><div id="';
e[a++]=n.id;
e[a++]='_add" class="DwtFormRowAdd" tabindex="200"></div></td><td><div id="';
e[a++]=n.id;
e[a++]='_remove" class="DwtFormRowRemove" tabindex="300"></div></td></tr></table>';
return o?e.length:e.join("")
}
,{
id:"dwt.Widgets#DwtFormRow"}
,false)
}
if(AjxPackage.define("share.App")){
AjxTemplate.register("share.App#Loading",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table border=0 cellpadding=0 cellspacing=0 style='width:100%;height=100%'><tr><td align='center' valign='middle'><br><br><br>";
e[a++]=ZmMsg.loading;
e[a++]="<br><br><div class='Imgwait_64'></div><br><br><br></td></tr><tr><td style='height:100%'>&nbsp;</td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"share.App#Loading"}
,false);
AjxTemplate.register("share.App",AjxTemplate.getTemplate("share.App#Loading"),AjxTemplate.getParams("share.App#Loading"));
AjxTemplate.register("share.App#Banner",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table border=0 cellpadding=0 cellspacing=0 style='width:100%;height:100%'><tr><td align='center' valign='middle'><a";
if(n.url&&n.url!=""){
e[a++]=" href='";
e[a++]=n.url;
e[a++]="' target='_blank'"
}
e[a++]="><div class='ImgAppBanner'></div></a></td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"share.App#Banner"}
,false);
AjxTemplate.register("share.App#UserInfo",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table class='skin_table' cellpadding=0 cellspacing=0 border=0>";
if(n.showOfflineLink){
e[a++]='<tr><td id=\'skin_td_switch_offline\' colspan=3><a href="http://www.zimbra.com/products/desktop.html" target="_blank">';
e[a++]=ZmMsg.switchToOfflineClientEx;
e[a++]="</a></td></tr>"
}
e[a++]="<tr>";
if(n.adminUrl){
e[a++]='<td id="skin_container_adminlink"><table border=0 cellpadding=0 cellspacing=0><tr><td><a target="_blank" href="';
e[a++]=n.adminUrl;
e[a++]='">';
e[a++]=AjxImg.getImageHtml("Status",null,"border=0");
e[a++]='</a></td><td style=\'white-space:nowrap; font-weight:bold\'><a target="_blank" href="';
e[a++]=n.adminUrl;
e[a++]='">';
e[a++]=ZmMsg.adminLinkLabel;
e[a++]="</a></td></tr></table></td>"
}
e[a++]="<td id='skin_container_help'><table border=0 cellpadding=0 cellspacing=0><tr>";
if(n.helpIcon){
e[a++]="<td style='padding-right:3px;'><a href='javascript:;' onclick='ZmZimbraMail.helpLinkCallback();'>";
e[a++]=AjxImg.getImageHtml(n.helpIcon,null,"border=0");
e[a++]="</a></td>"
}
e[a++]="<td style='white-space:nowrap; font-weight:bold'><a href='javascript:;' onclick='ZmZimbraMail.helpLinkCallback();'>";
e[a++]=ZmMsg.help;
e[a++]="</a></td></tr></table></td><td id='skin_container_logoff'><table border=0 cellpadding=0 cellspacing=0><tr>";
if(n.logoutIcon){
e[a++]="<td style='padding-right:3px;'><a href='javascript:;' onclick='ZmZimbraMail._onClickLogOff();'>";
e[a++]=AjxImg.getImageHtml(n.logoutIcon,null,"border=0");
e[a++]="</a></td>"
}
e[a++]="<td style='white-space:nowrap; font-weight:bold'><a href='javascript:;' onclick='ZmZimbraMail._onClickLogOff();'>";
e[a++]=n.logoutText;
e[a++]="</a></td></tr></table></td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"share.App#UserInfo"}
,false);
AjxTemplate.register("share.App#PrintView",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<html><head><title>";
e[a++]=ZmMsg.zimbraLabel;
e[a++]=" ";
e[a++]=n.username;
e[a++]="</title><link rel='stylesheet' href='";
e[a++]=n.appContextPath;
e[a++]="/css/msgview,zm,wiki.css?v=";
e[a++]=n.cacheKillerVersion;
e[a++]="' media='screen'></link>";
if(n.onloadStr){
e[a++]="<script language='javascript'>\n";
e[a++]="\t\t\t\t\tfunction handleOnload() {\n";
e[a++]="\t\t\t\t\t\t";
e[a++]=n.onloadStr;
e[a++]=";\n";
e[a++]="\t\t\t\t\t}\n";
e[a++]="\t\t\t\t<\/script></head><body onload='handleOnload();'>"
}else{
e[a++]="</head><body>"
}
e[a++]="<table border=0 width=100%><tr><td class='ZmPrintView-company'>";
e[a++]=ZmMsg.zimbraTitle;
e[a++]=" ";
e[a++]=ZmMsg.splashScreenAppName;
e[a++]="</td><td class='ZmPrintView-username' align=right>";
e[a++]=n.username;
e[a++]="</td></tr></table><hr><div style='padding:10px'>";
e[a++]=n.content;
e[a++]="</div></body></html>";
return o?e.length:e.join("")
}
,{
id:"share.App#PrintView"}
,false);
AjxTemplate.register("share.App#FolderTooltip",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table cellpadding=0 cellspacing=0 border=0><tr><td valign='top' style='padding-right:20px'>";
e[a++]=AjxMessageFormat.format(ZmMsg.makeLabel,n.itemText);
e[a++]="</td><td valign='top'>";
e[a++]=n.numTotal;
e[a++]="</td></tr>";
if(n.sizeTotal){
e[a++]="<tr><td valign='top'>";
e[a++]=ZmMsg.sizeLabel;
e[a++]="</td><td valign='top'>";
e[a++]=AjxUtil.formatSize(n.sizeTotal);
e[a++]="</td></tr>"
}
e[a++]="</table>";
return o?e.length:e.join("")
}
,{
id:"share.App#FolderTooltip"}
,false);
AjxTemplate.register("share.App#ZimbraAccountTooltip",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table border=0>";
if(n.lastSync&&n.lastSync!=""){
e[a++]="<tr><td class='nobreak' align=right>";
e[a++]=ZmMsg.lastSync;
e[a++]=":</td><td class='nobreak'>";
e[a++]=n.lastSync;
e[a++]="</td></tr>"
}else{
if(!n.isInitialSync){
e[a++]="<tr><td class='nobreak' colspan=2>";
e[a++]=ZmMsg.neverSynced;
e[a++]="</td></tr>"
}}
if(n.status&&n.status!=""){
e[a++]="<tr><td align=right valign=top>";
e[a++]=ZmMsg.status;
e[a++]=":</td><td>";
e[a++]=n.status;
e[a++]="</td></tr>"
}
e[a++]="</table>";
return o?e.length:e.join("")
}
,{
id:"share.App#ZimbraAccountTooltip"}
,false);
AjxTemplate.register("share.App#presenceButton",function(a,r,s,t){
var n=Boolean(t);
s=(typeof s=="string"?{
id:s}
:s)||{};
t=t||[];
var o=t.length;
var e=s.buttonClass||"ToolbarButton";
t[o++]="<table class='ZWidgetTable Z";
t[o++]=e;
t[o++]="Table Z";
t[o++]=e;
t[o++]="Border' cellspacing=0 cellpadding=0 style='table-layout:auto;'><tr><td id='";
t[o++]=s.id;
t[o++]="_left_icon'  \tclass='ZLeftIcon ZWidgetIcon'></td><td id='";
t[o++]=s.id;
t[o++]="_title'\t\tclass='ZWidgetTitle'></td></tr></table>";
return n?t.length:t.join("")
}
,{
"class":"ZWidget",id:"share.App#presenceButton"}
,false);
AjxTemplate.register("share.App#ZmTaskbarItem",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=n.id;
e[a++]="_button' class='ZmTaskbarButtonParent'></div><div id='";
e[a++]=n.id;
e[a++]="_content' class='ZmTaskbarContentParent' style='display:none;'></div>";
return o?e.length:e.join("")
}
,{
"class":"ZWidget",id:"share.App#ZmTaskbarItem"}
,false);
AjxTemplate.register("share.App#ZmStatusImageButton",function(a,r,s,t){
var n=Boolean(t);
s=(typeof s=="string"?{
id:s}
:s)||{};
t=t||[];
var o=t.length;
var e=s.buttonClass||"ToolbarButton";
t[o++]="<table class='ZWidgetTable Z";
t[o++]=e;
t[o++]="Table Z";
t[o++]=e;
t[o++]="Border' cellspacing=0 cellpadding=0 style='table-layout:auto;'><tr><td id='";
t[o++]=s.id;
t[o++]="_left_icon'  \tclass='ZLeftIcon ZWidgetIcon'></td><td id='";
t[o++]=s.id;
t[o++]="_status_icon'\tclass='ZLeftIcon ZWidgetIcon'><div></div></td></tr></table>";
return n?t.length:t.join("")
}
,{
"class":"ZWidget",id:"share.App#ZmStatusImageButton"}
,false)
}
if(AjxPackage.define("share.Dialogs")){
AjxTemplate.register("share.Dialogs#TableProperties",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]='<table class="ZmHEDialog"><tr><td><fieldset class="ZmFieldset"><legend class="ZmLegend">';
e[a++]=ZmMsg.description;
e[a++]='</legend><table width="100%"><tr><td class="Label" style="width: auto">';
e[a++]=ZmMsg.caption;
e[a++]='</td><td width="100%" id="';
e[a++]=n.id;
e[a++]='_Caption"></td></tr><tr><td class="Label" style="width: auto">';
e[a++]=ZmMsg.summary;
e[a++]='</td><td width="100%" id="';
e[a++]=n.id;
e[a++]='_Summary"></td></tr></table></fieldset><fieldset class="ZmFieldset"><legend class="ZmLegend">';
e[a++]=ZmMsg.layout;
e[a++]='</legend><table cellspacing="0"><tr><td class="Label">';
e[a++]=ZmMsg.tableWidth;
e[a++]='</td><td colspan="4"><table cellpadding="0" cellspacing="0"><tr><td style="padding-right: 2px"><input id="';
e[a++]=n.id;
e[a++]='_WidthAuto" checked="checked" name="';
e[a++]=n.id;
e[a++]='_WidthAuto" type="radio" /></td><td style="padding-right: 2em" colspan="2"><label for="';
e[a++]=n.id;
e[a++]='_WidthAuto">';
e[a++]=ZmMsg.auto;
e[a++]='</label></td></tr><tr><td style="padding-right: 2px"><input id="';
e[a++]=n.id;
e[a++]='_WidthAuto1" name="';
e[a++]=n.id;
e[a++]='_WidthAuto" type="radio" /></td><td style="padding-right: 3px" id="';
e[a++]=n.id;
e[a++]='_Width"></td><td id="';
e[a++]=n.id;
e[a++]='_WidthUnit"></td></tr></table></td></tr></table><table cellspacing="0" id="';
e[a++]=n.id;
e[a++]='_AdvancedMode1" style="margin-top: 4px; display: none"><tr><td class="Label">';
e[a++]=ZmMsg.tableAlignment;
e[a++]='</td><td class="col2" id="';
e[a++]=n.id;
e[a++]='_Align"></td><td class="VSep-L">&nbsp;</td><td class="VSep-R">&nbsp;</td><td><table cellpadding="1" cellspacing="1"><tr><td><input type="checkbox" id="';
e[a++]=n.id;
e[a++]='_FixedLayout" /></td><td><label for="';
e[a++]=n.id;
e[a++]='_FixedLayout">';
e[a++]=ZmMsg.fixedCellWidth;
e[a++]='</label></td></tr></table></td></tr></table></fieldset><fieldset class="ZmFieldset"><legend class="ZmLegend">';
e[a++]=ZmMsg.textStyle;
e[a++]='</legend><table cellspacing="0"><tr><td class="Label">';
e[a++]=ZmMsg.textAlign;
e[a++]='</td><td class="col2" id="';
e[a++]=n.id;
e[a++]='_TextAlign"></td><td class="VSep-L">&nbsp;</td><td class="VSep-R">&nbsp;</td><td class="Label">';
e[a++]=ZmMsg.fontColorLabel;
e[a++]='</td><td id="';
e[a++]=n.id;
e[a++]='_ForegroundColor"></td></tr><tr><td class="Label">';
e[a++]=ZmMsg.verticalAlign;
e[a++]='</td><td id="';
e[a++]=n.id;
e[a++]='_TextVAlign"></td><td class="VSep-L">&nbsp;</td><td class="VSep-R">&nbsp;</td><td class="Label">';
e[a++]=ZmMsg.fontBackgroundLabel;
e[a++]='</td><td id="';
e[a++]=n.id;
e[a++]='_BackgroundColor"></td></tr></table></fieldset><fieldset class="ZmFieldset"><legend class="ZmLegend">';
e[a++]=ZmMsg.borderStyle;
e[a++]='</legend><table cellspacing="0"><tr><td class="Label">';
e[a++]=ZmMsg.borderWidth;
e[a++]='</td><td class="col2" id="';
e[a++]=n.id;
e[a++]='_BorderWidth"></td><td class="VSep-L">&nbsp;</td><td class="VSep-R">&nbsp;</td><td class="Label">';
e[a++]=ZmMsg.borderColorLabel;
e[a++]='</td><td><table cellspacing="0"><tr><td id="';
e[a++]=n.id;
e[a++]='_BorderColor"></td></tr></table></td></tr><tr><td class="Label">';
e[a++]=ZmMsg.cellPadding;
e[a++]='</td><td id="';
e[a++]=n.id;
e[a++]='_CellPadding"></td><td class="VSep-L">&nbsp;</td><td class="VSep-R">&nbsp;</td><td class="Label">';
e[a++]=ZmMsg.borderStyleLabel;
e[a++]='</td><td id="';
e[a++]=n.id;
e[a++]='_BorderStyle"></td></tr><tr id="';
e[a++]=n.id;
e[a++]='_AdvancedMode2" style="display: none"><td class="Label">';
e[a++]=ZmMsg.cellSpacing;
e[a++]='</td><td id="';
e[a++]=n.id;
e[a++]='_BorderSpacing"></td><td class="VSep-L">&nbsp;</td><td class="VSep-R">&nbsp;</td><td colspan="2" style="padding: 2px 0 2px 0"><table cellpadding="1" cellspacing="1" align="center"><tr><td><input type="checkbox" id="';
e[a++]=n.id;
e[a++]='_BorderCollapse" /></td><td><label for="';
e[a++]=n.id;
e[a++]='_BorderCollapse">';
e[a++]=ZmMsg.collapsedBorders;
e[a++]="</label></td></tr></table></td></tr></table></fieldset></td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"share.Dialogs#TableProperties"}
,false);
AjxTemplate.register("share.Dialogs",AjxTemplate.getTemplate("share.Dialogs#TableProperties"),AjxTemplate.getParams("share.Dialogs#TableProperties"));
AjxTemplate.register("share.Dialogs#CellProperties",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]='<table class="ZmHEDialog"><tr><td><fieldset class="ZmFieldset"><legend class="ZmLegend">';
e[a++]=ZmMsg.borderStyle;
e[a++]='</legend><table width="100%"><tr><td style="width: 19em"><!-- If you\'re wondering why this has to be so complex, check out this bug:\n';
e[a++]='\t\t\t\t\t\t\t\thttps://bugzilla.mozilla.org/show_bug.cgi?id=258255 --><div style="padding-left: 1em; padding-top: 1em">';
e[a++]=ZmMsg.clickToDrawABorder;
e[a++]='</div><div style="margin-top: 10px;"><table align="center"><tr><td>';
e[a++]=ZmMsg.styleLabel;
e[a++]="</td><td>";
e[a++]=ZmMsg.colorLabel;
e[a++]="</td><td>";
e[a++]=ZmMsg.widthLabel;
e[a++]='</td></tr><tr><td id="';
e[a++]=n.id;
e[a++]='_BorderStyle"></td><td><!-- embedded in a table so the widget doesn\'t enlarge --><table cellspacing="0" cellpadding="0"><tr><td id="';
e[a++]=n.id;
e[a++]='_BorderColor"></td></tr></table></td><td id="';
e[a++]=n.id;
e[a++]='_BorderWidth"></td></tr></table></div><table id="';
e[a++]=n.id;
e[a++]='_PreviewGridHolder" style="width: 100px; height: 100px;" cellspacing="0" cellpadding="0" align="center"><tr><td><table cellspacing="0" cellpadding="0" align="center"><tr><td><table id="';
e[a++]=n.id;
e[a++]='_PreviewGrid" style="border-collapse: collapse; background-color: #fff; border: 1px dashed #ccc;" cellspacing="0" cellpadding="0"><tr><td style="border: 1px dashed #ccc;"><div style="width: 30px; height: 30px;"></div></td><td style="border: 1px dashed #ccc;"><div style="width: 30px; height: 30px;"></div></td></tr><tr><td style="border: 1px dashed #ccc;"><div style="width: 30px; height: 30px;"></div></td><td style="border: 1px dashed #ccc;"><div style="width: 30px; height: 30px;"></div></td></tr></table></td></tr></table></td></tr></table></td><td class="VSep-L">&nbsp;</td><td class="VSep-R">&nbsp;</td><td valign="top"><div style="padding-left: 1em; padding-top: 1em; padding-bottom: 1em">';
e[a++]=ZmMsg.orPickAStyleBelow;
e[a++]='</div><table align="center" id="';
e[a++]=n.id;
e[a++]='_QuickBorders"><tr><td></td><td></td><td></td><td></td><td></td></tr></table></td></tr></table></fieldset><fieldset class="ZmFieldset"><legend class="ZmLegend">';
e[a++]=ZmMsg.layout;
e[a++]='</legend><table cellspacing="0"><tr><td class="Label"><table align="right" cellspacing="0" cellpadding="0"><tr><td style="padding-right: 3px"><input id="';
e[a++]=n.id;
e[a++]='_EnableWidth" type="checkbox" /></td><td><label for="';
e[a++]=n.id;
e[a++]='_EnableWidth">';
e[a++]=ZmMsg.widthLabel;
e[a++]='</label></td></tr></table></td><td class="col2" id="';
e[a++]=n.id;
e[a++]='_Width"></td><td class="VSep-L">&nbsp;</td><td class="VSep-R">&nbsp;</td><td class="Label"><table align="right" cellspacing="0" cellpadding="0"><tr><td style="padding-right: 3px"><input id="';
e[a++]=n.id;
e[a++]='_EnableHorizPadding" type="checkbox" /></td><td><label for="';
e[a++]=n.id;
e[a++]='_EnableHorizPadding">';
e[a++]=ZmMsg.paddingHorizontal;
e[a++]='</label></td></tr></table></td><td id="';
e[a++]=n.id;
e[a++]='_HorizPadding"></td></tr><tr><td class="Label"><table align="right" cellspacing="0" cellpadding="0"><tr><td style="padding-right: 3px"><input id="';
e[a++]=n.id;
e[a++]='_EnableHeight" type="checkbox" /></td><td><label for="';
e[a++]=n.id;
e[a++]='_EnableHeight">';
e[a++]=ZmMsg.heightLabel;
e[a++]='</label></td></tr></table></td><td class="col2" id="';
e[a++]=n.id;
e[a++]='_Height"></td><td class="VSep-L">&nbsp;</td><td class="VSep-R">&nbsp;</td><td class="Label"><table align="right" cellspacing="0" cellpadding="0"><tr><td style="padding-right: 3px"><input id="';
e[a++]=n.id;
e[a++]='_EnableVertPadding" type="checkbox" /></td><td><label for="';
e[a++]=n.id;
e[a++]='_EnableVertPadding">';
e[a++]=ZmMsg.paddingVertical;
e[a++]='</label></td></tr></table></td><td id="';
e[a++]=n.id;
e[a++]='_VertPadding"></td></tr></table></fieldset><fieldset class="ZmFieldset"><legend class="ZmLegend">';
e[a++]=ZmMsg.textStyle;
e[a++]='</legend><table cellspacing="0"><tr><td class="Label"><table align="right" cellspacing="0" cellpadding="0"><tr><td style="padding-right: 3px"><input id="';
e[a++]=n.id;
e[a++]='_EnableTextAlign" type="checkbox" /></td><td><label for="';
e[a++]=n.id;
e[a++]='_EnableTextAlign">';
e[a++]=ZmMsg.textAlign;
e[a++]='</label></td></tr></table></td><td class="col2" id="';
e[a++]=n.id;
e[a++]='_TextAlign"></td><td class="VSep-L">&nbsp;</td><td class="VSep-R">&nbsp;</td><td class="Label"><table align="right" cellspacing="0" cellpadding="0"><tr><td style="padding-right: 3px"><input id="';
e[a++]=n.id;
e[a++]='_EnableForegroundColor" type="checkbox" /></td><td><label for="';
e[a++]=n.id;
e[a++]='_EnableForegroundColor">';
e[a++]=ZmMsg.fontColorLabel;
e[a++]='</label></td></tr></table></td><td id="';
e[a++]=n.id;
e[a++]='_ForegroundColor"></td></tr><tr><td class="Label"><table align="right" cellspacing="0" cellpadding="0"><tr><td style="padding-right: 3px"><input id="';
e[a++]=n.id;
e[a++]='_EnableTextVAlign" type="checkbox" /></td><td><label for="';
e[a++]=n.id;
e[a++]='_EnableTextVAlign">';
e[a++]=ZmMsg.verticalAlign;
e[a++]='</label></td></tr></table></td><td class="col2" id="';
e[a++]=n.id;
e[a++]='_TextVAlign"></td><td class="VSep-L">&nbsp;</td><td class="VSep-R">&nbsp;</td><td class="Label"><table align="right" cellspacing="0" cellpadding="0"><tr><td style="padding-right: 3px"><input id="';
e[a++]=n.id;
e[a++]='_EnableBackgroundColor" type="checkbox" /></td><td><label for="';
e[a++]=n.id;
e[a++]='_EnableBackgroundColor">';
e[a++]=ZmMsg.fontBackgroundLabel;
e[a++]='</label></td></tr></table></td><td id="';
e[a++]=n.id;
e[a++]='_BackgroundColor"></td></tr></table></fieldset></td></tr></table>';
return o?e.length:e.join("")
}
,{
id:"share.Dialogs#CellProperties"}
,false);
AjxTemplate.register("share.Dialogs#EditorInsertLink",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]='<table class="ZmHEDialog"><tr><td><fieldset class="ZmFieldset"><legend class="ZmLegend">';
e[a++]=ZmMsg.linkText;
e[a++]="</legend>";
e[a++]=ZmMsg.linkTextDesc;
e[a++]='<br /><div id="';
e[a++]=n.id;
e[a++]='_linkTextCont"></div></fieldset><fieldset class="ZmFieldset"><legend class="ZmLegend">';
e[a++]=ZmMsg.linkTarget;
e[a++]="</legend>";
e[a++]=ZmMsg.linkTargetDesc;
e[a++]='<br /><table cellspacing="0" cellpadding="0"><tr><td id="';
e[a++]=n.id;
e[a++]='_linkTargetCont" style="padding-right: 5px"></td><td id="';
e[a++]=n.id;
e[a++]='_testBtnCont"></td></tr></table></fieldset></td></tr></table>';
return o?e.length:e.join("")
}
,{
id:"share.Dialogs#EditorInsertLink"}
,false);
AjxTemplate.register("share.Dialogs#NewSearch",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table cellpadding='0' cellspacing='0' border='0' ";
e[a++]=AjxEnv.isWebKitBased?"width='320'>":">";
e[a++]="<tr><td class='Label' colspan=2 style='padding: 0px 0px 5px 0px;'>";
e[a++]=ZmMsg.searchName;
e[a++]=" </td></tr><tr><td><input autocomplete=OFF type='text' class='Field' id='";
e[a++]=n.id;
e[a++]="_nameField' /></td></tr><tr><td>&nbsp;</td></tr><tr><td><div id='";
e[a++]=n.id;
e[a++]='_overviewDiv\'><div class="Label">';
e[a++]=ZmMsg.newSearchParent;
e[a++]="</div><div id='";
e[a++]=n.id;
e[a++]="_folderTreeCell'></div></div></td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"share.Dialogs#NewSearch"}
,false);
AjxTemplate.register("share.Dialogs#ZmMountFolderDialog",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table border=0 width=375><tr><td colspan=2>";
e[a++]=ZmMsg.mountInstructions1;
e[a++]="</td></tr><tr><td width=50 align=right>";
e[a++]=ZmMsg.emailLabel;
e[a++]="</td><td id='";
e[a++]=n.id;
e[a++]="_email'></td></tr><tr><td width=50 align=right>";
e[a++]=ZmMsg.pathLabel;
e[a++]="</td><td id='";
e[a++]=n.id;
e[a++]="_path'></td></tr><tr><td><br></td></tr><tr><td colspan=2>";
e[a++]=ZmMsg.mountInstructions2;
e[a++]="</td></tr><tr><td width=50 align=right>";
e[a++]=ZmMsg.nameLabel;
e[a++]="</td><td id='";
e[a++]=n.id;
e[a++]="_name'></td></tr><tr><td width=50 align=right>";
e[a++]=ZmMsg.colorLabel;
e[a++]="</td><td id='";
e[a++]=n.id;
e[a++]="_color'></td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"share.Dialogs#ZmMountFolderDialog"}
,false);
AjxTemplate.register("share.Dialogs#ZmPromptDialog",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table cellpadding=2 cellspacing=0 border=0><tr><td class='Label' id='";
e[a++]=n.id;
e[a++]="_label'/></tr><tr><td><input type=";
e[a++]=n.type;
e[a++]=" autocomplete=OFF class='Field' id='";
e[a++]=n.id;
e[a++]="_name' /></td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"share.Dialogs#ZmPromptDialog"}
,false);
AjxTemplate.register("share.Dialogs#ZmPromptDialog",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table cellpadding=2 cellspacing=0 border=0><tr><td class='Label'>";
e[a++]=ZmMsg.tagName;
e[a++]=":</td>";
if(appCtxt.multiAccounts){
e[a++]="<td class='Label'>";
e[a++]=ZmMsg.colorLabel;
e[a++]="</td><td class='Label'>";
e[a++]=ZmMsg.accountLabel;
e[a++]="</td>"
}
e[a++]="</tr><tr><td><input type=text autocomplete=OFF id='";
e[a++]=n.id;
e[a++]="_name' /></td><td id='";
e[a++]=n.id;
e[a++]="_tagColor' style=\"padding-right: 16px;\"></td><td id='";
e[a++]=n.id;
e[a++]="_account'></td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"share.Dialogs#ZmPromptDialog"}
,false);
AjxTemplate.register("share.Dialogs#ZmTimezonePicker",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table cellpadding=4 cellspacing=0 border=0><tr><td colspan='2' class='Label'>";
e[a++]=ZmMsg.selectTimezoneInfo;
e[a++]="</td></tr><tr><td width=50 align=right>";
e[a++]=ZmMsg.selectTimezoneLabel;
e[a++]="</td><td id='";
e[a++]=n.id;
e[a++]="_tzSelect'></td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"share.Dialogs#ZmTimezonePicker"}
,false);
AjxTemplate.register("share.Dialogs#ZmAttachDialog-MyComputerTab",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div style='overflow:auto'><form accept-charset='utf-8' method='POST' action='";
e[a++]=n.uri;
e[a++]="' id='";
e[a++]=n.id;
e[a++]="_uploadForm' enctype='multipart/form-data'><input type='hidden' name='_charset_' /><table id='";
e[a++]=n.id;
e[a++]="_attachmentTable' cellspacing=0 cellpadding=0 border=0 class='iframeTable'></table></form></div><div><table id='";
e[a++]=n.id;
e[a++]="_attachmentButtonTable'></table></div>";
return o?e.length:e.join("")
}
,{
id:"share.Dialogs#ZmAttachDialog-MyComputerTab"}
,false);
AjxTemplate.register("share.Dialogs#ZmAttachDialog-MyComputerTab-AddAttachment",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table cellspacing=2 cellpadding=0 border=0><tr><td><div class='attachText'>";
e[a++]=ZmMsg.attach;
e[a++]=":</div></td><td class='nobreak'><input id='";
e[a++]=n.id;
e[a++]="_input' type='file' name='";
e[a++]=n.uploadName;
e[a++]="' size=40>&nbsp;\n";
e[a++]="\t\t\t\t<span id='";
e[a++]=n.removeLinkId;
e[a++]='\' onmouseover=\'this.style.cursor="pointer"\' onmouseout=\'this.style.cursor="default"\' class="ZmAttachDialog-removeLink">';
e[a++]=ZmMsg.remove;
e[a++]="</span></td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"share.Dialogs#ZmAttachDialog-MyComputerTab-AddAttachment"}
,false);
AjxTemplate.register("share.Dialogs#ZmNewOrgDialogRemote",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<tr><td colspan=2><table cellpadding=0 cellspacing=5 border=0><tr valign='center'><td class='Label'><input type='checkbox' id='";
e[a++]=n.id;
e[a++]="_remote' /></td><td>\n";
e[a++]="\t\t\t\t\t\t";
e[a++]=n.remoteLabel;
e[a++]="\n";
e[a++]="\t\t\t\t\t</td></tr></table></td></tr><tr style='display:none;' id='";
e[a++]=n.id;
e[a++]="_remoteURLrow' valign='center'><td class='Label'>";
e[a++]=ZmMsg.urlLabel;
e[a++]="</td><td><input autocomplete='off' type='text' class='Field' id='";
e[a++]=n.id;
e[a++]="_remoteURLfield' /></td></tr>";
return o?e.length:e.join("")
}
,{
id:"share.Dialogs#ZmNewOrgDialogRemote"}
,false);
AjxTemplate.register("share.Dialogs#ZmNewOrgDialogName",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<tr valign='center'><td class='Label'>";
e[a++]=ZmMsg.nameLabel;
e[a++]="</td><td><input autocomplete='off' type='text' class='Field' id='";
e[a++]=n.id;
e[a++]="_name' /></td></tr>";
return o?e.length:e.join("")
}
,{
id:"share.Dialogs#ZmNewOrgDialogName"}
,false);
AjxTemplate.register("share.Dialogs#ZmNewOrgDialogColor",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<tr><td class='Label'>";
e[a++]=ZmMsg.colorLabel;
e[a++]="</td><td id='";
e[a++]=n.id;
e[a++]="_colorSelect'></td></tr>";
return o?e.length:e.join("")
}
,{
id:"share.Dialogs#ZmNewOrgDialogColor"}
,false);
AjxTemplate.register("share.Dialogs#ZmNewOrgDialogFolder",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<tr><td class='Label' colspan=2>";
e[a++]=ZmMsg.newFolderParent;
e[a++]="</td></tr><tr><td colspan=2 id='";
e[a++]=n.id;
e[a++]="_folderTree'></td></tr>";
return o?e.length:e.join("")
}
,{
id:"share.Dialogs#ZmNewOrgDialogFolder"}
,false);
AjxTemplate.register("share.Dialogs#ZmNewCalDialogFreeBusy",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<tr><td colspan=2><table cellpadding=0 cellspacing=5 border=0><tr valign='center'><td class='Label'><input type='checkbox' id='";
e[a++]=n.id;
e[a++]="_excludeFbCheckbox' /></td><td>";
e[a++]=ZmMsg.excludeFromFreeBusy;
e[a++]="</td></tr></table></td></tr>";
return o?e.length:e.join("")
}
,{
id:"share.Dialogs#ZmNewCalDialogFreeBusy"}
,false);
AjxTemplate.register("share.Dialogs#ZmRenameDialog",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table cellpadding='0' cellspacing='0' border='0'><tr><td class='Label' colspan=2 style='padding: 0px 0px 5px 0px;'>";
e[a++]=n.newLabel;
e[a++]=": </td></tr><tr><td><input type='text' autocomplete='off' class='Field' id='";
e[a++]=n.id;
e[a++]="_name' /></td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"share.Dialogs#ZmRenameDialog"}
,false)
}
if(AjxPackage.define("share.Quota")){
AjxTemplate.register("share.Quota#UsedLimited",function(t,r,s,e){
var n=Boolean(e);
s=(typeof s=="string"?{
id:s}
:s)||{};
e=e||[];
var o=e.length;
var a="quotaUsed";
if(s.percent<85&&s.percent>65){
a="quotaWarning"
}else{
if(s.percent>=85){
a="quotaCritical"
}}
e[o++]="<table class='BannerBar' cellspacing=0 cellpadding=0><tr><td width='50%'><div></div></td><td><div class='quotabar'><div style='width:";
e[o++]=s.percent;
e[o++]="' class='";
e[o++]=a;
e[o++]="'></div></div></td><td width='50%'><div></div></td></tr></table>";
return n?e.length:e.join("")
}
,{
"class":"BannerBar",id:"share.Quota#UsedLimited"}
,false);
AjxTemplate.register("share.Quota",AjxTemplate.getTemplate("share.Quota#UsedLimited"),AjxTemplate.getParams("share.Quota#UsedLimited"));
AjxTemplate.register("share.Quota#UsedUnlimited",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table cellspacing=0 cellpadding=0 width='100%'><tr><td class='BannerTextQuota'>";
e[a++]=n.desc;
e[a++]="</td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"share.Quota#UsedUnlimited"}
,false);
AjxTemplate.register("share.Quota#Tooltip",function(t,r,s,e){
var n=Boolean(e);
s=(typeof s=="string"?{
id:s}
:s)||{};
e=e||[];
var o=e.length;
e[o++]="<table>";
if(s.username!=s.login){
e[o++]="<tr><td><center>";
e[o++]=s.login;
e[o++]="</center></td></tr>"
}
if(s.quota){
var a=AjxMessageFormat.format(ZmMsg.quotaDescLimited,[s.size,s.limit]);
e[o++]="<tr><td><center>";
e[o++]=ZmMsg.quota;
e[o++]=": ";
e[o++]=s.percent;
e[o++]="% (";
e[o++]=a;
e[o++]=")</center></td></tr>"
}
e[o++]="</table>";
return n?e.length:e.join("")
}
,{
id:"share.Quota#Tooltip"}
,false)
}
if(AjxPackage.define("share.Widgets")){
AjxTemplate.register("share.Widgets#ZmToolBarSeparator",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table><tr><td id='";
e[a++]=n.itemId;
e[a++]="' valign='middle'><div class='vertSep'></div></td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"share.Widgets#ZmToolBarSeparator"}
,false);
AjxTemplate.register("share.Widgets",AjxTemplate.getTemplate("share.Widgets#ZmToolBarSeparator"),AjxTemplate.getParams("share.Widgets#ZmToolBarSeparator"));
AjxTemplate.register("share.Widgets#ZmAppChooser",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table class='ZToolbarTable' border=0 cellpadding=0 cellspacing=0><tr valign='bottom' id='";
e[a++]=n.id;
e[a++]="_items'><td id='";
e[a++]=n.id;
e[a++]='_suffix\' valign=bottom><div class=\'ZAppTabSpacer\'></div></td><td width="100%" valign="middle" align="right" style="padding-right: 10px;" id="admin_link_container">\n';
e[a++]="                &nbsp;\n";
e[a++]="            </td></tr></table>";
return o?e.length:e.join("")
}
,{
"class":"ZWidget",id:"share.Widgets#ZmAppChooser"}
,false);
AjxTemplate.register("share.Widgets#ZmAppChooserItem",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]=AjxTemplate.expand("dwt.Widgets#ZToolbarItem",n);
return o?e.length:e.join("")
}
,{
id:"share.Widgets#ZmAppChooserItem"}
,false);
AjxTemplate.register("share.Widgets#ZmAppChooserButton",function(a,r,s,t){
var n=Boolean(t);
s=(typeof s=="string"?{
id:s}
:s)||{};
t=t||[];
var o=t.length;
var e=s.buttonClass||"AppTab";
t[o++]="<table class='ZWidgetTable Z";
t[o++]=e;
t[o++]="Table Z";
t[o++]=e;
t[o++]="Border' cellspacing=0 cellpadding=0 style='table-layout:auto;'><tr><td id='";
t[o++]=s.id;
t[o++]="_left_icon'  \tclass='ZLeftIcon ZWidgetIcon'></td><td id='";
t[o++]=s.id;
t[o++]="_title'\t\tclass='ZWidgetTitle'></td><td id='";
t[o++]=s.id;
t[o++]="_right_icon' \tclass='ZRightIcon ZWidgetIcon'></td></tr></table>";
return n?t.length:t.join("")
}
,{
"class":"ZAppTab",id:"share.Widgets#ZmAppChooserButton"}
,false);
AjxTemplate.register("share.Widgets#ZmAppChooserButton",function(a,r,s,t){
var n=Boolean(t);
s=(typeof s=="string"?{
id:s}
:s)||{};
t=t||[];
var o=t.length;
var e=s.buttonClass||"AppTab";
t[o++]="<table class='ZWidgetTable Z";
t[o++]=e;
t[o++]="Table Z";
t[o++]=e;
t[o++]="Border' cellspacing=0 cellpadding=0 style='table-layout:auto;'><tr><td id='";
t[o++]=s.id;
t[o++]="_left_icon'  \tclass='ZLeftIcon ZWidgetIcon'></td><td id='";
t[o++]=s.id;
t[o++]="_title'\t\tclass='ZWidgetTitle'></td><td id='";
t[o++]=s.id;
t[o++]="_right_icon' \tclass='ZRightIcon ZWidgetIcon'></td></tr></table>";
return n?t.length:t.join("")
}
,{
"class":"ZAppTab",id:"share.Widgets#ZmAppChooserButton"}
,false);
AjxTemplate.register("share.Widgets#ZmAppChooserSpacer",function(a,r,s,t){
var n=Boolean(t);
s=(typeof s=="string"?{
id:s}
:s)||{};
t=t||[];
var o=t.length;
var e=s.buttonClass||"AppTab";
t[o++]="<div class='Z";
t[o++]=e;
t[o++]="Spacer'></div>";
return n?t.length:t.join("")
}
,{
id:"share.Widgets#ZmAppChooserSpacer"}
,false);
AjxTemplate.register("share.Widgets#ZToast",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='ZToastBG'><div class='ZToastContent'><div id='";
e[a++]=n.id;
e[a++]="_icon' class='ZToastIcon'></div><div id='";
e[a++]=n.id;
e[a++]="_text' class='ZToastText'></div></div></div>";
return o?e.length:e.join("")
}
,{
"class":"ZToastInfo",id:"share.Widgets#ZToast"}
,false);
AjxTemplate.register("share.Widgets#ZmSearchToolBar",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<table border=0 cellpadding=0 cellspacing=0 width='100%' height='100%'><tr><td id='";
e[a++]=n.id;
e[a++]="_inputField' width='100%' class='ZmSearchToolbarCell'></td><td id='";
e[a++]=n.id;
e[a++]="_searchMenuButton' class='ZmSearchToolbarCell'></td><td id='";
e[a++]=n.id;
e[a++]="_searchButton' hint='text' class='ZmSearchToolbarCell'></td><!-- UNCOMMENT THIS IF YOU WANT CUSTOM SEARCH TO APPEAR AS A SEPARATE BUTTON ON SEARCH TOOLBAR\n";
e[a++]="\t\t\t<td class='ZmSearchToolbarSeparatorCell'><div id='";
e[a++]=n.id;
e[a++]="_customSearchButtonSep' class='vertSep' style='display:none'></div></td><td id='";
e[a++]=n.id;
e[a++]="_customSearchButton' class='ZmSearchToolbarCell'></td>\n";
e[a++]="\t\t\t--><td class='ZmSearchToolbarSeparatorCell'><div class='vertSep'></div></td><td id='";
e[a++]=n.id;
e[a++]="_saveButton' hint='text' class='ZmSearchToolbarCell'></td><td class='ZmSearchToolbarSeparatorCell'><div class='vertSep'></div></td><td id='";
e[a++]=n.id;
e[a++]="_advancedButton' hint='text' class='ZmSearchToolbarCell'></td></tr></table>";
return o?e.length:e.join("")
}
,{
id:"share.Widgets#ZmSearchToolBar"}
,false);
AjxTemplate.register("share.Widgets#ZmChooseFolderDialog",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='ChooserDialog'><span id='";
e[a++]=n.id;
e[a++]="_folderDescDivId' style='margin: 0; margin-bottom: 2px'></span><div>";
e[a++]=ZmMsg.chooserDescription;
e[a++]="</div><div id='";
e[a++]=n.id;
e[a++]="_inputDivId'></div><div class='overview' id='";
e[a++]=n.id;
e[a++]="_folderTreeDivId'></div></div>";
return o?e.length:e.join("")
}
,{
id:"share.Widgets#ZmChooseFolderDialog"}
,false);
AjxTemplate.register("share.Widgets#ZmPickTagDialog",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div class='ChooserDialog'><div style='width:300px'>";
e[a++]=ZmMsg.chooserDescription;
e[a++]="</div><div id='";
e[a++]=n.id;
e[a++]="_inputDivId'></div><div style='background-color:white; width:100%; overflow:auto' id='";
e[a++]=n.id;
e[a++]="_tagTreeDivId'></div></div>";
return o?e.length:e.join("")
}
,{
id:"share.Widgets#ZmPickTagDialog"}
,false)
}
if(AjxPackage.define("zimbra.Widgets")){
AjxTemplate.register("zimbra.Widgets#ZmErrorDialogControls",function(t,s,n,e){
var o=Boolean(e);
n=(typeof n=="string"?{
id:n}
:n)||{};
e=e||[];
var a=e.length;
e[a++]="<div id='";
e[a++]=n.id;
e[a++]="_buttons' class='DwtDialogButtonBar'>";
if(AjxEnv.isNav){
e[a++]="<input type='button' id='";
e[a++]=n.id;
e[a++]="_focus' style='height:0px;width:0px;display:none;'>"
}
e[a++]="</div>";
return o?e.length:e.join("")
}
,{
width:"20",height:"32",id:"zimbra.Widgets#ZmErrorDialogControls"}
,false);
AjxTemplate.register("zimbra.Widgets",AjxTemplate.getTemplate("zimbra.Widgets#ZmErrorDialogControls"),AjxTemplate.getParams("zimbra.Widgets#ZmErrorDialogControls"))
};




function ZmSkin(A){this.hints=this.mergeObjects(ZmSkin.hints,A)
}ZmSkin.hints={name:"sand",version:"2",skin:{containers:"skin_outer"},banner:{position:"static",url:""},userInfo:{position:"static"},search:{position:"static"},quota:{position:"static"},presence:{width:"40px",height:"24px"},appView:{position:"static"},searchBuilder:{containers:["skin_tr_search_builder"]},tree:{minWidth:parseInt("150px"),maxWidth:parseInt("300px"),containers:["skin_td_tree","skin_td_tree_app_sash"],resizeContainers:["skin_td_tree"]},topToolbar:{containers:"skin_tr_top_toolbar"},treeFooter:{containers:"skin_tr_tree_footer"},topAd:{containers:"skin_tr_top_ad"},sidebarAd:{containers:"skin_td_sidebar_ad"},bottomAd:{containers:"skin_tr_bottom_ad"},treeTopAd:{containers:"skin_tr_tree_top_ad"},treeBottomAd:{containers:"skin_tr_tree_bottom_ad"},helpButton:{style:"link",container:"quota",url:""},logoutButton:{style:"link",container:"quota"},appChooser:{position:"static",direction:"LR"},toast:{location:"N",transitions:[{type:"slide-in",step:1,duration:10},{type:"pause",duration:2500},{type:"slide-out",step:-1,duration:25}]},fullScreen:{containers:["!skin_td_tree","!skin_td_tree_app_sash"]},allAds:{containers:["skin_tr_top_ad","skin_td_sidebar_ad","skin_tr_bottom_ad","skin_tr_tree_top_ad","skin_tr_tree_bottom_ad"]}};
window.BaseSkin=ZmSkin;
ZmSkin.prototype={show:function(C,G){var F=this.hints[C]&&this.hints[C].containers;
if(F){if(typeof F=="function"){F.apply(this,[G!=false]);
skin._reflowApp();
return 
}if(typeof F=="string"){F=[F]
}for(var E=0;
E<F.length;
E++){var D=F[E];
var B=D.replace(/^!/,"");
var A=D!=B;
this._showEl(B,A?!G:G)
}skin._reflowApp()
}},hide:function(A){this.show(A,false)
},gotoApp:function(A,B){appCtxt.getAppController().activateApp(A,null,B)
},gotoPrefs:function(A){if(appCtxt.getCurrentAppName()!=ZmApp.PREFERENCES){var B=new AjxCallback(this,this._gotoPrefPage,[A]);
this.gotoApp(ZmApp.PREFERENCES,B)
}else{this._gotoPrefPage(A)
}},mergeObjects:function(A,D){if(A==null){A={}
}for(var C=1;
C<arguments.length;
C++){var E=arguments[C];
for(var B in E){var F=A[B];
if(typeof F=="object"&&!(F instanceof Array)){this.mergeObjects(A[B],E[B]);
continue
}if(!A[B]){A[B]=E[B]
}}}return A
},getTreeWidth:function(){return Dwt.getSize(this._getEl(this.hints.tree.containers[0])).x
},setTreeWidth:function(A){this._setContainerSizes("tree",A,null)
},showTopAd:function(A){skin._showEl("skin_tr_top_ad",A);
skin._reflowApp()

},hideTopAd:function(){skin.showTopAd(false)
},getTopAdContainer:function(){return skin._getEl("skin_container_top_ad")
},showSidebarAd:function(A){var B="skin_td_sidebar_ad";
if(A!=null){skin._setSize(B,A)
}skin._showEl(B);
skin._reflowApp()
},hideSidebarAd:function(){var A="skin_td_sidebar_ad";
skin._hideEl(A);
skin._reflowApp()
},getSidebarAdContainer:function(){return this._getEl("skin_container_sidebar_ad")
},_getEl:function(A){return(typeof A=="string"?document.getElementById(A):A)
},_showEl:function(E,D){var B=this._getEl(E);
if(!B){return 
}var C;
if(D==false){C="none"
}else{var A=B.tagName;
if(A=="TD"&&!document.all){C="table-cell"
}else{if(A=="TR"&&!document.all){C="table-row"
}else{C="block"
}}}B.style.display=C
},_hideEl:function(A){this._showEl(A,false)
},_reparentEl:function(D,A){var C=this._getEl(A);
var B=C&&this._getEl(D);
if(B){C.appendChild(B)
}},_setSize:function(D,C,A){var B=this._getEl(D);
if(!B){return 
}if(C!=null){B.style.width=C
}if(A!=null){B.style.height=A
}},_setContainerSizes:function(E,C,A){var D=this.hints[E].resizeContainers||this.hints[E].containers;
for(var B=0;
B<D.length;
B++){this._setSize(D[B],C,null)
}},_reflowApp:function(){if(window._zimbraMail){window._zimbraMail.getAppViewMgr().fitAll()
}},_gotoPrefPage:function(C){if(C==null){return 
}var D=appCtxt.getApp(ZmApp.PREFERENCES);
var B=D.getPrefController();
var A=B.getPrefsView();
A.selectSection(C)
}};
window.skin=new ZmSkin();



// compile locale specific templates
for (var pkg in window.AjxTemplateMsg) {
	var text = AjxTemplateMsg[pkg];
	AjxTemplate.compile(pkg, true, true, text);
}



	var cacheKillerVersion = "091214175450";
	function launch() {
		// quit if this function has already been called
		if (arguments.callee.done) {return;}

		// flag this function so we don't do the same thing twice
		arguments.callee.done = true;

		// kill the timer
		if (_timer) {
			clearInterval(_timer);
			_timer = null;
		}

		var prodMode = true;
		var debugLevel = "";
		if (!prodMode || debugLevel) {
			AjxDispatcher.require("Debug");
			DBG = new AjxDebug(AjxDebug.NONE, null, false);
			// figure out the debug level
			if (debugLevel == 't') {
				DBG.showTiming(true);
			} else {
				DBG.setDebugLevel(debugLevel);
			}
		}

		AjxHistoryMgr.BLANK_FILE = "/zimbra/public/blankHistory.html";
		var noSplashScreen = "";
		var protocolMode = "https";

        
        
        var batchInfoResponse = {}; // Redacted

        

		

		// NOTE: Domain info settings moved into launch function to
		//       prevent sloppy code from accessing extraneous window
		//       scoped variable.
		
		var settings = {
			"dummy":1,
			"zimbraPrefMailItemsPerPage":"25",
			"zimbraPrefAdvancedClientEnforceMinDisplay":"TRUE",
			"zimbraPrefGroupMailBy":"conversation",
			"zimbraPrefSkin":"sand",
			"zimbraPrefClientType":"advanced"
			,
			"zimbraFeatureNotebookEnabled":"TRUE",
			"zimbraFeatureIMEnabled":"FALSE",
			"zimbraFeatureBriefcasesEnabled":"TRUE",
			"zimbraFeatureContactsUpsellEnabled":"FALSE",
			"zimbraFeatureVoiceEnabled":"FALSE",
			"zimbraFeatureMailUpsellEnabled":"FALSE",
			"zimbraFeatureContactsEnabled":"TRUE",
			"zimbraFeatureConversationsEnabled":"TRUE",
			"zimbraFeaturePortalEnabled":"FALSE",
			"zimbraFeatureVoiceUpsellEnabled":"FALSE",
			"zimbraFeatureOptionsEnabled":"TRUE",
			"zimbraFeatureMailEnabled":"TRUE",
			"zimbraFeatureTasksEnabled":"TRUE",
			"zimbraFeatureCalendarEnabled":"TRUE",
			"zimbraFeatureCalendarUpsellEnabled":"FALSE"
			
			
			
		};

		var params = {
			app:"",
			settings:settings, batchInfoResponse:batchInfoResponse,
			offlineMode:false, devMode:false,
			protocolMode:protocolMode, httpPort:"80", httpsPort:"443",
			noSplashScreen:noSplashScreen
		};
		ZmZimbraMail.run(params);
	}

    //	START DOMContentLoaded
    // Mozilla and Opera 9 expose the event we could use
    if (document.addEventListener) {
        document.addEventListener("DOMContentLoaded", launch, null);

        //	mainly for Opera 8.5, won't be fired if DOMContentLoaded fired already.
        document.addEventListener("load", launch, null);
    }

    // 	for Internet Explorer. readyState will not be achieved on init call
    if (AjxEnv.isIE && AjxEnv.isWindows) {
        document.attachEvent("onreadystatechange", function(e) {
            if (document.readyState == "complete") {
                launch();
            }
        });
    }

    if (/(WebKit|khtml)/i.test(navigator.userAgent)) { // sniff
        var _timer = setInterval(function() {
            if (/loaded|complete/.test(document.readyState)) {
                launch();
                // call the onload handler
            }
        }, 10);
    }
    //	END DOMContentLoaded

    AjxCore.addOnloadListener(launch);
    AjxCore.addOnunloadListener(ZmZimbraMail.unload);